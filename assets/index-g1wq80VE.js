function iN(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Xn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function nw(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var iw={exports:{}},sm={},sw={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yd=Symbol.for("react.element"),sN=Symbol.for("react.portal"),aN=Symbol.for("react.fragment"),oN=Symbol.for("react.strict_mode"),lN=Symbol.for("react.profiler"),cN=Symbol.for("react.provider"),uN=Symbol.for("react.context"),fN=Symbol.for("react.forward_ref"),dN=Symbol.for("react.suspense"),hN=Symbol.for("react.memo"),mN=Symbol.for("react.lazy"),rv=Symbol.iterator;function pN(e){return e===null||typeof e!="object"?null:(e=rv&&e[rv]||e["@@iterator"],typeof e=="function"?e:null)}var aw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ow=Object.assign,lw={};function su(e,t,r){this.props=e,this.context=t,this.refs=lw,this.updater=r||aw}su.prototype.isReactComponent={};su.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};su.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function cw(){}cw.prototype=su.prototype;function Jg(e,t,r){this.props=e,this.context=t,this.refs=lw,this.updater=r||aw}var Qg=Jg.prototype=new cw;Qg.constructor=Jg;ow(Qg,su.prototype);Qg.isPureReactComponent=!0;var nv=Array.isArray,uw=Object.prototype.hasOwnProperty,Zg={current:null},fw={key:!0,ref:!0,__self:!0,__source:!0};function dw(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)uw.call(t,n)&&!fw.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:yd,type:e,key:s,ref:a,props:i,_owner:Zg.current}}function gN(e,t){return{$$typeof:yd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function e2(e){return typeof e=="object"&&e!==null&&e.$$typeof===yd}function xN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var iv=/\/+/g;function Ep(e,t){return typeof e=="object"&&e!==null&&e.key!=null?xN(""+e.key):t.toString(36)}function i0(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case yd:case sN:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+Ep(a,0):n,nv(i)?(r="",e!=null&&(r=e.replace(iv,"$&/")+"/"),i0(i,t,r,"",function(u){return u})):i!=null&&(e2(i)&&(i=gN(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(iv,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",nv(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Ep(s,o);a+=i0(s,t,r,l,i)}else if(l=pN(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Ep(s,o++),a+=i0(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function bh(e,t,r){if(e==null)return e;var n=[],i=0;return i0(e,n,"","",function(s){return t.call(r,s,i++)}),n}function vN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Zn={current:null},s0={transition:null},yN={ReactCurrentDispatcher:Zn,ReactCurrentBatchConfig:s0,ReactCurrentOwner:Zg};function hw(){throw Error("act(...) is not supported in production builds of React.")}Ft.Children={map:bh,forEach:function(e,t,r){bh(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return bh(e,function(){t++}),t},toArray:function(e){return bh(e,function(t){return t})||[]},only:function(e){if(!e2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ft.Component=su;Ft.Fragment=aN;Ft.Profiler=lN;Ft.PureComponent=Jg;Ft.StrictMode=oN;Ft.Suspense=dN;Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yN;Ft.act=hw;Ft.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=ow({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Zg.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)uw.call(t,l)&&!fw.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:yd,type:e.type,key:i,ref:s,props:n,_owner:a}};Ft.createContext=function(e){return e={$$typeof:uN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:cN,_context:e},e.Consumer=e};Ft.createElement=dw;Ft.createFactory=function(e){var t=dw.bind(null,e);return t.type=e,t};Ft.createRef=function(){return{current:null}};Ft.forwardRef=function(e){return{$$typeof:fN,render:e}};Ft.isValidElement=e2;Ft.lazy=function(e){return{$$typeof:mN,_payload:{_status:-1,_result:e},_init:vN}};Ft.memo=function(e,t){return{$$typeof:hN,type:e,compare:t===void 0?null:t}};Ft.startTransition=function(e){var t=s0.transition;s0.transition={};try{e()}finally{s0.transition=t}};Ft.unstable_act=hw;Ft.useCallback=function(e,t){return Zn.current.useCallback(e,t)};Ft.useContext=function(e){return Zn.current.useContext(e)};Ft.useDebugValue=function(){};Ft.useDeferredValue=function(e){return Zn.current.useDeferredValue(e)};Ft.useEffect=function(e,t){return Zn.current.useEffect(e,t)};Ft.useId=function(){return Zn.current.useId()};Ft.useImperativeHandle=function(e,t,r){return Zn.current.useImperativeHandle(e,t,r)};Ft.useInsertionEffect=function(e,t){return Zn.current.useInsertionEffect(e,t)};Ft.useLayoutEffect=function(e,t){return Zn.current.useLayoutEffect(e,t)};Ft.useMemo=function(e,t){return Zn.current.useMemo(e,t)};Ft.useReducer=function(e,t,r){return Zn.current.useReducer(e,t,r)};Ft.useRef=function(e){return Zn.current.useRef(e)};Ft.useState=function(e){return Zn.current.useState(e)};Ft.useSyncExternalStore=function(e,t,r){return Zn.current.useSyncExternalStore(e,t,r)};Ft.useTransition=function(){return Zn.current.useTransition()};Ft.version="18.3.1";sw.exports=Ft;var me=sw.exports;const mw=Xg(me),wN=iN({__proto__:null,default:mw},[me]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN=me,_N=Symbol.for("react.element"),SN=Symbol.for("react.fragment"),NN=Object.prototype.hasOwnProperty,kN=bN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EN={key:!0,ref:!0,__self:!0,__source:!0};function pw(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)NN.call(t,n)&&!EN.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:_N,type:e,key:s,ref:a,props:i,_owner:kN.current}}sm.Fragment=SN;sm.jsx=pw;sm.jsxs=pw;iw.exports=sm;var c=iw.exports,gw={exports:{}},Mi={},xw={exports:{}},vw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,Y){var re=B.length;B.push(Y);e:for(;0<re;){var he=re-1>>>1,k=B[he];if(0<i(k,Y))B[he]=Y,B[re]=k,re=he;else break e}}function r(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var Y=B[0],re=B.pop();if(re!==Y){B[0]=re;e:for(var he=0,k=B.length,I=k>>>1;he<I;){var M=2*(he+1)-1,D=B[M],V=M+1,se=B[V];if(0>i(D,re))V<k&&0>i(se,D)?(B[he]=se,B[V]=re,he=V):(B[he]=D,B[M]=re,he=M);else if(V<k&&0>i(se,re))B[he]=se,B[V]=re,he=V;else break e}}return Y}function i(B,Y){var re=B.sortIndex-Y.sortIndex;return re!==0?re:B.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,m=null,p=3,h=!1,v=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(B){for(var Y=r(u);Y!==null;){if(Y.callback===null)n(u);else if(Y.startTime<=B)n(u),Y.sortIndex=Y.expirationTime,t(l,Y);else break;Y=r(u)}}function j(B){if(g=!1,_(B),!v)if(r(l)!==null)v=!0,U(O);else{var Y=r(u);Y!==null&&G(j,Y.startTime-B)}}function O(B,Y){v=!1,g&&(g=!1,y(C),C=-1),h=!0;var re=p;try{for(_(Y),m=r(l);m!==null&&(!(m.expirationTime>Y)||B&&!T());){var he=m.callback;if(typeof he=="function"){m.callback=null,p=m.priorityLevel;var k=he(m.expirationTime<=Y);Y=e.unstable_now(),typeof k=="function"?m.callback=k:m===r(l)&&n(l),_(Y)}else n(l);m=r(l)}if(m!==null)var I=!0;else{var M=r(u);M!==null&&G(j,M.startTime-Y),I=!1}return I}finally{m=null,p=re,h=!1}}var L=!1,E=null,C=-1,P=5,R=-1;function T(){return!(e.unstable_now()-R<P)}function A(){if(E!==null){var B=e.unstable_now();R=B;var Y=!0;try{Y=E(!0,B)}finally{Y?q():(L=!1,E=null)}}else L=!1}var q;if(typeof w=="function")q=function(){w(A)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,ne=z.port2;z.port1.onmessage=A,q=function(){ne.postMessage(null)}}else q=function(){b(A,0)};function U(B){E=B,L||(L=!0,q())}function G(B,Y){C=b(function(){B(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,U(O))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(B){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var re=p;p=Y;try{return B()}finally{p=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,Y){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var re=p;p=B;try{return Y()}finally{p=re}},e.unstable_scheduleCallback=function(B,Y,re){var he=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?he+re:he):re=he,B){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=re+k,B={id:f++,callback:Y,priorityLevel:B,startTime:re,expirationTime:k,sortIndex:-1},re>he?(B.sortIndex=re,t(u,B),r(l)===null&&B===r(u)&&(g?(y(C),C=-1):g=!0,G(j,re-he))):(B.sortIndex=k,t(l,B),v||h||(v=!0,U(O))),B},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(B){var Y=p;return function(){var re=p;p=Y;try{return B.apply(this,arguments)}finally{p=re}}}})(vw);xw.exports=vw;var jN=xw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AN=me,Ii=jN;function qe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yw=new Set,zf={};function Cl(e,t){Yc(e,t),Yc(e+"Capture",t)}function Yc(e,t){for(zf[e]=t,e=0;e<t.length;e++)yw.add(t[e])}var Sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),C1=Object.prototype.hasOwnProperty,TN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sv={},av={};function CN(e){return C1.call(av,e)?!0:C1.call(sv,e)?!1:TN.test(e)?av[e]=!0:(sv[e]=!0,!1)}function PN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function LN(e,t,r,n){if(t===null||typeof t>"u"||PN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ei(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){An[e]=new ei(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];An[t]=new ei(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){An[e]=new ei(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){An[e]=new ei(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){An[e]=new ei(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){An[e]=new ei(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){An[e]=new ei(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){An[e]=new ei(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){An[e]=new ei(e,5,!1,e.toLowerCase(),null,!1,!1)});var t2=/[\-:]([a-z])/g;function r2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(t2,r2);An[t]=new ei(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(t2,r2);An[t]=new ei(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(t2,r2);An[t]=new ei(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){An[e]=new ei(e,1,!1,e.toLowerCase(),null,!1,!1)});An.xlinkHref=new ei("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){An[e]=new ei(e,1,!1,e.toLowerCase(),null,!0,!0)});function n2(e,t,r,n){var i=An.hasOwnProperty(t)?An[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(LN(t,r,i,n)&&(r=null),n||i===null?CN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ca=AN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_h=Symbol.for("react.element"),Sc=Symbol.for("react.portal"),Nc=Symbol.for("react.fragment"),i2=Symbol.for("react.strict_mode"),P1=Symbol.for("react.profiler"),ww=Symbol.for("react.provider"),bw=Symbol.for("react.context"),s2=Symbol.for("react.forward_ref"),L1=Symbol.for("react.suspense"),F1=Symbol.for("react.suspense_list"),a2=Symbol.for("react.memo"),Za=Symbol.for("react.lazy"),_w=Symbol.for("react.offscreen"),ov=Symbol.iterator;function Yu(e){return e===null||typeof e!="object"?null:(e=ov&&e[ov]||e["@@iterator"],typeof e=="function"?e:null)}var Er=Object.assign,jp;function ff(e){if(jp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);jp=t&&t[1]||""}return`
`+jp+e}var Ap=!1;function Tp(e,t){if(!e||Ap)return"";Ap=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{Ap=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ff(e):""}function FN(e){switch(e.tag){case 5:return ff(e.type);case 16:return ff("Lazy");case 13:return ff("Suspense");case 19:return ff("SuspenseList");case 0:case 2:case 15:return e=Tp(e.type,!1),e;case 11:return e=Tp(e.type.render,!1),e;case 1:return e=Tp(e.type,!0),e;default:return""}}function O1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Nc:return"Fragment";case Sc:return"Portal";case P1:return"Profiler";case i2:return"StrictMode";case L1:return"Suspense";case F1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bw:return(e.displayName||"Context")+".Consumer";case ww:return(e._context.displayName||"Context")+".Provider";case s2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case a2:return t=e.displayName||null,t!==null?t:O1(e.type)||"Memo";case Za:t=e._payload,e=e._init;try{return O1(e(t))}catch{}}return null}function ON(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return O1(t);case 8:return t===i2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function No(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Sw(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function DN(e){var t=Sw(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Sh(e){e._valueTracker||(e._valueTracker=DN(e))}function Nw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Sw(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function g0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function D1(e,t){var r=t.checked;return Er({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function lv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=No(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function kw(e,t){t=t.checked,t!=null&&n2(e,"checked",t,!1)}function I1(e,t){kw(e,t);var r=No(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?R1(e,t.type,r):t.hasOwnProperty("defaultValue")&&R1(e,t.type,No(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function cv(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function R1(e,t,r){(t!=="number"||g0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var df=Array.isArray;function Rc(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+No(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function M1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(qe(91));return Er({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function uv(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(qe(92));if(df(r)){if(1<r.length)throw Error(qe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:No(r)}}function Ew(e,t){var r=No(t.value),n=No(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function fv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function jw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function B1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?jw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Nh,Aw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Nh=Nh||document.createElement("div"),Nh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Nh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IN=["Webkit","ms","Moz","O"];Object.keys(vf).forEach(function(e){IN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vf[t]=vf[e]})});function Tw(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||vf.hasOwnProperty(e)&&vf[e]?(""+t).trim():t+"px"}function Cw(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Tw(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var RN=Er({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function U1(e,t){if(t){if(RN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(qe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(qe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(qe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(qe(62))}}function z1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var W1=null;function o2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var H1=null,Mc=null,Bc=null;function dv(e){if(e=_d(e)){if(typeof H1!="function")throw Error(qe(280));var t=e.stateNode;t&&(t=um(t),H1(e.stateNode,e.type,t))}}function Pw(e){Mc?Bc?Bc.push(e):Bc=[e]:Mc=e}function Lw(){if(Mc){var e=Mc,t=Bc;if(Bc=Mc=null,dv(e),t)for(e=0;e<t.length;e++)dv(t[e])}}function Fw(e,t){return e(t)}function Ow(){}var Cp=!1;function Dw(e,t,r){if(Cp)return e(t,r);Cp=!0;try{return Fw(e,t,r)}finally{Cp=!1,(Mc!==null||Bc!==null)&&(Ow(),Lw())}}function Hf(e,t){var r=e.stateNode;if(r===null)return null;var n=um(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(qe(231,t,typeof r));return r}var $1=!1;if(Sa)try{var Ku={};Object.defineProperty(Ku,"passive",{get:function(){$1=!0}}),window.addEventListener("test",Ku,Ku),window.removeEventListener("test",Ku,Ku)}catch{$1=!1}function MN(e,t,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var yf=!1,x0=null,v0=!1,q1=null,BN={onError:function(e){yf=!0,x0=e}};function UN(e,t,r,n,i,s,a,o,l){yf=!1,x0=null,MN.apply(BN,arguments)}function zN(e,t,r,n,i,s,a,o,l){if(UN.apply(this,arguments),yf){if(yf){var u=x0;yf=!1,x0=null}else throw Error(qe(198));v0||(v0=!0,q1=u)}}function Pl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Iw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hv(e){if(Pl(e)!==e)throw Error(qe(188))}function WN(e){var t=e.alternate;if(!t){if(t=Pl(e),t===null)throw Error(qe(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return hv(i),e;if(s===n)return hv(i),t;s=s.sibling}throw Error(qe(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(qe(189))}}if(r.alternate!==n)throw Error(qe(190))}if(r.tag!==3)throw Error(qe(188));return r.stateNode.current===r?e:t}function Rw(e){return e=WN(e),e!==null?Mw(e):null}function Mw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Mw(e);if(t!==null)return t;e=e.sibling}return null}var Bw=Ii.unstable_scheduleCallback,mv=Ii.unstable_cancelCallback,HN=Ii.unstable_shouldYield,$N=Ii.unstable_requestPaint,Br=Ii.unstable_now,qN=Ii.unstable_getCurrentPriorityLevel,l2=Ii.unstable_ImmediatePriority,Uw=Ii.unstable_UserBlockingPriority,y0=Ii.unstable_NormalPriority,VN=Ii.unstable_LowPriority,zw=Ii.unstable_IdlePriority,am=null,Ks=null;function GN(e){if(Ks&&typeof Ks.onCommitFiberRoot=="function")try{Ks.onCommitFiberRoot(am,e,void 0,(e.current.flags&128)===128)}catch{}}var As=Math.clz32?Math.clz32:XN,YN=Math.log,KN=Math.LN2;function XN(e){return e>>>=0,e===0?32:31-(YN(e)/KN|0)|0}var kh=64,Eh=4194304;function hf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function w0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=hf(o):(s&=a,s!==0&&(n=hf(s)))}else a=r&~i,a!==0?n=hf(a):s!==0&&(n=hf(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-As(t),i=1<<r,n|=e[r],t&=~i;return n}function JN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QN(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-As(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=JN(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function V1(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ww(){var e=kh;return kh<<=1,!(kh&4194240)&&(kh=64),e}function Pp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function wd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-As(t),e[t]=r}function ZN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-As(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function c2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-As(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var nr=0;function Hw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $w,u2,qw,Vw,Gw,G1=!1,jh=[],ho=null,mo=null,po=null,$f=new Map,qf=new Map,ro=[],e6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pv(e,t){switch(e){case"focusin":case"focusout":ho=null;break;case"dragenter":case"dragleave":mo=null;break;case"mouseover":case"mouseout":po=null;break;case"pointerover":case"pointerout":$f.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qf.delete(t.pointerId)}}function Xu(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=_d(t),t!==null&&u2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function t6(e,t,r,n,i){switch(t){case"focusin":return ho=Xu(ho,e,t,r,n,i),!0;case"dragenter":return mo=Xu(mo,e,t,r,n,i),!0;case"mouseover":return po=Xu(po,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return $f.set(s,Xu($f.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,qf.set(s,Xu(qf.get(s)||null,e,t,r,n,i)),!0}return!1}function Yw(e){var t=al(e.target);if(t!==null){var r=Pl(t);if(r!==null){if(t=r.tag,t===13){if(t=Iw(r),t!==null){e.blockedOn=t,Gw(e.priority,function(){qw(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function a0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Y1(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);W1=n,r.target.dispatchEvent(n),W1=null}else return t=_d(r),t!==null&&u2(t),e.blockedOn=r,!1;t.shift()}return!0}function gv(e,t,r){a0(e)&&r.delete(t)}function r6(){G1=!1,ho!==null&&a0(ho)&&(ho=null),mo!==null&&a0(mo)&&(mo=null),po!==null&&a0(po)&&(po=null),$f.forEach(gv),qf.forEach(gv)}function Ju(e,t){e.blockedOn===t&&(e.blockedOn=null,G1||(G1=!0,Ii.unstable_scheduleCallback(Ii.unstable_NormalPriority,r6)))}function Vf(e){function t(i){return Ju(i,e)}if(0<jh.length){Ju(jh[0],e);for(var r=1;r<jh.length;r++){var n=jh[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ho!==null&&Ju(ho,e),mo!==null&&Ju(mo,e),po!==null&&Ju(po,e),$f.forEach(t),qf.forEach(t),r=0;r<ro.length;r++)n=ro[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ro.length&&(r=ro[0],r.blockedOn===null);)Yw(r),r.blockedOn===null&&ro.shift()}var Uc=Ca.ReactCurrentBatchConfig,b0=!0;function n6(e,t,r,n){var i=nr,s=Uc.transition;Uc.transition=null;try{nr=1,f2(e,t,r,n)}finally{nr=i,Uc.transition=s}}function i6(e,t,r,n){var i=nr,s=Uc.transition;Uc.transition=null;try{nr=4,f2(e,t,r,n)}finally{nr=i,Uc.transition=s}}function f2(e,t,r,n){if(b0){var i=Y1(e,t,r,n);if(i===null)zp(e,t,n,_0,r),pv(e,n);else if(t6(i,e,t,r,n))n.stopPropagation();else if(pv(e,n),t&4&&-1<e6.indexOf(e)){for(;i!==null;){var s=_d(i);if(s!==null&&$w(s),s=Y1(e,t,r,n),s===null&&zp(e,t,n,_0,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else zp(e,t,n,null,r)}}var _0=null;function Y1(e,t,r,n){if(_0=null,e=o2(n),e=al(e),e!==null)if(t=Pl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Iw(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _0=e,null}function Kw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qN()){case l2:return 1;case Uw:return 4;case y0:case VN:return 16;case zw:return 536870912;default:return 16}default:return 16}}var ao=null,d2=null,o0=null;function Xw(){if(o0)return o0;var e,t=d2,r=t.length,n,i="value"in ao?ao.value:ao.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return o0=i.slice(e,1<n?1-n:void 0)}function l0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ah(){return!0}function xv(){return!1}function Bi(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ah:xv,this.isPropagationStopped=xv,this}return Er(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ah)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ah)},persist:function(){},isPersistent:Ah}),t}var au={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},h2=Bi(au),bd=Er({},au,{view:0,detail:0}),s6=Bi(bd),Lp,Fp,Qu,om=Er({},bd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:m2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qu&&(Qu&&e.type==="mousemove"?(Lp=e.screenX-Qu.screenX,Fp=e.screenY-Qu.screenY):Fp=Lp=0,Qu=e),Lp)},movementY:function(e){return"movementY"in e?e.movementY:Fp}}),vv=Bi(om),a6=Er({},om,{dataTransfer:0}),o6=Bi(a6),l6=Er({},bd,{relatedTarget:0}),Op=Bi(l6),c6=Er({},au,{animationName:0,elapsedTime:0,pseudoElement:0}),u6=Bi(c6),f6=Er({},au,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),d6=Bi(f6),h6=Er({},au,{data:0}),yv=Bi(h6),m6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},p6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},g6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x6(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=g6[e])?!!t[e]:!1}function m2(){return x6}var v6=Er({},bd,{key:function(e){if(e.key){var t=m6[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=l0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?p6[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:m2,charCode:function(e){return e.type==="keypress"?l0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?l0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),y6=Bi(v6),w6=Er({},om,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wv=Bi(w6),b6=Er({},bd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:m2}),_6=Bi(b6),S6=Er({},au,{propertyName:0,elapsedTime:0,pseudoElement:0}),N6=Bi(S6),k6=Er({},om,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),E6=Bi(k6),j6=[9,13,27,32],p2=Sa&&"CompositionEvent"in window,wf=null;Sa&&"documentMode"in document&&(wf=document.documentMode);var A6=Sa&&"TextEvent"in window&&!wf,Jw=Sa&&(!p2||wf&&8<wf&&11>=wf),bv=" ",_v=!1;function Qw(e,t){switch(e){case"keyup":return j6.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var kc=!1;function T6(e,t){switch(e){case"compositionend":return Zw(t);case"keypress":return t.which!==32?null:(_v=!0,bv);case"textInput":return e=t.data,e===bv&&_v?null:e;default:return null}}function C6(e,t){if(kc)return e==="compositionend"||!p2&&Qw(e,t)?(e=Xw(),o0=d2=ao=null,kc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Jw&&t.locale!=="ko"?null:t.data;default:return null}}var P6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!P6[e.type]:t==="textarea"}function eb(e,t,r,n){Pw(n),t=S0(t,"onChange"),0<t.length&&(r=new h2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var bf=null,Gf=null;function L6(e){fb(e,0)}function lm(e){var t=Ac(e);if(Nw(t))return e}function F6(e,t){if(e==="change")return t}var tb=!1;if(Sa){var Dp;if(Sa){var Ip="oninput"in document;if(!Ip){var Nv=document.createElement("div");Nv.setAttribute("oninput","return;"),Ip=typeof Nv.oninput=="function"}Dp=Ip}else Dp=!1;tb=Dp&&(!document.documentMode||9<document.documentMode)}function kv(){bf&&(bf.detachEvent("onpropertychange",rb),Gf=bf=null)}function rb(e){if(e.propertyName==="value"&&lm(Gf)){var t=[];eb(t,Gf,e,o2(e)),Dw(L6,t)}}function O6(e,t,r){e==="focusin"?(kv(),bf=t,Gf=r,bf.attachEvent("onpropertychange",rb)):e==="focusout"&&kv()}function D6(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lm(Gf)}function I6(e,t){if(e==="click")return lm(t)}function R6(e,t){if(e==="input"||e==="change")return lm(t)}function M6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ps=typeof Object.is=="function"?Object.is:M6;function Yf(e,t){if(Ps(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!C1.call(t,i)||!Ps(e[i],t[i]))return!1}return!0}function Ev(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function jv(e,t){var r=Ev(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ev(r)}}function nb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?nb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ib(){for(var e=window,t=g0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=g0(e.document)}return t}function g2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function B6(e){var t=ib(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&nb(r.ownerDocument.documentElement,r)){if(n!==null&&g2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=jv(r,s);var a=jv(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var U6=Sa&&"documentMode"in document&&11>=document.documentMode,Ec=null,K1=null,_f=null,X1=!1;function Av(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;X1||Ec==null||Ec!==g0(n)||(n=Ec,"selectionStart"in n&&g2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_f&&Yf(_f,n)||(_f=n,n=S0(K1,"onSelect"),0<n.length&&(t=new h2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ec)))}function Th(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var jc={animationend:Th("Animation","AnimationEnd"),animationiteration:Th("Animation","AnimationIteration"),animationstart:Th("Animation","AnimationStart"),transitionend:Th("Transition","TransitionEnd")},Rp={},sb={};Sa&&(sb=document.createElement("div").style,"AnimationEvent"in window||(delete jc.animationend.animation,delete jc.animationiteration.animation,delete jc.animationstart.animation),"TransitionEvent"in window||delete jc.transitionend.transition);function cm(e){if(Rp[e])return Rp[e];if(!jc[e])return e;var t=jc[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in sb)return Rp[e]=t[r];return e}var ab=cm("animationend"),ob=cm("animationiteration"),lb=cm("animationstart"),cb=cm("transitionend"),ub=new Map,Tv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oo(e,t){ub.set(e,t),Cl(t,[e])}for(var Mp=0;Mp<Tv.length;Mp++){var Bp=Tv[Mp],z6=Bp.toLowerCase(),W6=Bp[0].toUpperCase()+Bp.slice(1);Oo(z6,"on"+W6)}Oo(ab,"onAnimationEnd");Oo(ob,"onAnimationIteration");Oo(lb,"onAnimationStart");Oo("dblclick","onDoubleClick");Oo("focusin","onFocus");Oo("focusout","onBlur");Oo(cb,"onTransitionEnd");Yc("onMouseEnter",["mouseout","mouseover"]);Yc("onMouseLeave",["mouseout","mouseover"]);Yc("onPointerEnter",["pointerout","pointerover"]);Yc("onPointerLeave",["pointerout","pointerover"]);Cl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),H6=new Set("cancel close invalid load scroll toggle".split(" ").concat(mf));function Cv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zN(n,t,void 0,e),e.currentTarget=null}function fb(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Cv(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Cv(i,o,u),s=l}}}if(v0)throw e=q1,v0=!1,q1=null,e}function xr(e,t){var r=t[tg];r===void 0&&(r=t[tg]=new Set);var n=e+"__bubble";r.has(n)||(db(t,e,2,!1),r.add(n))}function Up(e,t,r){var n=0;t&&(n|=4),db(r,e,n,t)}var Ch="_reactListening"+Math.random().toString(36).slice(2);function Kf(e){if(!e[Ch]){e[Ch]=!0,yw.forEach(function(r){r!=="selectionchange"&&(H6.has(r)||Up(r,!1,e),Up(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ch]||(t[Ch]=!0,Up("selectionchange",!1,t))}}function db(e,t,r,n){switch(Kw(t)){case 1:var i=n6;break;case 4:i=i6;break;default:i=f2}r=i.bind(null,t,r,e),i=void 0,!$1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function zp(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=al(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Dw(function(){var u=s,f=o2(r),m=[];e:{var p=ub.get(e);if(p!==void 0){var h=h2,v=e;switch(e){case"keypress":if(l0(r)===0)break e;case"keydown":case"keyup":h=y6;break;case"focusin":v="focus",h=Op;break;case"focusout":v="blur",h=Op;break;case"beforeblur":case"afterblur":h=Op;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=vv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=o6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=_6;break;case ab:case ob:case lb:h=u6;break;case cb:h=N6;break;case"scroll":h=s6;break;case"wheel":h=E6;break;case"copy":case"cut":case"paste":h=d6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=wv}var g=(t&4)!==0,b=!g&&e==="scroll",y=g?p!==null?p+"Capture":null:p;g=[];for(var w=u,_;w!==null;){_=w;var j=_.stateNode;if(_.tag===5&&j!==null&&(_=j,y!==null&&(j=Hf(w,y),j!=null&&g.push(Xf(w,j,_)))),b)break;w=w.return}0<g.length&&(p=new h(p,v,null,r,f),m.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==W1&&(v=r.relatedTarget||r.fromElement)&&(al(v)||v[Na]))break e;if((h||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=u,v=v?al(v):null,v!==null&&(b=Pl(v),v!==b||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=u),h!==v)){if(g=vv,j="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=wv,j="onPointerLeave",y="onPointerEnter",w="pointer"),b=h==null?p:Ac(h),_=v==null?p:Ac(v),p=new g(j,w+"leave",h,r,f),p.target=b,p.relatedTarget=_,j=null,al(f)===u&&(g=new g(y,w+"enter",v,r,f),g.target=_,g.relatedTarget=b,j=g),b=j,h&&v)t:{for(g=h,y=v,w=0,_=g;_;_=lc(_))w++;for(_=0,j=y;j;j=lc(j))_++;for(;0<w-_;)g=lc(g),w--;for(;0<_-w;)y=lc(y),_--;for(;w--;){if(g===y||y!==null&&g===y.alternate)break t;g=lc(g),y=lc(y)}g=null}else g=null;h!==null&&Pv(m,p,h,g,!1),v!==null&&b!==null&&Pv(m,b,v,g,!0)}}e:{if(p=u?Ac(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var O=F6;else if(Sv(p))if(tb)O=R6;else{O=D6;var L=O6}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(O=I6);if(O&&(O=O(e,u))){eb(m,O,r,f);break e}L&&L(e,p,u),e==="focusout"&&(L=p._wrapperState)&&L.controlled&&p.type==="number"&&R1(p,"number",p.value)}switch(L=u?Ac(u):window,e){case"focusin":(Sv(L)||L.contentEditable==="true")&&(Ec=L,K1=u,_f=null);break;case"focusout":_f=K1=Ec=null;break;case"mousedown":X1=!0;break;case"contextmenu":case"mouseup":case"dragend":X1=!1,Av(m,r,f);break;case"selectionchange":if(U6)break;case"keydown":case"keyup":Av(m,r,f)}var E;if(p2)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else kc?Qw(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(Jw&&r.locale!=="ko"&&(kc||C!=="onCompositionStart"?C==="onCompositionEnd"&&kc&&(E=Xw()):(ao=f,d2="value"in ao?ao.value:ao.textContent,kc=!0)),L=S0(u,C),0<L.length&&(C=new yv(C,e,null,r,f),m.push({event:C,listeners:L}),E?C.data=E:(E=Zw(r),E!==null&&(C.data=E)))),(E=A6?T6(e,r):C6(e,r))&&(u=S0(u,"onBeforeInput"),0<u.length&&(f=new yv("onBeforeInput","beforeinput",null,r,f),m.push({event:f,listeners:u}),f.data=E))}fb(m,t)})}function Xf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function S0(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Hf(e,r),s!=null&&n.unshift(Xf(e,s,i)),s=Hf(e,t),s!=null&&n.push(Xf(e,s,i))),e=e.return}return n}function lc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Pv(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=Hf(r,s),l!=null&&a.unshift(Xf(r,l,o))):i||(l=Hf(r,s),l!=null&&a.push(Xf(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var $6=/\r\n?/g,q6=/\u0000|\uFFFD/g;function Lv(e){return(typeof e=="string"?e:""+e).replace($6,`
`).replace(q6,"")}function Ph(e,t,r){if(t=Lv(t),Lv(e)!==t&&r)throw Error(qe(425))}function N0(){}var J1=null,Q1=null;function Z1(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var eg=typeof setTimeout=="function"?setTimeout:void 0,V6=typeof clearTimeout=="function"?clearTimeout:void 0,Fv=typeof Promise=="function"?Promise:void 0,G6=typeof queueMicrotask=="function"?queueMicrotask:typeof Fv<"u"?function(e){return Fv.resolve(null).then(e).catch(Y6)}:eg;function Y6(e){setTimeout(function(){throw e})}function Wp(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Vf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Vf(t)}function go(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ov(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ou=Math.random().toString(36).slice(2),Gs="__reactFiber$"+ou,Jf="__reactProps$"+ou,Na="__reactContainer$"+ou,tg="__reactEvents$"+ou,K6="__reactListeners$"+ou,X6="__reactHandles$"+ou;function al(e){var t=e[Gs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Na]||r[Gs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ov(e);e!==null;){if(r=e[Gs])return r;e=Ov(e)}return t}e=r,r=e.parentNode}return null}function _d(e){return e=e[Gs]||e[Na],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ac(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(qe(33))}function um(e){return e[Jf]||null}var rg=[],Tc=-1;function Do(e){return{current:e}}function yr(e){0>Tc||(e.current=rg[Tc],rg[Tc]=null,Tc--)}function pr(e,t){Tc++,rg[Tc]=e.current,e.current=t}var ko={},Hn=Do(ko),di=Do(!1),wl=ko;function Kc(e,t){var r=e.type.contextTypes;if(!r)return ko;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function hi(e){return e=e.childContextTypes,e!=null}function k0(){yr(di),yr(Hn)}function Dv(e,t,r){if(Hn.current!==ko)throw Error(qe(168));pr(Hn,t),pr(di,r)}function hb(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(qe(108,ON(e)||"Unknown",i));return Er({},r,n)}function E0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ko,wl=Hn.current,pr(Hn,e),pr(di,di.current),!0}function Iv(e,t,r){var n=e.stateNode;if(!n)throw Error(qe(169));r?(e=hb(e,t,wl),n.__reactInternalMemoizedMergedChildContext=e,yr(di),yr(Hn),pr(Hn,e)):yr(di),pr(di,r)}var ga=null,fm=!1,Hp=!1;function mb(e){ga===null?ga=[e]:ga.push(e)}function J6(e){fm=!0,mb(e)}function Io(){if(!Hp&&ga!==null){Hp=!0;var e=0,t=nr;try{var r=ga;for(nr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ga=null,fm=!1}catch(i){throw ga!==null&&(ga=ga.slice(e+1)),Bw(l2,Io),i}finally{nr=t,Hp=!1}}return null}var Cc=[],Pc=0,j0=null,A0=0,Qi=[],Zi=0,bl=null,xa=1,va="";function Zo(e,t){Cc[Pc++]=A0,Cc[Pc++]=j0,j0=e,A0=t}function pb(e,t,r){Qi[Zi++]=xa,Qi[Zi++]=va,Qi[Zi++]=bl,bl=e;var n=xa;e=va;var i=32-As(n)-1;n&=~(1<<i),r+=1;var s=32-As(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,xa=1<<32-As(t)+i|r<<i|n,va=s+e}else xa=1<<s|r<<i|n,va=e}function x2(e){e.return!==null&&(Zo(e,1),pb(e,1,0))}function v2(e){for(;e===j0;)j0=Cc[--Pc],Cc[Pc]=null,A0=Cc[--Pc],Cc[Pc]=null;for(;e===bl;)bl=Qi[--Zi],Qi[Zi]=null,va=Qi[--Zi],Qi[Zi]=null,xa=Qi[--Zi],Qi[Zi]=null}var Oi=null,Li=null,_r=!1,Ss=null;function gb(e,t){var r=es(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Rv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Oi=e,Li=go(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Oi=e,Li=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=bl!==null?{id:xa,overflow:va}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=es(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Oi=e,Li=null,!0):!1;default:return!1}}function ng(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ig(e){if(_r){var t=Li;if(t){var r=t;if(!Rv(e,t)){if(ng(e))throw Error(qe(418));t=go(r.nextSibling);var n=Oi;t&&Rv(e,t)?gb(n,r):(e.flags=e.flags&-4097|2,_r=!1,Oi=e)}}else{if(ng(e))throw Error(qe(418));e.flags=e.flags&-4097|2,_r=!1,Oi=e}}}function Mv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Oi=e}function Lh(e){if(e!==Oi)return!1;if(!_r)return Mv(e),_r=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Z1(e.type,e.memoizedProps)),t&&(t=Li)){if(ng(e))throw xb(),Error(qe(418));for(;t;)gb(e,t),t=go(t.nextSibling)}if(Mv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Li=go(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Li=null}}else Li=Oi?go(e.stateNode.nextSibling):null;return!0}function xb(){for(var e=Li;e;)e=go(e.nextSibling)}function Xc(){Li=Oi=null,_r=!1}function y2(e){Ss===null?Ss=[e]:Ss.push(e)}var Q6=Ca.ReactCurrentBatchConfig;function Zu(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(qe(309));var n=r.stateNode}if(!n)throw Error(qe(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(qe(284));if(!r._owner)throw Error(qe(290,e))}return e}function Fh(e,t){throw e=Object.prototype.toString.call(t),Error(qe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Bv(e){var t=e._init;return t(e._payload)}function vb(e){function t(y,w){if(e){var _=y.deletions;_===null?(y.deletions=[w],y.flags|=16):_.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=wo(y,w),y.index=0,y.sibling=null,y}function s(y,w,_){return y.index=_,e?(_=y.alternate,_!==null?(_=_.index,_<w?(y.flags|=2,w):_):(y.flags|=2,w)):(y.flags|=1048576,w)}function a(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,_,j){return w===null||w.tag!==6?(w=Xp(_,y.mode,j),w.return=y,w):(w=i(w,_),w.return=y,w)}function l(y,w,_,j){var O=_.type;return O===Nc?f(y,w,_.props.children,j,_.key):w!==null&&(w.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Za&&Bv(O)===w.type)?(j=i(w,_.props),j.ref=Zu(y,w,_),j.return=y,j):(j=p0(_.type,_.key,_.props,null,y.mode,j),j.ref=Zu(y,w,_),j.return=y,j)}function u(y,w,_,j){return w===null||w.tag!==4||w.stateNode.containerInfo!==_.containerInfo||w.stateNode.implementation!==_.implementation?(w=Jp(_,y.mode,j),w.return=y,w):(w=i(w,_.children||[]),w.return=y,w)}function f(y,w,_,j,O){return w===null||w.tag!==7?(w=fl(_,y.mode,j,O),w.return=y,w):(w=i(w,_),w.return=y,w)}function m(y,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Xp(""+w,y.mode,_),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case _h:return _=p0(w.type,w.key,w.props,null,y.mode,_),_.ref=Zu(y,null,w),_.return=y,_;case Sc:return w=Jp(w,y.mode,_),w.return=y,w;case Za:var j=w._init;return m(y,j(w._payload),_)}if(df(w)||Yu(w))return w=fl(w,y.mode,_,null),w.return=y,w;Fh(y,w)}return null}function p(y,w,_,j){var O=w!==null?w.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return O!==null?null:o(y,w,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case _h:return _.key===O?l(y,w,_,j):null;case Sc:return _.key===O?u(y,w,_,j):null;case Za:return O=_._init,p(y,w,O(_._payload),j)}if(df(_)||Yu(_))return O!==null?null:f(y,w,_,j,null);Fh(y,_)}return null}function h(y,w,_,j,O){if(typeof j=="string"&&j!==""||typeof j=="number")return y=y.get(_)||null,o(w,y,""+j,O);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case _h:return y=y.get(j.key===null?_:j.key)||null,l(w,y,j,O);case Sc:return y=y.get(j.key===null?_:j.key)||null,u(w,y,j,O);case Za:var L=j._init;return h(y,w,_,L(j._payload),O)}if(df(j)||Yu(j))return y=y.get(_)||null,f(w,y,j,O,null);Fh(w,j)}return null}function v(y,w,_,j){for(var O=null,L=null,E=w,C=w=0,P=null;E!==null&&C<_.length;C++){E.index>C?(P=E,E=null):P=E.sibling;var R=p(y,E,_[C],j);if(R===null){E===null&&(E=P);break}e&&E&&R.alternate===null&&t(y,E),w=s(R,w,C),L===null?O=R:L.sibling=R,L=R,E=P}if(C===_.length)return r(y,E),_r&&Zo(y,C),O;if(E===null){for(;C<_.length;C++)E=m(y,_[C],j),E!==null&&(w=s(E,w,C),L===null?O=E:L.sibling=E,L=E);return _r&&Zo(y,C),O}for(E=n(y,E);C<_.length;C++)P=h(E,y,C,_[C],j),P!==null&&(e&&P.alternate!==null&&E.delete(P.key===null?C:P.key),w=s(P,w,C),L===null?O=P:L.sibling=P,L=P);return e&&E.forEach(function(T){return t(y,T)}),_r&&Zo(y,C),O}function g(y,w,_,j){var O=Yu(_);if(typeof O!="function")throw Error(qe(150));if(_=O.call(_),_==null)throw Error(qe(151));for(var L=O=null,E=w,C=w=0,P=null,R=_.next();E!==null&&!R.done;C++,R=_.next()){E.index>C?(P=E,E=null):P=E.sibling;var T=p(y,E,R.value,j);if(T===null){E===null&&(E=P);break}e&&E&&T.alternate===null&&t(y,E),w=s(T,w,C),L===null?O=T:L.sibling=T,L=T,E=P}if(R.done)return r(y,E),_r&&Zo(y,C),O;if(E===null){for(;!R.done;C++,R=_.next())R=m(y,R.value,j),R!==null&&(w=s(R,w,C),L===null?O=R:L.sibling=R,L=R);return _r&&Zo(y,C),O}for(E=n(y,E);!R.done;C++,R=_.next())R=h(E,y,C,R.value,j),R!==null&&(e&&R.alternate!==null&&E.delete(R.key===null?C:R.key),w=s(R,w,C),L===null?O=R:L.sibling=R,L=R);return e&&E.forEach(function(A){return t(y,A)}),_r&&Zo(y,C),O}function b(y,w,_,j){if(typeof _=="object"&&_!==null&&_.type===Nc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case _h:e:{for(var O=_.key,L=w;L!==null;){if(L.key===O){if(O=_.type,O===Nc){if(L.tag===7){r(y,L.sibling),w=i(L,_.props.children),w.return=y,y=w;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Za&&Bv(O)===L.type){r(y,L.sibling),w=i(L,_.props),w.ref=Zu(y,L,_),w.return=y,y=w;break e}r(y,L);break}else t(y,L);L=L.sibling}_.type===Nc?(w=fl(_.props.children,y.mode,j,_.key),w.return=y,y=w):(j=p0(_.type,_.key,_.props,null,y.mode,j),j.ref=Zu(y,w,_),j.return=y,y=j)}return a(y);case Sc:e:{for(L=_.key;w!==null;){if(w.key===L)if(w.tag===4&&w.stateNode.containerInfo===_.containerInfo&&w.stateNode.implementation===_.implementation){r(y,w.sibling),w=i(w,_.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=Jp(_,y.mode,j),w.return=y,y=w}return a(y);case Za:return L=_._init,b(y,w,L(_._payload),j)}if(df(_))return v(y,w,_,j);if(Yu(_))return g(y,w,_,j);Fh(y,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,w!==null&&w.tag===6?(r(y,w.sibling),w=i(w,_),w.return=y,y=w):(r(y,w),w=Xp(_,y.mode,j),w.return=y,y=w),a(y)):r(y,w)}return b}var Jc=vb(!0),yb=vb(!1),T0=Do(null),C0=null,Lc=null,w2=null;function b2(){w2=Lc=C0=null}function _2(e){var t=T0.current;yr(T0),e._currentValue=t}function sg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function zc(e,t){C0=e,w2=Lc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(fi=!0),e.firstContext=null)}function rs(e){var t=e._currentValue;if(w2!==e)if(e={context:e,memoizedValue:t,next:null},Lc===null){if(C0===null)throw Error(qe(308));Lc=e,C0.dependencies={lanes:0,firstContext:e}}else Lc=Lc.next=e;return t}var ol=null;function S2(e){ol===null?ol=[e]:ol.push(e)}function wb(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,S2(t)):(r.next=i.next,i.next=r),t.interleaved=r,ka(e,n)}function ka(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var eo=!1;function N2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bb(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ya(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xo(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Wt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ka(e,r)}return i=n.interleaved,i===null?(t.next=t,S2(n)):(t.next=i.next,i.next=t),n.interleaved=t,ka(e,r)}function c0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c2(e,r)}}function Uv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function P0(e,t,r,n){var i=e.updateQueue;eo=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;a=0,f=u=l=null,o=s;do{var p=o.lane,h=o.eventTime;if((n&p)===p){f!==null&&(f=f.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,g=o;switch(p=t,h=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){m=v.call(h,m,p);break e}m=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,p=typeof v=="function"?v.call(h,m,p):v,p==null)break e;m=Er({},m,p);break e;case 2:eo=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=h,l=m):f=f.next=h,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(f===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Sl|=a,e.lanes=a,e.memoizedState=m}}function zv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(qe(191,i));i.call(n)}}}var Sd={},Xs=Do(Sd),Qf=Do(Sd),Zf=Do(Sd);function ll(e){if(e===Sd)throw Error(qe(174));return e}function k2(e,t){switch(pr(Zf,t),pr(Qf,e),pr(Xs,Sd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:B1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=B1(t,e)}yr(Xs),pr(Xs,t)}function Qc(){yr(Xs),yr(Qf),yr(Zf)}function _b(e){ll(Zf.current);var t=ll(Xs.current),r=B1(t,e.type);t!==r&&(pr(Qf,e),pr(Xs,r))}function E2(e){Qf.current===e&&(yr(Xs),yr(Qf))}var Nr=Do(0);function L0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $p=[];function j2(){for(var e=0;e<$p.length;e++)$p[e]._workInProgressVersionPrimary=null;$p.length=0}var u0=Ca.ReactCurrentDispatcher,qp=Ca.ReactCurrentBatchConfig,_l=0,kr=null,sn=null,dn=null,F0=!1,Sf=!1,ed=0,Z6=0;function Fn(){throw Error(qe(321))}function A2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ps(e[r],t[r]))return!1;return!0}function T2(e,t,r,n,i,s){if(_l=s,kr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,u0.current=e===null||e.memoizedState===null?nk:ik,e=r(n,i),Sf){s=0;do{if(Sf=!1,ed=0,25<=s)throw Error(qe(301));s+=1,dn=sn=null,t.updateQueue=null,u0.current=sk,e=r(n,i)}while(Sf)}if(u0.current=O0,t=sn!==null&&sn.next!==null,_l=0,dn=sn=kr=null,F0=!1,t)throw Error(qe(300));return e}function C2(){var e=ed!==0;return ed=0,e}function Vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?kr.memoizedState=dn=e:dn=dn.next=e,dn}function ns(){if(sn===null){var e=kr.alternate;e=e!==null?e.memoizedState:null}else e=sn.next;var t=dn===null?kr.memoizedState:dn.next;if(t!==null)dn=t,sn=e;else{if(e===null)throw Error(qe(310));sn=e,e={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},dn===null?kr.memoizedState=dn=e:dn=dn.next=e}return dn}function td(e,t){return typeof t=="function"?t(e):t}function Vp(e){var t=ns(),r=t.queue;if(r===null)throw Error(qe(311));r.lastRenderedReducer=e;var n=sn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((_l&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=m,a=n):l=l.next=m,kr.lanes|=f,Sl|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,Ps(n,t.memoizedState)||(fi=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,kr.lanes|=s,Sl|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Gp(e){var t=ns(),r=t.queue;if(r===null)throw Error(qe(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Ps(s,t.memoizedState)||(fi=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Sb(){}function Nb(e,t){var r=kr,n=ns(),i=t(),s=!Ps(n.memoizedState,i);if(s&&(n.memoizedState=i,fi=!0),n=n.queue,P2(jb.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||dn!==null&&dn.memoizedState.tag&1){if(r.flags|=2048,rd(9,Eb.bind(null,r,n,i,t),void 0,null),xn===null)throw Error(qe(349));_l&30||kb(r,t,i)}return i}function kb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=kr.updateQueue,t===null?(t={lastEffect:null,stores:null},kr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Eb(e,t,r,n){t.value=r,t.getSnapshot=n,Ab(t)&&Tb(e)}function jb(e,t,r){return r(function(){Ab(t)&&Tb(e)})}function Ab(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ps(e,r)}catch{return!0}}function Tb(e){var t=ka(e,1);t!==null&&Ts(t,e,1,-1)}function Wv(e){var t=Vs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:td,lastRenderedState:e},t.queue=e,e=e.dispatch=rk.bind(null,kr,e),[t.memoizedState,e]}function rd(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=kr.updateQueue,t===null?(t={lastEffect:null,stores:null},kr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Cb(){return ns().memoizedState}function f0(e,t,r,n){var i=Vs();kr.flags|=e,i.memoizedState=rd(1|t,r,void 0,n===void 0?null:n)}function dm(e,t,r,n){var i=ns();n=n===void 0?null:n;var s=void 0;if(sn!==null){var a=sn.memoizedState;if(s=a.destroy,n!==null&&A2(n,a.deps)){i.memoizedState=rd(t,r,s,n);return}}kr.flags|=e,i.memoizedState=rd(1|t,r,s,n)}function Hv(e,t){return f0(8390656,8,e,t)}function P2(e,t){return dm(2048,8,e,t)}function Pb(e,t){return dm(4,2,e,t)}function Lb(e,t){return dm(4,4,e,t)}function Fb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ob(e,t,r){return r=r!=null?r.concat([e]):null,dm(4,4,Fb.bind(null,t,e),r)}function L2(){}function Db(e,t){var r=ns();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&A2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ib(e,t){var r=ns();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&A2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Rb(e,t,r){return _l&21?(Ps(r,t)||(r=Ww(),kr.lanes|=r,Sl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,fi=!0),e.memoizedState=r)}function ek(e,t){var r=nr;nr=r!==0&&4>r?r:4,e(!0);var n=qp.transition;qp.transition={};try{e(!1),t()}finally{nr=r,qp.transition=n}}function Mb(){return ns().memoizedState}function tk(e,t,r){var n=yo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Bb(e))Ub(t,r);else if(r=wb(e,t,r,n),r!==null){var i=Jn();Ts(r,e,n,i),zb(r,t,n)}}function rk(e,t,r){var n=yo(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Bb(e))Ub(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Ps(o,a)){var l=t.interleaved;l===null?(i.next=i,S2(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=wb(e,t,i,n),r!==null&&(i=Jn(),Ts(r,e,n,i),zb(r,t,n))}}function Bb(e){var t=e.alternate;return e===kr||t!==null&&t===kr}function Ub(e,t){Sf=F0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function zb(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c2(e,r)}}var O0={readContext:rs,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useInsertionEffect:Fn,useLayoutEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useMutableSource:Fn,useSyncExternalStore:Fn,useId:Fn,unstable_isNewReconciler:!1},nk={readContext:rs,useCallback:function(e,t){return Vs().memoizedState=[e,t===void 0?null:t],e},useContext:rs,useEffect:Hv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,f0(4194308,4,Fb.bind(null,t,e),r)},useLayoutEffect:function(e,t){return f0(4194308,4,e,t)},useInsertionEffect:function(e,t){return f0(4,2,e,t)},useMemo:function(e,t){var r=Vs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Vs();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=tk.bind(null,kr,e),[n.memoizedState,e]},useRef:function(e){var t=Vs();return e={current:e},t.memoizedState=e},useState:Wv,useDebugValue:L2,useDeferredValue:function(e){return Vs().memoizedState=e},useTransition:function(){var e=Wv(!1),t=e[0];return e=ek.bind(null,e[1]),Vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=kr,i=Vs();if(_r){if(r===void 0)throw Error(qe(407));r=r()}else{if(r=t(),xn===null)throw Error(qe(349));_l&30||kb(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Hv(jb.bind(null,n,s,e),[e]),n.flags|=2048,rd(9,Eb.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Vs(),t=xn.identifierPrefix;if(_r){var r=va,n=xa;r=(n&~(1<<32-As(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ed++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Z6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ik={readContext:rs,useCallback:Db,useContext:rs,useEffect:P2,useImperativeHandle:Ob,useInsertionEffect:Pb,useLayoutEffect:Lb,useMemo:Ib,useReducer:Vp,useRef:Cb,useState:function(){return Vp(td)},useDebugValue:L2,useDeferredValue:function(e){var t=ns();return Rb(t,sn.memoizedState,e)},useTransition:function(){var e=Vp(td)[0],t=ns().memoizedState;return[e,t]},useMutableSource:Sb,useSyncExternalStore:Nb,useId:Mb,unstable_isNewReconciler:!1},sk={readContext:rs,useCallback:Db,useContext:rs,useEffect:P2,useImperativeHandle:Ob,useInsertionEffect:Pb,useLayoutEffect:Lb,useMemo:Ib,useReducer:Gp,useRef:Cb,useState:function(){return Gp(td)},useDebugValue:L2,useDeferredValue:function(e){var t=ns();return sn===null?t.memoizedState=e:Rb(t,sn.memoizedState,e)},useTransition:function(){var e=Gp(td)[0],t=ns().memoizedState;return[e,t]},useMutableSource:Sb,useSyncExternalStore:Nb,useId:Mb,unstable_isNewReconciler:!1};function ys(e,t){if(e&&e.defaultProps){t=Er({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ag(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Er({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var hm={isMounted:function(e){return(e=e._reactInternals)?Pl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jn(),i=yo(e),s=ya(n,i);s.payload=t,r!=null&&(s.callback=r),t=xo(e,s,i),t!==null&&(Ts(t,e,i,n),c0(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jn(),i=yo(e),s=ya(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=xo(e,s,i),t!==null&&(Ts(t,e,i,n),c0(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jn(),n=yo(e),i=ya(r,n);i.tag=2,t!=null&&(i.callback=t),t=xo(e,i,n),t!==null&&(Ts(t,e,n,r),c0(t,e,n))}};function $v(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Yf(r,n)||!Yf(i,s):!0}function Wb(e,t,r){var n=!1,i=ko,s=t.contextType;return typeof s=="object"&&s!==null?s=rs(s):(i=hi(t)?wl:Hn.current,n=t.contextTypes,s=(n=n!=null)?Kc(e,i):ko),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=hm,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function qv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&hm.enqueueReplaceState(t,t.state,null)}function og(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},N2(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=rs(s):(s=hi(t)?wl:Hn.current,i.context=Kc(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(ag(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&hm.enqueueReplaceState(i,i.state,null),P0(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Zc(e,t){try{var r="",n=t;do r+=FN(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Yp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function lg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ak=typeof WeakMap=="function"?WeakMap:Map;function Hb(e,t,r){r=ya(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){I0||(I0=!0,vg=n),lg(e,t)},r}function $b(e,t,r){r=ya(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){lg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){lg(e,t),typeof n!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Vv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ak;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=wk.bind(null,e,t,r),t.then(e,e))}function Gv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Yv(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ya(-1,1),t.tag=2,xo(r,t,1))),r.lanes|=1),e)}var ok=Ca.ReactCurrentOwner,fi=!1;function Gn(e,t,r,n){t.child=e===null?yb(t,null,r,n):Jc(t,e.child,r,n)}function Kv(e,t,r,n,i){r=r.render;var s=t.ref;return zc(t,i),n=T2(e,t,r,n,s,i),r=C2(),e!==null&&!fi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ea(e,t,i)):(_r&&r&&x2(t),t.flags|=1,Gn(e,t,n,i),t.child)}function Xv(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!U2(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,qb(e,t,s,n,i)):(e=p0(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Yf,r(a,n)&&e.ref===t.ref)return Ea(e,t,i)}return t.flags|=1,e=wo(s,n),e.ref=t.ref,e.return=t,t.child=e}function qb(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Yf(s,n)&&e.ref===t.ref)if(fi=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(fi=!0);else return t.lanes=e.lanes,Ea(e,t,i)}return cg(e,t,r,n,i)}function Vb(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pr(Oc,Ai),Ai|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,pr(Oc,Ai),Ai|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,pr(Oc,Ai),Ai|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,pr(Oc,Ai),Ai|=n;return Gn(e,t,i,r),t.child}function Gb(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function cg(e,t,r,n,i){var s=hi(r)?wl:Hn.current;return s=Kc(t,s),zc(t,i),r=T2(e,t,r,n,s,i),n=C2(),e!==null&&!fi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ea(e,t,i)):(_r&&n&&x2(t),t.flags|=1,Gn(e,t,r,i),t.child)}function Jv(e,t,r,n,i){if(hi(r)){var s=!0;E0(t)}else s=!1;if(zc(t,i),t.stateNode===null)d0(e,t),Wb(t,r,n),og(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=rs(u):(u=hi(r)?wl:Hn.current,u=Kc(t,u));var f=r.getDerivedStateFromProps,m=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&qv(t,a,n,u),eo=!1;var p=t.memoizedState;a.state=p,P0(t,n,a,i),l=t.memoizedState,o!==n||p!==l||di.current||eo?(typeof f=="function"&&(ag(t,r,f,n),l=t.memoizedState),(o=eo||$v(t,r,o,n,p,l,u))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,bb(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ys(t.type,o),a.props=u,m=t.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=rs(l):(l=hi(r)?wl:Hn.current,l=Kc(t,l));var h=r.getDerivedStateFromProps;(f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==m||p!==l)&&qv(t,a,n,l),eo=!1,p=t.memoizedState,a.state=p,P0(t,n,a,i);var v=t.memoizedState;o!==m||p!==v||di.current||eo?(typeof h=="function"&&(ag(t,r,h,n),v=t.memoizedState),(u=eo||$v(t,r,u,n,p,v,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),a.props=n,a.state=v,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return ug(e,t,r,n,s,i)}function ug(e,t,r,n,i,s){Gb(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&Iv(t,r,!1),Ea(e,t,s);n=t.stateNode,ok.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Jc(t,e.child,null,s),t.child=Jc(t,null,o,s)):Gn(e,t,o,s),t.memoizedState=n.state,i&&Iv(t,r,!0),t.child}function Yb(e){var t=e.stateNode;t.pendingContext?Dv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Dv(e,t.context,!1),k2(e,t.containerInfo)}function Qv(e,t,r,n,i){return Xc(),y2(i),t.flags|=256,Gn(e,t,r,n),t.child}var fg={dehydrated:null,treeContext:null,retryLane:0};function dg(e){return{baseLanes:e,cachePool:null,transitions:null}}function Kb(e,t,r){var n=t.pendingProps,i=Nr.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),pr(Nr,i&1),e===null)return ig(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=gm(a,n,0,null),e=fl(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=dg(r),t.memoizedState=fg,e):F2(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lk(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=wo(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=wo(o,s):(s=fl(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?dg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=fg,n}return s=e.child,e=s.sibling,n=wo(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function F2(e,t){return t=gm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Oh(e,t,r,n){return n!==null&&y2(n),Jc(t,e.child,null,r),e=F2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lk(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Yp(Error(qe(422))),Oh(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=gm({mode:"visible",children:n.children},i,0,null),s=fl(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Jc(t,e.child,null,a),t.child.memoizedState=dg(a),t.memoizedState=fg,s);if(!(t.mode&1))return Oh(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(qe(419)),n=Yp(s,n,void 0),Oh(e,t,a,n)}if(o=(a&e.childLanes)!==0,fi||o){if(n=xn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ka(e,i),Ts(n,e,i,-1))}return B2(),n=Yp(Error(qe(421))),Oh(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=bk.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Li=go(i.nextSibling),Oi=t,_r=!0,Ss=null,e!==null&&(Qi[Zi++]=xa,Qi[Zi++]=va,Qi[Zi++]=bl,xa=e.id,va=e.overflow,bl=t),t=F2(t,n.children),t.flags|=4096,t)}function Zv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),sg(e.return,t,r)}function Kp(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Xb(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Gn(e,t,n.children,r),n=Nr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zv(e,r,t);else if(e.tag===19)Zv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(pr(Nr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&L0(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Kp(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&L0(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Kp(t,!0,r,null,s);break;case"together":Kp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function d0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ea(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(qe(153));if(t.child!==null){for(e=t.child,r=wo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=wo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ck(e,t,r){switch(t.tag){case 3:Yb(t),Xc();break;case 5:_b(t);break;case 1:hi(t.type)&&E0(t);break;case 4:k2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;pr(T0,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(pr(Nr,Nr.current&1),t.flags|=128,null):r&t.child.childLanes?Kb(e,t,r):(pr(Nr,Nr.current&1),e=Ea(e,t,r),e!==null?e.sibling:null);pr(Nr,Nr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Xb(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),pr(Nr,Nr.current),n)break;return null;case 22:case 23:return t.lanes=0,Vb(e,t,r)}return Ea(e,t,r)}var Jb,hg,Qb,Zb;Jb=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};hg=function(){};Qb=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ll(Xs.current);var s=null;switch(r){case"input":i=D1(e,i),n=D1(e,n),s=[];break;case"select":i=Er({},i,{value:void 0}),n=Er({},n,{value:void 0}),s=[];break;case"textarea":i=M1(e,i),n=M1(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=N0)}U1(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(zf.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(zf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&xr("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};Zb=function(e,t,r,n){r!==n&&(t.flags|=4)};function ef(e,t){if(!_r)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function On(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function uk(e,t,r){var n=t.pendingProps;switch(v2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(t),null;case 1:return hi(t.type)&&k0(),On(t),null;case 3:return n=t.stateNode,Qc(),yr(di),yr(Hn),j2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Lh(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ss!==null&&(bg(Ss),Ss=null))),hg(e,t),On(t),null;case 5:E2(t);var i=ll(Zf.current);if(r=t.type,e!==null&&t.stateNode!=null)Qb(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(qe(166));return On(t),null}if(e=ll(Xs.current),Lh(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Gs]=t,n[Jf]=s,e=(t.mode&1)!==0,r){case"dialog":xr("cancel",n),xr("close",n);break;case"iframe":case"object":case"embed":xr("load",n);break;case"video":case"audio":for(i=0;i<mf.length;i++)xr(mf[i],n);break;case"source":xr("error",n);break;case"img":case"image":case"link":xr("error",n),xr("load",n);break;case"details":xr("toggle",n);break;case"input":lv(n,s),xr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},xr("invalid",n);break;case"textarea":uv(n,s),xr("invalid",n)}U1(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ph(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ph(n.textContent,o,e),i=["children",""+o]):zf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&xr("scroll",n)}switch(r){case"input":Sh(n),cv(n,s,!0);break;case"textarea":Sh(n),fv(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=N0)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=jw(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Gs]=t,e[Jf]=n,Jb(e,t,!1,!1),t.stateNode=e;e:{switch(a=z1(r,n),r){case"dialog":xr("cancel",e),xr("close",e),i=n;break;case"iframe":case"object":case"embed":xr("load",e),i=n;break;case"video":case"audio":for(i=0;i<mf.length;i++)xr(mf[i],e);i=n;break;case"source":xr("error",e),i=n;break;case"img":case"image":case"link":xr("error",e),xr("load",e),i=n;break;case"details":xr("toggle",e),i=n;break;case"input":lv(e,n),i=D1(e,n),xr("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Er({},n,{value:void 0}),xr("invalid",e);break;case"textarea":uv(e,n),i=M1(e,n),xr("invalid",e);break;default:i=n}U1(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Cw(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Aw(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Wf(e,l):typeof l=="number"&&Wf(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(zf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&xr("scroll",e):l!=null&&n2(e,s,l,a))}switch(r){case"input":Sh(e),cv(e,n,!1);break;case"textarea":Sh(e),fv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+No(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Rc(e,!!n.multiple,s,!1):n.defaultValue!=null&&Rc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=N0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return On(t),null;case 6:if(e&&t.stateNode!=null)Zb(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(qe(166));if(r=ll(Zf.current),ll(Xs.current),Lh(t)){if(n=t.stateNode,r=t.memoizedProps,n[Gs]=t,(s=n.nodeValue!==r)&&(e=Oi,e!==null))switch(e.tag){case 3:Ph(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ph(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gs]=t,t.stateNode=n}return On(t),null;case 13:if(yr(Nr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_r&&Li!==null&&t.mode&1&&!(t.flags&128))xb(),Xc(),t.flags|=98560,s=!1;else if(s=Lh(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(qe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(qe(317));s[Gs]=t}else Xc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;On(t),s=!1}else Ss!==null&&(bg(Ss),Ss=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Nr.current&1?on===0&&(on=3):B2())),t.updateQueue!==null&&(t.flags|=4),On(t),null);case 4:return Qc(),hg(e,t),e===null&&Kf(t.stateNode.containerInfo),On(t),null;case 10:return _2(t.type._context),On(t),null;case 17:return hi(t.type)&&k0(),On(t),null;case 19:if(yr(Nr),s=t.memoizedState,s===null)return On(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)ef(s,!1);else{if(on!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=L0(e),a!==null){for(t.flags|=128,ef(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return pr(Nr,Nr.current&1|2),t.child}e=e.sibling}s.tail!==null&&Br()>eu&&(t.flags|=128,n=!0,ef(s,!1),t.lanes=4194304)}else{if(!n)if(e=L0(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ef(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!_r)return On(t),null}else 2*Br()-s.renderingStartTime>eu&&r!==1073741824&&(t.flags|=128,n=!0,ef(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Br(),t.sibling=null,r=Nr.current,pr(Nr,n?r&1|2:r&1),t):(On(t),null);case 22:case 23:return M2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ai&1073741824&&(On(t),t.subtreeFlags&6&&(t.flags|=8192)):On(t),null;case 24:return null;case 25:return null}throw Error(qe(156,t.tag))}function fk(e,t){switch(v2(t),t.tag){case 1:return hi(t.type)&&k0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qc(),yr(di),yr(Hn),j2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return E2(t),null;case 13:if(yr(Nr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(qe(340));Xc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yr(Nr),null;case 4:return Qc(),null;case 10:return _2(t.type._context),null;case 22:case 23:return M2(),null;case 24:return null;default:return null}}var Dh=!1,Bn=!1,dk=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Fc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Pr(e,t,n)}else r.current=null}function mg(e,t,r){try{r()}catch(n){Pr(e,t,n)}}var ey=!1;function hk(e,t){if(J1=b0,e=ib(),g2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,m=e,p=null;t:for(;;){for(var h;m!==r||i!==0&&m.nodeType!==3||(o=a+i),m!==s||n!==0&&m.nodeType!==3||(l=a+n),m.nodeType===3&&(a+=m.nodeValue.length),(h=m.firstChild)!==null;)p=m,m=h;for(;;){if(m===e)break t;if(p===r&&++u===i&&(o=a),p===s&&++f===n&&(l=a),(h=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Q1={focusedElem:e,selectionRange:r},b0=!1,ct=t;ct!==null;)if(t=ct,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ct=e;else for(;ct!==null;){t=ct;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,b=v.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ys(t.type,g),b);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch(j){Pr(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,ct=e;break}ct=t.return}return v=ey,ey=!1,v}function Nf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&mg(t,r,s)}i=i.next}while(i!==n)}}function mm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function pg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function e4(e){var t=e.alternate;t!==null&&(e.alternate=null,e4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gs],delete t[Jf],delete t[tg],delete t[K6],delete t[X6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function t4(e){return e.tag===5||e.tag===3||e.tag===4}function ty(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||t4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=N0));else if(n!==4&&(e=e.child,e!==null))for(gg(e,t,r),e=e.sibling;e!==null;)gg(e,t,r),e=e.sibling}function xg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(xg(e,t,r),e=e.sibling;e!==null;)xg(e,t,r),e=e.sibling}var _n=null,bs=!1;function Va(e,t,r){for(r=r.child;r!==null;)r4(e,t,r),r=r.sibling}function r4(e,t,r){if(Ks&&typeof Ks.onCommitFiberUnmount=="function")try{Ks.onCommitFiberUnmount(am,r)}catch{}switch(r.tag){case 5:Bn||Fc(r,t);case 6:var n=_n,i=bs;_n=null,Va(e,t,r),_n=n,bs=i,_n!==null&&(bs?(e=_n,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):_n.removeChild(r.stateNode));break;case 18:_n!==null&&(bs?(e=_n,r=r.stateNode,e.nodeType===8?Wp(e.parentNode,r):e.nodeType===1&&Wp(e,r),Vf(e)):Wp(_n,r.stateNode));break;case 4:n=_n,i=bs,_n=r.stateNode.containerInfo,bs=!0,Va(e,t,r),_n=n,bs=i;break;case 0:case 11:case 14:case 15:if(!Bn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&mg(r,t,a),i=i.next}while(i!==n)}Va(e,t,r);break;case 1:if(!Bn&&(Fc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Pr(r,t,o)}Va(e,t,r);break;case 21:Va(e,t,r);break;case 22:r.mode&1?(Bn=(n=Bn)||r.memoizedState!==null,Va(e,t,r),Bn=n):Va(e,t,r);break;default:Va(e,t,r)}}function ry(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new dk),t.forEach(function(n){var i=_k.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ms(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:_n=o.stateNode,bs=!1;break e;case 3:_n=o.stateNode.containerInfo,bs=!0;break e;case 4:_n=o.stateNode.containerInfo,bs=!0;break e}o=o.return}if(_n===null)throw Error(qe(160));r4(s,a,i),_n=null,bs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Pr(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)n4(t,e),t=t.sibling}function n4(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ms(t,e),zs(e),n&4){try{Nf(3,e,e.return),mm(3,e)}catch(g){Pr(e,e.return,g)}try{Nf(5,e,e.return)}catch(g){Pr(e,e.return,g)}}break;case 1:ms(t,e),zs(e),n&512&&r!==null&&Fc(r,r.return);break;case 5:if(ms(t,e),zs(e),n&512&&r!==null&&Fc(r,r.return),e.flags&32){var i=e.stateNode;try{Wf(i,"")}catch(g){Pr(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&kw(i,s),z1(o,a);var u=z1(o,s);for(a=0;a<l.length;a+=2){var f=l[a],m=l[a+1];f==="style"?Cw(i,m):f==="dangerouslySetInnerHTML"?Aw(i,m):f==="children"?Wf(i,m):n2(i,f,m,u)}switch(o){case"input":I1(i,s);break;case"textarea":Ew(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Rc(i,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?Rc(i,!!s.multiple,s.defaultValue,!0):Rc(i,!!s.multiple,s.multiple?[]:"",!1))}i[Jf]=s}catch(g){Pr(e,e.return,g)}}break;case 6:if(ms(t,e),zs(e),n&4){if(e.stateNode===null)throw Error(qe(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Pr(e,e.return,g)}}break;case 3:if(ms(t,e),zs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vf(t.containerInfo)}catch(g){Pr(e,e.return,g)}break;case 4:ms(t,e),zs(e);break;case 13:ms(t,e),zs(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(I2=Br())),n&4&&ry(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Bn=(u=Bn)||f,ms(t,e),Bn=u):ms(t,e),zs(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(ct=e,f=e.child;f!==null;){for(m=ct=f;ct!==null;){switch(p=ct,h=p.child,p.tag){case 0:case 11:case 14:case 15:Nf(4,p,p.return);break;case 1:Fc(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Pr(n,r,g)}}break;case 5:Fc(p,p.return);break;case 22:if(p.memoizedState!==null){iy(m);continue}}h!==null?(h.return=p,ct=h):iy(m)}f=f.sibling}e:for(f=null,m=e;;){if(m.tag===5){if(f===null){f=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=m.stateNode,l=m.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Tw("display",a))}catch(g){Pr(e,e.return,g)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(g){Pr(e,e.return,g)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:ms(t,e),zs(e),n&4&&ry(e);break;case 21:break;default:ms(t,e),zs(e)}}function zs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(t4(r)){var n=r;break e}r=r.return}throw Error(qe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Wf(i,""),n.flags&=-33);var s=ty(e);xg(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=ty(e);gg(e,o,a);break;default:throw Error(qe(161))}}catch(l){Pr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mk(e,t,r){ct=e,i4(e)}function i4(e,t,r){for(var n=(e.mode&1)!==0;ct!==null;){var i=ct,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Dh;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Bn;o=Dh;var u=Bn;if(Dh=a,(Bn=l)&&!u)for(ct=i;ct!==null;)a=ct,l=a.child,a.tag===22&&a.memoizedState!==null?sy(i):l!==null?(l.return=a,ct=l):sy(i);for(;s!==null;)ct=s,i4(s),s=s.sibling;ct=i,Dh=o,Bn=u}ny(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ct=s):ny(e)}}function ny(e){for(;ct!==null;){var t=ct;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Bn||mm(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Bn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ys(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&zv(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}zv(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&Vf(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}Bn||t.flags&512&&pg(t)}catch(p){Pr(t,t.return,p)}}if(t===e){ct=null;break}if(r=t.sibling,r!==null){r.return=t.return,ct=r;break}ct=t.return}}function iy(e){for(;ct!==null;){var t=ct;if(t===e){ct=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ct=r;break}ct=t.return}}function sy(e){for(;ct!==null;){var t=ct;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{mm(4,t)}catch(l){Pr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Pr(t,i,l)}}var s=t.return;try{pg(t)}catch(l){Pr(t,s,l)}break;case 5:var a=t.return;try{pg(t)}catch(l){Pr(t,a,l)}}}catch(l){Pr(t,t.return,l)}if(t===e){ct=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ct=o;break}ct=t.return}}var pk=Math.ceil,D0=Ca.ReactCurrentDispatcher,O2=Ca.ReactCurrentOwner,ts=Ca.ReactCurrentBatchConfig,Wt=0,xn=null,Xr=null,En=0,Ai=0,Oc=Do(0),on=0,nd=null,Sl=0,pm=0,D2=0,kf=null,ci=null,I2=0,eu=1/0,ma=null,I0=!1,vg=null,vo=null,Ih=!1,oo=null,R0=0,Ef=0,yg=null,h0=-1,m0=0;function Jn(){return Wt&6?Br():h0!==-1?h0:h0=Br()}function yo(e){return e.mode&1?Wt&2&&En!==0?En&-En:Q6.transition!==null?(m0===0&&(m0=Ww()),m0):(e=nr,e!==0||(e=window.event,e=e===void 0?16:Kw(e.type)),e):1}function Ts(e,t,r,n){if(50<Ef)throw Ef=0,yg=null,Error(qe(185));wd(e,r,n),(!(Wt&2)||e!==xn)&&(e===xn&&(!(Wt&2)&&(pm|=r),on===4&&no(e,En)),mi(e,n),r===1&&Wt===0&&!(t.mode&1)&&(eu=Br()+500,fm&&Io()))}function mi(e,t){var r=e.callbackNode;QN(e,t);var n=w0(e,e===xn?En:0);if(n===0)r!==null&&mv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&mv(r),t===1)e.tag===0?J6(ay.bind(null,e)):mb(ay.bind(null,e)),G6(function(){!(Wt&6)&&Io()}),r=null;else{switch(Hw(n)){case 1:r=l2;break;case 4:r=Uw;break;case 16:r=y0;break;case 536870912:r=zw;break;default:r=y0}r=d4(r,s4.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function s4(e,t){if(h0=-1,m0=0,Wt&6)throw Error(qe(327));var r=e.callbackNode;if(Wc()&&e.callbackNode!==r)return null;var n=w0(e,e===xn?En:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=M0(e,n);else{t=n;var i=Wt;Wt|=2;var s=o4();(xn!==e||En!==t)&&(ma=null,eu=Br()+500,ul(e,t));do try{vk();break}catch(o){a4(e,o)}while(!0);b2(),D0.current=s,Wt=i,Xr!==null?t=0:(xn=null,En=0,t=on)}if(t!==0){if(t===2&&(i=V1(e),i!==0&&(n=i,t=wg(e,i))),t===1)throw r=nd,ul(e,0),no(e,n),mi(e,Br()),r;if(t===6)no(e,n);else{if(i=e.current.alternate,!(n&30)&&!gk(i)&&(t=M0(e,n),t===2&&(s=V1(e),s!==0&&(n=s,t=wg(e,s))),t===1))throw r=nd,ul(e,0),no(e,n),mi(e,Br()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(qe(345));case 2:el(e,ci,ma);break;case 3:if(no(e,n),(n&130023424)===n&&(t=I2+500-Br(),10<t)){if(w0(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Jn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=eg(el.bind(null,e,ci,ma),t);break}el(e,ci,ma);break;case 4:if(no(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-As(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Br()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*pk(n/1960))-n,10<n){e.timeoutHandle=eg(el.bind(null,e,ci,ma),n);break}el(e,ci,ma);break;case 5:el(e,ci,ma);break;default:throw Error(qe(329))}}}return mi(e,Br()),e.callbackNode===r?s4.bind(null,e):null}function wg(e,t){var r=kf;return e.current.memoizedState.isDehydrated&&(ul(e,t).flags|=256),e=M0(e,t),e!==2&&(t=ci,ci=r,t!==null&&bg(t)),e}function bg(e){ci===null?ci=e:ci.push.apply(ci,e)}function gk(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Ps(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function no(e,t){for(t&=~D2,t&=~pm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-As(t),n=1<<r;e[r]=-1,t&=~n}}function ay(e){if(Wt&6)throw Error(qe(327));Wc();var t=w0(e,0);if(!(t&1))return mi(e,Br()),null;var r=M0(e,t);if(e.tag!==0&&r===2){var n=V1(e);n!==0&&(t=n,r=wg(e,n))}if(r===1)throw r=nd,ul(e,0),no(e,t),mi(e,Br()),r;if(r===6)throw Error(qe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,el(e,ci,ma),mi(e,Br()),null}function R2(e,t){var r=Wt;Wt|=1;try{return e(t)}finally{Wt=r,Wt===0&&(eu=Br()+500,fm&&Io())}}function Nl(e){oo!==null&&oo.tag===0&&!(Wt&6)&&Wc();var t=Wt;Wt|=1;var r=ts.transition,n=nr;try{if(ts.transition=null,nr=1,e)return e()}finally{nr=n,ts.transition=r,Wt=t,!(Wt&6)&&Io()}}function M2(){Ai=Oc.current,yr(Oc)}function ul(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,V6(r)),Xr!==null)for(r=Xr.return;r!==null;){var n=r;switch(v2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&k0();break;case 3:Qc(),yr(di),yr(Hn),j2();break;case 5:E2(n);break;case 4:Qc();break;case 13:yr(Nr);break;case 19:yr(Nr);break;case 10:_2(n.type._context);break;case 22:case 23:M2()}r=r.return}if(xn=e,Xr=e=wo(e.current,null),En=Ai=t,on=0,nd=null,D2=pm=Sl=0,ci=kf=null,ol!==null){for(t=0;t<ol.length;t++)if(r=ol[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ol=null}return e}function a4(e,t){do{var r=Xr;try{if(b2(),u0.current=O0,F0){for(var n=kr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}F0=!1}if(_l=0,dn=sn=kr=null,Sf=!1,ed=0,O2.current=null,r===null||r.return===null){on=1,nd=t,Xr=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=En,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=Gv(a);if(h!==null){h.flags&=-257,Yv(h,a,o,s,t),h.mode&1&&Vv(s,u,t),t=h,l=u;var v=t.updateQueue;if(v===null){var g=new Set;g.add(l),t.updateQueue=g}else v.add(l);break e}else{if(!(t&1)){Vv(s,u,t),B2();break e}l=Error(qe(426))}}else if(_r&&o.mode&1){var b=Gv(a);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Yv(b,a,o,s,t),y2(Zc(l,o));break e}}s=l=Zc(l,o),on!==4&&(on=2),kf===null?kf=[s]:kf.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=Hb(s,l,t);Uv(s,y);break e;case 1:o=l;var w=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(vo===null||!vo.has(_)))){s.flags|=65536,t&=-t,s.lanes|=t;var j=$b(s,o,t);Uv(s,j);break e}}s=s.return}while(s!==null)}c4(r)}catch(O){t=O,Xr===r&&r!==null&&(Xr=r=r.return);continue}break}while(!0)}function o4(){var e=D0.current;return D0.current=O0,e===null?O0:e}function B2(){(on===0||on===3||on===2)&&(on=4),xn===null||!(Sl&268435455)&&!(pm&268435455)||no(xn,En)}function M0(e,t){var r=Wt;Wt|=2;var n=o4();(xn!==e||En!==t)&&(ma=null,ul(e,t));do try{xk();break}catch(i){a4(e,i)}while(!0);if(b2(),Wt=r,D0.current=n,Xr!==null)throw Error(qe(261));return xn=null,En=0,on}function xk(){for(;Xr!==null;)l4(Xr)}function vk(){for(;Xr!==null&&!HN();)l4(Xr)}function l4(e){var t=f4(e.alternate,e,Ai);e.memoizedProps=e.pendingProps,t===null?c4(e):Xr=t,O2.current=null}function c4(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fk(r,t),r!==null){r.flags&=32767,Xr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{on=6,Xr=null;return}}else if(r=uk(r,t,Ai),r!==null){Xr=r;return}if(t=t.sibling,t!==null){Xr=t;return}Xr=t=e}while(t!==null);on===0&&(on=5)}function el(e,t,r){var n=nr,i=ts.transition;try{ts.transition=null,nr=1,yk(e,t,r,n)}finally{ts.transition=i,nr=n}return null}function yk(e,t,r,n){do Wc();while(oo!==null);if(Wt&6)throw Error(qe(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(qe(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(ZN(e,s),e===xn&&(Xr=xn=null,En=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ih||(Ih=!0,d4(y0,function(){return Wc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ts.transition,ts.transition=null;var a=nr;nr=1;var o=Wt;Wt|=4,O2.current=null,hk(e,r),n4(r,e),B6(Q1),b0=!!J1,Q1=J1=null,e.current=r,mk(r),$N(),Wt=o,nr=a,ts.transition=s}else e.current=r;if(Ih&&(Ih=!1,oo=e,R0=i),s=e.pendingLanes,s===0&&(vo=null),GN(r.stateNode),mi(e,Br()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(I0)throw I0=!1,e=vg,vg=null,e;return R0&1&&e.tag!==0&&Wc(),s=e.pendingLanes,s&1?e===yg?Ef++:(Ef=0,yg=e):Ef=0,Io(),null}function Wc(){if(oo!==null){var e=Hw(R0),t=ts.transition,r=nr;try{if(ts.transition=null,nr=16>e?16:e,oo===null)var n=!1;else{if(e=oo,oo=null,R0=0,Wt&6)throw Error(qe(331));var i=Wt;for(Wt|=4,ct=e.current;ct!==null;){var s=ct,a=s.child;if(ct.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ct=u;ct!==null;){var f=ct;switch(f.tag){case 0:case 11:case 15:Nf(8,f,s)}var m=f.child;if(m!==null)m.return=f,ct=m;else for(;ct!==null;){f=ct;var p=f.sibling,h=f.return;if(e4(f),f===u){ct=null;break}if(p!==null){p.return=h,ct=p;break}ct=h}}}var v=s.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(g!==null)}}ct=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ct=a;else e:for(;ct!==null;){if(s=ct,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Nf(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,ct=y;break e}ct=s.return}}var w=e.current;for(ct=w;ct!==null;){a=ct;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,ct=_;else e:for(a=w;ct!==null;){if(o=ct,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:mm(9,o)}}catch(O){Pr(o,o.return,O)}if(o===a){ct=null;break e}var j=o.sibling;if(j!==null){j.return=o.return,ct=j;break e}ct=o.return}}if(Wt=i,Io(),Ks&&typeof Ks.onPostCommitFiberRoot=="function")try{Ks.onPostCommitFiberRoot(am,e)}catch{}n=!0}return n}finally{nr=r,ts.transition=t}}return!1}function oy(e,t,r){t=Zc(r,t),t=Hb(e,t,1),e=xo(e,t,1),t=Jn(),e!==null&&(wd(e,1,t),mi(e,t))}function Pr(e,t,r){if(e.tag===3)oy(e,e,r);else for(;t!==null;){if(t.tag===3){oy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(vo===null||!vo.has(n))){e=Zc(r,e),e=$b(t,e,1),t=xo(t,e,1),e=Jn(),t!==null&&(wd(t,1,e),mi(t,e));break}}t=t.return}}function wk(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jn(),e.pingedLanes|=e.suspendedLanes&r,xn===e&&(En&r)===r&&(on===4||on===3&&(En&130023424)===En&&500>Br()-I2?ul(e,0):D2|=r),mi(e,t)}function u4(e,t){t===0&&(e.mode&1?(t=Eh,Eh<<=1,!(Eh&130023424)&&(Eh=4194304)):t=1);var r=Jn();e=ka(e,t),e!==null&&(wd(e,t,r),mi(e,r))}function bk(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),u4(e,r)}function _k(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(qe(314))}n!==null&&n.delete(t),u4(e,r)}var f4;f4=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||di.current)fi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return fi=!1,ck(e,t,r);fi=!!(e.flags&131072)}else fi=!1,_r&&t.flags&1048576&&pb(t,A0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;d0(e,t),e=t.pendingProps;var i=Kc(t,Hn.current);zc(t,r),i=T2(null,t,n,e,i,r);var s=C2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,hi(n)?(s=!0,E0(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,N2(t),i.updater=hm,t.stateNode=i,i._reactInternals=t,og(t,n,e,r),t=ug(null,t,n,!0,s,r)):(t.tag=0,_r&&s&&x2(t),Gn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(d0(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Nk(n),e=ys(n,e),i){case 0:t=cg(null,t,n,e,r);break e;case 1:t=Jv(null,t,n,e,r);break e;case 11:t=Kv(null,t,n,e,r);break e;case 14:t=Xv(null,t,n,ys(n.type,e),r);break e}throw Error(qe(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),cg(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),Jv(e,t,n,i,r);case 3:e:{if(Yb(t),e===null)throw Error(qe(387));n=t.pendingProps,s=t.memoizedState,i=s.element,bb(e,t),P0(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Zc(Error(qe(423)),t),t=Qv(e,t,n,r,i);break e}else if(n!==i){i=Zc(Error(qe(424)),t),t=Qv(e,t,n,r,i);break e}else for(Li=go(t.stateNode.containerInfo.firstChild),Oi=t,_r=!0,Ss=null,r=yb(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xc(),n===i){t=Ea(e,t,r);break e}Gn(e,t,n,r)}t=t.child}return t;case 5:return _b(t),e===null&&ig(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Z1(n,i)?a=null:s!==null&&Z1(n,s)&&(t.flags|=32),Gb(e,t),Gn(e,t,a,r),t.child;case 6:return e===null&&ig(t),null;case 13:return Kb(e,t,r);case 4:return k2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Jc(t,null,n,r):Gn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),Kv(e,t,n,i,r);case 7:return Gn(e,t,t.pendingProps,r),t.child;case 8:return Gn(e,t,t.pendingProps.children,r),t.child;case 12:return Gn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,pr(T0,n._currentValue),n._currentValue=a,s!==null)if(Ps(s.value,a)){if(s.children===i.children&&!di.current){t=Ea(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ya(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),sg(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(qe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),sg(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Gn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,zc(t,r),i=rs(i),n=n(i),t.flags|=1,Gn(e,t,n,r),t.child;case 14:return n=t.type,i=ys(n,t.pendingProps),i=ys(n.type,i),Xv(e,t,n,i,r);case 15:return qb(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),d0(e,t),t.tag=1,hi(n)?(e=!0,E0(t)):e=!1,zc(t,r),Wb(t,n,i),og(t,n,i,r),ug(null,t,n,!0,e,r);case 19:return Xb(e,t,r);case 22:return Vb(e,t,r)}throw Error(qe(156,t.tag))};function d4(e,t){return Bw(e,t)}function Sk(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function es(e,t,r,n){return new Sk(e,t,r,n)}function U2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Nk(e){if(typeof e=="function")return U2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===s2)return 11;if(e===a2)return 14}return 2}function wo(e,t){var r=e.alternate;return r===null?(r=es(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function p0(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")U2(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Nc:return fl(r.children,i,s,t);case i2:a=8,i|=8;break;case P1:return e=es(12,r,t,i|2),e.elementType=P1,e.lanes=s,e;case L1:return e=es(13,r,t,i),e.elementType=L1,e.lanes=s,e;case F1:return e=es(19,r,t,i),e.elementType=F1,e.lanes=s,e;case _w:return gm(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ww:a=10;break e;case bw:a=9;break e;case s2:a=11;break e;case a2:a=14;break e;case Za:a=16,n=null;break e}throw Error(qe(130,e==null?e:typeof e,""))}return t=es(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function fl(e,t,r,n){return e=es(7,e,n,t),e.lanes=r,e}function gm(e,t,r,n){return e=es(22,e,n,t),e.elementType=_w,e.lanes=r,e.stateNode={isHidden:!1},e}function Xp(e,t,r){return e=es(6,e,null,t),e.lanes=r,e}function Jp(e,t,r){return t=es(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function kk(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pp(0),this.expirationTimes=Pp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function z2(e,t,r,n,i,s,a,o,l){return e=new kk(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=es(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},N2(s),e}function Ek(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sc,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function h4(e){if(!e)return ko;e=e._reactInternals;e:{if(Pl(e)!==e||e.tag!==1)throw Error(qe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(hi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(qe(171))}if(e.tag===1){var r=e.type;if(hi(r))return hb(e,r,t)}return t}function m4(e,t,r,n,i,s,a,o,l){return e=z2(r,n,!0,e,i,s,a,o,l),e.context=h4(null),r=e.current,n=Jn(),i=yo(r),s=ya(n,i),s.callback=t??null,xo(r,s,i),e.current.lanes=i,wd(e,i,n),mi(e,n),e}function xm(e,t,r,n){var i=t.current,s=Jn(),a=yo(i);return r=h4(r),t.context===null?t.context=r:t.pendingContext=r,t=ya(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=xo(i,t,a),e!==null&&(Ts(e,i,a,s),c0(e,i,a)),a}function B0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ly(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function W2(e,t){ly(e,t),(e=e.alternate)&&ly(e,t)}function jk(){return null}var p4=typeof reportError=="function"?reportError:function(e){console.error(e)};function H2(e){this._internalRoot=e}vm.prototype.render=H2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(qe(409));xm(e,t,null,null)};vm.prototype.unmount=H2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nl(function(){xm(null,e,null,null)}),t[Na]=null}};function vm(e){this._internalRoot=e}vm.prototype.unstable_scheduleHydration=function(e){if(e){var t=Vw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ro.length&&t!==0&&t<ro[r].priority;r++);ro.splice(r,0,e),r===0&&Yw(e)}};function $2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ym(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cy(){}function Ak(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=B0(a);s.call(u)}}var a=m4(t,n,e,0,null,!1,!1,"",cy);return e._reactRootContainer=a,e[Na]=a.current,Kf(e.nodeType===8?e.parentNode:e),Nl(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=B0(l);o.call(u)}}var l=z2(e,0,!1,null,null,!1,!1,"",cy);return e._reactRootContainer=l,e[Na]=l.current,Kf(e.nodeType===8?e.parentNode:e),Nl(function(){xm(t,l,r,n)}),l}function wm(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=B0(a);o.call(l)}}xm(t,a,e,i)}else a=Ak(r,t,e,i,n);return B0(a)}$w=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=hf(t.pendingLanes);r!==0&&(c2(t,r|1),mi(t,Br()),!(Wt&6)&&(eu=Br()+500,Io()))}break;case 13:Nl(function(){var n=ka(e,1);if(n!==null){var i=Jn();Ts(n,e,1,i)}}),W2(e,1)}};u2=function(e){if(e.tag===13){var t=ka(e,134217728);if(t!==null){var r=Jn();Ts(t,e,134217728,r)}W2(e,134217728)}};qw=function(e){if(e.tag===13){var t=yo(e),r=ka(e,t);if(r!==null){var n=Jn();Ts(r,e,t,n)}W2(e,t)}};Vw=function(){return nr};Gw=function(e,t){var r=nr;try{return nr=e,t()}finally{nr=r}};H1=function(e,t,r){switch(t){case"input":if(I1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=um(n);if(!i)throw Error(qe(90));Nw(n),I1(n,i)}}}break;case"textarea":Ew(e,r);break;case"select":t=r.value,t!=null&&Rc(e,!!r.multiple,t,!1)}};Fw=R2;Ow=Nl;var Tk={usingClientEntryPoint:!1,Events:[_d,Ac,um,Pw,Lw,R2]},tf={findFiberByHostInstance:al,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ck={bundleType:tf.bundleType,version:tf.version,rendererPackageName:tf.rendererPackageName,rendererConfig:tf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ca.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Rw(e),e===null?null:e.stateNode},findFiberByHostInstance:tf.findFiberByHostInstance||jk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rh.isDisabled&&Rh.supportsFiber)try{am=Rh.inject(Ck),Ks=Rh}catch{}}Mi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tk;Mi.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$2(t))throw Error(qe(200));return Ek(e,t,null,r)};Mi.createRoot=function(e,t){if(!$2(e))throw Error(qe(299));var r=!1,n="",i=p4;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=z2(e,1,!1,null,null,r,!1,n,i),e[Na]=t.current,Kf(e.nodeType===8?e.parentNode:e),new H2(t)};Mi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(qe(188)):(e=Object.keys(e).join(","),Error(qe(268,e)));return e=Rw(t),e=e===null?null:e.stateNode,e};Mi.flushSync=function(e){return Nl(e)};Mi.hydrate=function(e,t,r){if(!ym(t))throw Error(qe(200));return wm(null,e,t,!0,r)};Mi.hydrateRoot=function(e,t,r){if(!$2(e))throw Error(qe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=p4;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=m4(t,null,e,1,r??null,i,!1,s,a),e[Na]=t.current,Kf(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new vm(t)};Mi.render=function(e,t,r){if(!ym(t))throw Error(qe(200));return wm(null,e,t,!1,r)};Mi.unmountComponentAtNode=function(e){if(!ym(e))throw Error(qe(40));return e._reactRootContainer?(Nl(function(){wm(null,null,e,!1,function(){e._reactRootContainer=null,e[Na]=null})}),!0):!1};Mi.unstable_batchedUpdates=R2;Mi.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ym(r))throw Error(qe(200));if(e==null||e._reactInternals===void 0)throw Error(qe(38));return wm(e,t,r,!1,n)};Mi.version="18.3.1-next-f1338f8080-20240426";function g4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g4)}catch(e){console.error(e)}}g4(),gw.exports=Mi;var Pk=gw.exports,x4,uy=Pk;x4=uy.createRoot,uy.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function id(){return id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},id.apply(this,arguments)}var lo;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(lo||(lo={}));const fy="popstate";function Lk(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:a,hash:o}=n.location;return _g("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:U0(i)}return Ok(t,r,null,e)}function Hr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function v4(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Fk(){return Math.random().toString(36).substr(2,8)}function dy(e,t){return{usr:e.state,key:e.key,idx:t}}function _g(e,t,r,n){return r===void 0&&(r=null),id({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?lu(t):t,{state:r,key:t&&t.key||n||Fk()})}function U0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function lu(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Ok(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=lo.Pop,l=null,u=f();u==null&&(u=0,a.replaceState(id({},a.state,{idx:u}),""));function f(){return(a.state||{idx:null}).idx}function m(){o=lo.Pop;let b=f(),y=b==null?null:b-u;u=b,l&&l({action:o,location:g.location,delta:y})}function p(b,y){o=lo.Push;let w=_g(g.location,b,y);u=f()+1;let _=dy(w,u),j=g.createHref(w);try{a.pushState(_,"",j)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(j)}s&&l&&l({action:o,location:g.location,delta:1})}function h(b,y){o=lo.Replace;let w=_g(g.location,b,y);u=f();let _=dy(w,u),j=g.createHref(w);a.replaceState(_,"",j),s&&l&&l({action:o,location:g.location,delta:0})}function v(b){let y=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof b=="string"?b:U0(b);return w=w.replace(/ $/,"%20"),Hr(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let g={get action(){return o},get location(){return e(i,a)},listen(b){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(fy,m),l=b,()=>{i.removeEventListener(fy,m),l=null}},createHref(b){return t(i,b)},createURL:v,encodeLocation(b){let y=v(b);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:p,replace:h,go(b){return a.go(b)}};return g}var hy;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(hy||(hy={}));function Dk(e,t,r){return r===void 0&&(r="/"),Ik(e,t,r)}function Ik(e,t,r,n){let i=typeof t=="string"?lu(t):t,s=q2(i.pathname||"/",r);if(s==null)return null;let a=y4(e);Rk(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=Kk(s);o=Vk(a[l],u)}return o}function y4(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Hr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=bo([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(Hr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),y4(s.children,t,f,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:$k(u,s.index),routesMeta:f})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of w4(s.path))i(s,a,l)}),t}function w4(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=w4(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Rk(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:qk(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Mk=/^:[\w-]+$/,Bk=3,Uk=2,zk=1,Wk=10,Hk=-2,my=e=>e==="*";function $k(e,t){let r=e.split("/"),n=r.length;return r.some(my)&&(n+=Hk),t&&(n+=Uk),r.filter(i=>!my(i)).reduce((i,s)=>i+(Mk.test(s)?Bk:s===""?zk:Wk),n)}function qk(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function Vk(e,t,r){let{routesMeta:n}=e,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",m=Gk({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),p=l.route;if(!m)return null;Object.assign(i,m.params),a.push({params:i,pathname:bo([s,m.pathname]),pathnameBase:Zk(bo([s,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(s=bo([s,m.pathnameBase]))}return a}function Gk(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Yk(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,f,m)=>{let{paramName:p,isOptional:h}=f;if(p==="*"){let g=o[m]||"";a=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const v=o[m];return h&&!v?u[p]=void 0:u[p]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:e}}function Yk(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),v4(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function Kk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return v4(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function q2(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Xk(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?lu(e):e;return{pathname:r?r.startsWith("/")?r:Jk(r,t):t,search:eE(n),hash:tE(i)}}function Jk(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Qp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Qk(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function V2(e,t){let r=Qk(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function G2(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=lu(e):(i=id({},e),Hr(!i.pathname||!i.pathname.includes("?"),Qp("?","pathname","search",i)),Hr(!i.pathname||!i.pathname.includes("#"),Qp("#","pathname","hash",i)),Hr(!i.search||!i.search.includes("#"),Qp("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let m=t.length-1;if(!n&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),m-=1;i.pathname=p.join("/")}o=m>=0?t[m]:"/"}let l=Xk(i,o),u=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}const bo=e=>e.join("/").replace(/\/\/+/g,"/"),Zk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),eE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,tE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function rE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const b4=["post","put","patch","delete"];new Set(b4);const nE=["get",...b4];new Set(nE);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sd(){return sd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sd.apply(this,arguments)}const Y2=me.createContext(null),iE=me.createContext(null),Ro=me.createContext(null),bm=me.createContext(null),ea=me.createContext({outlet:null,matches:[],isDataRoute:!1}),_4=me.createContext(null);function sE(e,t){let{relative:r}=t===void 0?{}:t;cu()||Hr(!1);let{basename:n,navigator:i}=me.useContext(Ro),{hash:s,pathname:a,search:o}=N4(e,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:bo([n,a])),i.createHref({pathname:l,search:o,hash:s})}function cu(){return me.useContext(bm)!=null}function uu(){return cu()||Hr(!1),me.useContext(bm).location}function S4(e){me.useContext(Ro).static||me.useLayoutEffect(e)}function fu(){let{isDataRoute:e}=me.useContext(ea);return e?wE():aE()}function aE(){cu()||Hr(!1);let e=me.useContext(Y2),{basename:t,future:r,navigator:n}=me.useContext(Ro),{matches:i}=me.useContext(ea),{pathname:s}=uu(),a=JSON.stringify(V2(i,r.v7_relativeSplatPath)),o=me.useRef(!1);return S4(()=>{o.current=!0}),me.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let m=G2(u,JSON.parse(a),s,f.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:bo([t,m.pathname])),(f.replace?n.replace:n.push)(m,f.state,f)},[t,n,a,s,e])}const oE=me.createContext(null);function lE(e){let t=me.useContext(ea).outlet;return t&&me.createElement(oE.Provider,{value:e},t)}function K2(){let{matches:e}=me.useContext(ea),t=e[e.length-1];return t?t.params:{}}function N4(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=me.useContext(Ro),{matches:i}=me.useContext(ea),{pathname:s}=uu(),a=JSON.stringify(V2(i,n.v7_relativeSplatPath));return me.useMemo(()=>G2(e,JSON.parse(a),s,r==="path"),[e,a,s,r])}function cE(e,t){return uE(e,t)}function uE(e,t,r,n){cu()||Hr(!1);let{navigator:i,static:s}=me.useContext(Ro),{matches:a}=me.useContext(ea),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let f=uu(),m;if(t){var p;let y=typeof t=="string"?lu(t):t;u==="/"||(p=y.pathname)!=null&&p.startsWith(u)||Hr(!1),m=y}else m=f;let h=m.pathname||"/",v=h;if(u!=="/"){let y=u.replace(/^\//,"").split("/");v="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=Dk(e,{pathname:v}),b=pE(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:bo([u,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:bo([u,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,r,n);return t&&b?me.createElement(bm.Provider,{value:{location:sd({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:lo.Pop}},b):b}function fE(){let e=yE(),t=rE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return me.createElement(me.Fragment,null,me.createElement("h2",null,"Unexpected Application Error!"),me.createElement("h3",{style:{fontStyle:"italic"}},t),r?me.createElement("pre",{style:i},r):null,null)}const dE=me.createElement(fE,null);class hE extends me.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?me.createElement(ea.Provider,{value:this.props.routeContext},me.createElement(_4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mE(e){let{routeContext:t,match:r,children:n}=e,i=me.useContext(Y2);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),me.createElement(ea.Provider,{value:t},n)}function pE(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=(i=r)==null?void 0:i.errors;if(o!=null){let f=a.findIndex(m=>m.route.id&&(o==null?void 0:o[m.route.id])!==void 0);f>=0||Hr(!1),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<a.length;f++){let m=a[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:p,errors:h}=r,v=m.route.loader&&p[m.route.id]===void 0&&(!h||h[m.route.id]===void 0);if(m.route.lazy||v){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((f,m,p)=>{let h,v=!1,g=null,b=null;r&&(h=o&&m.route.id?o[m.route.id]:void 0,g=m.route.errorElement||dE,l&&(u<0&&p===0?(bE("route-fallback"),v=!0,b=null):u===p&&(v=!0,b=m.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,p+1)),w=()=>{let _;return h?_=g:v?_=b:m.route.Component?_=me.createElement(m.route.Component,null):m.route.element?_=m.route.element:_=f,me.createElement(mE,{match:m,routeContext:{outlet:f,matches:y,isDataRoute:r!=null},children:_})};return r&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?me.createElement(hE,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var k4=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(k4||{}),E4=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(E4||{});function gE(e){let t=me.useContext(Y2);return t||Hr(!1),t}function xE(e){let t=me.useContext(iE);return t||Hr(!1),t}function vE(e){let t=me.useContext(ea);return t||Hr(!1),t}function j4(e){let t=vE(),r=t.matches[t.matches.length-1];return r.route.id||Hr(!1),r.route.id}function yE(){var e;let t=me.useContext(_4),r=xE(),n=j4();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function wE(){let{router:e}=gE(k4.UseNavigateStable),t=j4(E4.UseNavigateStable),r=me.useRef(!1);return S4(()=>{r.current=!0}),me.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,sd({fromRouteId:t},s)))},[e,t])}const py={};function bE(e,t,r){py[e]||(py[e]=!0)}function _E(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function dl(e){let{to:t,replace:r,state:n,relative:i}=e;cu()||Hr(!1);let{future:s,static:a}=me.useContext(Ro),{matches:o}=me.useContext(ea),{pathname:l}=uu(),u=fu(),f=G2(t,V2(o,s.v7_relativeSplatPath),l,i==="path"),m=JSON.stringify(f);return me.useEffect(()=>u(JSON.parse(m),{replace:r,state:n,relative:i}),[u,m,i,r,n]),null}function SE(e){return lE(e.context)}function br(e){Hr(!1)}function NE(e){let{basename:t="/",children:r=null,location:n,navigationType:i=lo.Pop,navigator:s,static:a=!1,future:o}=e;cu()&&Hr(!1);let l=t.replace(/^\/*/,"/"),u=me.useMemo(()=>({basename:l,navigator:s,static:a,future:sd({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=lu(n));let{pathname:f="/",search:m="",hash:p="",state:h=null,key:v="default"}=n,g=me.useMemo(()=>{let b=q2(f,l);return b==null?null:{location:{pathname:b,search:m,hash:p,state:h,key:v},navigationType:i}},[l,f,m,p,h,v,i]);return g==null?null:me.createElement(Ro.Provider,{value:u},me.createElement(bm.Provider,{children:r,value:g}))}function A4(e){let{children:t,location:r}=e;return cE(Sg(t),r)}new Promise(()=>{});function Sg(e,t){t===void 0&&(t=[]);let r=[];return me.Children.forEach(e,(n,i)=>{if(!me.isValidElement(n))return;let s=[...t,i];if(n.type===me.Fragment){r.push.apply(r,Sg(n.props.children,s));return}n.type!==br&&Hr(!1),!n.props.index||!n.props.children||Hr(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=Sg(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ng(){return Ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ng.apply(this,arguments)}function kE(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function EE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jE(e,t){return e.button===0&&(!t||t==="_self")&&!EE(e)}const AE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],TE="6";try{window.__reactRouterVersion=TE}catch{}const CE="startTransition",gy=wN[CE];function PE(e){let{basename:t,children:r,future:n,window:i}=e,s=me.useRef();s.current==null&&(s.current=Lk({window:i,v5Compat:!0}));let a=s.current,[o,l]=me.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},f=me.useCallback(m=>{u&&gy?gy(()=>l(m)):l(m)},[l,u]);return me.useLayoutEffect(()=>a.listen(f),[a,f]),me.useEffect(()=>_E(n),[n]),me.createElement(NE,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}const LE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",FE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fr=me.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:f,viewTransition:m}=t,p=kE(t,AE),{basename:h}=me.useContext(Ro),v,g=!1;if(typeof u=="string"&&FE.test(u)&&(v=u,LE))try{let _=new URL(window.location.href),j=u.startsWith("//")?new URL(_.protocol+u):new URL(u),O=q2(j.pathname,h);j.origin===_.origin&&O!=null?u=O+j.search+j.hash:g=!0}catch{}let b=sE(u,{relative:i}),y=OE(u,{replace:a,state:o,target:l,preventScrollReset:f,relative:i,viewTransition:m});function w(_){n&&n(_),_.defaultPrevented||y(_)}return me.createElement("a",Ng({},p,{href:v||b,onClick:g||s?n:w,ref:r,target:l}))});var xy;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(xy||(xy={}));var vy;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(vy||(vy={}));function OE(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=t===void 0?{}:t,l=fu(),u=uu(),f=N4(e,{relative:a});return me.useCallback(m=>{if(jE(m,r)){m.preventDefault();let p=n!==void 0?n:U0(u)===U0(f);l(e,{replace:p,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[u,l,f,n,i,r,e,s,a,o])}const DE={},yy=e=>{let t;const r=new Set,n=(f,m)=>{const p=typeof f=="function"?f(t):f;if(!Object.is(p,t)){const h=t;t=m??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(v=>v(t,h))}},i=()=>t,l={setState:n,getState:i,getInitialState:()=>u,subscribe:f=>(r.add(f),()=>r.delete(f)),destroy:()=>{(DE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,i,l);return l},IE=e=>e?yy(e):yy;var T4={exports:{}},C4={},P4={exports:{}},L4={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tu=me;function RE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ME=typeof Object.is=="function"?Object.is:RE,BE=tu.useState,UE=tu.useEffect,zE=tu.useLayoutEffect,WE=tu.useDebugValue;function HE(e,t){var r=t(),n=BE({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return zE(function(){i.value=r,i.getSnapshot=t,Zp(i)&&s({inst:i})},[e,r,t]),UE(function(){return Zp(i)&&s({inst:i}),e(function(){Zp(i)&&s({inst:i})})},[e]),WE(r),r}function Zp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ME(e,r)}catch{return!0}}function $E(e,t){return t()}var qE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$E:HE;L4.useSyncExternalStore=tu.useSyncExternalStore!==void 0?tu.useSyncExternalStore:qE;P4.exports=L4;var VE=P4.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _m=me,GE=VE;function YE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var KE=typeof Object.is=="function"?Object.is:YE,XE=GE.useSyncExternalStore,JE=_m.useRef,QE=_m.useEffect,ZE=_m.useMemo,e8=_m.useDebugValue;C4.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=JE(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=ZE(function(){function l(h){if(!u){if(u=!0,f=h,h=n(h),i!==void 0&&a.hasValue){var v=a.value;if(i(v,h))return m=v}return m=h}if(v=m,KE(f,h))return v;var g=n(h);return i!==void 0&&i(v,g)?(f=h,v):(f=h,m=g)}var u=!1,f,m,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,i]);var o=XE(e,s[0],s[1]);return QE(function(){a.hasValue=!0,a.value=o},[o]),e8(o),o};T4.exports=C4;var t8=T4.exports;const r8=Xg(t8),F4={},{useDebugValue:n8}=mw,{useSyncExternalStoreWithSelector:i8}=r8;let wy=!1;const s8=e=>e;function a8(e,t=s8,r){(F4?"production":void 0)!=="production"&&r&&!wy&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),wy=!0);const n=i8(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return n8(n),n}const by=e=>{(F4?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?IE(e):e,r=(n,i)=>a8(t,n,i);return Object.assign(r,t),r},o8=e=>e?by(e):by,l8="modulepreload",c8=function(e){return"/"+e},_y={},ja=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=c8(l),l in _y)return;_y[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":l8,u||(m.as="script"),m.crossOrigin="",m.href=l,o&&m.setAttribute("nonce",o),document.head.appendChild(m),u)return new Promise((p,h)=>{m.addEventListener("load",p),m.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},u8=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ja(async()=>{const{default:n}=await Promise.resolve().then(()=>du);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class X2 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class f8 extends X2{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class d8 extends X2{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class h8 extends X2{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var kg;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(kg||(kg={}));var m8=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};class p8{constructor(t,{headers:r={},customFetch:n,region:i=kg.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=u8(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return m8(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:u}).catch(v=>{throw new f8(v)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new d8(f);if(!f.ok)throw new h8(f);let p=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),h;return p==="application/json"?h=yield f.json():p==="application/octet-stream"?h=yield f.blob():p==="text/event-stream"?h=f:p==="multipart/form-data"?h=yield f.formData():h=yield f.text(),{data:h,error:null}}catch(i){return{data:null,error:i}}})}}var ui={},J2={},Sm={},Nd={},Nm={},km={},g8=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ru=g8();const x8=ru.fetch,O4=ru.fetch.bind(ru),D4=ru.Headers,v8=ru.Request,y8=ru.Response,du=Object.freeze(Object.defineProperty({__proto__:null,Headers:D4,Request:v8,Response:y8,default:O4,fetch:x8},Symbol.toStringTag,{value:"Module"})),w8=nw(du);var Em={};Object.defineProperty(Em,"__esModule",{value:!0});let b8=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Em.default=b8;var I4=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(km,"__esModule",{value:!0});const _8=I4(w8),S8=I4(Em);let N8=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=_8.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let u=null,f=null,m=null,p=s.status,h=s.statusText;if(s.ok){if(this.method!=="HEAD"){const y=await s.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=y:f=JSON.parse(y))}const g=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");g&&b&&b.length>1&&(m=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,p=406,h="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const g=await s.text();try{u=JSON.parse(g),Array.isArray(u)&&s.status===404&&(f=[],u=null,p=200,h="OK")}catch{s.status===404&&g===""?(p=204,h="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,p=200,h="OK"),u&&this.shouldThrowOnError)throw new S8.default(u)}return{error:u,data:f,count:m,status:p,statusText:h}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};km.default=N8;var k8=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nm,"__esModule",{value:!0});const E8=k8(km);let j8=class extends E8.default{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Nm.default=j8;var A8=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nd,"__esModule",{value:!0});const T8=A8(Nm);let C8=class extends T8.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Nd.default=C8;var P8=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sm,"__esModule",{value:!0});const rf=P8(Nd);let L8=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let s=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new rf.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const a=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new rf.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(l.length>0){const u=[...new Set(l)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new rf.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new rf.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new rf.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Sm.default=L8;var jm={},Am={};Object.defineProperty(Am,"__esModule",{value:!0});Am.version=void 0;Am.version="0.0.0-automated";Object.defineProperty(jm,"__esModule",{value:!0});jm.DEFAULT_HEADERS=void 0;const F8=Am;jm.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${F8.version}`};var R4=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(J2,"__esModule",{value:!0});const O8=R4(Sm),D8=R4(Nd),I8=jm;let R8=class M4{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},I8.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new O8.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new M4(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${t}`);let l;n||i?(a=n?"HEAD":"GET",Object.entries(r).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{o.searchParams.append(f,m)})):(a="POST",l=r);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new D8.default({method:a,url:o,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};J2.default=R8;var hu=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ui,"__esModule",{value:!0});ui.PostgrestError=ui.PostgrestBuilder=ui.PostgrestTransformBuilder=ui.PostgrestFilterBuilder=ui.PostgrestQueryBuilder=ui.PostgrestClient=void 0;const B4=hu(J2);ui.PostgrestClient=B4.default;const U4=hu(Sm);ui.PostgrestQueryBuilder=U4.default;const z4=hu(Nd);ui.PostgrestFilterBuilder=z4.default;const W4=hu(Nm);ui.PostgrestTransformBuilder=W4.default;const H4=hu(km);ui.PostgrestBuilder=H4.default;const $4=hu(Em);ui.PostgrestError=$4.default;var M8=ui.default={PostgrestClient:B4.default,PostgrestQueryBuilder:U4.default,PostgrestFilterBuilder:z4.default,PostgrestTransformBuilder:W4.default,PostgrestBuilder:H4.default,PostgrestError:$4.default};const{PostgrestClient:B8,PostgrestQueryBuilder:OR,PostgrestFilterBuilder:DR,PostgrestTransformBuilder:IR,PostgrestBuilder:RR,PostgrestError:MR}=M8,U8="2.11.2",z8={"X-Client-Info":`realtime-js/${U8}`},W8="1.0.0",q4=1e4,H8=1e3;var Hc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Hc||(Hc={}));var Ei;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ei||(Ei={}));var _s;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_s||(_s={}));var Eg;(function(e){e.websocket="websocket"})(Eg||(Eg={}));var il;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(il||(il={}));class $8{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+i));a=a+i;const l=n.decode(t.slice(a,a+s));a=a+s;const u=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class V4{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var mr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(mr||(mr={}));const Sy=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,a)=>(s[a]=q8(a,e,t,i),s),{})},q8=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?G4(s,a):jg(a)},G4=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return K8(t,r)}switch(e){case mr.bool:return V8(t);case mr.float4:case mr.float8:case mr.int2:case mr.int4:case mr.int8:case mr.numeric:case mr.oid:return G8(t);case mr.json:case mr.jsonb:return Y8(t);case mr.timestamp:return X8(t);case mr.abstime:case mr.date:case mr.daterange:case mr.int4range:case mr.int8range:case mr.money:case mr.reltime:case mr.text:case mr.time:case mr.timestamptz:case mr.timetz:case mr.tsrange:case mr.tstzrange:return jg(t);default:return jg(t)}},jg=e=>e,V8=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},G8=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Y8=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},K8=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>G4(t,o))}return e},X8=e=>typeof e=="string"?e.replace(" ","T"):e,Y4=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class e1{constructor(t,r,n={},i=q4){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ny;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ny||(Ny={}));class jf{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jf.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=jf.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=jf.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(u,f)=>{a[u]||(l[u]=f)}),this.map(a,(u,f)=>{const m=s[u];if(m){const p=f.map(b=>b.presence_ref),h=m.map(b=>b.presence_ref),v=f.filter(b=>h.indexOf(b.presence_ref)<0),g=m.filter(b=>p.indexOf(b.presence_ref)<0);v.length>0&&(o[u]=v),g.length>0&&(l[u]=g)}else o[u]=f}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var u;const f=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(l),f.length>0){const m=t[o].map(h=>h.presence_ref),p=f.filter(h=>m.indexOf(h.presence_ref)<0);t[o].unshift(...p)}n(o,f,l)}),this.map(a,(o,l)=>{let u=t[o];if(!u)return;const f=l.map(m=>m.presence_ref);u=u.filter(m=>f.indexOf(m.presence_ref)<0),t[o]=u,i(o,u,l),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ky;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ky||(ky={}));var Ey;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ey||(Ey={}));var pa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(pa||(pa={}));class Q2{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ei.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new e1(this,_s.join,this.params,this.timeout),this.rejoinTimer=new V4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ei.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ei.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ei.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ei.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_s.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new jf(this),this.broadcastEndpointURL=Y4(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(f=>t==null?void 0:t(pa.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(pa.CLOSED));const l={},u={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){t==null||t(pa.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,h=(m=p==null?void 0:p.length)!==null&&m!==void 0?m:0,v=[];for(let g=0;g<h;g++){const b=p[g],{filter:{event:y,schema:w,table:_,filter:j}}=b,O=f&&f[g];if(O&&O.event===y&&O.schema===w&&O.table===_&&O.filter===j)v.push(Object.assign(Object.assign({},b),{id:O.id}));else{this.unsubscribe(),t==null||t(pa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(pa.SUBSCRIBED);return}}).receive("error",f=>{t==null||t(pa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ei.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_s.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new e1(this,_s.leave,{},t);i.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new e1(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:u,join:f}=_s;if(n&&[o,l,u,f].indexOf(a)>=0&&n!==this._joinRef())return;let p=this._onMessage(a,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(h=>{var v,g,b;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((b=(g=h.filter)===null||g===void 0?void 0:g.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===a}).map(h=>h.callback(p,n)):(s=this.bindings[a])===null||s===void 0||s.filter(h=>{var v,g,b,y,w,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in h){const j=h.id,O=(v=h.filter)===null||v===void 0?void 0:v.event;return j&&((g=r.ids)===null||g===void 0?void 0:g.includes(j))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const j=(w=(y=h==null?void 0:h.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return j==="*"||j===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===a}).map(h=>{if(typeof p=="object"&&"ids"in p){const v=p.data,{schema:g,table:b,commit_timestamp:y,type:w,errors:_}=v;p=Object.assign(Object.assign({},{schema:g,table:b,commit_timestamp:y,eventType:w,new:{},old:{},errors:_}),this._getPayloadRecords(v))}h.callback(p,n)})}_isClosed(){return this.state===Ei.closed}_isJoined(){return this.state===Ei.joined}_isJoining(){return this.state===Ei.joining}_isLeaving(){return this.state===Ei.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Q2.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_s.close,{},t)}_onError(t){this._on(_s.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ei.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Sy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Sy(t.columns,t.old_record)),r}}const J8=()=>{},Q8=typeof WebSocket<"u",Z8=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ej{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=z8,this.params={},this.timeout=q4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=J8,this.conn=null,this.sendBuffer=[],this.serializer=new $8,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>ja(async()=>{const{default:l}=await Promise.resolve().then(()=>du);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${Eg.websocket}`,this.httpEndpoint=Y4(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,a)=>a(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new V4(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Q8){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new tj(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ja(async()=>{const{default:t}=await import("./browser-C7CGXxR2.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:W8}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Hc.connecting:return il.Connecting;case Hc.open:return il.Open;case Hc.closing:return il.Closing;default:return il.Closed}}isConnected(){return this.connectionState()===il.Open}channel(t,r={config:{}}){const n=new Q2(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(i=>{r&&i.updateJoinPayload({access_token:r}),i.joinedOnce&&i._isJoined()&&i._push(_s.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(H8,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:s,ref:a}=r;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(_s.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Z8],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class tj{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Hc.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Z2 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function fn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class rj extends Z2{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ag extends Z2{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var nj=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const K4=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ja(async()=>{const{default:n}=await Promise.resolve().then(()=>du);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},ij=()=>nj(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ja(()=>Promise.resolve().then(()=>du),void 0)).Response:Response}),Tg=e=>{if(Array.isArray(e))return e.map(r=>Tg(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Tg(n)}),t};var Ll=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const t1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),sj=(e,t,r)=>Ll(void 0,void 0,void 0,function*(){const n=yield ij();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{t(new rj(t1(i),e.status||500))}).catch(i=>{t(new Ag(t1(i),i))}):t(new Ag(t1(e),e))}),aj=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function kd(e,t,r,n,i,s){return Ll(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,aj(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>sj(l,o,n))})})}function z0(e,t,r,n){return Ll(this,void 0,void 0,function*(){return kd(e,"GET",t,r,n)})}function to(e,t,r,n,i){return Ll(this,void 0,void 0,function*(){return kd(e,"POST",t,n,i,r)})}function oj(e,t,r,n,i){return Ll(this,void 0,void 0,function*(){return kd(e,"PUT",t,n,i,r)})}function lj(e,t,r,n){return Ll(this,void 0,void 0,function*(){return kd(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function X4(e,t,r,n,i){return Ll(this,void 0,void 0,function*(){return kd(e,"DELETE",t,n,i,r)})}var li=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const cj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},jy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class uj{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=K4(i)}uploadOrUpdate(t,r,n,i){return li(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},jy),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const u=this._removeEmptyFolders(r),f=this._getFinalPath(u),m=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),p=yield m.json();return m.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(s){if(fn(s))return{data:null,error:s};throw s}})}upload(t,r,n){return li(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return li(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const u=Object.assign({upsert:jy.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const m=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:f}),p=yield m.json();return m.ok?{data:{path:s,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(fn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return li(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield to(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new Z2("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}update(t,r,n){return li(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return li(this,void 0,void 0,function*(){try{return{data:yield to(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}copy(t,r,n){return li(this,void 0,void 0,function*(){try{return{data:{path:(yield to(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return li(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield to(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return li(this,void 0,void 0,function*(){try{const i=yield to(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}download(t,r){return li(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield z0(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(fn(o))return{data:null,error:o};throw o}})}info(t){return li(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield z0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Tg(n),error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}exists(t){return li(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield lj(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(fn(n)&&n instanceof Ag){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return li(this,void 0,void 0,function*(){try{return{data:yield X4(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}list(t,r,n){return li(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},cj),r),{prefix:t||""});return{data:yield to(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const fj="2.7.1",dj={"X-Client-Info":`storage-js/${fj}`};var cc=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};class hj{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},dj),r),this.fetch=K4(n)}listBuckets(){return cc(this,void 0,void 0,function*(){try{return{data:yield z0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(fn(t))return{data:null,error:t};throw t}})}getBucket(t){return cc(this,void 0,void 0,function*(){try{return{data:yield z0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return cc(this,void 0,void 0,function*(){try{return{data:yield to(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return cc(this,void 0,void 0,function*(){try{return{data:yield oj(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return cc(this,void 0,void 0,function*(){try{return{data:yield to(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return cc(this,void 0,void 0,function*(){try{return{data:yield X4(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}}class mj extends hj{constructor(t,r={},n){super(t,r,n)}from(t){return new uj(this.url,this.headers,t,this.fetch)}}const pj="2.49.2";let pf="";typeof Deno<"u"?pf="deno":typeof document<"u"?pf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?pf="react-native":pf="node";const gj={"X-Client-Info":`supabase-js-${pf}/${pj}`},xj={headers:gj},vj={schema:"public"},yj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wj={};var bj=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const _j=e=>{let t;return e?t=e:typeof fetch>"u"?t=O4:t=fetch,(...r)=>t(...r)},Sj=()=>typeof Headers>"u"?D4:Headers,Nj=(e,t,r)=>{const n=_j(r),i=Sj();return(s,a)=>bj(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:u}))})};var kj=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};function Ej(e){return e.replace(/\/$/,"")}function jj(e,t){const{db:r,auth:n,realtime:i,global:s}=e,{db:a,auth:o,realtime:l,global:u}=t,f={db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},u),s),accessToken:()=>kj(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const J4="2.69.0",yc=30*1e3,Cg=3,r1=Cg*yc,Aj="http://localhost:9999",Tj="supabase.auth.token",Cj={"X-Client-Info":`gotrue-js/${J4}`},Pg="X-Supabase-Api-Version",Q4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Pj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Lj=6e5;class ex extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Tt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Fj extends ex{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Oj(e){return Tt(e)&&e.name==="AuthApiError"}class Z4 extends ex{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Mo extends ex{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Ja extends Mo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Dj(e){return Tt(e)&&e.name==="AuthSessionMissingError"}class n1 extends Mo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mh extends Mo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Bh extends Mo{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ij(e){return Tt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Ay extends Mo{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Lg extends Mo{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function i1(e){return Tt(e)&&e.name==="AuthRetryableFetchError"}class Ty extends Mo{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Af extends Mo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const W0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Cy=` 	
\r=`.split(""),Rj=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Cy.length;t+=1)e[Cy[t].charCodeAt(0)]=-2;for(let t=0;t<W0.length;t+=1)e[W0[t].charCodeAt(0)]=t;return e})();function Py(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(W0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(W0[n]),t.queuedBits-=6}}function e_(e,t,r){const n=Rj[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Mj(e){const t=[],r=i=>{t.push(i)},n={queue:0,queuedBits:0};return t_(e,i=>{Py(i,n,r)}),Py(null,n,r),t.join("")}function Ly(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Uj(a,n,r)};for(let a=0;a<e.length;a+=1)e_(e.charCodeAt(a),i,s);return t.join("")}function Bj(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function t_(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Bj(n,t)}}function Uj(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function zj(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)e_(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Wj(e){const t=[];return t_(e,r=>t.push(r)),new Uint8Array(t)}function Hj(e){return Math.round(Date.now()/1e3)+e}function $j(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Ws=()=>typeof window<"u"&&typeof document<"u",Jo={tested:!1,writable:!1},Tf=()=>{if(!Ws())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Jo.tested)return Jo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Jo.tested=!0,Jo.writable=!0}catch{Jo.tested=!0,Jo.writable=!1}return Jo.writable};function qj(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const r_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ja(async()=>{const{default:n}=await Promise.resolve().then(()=>du);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Vj=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",n_=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Uh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},zh=async(e,t)=>{await e.removeItem(t)};class Tm{constructor(){this.promise=new Tm.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Tm.promiseConstructor=Promise;function s1(e){const t=e.split(".");if(t.length!==3)throw new Af("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Pj.test(t[n]))throw new Af("JWT not in base64url format");return{header:JSON.parse(Ly(t[0])),payload:JSON.parse(Ly(t[1])),signature:zj(t[2]),raw:{header:t[0],payload:t[1]}}}async function Gj(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Yj(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function Kj(e){return("0"+e.toString(16)).substr(-2)}function Xj(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Kj).join("")}async function Jj(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function Qj(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Jj(e);return Mj(r)}async function uc(e,t,r=!1){const n=Xj();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await n_(e,`${t}-code-verifier`,i);const s=await Qj(n);return[s,n===s?"plain":"s256"]}const Zj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eA(e){const t=e.headers.get(Pg);if(!t||!t.match(Zj))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function tA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function rA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var nA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const tl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),iA=[502,503,504];async function Fy(e){var t;if(!Vj(e))throw new Lg(tl(e),0);if(iA.includes(e.status))throw new Lg(tl(e),e.status);let r;try{r=await e.json()}catch(s){throw new Z4(tl(s),s)}let n;const i=eA(e);if(i&&i.getTime()>=Q4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ty(tl(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ja}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Ty(tl(r),e.status,r.weak_password.reasons);throw new Fj(tl(r),e.status||500,n)}const sA=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function It(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Pg]||(s[Pg]=Q4["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await aA(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function aA(e,t,r,n,i,s){const a=sA(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new Lg(tl(l),0)}if(o.ok||await Fy(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Fy(l)}}function Qa(e){var t;let r=null;uA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Hj(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Oy(e){const t=Qa(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function io(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function oA(e){return{data:e,error:null}}function lA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=nA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function cA(e){return e}function uA(e){return e.access_token&&e.refresh_token&&e.expires_in}var fA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class dA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=r_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await It(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Tt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await It(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:io})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=fA(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await It(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:lA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Tt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await It(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:io})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},f=await It(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:cA});if(f.error)throw f.error;const m=await f.json(),p=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,h=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(v.split(";")[1].split("=")[1]);u[`${b}Page`]=g}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(Tt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){try{return await It(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:io})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await It(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:io})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await It(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:io})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await It(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await It(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}}const hA={getItem:e=>Tf()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Tf()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Tf()&&globalThis.localStorage.removeItem(e)}};function Dy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function mA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const fc={debug:!!(globalThis&&Tf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class i_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class pA extends i_{}async function gA(e,t,r){fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),fc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new pA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(fc.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}mA();const xA={url:Aj,storageKey:Tj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Cj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Iy(e,t,r){return await r()}class ad{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ad.nextInstanceID,ad.nextInstanceID+=1,this.instanceID>0&&Ws()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},xA),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new dA({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=r_(i.fetch),this.lock=i.lock||Iy,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Ws()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=gA:this.lock=Iy,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Tf()?this.storage=hA:(this.memoryStorage={},this.storage=Dy(this.memoryStorage)):(this.memoryStorage={},this.storage=Dy(this.memoryStorage)),Ws()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${J4}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=qj(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ws()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Ij(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Tt(r)?{error:r}:{error:new Z4("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Qa}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(Tt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:f,password:m,options:p}=t;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await uc(this.storage,this.storageKey)),s=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:f,password:m,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:h,code_challenge_method:v},xform:Qa})}else if("phone"in t){const{phone:f,password:m,options:p}=t;s=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:m,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Qa})}else throw new Mh("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(Tt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Oy})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Oy})}else throw new Mh("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new n1}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await Uh(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await It(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Qa});if(await zh(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new n1}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(Tt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Qa}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new n1}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await uc(this.storage,this.storageKey));const{error:m}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:o,options:l}=t,{data:u,error:f}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f}}throw new Mh("You must provide either an email or phone number.")}catch(o){if(Tt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await It(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Qa});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(Tt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await uc(this.storage,this.storageKey)),await It(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:oA})}catch(s){if(Tt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ja;const{error:i}=await It(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(Tt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await It(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await It(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Mh("You must provide either an email or phone number and a type")}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Uh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<r1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,u,f)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,f))})}return{data:{session:t},error:null}}const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:io}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ja}:await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:io})})}catch(r){if(Tt(r))return Dj(r)&&(await this._removeSession(),await zh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Ja;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await uc(this.storage,this.storageKey));const{data:u,error:f}=await It(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:io});if(f)throw f;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ja;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=s1(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Tt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ja;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Ws())throw new Bh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Bh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ay("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ay("No code detected.");const{data:w,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=t;if(!s||!o||!a||!u)throw new Bh("No session defined in URL");const f=Math.round(Date.now()/1e3),m=parseInt(o);let p=f+m;l&&(p=parseInt(l));const h=p-f;h*1e3<=yc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${m}s`);const v=p-m;f-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,p,f):f-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,p,f);const{data:g,error:b}=await this._getUser(s);if(b)throw b;const y={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:m,expires_at:p,refresh_token:a,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(Tt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Uh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(Oj(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await zh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=$j(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await uc(this.storage,this.storageKey,!0));try{return await It(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Tt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,u,f;const{data:m,error:p}=s;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await It(this.fetch,"GET",h,{headers:this.headers,jwt:(f=(u=m.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return Ws()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Tt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await It(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Yj(async i=>(i>0&&await Gj(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await It(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Qa})),(i,s)=>{const a=200*Math.pow(2,i);return s&&i1(s)&&Date.now()+a-n<yc})}catch(n){if(this._debug(r,"error",n),Tt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ws()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Uh(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<r1;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${r1}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),i1(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ja;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Tm;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Ja;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),Tt(s)){const a={session:null,error:s};return i1(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await n_(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await zh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ws()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),yc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/yc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${yc}ms, refresh threshold is ${Cg} ticks`),i<=Cg&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof i_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ws()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await uc(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await It(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:u}=await It(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await It(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await It(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=s1(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const f=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+Lj>Date.now()))return n;const{data:i,error:s}=await It(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new Af("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(a=>a.kid===t),!n)throw new Af("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=s1(n);if(tA(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:s,header:i,signature:a},error:null}}const u=rA(i.alg),f=await this.fetchJwk(i.kid,r),m=await crypto.subtle.importKey("jwk",f,u,!0,["verify"]);if(!await crypto.subtle.verify(u,m,a,Wj(`${o}.${l}`)))throw new Af("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(Tt(n))return{data:null,error:n};throw n}}}ad.nextInstanceID=0;const vA=ad;class yA extends vA{constructor(t){super(t)}}var wA=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(m){a(m)}}function l(f){try{u(n.throw(f))}catch(m){a(m)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};class bA{constructor(t,r,n){var i,s,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=Ej(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:vj,realtime:wj,auth:Object.assign(Object.assign({},yj),{storageKey:l}),global:xj},f=jj(n??{},u);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=Nj(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new B8(`${o}/rest/v1`,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new p8(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new mj(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return wA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:o,debug:l},u,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yA({url:this.authUrl,headers:Object.assign(Object.assign({},m),u),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:a,lock:o,debug:l,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new ej(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const _A=(e,t,r)=>new bA(e,t,r),SA="https://egtgfkxlkdgjtnicyfxr.supabase.co",NA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVndGdma3hsa2RnanRuaWN5ZnhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI1OTA0MzMsImV4cCI6MjA1ODE2NjQzM30.JTai6zEgGVb99zNGAoeK8wvdg3waV0hnrSCCZtyPlR0",$e=_A(SA,NA,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),dc=async()=>{try{await $e.auth.signOut({scope:"global"}),localStorage.clear(),sessionStorage.clear(),await new Promise(e=>setTimeout(e,100))}catch(e){throw console.error("Error killing sessions:",e),e}},Gt=o8(e=>({user:null,organization:null,error:null,initialized:!1,refreshSession:async()=>{try{const{data:t,error:r}=await $e.auth.getSession(),n=t.session;if(r)throw r;if(n!=null&&n.user){const{data:i,error:s}=await $e.from("users_organizations").select("organizations:organization_id(*)").eq("user_id",n.user.id).maybeSingle();if(s)throw s;if(i!=null&&i.organizations){const l=i.organizations;e({user:n.user,organization:l,error:null,initialized:!0});return}const{data:a,error:o}=await $e.from("organizations").select().eq("owner_id",n.user.id).maybeSingle();if(o)throw o;e({user:n.user,organization:a,error:null,initialized:!0})}else e({user:null,organization:null,error:null,initialized:!0})}catch(t){console.error("Error refreshing session:",t),await dc(),e({user:null,organization:null,error:t instanceof Error?t.message:"Session expired. Please sign in again.",initialized:!0})}},signIn:async(t,r)=>{e({error:null});try{await dc();const{data:n,error:i}=await $e.auth.signInWithPassword({email:t.trim().toLowerCase(),password:r});if(i)throw i.message==="Invalid login credentials"?new Error("Invalid email or password"):i;if(!n.user)throw new Error("No user returned from sign in");const{data:s,error:a}=await $e.from("users_organizations").select("organizations:organization_id(*)").eq("user_id",n.user.id).maybeSingle();if(a)throw a;if(s!=null&&s.organizations){const u=s.organizations;e({user:n.user,organization:u,error:null,initialized:!0});return}const{data:o,error:l}=await $e.from("organizations").select().eq("owner_id",n.user.id).maybeSingle();if(l)throw l;e({user:n.user,organization:o,error:null,initialized:!0})}catch(n){throw console.error("Sign in error:",n),e({user:null,organization:null,error:n instanceof Error?n.message:"Failed to sign in",initialized:!0}),n}},signUp:async(t,r,n)=>{e({error:null});try{await dc();const{data:i,error:s}=await $e.auth.signUp({email:t.trim().toLowerCase(),password:r});if(s)throw s;if(!i.user)throw new Error("No user returned from sign up");const{data:a,error:o}=await $e.from("organizations").insert([{name:n.trim(),owner_id:i.user.id}]).select().single();if(o)throw o;const{error:l}=await $e.from("users_organizations").insert([{user_id:i.user.id,organization_id:a.id,role:"owner"}]);if(l)throw l;e({user:i.user,organization:a,error:null,initialized:!0})}catch(i){throw console.error("Sign up error:",i),e({user:null,organization:null,error:i instanceof Error?i.message:"Failed to sign up",initialized:!0}),i}},deleteAccount:async()=>{try{const{error:t}=await $e.rpc("delete_user_account");if(t)throw t;await dc(),e({user:null,organization:null,error:null,initialized:!0})}catch(t){throw console.error("Delete account error:",t),e({error:t instanceof Error?t.message:"Failed to delete account",initialized:!0}),t}},signOut:async()=>{try{const{error:t}=await $e.auth.signOut();e({user:null,organization:null,error:null,initialized:!0}),t&&await dc()}catch(t){throw console.error("Sign out error:",t),e({error:t instanceof Error?t.message:"Failed to sign out",initialized:!0}),t}},killAllSessions:dc})),kA=async()=>{try{await Gt.getState().refreshSession(),console.log("initAuth")}catch(e){console.error("Auth initialization error:",e)}};kA();$e.auth.onAuthStateChange(async(e,t)=>{if(e==="SIGNED_OUT"){Gt.setState({user:null,organization:null,error:null,initialized:!0});return}});setInterval(async()=>{const e=Gt.getState();e.user&&await e.refreshSession()},10*60*1e3);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var EA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),yt=(e,t)=>{const r=me.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>me.createElement("svg",{ref:f,...EA,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${jA(e)}`,o].join(" "),...u},[...t.map(([m,p])=>me.createElement(m,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=yt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=yt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a1=yt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=yt("BarChart4",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=yt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=yt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=yt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=yt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=yt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=yt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=yt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=yt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=yt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=yt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=yt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=yt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=yt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=yt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=yt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OA=yt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=yt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=yt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=yt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RA=yt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=yt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=yt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=yt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=yt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=yt("MinusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=yt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=yt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=yt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=yt("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=yt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=yt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=yt("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=yt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=yt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=yt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=yt("SquareUserRound",[["path",{d:"M18 21a6 6 0 0 0-12 0",key:"kaz2du"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=yt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=yt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=yt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=yt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=yt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=yt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=yt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function VA(){const{user:e}=Gt();return e?c.jsx(dl,{to:"/dashboard",replace:!0}):c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[c.jsx("div",{className:"flex justify-center",children:c.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:c.jsx(Eo,{className:"h-8 w-8 text-blue-600"})})}),c.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sten360"}),c.jsxs("div",{className:"mt-2 text-center",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Complete Business Management Platform"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"A Sten Business Solution"})]})]}),c.jsx(SE,{})]})}function GA(e){return e&&e.country&&e.city&&e.address&&e.employee_count&&e.currency}function YA(){const[e,t]=me.useState(""),[r,n]=me.useState(""),[i,s]=me.useState(!1),[a,o]=me.useState(null),{signIn:l,user:u,organization:f}=Gt();if(u)return GA(f)?c.jsx(dl,{to:"/dashboard",replace:!0}):c.jsx(dl,{to:"/organization-setup",replace:!0});const m=async p=>{if(p.preventDefault(),!i){o(null),s(!0);try{await l(e,r)}catch(h){console.error("Sign in error:",h),o(h instanceof Error?h.message:"An error occurred during sign in"),s(!1)}}};return c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsxs("div",{className:"bg-white py-8 px-4 shadow-xl sm:rounded-lg sm:px-10",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md mb-8",children:[c.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:c.jsx(RA,{className:"h-6 w-6 text-blue-600"})}),c.jsx("h2",{className:"mt-6 text-center text-2xl font-bold tracking-tight text-gray-900",children:"Sign in to your account"})]}),a&&c.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-400 p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsx("p",{className:"text-sm text-red-700",children:a})})]})}),c.jsxs("form",{onSubmit:m,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(BA,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:p=>t(p.target.value),disabled:i,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your email"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(IA,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"password",type:"password",required:!0,value:r,onChange:p=>n(p.target.value),disabled:i,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your password"})]})]}),c.jsx("div",{children:c.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed transition-colors duration-200",children:i?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]}),c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Don't have an account?"})})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx(Fr,{to:"/signup",className:"font-medium text-blue-600 hover:text-blue-500 transition-colors duration-200",children:"Sign up for free"})})]})]})})}function KA(){const[e,t]=me.useState(""),[r,n]=me.useState(""),[i,s]=me.useState(""),[a,o]=me.useState(null),l=Gt(f=>f.signUp),u=async f=>{f.preventDefault();try{await l(e,r,i)}catch(m){o(m instanceof Error?m.message:"An error occurred")}};return c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[c.jsx("h2",{className:"text-2xl font-bold mb-8 text-center",children:"Create your account"}),a&&c.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:a}),c.jsxs("form",{onSubmit:u,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"organization",className:"block text-sm font-medium text-gray-700",children:"Organization name"}),c.jsx("input",{id:"organization",type:"text",required:!0,value:i,onChange:f=>s(f.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),c.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:f=>t(f.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),c.jsx("input",{id:"password",type:"password",required:!0,value:r,onChange:f=>n(f.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsx("div",{children:c.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign up"})})]}),c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Already have an account?"})})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx(Fr,{to:"/signin",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in instead"})})]})]})})}function u_(){const[e,t]=me.useState({isOpen:!1,title:"",message:"",type:"info",confirmText:"Confirm",cancelText:"Cancel",resolve:null});return{confirm:s=>new Promise(a=>{t({...s,isOpen:!0,resolve:a})}),dialog:e,handleConfirm:()=>{e.resolve&&e.resolve(!0),t(s=>({...s,isOpen:!1}))},handleCancel:()=>{e.resolve&&e.resolve(!1),t(s=>({...s,isOpen:!1}))}}}function f_(){const[e,t]=me.useState([]),r=me.useCallback(i=>{const s=Math.random().toString(36).substr(2,9);t(a=>[...a,{...i,id:s}])},[]),n=me.useCallback(i=>{t(s=>s.filter(a=>a.id!==i))},[]);return{toasts:e,addToast:r,removeToast:n}}function XA({isOpen:e,title:t,message:r,type:n="info",confirmText:i="Confirm",cancelText:s="Cancel",onConfirm:a,onCancel:o}){if(!e)return null;const l={danger:c.jsx(Bo,{className:"h-6 w-6 text-red-600"}),warning:c.jsx(od,{className:"h-6 w-6 text-yellow-600"}),info:c.jsx(OA,{className:"h-6 w-6 text-blue-600"})},u={danger:{button:"bg-red-600 hover:bg-red-700 focus:ring-red-500",icon:"bg-red-100"},warning:{button:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500",icon:"bg-yellow-100"},info:{button:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",icon:"bg-blue-100"}};return c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 transition-opacity"}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:[c.jsxs("div",{className:"sm:flex sm:items-start",children:[c.jsx("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full ${u[n].icon} sm:mx-0 sm:h-10 sm:w-10`,children:l[n]}),c.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[c.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:t}),c.jsx("div",{className:"mt-2",children:c.jsx("p",{className:"text-sm text-gray-500",children:r})})]})]}),c.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse gap-3",children:[c.jsx("button",{type:"button",className:`inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm sm:w-auto ${u[n].button} focus:outline-none focus:ring-2 focus:ring-offset-2`,onClick:a,children:i}),c.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:o,children:s})]})]})})]})}function JA({id:e,type:t,title:r,message:n,duration:i=5e3,onClose:s}){me.useEffect(()=>{if(i>0){const l=setTimeout(()=>{s(e)},i);return()=>clearTimeout(l)}},[i,e,s]);const a={success:c.jsx(Ns,{className:"h-6 w-6 text-green-400"}),error:c.jsx(Bo,{className:"h-6 w-6 text-red-400"}),warning:c.jsx(od,{className:"h-6 w-6 text-yellow-400"}),info:c.jsx(DA,{className:"h-6 w-6 text-blue-400"})},o={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200"};return c.jsx("div",{className:`pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg border shadow-lg ${o[t]}`,children:c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"flex-shrink-0",children:a[t]}),c.jsxs("div",{className:"ml-3 w-0 flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:r}),n&&c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n})]}),c.jsx("div",{className:"ml-4 flex flex-shrink-0",children:c.jsxs("button",{type:"button",className:"inline-flex rounded-md text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>s(e),children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx(Es,{className:"h-5 w-5"})]})})]})})})}function QA({toasts:e,onClose:t}){return c.jsx("div",{"aria-live":"assertive",className:"pointer-events-none fixed inset-0 z-50 flex flex-col items-end gap-2 px-4 py-6 sm:p-6",children:c.jsx("div",{className:"flex w-full flex-col items-end space-y-4",children:e.map(r=>c.jsx(JA,{...r,onClose:t},r.id))})})}const d_=me.createContext(null);function ZA({children:e}){const{confirm:t,dialog:r,handleConfirm:n,handleCancel:i}=u_(),{toasts:s,addToast:a,removeToast:o}=f_();return c.jsxs(d_.Provider,{value:{confirm:t,addToast:a},children:[e,c.jsx(XA,{isOpen:r.isOpen,title:r.title,message:r.message,type:r.type,confirmText:r.confirmText,cancelText:r.cancelText,onConfirm:n,onCancel:i}),c.jsx(QA,{toasts:s,onClose:o})]})}function vn(){const e=me.useContext(d_);if(!e)throw new Error("useUI must be used within a UIProvider");return e}const $r={GHS:{name:"Ghanaian Cedi",symbol:"₵"},USD:{name:"US Dollar",symbol:"$"},EUR:{name:"Euro",symbol:"€"},GBP:{name:"British Pound",symbol:"£"},NGN:{name:"Nigerian Naira",symbol:"₦"}},Wh={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},delayed:{bg:"bg-orange-100",text:"text-orange-800",hover:"hover:bg-orange-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},cancelled:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"}},Ry={pending:"Pending",in_progress:"In Progress",delayed:"Delayed",completed:"Completed",cancelled:"Cancelled"};function Jr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Ao(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function eT(e,t){const r=Jr(e);return isNaN(t)?Ao(e,NaN):(t&&r.setDate(r.getDate()+t),r)}const h_=6048e5,tT=864e5;let rT={};function jd(){return rT}function Di(e,t){var o,l,u,f;const r=jd(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,i=Jr(e),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function H0(e){return Di(e,{weekStartsOn:1})}function m_(e){const t=Jr(e),r=t.getFullYear(),n=Ao(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=H0(n),s=Ao(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const a=H0(s);return t.getTime()>=i.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function El(e){const t=Jr(e);return t.setHours(0,0,0,0),t}function My(e){const t=Jr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function nT(e,t){const r=El(e),n=El(t),i=+r-My(r),s=+n-My(n);return Math.round((i-s)/tT)}function iT(e){const t=m_(e),r=Ao(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),H0(r)}function p_(e,t){const r=t*7;return eT(e,r)}function sT(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function aT(e){if(!sT(e)&&typeof e!="number")return!1;const t=Jr(e);return!isNaN(Number(t))}function oT(e){const t=Jr(e);return t.setHours(23,59,59,999),t}function lT(e){const t=Jr(e),r=Ao(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function _o(e,t){var o,l,u,f;const r=jd(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,i=Jr(e),s=i.getDay(),a=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}const cT={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},uT=(e,t,r)=>{let n;const i=cT[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function o1(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const fT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},dT={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hT={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},mT={date:o1({formats:fT,defaultWidth:"full"}),time:o1({formats:dT,defaultWidth:"full"}),dateTime:o1({formats:hT,defaultWidth:"full"})},pT={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},gT=(e,t,r,n)=>pT[e];function nf(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;i=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[a]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const xT={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},vT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},yT={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},wT={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},bT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_T={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ST=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},NT={ordinalNumber:ST,era:nf({values:xT,defaultWidth:"wide"}),quarter:nf({values:vT,defaultWidth:"wide",argumentCallback:e=>e-1}),month:nf({values:yT,defaultWidth:"wide"}),day:nf({values:wT,defaultWidth:"wide"}),dayPeriod:nf({values:bT,defaultWidth:"wide",formattingValues:_T,defaultFormattingWidth:"wide"})};function sf(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const a=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?ET(o,m=>m.test(a)):kT(o,m=>m.test(a));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const f=t.slice(a.length);return{value:u,rest:f}}}function kT(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function ET(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function jT(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;const o=t.slice(i.length);return{value:a,rest:o}}}const AT=/^(\d+)(th|st|nd|rd)?/i,TT=/\d+/i,CT={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},PT={any:[/^b/i,/^(a|c)/i]},LT={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},FT={any:[/1/i,/2/i,/3/i,/4/i]},OT={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},DT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},IT={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},RT={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},MT={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},BT={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},UT={ordinalNumber:jT({matchPattern:AT,parsePattern:TT,valueCallback:e=>parseInt(e,10)}),era:sf({matchPatterns:CT,defaultMatchWidth:"wide",parsePatterns:PT,defaultParseWidth:"any"}),quarter:sf({matchPatterns:LT,defaultMatchWidth:"wide",parsePatterns:FT,defaultParseWidth:"any",valueCallback:e=>e+1}),month:sf({matchPatterns:OT,defaultMatchWidth:"wide",parsePatterns:DT,defaultParseWidth:"any"}),day:sf({matchPatterns:IT,defaultMatchWidth:"wide",parsePatterns:RT,defaultParseWidth:"any"}),dayPeriod:sf({matchPatterns:MT,defaultMatchWidth:"any",parsePatterns:BT,defaultParseWidth:"any"})},zT={code:"en-US",formatDistance:uT,formatLong:mT,formatRelative:gT,localize:NT,match:UT,options:{weekStartsOn:0,firstWeekContainsDate:1}};function WT(e){const t=Jr(e);return nT(t,lT(t))+1}function HT(e){const t=Jr(e),r=+H0(t)-+iT(t);return Math.round(r/h_)+1}function g_(e,t){var f,m,p,h;const r=Jr(e),n=r.getFullYear(),i=jd(),s=(t==null?void 0:t.firstWeekContainsDate)??((m=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??i.firstWeekContainsDate??((h=(p=i.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,a=Ao(e,0);a.setFullYear(n+1,0,s),a.setHours(0,0,0,0);const o=Di(a,t),l=Ao(e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const u=Di(l,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function $T(e,t){var o,l,u,f;const r=jd(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,i=g_(e,t),s=Ao(e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),Di(s,t)}function Lm(e,t){const r=Jr(e),n=+Di(r,t)-+$T(r,t);return Math.round(n/h_)+1}function Zt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Ga={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Zt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Zt(r+1,2)},d(e,t){return Zt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Zt(e.getHours()%12||12,t.length)},H(e,t){return Zt(e.getHours(),t.length)},m(e,t){return Zt(e.getMinutes(),t.length)},s(e,t){return Zt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Zt(i,t.length)}},hc={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},By={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Ga.y(e,t)},Y:function(e,t,r,n){const i=g_(e,n),s=i>0?i:1-i;if(t==="YY"){const a=s%100;return Zt(a,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Zt(s,t.length)},R:function(e,t){const r=m_(e);return Zt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Zt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Zt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Zt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Ga.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Zt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=Lm(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):Zt(i,t.length)},I:function(e,t,r){const n=HT(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Zt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ga.d(e,t)},D:function(e,t,r){const n=WT(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Zt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Zt(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Zt(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return Zt(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=hc.noon:n===0?i=hc.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=hc.evening:n>=12?i=hc.afternoon:n>=4?i=hc.morning:i=hc.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Ga.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ga.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Zt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Zt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ga.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ga.s(e,t)},S:function(e,t){return Ga.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return zy(n);case"XXXX":case"XX":return rl(n);case"XXXXX":case"XXX":default:return rl(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return zy(n);case"xxxx":case"xx":return rl(n);case"xxxxx":case"xxx":default:return rl(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Uy(n,":");case"OOOO":default:return"GMT"+rl(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Uy(n,":");case"zzzz":default:return"GMT"+rl(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Zt(n,t.length)},T:function(e,t,r){const n=e.getTime();return Zt(n,t.length)}};function Uy(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+Zt(s,2)}function zy(e,t){return e%60===0?(e>0?"-":"+")+Zt(Math.abs(e)/60,2):rl(e,t)}function rl(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Zt(Math.trunc(n/60),2),s=Zt(n%60,2);return r+i+t+s}const Wy=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},x_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},qT=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return Wy(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Wy(n,t)).replace("{{time}}",x_(i,t))},VT={p:x_,P:qT},GT=/^D+$/,YT=/^Y+$/,KT=["D","DD","YY","YYYY"];function XT(e){return GT.test(e)}function JT(e){return YT.test(e)}function QT(e,t,r){const n=ZT(e,t,r);if(console.warn(n),KT.includes(e))throw new RangeError(n)}function ZT(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const eC=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tC=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rC=/^'([^]*?)'?$/,nC=/''/g,iC=/[a-zA-Z]/;function Mt(e,t,r){var f,m,p,h;const n=jd(),i=n.locale??zT,s=n.firstWeekContainsDate??((m=(f=n.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,a=n.weekStartsOn??((h=(p=n.locale)==null?void 0:p.options)==null?void 0:h.weekStartsOn)??0,o=Jr(e);if(!aT(o))throw new RangeError("Invalid time value");let l=t.match(tC).map(v=>{const g=v[0];if(g==="p"||g==="P"){const b=VT[g];return b(v,i.formatLong)}return v}).join("").match(eC).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const g=v[0];if(g==="'")return{isToken:!1,value:sC(v)};if(By[g])return{isToken:!0,value:v};if(g.match(iC))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:v}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const u={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return l.map(v=>{if(!v.isToken)return v.value;const g=v.value;(JT(g)||XT(g))&&QT(g,t,String(e));const b=By[g[0]];return b(o,g,i.localize,u)}).join("")}function sC(e){const t=e.match(rC);return t?t[1].replace(nC,"'"):e}function ix(e){return Jr(e).getFullYear()}function ml(e,t){const r=Jr(e),n=Jr(t);return r.getTime()>n.getTime()}function Hy(e,t){const r=+Jr(e),[n,i]=[+Jr(t.start),+Jr(t.end)].sort((s,a)=>s-a);return r>=n&&r<=i}function aC(e,t){return p_(e,-1)}const v_=({orderId:e,outstandingBalance:t,onPaymentRecorded:r})=>{const{addToast:n}=vn(),{organization:i}=Gt(),[s,a]=me.useState(!1),[o,l]=me.useState(""),[u,f]=me.useState(""),[m,p]=me.useState(""),[h,v]=me.useState(!1),g=async b=>{if(b.preventDefault(),!o||!u){n({type:"error",title:"Error",message:"Please fill in all required fields"});return}const y=parseFloat(o);if(isNaN(y)||y<=0){n({type:"error",title:"Error",message:"Please enter a valid payment amount"});return}if(y>t){n({type:"error",title:"Error",message:"Payment amount cannot exceed outstanding balance"});return}v(!0);try{const{data:{user:w},error:_}=await $e.auth.getUser();if(_)throw _;if(!w)throw new Error("User not authenticated");const{error:j}=await $e.rpc("record_payment",{p_organization_id:i==null?void 0:i.id,p_order_id:e,p_amount:y,p_payment_method:u,p_payment_reference:m||null,p_recorded_by:w.id});if(j)throw j;n({type:"success",title:"Success",message:"Payment recorded successfully"}),l(""),f(""),p(""),a(!1),r()}catch(w){n({type:"error",title:"Error",message:w.message||"Failed to record payment"})}finally{v(!1)}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>a(!0),className:"ml-2 inline-flex items-center px-3 py-1.5 border border-blue-600 text-blue-600 hover:bg-blue-50 rounded-md text-sm font-medium transition-colors",children:[c.jsx(jo,{className:"h-4 w-4 mr-1"}),"Record Payment"]}),s&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),c.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[c.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Record Payment"}),c.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-500",children:c.jsx(Es,{className:"h-5 w-5"})})]}),c.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount*"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),c.jsx("input",{type:"number",step:"0.01",min:"0.01",max:t,value:o,onChange:b=>l(b.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"0.00",required:!0})]}),c.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Outstanding Balance: $",t.toFixed(2)]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method*"}),c.jsxs("select",{value:u,onChange:b=>f(b.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",required:!0,children:[c.jsx("option",{value:"",children:"Select a payment method"}),c.jsx("option",{value:"cash",children:"Cash"}),c.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),c.jsx("option",{value:"credit_card",children:"Credit Card"}),c.jsx("option",{value:"check",children:"Check"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Reference"}),c.jsx("input",{type:"text",value:m,onChange:b=>p(b.target.value),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"e.g., Check number, Transaction ID"})]}),c.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300",children:h?"Recording Payment...":"Record Payment"})]})]})]})]})})]})},oC={pending:"bg-yellow-100 text-yellow-800 border-yellow-200",in_progress:"bg-blue-100 text-blue-800 border-blue-200",completed:"bg-green-100 text-green-800 border-green-200",cancelled:"bg-red-100 text-red-800 border-red-200"},$y={pending:"Pending",in_progress:"In Progress",completed:"Completed",cancelled:"Cancelled"},lC={pending:od,in_progress:CA,completed:Ns,cancelled:Bo};function cC(){var m,p,h;const{id:e}=K2(),[t,r]=me.useState(null),[n,i]=me.useState(!0),{organization:s}=Gt(),{addToast:a}=vn(),o=s!=null&&s.currency?((m=$r[s.currency])==null?void 0:m.symbol)||s.currency:$r.USD.symbol;me.useEffect(()=>{e&&l()},[e]);const l=async()=>{try{const{data:v,error:g}=await $e.from("orders").select(`
          *,
          client:clients(name),
          workers:order_workers(
            id,
            worker_id,
            worker:workers(name),
            project:projects(name)
          ),
          services:order_services(
            id,
            service_id,
            quantity,
            cost,
            service:services(name)
          ),
          custom_fields:order_custom_fields(
            id,
            field:client_custom_fields(title, value)
          ),
          payments:service_payments(
            id,
            amount,
            payment_method,
            payment_reference,
            created_at
          )
        `).eq("id",e).single();if(g)throw g;r(v)}catch(v){console.error("Error loading order:",v),a({type:"error",title:"Error",message:"Failed to load order details"})}finally{i(!1)}},u=async v=>{if(t)try{const{error:g}=await $e.from("orders").update({status:v}).eq("id",t.id);if(g)throw g;r(b=>b?{...b,status:v}:null),a({type:"success",title:"Status Updated",message:`Order status updated to ${$y[v]}`})}catch(g){console.error("Error updating status:",g),a({type:"error",title:"Error",message:"Failed to update order status"})}};if(n)return c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!t)return c.jsxs("div",{className:"text-center py-12",children:[c.jsx("p",{className:"text-gray-500",children:"Order not found."}),c.jsxs(Fr,{to:"/dashboard/orders",className:"mt-4 inline-flex items-center text-blue-600 hover:text-blue-800",children:[c.jsx(ld,{className:"h-4 w-4 mr-2"}),"Back to Orders"]})]});const f=lC[t.status];return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx(Fr,{to:"/dashboard/orders",className:"text-gray-500 hover:text-gray-700",children:c.jsx(ld,{className:"h-5 w-5"})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Order ",t.order_number]}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created on ",Mt(new Date(t.created_at),"MMM d, yyyy HH:mm")]})]})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:`px-4 py-2 rounded-full border ${oC[t.status]} flex items-center space-x-2`,children:[c.jsx(f,{className:"h-4 w-4"}),c.jsx("span",{className:"text-sm font-medium",children:$y[t.status]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{value:t.status,onChange:v=>u(v.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg py-2 pl-3 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"pending",children:"Mark as Pending"}),c.jsx("option",{value:"in_progress",children:"Mark as In Progress"}),c.jsx("option",{value:"completed",children:"Mark as Completed"}),c.jsx("option",{value:"cancelled",children:"Mark as Cancelled"})]}),c.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500",children:c.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Services"})}),c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsx("div",{className:"space-y-4",children:t.services.map(v=>c.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Qs,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.service.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",v.quantity]})]})]}),c.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[o," ",v.cost.toFixed(2)]})]},v.id))}),c.jsx("div",{className:"mt-6 pt-6 border-t",children:c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Total Amount"}),c.jsxs("span",{className:"font-bold text-gray-900",children:[o," ",t.total_amount.toFixed(2)]})]})})]})]}),((p=t.custom_fields)==null?void 0:p.length)>0&&c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Custom Information"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsx("div",{className:"space-y-4",children:t.custom_fields.map(v=>c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(a_,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.field.title}),c.jsx("p",{className:"text-sm text-gray-500",children:v.field.value})]})]},v.id))})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[c.jsx(jo,{className:"h-5 w-5 mr-2 text-gray-500"}),"Payment Details"]}),t.payment_status!=="paid"&&c.jsx(v_,{orderId:t.id,outstandingBalance:t.outstanding_balance,onPaymentRecorded:l})]})}),c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Amount"}),c.jsxs("p",{className:"text-xl font-bold text-blue-900",children:[o," ",t==null?void 0:t.total_amount.toFixed(2)]})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[c.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Amount Paid"}),c.jsxs("p",{className:"text-xl font-bold text-green-900",children:[o," ",((t==null?void 0:t.total_amount)-((t==null?void 0:t.outstanding_balance)||0)).toFixed(2)]})]}),c.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[c.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Outstanding Balance"}),c.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[o," ",((t==null?void 0:t.outstanding_balance)||0).toFixed(2)]})]})]}),c.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-200",children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Payment Status"}),c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                    ${(t==null?void 0:t.payment_status)==="paid"?"bg-green-100 text-green-800":(t==null?void 0:t.payment_status)==="partially_paid"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:(t==null?void 0:t.payment_status)==="paid"?"Paid":(t==null?void 0:t.payment_status)==="partially_paid"?"Partially Paid":"Unpaid"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Payment History"}),t!=null&&t.payments&&t.payments.length>0?c.jsx("div",{className:"border rounded-lg divide-y",children:t.payments.map(v=>c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[o," ",v.amount.toFixed(2)]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[v.payment_method," • ",v.payment_reference]})]}),c.jsx("div",{className:"text-right",children:c.jsx("p",{className:"text-xs text-gray-500",children:Mt(new Date(v.created_at),"MMM d, yyyy h:mm a")})})]},v.id))}):c.jsx("p",{className:"text-sm text-gray-500 italic",children:"No payments recorded yet"})]})]})})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Client"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.client.name})]})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Assigned Workers"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsx("div",{className:"space-y-4",children:(h=t.workers)!=null&&h.length?t.workers.map(v=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.worker.name}),c.jsx("p",{className:"text-sm text-gray-500",children:v.project.name})]})]},v.id)):c.jsx("p",{className:"text-sm text-gray-500",children:"No workers assigned"})})})]}),t.due_date&&c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Due Date"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Fl,{className:"h-5 w-5 text-gray-400"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:Mt(new Date(t.due_date),"MMM d, yyyy")})]})})]}),t.description&&c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Description"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsx("p",{className:"text-sm text-gray-500",children:t.description})})]})]})]})]})}function uC({onClose:e,onSuccess:t}){var G;const[r,n]=me.useState([]),[i,s]=me.useState([]),[a,o]=me.useState([]),[l,u]=me.useState({}),[f,m]=me.useState(null),[p,h]=me.useState([]),[v,g]=me.useState([]),[b,y]=me.useState([]),[w,_]=me.useState(""),[j,O]=me.useState(!1),[L,E]=me.useState({description:"",due_date:"",initial_payment:0,payment_method:""}),{organization:C}=Gt(),{addToast:P}=vn(),R=C!=null&&C.currency?((G=$r[C.currency])==null?void 0:G.symbol)||C.currency:$r.USD.symbol;me.useEffect(()=>{C!=null&&C.id&&T()},[C]);const T=async()=>{if(C!=null&&C.id)try{const{data:B,error:Y}=await $e.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*)
        `).eq("organization_id",C.id);if(Y)throw Y;n(B||[]);const{data:re,error:he}=await $e.from("workers").select("id, name").eq("organization_id",C.id);if(he)throw he;s(re||[]);const{data:k,error:I}=await $e.from("services").select("*").eq("organization_id",C.id);if(I)throw I;o(k||[])}catch(B){console.error("Error loading data:",B),P({type:"error",title:"Error",message:"Failed to load required data"})}},A=async B=>{try{const{data:Y,error:re}=await $e.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).eq("worker_id",B);if(re)throw re;u(he=>({...he,[B]:Y||[]}))}catch(Y){console.error("Error loading worker projects:",Y),P({type:"error",title:"Error",message:"Failed to load worker projects"})}},q=async B=>{var re;if(B.preventDefault(),!f||v.length===0||!b.some(he=>he.worker_id&&he.project_id)){P({type:"error",title:"Validation Error",message:"Please select a client, at least one service, and assign at least one worker with a project."});return}if(!(C!=null&&C.id)){P({type:"error",title:"Error",message:"Organization information is missing."});return}const Y=v.reduce((he,{service:k,quantity:I})=>he+k.cost*I,0);if(L.initial_payment>Y){P({type:"error",title:"Validation Error",message:"Initial payment cannot be greater than the total amount."});return}O(!0);try{const{data:he,error:k}=await $e.rpc("create_order",{p_organization_id:C.id,p_client_id:f.id,p_description:L.description.trim()||null,p_due_date:L.due_date||null,p_total_amount:Y,p_workers:b.filter(I=>I.worker_id&&I.project_id).map(I=>({worker_id:I.worker_id,project_id:I.project_id})),p_services:v.map(({service:I,quantity:M})=>({service_id:I.id,quantity:M,cost:I.cost*M})),p_custom_fields:p});if(k)throw k;if(!he)throw new Error("Failed to create order");if(L.initial_payment>0&&L.payment_method){const{error:I}=await $e.rpc("record_payment",{p_organization_id:C.id,p_order_id:he.id,p_amount:L.initial_payment,p_payment_method:L.payment_method,p_payment_reference:`Initial payment for order ${he.order_number}`,p_recorded_by:(re=(await $e.auth.getUser()).data.user)==null?void 0:re.id});if(I)throw I}P({type:"success",title:"Order Created",message:"The order has been created successfully."}),t(),e()}catch(he){console.error("Error creating order:",he),P({type:"error",title:"Error",message:he instanceof Error?he.message:"Failed to create order. Please try again."})}finally{O(!1)}},z=r.filter(B=>B.name.toLowerCase().includes(w.toLowerCase())),ne=(B,Y,re)=>{g(he=>{const k=he.find(I=>I.service.id===B.id);return Y==="add"&&!k?[...he,{service:B,quantity:1}]:Y==="remove"?he.filter(I=>I.service.id!==B.id):Y==="update"&&re!==void 0?he.map(I=>I.service.id===B.id?{...I,quantity:Math.max(1,re)}:I):he})},U=v.reduce((B,{service:Y,quantity:re})=>B+Y.cost*re,0);return c.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-auto overflow-y-auto max-h-[90vh] border border-gray-100",children:c.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-8 py-6 border-b",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Order"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Fill in the order details below"})]}),c.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-400 hover:text-gray-500 hover:bg-white rounded-full transition-colors duration-200",children:c.jsx(Es,{className:"h-5 w-5"})})]}),c.jsxs("form",{onSubmit:q,className:"space-y-8",children:[c.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[c.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"1"}),"General Order Info"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800",children:"Select Client *"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsxs("div",{className:"relative",children:[c.jsx(hl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:w,onChange:B=>_(B.target.value),placeholder:"Search clients by name...",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400"})]}),w&&c.jsx("div",{className:"absolute z-10 mt-2 w-full bg-white shadow-xl rounded-lg border border-gray-200 max-h-60 overflow-auto divide-y divide-gray-100",children:z.map(B=>c.jsxs("button",{type:"button",onClick:()=>{var Y;m(B),_(""),h(((Y=B.custom_fields)==null?void 0:Y.map(re=>re.id))||[])},className:"w-full text-left px-4 py-3 hover:bg-blue-50 transition-colors duration-150 flex items-center space-x-3",children:[c.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:c.jsx(hl,{className:"h-4 w-4 text-blue-600"})}),c.jsx("div",{children:B.name})]},B.id))})]}),f&&!w&&c.jsxs("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg flex items-center justify-between animate-fadeIn shadow-sm",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center",children:c.jsx(hl,{className:"h-5 w-5 text-blue-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("span",{className:"text-sm font-semibold text-blue-900",children:f.name}),c.jsx("p",{className:"text-xs text-blue-600 mt-0.5",children:"Selected Client"})]})]}),c.jsx("button",{type:"button",onClick:()=>m(null),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-full transition-colors duration-200",children:c.jsx(Es,{className:"h-4 w-4"})})]}),(f==null?void 0:f.custom_fields)&&f.custom_fields.length>0&&c.jsxs("div",{className:"mt-6 animate-fadeIn",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Fields"}),c.jsx("div",{className:"space-y-2",children:f.custom_fields.map(B=>c.jsxs("label",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",checked:p.includes(B.id),onChange:Y=>{Y.target.checked?h(re=>[...re,B.id]):h(re=>re.filter(he=>he!==B.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsx("span",{className:"text-sm text-gray-900",children:B.title})]},B.id))})]}),c.jsxs("div",{className:"mt-6 space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800",children:"Assign Workers"}),c.jsxs("button",{type:"button",onClick:()=>y([...b,{worker_id:"",project_id:""}]),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Worker"]})]}),b.map((B,Y)=>{var re;return c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("select",{value:B.worker_id||"",onChange:he=>{const k=he.target.value;k&&A(k);const I=[...b];I[Y]={...I[Y],worker_id:k,project_id:""},y(I)},className:"block w-full px-3 py-2 border border-gray-300 rounded-md",children:[c.jsx("option",{value:"",children:"Select Worker"}),i.map(he=>c.jsx("option",{value:he.id,children:he.name},he.id))]})}),c.jsx("div",{className:"flex-1",children:c.jsxs("select",{value:B.project_id||"",onChange:he=>{const k=[...b];k[Y].project_id=he.target.value,y(k)},disabled:!B.worker_id,className:"block w-full px-3 py-2 border border-gray-300 rounded-md",children:[c.jsx("option",{value:"",children:"Select Project"}),B.worker_id&&((re=l[B.worker_id])==null?void 0:re.map(he=>c.jsx("option",{value:he.project_id,children:he.project.name},he.project_id)))]})}),c.jsx("button",{type:"button",onClick:()=>{const he=b.filter((k,I)=>I!==Y);y(he)},className:"p-2 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:c.jsx(Es,{className:"h-5 w-5"})})]},Y)})]}),c.jsxs("div",{className:"mt-6",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Description"}),c.jsxs("div",{className:"relative",children:[c.jsx(a_,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),c.jsx("textarea",{value:L.description,onChange:B=>E(Y=>({...Y,description:B.target.value})),rows:3,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400 resize-none",placeholder:"Enter order description"})]})]}),c.jsxs("div",{className:"mt-6",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Due Date"}),c.jsxs("div",{className:"relative",children:[c.jsx(Fl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"date",value:L.due_date,onChange:B=>E(Y=>({...Y,due_date:B.target.value})),min:Mt(new Date,"yyyy-MM-dd"),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400"})]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[c.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"2"}),"Services"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:a.map(B=>{const Y=v.find(re=>re.service.id===B.id);return c.jsx("div",{className:`p-4 rounded-lg border ${Y?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:B.name}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[R," ",B.cost.toFixed(2)]})]}),Y?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{type:"button",onClick:()=>ne(B,"update",Y.quantity-1),className:"p-1 text-gray-400 hover:text-gray-600",children:c.jsx(l_,{className:"h-4 w-4"})}),c.jsx("span",{className:"text-gray-900 min-w-[2rem] text-center",children:Y.quantity}),c.jsx("button",{type:"button",onClick:()=>ne(B,"update",Y.quantity+1),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:c.jsx(mn,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",onClick:()=>ne(B,"remove"),className:"p-1 text-red-400 hover:text-red-600",children:c.jsx(Es,{className:"h-4 w-4"})})]}):c.jsx("button",{type:"button",onClick:()=>ne(B,"add"),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-full transition-all duration-200",children:c.jsx(mn,{className:"h-4 w-4"})})]})},B.id)})}),v.length>0&&c.jsx("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg shadow-sm",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),c.jsxs("span",{className:"text-xl font-bold text-blue-600",children:[R," ",U.toFixed(2)]})]})})]})]}),c.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[c.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"3"}),"Payment Details"]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Order Amount"}),c.jsxs("span",{className:"text-xl font-bold text-blue-600",children:[R," ",U.toFixed(2)]})]})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Initial Payment (Optional)"}),c.jsxs("div",{className:"relative",children:[c.jsx(jo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"number",min:"0",max:U,step:"0.01",value:L.initial_payment,onChange:B=>E(Y=>({...Y,initial_payment:parseFloat(B.target.value)||0})),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400",placeholder:"Enter initial payment amount"})]})]}),L.initial_payment>0&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Payment Method *"}),c.jsxs("div",{className:"relative",children:[c.jsx(s_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsxs("select",{value:L.payment_method,onChange:B=>E(Y=>({...Y,payment_method:B.target.value})),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400",required:L.initial_payment>0,children:[c.jsx("option",{value:"",children:"Select Payment Method"}),c.jsx("option",{value:"mobile_money",children:"Mobile Money"}),c.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),c.jsx("option",{value:"cash",children:"Cash"}),c.jsx("option",{value:"other",children:"Other"})]})]})]}),L.initial_payment>0&&c.jsx("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-100 rounded-lg",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outstanding Balance"}),c.jsxs("span",{className:"text-xl font-bold text-green-600",children:[R," ",(U-L.initial_payment).toFixed(2)]})]})})]})]}),c.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:e,className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:j||!f||v.length===0,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:j?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Order..."]}):c.jsxs(c.Fragment,{children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Create Order"]})})]})]})]})})}function fC(){var P;const[e,t]=me.useState([]),[r,n]=me.useState(!0),[i,s]=me.useState(""),[a,o]=me.useState("all"),[l,u]=me.useState(!1),[f,m]=me.useState(new Date),p=Di(f,{weekStartsOn:1}),h=_o(f,{weekStartsOn:1}),v=new Date,g=Lm(f,{weekStartsOn:1}),b=ix(f),{organization:y}=Gt(),{confirm:w,addToast:_}=vn(),j=y!=null&&y.currency?((P=$r[y.currency])==null?void 0:P.symbol)||y.currency:"";me.useEffect(()=>{y&&O()},[y,f]);const O=async()=>{if(y!=null&&y.id)try{const{data:R,error:T}=await $e.from("orders").select(`
          *,
          client:clients(name),
          workers:order_workers(
            id,
            worker_id,
            worker:workers(name),
            project_id,
            project:projects(name),
            status
          ),
          services:order_services(
            id,
            service_id,
            service:services(name),
            quantity,
            cost
          ),
          outstanding_balance,
          payment_status
        `).eq("organization_id",y.id).gte("created_at",p.toISOString()).lte("created_at",h.toISOString()).order("created_at",{ascending:!1});if(T)throw T;t(R||[])}catch(R){console.error("Error loading orders:",R),_({type:"error",title:"Error",message:"Failed to load orders"})}finally{n(!1)}},L=async R=>{if(await w({title:"Delete Order",message:"Are you sure you want to delete this order? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:A}=await $e.from("orders").delete().eq("id",R);if(A)throw A;t(q=>q.filter(z=>z.id!==R)),_({type:"success",title:"Order Deleted",message:"The order has been deleted successfully."})}catch(A){console.error("Error deleting order:",A),_({type:"error",title:"Error",message:"Failed to delete order. Please try again."})}},E=R=>{m(T=>{const A=new Date(T);return R==="prev"?A.setDate(A.getDate()-7):A.setDate(A.getDate()+7),A})},C=e.filter(R=>R.client.name.toLowerCase().includes(i.toLowerCase())&&(a==="all"||R.status===a));return r?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage and track your customer orders"})]}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Create Order"]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>E("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:c.jsx(Cm,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"text-sm",children:[c.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",g,", ",b]}),c.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[Mt(p,"MMM d")," - ",Mt(h,"MMM d")]})]}),c.jsx("button",{onClick:()=>E("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:ml(h,v),children:c.jsx(Pm,{className:"h-5 w-5 text-gray-600"})})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[e.length," orders this week"]})]})}),l&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl",children:c.jsx(uC,{onClose:()=>u(!1),onSuccess:O})})]})}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50"}`,children:"All Orders"}),Object.entries(Ry).map(([R,T])=>c.jsx("button",{onClick:()=>o(R),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a===R?`${Wh[R].bg} ${Wh[R].text}`:"text-gray-500 hover:bg-gray-50"}`,children:T},R))]}),c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Ed,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:R=>s(R.target.value),placeholder:"Search orders...",className:"ml-2 flex-1 outline-none bg-transparent"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:C.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No orders found. Start by creating a new order."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Workers"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Services"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(R=>{var T;return c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm font-medium text-gray-900",children:c.jsx(Fr,{to:`/dashboard/orders/${R.id}`,className:"text-blue-600 hover:text-blue-800",children:R.order_number})})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400 mr-2"}),c.jsx("div",{className:"text-sm font-medium text-gray-900",children:R.client.name})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm text-gray-900",children:(T=R.workers)!=null&&T.length?R.workers.map(A=>A.worker.name).join(", "):"Unassigned"})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"flex flex-col space-y-1",children:R.services.map(A=>c.jsxs("div",{className:"flex items-center text-sm",children:[c.jsx(Qs,{className:"h-4 w-4 text-gray-400 mr-2"}),c.jsx("span",{className:"text-gray-900",children:A.service.name}),c.jsxs("span",{className:"text-gray-500 ml-2",children:["× ",A.quantity]})]},A.id))})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[c.jsx(Fl,{className:"h-4 w-4 text-gray-400 mr-2"}),R.due_date?Mt(new Date(R.due_date),"MMM d, yyyy"):"No due date"]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Wh[R.status].bg} ${Wh[R.status].text}`,children:Ry[R.status]})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[j," ",R.total_amount.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("span",{className:`text-sm font-medium ${R.payment_status==="paid"?"text-green-600":R.payment_status==="partially_paid"?"text-orange-600":"text-red-600"}`,children:[j," ",(R.total_amount-R.outstanding_balance).toFixed(2)]}),c.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:R.payment_status==="paid"?"Paid":R.payment_status==="partially_paid"?"Partially Paid":"Unpaid"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Fr,{to:`/dashboard/orders/${R.id}`,className:"text-blue-600 hover:text-blue-900",children:c.jsx(mu,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>L(R.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},R.id)})})]})})]})]})}function dC(){var C;const[e,t]=me.useState([]),[r,n]=me.useState(!0),[i,s]=me.useState(""),[a,o]=me.useState(!1),[l,u]=me.useState({name:"",whatsapp:"",image:""}),[f,m]=me.useState(!1),p=me.useRef(null),[h,v]=me.useState(null),{organization:g}=Gt(),{confirm:b,addToast:y}=vn(),w=((C=$r[g.currency])==null?void 0:C.symbol)||g.currency,_=P=>{var T;const R=(T=P.target.files)==null?void 0:T[0];if(R){if(!["image/jpeg","image/jpg","image/png"].includes(R.type)){alert("Please upload a JPG, JPEG, or PNG file");return}if(R.size>5*1024*1024){alert("Image must be less than 5MB");return}v(R)}},j=async()=>{if(g)try{n(!0);const{data:P,error:R}=await $e.from("workers").select("*").eq("organization_id",g.id).order("name");if(R)throw R;const T=new Date,A=Di(T,{weekStartsOn:1}),q=_o(T,{weekStartsOn:1}),z=El(T),ne=oT(T),{data:U,error:G}=await $e.from("tasks").select(`
          *,
          deductions (
            amount
          )
        `).eq("organization_id",g.id);if(G)throw G;const B=(P==null?void 0:P.map(Y=>{const re=(U==null?void 0:U.filter(se=>se.worker_id===Y.id))||[],he=re.filter(se=>Hy(new Date(se.date),{start:A,end:q})),k=he.filter(se=>se.status==="completed"),I=he.filter(se=>se.status==="pending"),M=k.reduce((se,fe)=>{var ve;const de=((ve=fe.deductions)==null?void 0:ve.reduce((Ee,Oe)=>Ee+(Oe.amount||0),0))||0;return se+(fe.amount-de)},0),D=he.reduce((se,fe)=>{var ve;const de=((ve=fe.deductions)==null?void 0:ve.reduce((Ee,Oe)=>Ee+(Oe.amount||0),0))||0;return se+(fe.amount-de)},0),V={completedEarnings:M,weeklyProjectTotal:D,assignedTasks:I.length,completedTasks:k.length,allTimeTasks:re.length,weeklyTasks:he.length,dailyTasks:re.filter(se=>Hy(new Date(se.date),{start:z,end:ne})).length};return{...Y,stats:V}}))||[];t(B)}catch(P){console.error("Error loading workers:",P)}finally{n(!1)}};me.useEffect(()=>{j()},[g]);const O=async()=>{var P;if(!(!g||!l.name.trim()))try{m(!0);let R=null;if(h){const q=(P=h.name.split(".").pop())==null?void 0:P.toLowerCase();if(!q||!["jpg","jpeg","png"].includes(q))throw new Error("Invalid file extension");const z=`${Math.random().toString(36).substring(2)}.${q}`,ne=`${g.id}/${z}`,{error:U,data:G}=await $e.storage.from("profiles").upload(ne,h,{contentType:h.type,cacheControl:"3600",upsert:!1});if(U)throw U;const{data:{publicUrl:B}}=$e.storage.from("profiles").getPublicUrl(ne);R=B}const{data:T,error:A}=await $e.from("workers").insert([{organization_id:g.id,name:l.name.trim(),whatsapp:l.whatsapp.trim()||null,image:R}]).select().single();if(A)throw A;t(q=>[...q,{...T,stats:{completedEarnings:0,weeklyProjectTotal:0,assignedTasks:0,completedTasks:0,allTimeTasks:0,weeklyTasks:0,dailyTasks:0}}]),u({name:"",whatsapp:"",image:""}),v(null),p.current&&(p.current.value=""),o(!1)}catch(R){console.error("Error adding worker:",R),alert(R instanceof Error?R.message:"Failed to add worker")}finally{m(!1)}},L=async P=>{if(await b({title:"Delete Worker",message:"Are you sure you want to delete this worker? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const T=e.find(q=>q.id===P);if(T!=null&&T.image){const q=T.image.split("/").slice(-2).join("/");await $e.storage.from("profiles").remove([q])}const{error:A}=await $e.from("workers").delete().eq("id",P);if(A)throw A;t(q=>q.filter(z=>z.id!==P)),y({type:"success",title:"Worker Deleted",message:"The worker has been deleted successfully."})}catch(T){console.error("Error deleting worker:",T),y({type:"error",title:"Error",message:"Failed to delete worker. Please try again."})}},E=e.filter(P=>P.name.toLowerCase().includes(i.toLowerCase()));return r?c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading workers..."})]})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Workers"}),c.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Worker"]})]}),a&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Worker"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),c.jsx("input",{type:"text",value:l.name,onChange:P=>u(R=>({...R,name:P.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",placeholder:"Enter worker name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp Number"}),c.jsx("input",{type:"text",value:l.whatsapp,onChange:P=>u(R=>({...R,whatsapp:P.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",placeholder:"Enter WhatsApp number"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Profile Image"}),c.jsx("input",{type:"file",ref:p,onChange:_,accept:"image/*",className:"hidden"}),c.jsx("div",{className:"mt-1 flex items-center space-x-4",children:h?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:h.name}),c.jsx("button",{onClick:()=>{v(null),p.current&&(p.current.value="")},className:"text-red-600 hover:text-red-700",children:c.jsx(Bo,{className:"h-5 w-5"})})]}):c.jsxs("button",{onClick:()=>{var P;return(P=p.current)==null?void 0:P.click()},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(cd,{className:"h-4 w-4 mr-2"}),"Choose Image"]})})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>{o(!1),v(null),p.current&&(p.current.value="")},className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:O,disabled:!l.name.trim()||f,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center",children:f?c.jsxs(c.Fragment,{children:[c.jsx(kl,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):"Add Worker"})]})]})]}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsx("div",{className:"p-4 border-b",children:c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Ed,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:P=>s(P.target.value),placeholder:"Search workers...",className:"ml-2 flex-1 outline-none bg-transparent"})]})}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-4",children:E.length===0?c.jsx("div",{className:"col-span-full text-center text-gray-500 py-4",children:i?"No workers found matching your search.":"No workers added yet."}):E.map(P=>{var R,T,A,q,z,ne,U;return c.jsxs("div",{className:"relative",children:[c.jsx(Fr,{to:`/dashboard/workers/${P.id}`,className:"block bg-white border rounded-lg shadow-sm hover:shadow-md transition-shadow",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:P.image?c.jsx("img",{src:P.image,alt:P.name,className:"h-full w-full object-cover"}):c.jsx("span",{className:"text-2xl font-medium text-gray-600",children:P.name[0].toUpperCase()})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:P.name}),P.whatsapp&&c.jsxs("p",{className:"text-sm text-gray-500",children:["WhatsApp: ",P.whatsapp]})]})]}),c.jsxs("div",{className:"mt-6 space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Completed Earnings: ",w," ",(R=P.stats)==null?void 0:R.completedEarnings.toFixed(2)]}),c.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:["Weekly Project Total: ",w," ",(T=P.stats)==null?void 0:T.weeklyProjectTotal.toFixed(2)]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-sm text-yellow-600 font-medium",children:["Tasks Assigned: ",(A=P.stats)==null?void 0:A.assignedTasks]}),c.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Tasks Completed: ",(q=P.stats)==null?void 0:q.completedTasks]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"All-time"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(z=P.stats)==null?void 0:z.allTimeTasks})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"This week"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(ne=P.stats)==null?void 0:ne.weeklyTasks})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Today"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(U=P.stats)==null?void 0:U.dailyTasks})]})]})]})]})}),c.jsx("button",{onClick:()=>L(P.id),className:"absolute top-4 right-4 p-2 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50 z-10",children:c.jsx(is,{className:"h-5 w-5"})})]},P.id)})})]})]})}function tr(e){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tr(e)}var Un=Uint8Array,Fi=Uint16Array,sx=Int32Array,Fm=new Un([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Om=new Un([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Dg=new Un([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),y_=function(e,t){for(var r=new Fi(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new sx(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},w_=y_(Fm,2),b_=w_.b,Ig=w_.r;b_[28]=258,Ig[258]=28;var __=y_(Om,0),hC=__.b,qy=__.r,Rg=new Fi(32768);for(var vr=0;vr<32768;++vr){var Ya=(vr&43690)>>1|(vr&21845)<<1;Ya=(Ya&52428)>>2|(Ya&13107)<<2,Ya=(Ya&61680)>>4|(Ya&3855)<<4,Rg[vr]=((Ya&65280)>>8|(Ya&255)<<8)>>1}var Js=function(e,t,r){for(var n=e.length,i=0,s=new Fi(t);i<n;++i)e[i]&&++s[e[i]-1];var a=new Fi(t);for(i=1;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(r){o=new Fi(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],f=t-e[i],m=a[e[i]-1]++<<f,p=m|(1<<f)-1;m<=p;++m)o[Rg[m]>>l]=u}else for(o=new Fi(n),i=0;i<n;++i)e[i]&&(o[i]=Rg[a[e[i]-1]++]>>15-e[i]);return o},To=new Un(288);for(var vr=0;vr<144;++vr)To[vr]=8;for(var vr=144;vr<256;++vr)To[vr]=9;for(var vr=256;vr<280;++vr)To[vr]=7;for(var vr=280;vr<288;++vr)To[vr]=8;var ud=new Un(32);for(var vr=0;vr<32;++vr)ud[vr]=5;var mC=Js(To,9,0),pC=Js(To,9,1),gC=Js(ud,5,0),xC=Js(ud,5,1),l1=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ps=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},c1=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},ax=function(e){return(e+7)/8|0},S_=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Un(e.subarray(t,r))},vC=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ws=function(e,t,r){var n=new Error(t||vC[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,ws),!r)throw n;return n},yC=function(e,t,r,n){var i=e.length,s=0;if(!i||t.f&&!t.l)return r||new Un(0);var a=!r,o=a||t.i!=2,l=t.i;a&&(r=new Un(i*3));var u=function(Ee){var Oe=r.length;if(Ee>Oe){var Ve=new Un(Math.max(Oe*2,Ee));Ve.set(r),r=Ve}},f=t.f||0,m=t.p||0,p=t.b||0,h=t.l,v=t.d,g=t.m,b=t.n,y=i*8;do{if(!h){f=ps(e,m,1);var w=ps(e,m+1,3);if(m+=3,w)if(w==1)h=pC,v=xC,g=9,b=5;else if(w==2){var L=ps(e,m,31)+257,E=ps(e,m+10,15)+4,C=L+ps(e,m+5,31)+1;m+=14;for(var P=new Un(C),R=new Un(19),T=0;T<E;++T)R[Dg[T]]=ps(e,m+T*3,7);m+=E*3;for(var A=l1(R),q=(1<<A)-1,z=Js(R,A,1),T=0;T<C;){var ne=z[ps(e,m,q)];m+=ne&15;var _=ne>>4;if(_<16)P[T++]=_;else{var U=0,G=0;for(_==16?(G=3+ps(e,m,3),m+=2,U=P[T-1]):_==17?(G=3+ps(e,m,7),m+=3):_==18&&(G=11+ps(e,m,127),m+=7);G--;)P[T++]=U}}var B=P.subarray(0,L),Y=P.subarray(L);g=l1(B),b=l1(Y),h=Js(B,g,1),v=Js(Y,b,1)}else ws(1);else{var _=ax(m)+4,j=e[_-4]|e[_-3]<<8,O=_+j;if(O>i){l&&ws(0);break}o&&u(p+j),r.set(e.subarray(_,O),p),t.b=p+=j,t.p=m=O*8,t.f=f;continue}if(m>y){l&&ws(0);break}}o&&u(p+131072);for(var re=(1<<g)-1,he=(1<<b)-1,k=m;;k=m){var U=h[c1(e,m)&re],I=U>>4;if(m+=U&15,m>y){l&&ws(0);break}if(U||ws(2),I<256)r[p++]=I;else if(I==256){k=m,h=null;break}else{var M=I-254;if(I>264){var T=I-257,D=Fm[T];M=ps(e,m,(1<<D)-1)+b_[T],m+=D}var V=v[c1(e,m)&he],se=V>>4;V||ws(3),m+=V&15;var Y=hC[se];if(se>3){var D=Om[se];Y+=c1(e,m)&(1<<D)-1,m+=D}if(m>y){l&&ws(0);break}o&&u(p+131072);var fe=p+M;if(p<Y){var de=s-Y,ve=Math.min(Y,fe);for(de+p<0&&ws(3);p<ve;++p)r[p]=n[de+p]}for(;p<fe;++p)r[p]=r[p-Y]}}t.l=h,t.p=k,t.b=p,t.f=f,h&&(f=1,t.m=g,t.d=v,t.n=b)}while(!f);return p!=r.length&&a?S_(r,0,p):r.subarray(0,p)},ha=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},af=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},u1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:k_,l:0};if(i==1){var a=new Un(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(O,L){return O.f-L.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],u=0,f=1,m=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};f!=i-1;)o=r[r[u].f<r[m].f?u++:m++],l=r[u!=f&&r[u].f<r[m].f?u++:m++],r[f++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=s[0].s,n=1;n<i;++n)s[n].s>p&&(p=s[n].s);var h=new Fi(p+1),v=Mg(r[f-1],h,0);if(v>t){var n=0,g=0,b=v-t,y=1<<b;for(s.sort(function(L,E){return h[E.s]-h[L.s]||L.f-E.f});n<i;++n){var w=s[n].s;if(h[w]>t)g+=y-(1<<v-h[w]),h[w]=t;else break}for(g>>=b;g>0;){var _=s[n].s;h[_]<t?g-=1<<t-h[_]++-1:++n}for(;n>=0&&g;--n){var j=s[n].s;h[j]==t&&(--h[j],++g)}v=t}return{t:new Un(h),l:v}},Mg=function(e,t,r){return e.s==-1?Math.max(Mg(e.l,t,r+1),Mg(e.r,t,r+1)):t[e.s]=r},Vy=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Fi(++t),n=0,i=e[0],s=1,a=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[o]}return{c:r.subarray(0,n),n:t}},of=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},N_=function(e,t,r){var n=r.length,i=ax(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},Gy=function(e,t,r,n,i,s,a,o,l,u,f){ha(t,f++,r),++i[256];for(var m=u1(i,15),p=m.t,h=m.l,v=u1(s,15),g=v.t,b=v.l,y=Vy(p),w=y.c,_=y.n,j=Vy(g),O=j.c,L=j.n,E=new Fi(19),C=0;C<w.length;++C)++E[w[C]&31];for(var C=0;C<O.length;++C)++E[O[C]&31];for(var P=u1(E,7),R=P.t,T=P.l,A=19;A>4&&!R[Dg[A-1]];--A);var q=u+5<<3,z=of(i,To)+of(s,ud)+a,ne=of(i,p)+of(s,g)+a+14+3*A+of(E,R)+2*E[16]+3*E[17]+7*E[18];if(l>=0&&q<=z&&q<=ne)return N_(t,f,e.subarray(l,l+u));var U,G,B,Y;if(ha(t,f,1+(ne<z)),f+=2,ne<z){U=Js(p,h,0),G=p,B=Js(g,b,0),Y=g;var re=Js(R,T,0);ha(t,f,_-257),ha(t,f+5,L-1),ha(t,f+10,A-4),f+=14;for(var C=0;C<A;++C)ha(t,f+3*C,R[Dg[C]]);f+=3*A;for(var he=[w,O],k=0;k<2;++k)for(var I=he[k],C=0;C<I.length;++C){var M=I[C]&31;ha(t,f,re[M]),f+=R[M],M>15&&(ha(t,f,I[C]>>5&127),f+=I[C]>>12)}}else U=mC,G=To,B=gC,Y=ud;for(var C=0;C<o;++C){var D=n[C];if(D>255){var M=D>>18&31;af(t,f,U[M+257]),f+=G[M+257],M>7&&(ha(t,f,D>>23&31),f+=Fm[M]);var V=D&31;af(t,f,B[V]),f+=Y[V],V>3&&(af(t,f,D>>5&8191),f+=Om[V])}else af(t,f,U[D]),f+=G[D]}return af(t,f,U[256]),f+G[256]},wC=new sx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),k_=new Un(0),bC=function(e,t,r,n,i,s){var a=s.z||e.length,o=new Un(n+a+5*(1+Math.ceil(a/7e3))+i),l=o.subarray(n,o.length-i),u=s.l,f=(s.r||0)&7;if(t){f&&(l[0]=s.r>>3);for(var m=wC[t-1],p=m>>13,h=m&8191,v=(1<<r)-1,g=s.p||new Fi(32768),b=s.h||new Fi(v+1),y=Math.ceil(r/3),w=2*y,_=function(Qe){return(e[Qe]^e[Qe+1]<<y^e[Qe+2]<<w)&v},j=new sx(25e3),O=new Fi(288),L=new Fi(32),E=0,C=0,P=s.i||0,R=0,T=s.w||0,A=0;P+2<a;++P){var q=_(P),z=P&32767,ne=b[q];if(g[z]=ne,b[q]=z,T<=P){var U=a-P;if((E>7e3||R>24576)&&(U>423||!u)){f=Gy(e,l,0,j,O,L,C,R,A,P-A,f),R=E=C=0,A=P;for(var G=0;G<286;++G)O[G]=0;for(var G=0;G<30;++G)L[G]=0}var B=2,Y=0,re=h,he=z-ne&32767;if(U>2&&q==_(P-he))for(var k=Math.min(p,U)-1,I=Math.min(32767,P),M=Math.min(258,U);he<=I&&--re&&z!=ne;){if(e[P+B]==e[P+B-he]){for(var D=0;D<M&&e[P+D]==e[P+D-he];++D);if(D>B){if(B=D,Y=he,D>k)break;for(var V=Math.min(he,D-2),se=0,G=0;G<V;++G){var fe=P-he+G&32767,de=g[fe],ve=fe-de&32767;ve>se&&(se=ve,ne=fe)}}}z=ne,ne=g[z],he+=z-ne&32767}if(Y){j[R++]=268435456|Ig[B]<<18|qy[Y];var Ee=Ig[B]&31,Oe=qy[Y]&31;C+=Fm[Ee]+Om[Oe],++O[257+Ee],++L[Oe],T=P+B,++E}else j[R++]=e[P],++O[e[P]]}}for(P=Math.max(P,T);P<a;++P)j[R++]=e[P],++O[e[P]];f=Gy(e,l,u,j,O,L,C,R,A,P-A,f),u||(s.r=f&7|l[f/8|0]<<3,f-=7,s.h=b,s.p=g,s.i=P,s.w=T)}else{for(var P=s.w||0;P<a+u;P+=65535){var Ve=P+65535;Ve>=a&&(l[f/8|0]=u,Ve=a),f=N_(l,f+1,e.subarray(P,Ve))}s.i=a}return S_(o,0,n+ax(f)+i)},E_=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=n+=r[a];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},_C=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new Un(s.length+e.length);a.set(s),a.set(e,s.length),e=a,i.w=s.length}return bC(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},j_=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},SC=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=E_();i.p(t.dictionary),j_(e,2,i.d())}},NC=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ws(6,"invalid zlib data"),(e[1]>>5&1)==1&&ws(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Bg(e,t){t||(t={});var r=E_();r.p(e);var n=_C(e,t,t.dictionary?6:2,4);return SC(n,t),j_(n,n.length-4,r.d()),n}function kC(e,t){return yC(e.subarray(NC(e),-4),{i:2},t,t)}var EC=typeof TextDecoder<"u"&&new TextDecoder,jC=0;try{EC.decode(k_,{stream:!0}),jC=1}catch{}var vt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function f1(){vt.console&&typeof vt.console.log=="function"&&vt.console.log.apply(vt.console,arguments)}var ur={log:f1,warn:function(e){vt.console&&(typeof vt.console.warn=="function"?vt.console.warn.apply(vt.console,arguments):f1.call(null,arguments))},error:function(e){vt.console&&(typeof vt.console.error=="function"?vt.console.error.apply(vt.console,arguments):f1(e))}};function d1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){nl(n.response,t,r)},n.onerror=function(){ur.error("could not download file")},n.send()}function Yy(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Hh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Cf,Ug,nl=vt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==vt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=vt.URL||vt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?Yy(i.href)?d1(e,t,r):Hh(i,i.target="_blank"):Hh(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Hh(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Yy(e))d1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Hh(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:tr(s)!=="object"&&(ur.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return d1(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(vt.HTMLElement)||vt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=a?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var l=vt.URL||vt.webkitURL,u=l.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function A_(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,a=i.exec(e);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),"#"+o+l+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function h1(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=Dn(r,n,i,s,t[0],7,-680876936),s=Dn(s,r,n,i,t[1],12,-389564586),i=Dn(i,s,r,n,t[2],17,606105819),n=Dn(n,i,s,r,t[3],22,-1044525330),r=Dn(r,n,i,s,t[4],7,-176418897),s=Dn(s,r,n,i,t[5],12,1200080426),i=Dn(i,s,r,n,t[6],17,-1473231341),n=Dn(n,i,s,r,t[7],22,-45705983),r=Dn(r,n,i,s,t[8],7,1770035416),s=Dn(s,r,n,i,t[9],12,-1958414417),i=Dn(i,s,r,n,t[10],17,-42063),n=Dn(n,i,s,r,t[11],22,-1990404162),r=Dn(r,n,i,s,t[12],7,1804603682),s=Dn(s,r,n,i,t[13],12,-40341101),i=Dn(i,s,r,n,t[14],17,-1502002290),r=In(r,n=Dn(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=In(s,r,n,i,t[6],9,-1069501632),i=In(i,s,r,n,t[11],14,643717713),n=In(n,i,s,r,t[0],20,-373897302),r=In(r,n,i,s,t[5],5,-701558691),s=In(s,r,n,i,t[10],9,38016083),i=In(i,s,r,n,t[15],14,-660478335),n=In(n,i,s,r,t[4],20,-405537848),r=In(r,n,i,s,t[9],5,568446438),s=In(s,r,n,i,t[14],9,-1019803690),i=In(i,s,r,n,t[3],14,-187363961),n=In(n,i,s,r,t[8],20,1163531501),r=In(r,n,i,s,t[13],5,-1444681467),s=In(s,r,n,i,t[2],9,-51403784),i=In(i,s,r,n,t[7],14,1735328473),r=Rn(r,n=In(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=Rn(s,r,n,i,t[8],11,-2022574463),i=Rn(i,s,r,n,t[11],16,1839030562),n=Rn(n,i,s,r,t[14],23,-35309556),r=Rn(r,n,i,s,t[1],4,-1530992060),s=Rn(s,r,n,i,t[4],11,1272893353),i=Rn(i,s,r,n,t[7],16,-155497632),n=Rn(n,i,s,r,t[10],23,-1094730640),r=Rn(r,n,i,s,t[13],4,681279174),s=Rn(s,r,n,i,t[0],11,-358537222),i=Rn(i,s,r,n,t[3],16,-722521979),n=Rn(n,i,s,r,t[6],23,76029189),r=Rn(r,n,i,s,t[9],4,-640364487),s=Rn(s,r,n,i,t[12],11,-421815835),i=Rn(i,s,r,n,t[15],16,530742520),r=Mn(r,n=Rn(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Mn(s,r,n,i,t[7],10,1126891415),i=Mn(i,s,r,n,t[14],15,-1416354905),n=Mn(n,i,s,r,t[5],21,-57434055),r=Mn(r,n,i,s,t[12],6,1700485571),s=Mn(s,r,n,i,t[3],10,-1894986606),i=Mn(i,s,r,n,t[10],15,-1051523),n=Mn(n,i,s,r,t[1],21,-2054922799),r=Mn(r,n,i,s,t[8],6,1873313359),s=Mn(s,r,n,i,t[15],10,-30611744),i=Mn(i,s,r,n,t[6],15,-1560198380),n=Mn(n,i,s,r,t[13],21,1309151649),r=Mn(r,n,i,s,t[4],6,-145523070),s=Mn(s,r,n,i,t[11],10,-1120210379),i=Mn(i,s,r,n,t[2],15,718787259),n=Mn(n,i,s,r,t[9],21,-343485551),e[0]=co(r,e[0]),e[1]=co(n,e[1]),e[2]=co(i,e[2]),e[3]=co(s,e[3])}function Dm(e,t,r,n,i,s){return t=co(co(t,e),co(n,s)),co(t<<i|t>>>32-i,r)}function Dn(e,t,r,n,i,s,a){return Dm(t&r|~t&n,e,t,i,s,a)}function In(e,t,r,n,i,s,a){return Dm(t&n|r&~n,e,t,i,s,a)}function Rn(e,t,r,n,i,s,a){return Dm(t^r^n,e,t,i,s,a)}function Mn(e,t,r,n,i,s,a){return Dm(r^(t|~n),e,t,i,s,a)}function T_(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)h1(n,AC(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(h1(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,h1(n,i),n}function AC(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Cf=vt.atob.bind(vt),Ug=vt.btoa.bind(vt);var Ky="0123456789abcdef".split("");function TC(e){for(var t="",r=0;r<4;r++)t+=Ky[e>>8*r+4&15]+Ky[e>>8*r&15];return t}function CC(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function zg(e){return T_(e).map(CC).join("")}var PC=function(e){for(var t=0;t<e.length;t++)e[t]=TC(e[t]);return e.join("")}(T_("hello"))!="5d41402abc4b2a76b9719d911017c592";function co(e,t){if(PC){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Wg(e,t){var r,n,i,s;if(e!==r){for(var a=(i=e,s=1+(256/e.length>>0),new Array(s+1).join(i)),o=[],l=0;l<256;l++)o[l]=l;var u=0;for(l=0;l<256;l++){var f=o[l];u=(u+f+a.charCodeAt(l))%256,o[l]=o[u],o[u]=f}r=e,n=o}else o=n;var m=t.length,p=0,h=0,v="";for(l=0;l<m;l++)h=(h+(f=o[p=(p+1)%256]))%256,o[p]=o[h],o[h]=f,a=o[(o[p]+o[h])%256],v+=String.fromCharCode(t.charCodeAt(l)^a);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Xy={print:4,modify:8,copy:16,"annot-forms":32};function wc(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(Xy.perm!==void 0)throw new Error("Invalid permission: "+o);i+=Xy[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),a=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=zg(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Wg(this.encryptionKey,this.padding)}function bc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=e[n]}return t}function Jy(e){if(tr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var a=t[r][s];try{a[0].apply(e,n)}catch(o){vt.console&&ur.error("jsPDF PubSub Error",o.message,o)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function fd(e){if(!(this instanceof fd))return new fd(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function C_(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function so(e,t,r,n,i){if(!(this instanceof so))return new so(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,C_.call(this,n,i)}function cl(e,t,r,n,i){if(!(this instanceof cl))return new cl(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,C_.call(this,n,i)}function mt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],a=[],o=1,l=16,u="S",f=null;tr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),u=e.defaultPathOperation||"S"),a=e.filters||(s===!0?["FlateEncode"]:a),n=n||"mm",r=(""+(r||"P")).toLowerCase();var m=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=Jy;var v="1.3",g=h.__private__.getPdfVersion=function(){return v};h.__private__.setPdfVersion=function(S){v=S};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return b};var y=h.__private__.getPageFormat=function(S){return b[S]};i=i||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},_=w.COMPAT;function j(){this.saveGraphicsState(),ue(new pt(nt,0,0,-nt,0,Oa()*nt).toString()+" cm"),this.setFontSize(this.getFontSize()/nt),u="n",_=w.ADVANCED}function O(){this.restoreGraphicsState(),u="S",_=w.COMPAT}var L=h.__private__.combineFontStyleAndFontWeight=function(S,H){if(S=="bold"&&H=="normal"||S=="bold"&&H==400||S=="normal"&&H=="italic"||S=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(S=H==400||H==="normal"?S==="italic"?"italic":"normal":H!=700&&H!=="bold"||S!=="normal"?(H==700?"bold":H)+""+S:"bold"),S};h.advancedAPI=function(S){var H=_===w.COMPAT;return H&&j.call(this),typeof S!="function"||(S(this),H&&O.call(this)),this},h.compatAPI=function(S){var H=_===w.ADVANCED;return H&&O.call(this),typeof S!="function"||(S(this),H&&j.call(this)),this},h.isAdvancedAPI=function(){return _===w.ADVANCED};var E,C=function(S){if(_!==w.ADVANCED)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},P=h.roundToPrecision=h.__private__.roundToPrecision=function(S,H){var ce=t||H;if(isNaN(S)||isNaN(ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(ce).replace(/0+$/,"")};E=h.hpf=h.__private__.hpf=typeof l=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return P(S,l)}:l==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return P(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return P(S,16)};var R=h.f2=h.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return P(S,2)},T=h.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return P(S,3)},A=h.scale=h.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return _===w.COMPAT?S*nt:_===w.ADVANCED?S:void 0},q=function(S){return _===w.COMPAT?Oa()-S:_===w.ADVANCED?S:void 0},z=function(S){return A(q(S))};h.__private__.setPrecision=h.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var ne,U="00000000000000000000000000000000",G=h.__private__.getFileId=function(){return U},B=h.__private__.setFileId=function(S){return U=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():U.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Pn=new wc(f.userPermissions,f.userPassword,f.ownerPassword,U)),U};h.setFileId=function(S){return B(S),this},h.getFileId=function(){return G()};var Y=h.__private__.convertDateToPDFDate=function(S){var H=S.getTimezoneOffset(),ce=H<0?"+":"-",pe=Math.floor(Math.abs(H/60)),be=Math.abs(H%60),Le=[ce,M(pe),"'",M(be),"'"].join("");return["D:",S.getFullYear(),M(S.getMonth()+1),M(S.getDate()),M(S.getHours()),M(S.getMinutes()),M(S.getSeconds()),Le].join("")},re=h.__private__.convertPDFDateToDate=function(S){var H=parseInt(S.substr(2,4),10),ce=parseInt(S.substr(6,2),10)-1,pe=parseInt(S.substr(8,2),10),be=parseInt(S.substr(10,2),10),Le=parseInt(S.substr(12,2),10),We=parseInt(S.substr(14,2),10);return new Date(H,ce,pe,be,Le,We,0)},he=h.__private__.setCreationDate=function(S){var H;if(S===void 0&&(S=new Date),S instanceof Date)H=Y(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=S}return ne=H},k=h.__private__.getCreationDate=function(S){var H=ne;return S==="jsDate"&&(H=re(ne)),H};h.setCreationDate=function(S){return he(S),this},h.getCreationDate=function(S){return k(S)};var I,M=h.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},D=h.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},V=0,se=[],fe=[],de=0,ve=[],Ee=[],Oe=!1,Ve=fe,Qe=function(){V=0,de=0,fe=[],se=[],ve=[],ee=jr(),te=jr()};h.__private__.setCustomOutputDestination=function(S){Oe=!0,Ve=S};var Te=function(S){Oe||(Ve=S)};h.__private__.resetCustomOutputDestination=function(){Oe=!1,Ve=fe};var ue=h.__private__.out=function(S){return S=S.toString(),de+=S.length+1,Ve.push(S),Ve},Me=h.__private__.write=function(S){return ue(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},at=h.__private__.getArrayBuffer=function(S){for(var H=S.length,ce=new ArrayBuffer(H),pe=new Uint8Array(ce);H--;)pe[H]=S.charCodeAt(H);return ce},ze=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return ze};var Ye=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(S){return Ye=_===w.ADVANCED?S/nt:S,this};var Ze,tt=h.__private__.getFontSize=h.getFontSize=function(){return _===w.COMPAT?Ye:Ye*nt},ft=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(S){return ft=S,this},h.__private__.getR2L=h.getR2L=function(){return ft};var dt,bt=h.__private__.setZoomMode=function(S){var H=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))Ze=S;else if(isNaN(S)){if(H.indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');Ze=S}else Ze=parseInt(S,10)};h.__private__.getZoomMode=function(){return Ze};var jt,Lt=h.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');dt=S};h.__private__.getPageMode=function(){return dt};var Ot=h.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');jt=S};h.__private__.getLayoutMode=function(){return jt},h.__private__.setDisplayMode=h.setDisplayMode=function(S,H,ce){return bt(S),Ot(H),Lt(ce),this};var xt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(S){if(Object.keys(xt).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt[S]},h.__private__.getDocumentProperties=function(){return xt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(S){for(var H in xt)xt.hasOwnProperty(H)&&S[H]&&(xt[H]=S[H]);return this},h.__private__.setDocumentProperty=function(S,H){if(Object.keys(xt).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt[S]=H};var Ct,nt,en,Rt,ti,Yt={},fr={},Ui=[],Ut={},Os={},gr={},yi={},as=null,lr=0,_t=[],Ht=new Jy(h),ra=e.hotfixes||[],tn={},zi={},Wi=[],pt=function S(H,ce,pe,be,Le,We){if(!(this instanceof S))return new S(H,ce,pe,be,Le,We);isNaN(H)&&(H=1),isNaN(ce)&&(ce=0),isNaN(pe)&&(pe=0),isNaN(be)&&(be=1),isNaN(Le)&&(Le=0),isNaN(We)&&(We=0),this._matrix=[H,ce,pe,be,Le,We]};Object.defineProperty(pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),pt.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(S)},pt.prototype.multiply=function(S){var H=S.sx*this.sx+S.shy*this.shx,ce=S.sx*this.shy+S.shy*this.sy,pe=S.shx*this.sx+S.sy*this.shx,be=S.shx*this.shy+S.sy*this.sy,Le=S.tx*this.sx+S.ty*this.shx+this.tx,We=S.tx*this.shy+S.ty*this.sy+this.ty;return new pt(H,ce,pe,be,Le,We)},pt.prototype.decompose=function(){var S=this.sx,H=this.shy,ce=this.shx,pe=this.sy,be=this.tx,Le=this.ty,We=Math.sqrt(S*S+H*H),ot=(S/=We)*ce+(H/=We)*pe;ce-=S*ot,pe-=H*ot;var ht=Math.sqrt(ce*ce+pe*pe);return ot/=ht,S*(pe/=ht)<H*(ce/=ht)&&(S=-S,H=-H,ot=-ot,We=-We),{scale:new pt(We,0,0,ht,0,0),translate:new pt(1,0,0,1,be,Le),rotate:new pt(S,H,-H,S,0,0),skew:new pt(1,0,ot,1,0,0)}},pt.prototype.toString=function(S){return this.join(" ")},pt.prototype.inversed=function(){var S=this.sx,H=this.shy,ce=this.shx,pe=this.sy,be=this.tx,Le=this.ty,We=1/(S*pe-H*ce),ot=pe*We,ht=-H*We,Et=-ce*We,Nt=S*We;return new pt(ot,ht,Et,Nt,-ot*be-Et*Le,-ht*be-Nt*Le)},pt.prototype.applyToPoint=function(S){var H=S.x*this.sx+S.y*this.shx+this.tx,ce=S.x*this.shy+S.y*this.sy+this.ty;return new Vl(H,ce)},pt.prototype.applyToRectangle=function(S){var H=this.applyToPoint(S),ce=this.applyToPoint(new Vl(S.x+S.w,S.y+S.h));return new Au(H.x,H.y,ce.x-H.x,ce.y-H.y)},pt.prototype.clone=function(){var S=this.sx,H=this.shy,ce=this.shx,pe=this.sy,be=this.tx,Le=this.ty;return new pt(S,H,ce,pe,be,Le)},h.Matrix=pt;var wi=h.matrixMult=function(S,H){return H.multiply(S)},ri=new pt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=ri;var Cn=function(S,H){if(!Os[S]){var ce=(H instanceof so?"Sh":"P")+(Object.keys(Ut).length+1).toString(10);H.id=ce,Os[S]=ce,Ut[ce]=H,Ht.publish("addPattern",H)}};h.ShadingPattern=so,h.TilingPattern=cl,h.addShadingPattern=function(S,H){return C("addShadingPattern()"),Cn(S,H),this},h.beginTilingPattern=function(S){C("beginTilingPattern()"),Kd(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},h.endTilingPattern=function(S,H){C("endTilingPattern()"),H.stream=Ee[I].join(`
`),Cn(S,H),Ht.publish("endTilingPattern",H),Wi.pop().restore()};var Dr=h.__private__.newObject=function(){var S=jr();return X(S,!0),S},jr=h.__private__.newObjectDeferred=function(){return V++,se[V]=function(){return de},V},X=function(S,H){return H=typeof H=="boolean"&&H,se[S]=de,H&&ue(S+" 0 obj"),S},oe=h.__private__.newAdditionalObject=function(){var S={objId:jr(),content:""};return ve.push(S),S},ee=jr(),te=jr(),ae=h.__private__.decodeColorString=function(S){var H=S.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length===5&&(H[4]==="k"||H[4]==="K")&&(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var ce=parseFloat(H[0]);H=[ce,ce,ce,"r"]}for(var pe="#",be=0;be<3;be++)pe+=("0"+Math.floor(255*parseFloat(H[be])).toString(16)).slice(-2);return pe},le=h.__private__.encodeColorString=function(S){var H;typeof S=="string"&&(S={ch1:S});var ce=S.ch1,pe=S.ch2,be=S.ch3,Le=S.ch4,We=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ce=="string"&&ce.charAt(0)!=="#"){var ot=new A_(ce);if(ot.ok)ce=ot.toHex();else if(!/^\d*\.?\d*$/.test(ce))throw new Error('Invalid color "'+ce+'" passed to jsPDF.encodeColorString.')}if(typeof ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ce)&&(ce="#"+ce[1]+ce[1]+ce[2]+ce[2]+ce[3]+ce[3]),typeof ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ce)){var ht=parseInt(ce.substr(1),16);ce=ht>>16&255,pe=ht>>8&255,be=255&ht}if(pe===void 0||Le===void 0&&ce===pe&&pe===be)if(typeof ce=="string")H=ce+" "+We[0];else switch(S.precision){case 2:H=R(ce/255)+" "+We[0];break;case 3:default:H=T(ce/255)+" "+We[0]}else if(Le===void 0||tr(Le)==="object"){if(Le&&!isNaN(Le.a)&&Le.a===0)return H=["1.","1.","1.",We[1]].join(" ");if(typeof ce=="string")H=[ce,pe,be,We[1]].join(" ");else switch(S.precision){case 2:H=[R(ce/255),R(pe/255),R(be/255),We[1]].join(" ");break;default:case 3:H=[T(ce/255),T(pe/255),T(be/255),We[1]].join(" ")}}else if(typeof ce=="string")H=[ce,pe,be,Le,We[2]].join(" ");else switch(S.precision){case 2:H=[R(ce),R(pe),R(be),R(Le),We[2]].join(" ");break;case 3:default:H=[T(ce),T(pe),T(be),T(Le),We[2]].join(" ")}return H},Se=h.__private__.getFilters=function(){return a},Ce=h.__private__.putStream=function(S){var H=(S=S||{}).data||"",ce=S.filters||Se(),pe=S.alreadyAppliedFilters||[],be=S.addLength1||!1,Le=H.length,We=S.objectId,ot=function(Ln){return Ln};if(f!==null&&We===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(ot=Pn.encryptor(We,0));var ht={};ce===!0&&(ce=["FlateEncode"]);var Et=S.additionalKeyValues||[],Nt=(ht=mt.API.processDataByFilters!==void 0?mt.API.processDataByFilters(H,ce):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(pe)?pe.join(" "):pe.toString());if(ht.data.length!==0&&(Et.push({key:"Length",value:ht.data.length}),be===!0&&Et.push({key:"Length1",value:Le})),Nt.length!=0)if(Nt.split("/").length-1==1)Et.push({key:"Filter",value:Nt});else{Et.push({key:"Filter",value:"["+Nt+"]"});for(var Bt=0;Bt<Et.length;Bt+=1)if(Et[Bt].key==="DecodeParms"){for(var Sr=[],Ar=0;Ar<ht.reverseChain.split("/").length-1;Ar+=1)Sr.push("null");Sr.push(Et[Bt].value),Et[Bt].value="["+Sr.join(" ")+"]"}}ue("<<");for(var Vr=0;Vr<Et.length;Vr++)ue("/"+Et[Vr].key+" "+Et[Vr].value);ue(">>"),ht.data.length!==0&&(ue("stream"),ue(ot(ht.data)),ue("endstream"))},_e=h.__private__.putPage=function(S){var H=S.number,ce=S.data,pe=S.objId,be=S.contentsObjId;X(pe,!0),ue("<</Type /Page"),ue("/Parent "+S.rootDictionaryObjId+" 0 R"),ue("/Resources "+S.resourceDictionaryObjId+" 0 R"),ue("/MediaBox ["+parseFloat(E(S.mediaBox.bottomLeftX))+" "+parseFloat(E(S.mediaBox.bottomLeftY))+" "+E(S.mediaBox.topRightX)+" "+E(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&ue("/CropBox ["+E(S.cropBox.bottomLeftX)+" "+E(S.cropBox.bottomLeftY)+" "+E(S.cropBox.topRightX)+" "+E(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&ue("/BleedBox ["+E(S.bleedBox.bottomLeftX)+" "+E(S.bleedBox.bottomLeftY)+" "+E(S.bleedBox.topRightX)+" "+E(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&ue("/TrimBox ["+E(S.trimBox.bottomLeftX)+" "+E(S.trimBox.bottomLeftY)+" "+E(S.trimBox.topRightX)+" "+E(S.trimBox.topRightY)+"]"),S.artBox!==null&&ue("/ArtBox ["+E(S.artBox.bottomLeftX)+" "+E(S.artBox.bottomLeftY)+" "+E(S.artBox.topRightX)+" "+E(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&ue("/UserUnit "+S.userUnit),Ht.publish("putPage",{objId:pe,pageContext:_t[H],pageNumber:H,page:ce}),ue("/Contents "+be+" 0 R"),ue(">>"),ue("endobj");var Le=ce.join(`
`);return _===w.ADVANCED&&(Le+=`
Q`),X(be,!0),Ce({data:Le,filters:Se(),objectId:be}),ue("endobj"),pe},je=h.__private__.putPages=function(){var S,H,ce=[];for(S=1;S<=lr;S++)_t[S].objId=jr(),_t[S].contentsObjId=jr();for(S=1;S<=lr;S++)ce.push(_e({number:S,data:Ee[S],objId:_t[S].objId,contentsObjId:_t[S].contentsObjId,mediaBox:_t[S].mediaBox,cropBox:_t[S].cropBox,bleedBox:_t[S].bleedBox,trimBox:_t[S].trimBox,artBox:_t[S].artBox,userUnit:_t[S].userUnit,rootDictionaryObjId:ee,resourceDictionaryObjId:te}));X(ee,!0),ue("<</Type /Pages");var pe="/Kids [";for(H=0;H<lr;H++)pe+=ce[H]+" 0 R ";ue(pe+"]"),ue("/Count "+lr),ue(">>"),ue("endobj"),Ht.publish("postPutPages")},Ae=function(S){Ht.publish("putFont",{font:S,out:ue,newObject:Dr,putStream:Ce}),S.isAlreadyPutted!==!0&&(S.objectNumber=Dr(),ue("<<"),ue("/Type /Font"),ue("/BaseFont /"+bc(S.postScriptName)),ue("/Subtype /Type1"),typeof S.encoding=="string"&&ue("/Encoding /"+S.encoding),ue("/FirstChar 32"),ue("/LastChar 255"),ue(">>"),ue("endobj"))},He=function(){for(var S in Yt)Yt.hasOwnProperty(S)&&(m===!1||m===!0&&p.hasOwnProperty(S))&&Ae(Yt[S])},Ke=function(S){S.objectNumber=Dr();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[E(S.x),E(S.y),E(S.x+S.width),E(S.y+S.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var ce=S.pages[1].join(`
`);Ce({data:ce,additionalKeyValues:H,objectId:S.objectNumber}),ue("endobj")},st=function(){for(var S in tn)tn.hasOwnProperty(S)&&Ke(tn[S])},Ge=function(S,H){var ce,pe=[],be=1/(H-1);for(ce=0;ce<1;ce+=be)pe.push(ce);if(pe.push(1),S[0].offset!=0){var Le={offset:0,color:S[0].color};S.unshift(Le)}if(S[S.length-1].offset!=1){var We={offset:1,color:S[S.length-1].color};S.push(We)}for(var ot="",ht=0,Et=0;Et<pe.length;Et++){for(ce=pe[Et];ce>S[ht+1].offset;)ht++;var Nt=S[ht].offset,Bt=(ce-Nt)/(S[ht+1].offset-Nt),Sr=S[ht].color,Ar=S[ht+1].color;ot+=D(Math.round((1-Bt)*Sr[0]+Bt*Ar[0]).toString(16))+D(Math.round((1-Bt)*Sr[1]+Bt*Ar[1]).toString(16))+D(Math.round((1-Bt)*Sr[2]+Bt*Ar[2]).toString(16))}return ot.trim()},it=function(S,H){H||(H=21);var ce=Dr(),pe=Ge(S.colors,H),be=[];be.push({key:"FunctionType",value:"0"}),be.push({key:"Domain",value:"[0.0 1.0]"}),be.push({key:"Size",value:"["+H+"]"}),be.push({key:"BitsPerSample",value:"8"}),be.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),be.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ce({data:pe,additionalKeyValues:be,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ce}),ue("endobj"),S.objectNumber=Dr(),ue("<< /ShadingType "+S.type),ue("/ColorSpace /DeviceRGB");var Le="/Coords ["+E(parseFloat(S.coords[0]))+" "+E(parseFloat(S.coords[1]))+" ";S.type===2?Le+=E(parseFloat(S.coords[2]))+" "+E(parseFloat(S.coords[3])):Le+=E(parseFloat(S.coords[2]))+" "+E(parseFloat(S.coords[3]))+" "+E(parseFloat(S.coords[4]))+" "+E(parseFloat(S.coords[5])),ue(Le+="]"),S.matrix&&ue("/Matrix ["+S.matrix.toString()+"]"),ue("/Function "+ce+" 0 R"),ue("/Extend [true true]"),ue(">>"),ue("endobj")},wt=function(S,H){var ce=jr(),pe=Dr();H.push({resourcesOid:ce,objectOid:pe}),S.objectNumber=pe;var be=[];be.push({key:"Type",value:"/Pattern"}),be.push({key:"PatternType",value:"1"}),be.push({key:"PaintType",value:"1"}),be.push({key:"TilingType",value:"1"}),be.push({key:"BBox",value:"["+S.boundingBox.map(E).join(" ")+"]"}),be.push({key:"XStep",value:E(S.xStep)}),be.push({key:"YStep",value:E(S.yStep)}),be.push({key:"Resources",value:ce+" 0 R"}),S.matrix&&be.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),Ce({data:S.stream,additionalKeyValues:be,objectId:S.objectNumber}),ue("endobj")},Kt=function(S){var H;for(H in Ut)Ut.hasOwnProperty(H)&&(Ut[H]instanceof so?it(Ut[H]):Ut[H]instanceof cl&&wt(Ut[H],S))},sr=function(S){for(var H in S.objectNumber=Dr(),ue("<<"),S)switch(H){case"opacity":ue("/ca "+R(S[H]));break;case"stroke-opacity":ue("/CA "+R(S[H]))}ue(">>"),ue("endobj")},qr=function(){var S;for(S in gr)gr.hasOwnProperty(S)&&sr(gr[S])},os=function(){for(var S in ue("/XObject <<"),tn)tn.hasOwnProperty(S)&&tn[S].objectNumber>=0&&ue("/"+S+" "+tn[S].objectNumber+" 0 R");Ht.publish("putXobjectDict"),ue(">>")},na=function(){Pn.oid=Dr(),ue("<<"),ue("/Filter /Standard"),ue("/V "+Pn.v),ue("/R "+Pn.r),ue("/U <"+Pn.toHexString(Pn.U)+">"),ue("/O <"+Pn.toHexString(Pn.O)+">"),ue("/P "+Pn.P),ue(">>"),ue("endobj")},Ds=function(){for(var S in ue("/Font <<"),Yt)Yt.hasOwnProperty(S)&&(m===!1||m===!0&&p.hasOwnProperty(S))&&ue("/"+S+" "+Yt[S].objectNumber+" 0 R");ue(">>")},ls=function(){if(Object.keys(Ut).length>0){for(var S in ue("/Shading <<"),Ut)Ut.hasOwnProperty(S)&&Ut[S]instanceof so&&Ut[S].objectNumber>=0&&ue("/"+S+" "+Ut[S].objectNumber+" 0 R");Ht.publish("putShadingPatternDict"),ue(">>")}},Is=function(S){if(Object.keys(Ut).length>0){for(var H in ue("/Pattern <<"),Ut)Ut.hasOwnProperty(H)&&Ut[H]instanceof h.TilingPattern&&Ut[H].objectNumber>=0&&Ut[H].objectNumber<S&&ue("/"+H+" "+Ut[H].objectNumber+" 0 R");Ht.publish("putTilingPatternDict"),ue(">>")}},bi=function(){if(Object.keys(gr).length>0){var S;for(S in ue("/ExtGState <<"),gr)gr.hasOwnProperty(S)&&gr[S].objectNumber>=0&&ue("/"+S+" "+gr[S].objectNumber+" 0 R");Ht.publish("putGStateDict"),ue(">>")}},Ir=function(S){X(S.resourcesOid,!0),ue("<<"),ue("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ds(),ls(),Is(S.objectOid),bi(),os(),ue(">>"),ue("endobj")},Od=function(){var S=[];He(),qr(),st(),Kt(S),Ht.publish("putResources"),S.forEach(Ir),Ir({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),Ht.publish("postPutResources")},Dd=function(){Ht.publish("putAdditionalObjects");for(var S=0;S<ve.length;S++){var H=ve[S];X(H.objId,!0),ue(H.content),ue("endobj")}Ht.publish("postPutAdditionalObjects")},Id=function(S){fr[S.fontName]=fr[S.fontName]||{},fr[S.fontName][S.fontStyle]=S.id},yu=function(S,H,ce,pe,be){var Le={id:"F"+(Object.keys(Yt).length+1).toString(10),postScriptName:S,fontName:H,fontStyle:ce,encoding:pe,isStandardFont:be||!1,metadata:{}};return Ht.publish("addFont",{font:Le,instance:this}),Yt[Le.id]=Le,Id(Le),Le.id},$m=function(S){for(var H=0,ce=ze.length;H<ce;H++){var pe=yu.call(this,S[H][0],S[H][1],S[H][2],ze[H][3],!0);m===!1&&(p[pe]=!0);var be=S[H][0].split("-");Id({id:pe,fontName:be[0],fontStyle:be[1]||""})}Ht.publish("addFonts",{fonts:Yt,dictionary:fr})},cs=function(S){return S.foo=function(){try{return S.apply(this,arguments)}catch(pe){var H=pe.stack||"";~H.indexOf(" at ")&&(H=H.split(" at ")[1]);var ce="Error in function "+H.split(`
`)[0].split("<")[0]+": "+pe.message;if(!vt.console)throw new Error(ce);vt.console.error(ce,pe),vt.alert&&alert(ce)}},S.foo.bar=S,S.foo},Ul=function(S,H){var ce,pe,be,Le,We,ot,ht,Et,Nt;if(be=(H=H||{}).sourceEncoding||"Unicode",We=H.outputEncoding,(H.autoencode||We)&&Yt[Ct].metadata&&Yt[Ct].metadata[be]&&Yt[Ct].metadata[be].encoding&&(Le=Yt[Ct].metadata[be].encoding,!We&&Yt[Ct].encoding&&(We=Yt[Ct].encoding),!We&&Le.codePages&&(We=Le.codePages[0]),typeof We=="string"&&(We=Le[We]),We)){for(ht=!1,ot=[],ce=0,pe=S.length;ce<pe;ce++)(Et=We[S.charCodeAt(ce)])?ot.push(String.fromCharCode(Et)):ot.push(S[ce]),ot[ce].charCodeAt(0)>>8&&(ht=!0);S=ot.join("")}for(ce=S.length;ht===void 0&&ce!==0;)S.charCodeAt(ce-1)>>8&&(ht=!0),ce--;if(!ht)return S;for(ot=H.noBOM?[]:[254,255],ce=0,pe=S.length;ce<pe;ce++){if((Nt=(Et=S.charCodeAt(ce))>>8)>>8)throw new Error("Character at position "+ce+" of string '"+S+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ot.push(Nt),ot.push(Et-(Nt<<8))}return String.fromCharCode.apply(void 0,ot)},ni=h.__private__.pdfEscape=h.pdfEscape=function(S,H){return Ul(S,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wu=h.__private__.beginPage=function(S){Ee[++lr]=[],_t[lr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},Md(lr),Te(Ee[I])},Rd=function(S,H){var ce,pe,be;switch(r=H||r,typeof S=="string"&&(ce=y(S.toLowerCase()),Array.isArray(ce)&&(pe=ce[0],be=ce[1])),Array.isArray(S)&&(pe=S[0]*nt,be=S[1]*nt),isNaN(pe)&&(pe=i[0],be=i[1]),(pe>14400||be>14400)&&(ur.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),pe=Math.min(14400,pe),be=Math.min(14400,be)),i=[pe,be],r.substr(0,1)){case"l":be>pe&&(i=[be,pe]);break;case"p":pe>be&&(i=[be,pe])}wu(i),$d(Nu),ue(us),Eu!==0&&ue(Eu+" J"),ju!==0&&ue(ju+" j"),Ht.publish("addPage",{pageNumber:lr})},qm=function(S){S>0&&S<=lr&&(Ee.splice(S,1),_t.splice(S,1),lr--,I>lr&&(I=lr),this.setPage(I))},Md=function(S){S>0&&S<=lr&&(I=S)},Vm=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Ee.length-1},Bd=function(S,H,ce){var pe,be=void 0;return ce=ce||{},S=S!==void 0?S:Yt[Ct].fontName,H=H!==void 0?H:Yt[Ct].fontStyle,pe=S.toLowerCase(),fr[pe]!==void 0&&fr[pe][H]!==void 0?be=fr[pe][H]:fr[S]!==void 0&&fr[S][H]!==void 0?be=fr[S][H]:ce.disableWarning===!1&&ur.warn("Unable to look up font label for font '"+S+"', '"+H+"'. Refer to getFontList() for available fonts."),be||ce.noFallback||(be=fr.times[H])==null&&(be=fr.times.normal),be},Gm=h.__private__.putInfo=function(){var S=Dr(),H=function(pe){return pe};for(var ce in f!==null&&(H=Pn.encryptor(S,0)),ue("<<"),ue("/Producer ("+ni(H("jsPDF "+mt.version))+")"),xt)xt.hasOwnProperty(ce)&&xt[ce]&&ue("/"+ce.substr(0,1).toUpperCase()+ce.substr(1)+" ("+ni(H(xt[ce]))+")");ue("/CreationDate ("+ni(H(ne))+")"),ue(">>"),ue("endobj")},bu=h.__private__.putCatalog=function(S){var H=(S=S||{}).rootDictionaryObjId||ee;switch(Dr(),ue("<<"),ue("/Type /Catalog"),ue("/Pages "+H+" 0 R"),Ze||(Ze="fullwidth"),Ze){case"fullwidth":ue("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ue("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ue("/OpenAction [3 0 R /Fit]");break;case"original":ue("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ce=""+Ze;ce.substr(ce.length-1)==="%"&&(Ze=parseInt(Ze)/100),typeof Ze=="number"&&ue("/OpenAction [3 0 R /XYZ null null "+R(Ze)+"]")}switch(jt||(jt="continuous"),jt){case"continuous":ue("/PageLayout /OneColumn");break;case"single":ue("/PageLayout /SinglePage");break;case"two":case"twoleft":ue("/PageLayout /TwoColumnLeft");break;case"tworight":ue("/PageLayout /TwoColumnRight")}dt&&ue("/PageMode /"+dt),Ht.publish("putCatalog"),ue(">>"),ue("endobj")},Ym=h.__private__.putTrailer=function(){ue("trailer"),ue("<<"),ue("/Size "+(V+1)),ue("/Root "+V+" 0 R"),ue("/Info "+(V-1)+" 0 R"),f!==null&&ue("/Encrypt "+Pn.oid+" 0 R"),ue("/ID [ <"+U+"> <"+U+"> ]"),ue(">>")},Km=h.__private__.putHeader=function(){ue("%PDF-"+v),ue("%ºß¬à")},Xm=h.__private__.putXRef=function(){var S="0000000000";ue("xref"),ue("0 "+(V+1)),ue("0000000000 65535 f ");for(var H=1;H<=V;H++)typeof se[H]=="function"?ue((S+se[H]()).slice(-10)+" 00000 n "):se[H]!==void 0?ue((S+se[H]).slice(-10)+" 00000 n "):ue("0000000000 00000 n ")},ia=h.__private__.buildDocument=function(){Qe(),Te(fe),Ht.publish("buildDocument"),Km(),je(),Dd(),Od(),f!==null&&na(),Gm(),bu();var S=de;return Xm(),Ym(),ue("startxref"),ue(""+S),ue("%%EOF"),Te(Ee[I]),fe.join(`
`)},zl=h.__private__.getBlob=function(S){return new Blob([at(S)],{type:"application/pdf"})},Wl=h.output=h.__private__.output=cs(function(S,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",S){case void 0:return ia();case"save":h.save(H.filename);break;case"arraybuffer":return at(ia());case"blob":return zl(ia());case"bloburi":case"bloburl":if(vt.URL!==void 0&&typeof vt.URL.createObjectURL=="function")return vt.URL&&vt.URL.createObjectURL(zl(ia()))||void 0;ur.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ce="",pe=ia();try{ce=Ug(pe)}catch{ce=Ug(unescape(encodeURIComponent(pe)))}return"data:application/pdf;filename="+H.filename+";base64,"+ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(vt)==="[object Window]"){var be="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Le=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(be=H.pdfObjectUrl,Le="");var We='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+be+'"'+Le+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",ot=vt.open();return ot!==null&&ot.document.write(We),ot}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(vt)==="[object Window]"){var ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',Et=vt.open();if(Et!==null){Et.document.write(ht);var Nt=this;Et.document.documentElement.querySelector("#pdfViewer").onload=function(){Et.document.title=H.filename,Et.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Nt.output("bloburl"))}}return Et}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(vt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Bt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',Sr=vt.open();if(Sr!==null&&(Sr.document.write(Bt),Sr.document.title=H.filename),Sr||typeof safari>"u")return Sr;break;case"datauri":case"dataurl":return vt.document.location.href=this.output("datauristring",H);default:return null}}),Ud=function(S){return Array.isArray(ra)===!0&&ra.indexOf(S)>-1};switch(n){case"pt":nt=1;break;case"mm":nt=72/25.4;break;case"cm":nt=72/2.54;break;case"in":nt=72;break;case"px":nt=Ud("px_scaling")==1?.75:96/72;break;case"pc":case"em":nt=12;break;case"ex":nt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);nt=n}var Pn=null;he(),B();var Jm=function(S){return f!==null?Pn.encryptor(S,0):function(H){return H}},zd=h.__private__.getPageInfo=h.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_t[S].objId,pageNumber:S,pageContext:_t[S]}},St=h.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in _t)if(_t[H].objId===S)break;return zd(H)},Qm=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:_t[I].objId,pageNumber:I,pageContext:_t[I]}};h.addPage=function(){return Rd.apply(this,arguments),this},h.setPage=function(){return Md.apply(this,arguments),Te.call(this,Ee[I]),this},h.insertPage=function(S){return this.addPage(),this.movePage(I,S),this},h.movePage=function(S,H){var ce,pe;if(S>H){ce=Ee[S],pe=_t[S];for(var be=S;be>H;be--)Ee[be]=Ee[be-1],_t[be]=_t[be-1];Ee[H]=ce,_t[H]=pe,this.setPage(H)}else if(S<H){ce=Ee[S],pe=_t[S];for(var Le=S;Le<H;Le++)Ee[Le]=Ee[Le+1],_t[Le]=_t[Le+1];Ee[H]=ce,_t[H]=pe,this.setPage(H)}return this},h.deletePage=function(){return qm.apply(this,arguments),this},h.__private__.text=h.text=function(S,H,ce,pe,be){var Le,We,ot,ht,Et,Nt,Bt,Sr,Ar,Vr=(pe=pe||{}).scope||this;if(typeof S=="number"&&typeof H=="number"&&(typeof ce=="string"||Array.isArray(ce))){var Ln=ce;ce=H,H=S,S=Ln}if(arguments[3]instanceof pt?(C("The transform parameter of text() with a Matrix value"),Ar=be):(ot=arguments[4],ht=arguments[5],tr(Bt=arguments[3])==="object"&&Bt!==null||(typeof ot=="string"&&(ht=ot,ot=null),typeof Bt=="string"&&(ht=Bt,Bt=null),typeof Bt=="number"&&(ot=Bt,Bt=null),pe={flags:Bt,angle:ot,align:ht})),isNaN(H)||isNaN(ce)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return Vr;var ln="",fs=!1,_i=typeof pe.lineHeightFactor=="number"?pe.lineHeightFactor:Wo,Bs=Vr.internal.scaleFactor;function Xd(dr){return dr=dr.split("	").join(Array(pe.TabLen||9).join(" ")),ni(dr,Bt)}function Lu(dr){for(var hr,Mr=dr.concat(),rn=[],ca=Mr.length;ca--;)typeof(hr=Mr.shift())=="string"?rn.push(hr):Array.isArray(dr)&&(hr.length===1||hr[1]===void 0&&hr[2]===void 0)?rn.push(hr[0]):rn.push([hr[0],hr[1],hr[2]]);return rn}function Fu(dr,hr){var Mr;if(typeof dr=="string")Mr=hr(dr)[0];else if(Array.isArray(dr)){for(var rn,ca,zu=dr.concat(),nc=[],th=zu.length;th--;)typeof(rn=zu.shift())=="string"?nc.push(hr(rn)[0]):Array.isArray(rn)&&typeof rn[0]=="string"&&(ca=hr(rn[0],rn[1],rn[2]),nc.push([ca[0],ca[1],ca[2]]));Mr=nc}return Mr}var Yl=!1,Ou=!0;if(typeof S=="string")Yl=!0;else if(Array.isArray(S)){var Du=S.concat();We=[];for(var Kl,yn=Du.length;yn--;)(typeof(Kl=Du.shift())!="string"||Array.isArray(Kl)&&typeof Kl[0]!="string")&&(Ou=!1);Yl=Ou}if(Yl===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var Xl=Ye/Vr.internal.scaleFactor,Jl=Xl*(_i-1);switch(pe.baseline){case"bottom":ce-=Jl;break;case"top":ce+=Xl-Jl;break;case"hanging":ce+=Xl-2*Jl;break;case"middle":ce+=Xl/2-Jl}if((Nt=pe.maxWidth||0)>0&&(typeof S=="string"?S=Vr.splitTextToSize(S,Nt):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(dr,hr){return dr.concat(Vr.splitTextToSize(hr,Nt))},[]))),Le={text:S,x:H,y:ce,options:pe,mutex:{pdfEscape:ni,activeFontKey:Ct,fonts:Yt,activeFontSize:Ye}},Ht.publish("preProcessText",Le),S=Le.text,ot=(pe=Le.options).angle,!(Ar instanceof pt)&&ot&&typeof ot=="number"){ot*=Math.PI/180,pe.rotationDirection===0&&(ot=-ot),_===w.ADVANCED&&(ot=-ot);var Ql=Math.cos(ot),Iu=Math.sin(ot);Ar=new pt(Ql,Iu,-Iu,Ql,0,0)}else ot&&ot instanceof pt&&(Ar=ot);_!==w.ADVANCED||Ar||(Ar=ri),(Et=pe.charSpace||ql)!==void 0&&(ln+=E(A(Et))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Sr=pe.horizontalScale)!==void 0&&(ln+=E(100*Sr)+` Tz
`),pe.lang;var ii=-1,lp=pe.renderingMode!==void 0?pe.renderingMode:pe.stroke,Ru=Vr.internal.getCurrentPageInfo().pageContext;switch(lp){case 0:case!1:case"fill":ii=0;break;case 1:case!0:case"stroke":ii=1;break;case 2:case"fillThenStroke":ii=2;break;case 3:case"invisible":ii=3;break;case 4:case"fillAndAddForClipping":ii=4;break;case 5:case"strokeAndAddPathForClipping":ii=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ii=6;break;case 7:case"addToPathForClipping":ii=7}var Jd=Ru.usedRenderingMode!==void 0?Ru.usedRenderingMode:-1;ii!==-1?ln+=ii+` Tr
`:Jd!==-1&&(ln+=`0 Tr
`),ii!==-1&&(Ru.usedRenderingMode=ii),ht=pe.align||"left";var Hi,Zl=Ye*_i,Qd=Vr.internal.pageSize.getWidth(),Zd=Yt[Ct];Et=pe.charSpace||ql,Nt=pe.maxWidth||0,Bt=Object.assign({autoencode:!0,noBOM:!0},pe.flags);var Da=[],qo=function(dr){return Vr.getStringUnitWidth(dr,{font:Zd,charSpace:Et,fontSize:Ye,doKerning:!1})*Ye/Bs};if(Object.prototype.toString.call(S)==="[object Array]"){var si;We=Lu(S),ht!=="left"&&(Hi=We.map(qo));var $n,Ia=0;if(ht==="right"){H-=Hi[0],S=[],yn=We.length;for(var aa=0;aa<yn;aa++)aa===0?($n=Ms(H),si=sa(ce)):($n=A(Ia-Hi[aa]),si=-Zl),S.push([We[aa],$n,si]),Ia=Hi[aa]}else if(ht==="center"){H-=Hi[0]/2,S=[],yn=We.length;for(var oa=0;oa<yn;oa++)oa===0?($n=Ms(H),si=sa(ce)):($n=A((Ia-Hi[oa])/2),si=-Zl),S.push([We[oa],$n,si]),Ia=Hi[oa]}else if(ht==="left"){S=[],yn=We.length;for(var ec=0;ec<yn;ec++)S.push(We[ec])}else if(ht==="justify"&&Zd.encoding==="Identity-H"){S=[],yn=We.length,Nt=Nt!==0?Nt:Qd;for(var la=0,Rr=0;Rr<yn;Rr++)if(si=Rr===0?sa(ce):-Zl,$n=Rr===0?Ms(H):la,Rr<yn-1){var Mu=A((Nt-Hi[Rr])/(We[Rr].split(" ").length-1)),qn=We[Rr].split(" ");S.push([qn[0]+" ",$n,si]),la=0;for(var $i=1;$i<qn.length;$i++){var tc=(qo(qn[$i-1]+" "+qn[$i])-qo(qn[$i]))*Bs+Mu;$i==qn.length-1?S.push([qn[$i],tc,0]):S.push([qn[$i]+" ",tc,0]),la-=tc}}else S.push([We[Rr],$n,si]);S.push(["",la,0])}else{if(ht!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],yn=We.length,Nt=Nt!==0?Nt:Qd,Rr=0;Rr<yn;Rr++)si=Rr===0?sa(ce):-Zl,$n=Rr===0?Ms(H):0,Rr<yn-1?Da.push(E(A((Nt-Hi[Rr])/(We[Rr].split(" ").length-1)))):Da.push(0),S.push([We[Rr],$n,si])}}var eh=typeof pe.R2L=="boolean"?pe.R2L:ft;eh===!0&&(S=Fu(S,function(dr,hr,Mr){return[dr.split("").reverse().join(""),hr,Mr]})),Le={text:S,x:H,y:ce,options:pe,mutex:{pdfEscape:ni,activeFontKey:Ct,fonts:Yt,activeFontSize:Ye}},Ht.publish("postProcessText",Le),S=Le.text,fs=Le.mutex.isHex||!1;var Bu=Yt[Ct].encoding;Bu!=="WinAnsiEncoding"&&Bu!=="StandardEncoding"||(S=Fu(S,function(dr,hr,Mr){return[Xd(dr),hr,Mr]})),We=Lu(S),S=[];for(var Vo,Go,Ra,Yo=0,rc=1,Ko=Array.isArray(We[0])?rc:Yo,Ma="",Uu=function(dr,hr,Mr){var rn="";return Mr instanceof pt?(Mr=typeof pe.angle=="number"?wi(Mr,new pt(1,0,0,1,dr,hr)):wi(new pt(1,0,0,1,dr,hr),Mr),_===w.ADVANCED&&(Mr=wi(new pt(1,0,0,-1,0,0),Mr)),rn=Mr.join(" ")+` Tm
`):rn=E(dr)+" "+E(hr)+` Td
`,rn},qi=0;qi<We.length;qi++){switch(Ma="",Ko){case rc:Ra=(fs?"<":"(")+We[qi][0]+(fs?">":")"),Vo=parseFloat(We[qi][1]),Go=parseFloat(We[qi][2]);break;case Yo:Ra=(fs?"<":"(")+We[qi]+(fs?">":")"),Vo=Ms(H),Go=sa(ce)}Da!==void 0&&Da[qi]!==void 0&&(Ma=Da[qi]+` Tw
`),qi===0?S.push(Ma+Uu(Vo,Go,Ar)+Ra):Ko===Yo?S.push(Ma+Ra):Ko===rc&&S.push(Ma+Uu(Vo,Go,Ar)+Ra)}S=Ko===Yo?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var Vi=`BT
/`;return Vi+=Ct+" "+Ye+` Tf
`,Vi+=E(Ye*_i)+` TL
`,Vi+=Ho+`
`,Vi+=ln,Vi+=S,ue(Vi+="ET"),p[Ct]=!0,Vr};var Zm=h.__private__.clip=h.clip=function(S){return ue(S==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Zm("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ue("n"),this};var Rs=h.__private__.isValidStyle=function(S){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(H=!0),H};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(S){return Rs(S)&&(u=S),this};var Wd=h.__private__.getStyle=h.getStyle=function(S){var H=u;switch(S){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=S}return H},Hd=h.close=function(){return ue("h"),this};h.stroke=function(){return ue("S"),this},h.fill=function(S){return Hl("f",S),this},h.fillEvenOdd=function(S){return Hl("f*",S),this},h.fillStroke=function(S){return Hl("B",S),this},h.fillStrokeEvenOdd=function(S){return Hl("B*",S),this};var Hl=function(S,H){tr(H)==="object"?tp(H,S):ue(S)},_u=function(S){S===null||_===w.ADVANCED&&S===void 0||(S=Wd(S),ue(S))};function ep(S,H,ce,pe,be){var Le=new cl(H||this.boundingBox,ce||this.xStep,pe||this.yStep,this.gState,be||this.matrix);Le.stream=this.stream;var We=S+"$$"+this.cloneIndex+++"$$";return Cn(We,Le),Le}var tp=function(S,H){var ce=Os[S.key],pe=Ut[ce];if(pe instanceof so)ue("q"),ue(rp(H)),pe.gState&&h.setGState(pe.gState),ue(S.matrix.toString()+" cm"),ue("/"+ce+" sh"),ue("Q");else if(pe instanceof cl){var be=new pt(1,0,0,-1,0,Oa());S.matrix&&(be=be.multiply(S.matrix||ri),ce=ep.call(pe,S.key,S.boundingBox,S.xStep,S.yStep,be).id),ue("q"),ue("/Pattern cs"),ue("/"+ce+" scn"),pe.gState&&h.setGState(pe.gState),ue(H),ue("Q")}},rp=function(S){switch(S){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Su=h.moveTo=function(S,H){return ue(E(A(S))+" "+E(z(H))+" m"),this},zo=h.lineTo=function(S,H){return ue(E(A(S))+" "+E(z(H))+" l"),this},La=h.curveTo=function(S,H,ce,pe,be,Le){return ue([E(A(S)),E(z(H)),E(A(ce)),E(z(pe)),E(A(be)),E(z(Le)),"c"].join(" ")),this};h.__private__.line=h.line=function(S,H,ce,pe,be){if(isNaN(S)||isNaN(H)||isNaN(ce)||isNaN(pe)||!Rs(be))throw new Error("Invalid arguments passed to jsPDF.line");return _===w.COMPAT?this.lines([[ce-S,pe-H]],S,H,[1,1],be||"S"):this.lines([[ce-S,pe-H]],S,H,[1,1]).stroke()},h.__private__.lines=h.lines=function(S,H,ce,pe,be,Le){var We,ot,ht,Et,Nt,Bt,Sr,Ar,Vr,Ln,ln,fs;if(typeof S=="number"&&(fs=ce,ce=H,H=S,S=fs),pe=pe||[1,1],Le=Le||!1,isNaN(H)||isNaN(ce)||!Array.isArray(S)||!Array.isArray(pe)||!Rs(be)||typeof Le!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Su(H,ce),We=pe[0],ot=pe[1],Et=S.length,Ln=H,ln=ce,ht=0;ht<Et;ht++)(Nt=S[ht]).length===2?(Ln=Nt[0]*We+Ln,ln=Nt[1]*ot+ln,zo(Ln,ln)):(Bt=Nt[0]*We+Ln,Sr=Nt[1]*ot+ln,Ar=Nt[2]*We+Ln,Vr=Nt[3]*ot+ln,Ln=Nt[4]*We+Ln,ln=Nt[5]*ot+ln,La(Bt,Sr,Ar,Vr,Ln,ln));return Le&&Hd(),_u(be),this},h.path=function(S){for(var H=0;H<S.length;H++){var ce=S[H],pe=ce.c;switch(ce.op){case"m":Su(pe[0],pe[1]);break;case"l":zo(pe[0],pe[1]);break;case"c":La.apply(this,pe);break;case"h":Hd()}}return this},h.__private__.rect=h.rect=function(S,H,ce,pe,be){if(isNaN(S)||isNaN(H)||isNaN(ce)||isNaN(pe)||!Rs(be))throw new Error("Invalid arguments passed to jsPDF.rect");return _===w.COMPAT&&(pe=-pe),ue([E(A(S)),E(z(H)),E(A(ce)),E(A(pe)),"re"].join(" ")),_u(be),this},h.__private__.triangle=h.triangle=function(S,H,ce,pe,be,Le,We){if(isNaN(S)||isNaN(H)||isNaN(ce)||isNaN(pe)||isNaN(be)||isNaN(Le)||!Rs(We))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ce-S,pe-H],[be-ce,Le-pe],[S-be,H-Le]],S,H,[1,1],We,!0),this},h.__private__.roundedRect=h.roundedRect=function(S,H,ce,pe,be,Le,We){if(isNaN(S)||isNaN(H)||isNaN(ce)||isNaN(pe)||isNaN(be)||isNaN(Le)||!Rs(We))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ot=4/3*(Math.SQRT2-1);return be=Math.min(be,.5*ce),Le=Math.min(Le,.5*pe),this.lines([[ce-2*be,0],[be*ot,0,be,Le-Le*ot,be,Le],[0,pe-2*Le],[0,Le*ot,-be*ot,Le,-be,Le],[2*be-ce,0],[-be*ot,0,-be,-Le*ot,-be,-Le],[0,2*Le-pe],[0,-Le*ot,be*ot,-Le,be,-Le]],S+be,H,[1,1],We,!0),this},h.__private__.ellipse=h.ellipse=function(S,H,ce,pe,be){if(isNaN(S)||isNaN(H)||isNaN(ce)||isNaN(pe)||!Rs(be))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Le=4/3*(Math.SQRT2-1)*ce,We=4/3*(Math.SQRT2-1)*pe;return Su(S+ce,H),La(S+ce,H-We,S+Le,H-pe,S,H-pe),La(S-Le,H-pe,S-ce,H-We,S-ce,H),La(S-ce,H+We,S-Le,H+pe,S,H+pe),La(S+Le,H+pe,S+ce,H+We,S+ce,H),_u(be),this},h.__private__.circle=h.circle=function(S,H,ce,pe){if(isNaN(S)||isNaN(H)||isNaN(ce)||!Rs(pe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,H,ce,ce,pe)},h.setFont=function(S,H,ce){return ce&&(H=L(H,ce)),Ct=Bd(S,H,{disableWarning:!1}),this};var np=h.__private__.getFont=h.getFont=function(){return Yt[Bd.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var S,H,ce={};for(S in fr)if(fr.hasOwnProperty(S))for(H in ce[S]=[],fr[S])fr[S].hasOwnProperty(H)&&ce[S].push(H);return ce},h.addFont=function(S,H,ce,pe,be){var Le=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Le.indexOf(arguments[3])!==-1?be=arguments[3]:arguments[3]&&Le.indexOf(arguments[3])==-1&&(ce=L(ce,pe)),be=be||"Identity-H",yu.call(this,S,H,ce,be)};var Wo,Nu=e.lineWidth||.200025,$l=h.__private__.getLineWidth=h.getLineWidth=function(){return Nu},$d=h.__private__.setLineWidth=h.setLineWidth=function(S){return Nu=S,ue(E(A(S))+" w"),this};h.__private__.setLineDash=mt.API.setLineDash=mt.API.setLineDashPattern=function(S,H){if(S=S||[],H=H||0,isNaN(H)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(ce){return E(A(ce))}).join(" "),H=E(A(H)),ue("["+S+"] "+H+" d"),this};var qd=h.__private__.getLineHeight=h.getLineHeight=function(){return Ye*Wo};h.__private__.getLineHeight=h.getLineHeight=function(){return Ye*Wo};var Vd=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(Wo=S),this},Gd=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Wo};Vd(e.lineHeight);var Ms=h.__private__.getHorizontalCoordinate=function(S){return A(S)},sa=h.__private__.getVerticalCoordinate=function(S){return _===w.ADVANCED?S:_t[I].mediaBox.topRightY-_t[I].mediaBox.bottomLeftY-A(S)},ip=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(S){return E(Ms(S))},Fa=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(S){return E(sa(S))},us=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ae(us)},h.__private__.setStrokeColor=h.setDrawColor=function(S,H,ce,pe){return us=le({ch1:S,ch2:H,ch3:ce,ch4:pe,pdfColorType:"draw",precision:2}),ue(us),this};var ku=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ae(ku)},h.__private__.setFillColor=h.setFillColor=function(S,H,ce,pe){return ku=le({ch1:S,ch2:H,ch3:ce,ch4:pe,pdfColorType:"fill",precision:2}),ue(ku),this};var Ho=e.textColor||"0 g",sp=h.__private__.getTextColor=h.getTextColor=function(){return ae(Ho)};h.__private__.setTextColor=h.setTextColor=function(S,H,ce,pe){return Ho=le({ch1:S,ch2:H,ch3:ce,ch4:pe,pdfColorType:"text",precision:3}),this};var ql=e.charSpace,ap=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(ql||0)};h.__private__.setCharSpace=h.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ql=S,this};var Eu=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(S){var H=h.CapJoinStyles[S];if(H===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Eu=H,ue(H+" J"),this};var ju=0;h.__private__.setLineJoin=h.setLineJoin=function(S){var H=h.CapJoinStyles[S];if(H===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ju=H,ue(H+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ue(E(A(S))+" M"),this},h.GState=fd,h.setGState=function(S){(S=typeof S=="string"?gr[yi[S]]:Yd(null,S)).equals(as)||(ue("/"+S.id+" gs"),as=S)};var Yd=function(S,H){if(!S||!yi[S]){var ce=!1;for(var pe in gr)if(gr.hasOwnProperty(pe)&&gr[pe].equals(H)){ce=!0;break}if(ce)H=gr[pe];else{var be="GS"+(Object.keys(gr).length+1).toString(10);gr[be]=H,H.id=be}return S&&(yi[S]=H.id),Ht.publish("addGState",H),H}};h.addGState=function(S,H){return Yd(S,H),this},h.saveGraphicsState=function(){return ue("q"),Ui.push({key:Ct,size:Ye,color:Ho}),this},h.restoreGraphicsState=function(){ue("Q");var S=Ui.pop();return Ct=S.key,Ye=S.size,Ho=S.color,as=null,this},h.setCurrentTransformationMatrix=function(S){return ue(S.toString()+" cm"),this},h.comment=function(S){return ue("#"+S),this};var Vl=function(S,H){var ce=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ce},set:function(Le){isNaN(Le)||(ce=parseFloat(Le))}});var pe=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return pe},set:function(Le){isNaN(Le)||(pe=parseFloat(Le))}});var be="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return be},set:function(Le){be=Le.toString()}}),this},Au=function(S,H,ce,pe){Vl.call(this,S,H),this.type="rect";var be=ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return be},set:function(We){isNaN(We)||(be=parseFloat(We))}});var Le=pe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Le},set:function(We){isNaN(We)||(Le=parseFloat(We))}}),this},Tu=function(){this.page=lr,this.currentPage=I,this.pages=Ee.slice(0),this.pagesContext=_t.slice(0),this.x=en,this.y=Rt,this.matrix=ti,this.width=$o(I),this.height=Oa(I),this.outputDestination=Ve,this.id="",this.objectNumber=-1};Tu.prototype.restore=function(){lr=this.page,I=this.currentPage,_t=this.pagesContext,Ee=this.pages,en=this.x,Rt=this.y,ti=this.matrix,Cu(I,this.width),Pu(I,this.height),Ve=this.outputDestination};var Kd=function(S,H,ce,pe,be){Wi.push(new Tu),lr=I=0,Ee=[],en=S,Rt=H,ti=be,wu([ce,pe])},op=function(S){if(zi[S])Wi.pop().restore();else{var H=new Tu,ce="Xo"+(Object.keys(tn).length+1).toString(10);H.id=ce,zi[S]=ce,tn[ce]=H,Ht.publish("addFormObject",H),Wi.pop().restore()}};for(var Gl in h.beginFormObject=function(S,H,ce,pe,be){return Kd(S,H,ce,pe,be),this},h.endFormObject=function(S){return op(S),this},h.doFormObject=function(S,H){var ce=tn[zi[S]];return ue("q"),ue(H.toString()+" cm"),ue("/"+ce.id+" Do"),ue("Q"),this},h.getFormObject=function(S){var H=tn[zi[S]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},h.save=function(S,H){return S=S||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(nl(zl(ia()),S),typeof nl.unload=="function"&&vt.setTimeout&&setTimeout(nl.unload,911),this):new Promise(function(ce,pe){try{var be=nl(zl(ia()),S);typeof nl.unload=="function"&&vt.setTimeout&&setTimeout(nl.unload,911),ce(be)}catch(Le){pe(Le.message)}})},mt.API)mt.API.hasOwnProperty(Gl)&&(Gl==="events"&&mt.API.events.length?function(S,H){var ce,pe,be;for(be=H.length-1;be!==-1;be--)ce=H[be][0],pe=H[be][1],S.subscribe.apply(S,[ce].concat(typeof pe=="function"?[pe]:pe))}(Ht,mt.API.events):h[Gl]=mt.API[Gl]);var $o=h.getPageWidth=function(S){return(_t[S=S||I].mediaBox.topRightX-_t[S].mediaBox.bottomLeftX)/nt},Cu=h.setPageWidth=function(S,H){_t[S].mediaBox.topRightX=H*nt+_t[S].mediaBox.bottomLeftX},Oa=h.getPageHeight=function(S){return(_t[S=S||I].mediaBox.topRightY-_t[S].mediaBox.bottomLeftY)/nt},Pu=h.setPageHeight=function(S,H){_t[S].mediaBox.topRightY=H*nt+_t[S].mediaBox.bottomLeftY};return h.internal={pdfEscape:ni,getStyle:Wd,getFont:np,getFontSize:tt,getCharSpace:ap,getTextColor:sp,getLineHeight:qd,getLineHeightFactor:Gd,getLineWidth:$l,write:Me,getHorizontalCoordinate:Ms,getVerticalCoordinate:sa,getCoordinateString:ip,getVerticalCoordinateString:Fa,collections:{},newObject:Dr,newAdditionalObject:oe,newObjectDeferred:jr,newObjectDeferredBegin:X,getFilters:Se,putStream:Ce,events:Ht,scaleFactor:nt,pageSize:{getWidth:function(){return $o(I)},setWidth:function(S){Cu(I,S)},getHeight:function(){return Oa(I)},setHeight:function(S){Pu(I,S)}},encryptionOptions:f,encryption:Pn,getEncryptor:Jm,output:Wl,getNumberOfPages:Vm,pages:Ee,out:ue,f2:R,f3:T,getPageInfo:zd,getPageInfoByObjId:St,getCurrentPageInfo:Qm,getPDFVersion:g,Point:Vl,Rectangle:Au,Matrix:pt,hasHotfix:Ud},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return $o(I)},set:function(S){Cu(I,S)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Oa(I)},set:function(S){Pu(I,S)},enumerable:!0,configurable:!0}),$m.call(h,ze),Ct="F1",Rd(i,r),Ht.publish("initialized"),h}wc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},wc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},wc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},wc.prototype.processOwnerPassword=function(e,t){return Wg(zg(t).substr(0,5),e)},wc.prototype.encryptor=function(e,t){var r=zg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Wg(r,n)}},fd.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||tr(e)!==tr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},mt.API={events:[]},mt.version="2.5.2";var Cr=mt.API,ox=1,Ol=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},mc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},kt=function(e){return e.toFixed(2)},Ka=function(e){return e.toFixed(5)};Cr.__acroform__={};var vi=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Qy=function(e){return e*ox},Hs=function(e){var t=new L_,r=ut.internal.getHeight(e)||0,n=ut.internal.getWidth(e)||0;return t.BBox=[0,0,Number(kt(n)),Number(kt(r))],t},LC=Cr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},FC=Cr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},OC=Cr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Ur=Cr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return OC(e,t-1)},zr=Cr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return LC(e,t-1)},Wr=Cr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return FC(e,t-1)},DC=Cr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],a=e[2],o=e[3],l={};return l.lowerLeft_X=r(i)||0,l.lowerLeft_Y=n(s+o)||0,l.upperRight_X=r(i+a)||0,l.upperRight_Y=n(s)||0,[Number(kt(l.lowerLeft_X)),Number(kt(l.lowerLeft_Y)),Number(kt(l.upperRight_X)),Number(kt(l.upperRight_Y))]},IC=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Hg(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+kt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Hs(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},Hg=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(T){return T.split(`
`)}):i.map(function(T){return[T]});var s=r,a=ut.internal.getHeight(e)||0;a=a<0?-a:a;var o=ut.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(T,A,q){if(T+1<i.length){var z=A+" "+i[T+1][0];return $h(z,e,q).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var u,f,m=$h("3",e,s).height,p=e.multiline?a-s:(a-m)/2,h=p+=2,v=0,g=0,b=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+$h(t,e,s=12).width+", FieldWidth:"+o+`
`;break}for(var y="",w=0,_=0;_<i.length;_++)if(i.hasOwnProperty(_)){var j=!1;if(i[_].length!==1&&b!==i[_].length-1){if((m+2)*(w+2)+2>a)continue e;y+=i[_][b],j=!0,g=_,_--}else{y=(y+=i[_][b]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var O=parseInt(_),L=l(O,y,s),E=_>=i.length-1;if(L&&!E){y+=" ",b=0;continue}if(L||E){if(E)g=O;else if(e.multiline&&(m+2)*(w+2)+2>a)continue e}else{if(!e.multiline||(m+2)*(w+2)+2>a)continue e;g=O}}for(var C="",P=v;P<=g;P++){var R=i[P];if(e.multiline){if(P===g){C+=R[b]+" ",b=(b+1)%R.length;continue}if(P===v){C+=R[R.length-1]+" ";continue}}C+=R[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,f=$h(C,e,s).width,e.textAlign){case"right":u=o-f-2;break;case"center":u=(o-f)/2;break;case"left":default:u=2}t+=kt(u)+" "+kt(h)+` Td
`,t+="("+Ol(C)+`) Tj
`,t+=-kt(u)+` 0 Td
`,h=-(s+2),f=0,v=j?g:g+1,w++,y=""}break}return n.text=t,n.fontSize=s,n},$h=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},RC={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},MC=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},BC=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,i=e[r];t.internal.newObjectDeferredBegin(i.objId,!0),tr(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[n]}},UC=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Ls.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(RC)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ox=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new F_,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&MC(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var a in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],l=[],u=o.Rect;if(o.Rect&&(o.Rect=DC(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ut.createDefaultAppearanceStream(o),tr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=IC(o);l.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var m="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var h=o.appearanceStreamContent[p];if(m+="/"+p+" ",m+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var a in h)if(h.hasOwnProperty(a)){var v=h[a];typeof v=="function"&&(v=v.call(i,o)),m+="/"+a+" "+v+" ",i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v)}}else typeof(v=h)=="function"&&(v=v.call(i,o)),m+="/"+a+" "+v,i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v);m+=">>"}l.push({key:"AP",value:`<<
`+m+">>"})}i.internal.putStream({additionalKeyValues:l,objectId:o.objId}),i.internal.out("endobj")}s&&BC(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},P_=Cr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(a){return a};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),tr(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+Ol(n(e[s].toString()))+")"):i+=e[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},m1=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Ol(n(e))+")"},Ys=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ys.prototype.toString=function(){return this.objId+" 0 R"},Ys.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ys.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:P_(i,this.objId,this.scope)}):i instanceof Ys?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var L_=function(){Ys.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};vi(L_,Ys);var F_=function(){Ys.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Ol(r(e))+")"}},set:function(r){e=r}})};vi(F_,Ys);var Ls=function e(){Ys.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ur(t,3)},set:function(y){y?this.F=zr(t,3):this.F=Wr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof $0)return;s="FieldObject"+e.FieldNum++}var y=function(w){return w};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+Ol(y(s))+")"},set:function(y){s=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(y){s=y}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(y){a=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/ox:u},set:function(y){u=y}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(y){f=y}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof $0||this instanceof So))return m1(m,this.objId,this.scope)},set:function(y){y=y.toString(),m=y}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof an?p:m1(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=this instanceof an?y:y.substr(0,1)==="("?mc(y.substr(1,y.length-2)):mc(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof an?mc(p.substr(1,p.length-1)):p},set:function(y){y=y.toString(),p=this instanceof an?"/"+y:y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof an?h:m1(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof an?y:y.substr(0,1)==="("?mc(y.substr(1,y.length-2)):mc(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof an?mc(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof an?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(y){y=!!y,g=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(y){v=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,1)},set:function(y){y?this.Ff=zr(this.Ff,1):this.Ff=Wr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,2)},set:function(y){y?this.Ff=zr(this.Ff,2):this.Ff=Wr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,3)},set:function(y){y?this.Ff=zr(this.Ff,3):this.Ff=Wr(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');b=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(b){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};vi(Ls,Ys);var pl=function(){Ls.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return P_(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,a,o){o||(o=1);for(var l,u=[];l=a.exec(s);)u.push(l[o]);return u}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,18)},set:function(r){r?this.Ff=zr(this.Ff,18):this.Ff=Wr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=zr(this.Ff,19):this.Ff=Wr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,20)},set:function(r){r?(this.Ff=zr(this.Ff,20),t.sort()):this.Ff=Wr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,22)},set:function(r){r?this.Ff=zr(this.Ff,22):this.Ff=Wr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,23)},set:function(r){r?this.Ff=zr(this.Ff,23):this.Ff=Wr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,27)},set:function(r){r?this.Ff=zr(this.Ff,27):this.Ff=Wr(this.Ff,27)}}),this.hasAppearanceStream=!1};vi(pl,Ls);var gl=function(){pl.call(this),this.fontName="helvetica",this.combo=!1};vi(gl,pl);var xl=function(){gl.call(this),this.combo=!0};vi(xl,gl);var Pf=function(){xl.call(this),this.edit=!0};vi(Pf,xl);var an=function(){Ls.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,15)},set:function(r){r?this.Ff=zr(this.Ff,15):this.Ff=Wr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,16)},set:function(r){r?this.Ff=zr(this.Ff,16):this.Ff=Wr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,17)},set:function(r){r?this.Ff=zr(this.Ff,17):this.Ff=Wr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,26)},set:function(r){r?this.Ff=zr(this.Ff,26):this.Ff=Wr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+Ol(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){tr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};vi(an,Ls);var Lf=function(){an.call(this),this.pushButton=!0};vi(Lf,an);var vl=function(){an.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};vi(vl,an);var $0=function(){var e,t;Ls.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),n)a.push("/"+s+" ("+Ol(i(n[s]))+")");return a.push(">>"),a.join(`
`)},set:function(i){tr(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ut.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};vi($0,Ls),vl.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},vl.prototype.createOption=function(e){var t=new $0;return t.Parent=this,t.optionName=e,this.Kids.push(t),zC.call(this.scope,t),t};var Ff=function(){an.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ut.CheckBox.createAppearanceStream()};vi(Ff,an);var So=function(){Ls.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,13)},set:function(t){t?this.Ff=zr(this.Ff,13):this.Ff=Wr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,21)},set:function(t){t?this.Ff=zr(this.Ff,21):this.Ff=Wr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,23)},set:function(t){t?this.Ff=zr(this.Ff,23):this.Ff=Wr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,24)},set:function(t){t?this.Ff=zr(this.Ff,24):this.Ff=Wr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,25)},set:function(t){t?this.Ff=zr(this.Ff,25):this.Ff=Wr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,26)},set:function(t){t?this.Ff=zr(this.Ff,26):this.Ff=Wr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};vi(So,Ls);var Of=function(){So.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,14)},set:function(e){e?this.Ff=zr(this.Ff,14):this.Ff=Wr(this.Ff,14)}}),this.password=!0};vi(Of,So);var ut={CheckBox:{createAppearanceStream:function(){return{N:{On:ut.CheckBox.YesNormal},D:{On:ut.CheckBox.YesPushDown,Off:ut.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Hs(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=Hg(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+kt(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Hs(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=ut.internal.getHeight(e),a=ut.internal.getWidth(e),o=Hg(e,e.caption);return i.push("1 g"),i.push("0 0 "+kt(a)+" "+kt(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+kt(a-1)+" "+kt(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+kt(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Hs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Circle.YesNormal,t.D[e]=ut.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Hs(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=ut.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Hs(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*ut.internal.Bezier_C).toFixed(5)),a=Number((n*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Hs(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Cross.YesNormal,t.D[e]=ut.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Hs(e);t.scope=e.scope;var r=[],n=ut.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+kt(ut.internal.getWidth(e)-2)+" "+kt(ut.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(kt(n.x1.x)+" "+kt(n.x1.y)+" m"),r.push(kt(n.x2.x)+" "+kt(n.x2.y)+" l"),r.push(kt(n.x4.x)+" "+kt(n.x4.y)+" m"),r.push(kt(n.x3.x)+" "+kt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Hs(e);t.scope=e.scope;var r=ut.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+kt(ut.internal.getWidth(e)-2)+" "+kt(ut.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(kt(r.x1.x)+" "+kt(r.x1.y)+" m"),n.push(kt(r.x2.x)+" "+kt(r.x2.y)+" l"),n.push(kt(r.x4.x)+" "+kt(r.x4.y)+" m"),n.push(kt(r.x3.x)+" "+kt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Hs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ut.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ut.internal.getWidth(e),r=ut.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ut.internal.getWidth=function(e){var t=0;return tr(e)==="object"&&(t=Qy(e.Rect[2])),t},ut.internal.getHeight=function(e){var t=0;return tr(e)==="object"&&(t=Qy(e.Rect[3])),t};var zC=Cr.addField=function(e){if(UC(this,e),!(e instanceof Ls))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Cr.AcroFormChoiceField=pl,Cr.AcroFormListBox=gl,Cr.AcroFormComboBox=xl,Cr.AcroFormEditBox=Pf,Cr.AcroFormButton=an,Cr.AcroFormPushButton=Lf,Cr.AcroFormRadioButton=vl,Cr.AcroFormCheckBox=Ff,Cr.AcroFormTextField=So,Cr.AcroFormPasswordField=Of,Cr.AcroFormAppearance=ut,Cr.AcroForm={ChoiceField:pl,ListBox:gl,ComboBox:xl,EditBox:Pf,Button:an,PushButton:Lf,RadioButton:vl,CheckBox:Ff,TextField:So,PasswordField:Of,Appearance:ut},mt.AcroForm={ChoiceField:pl,ListBox:gl,ComboBox:xl,EditBox:Pf,Button:an,PushButton:Lf,RadioButton:vl,CheckBox:Ff,TextField:So,PasswordField:Of,Appearance:ut};var WC=mt.AcroForm;function O_(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(T,A){var q,z,ne,U,G,B=t;if((A=A||t)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(L(T))for(G in r)for(ne=r[G],q=0;q<ne.length;q+=1){for(U=!0,z=0;z<ne[q].length;z+=1)if(ne[q][z]!==void 0&&ne[q][z]!==T[z]){U=!1;break}if(U===!0){B=G;break}}else for(G in r)for(ne=r[G],q=0;q<ne.length;q+=1){for(U=!0,z=0;z<ne[q].length;z+=1)if(ne[q][z]!==void 0&&ne[q][z]!==T.charCodeAt(z)){U=!1;break}if(U===!0){B=G;break}}return B===t&&A!==t&&(B=A),B},i=function T(A){for(var q=this.internal.write,z=this.internal.putStream,ne=(0,this.internal.getFilters)();ne.indexOf("FlateEncode")!==-1;)ne.splice(ne.indexOf("FlateEncode"),1);A.objectId=this.internal.newObject();var U=[];if(U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Image"}),U.push({key:"Width",value:A.width}),U.push({key:"Height",value:A.height}),A.colorSpace===b.INDEXED?U.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(A.palette.length/3-1)+" "+("sMask"in A&&A.sMask!==void 0?A.objectId+2:A.objectId+1)+" 0 R]"}):(U.push({key:"ColorSpace",value:"/"+A.colorSpace}),A.colorSpace===b.DEVICE_CMYK&&U.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),U.push({key:"BitsPerComponent",value:A.bitsPerComponent}),"decodeParameters"in A&&A.decodeParameters!==void 0&&U.push({key:"DecodeParms",value:"<<"+A.decodeParameters+">>"}),"transparency"in A&&Array.isArray(A.transparency)){for(var G="",B=0,Y=A.transparency.length;B<Y;B++)G+=A.transparency[B]+" "+A.transparency[B]+" ";U.push({key:"Mask",value:"["+G+"]"})}A.sMask!==void 0&&U.push({key:"SMask",value:A.objectId+1+" 0 R"});var re=A.filter!==void 0?["/"+A.filter]:void 0;if(z({data:A.data,additionalKeyValues:U,alreadyAppliedFilters:re,objectId:A.objectId}),q("endobj"),"sMask"in A&&A.sMask!==void 0){var he="/Predictor "+A.predictor+" /Colors 1 /BitsPerComponent "+A.bitsPerComponent+" /Columns "+A.width,k={width:A.width,height:A.height,colorSpace:"DeviceGray",bitsPerComponent:A.bitsPerComponent,decodeParameters:he,data:A.sMask};"filter"in A&&(k.filter=A.filter),T.call(this,k)}if(A.colorSpace===b.INDEXED){var I=this.internal.newObject();z({data:C(new Uint8Array(A.palette)),objectId:I}),q("endobj")}},s=function(){var T=this.internal.collections.addImage_images;for(var A in T)i.call(this,T[A])},a=function(){var T,A=this.internal.collections.addImage_images,q=this.internal.write;for(var z in A)q("/I"+(T=A[z]).index,T.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var T=this.internal.collections.addImage_images;return o.call(this),T},u=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(T){return typeof e["process"+T.toUpperCase()]=="function"},m=function(T){return tr(T)==="object"&&T.nodeType===1},p=function(T,A){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var q=""+T.getAttribute("src");if(q.indexOf("data:image/")===0)return Cf(unescape(q).split("base64,").pop());var z=e.loadFile(q,!0);if(z!==void 0)return z}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var ne;switch(A){case"PNG":ne="image/png";break;case"WEBP":ne="image/webp";break;case"JPEG":case"JPG":default:ne="image/jpeg"}return Cf(T.toDataURL(ne,1).split("base64,").pop())}},h=function(T){var A=this.internal.collections.addImage_images;if(A){for(var q in A)if(T===A[q].alias)return A[q]}},v=function(T,A,q){return T||A||(T=-96,A=-96),T<0&&(T=-1*q.width*72/T/this.internal.scaleFactor),A<0&&(A=-1*q.height*72/A/this.internal.scaleFactor),T===0&&(T=A*q.width/q.height),A===0&&(A=T*q.height/q.width),[T,A]},g=function(T,A,q,z,ne,U){var G=v.call(this,q,z,ne),B=this.internal.getCoordinateString,Y=this.internal.getVerticalCoordinateString,re=l.call(this);if(q=G[0],z=G[1],re[ne.index]=ne,U){U*=Math.PI/180;var he=Math.cos(U),k=Math.sin(U),I=function(D){return D.toFixed(4)},M=[I(he),I(k),I(-1*k),I(he),0,0,"cm"]}this.internal.write("q"),U?(this.internal.write([1,"0","0",1,B(T),Y(A+z),"cm"].join(" ")),this.internal.write(M.join(" ")),this.internal.write([B(q),"0","0",B(z),"0","0","cm"].join(" "))):this.internal.write([B(q),"0","0",B(z),B(T),Y(A+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ne.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(T){var A,q,z=0;if(typeof T=="string")for(q=T.length,A=0;A<q;A++)z=(z<<5)-z+T.charCodeAt(A),z|=0;else if(L(T))for(q=T.byteLength/2,A=0;A<q;A++)z=(z<<5)-z+T[A],z|=0;return z},_=e.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var A=!0;return T.length===0&&(A=!1),T.length%4!=0&&(A=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(A=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(A=!1),A},j=e.__addimage__.extractImageFromDataUrl=function(T){var A=(T=T||"").split("base64,"),q=null;if(A.length===2){var z=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(A[0]);Array.isArray(z)&&(q={mimeType:z[1],charset:z[2],data:A[1]})}return q},O=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(T){return O()&&T instanceof ArrayBuffer};var L=e.__addimage__.isArrayBufferView=function(T){return O()&&typeof Uint32Array<"u"&&(T instanceof Int8Array||T instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array)},E=e.__addimage__.binaryStringToUint8Array=function(T){for(var A=T.length,q=new Uint8Array(A),z=0;z<A;z++)q[z]=T.charCodeAt(z);return q},C=e.__addimage__.arrayBufferToBinaryString=function(T){for(var A="",q=L(T)?T:new Uint8Array(T),z=0;z<q.length;z+=8192)A+=String.fromCharCode.apply(null,q.subarray(z,z+8192));return A};e.addImage=function(){var T,A,q,z,ne,U,G,B,Y;if(typeof arguments[1]=="number"?(A=t,q=arguments[1],z=arguments[2],ne=arguments[3],U=arguments[4],G=arguments[5],B=arguments[6],Y=arguments[7]):(A=arguments[1],q=arguments[2],z=arguments[3],ne=arguments[4],U=arguments[5],G=arguments[6],B=arguments[7],Y=arguments[8]),tr(T=arguments[0])==="object"&&!m(T)&&"imageData"in T){var re=T;T=re.imageData,A=re.format||A||t,q=re.x||q||0,z=re.y||z||0,ne=re.w||re.width||ne,U=re.h||re.height||U,G=re.alias||G,B=re.compression||B,Y=re.rotation||re.angle||Y}var he=this.internal.getFilters();if(B===void 0&&he.indexOf("FlateEncode")!==-1&&(B="SLOW"),isNaN(q)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var k=P.call(this,T,A,G,B);return g.call(this,q,z,ne,U,k,Y),this};var P=function(T,A,q,z){var ne,U,G;if(typeof T=="string"&&n(T)===t){T=unescape(T);var B=R(T,!1);(B!==""||(B=e.loadFile(T,!0))!==void 0)&&(T=B)}if(m(T)&&(T=p(T,A)),A=n(T,A),!f(A))throw new Error("addImage does not support files of type '"+A+"', please ensure that a plugin for '"+A+"' support is added.");if(((G=q)==null||G.length===0)&&(q=function(Y){return typeof Y=="string"||L(Y)?w(Y):L(Y.data)?w(Y.data):null}(T)),(ne=h.call(this,q))||(O()&&(T instanceof Uint8Array||A==="RGBA"||(U=T,T=E(T))),ne=this["process"+A.toUpperCase()](T,u.call(this),q,function(Y){return Y&&typeof Y=="string"&&(Y=Y.toUpperCase()),Y in e.image_compression?Y:y.NONE}(z),U)),!ne)throw new Error("An unknown error occurred whilst processing the image.");return ne},R=e.__addimage__.convertBase64ToBinaryString=function(T,A){var q;A=typeof A!="boolean"||A;var z,ne="";if(typeof T=="string"){z=(q=j(T))!==null?q.data:T;try{ne=Cf(z)}catch(U){if(A)throw _(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+U.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ne};e.getImageProperties=function(T){var A,q,z="";if(m(T)&&(T=p(T)),typeof T=="string"&&n(T)===t&&((z=R(T,!1))===""&&(z=e.loadFile(T)||""),T=z),q=n(T),!f(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(!O()||T instanceof Uint8Array||(T=E(T)),!(A=this["process"+q.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return A.fileType=q,A}})(mt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};mt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,m=0;m<u.length&&!f;m++)switch((n=u[m]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(g.objId),w=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(y(n.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+h(y(w))+") >>",g.content=s;var _=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(g.objId,"0 R",b.objId,"0 R");break;case"freetext":i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+h(v(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+h(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var L=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+L+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:u(n),w:l(r+i),h:u(n+s)},options:a,type:"link"})},e.textWithLink=function(r,n,i,s){var a,o,l=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var f=this.splitTextToSize(r,o).length;a=Math.ceil(u*f)}else o=l,a=u;return this.text(r,n,i,s),i+=.2*u,s.align==="center"&&(n-=l/2),s.align==="right"&&(n-=l),this.link(n,i-u,o,a,s),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(mt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},a=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return a(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(g){return a(g)&&i.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return a(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return a(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return a(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return a(g)&&s(g)&&t[g.charCodeAt(0)].length==4},m=e.__arabicParser__.resolveLigatures=function(g){var b=0,y=r,w="",_=0;for(b=0;b<g.length;b+=1)y[g.charCodeAt(b)]!==void 0?(_++,typeof(y=y[g.charCodeAt(b)])=="number"&&(w+=String.fromCharCode(y),y=r,_=0),b===g.length-1&&(y=r,w+=g.charAt(b-(_-1)),b-=_-1,_=0)):(y=r,w+=g.charAt(b-_),b-=_,_=0);return w};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,b,y){return a(g)?s(g)===!1?-1:!u(g)||!a(b)&&!a(y)||!a(y)&&o(b)||o(g)&&!a(b)||o(g)&&l(b)||o(g)&&o(b)?0:f(g)&&a(b)&&!o(b)&&a(y)&&u(y)?3:o(g)||!a(y)?1:2:-1},h=function(g){var b=0,y=0,w=0,_="",j="",O="",L=(g=g||"").split("\\s+"),E=[];for(b=0;b<L.length;b+=1){for(E.push(""),y=0;y<L[b].length;y+=1)_=L[b][y],j=L[b][y-1],O=L[b][y+1],a(_)?(w=p(_,j,O),E[b]+=w!==-1?String.fromCharCode(t[_.charCodeAt(0)][w]):_):E[b]+=_;E[b]=m(E[b])}return E.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(b)){var w=0;for(y=[],w=0;w<b.length;w+=1)Array.isArray(b[w])?y.push([h(b[w][0]),b[w][1],b[w][2]]):y.push([h(b[w])]);g=y}else g=h(b);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(mt.API),mt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(mt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),m=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,v=0,g=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var y=u.maxWidth;y>0?typeof l=="string"?l=this.splitTextToSize(l,y):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(_,j){return _.concat(b.splitTextToSize(j,y))},[])):l=Array.isArray(l)?l:[l];for(var w=0;w<l.length;w++)h<(g=this.getStringUnitWidth(l[w],{font:m})*f)&&(h=g);return h!==0&&(v=l.length),{w:h/=p,h:Math.max((v*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=e.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,m=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===l.lineNumber?(l.x=(u.x||0)+(u.width||0),l.y=u.y||0):u.y+u.height+l.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=m.top,h&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=u.y+u.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-f,l.y+f,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+f,{align:"center",baseline:"top",maxWidth:l.width-f-f}):this.text(l.text,l.x+f,l.y+f,{align:"left",baseline:"top",maxWidth:l.width-f-f})),this.internal.__cell__.lastCell=l,this};e.table=function(l,u,f,m,p){if(n.call(this),!f)throw new Error("No data for PDF table.");var h,v,g,b,y=[],w=[],_=[],j={},O={},L=[],E=[],C=(p=p||{}).autoSize||!1,P=p.printHeaders!==!1,R=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,T=p.margins||Object.assign({width:this.getPageWidth()},t),A=typeof p.padding=="number"?p.padding:3,q=p.headerBackgroundColor||"#c8c8c8",z=p.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=R,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=q,this.internal.__cell__.headerTextColor=z,this.setFontSize(R),m==null)w=y=Object.keys(f[0]),_=y.map(function(){return"left"});else if(Array.isArray(m)&&tr(m[0])==="object")for(y=m.map(function(re){return re.name}),w=m.map(function(re){return re.prompt||re.name||""}),_=m.map(function(re){return re.align||"left"}),h=0;h<m.length;h+=1)O[m[h].name]=m[h].width*(19.049976/25.4);else Array.isArray(m)&&typeof m[0]=="string"&&(w=y=m,_=y.map(function(){return"left"}));if(C||Array.isArray(m)&&typeof m[0]=="string")for(h=0;h<y.length;h+=1){for(j[b=y[h]]=f.map(function(re){return re[b]}),this.setFont(void 0,"bold"),L.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=j[b],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)L.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[b]=Math.max.apply(null,L)+A+A,L=[]}if(P){var ne={};for(h=0;h<y.length;h+=1)ne[y[h]]={},ne[y[h]].text=w[h],ne[y[h]].align=_[h];var U=o.call(this,ne,O);E=y.map(function(re){return new s(l,u,O[re],U,ne[re].text,void 0,ne[re].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var G=m.reduce(function(re,he){return re[he.name]=he.align,re},{});for(h=0;h<f.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:f[h]},this);var B=o.call(this,f[h],O);for(g=0;g<y.length;g+=1){var Y=f[h][y[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:Y},this),a.call(this,new s(l,u,O[y[g]],B,Y,h+2,G[y[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=u,this};var o=function(l,u){var f=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(h){var v=l[h];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,u[h]-f-f)},this).map(function(h){return this.getLineHeightFactor()*h.length*m/p+f+f},this).reduce(function(h,v){return Math.max(h,v)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){f=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,p.push(f)),f.lineNumber=l;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,f),this.setTextColor(v)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(mt.API);var D_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},I_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],$g=O_(I_),R_=[100,200,300,400,500,600,700,800,900],HC=O_(R_);function qg(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return D_[s=s||"normal"]?s:"normal"}(e.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(s){return typeof $g[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function Zy(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var $C={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},e5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function t5(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function qC(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},$C,r.genericFontFamilies||{}),s=null,a=null,o=0;o<t.length;++o)if(i[(s=qg(t[o])).family]&&(s.family=i[s.family]),e.hasOwnProperty(s.family)){a=e[s.family];break}if(!(a=a||e[n]))throw new Error("Could not find a font-family for the rule '"+t5(s)+"' and default family '"+n+"'.");if(a=function(l,u){if(u[l])return u[l];var f=$g[l],m=f<=$g.normal?-1:1,p=Zy(u,I_,f,m);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(s.stretch,a),a=function(l,u){if(u[l])return u[l];for(var f=D_[l],m=0;m<f.length;++m)if(u[f[m]])return u[f[m]];throw new Error("Could not find a matching font-style for "+l)}(s.style,a),!(a=function(l,u){if(u[l])return u[l];if(l===400&&u[500])return u[500];if(l===500&&u[400])return u[400];var f=HC[l],m=Zy(u,R_,f,l<400?-1:1);if(!m)throw new Error("Could not find a matching font-weight for value "+l);return m}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+t5(s)+"'.");return a}function r5(e){return e.trimLeft()}function VC(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function GC(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var qh,n5,i5,p1=["times"];(function(e){var t,r,n,i,s,a,o,l,u,f=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new l,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new a,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new a,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new m(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,u=new f}]);var m=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=k;Object.defineProperty(this,"pdf",{get:function(){return I}});var M=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return M},set:function(Te){M=!!Te}});var D=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return D},set:function(Te){D=!!Te}});var V=0;Object.defineProperty(this,"posX",{get:function(){return V},set:function(Te){isNaN(Te)||(V=Te)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(Te){isNaN(Te)||(se=Te)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Te){var ue;typeof Te=="number"?ue=[Te,Te,Te,Te]:((ue=new Array(4))[0]=Te[0],ue[1]=Te.length>=2?Te[1]:ue[0],ue[2]=Te.length>=3?Te[2]:ue[0],ue[3]=Te.length>=4?Te[3]:ue[1]),u.margin=ue}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(Te){fe=Te}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(Te){de=Te}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(Te){ve=Te}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Te){Te instanceof f&&(u=Te)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Te){u.path=Te}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(Te){Ee=Te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Te){var ue;ue=p(Te),this.ctx.fillStyle=ue.style,this.ctx.isFillTransparent=ue.a===0,this.ctx.fillOpacity=ue.a,this.pdf.setFillColor(ue.r,ue.g,ue.b,{a:ue.a}),this.pdf.setTextColor(ue.r,ue.g,ue.b,{a:ue.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Te){var ue=p(Te);this.ctx.strokeStyle=ue.style,this.ctx.isStrokeTransparent=ue.a===0,this.ctx.strokeOpacity=ue.a,ue.a===0?this.pdf.setDrawColor(255,255,255):(ue.a,this.pdf.setDrawColor(ue.r,ue.g,ue.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Te){["butt","round","square"].indexOf(Te)!==-1&&(this.ctx.lineCap=Te,this.pdf.setLineCap(Te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Te){isNaN(Te)||(this.ctx.lineWidth=Te,this.pdf.setLineWidth(Te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Te){["bevel","round","miter"].indexOf(Te)!==-1&&(this.ctx.lineJoin=Te,this.pdf.setLineJoin(Te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Te){isNaN(Te)||(this.ctx.miterLimit=Te,this.pdf.setMiterLimit(Te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Te){this.ctx.textBaseline=Te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Te){["right","end","center","left","start"].indexOf(Te)!==-1&&(this.ctx.textAlign=Te)}});var Oe=null;function Ve(Te,ue){if(Oe===null){var Me=function(at){var ze=[];return Object.keys(at).forEach(function(Ye){at[Ye].forEach(function(Ze){var tt=null;switch(Ze){case"bold":tt={family:Ye,weight:"bold"};break;case"italic":tt={family:Ye,style:"italic"};break;case"bolditalic":tt={family:Ye,weight:"bold",style:"italic"};break;case"":case"normal":tt={family:Ye}}tt!==null&&(tt.ref={name:Ye,style:Ze},ze.push(tt))})}),ze}(Te.getFontList());Oe=function(at){for(var ze={},Ye=0;Ye<at.length;++Ye){var Ze=qg(at[Ye]),tt=Ze.family,ft=Ze.stretch,dt=Ze.style,bt=Ze.weight;ze[tt]=ze[tt]||{},ze[tt][ft]=ze[tt][ft]||{},ze[tt][ft][dt]=ze[tt][ft][dt]||{},ze[tt][ft][dt][bt]=Ze}return ze}(Me.concat(ue))}return Oe}var Qe=null;Object.defineProperty(this,"fontFaces",{get:function(){return Qe},set:function(Te){Oe=null,Qe=Te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Te){var ue;if(this.ctx.font=Te,(ue=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Te))!==null){var Me=ue[1],at=(ue[2],ue[3]),ze=ue[4],Ye=(ue[5],ue[6]),Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ze)[2];ze=Math.floor(Ze==="px"?parseFloat(ze)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(ze)*this.pdf.getFontSize():parseFloat(ze)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ze);var tt=function(xt){var Ct,nt,en=[],Rt=xt.trim();if(Rt==="")return p1;if(Rt in e5)return[e5[Rt]];for(;Rt!=="";){switch(nt=null,Ct=(Rt=r5(Rt)).charAt(0)){case'"':case"'":nt=VC(Rt.substring(1),Ct);break;default:nt=GC(Rt)}if(nt===null||(en.push(nt[0]),(Rt=r5(nt[1]))!==""&&Rt.charAt(0)!==","))return p1;Rt=Rt.replace(/^,/,"")}return en}(Ye);if(this.fontFaces){var ft=qC(Ve(this.pdf,this.fontFaces),tt.map(function(xt){return{family:xt,stretch:"normal",weight:at,style:Me}}));this.pdf.setFont(ft.ref.name,ft.ref.style)}else{var dt="";(at==="bold"||parseInt(at,10)>=700||Me==="bold")&&(dt="bold"),Me==="italic"&&(dt+="italic"),dt.length===0&&(dt="normal");for(var bt="",jt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Lt=0;Lt<tt.length;Lt++){if(this.pdf.internal.getFont(tt[Lt],dt,{noFallback:!0,disableWarning:!0})!==void 0){bt=tt[Lt];break}if(dt==="bolditalic"&&this.pdf.internal.getFont(tt[Lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)bt=tt[Lt],dt="bold";else if(this.pdf.internal.getFont(tt[Lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){bt=tt[Lt],dt="normal";break}}if(bt===""){for(var Ot=0;Ot<tt.length;Ot++)if(jt[tt[Ot]]){bt=jt[tt[Ot]];break}}bt=bt===""?"Times":bt,this.pdf.setFont(bt,dt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Te){this.ctx.globalCompositeOperation=Te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Te){this.ctx.globalAlpha=Te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Te){this.ctx.lineDashOffset=Te,he.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Te){this.ctx.lineDash=Te,he.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Te){this.ctx.ignoreClearRect=!!Te}})};m.prototype.setLineDash=function(k){this.lineDash=k},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){j.call(this,"fill",!1)},m.prototype.stroke=function(){j.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var M=this.ctx.transform.applyToPoint(new a(k,I));this.path.push({type:"mt",x:M.x,y:M.y}),this.ctx.lastPoint=new a(k,I)},m.prototype.closePath=function(){var k=new a(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&tr(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){k=new a(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(k.x,k.y)},m.prototype.lineTo=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var M=this.ctx.transform.applyToPoint(new a(k,I));this.path.push({type:"lt",x:M.x,y:M.y}),this.ctx.lastPoint=new a(M.x,M.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},m.prototype.quadraticCurveTo=function(k,I,M,D){if(isNaN(M)||isNaN(D)||isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var V=this.ctx.transform.applyToPoint(new a(M,D)),se=this.ctx.transform.applyToPoint(new a(k,I));this.path.push({type:"qct",x1:se.x,y1:se.y,x:V.x,y:V.y}),this.ctx.lastPoint=new a(V.x,V.y)},m.prototype.bezierCurveTo=function(k,I,M,D,V,se){if(isNaN(V)||isNaN(se)||isNaN(k)||isNaN(I)||isNaN(M)||isNaN(D))throw ur.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new a(V,se)),de=this.ctx.transform.applyToPoint(new a(k,I)),ve=this.ctx.transform.applyToPoint(new a(M,D));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:ve.x,y2:ve.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new a(fe.x,fe.y)},m.prototype.arc=function(k,I,M,D,V,se){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(D)||isNaN(V))throw ur.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new a(k,I));k=fe.x,I=fe.y;var de=this.ctx.transform.applyToPoint(new a(0,M)),ve=this.ctx.transform.applyToPoint(new a(0,0));M=Math.sqrt(Math.pow(de.x-ve.x,2)+Math.pow(de.y-ve.y,2))}Math.abs(V-D)>=2*Math.PI&&(D=0,V=2*Math.PI),this.path.push({type:"arc",x:k,y:I,radius:M,startAngle:D,endAngle:V,counterclockwise:se})},m.prototype.arcTo=function(k,I,M,D,V){throw new Error("arcTo not implemented.")},m.prototype.rect=function(k,I,M,D){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(D))throw ur.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,I),this.lineTo(k+M,I),this.lineTo(k+M,I+D),this.lineTo(k,I+D),this.lineTo(k,I),this.lineTo(k+M,I),this.lineTo(k,I)},m.prototype.fillRect=function(k,I,M,D){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(D))throw ur.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var V={};this.lineCap!=="butt"&&(V.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(V.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,I,M,D),this.fill(),V.hasOwnProperty("lineCap")&&(this.lineCap=V.lineCap),V.hasOwnProperty("lineJoin")&&(this.lineJoin=V.lineJoin)}},m.prototype.strokeRect=function(k,I,M,D){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(D))throw ur.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(k,I,M,D),this.stroke())},m.prototype.clearRect=function(k,I,M,D){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(D))throw ur.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,I,M,D))},m.prototype.save=function(k){k=typeof k!="boolean"||k;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var D=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=D}},m.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("Q");this.pdf.setPage(I),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(k){var I,M,D,V;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))I=0,M=0,D=0,V=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(se!==null)I=parseInt(se[1]),M=parseInt(se[2]),D=parseInt(se[3]),V=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)I=parseInt(se[1]),M=parseInt(se[2]),D=parseInt(se[3]),V=parseFloat(se[4]);else{if(V=1,typeof k=="string"&&k.charAt(0)!=="#"){var fe=new A_(k);k=fe.ok?fe.toHex():"#000000"}k.length===4?(I=k.substring(1,2),I+=I,M=k.substring(2,3),M+=M,D=k.substring(3,4),D+=D):(I=k.substring(1,3),M=k.substring(3,5),D=k.substring(5,7)),I=parseInt(I,16),M=parseInt(M,16),D=parseInt(D,16)}}return{r:I,g:M,b:D,a:V,style:k}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(k,I,M,D){if(isNaN(I)||isNaN(M)||typeof k!="string")throw ur.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(D=isNaN(D)?void 0:D,!h.call(this)){var V=B(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;A.call(this,{text:k,x:I,y:M,scale:se,angle:V,align:this.textAlign,maxWidth:D})}},m.prototype.strokeText=function(k,I,M,D){if(isNaN(I)||isNaN(M)||typeof k!="string")throw ur.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){D=isNaN(D)?void 0:D;var V=B(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;A.call(this,{text:k,x:I,y:M,scale:se,renderingMode:"stroke",angle:V,align:this.textAlign,maxWidth:D})}},m.prototype.measureText=function(k){if(typeof k!="string")throw ur.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,M=this.pdf.internal.scaleFactor,D=I.internal.getFontSize(),V=I.getStringUnitWidth(k)*D/I.internal.scaleFactor,se=function(fe){var de=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new se({width:V*=Math.round(96*M/72*1e4)/1e4})},m.prototype.scale=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var M=new l(k,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(M)},m.prototype.rotate=function(k){if(isNaN(k))throw ur.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new l(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},m.prototype.translate=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var M=new l(1,0,0,1,k,I);this.ctx.transform=this.ctx.transform.multiply(M)},m.prototype.transform=function(k,I,M,D,V,se){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(D)||isNaN(V)||isNaN(se))throw ur.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new l(k,I,M,D,V,se);this.ctx.transform=this.ctx.transform.multiply(fe)},m.prototype.setTransform=function(k,I,M,D,V,se){k=isNaN(k)?1:k,I=isNaN(I)?0:I,M=isNaN(M)?0:M,D=isNaN(D)?1:D,V=isNaN(V)?0:V,se=isNaN(se)?0:se,this.ctx.transform=new l(k,I,M,D,V,se)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(k,I,M,D,V,se,fe,de,ve){var Ee=this.pdf.getImageProperties(k),Oe=1,Ve=1,Qe=1,Te=1;D!==void 0&&de!==void 0&&(Qe=de/D,Te=ve/V,Oe=Ee.width/D*de/D,Ve=Ee.height/V*ve/V),se===void 0&&(se=I,fe=M,I=0,M=0),D!==void 0&&de===void 0&&(de=D,ve=V),D===void 0&&de===void 0&&(de=Ee.width,ve=Ee.height);for(var ue,Me=this.ctx.transform.decompose(),at=B(Me.rotate.shx),ze=new l,Ye=(ze=(ze=(ze=ze.multiply(Me.translate)).multiply(Me.skew)).multiply(Me.scale)).applyToRectangle(new o(se-I*Qe,fe-M*Te,D*Oe,V*Ve)),Ze=b.call(this,Ye),tt=[],ft=0;ft<Ze.length;ft+=1)tt.indexOf(Ze[ft])===-1&&tt.push(Ze[ft]);if(_(tt),this.autoPaging)for(var dt=tt[0],bt=tt[tt.length-1],jt=dt;jt<bt+1;jt++){this.pdf.setPage(jt);var Lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=jt===1?this.posY+this.margin[0]:this.margin[0],xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],nt=jt===1?0:xt+(jt-2)*Ct;if(this.ctx.clip_path.length!==0){var en=this.path;ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(ue,this.posX+this.margin[3],-nt+Ot+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=en}var Rt=JSON.parse(JSON.stringify(Ye));Rt=w([Rt],this.posX+this.margin[3],-nt+Ot+this.ctx.prevPageLastElemOffset)[0];var ti=(jt>dt||jt<bt)&&g.call(this);ti&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,Ct,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",Rt.x,Rt.y,Rt.w,Rt.h,null,null,at),ti&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",Ye.x,Ye.y,Ye.w,Ye.h,null,null,at)};var b=function(k,I,M){var D=[];I=I||this.pdf.internal.pageSize.width,M=M||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var V=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":D.push(Math.floor((k.y+V)/M)+1);break;case"arc":D.push(Math.floor((k.y+V-k.radius)/M)+1),D.push(Math.floor((k.y+V+k.radius)/M)+1);break;case"qct":var se=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);D.push(Math.floor((se.y+V)/M)+1),D.push(Math.floor((se.y+se.h+V)/M)+1);break;case"bct":var fe=re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);D.push(Math.floor((fe.y+V)/M)+1),D.push(Math.floor((fe.y+fe.h+V)/M)+1);break;case"rect":D.push(Math.floor((k.y+V)/M)+1),D.push(Math.floor((k.y+k.h+V)/M)+1)}for(var de=0;de<D.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<D[de];)y.call(this);return D},y=function(){var k=this.fillStyle,I=this.strokeStyle,M=this.font,D=this.lineCap,V=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=I,this.font=M,this.lineCap=D,this.lineWidth=V,this.lineJoin=se},w=function(k,I,M){for(var D=0;D<k.length;D++)switch(k[D].type){case"bct":k[D].x2+=I,k[D].y2+=M;case"qct":k[D].x1+=I,k[D].y1+=M;case"mt":case"lt":case"arc":default:k[D].x+=I,k[D].y+=M}return k},_=function(k){return k.sort(function(I,M){return I-M})},j=function(k,I){for(var M,D,V=this.fillStyle,se=this.strokeStyle,fe=this.lineCap,de=this.lineWidth,ve=Math.abs(de*this.ctx.transform.scaleX),Ee=this.lineJoin,Oe=JSON.parse(JSON.stringify(this.path)),Ve=JSON.parse(JSON.stringify(this.path)),Qe=[],Te=0;Te<Ve.length;Te++)if(Ve[Te].x!==void 0)for(var ue=b.call(this,Ve[Te]),Me=0;Me<ue.length;Me+=1)Qe.indexOf(ue[Me])===-1&&Qe.push(ue[Me]);for(var at=0;at<Qe.length;at++)for(;this.pdf.internal.getNumberOfPages()<Qe[at];)y.call(this);if(_(Qe),this.autoPaging)for(var ze=Qe[0],Ye=Qe[Qe.length-1],Ze=ze;Ze<Ye+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=V,this.strokeStyle=se,this.lineCap=fe,this.lineWidth=ve,this.lineJoin=Ee;var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=Ze===1?this.posY+this.margin[0]:this.margin[0],dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],jt=Ze===1?0:dt+(Ze-2)*bt;if(this.ctx.clip_path.length!==0){var Lt=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(M,this.posX+this.margin[3],-jt+ft+this.ctx.prevPageLastElemOffset),O.call(this,k,!0),this.path=Lt}if(D=JSON.parse(JSON.stringify(Oe)),this.path=w(D,this.posX+this.margin[3],-jt+ft+this.ctx.prevPageLastElemOffset),I===!1||Ze===0){var Ot=(Ze>ze||Ze<Ye)&&g.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,bt,null).clip().discardPath()),O.call(this,k,I),Ot&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=ve,O.call(this,k,I),this.lineWidth=de;this.path=Oe},O=function(k,I){if((k!=="stroke"||I||!v.call(this))&&(k==="stroke"||I||!h.call(this))){for(var M,D,V=[],se=this.path,fe=0;fe<se.length;fe++){var de=se[fe];switch(de.type){case"begin":V.push({begin:!0});break;case"close":V.push({close:!0});break;case"mt":V.push({start:de,deltas:[],abs:[]});break;case"lt":var ve=V.length;if(se[fe-1]&&!isNaN(se[fe-1].x)&&(M=[de.x-se[fe-1].x,de.y-se[fe-1].y],ve>0)){for(;ve>=0;ve--)if(V[ve-1].close!==!0&&V[ve-1].begin!==!0){V[ve-1].deltas.push(M),V[ve-1].abs.push(de);break}}break;case"bct":M=[de.x1-se[fe-1].x,de.y1-se[fe-1].y,de.x2-se[fe-1].x,de.y2-se[fe-1].y,de.x-se[fe-1].x,de.y-se[fe-1].y],V[V.length-1].deltas.push(M);break;case"qct":var Ee=se[fe-1].x+2/3*(de.x1-se[fe-1].x),Oe=se[fe-1].y+2/3*(de.y1-se[fe-1].y),Ve=de.x+2/3*(de.x1-de.x),Qe=de.y+2/3*(de.y1-de.y),Te=de.x,ue=de.y;M=[Ee-se[fe-1].x,Oe-se[fe-1].y,Ve-se[fe-1].x,Qe-se[fe-1].y,Te-se[fe-1].x,ue-se[fe-1].y],V[V.length-1].deltas.push(M);break;case"arc":V.push({deltas:[],abs:[],arc:!0}),Array.isArray(V[V.length-1].abs)&&V[V.length-1].abs.push(de)}}D=I?null:k==="stroke"?"stroke":"fill";for(var Me=!1,at=0;at<V.length;at++)if(V[at].arc)for(var ze=V[at].abs,Ye=0;Ye<ze.length;Ye++){var Ze=ze[Ye];Ze.type==="arc"?C.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,I,!Me):q.call(this,Ze.x,Ze.y),Me=!0}else if(V[at].close===!0)this.pdf.internal.out("h"),Me=!1;else if(V[at].begin!==!0){var tt=V[at].start.x,ft=V[at].start.y;z.call(this,V[at].deltas,tt,ft),Me=!0}D&&P.call(this,D),I&&R.call(this)}},L=function(k){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,M=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-M;case"top":return k+I-M;case"hanging":return k+I-2*M;case"middle":return k+I/2-M;case"ideographic":return k;case"alphabetic":default:return k}},E=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(I,M){this.colorStops.push([I,M])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(k,I,M,D,V,se,fe,de,ve){for(var Ee=U.call(this,M,D,V,se),Oe=0;Oe<Ee.length;Oe++){var Ve=Ee[Oe];Oe===0&&(ve?T.call(this,Ve.x1+k,Ve.y1+I):q.call(this,Ve.x1+k,Ve.y1+I)),ne.call(this,k,I,Ve.x2,Ve.y2,Ve.x3,Ve.y3,Ve.x4,Ve.y4)}de?R.call(this):P.call(this,fe)},P=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},R=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(k,I){this.pdf.internal.out(r(k)+" "+n(I)+" m")},A=function(k){var I;switch(k.align){case"right":case"end":I="right";break;case"center":I="center";break;case"left":case"start":default:I="left"}var M=this.pdf.getTextDimensions(k.text),D=L.call(this,k.y),V=E.call(this,D)-M.h,se=this.ctx.transform.applyToPoint(new a(k.x,D)),fe=this.ctx.transform.decompose(),de=new l;de=(de=(de=de.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var ve,Ee,Oe,Ve=this.ctx.transform.applyToRectangle(new o(k.x,D,M.w,M.h)),Qe=de.applyToRectangle(new o(k.x,V,M.w,M.h)),Te=b.call(this,Qe),ue=[],Me=0;Me<Te.length;Me+=1)ue.indexOf(Te[Me])===-1&&ue.push(Te[Me]);if(_(ue),this.autoPaging)for(var at=ue[0],ze=ue[ue.length-1],Ye=at;Ye<ze+1;Ye++){this.pdf.setPage(Ye);var Ze=Ye===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[2],dt=ft-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],jt=bt-this.margin[3],Lt=Ye===1?0:tt+(Ye-2)*dt;if(this.ctx.clip_path.length!==0){var Ot=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(ve,this.posX+this.margin[3],-1*Lt+Ze),O.call(this,"fill",!0),this.path=Ot}var xt=w([JSON.parse(JSON.stringify(Qe))],this.posX+this.margin[3],-Lt+Ze+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*k.scale),Oe=this.lineWidth,this.lineWidth=Oe*k.scale);var Ct=this.autoPaging!=="text";if(Ct||xt.y+xt.h<=ft){if(Ct||xt.y>=Ze&&xt.x<=bt){var nt=Ct?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||bt-xt.x)[0],en=w([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-Lt+Ze+this.ctx.prevPageLastElemOffset)[0],Rt=Ct&&(Ye>at||Ye<ze)&&g.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],jt,dt,null).clip().discardPath()),this.pdf.text(nt,en.x,en.y,{angle:k.angle,align:I,renderingMode:k.renderingMode}),Rt&&this.pdf.restoreGraphicsState()}}else xt.y<ft&&(this.ctx.prevPageLastElemOffset+=ft-xt.y);k.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Oe)}else k.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*k.scale),Oe=this.lineWidth,this.lineWidth=Oe*k.scale),this.pdf.text(k.text,se.x+this.posX,se.y+this.posY,{angle:k.angle,align:I,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Oe)},q=function(k,I,M,D){M=M||0,D=D||0,this.pdf.internal.out(r(k+M)+" "+n(I+D)+" l")},z=function(k,I,M){return this.pdf.lines(k,I,M,null,null)},ne=function(k,I,M,D,V,se,fe,de){this.pdf.internal.out([t(i(M+k)),t(s(D+I)),t(i(V+k)),t(s(se+I)),t(i(fe+k)),t(s(de+I)),"c"].join(" "))},U=function(k,I,M,D){for(var V=2*Math.PI,se=Math.PI/2;I>M;)I-=V;var fe=Math.abs(M-I);fe<V&&D&&(fe=V-fe);for(var de=[],ve=D?-1:1,Ee=I;fe>1e-5;){var Oe=Ee+ve*Math.min(fe,se);de.push(G.call(this,k,Ee,Oe)),fe-=Math.abs(Oe-Ee),Ee=Oe}return de},G=function(k,I,M){var D=(M-I)/2,V=k*Math.cos(D),se=k*Math.sin(D),fe=V,de=-se,ve=fe*fe+de*de,Ee=ve+fe*V+de*se,Oe=4/3*(Math.sqrt(2*ve*Ee)-Ee)/(fe*se-de*V),Ve=fe-Oe*de,Qe=de+Oe*fe,Te=Ve,ue=-Qe,Me=D+I,at=Math.cos(Me),ze=Math.sin(Me);return{x1:k*Math.cos(I),y1:k*Math.sin(I),x2:Ve*at-Qe*ze,y2:Ve*ze+Qe*at,x3:Te*at-ue*ze,y3:Te*ze+ue*at,x4:k*Math.cos(M),y4:k*Math.sin(M)}},B=function(k){return 180*k/Math.PI},Y=function(k,I,M,D,V,se){var fe=k+.5*(M-k),de=I+.5*(D-I),ve=V+.5*(M-V),Ee=se+.5*(D-se),Oe=Math.min(k,V,fe,ve),Ve=Math.max(k,V,fe,ve),Qe=Math.min(I,se,de,Ee),Te=Math.max(I,se,de,Ee);return new o(Oe,Qe,Ve-Oe,Te-Qe)},re=function(k,I,M,D,V,se,fe,de){var ve,Ee,Oe,Ve,Qe,Te,ue,Me,at,ze,Ye,Ze,tt,ft,dt=M-k,bt=D-I,jt=V-M,Lt=se-D,Ot=fe-V,xt=de-se;for(Ee=0;Ee<41;Ee++)at=(ue=(Oe=k+(ve=Ee/40)*dt)+ve*((Qe=M+ve*jt)-Oe))+ve*(Qe+ve*(V+ve*Ot-Qe)-ue),ze=(Me=(Ve=I+ve*bt)+ve*((Te=D+ve*Lt)-Ve))+ve*(Te+ve*(se+ve*xt-Te)-Me),Ee==0?(Ye=at,Ze=ze,tt=at,ft=ze):(Ye=Math.min(Ye,at),Ze=Math.min(Ze,ze),tt=Math.max(tt,at),ft=Math.max(ft,ze));return new o(Math.round(Ye),Math.round(Ze),Math.round(tt-Ye),Math.round(ft-Ze))},he=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,I,M=(k=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:I}));this.prevLineDash!==M&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=M)}}})(mt.API),function(e){var t=function(s){var a,o,l,u,f,m,p,h,v,g;for(o=[],l=0,u=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;u>l;l+=4)(f=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(m=(f=((f=((f=((f=(f-(g=f%85))/85)-(v=f%85))/85)-(h=f%85))/85)-(p=f%85))/85)%85,o.push(m+33,p+33,h+33,v+33,g+33)):o.push(122);return function(b,y){for(var w=y;w>0;w--)b.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},r=function(s){var a,o,l,u,f,m=String,p="length",h=255,v="charCodeAt",g="slice",b="replace";for(s[g](-2),s=s[g](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],u=0,f=(s+=a="uuuuu"[g](s[p]%5||5))[p];f>u;u+=5)o=52200625*(s[v](u)-33)+614125*(s[v](u+1)-33)+7225*(s[v](u+2)-33)+85*(s[v](u+3)-33)+(s[v](u+4)-33),l.push(h&o>>24,h&o>>16,h&o>>8,h&o);return function(y,w){for(var _=w;_>0;_--)y.pop()}(l,a[p]),m.fromCharCode.apply(m,l)},n=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",l=0;l<s.length;l+=2)o+=String.fromCharCode("0x"+(s[l]+s[l+1]));return o},i=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=Bg(a)).reduce(function(l,u){return l+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,a){var o=0,l=s||"",u=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=i(l),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:u.reverse().join(" ")}}}(mt.API),function(e){e.loadFile=function(t,r,n){return function(i,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(l,u,f){var m=new XMLHttpRequest,p=0,h=function(v){var g=v.length,b=[],y=String.fromCharCode;for(p=0;p<g;p+=1)b.push(y(255&v.charCodeAt(p)));return b.join("")};if(m.open("GET",l,!u),m.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(m.onload=function(){m.status===200?f(h(this.responseText)):f(void 0)}),m.send(null),u&&m.status===200)return h(m.responseText)}(i,s,a)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(mt.API),function(e){function t(){return(vt.html2canvas?Promise.resolve(vt.html2canvas):ja(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function r(){return(vt.DOMPurify?Promise.resolve(vt.DOMPurify):ja(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=tr(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(a,o){var l=document.createElement(a);for(var u in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[u]=o.style[u];return l},s=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),u=a.convert(Promise.resolve(),l);return u=(u=u.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(r).then(function(l){return this.set({src:i("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(u,f){for(var m=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),p=u.firstChild;p;p=p.nextSibling)f!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||m.appendChild(l(p,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(m.width=u.width,m.height=u.height,m.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(m.value=u.value),m.addEventListener("load",function(){m.scrollTop=u.scrollTop,m.scrollLeft=u.scrollLeft},!0)),m}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var l=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=u,u)for(var p=0;p<u.length;++p){var h=u[p],v=h.src.find(function(g){return g.format==="truetype"});v&&l.addFont(v.url,h.ref.name,h.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,l.context2d.save(!0),o(this.prop.container,m)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(l){if(l in s.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(a,o){return this.then(function(){var l=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(l):l})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(l,u){return Math.floor(l*u/72*96)}return this.then(function(){(a=a||mt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,o,l,u){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,l,u){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,function(u,f){return l.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return l.updateProgress(null,u),m}).then(u,f).then(function(m){return l.updateProgress(1),m})})},s.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),f=l.call(u,a,o);return s.convert(f,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach(function(l){o=o.thenCore(l)}),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,mt.getPageSize=function(a,o,l){if(tr(a)==="object"){var u=a;a=u.orientation,o=u.unit||o,l=u.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var f,m=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+o}var h,v=0,g=0;if(p.hasOwnProperty(m))v=p[m][1]/f,g=p[m][0]/f;else try{v=l[1],g=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",g>v&&(h=g,g=v,v=h);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",v>g&&(h=g,g=v,v=h)}return{width:g,height:v,unit:o,k:f,orientation:a}},e.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(qg):null;var l=new s(o);return o.worker?l:l.from(a).doCallback()}}(mt.API),mt.API.addJS=function(e){return i5=e,this.internal.events.subscribe("postPutResources",function(){qh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(qh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+i5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){qh!==void 0&&n5!==void 0&&this.internal.out("/Names <</JavaScript "+qh+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var a=i[s],o=n.exec(a);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(a)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(s=0;s<u;s++){var m=r.internal.newObject();f.push(m);var p=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<f.length;s++)r.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var a={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(a),a},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var a=n.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=r.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(mt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,a,o){var l,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=a||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(m){for(var p,h=256*m.charCodeAt(4)+m.charCodeAt(5),v=m.length,g={width:0,height:0,numcomponents:1},b=4;b<v;b+=2){if(b+=h,t.indexOf(m.charCodeAt(b+1))!==-1){p=256*m.charCodeAt(b+5)+m.charCodeAt(b+6),g={width:256*m.charCodeAt(b+7)+m.charCodeAt(b+8),height:p,numcomponents:m.charCodeAt(b+9)};break}h=256*m.charCodeAt(b+2)+m.charCodeAt(b+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:i}}return f}}(mt.API);var pc,Vh,s5,a5,o5,YC=function(){var e,t,r;function n(s){var a,o,l,u,f,m,p,h,v,g,b,y,w,_;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},m=null;;){switch(a=this.readUInt32(),v=(function(){var j,O;for(O=[],j=0;j<4;++j)O.push(String.fromCharCode(this.data[this.pos++]));return O}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":m&&this.animation.frames.push(m),this.pos+=4,m={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),u=this.readUInt16()||100,m.delay=1e3*f/u,m.disposeOp=this.data[this.pos++],m.blendOp=this.data[this.pos++],m.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,a-=4),s=(m!=null?m.data:void 0)||this.imgData,y=0;0<=a?y<a:y>a;0<=a?++y:--y)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((g=l-this.transparency.indexed.length)>0)for(w=0;0<=g?w<g:w>g;0<=g?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":p=(b=this.read(a)).indexOf(0),h=String.fromCharCode.apply(String,b.slice(0,p)),this.text[h]=String.fromCharCode.apply(String,b.slice(p+1));break;case"IEND":return m&&this.animation.frames.push(m),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,u=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function f(m,p,h,v){var g,b,y,w,_,j,O,L,E,C,P,R,T,A,q,z,ne,U,G,B,Y,re=Math.ceil((u.width-m)/h),he=Math.ceil((u.height-p)/v),k=u.width==re&&u.height==he;for(A=a*re,R=k?o:new Uint8Array(A*he),j=s.length,T=0,b=0;T<he&&l<j;){switch(s[l++]){case 0:for(w=ne=0;ne<A;w=ne+=1)R[b++]=s[l++];break;case 1:for(w=U=0;U<A;w=U+=1)g=s[l++],_=w<a?0:R[b-a],R[b++]=(g+_)%256;break;case 2:for(w=G=0;G<A;w=G+=1)g=s[l++],y=(w-w%a)/a,q=T&&R[(T-1)*A+y*a+w%a],R[b++]=(q+g)%256;break;case 3:for(w=B=0;B<A;w=B+=1)g=s[l++],y=(w-w%a)/a,_=w<a?0:R[b-a],q=T&&R[(T-1)*A+y*a+w%a],R[b++]=(g+Math.floor((_+q)/2))%256;break;case 4:for(w=Y=0;Y<A;w=Y+=1)g=s[l++],y=(w-w%a)/a,_=w<a?0:R[b-a],T===0?q=z=0:(q=R[(T-1)*A+y*a+w%a],z=y&&R[(T-1)*A+(y-1)*a+w%a]),O=_+q-z,L=Math.abs(O-_),C=Math.abs(O-q),P=Math.abs(O-z),E=L<=C&&L<=P?_:C<=P?q:z,R[b++]=(g+E)%256;break;default:throw new Error("Invalid filter algorithm: "+s[l-1])}if(!k){var I=((p+T*v)*u.width+m)*a,M=T*A;for(w=0;w<re;w+=1){for(var D=0;D<a;D+=1)o[I++]=R[M++];I+=(h-1)*a}}T++}}return s=kC(s),u.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),o},n.prototype.decodePalette=function(){var s,a,o,l,u,f,m,p,h;for(o=this.palette,f=this.transparency.indexed||[],u=new Uint8Array((f.length||0)+o.length),l=0,s=0,a=m=0,p=o.length;m<p;a=m+=3)u[l++]=o[a],u[l++]=o[a+1],u[l++]=o[a+2],u[l++]=(h=f[s++])!=null?h:255;return u},n.prototype.copyToImageData=function(s,a){var o,l,u,f,m,p,h,v,g,b,y;if(l=this.colors,g=null,o=this.hasAlphaChannel,this.palette.length&&(g=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),l=4,o=!0),v=(u=s.data||s).length,m=g||a,f=p=0,l===1)for(;f<v;)h=g?4*a[f/4]:p,b=m[h++],u[f++]=b,u[f++]=b,u[f++]=b,u[f++]=o?m[h++]:255,p=h;else for(;f<v;)h=g?4*a[f/4]:p,u[f++]=m[h++],u[f++]=m[h++],u[f++]=m[h++],u[f++]=o?m[h++]:255,p=h},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(vt)==="[object Window]"){try{t=vt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(s){var a;if(i()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var a,o,l,u,f,m,p,h;if(this.animation){for(h=[],o=f=0,m=(p=this.animation.frames).length;f<m;o=++f)a=p[o],l=s.createImageData(a.width,a.height),u=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,u),a.imageData=l,h.push(a.image=e(l));return h}},n.prototype.renderFrame=function(s,a){var o,l,u;return o=(l=this.animation.frames)[a],u=l[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?s.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&s.putImageData(u.imageData,u.xOffset,u.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var a,o,l,u,f,m,p=this;return o=0,m=this.animation,u=m.numFrames,l=m.frames,f=m.numPlays,(a=function(){var h,v;if(h=o++%u,v=l[h],p.renderFrame(s,h),u>1&&o/u<f)return p.animation._timeout=setTimeout(a,v.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function KC(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,a=1<<(7&i)+1;e[t++],e[t++];var o=null,l=null;s&&(o=t,l=a,t+=3*a);var u=!0,f=[],m=0,p=null,h=0,v=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];m=e[t++]|e[t++]<<8,p=e[t++],!(1&g)&&(p=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var b=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,j=e[t++],O=j>>6&1,L=1<<(7&j)+1,E=o,C=l,P=!1;j>>7&&(P=!0,E=t,C=L,t+=3*L);var R=t;for(t++;;){var T;if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}f.push({x:b,y,width:w,height:_,has_local_palette:P,palette_offset:E,palette_size:C,data_offset:R,data_length:t-R,transparent_index:p,interlaced:!!O,delay:m,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return v},this.frameInfo=function(A){if(A<0||A>=f.length)throw new Error("Frame index out of range.");return f[A]},this.decodeAndBlitFrameBGRA=function(A,q){var z=this.frameInfo(A),ne=z.width*z.height,U=new Uint8Array(ne);l5(e,z.data_offset,U,ne);var G=z.palette_offset,B=z.transparent_index;B===null&&(B=256);var Y=z.width,re=r-Y,he=Y,k=4*(z.y*r+z.x),I=4*((z.y+z.height)*r+z.x),M=k,D=4*re;z.interlaced===!0&&(D+=4*r*7);for(var V=8,se=0,fe=U.length;se<fe;++se){var de=U[se];if(he===0&&(he=Y,(M+=D)>=I&&(D=4*re+4*r*(V-1),M=k+(Y+re)*(V<<1),V>>=1)),de===B)M+=4;else{var ve=e[G+3*de],Ee=e[G+3*de+1],Oe=e[G+3*de+2];q[M++]=Oe,q[M++]=Ee,q[M++]=ve,q[M++]=255}--he}},this.decodeAndBlitFrameRGBA=function(A,q){var z=this.frameInfo(A),ne=z.width*z.height,U=new Uint8Array(ne);l5(e,z.data_offset,U,ne);var G=z.palette_offset,B=z.transparent_index;B===null&&(B=256);var Y=z.width,re=r-Y,he=Y,k=4*(z.y*r+z.x),I=4*((z.y+z.height)*r+z.x),M=k,D=4*re;z.interlaced===!0&&(D+=4*r*7);for(var V=8,se=0,fe=U.length;se<fe;++se){var de=U[se];if(he===0&&(he=Y,(M+=D)>=I&&(D=4*re+4*r*(V-1),M=k+(Y+re)*(V<<1),V>>=1)),de===B)M+=4;else{var ve=e[G+3*de],Ee=e[G+3*de+1],Oe=e[G+3*de+2];q[M++]=ve,q[M++]=Ee,q[M++]=Oe,q[M++]=255}--he}}}function l5(e,t,r,n){for(var i=e[t++],s=1<<i,a=s+1,o=a+1,l=i+1,u=(1<<l)-1,f=0,m=0,p=0,h=e[t++],v=new Int32Array(4096),g=null;;){for(;f<16&&h!==0;)m|=e[t++]<<f,f+=8,h===1?h=e[t++]:--h;if(f<l)break;var b=m&u;if(m>>=l,f-=l,b!==s){if(b===a)break;for(var y=b<o?b:g,w=0,_=y;_>s;)_=v[_]>>8,++w;var j=_;if(p+w+(y!==b?1:0)>n)return void ur.log("Warning, gif stream longer than expected.");r[p++]=j;var O=p+=w;for(y!==b&&(r[p++]=j),_=y;w--;)_=v[_],r[--O]=255&_,_>>=8;g!==null&&o<4096&&(v[o++]=g<<8|j,o>=u+1&&l<12&&(++l,u=u<<1|1)),g=b}else o=a+1,u=(1<<(l=i+1))-1,g=null}return p!==n&&ur.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function g1(e){var t,r,n,i,s,a=Math.floor,o=new Array(64),l=new Array(64),u=new Array(64),f=new Array(64),m=new Array(65535),p=new Array(65535),h=new Array(64),v=new Array(64),g=[],b=0,y=7,w=new Array(64),_=new Array(64),j=new Array(64),O=new Array(256),L=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ne=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function U(k,I){for(var M=0,D=0,V=new Array,se=1;se<=16;se++){for(var fe=1;fe<=k[se];fe++)V[I[D]]=[],V[I[D]][0]=M,V[I[D]][1]=se,D++,M++;M*=2}return V}function G(k){for(var I=k[0],M=k[1]-1;M>=0;)I&1<<M&&(b|=1<<y),M--,--y<0&&(b==255?(B(255),B(0)):B(b),y=7,b=0)}function B(k){g.push(k)}function Y(k){B(k>>8&255),B(255&k)}function re(k,I,M,D,V){for(var se,fe=V[0],de=V[240],ve=function(ze,Ye){var Ze,tt,ft,dt,bt,jt,Lt,Ot,xt,Ct,nt=0;for(xt=0;xt<8;++xt){Ze=ze[nt],tt=ze[nt+1],ft=ze[nt+2],dt=ze[nt+3],bt=ze[nt+4],jt=ze[nt+5],Lt=ze[nt+6];var en=Ze+(Ot=ze[nt+7]),Rt=Ze-Ot,ti=tt+Lt,Yt=tt-Lt,fr=ft+jt,Ui=ft-jt,Ut=dt+bt,Os=dt-bt,gr=en+Ut,yi=en-Ut,as=ti+fr,lr=ti-fr;ze[nt]=gr+as,ze[nt+4]=gr-as;var _t=.707106781*(lr+yi);ze[nt+2]=yi+_t,ze[nt+6]=yi-_t;var Ht=.382683433*((gr=Os+Ui)-(lr=Yt+Rt)),ra=.5411961*gr+Ht,tn=1.306562965*lr+Ht,zi=.707106781*(as=Ui+Yt),Wi=Rt+zi,pt=Rt-zi;ze[nt+5]=pt+ra,ze[nt+3]=pt-ra,ze[nt+1]=Wi+tn,ze[nt+7]=Wi-tn,nt+=8}for(nt=0,xt=0;xt<8;++xt){Ze=ze[nt],tt=ze[nt+8],ft=ze[nt+16],dt=ze[nt+24],bt=ze[nt+32],jt=ze[nt+40],Lt=ze[nt+48];var wi=Ze+(Ot=ze[nt+56]),ri=Ze-Ot,Cn=tt+Lt,Dr=tt-Lt,jr=ft+jt,X=ft-jt,oe=dt+bt,ee=dt-bt,te=wi+oe,ae=wi-oe,le=Cn+jr,Se=Cn-jr;ze[nt]=te+le,ze[nt+32]=te-le;var Ce=.707106781*(Se+ae);ze[nt+16]=ae+Ce,ze[nt+48]=ae-Ce;var _e=.382683433*((te=ee+X)-(Se=Dr+ri)),je=.5411961*te+_e,Ae=1.306562965*Se+_e,He=.707106781*(le=X+Dr),Ke=ri+He,st=ri-He;ze[nt+40]=st+je,ze[nt+24]=st-je,ze[nt+8]=Ke+Ae,ze[nt+56]=Ke-Ae,nt++}for(xt=0;xt<64;++xt)Ct=ze[xt]*Ye[xt],h[xt]=Ct>0?Ct+.5|0:Ct-.5|0;return h}(k,I),Ee=0;Ee<64;++Ee)v[E[Ee]]=ve[Ee];var Oe=v[0]-M;M=v[0],Oe==0?G(D[0]):(G(D[p[se=32767+Oe]]),G(m[se]));for(var Ve=63;Ve>0&&v[Ve]==0;)Ve--;if(Ve==0)return G(fe),M;for(var Qe,Te=1;Te<=Ve;){for(var ue=Te;v[Te]==0&&Te<=Ve;)++Te;var Me=Te-ue;if(Me>=16){Qe=Me>>4;for(var at=1;at<=Qe;++at)G(de);Me&=15}se=32767+v[Te],G(V[(Me<<4)+p[se]]),G(m[se]),Te++}return Ve!=63&&G(fe),M}function he(k){k=Math.min(Math.max(k,1),100),s!=k&&(function(I){for(var M=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],D=0;D<64;D++){var V=a((M[D]*I+50)/100);V=Math.min(Math.max(V,1),255),o[E[D]]=V}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var de=a((se[fe]*I+50)/100);de=Math.min(Math.max(de,1),255),l[E[fe]]=de}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,Oe=0;Oe<8;Oe++)for(var Ve=0;Ve<8;Ve++)u[Ee]=1/(o[E[Ee]]*ve[Oe]*ve[Ve]*8),f[Ee]=1/(l[E[Ee]]*ve[Oe]*ve[Ve]*8),Ee++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),s=k)}this.encode=function(k,I){I&&he(I),g=new Array,b=0,y=7,Y(65496),Y(65504),Y(16),B(74),B(70),B(73),B(70),B(0),B(1),B(1),B(0),Y(1),Y(1),B(0),B(0),function(){Y(65499),Y(132),B(0);for(var tt=0;tt<64;tt++)B(o[tt]);B(1);for(var ft=0;ft<64;ft++)B(l[ft])}(),function(tt,ft){Y(65472),Y(17),B(8),Y(ft),Y(tt),B(3),B(1),B(17),B(0),B(2),B(17),B(1),B(3),B(17),B(1)}(k.width,k.height),function(){Y(65476),Y(418),B(0);for(var tt=0;tt<16;tt++)B(C[tt+1]);for(var ft=0;ft<=11;ft++)B(P[ft]);B(16);for(var dt=0;dt<16;dt++)B(R[dt+1]);for(var bt=0;bt<=161;bt++)B(T[bt]);B(1);for(var jt=0;jt<16;jt++)B(A[jt+1]);for(var Lt=0;Lt<=11;Lt++)B(q[Lt]);B(17);for(var Ot=0;Ot<16;Ot++)B(z[Ot+1]);for(var xt=0;xt<=161;xt++)B(ne[xt])}(),Y(65498),Y(12),B(3),B(1),B(0),B(2),B(17),B(3),B(17),B(0),B(63),B(0);var M=0,D=0,V=0;b=0,y=7,this.encode.displayName="_encode_";for(var se,fe,de,ve,Ee,Oe,Ve,Qe,Te,ue=k.data,Me=k.width,at=k.height,ze=4*Me,Ye=0;Ye<at;){for(se=0;se<ze;){for(Ee=ze*Ye+se,Ve=-1,Qe=0,Te=0;Te<64;Te++)Oe=Ee+(Qe=Te>>3)*ze+(Ve=4*(7&Te)),Ye+Qe>=at&&(Oe-=ze*(Ye+1+Qe-at)),se+Ve>=ze&&(Oe-=se+Ve-ze+4),fe=ue[Oe++],de=ue[Oe++],ve=ue[Oe++],w[Te]=(L[fe]+L[de+256>>0]+L[ve+512>>0]>>16)-128,_[Te]=(L[fe+768>>0]+L[de+1024>>0]+L[ve+1280>>0]>>16)-128,j[Te]=(L[fe+1280>>0]+L[de+1536>>0]+L[ve+1792>>0]>>16)-128;M=re(w,u,M,t,n),D=re(_,f,D,r,i),V=re(j,f,V,r,i),se+=32}Ye+=8}if(y>=0){var Ze=[];Ze[1]=y+1,Ze[0]=(1<<y+1)-1,G(Ze)}return Y(65497),new Uint8Array(g)},e=e||50,function(){for(var k=String.fromCharCode,I=0;I<256;I++)O[I]=k(I)}(),t=U(C,P),r=U(A,q),n=U(R,T),i=U(z,ne),function(){for(var k=1,I=2,M=1;M<=15;M++){for(var D=k;D<I;D++)p[32767+D]=M,m[32767+D]=[],m[32767+D][1]=M,m[32767+D][0]=D;for(var V=-(I-1);V<=-k;V++)p[32767+V]=M,m[32767+V]=[],m[32767+V][1]=M,m[32767+V][0]=I-1+V;k<<=1,I<<=1}}(),function(){for(var k=0;k<256;k++)L[k]=19595*k,L[k+256>>0]=38470*k,L[k+512>>0]=7471*k+32768,L[k+768>>0]=-11059*k,L[k+1024>>0]=-21709*k,L[k+1280>>0]=32768*k+8421375,L[k+1536>>0]=-27439*k,L[k+1792>>0]=-5329*k}(),he(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function gs(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function c5(e){function t(C){if(!C)throw Error("assert :P")}function r(C,P,R){for(var T=0;4>T;T++)if(C[P+T]!=R.charCodeAt(T))return!0;return!1}function n(C,P,R,T,A){for(var q=0;q<A;q++)C[P+q]=R[T+q]}function i(C,P,R,T){for(var A=0;A<T;A++)C[P+A]=R}function s(C){return new Int32Array(C)}function a(C,P){for(var R=[],T=0;T<C;T++)R.push(new P);return R}function o(C,P){var R=[];return function T(A,q,z){for(var ne=z[q],U=0;U<ne&&(A.push(z.length>q+1?[]:new P),!(z.length<q+1));U++)T(A[U],q+1,z)}(R,0,C),R}var l=function(){var C=this;function P(d,x){for(var N=1<<x-1>>>0;d&N;)N>>>=1;return N?(d&N-1)+N:d}function R(d,x,N,F,W){t(!(F%N));do d[x+(F-=N)]=W;while(0<F)}function T(d,x,N,F,W){if(t(2328>=W),512>=W)var K=s(512);else if((K=s(W))==null)return 0;return function(J,Q,Z,ie,ge,Ne){var ke,we,Re=Q,Pe=1<<Z,xe=s(16),ye=s(16);for(t(ge!=0),t(ie!=null),t(J!=null),t(0<Z),we=0;we<ge;++we){if(15<ie[we])return 0;++xe[ie[we]]}if(xe[0]==ge)return 0;for(ye[1]=0,ke=1;15>ke;++ke){if(xe[ke]>1<<ke)return 0;ye[ke+1]=ye[ke]+xe[ke]}for(we=0;we<ge;++we)ke=ie[we],0<ie[we]&&(Ne[ye[ke]++]=we);if(ye[15]==1)return(ie=new A).g=0,ie.value=Ne[0],R(J,Re,1,Pe,ie),Pe;var De,Ue=-1,Ie=Pe-1,lt=0,et=1,gt=1,rt=1<<Z;for(we=0,ke=1,ge=2;ke<=Z;++ke,ge<<=1){if(et+=gt<<=1,0>(gt-=xe[ke]))return 0;for(;0<xe[ke];--xe[ke])(ie=new A).g=ke,ie.value=Ne[we++],R(J,Re+lt,ge,rt,ie),lt=P(lt,ke)}for(ke=Z+1,ge=2;15>=ke;++ke,ge<<=1){if(et+=gt<<=1,0>(gt-=xe[ke]))return 0;for(;0<xe[ke];--xe[ke]){if(ie=new A,(lt&Ie)!=Ue){for(Re+=rt,De=1<<(Ue=ke)-Z;15>Ue&&!(0>=(De-=xe[Ue]));)++Ue,De<<=1;Pe+=rt=1<<(De=Ue-Z),J[Q+(Ue=lt&Ie)].g=De+Z,J[Q+Ue].value=Re-Q-Ue}ie.g=ke-Z,ie.value=Ne[we++],R(J,Re+(lt>>Z),ge,rt,ie),lt=P(lt,ke)}}return et!=2*ye[15]-1?0:Pe}(d,x,N,F,W,K)}function A(){this.value=this.g=0}function q(){this.value=this.g=0}function z(){this.G=a(5,A),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(yn,q)}function ne(d,x,N,F){t(d!=null),t(x!=null),t(2147483648>F),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=x,d.pa=N,d.Jd=x,d.Yc=N+F,d.Zc=4<=F?N+F-4+1:N,se(d)}function U(d,x){for(var N=0;0<x--;)N|=de(d,128)<<x;return N}function G(d,x){var N=U(d,x);return fe(d)?-N:N}function B(d,x,N,F){var W,K=0;for(t(d!=null),t(x!=null),t(4294967288>F),d.Sb=F,d.Ra=0,d.u=0,d.h=0,4<F&&(F=4),W=0;W<F;++W)K+=x[N+W]<<8*W;d.Ra=K,d.bb=F,d.oa=x,d.pa=N}function Y(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<Ql-8>>>0,++d.bb,d.u-=8;M(d)&&(d.h=1,d.u=0)}function re(d,x){if(t(0<=x),!d.h&&x<=Jl){var N=I(d)&Xl[x];return d.u+=x,Y(d),N}return d.h=1,d.u=0}function he(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(d){return d.Ra>>>(d.u&Ql-1)>>>0}function M(d){return t(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>Ql}function D(d,x){d.u=x,d.h=M(d)}function V(d){d.u>=Iu&&(t(d.u>=Iu),Y(d))}function se(d){t(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(t(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function fe(d){return U(d,1)}function de(d,x){var N=d.Ca;0>d.b&&se(d);var F=d.b,W=N*x>>>8,K=(d.I>>>F>W)+0;for(K?(N-=W,d.I-=W+1<<F>>>0):N=W+1,F=N,W=0;256<=F;)W+=8,F>>=8;return F=7^W+ii[F],d.b-=F,d.Ca=(N<<F)-1,K}function ve(d,x,N){d[x+0]=N>>24&255,d[x+1]=N>>16&255,d[x+2]=N>>8&255,d[x+3]=N>>0&255}function Ee(d,x){return d[x+0]<<0|d[x+1]<<8}function Oe(d,x){return Ee(d,x)|d[x+2]<<16}function Ve(d,x){return Ee(d,x)|Ee(d,x+2)<<16}function Qe(d,x){var N=1<<x;return t(d!=null),t(0<x),d.X=s(N),d.X==null?0:(d.Mb=32-x,d.Xa=x,1)}function Te(d,x){t(d!=null),t(x!=null),t(d.Xa==x.Xa),n(x.X,0,d.X,0,1<<x.Xa)}function ue(){this.X=[],this.Xa=this.Mb=0}function Me(d,x,N,F){t(N!=null),t(F!=null);var W=N[0],K=F[0];return W==0&&(W=(d*K+x/2)/x),K==0&&(K=(x*W+d/2)/d),0>=W||0>=K?0:(N[0]=W,F[0]=K,1)}function at(d,x){return d+(1<<x)-1>>>x}function ze(d,x){return((4278255360&d)+(4278255360&x)>>>0&4278255360)+((16711935&d)+(16711935&x)>>>0&16711935)>>>0}function Ye(d,x){C[x]=function(N,F,W,K,J,Q,Z){var ie;for(ie=0;ie<J;++ie){var ge=C[d](Q[Z+ie-1],W,K+ie);Q[Z+ie]=ze(N[F+ie],ge)}}}function Ze(){this.ud=this.hd=this.jd=0}function tt(d,x){return((4278124286&(d^x))>>>1)+(d&x)>>>0}function ft(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function dt(d,x){return ft(d+(d-x+.5>>1))}function bt(d,x,N){return Math.abs(x-N)-Math.abs(d-N)}function jt(d,x,N,F,W,K,J){for(F=K[J-1],N=0;N<W;++N)K[J+N]=F=ze(d[x+N],F)}function Lt(d,x,N,F,W){var K;for(K=0;K<N;++K){var J=d[x+K],Q=J>>8&255,Z=16711935&(Z=(Z=16711935&J)+((Q<<16)+Q));F[W+K]=(4278255360&J)+Z>>>0}}function Ot(d,x){x.jd=d>>0&255,x.hd=d>>8&255,x.ud=d>>16&255}function xt(d,x,N,F,W,K){var J;for(J=0;J<F;++J){var Q=x[N+J],Z=Q>>>8,ie=Q,ge=255&(ge=(ge=Q>>>16)+((d.jd<<24>>24)*(Z<<24>>24)>>>5));ie=255&(ie=(ie=ie+((d.hd<<24>>24)*(Z<<24>>24)>>>5))+((d.ud<<24>>24)*(ge<<24>>24)>>>5)),W[K+J]=(4278255360&Q)+(ge<<16)+ie}}function Ct(d,x,N,F,W){C[x]=function(K,J,Q,Z,ie,ge,Ne,ke,we){for(Z=Ne;Z<ke;++Z)for(Ne=0;Ne<we;++Ne)ie[ge++]=W(Q[F(K[J++])])},C[d]=function(K,J,Q,Z,ie,ge,Ne){var ke=8>>K.b,we=K.Ea,Re=K.K[0],Pe=K.w;if(8>ke)for(K=(1<<K.b)-1,Pe=(1<<ke)-1;J<Q;++J){var xe,ye=0;for(xe=0;xe<we;++xe)xe&K||(ye=F(Z[ie++])),ge[Ne++]=W(Re[ye&Pe]),ye>>=ke}else C["VP8LMapColor"+N](Z,ie,Re,Pe,ge,Ne,J,Q,we)}}function nt(d,x,N,F,W){for(N=x+N;x<N;){var K=d[x++];F[W++]=K>>16&255,F[W++]=K>>8&255,F[W++]=K>>0&255}}function en(d,x,N,F,W){for(N=x+N;x<N;){var K=d[x++];F[W++]=K>>16&255,F[W++]=K>>8&255,F[W++]=K>>0&255,F[W++]=K>>24&255}}function Rt(d,x,N,F,W){for(N=x+N;x<N;){var K=(J=d[x++])>>16&240|J>>12&15,J=J>>0&240|J>>28&15;F[W++]=K,F[W++]=J}}function ti(d,x,N,F,W){for(N=x+N;x<N;){var K=(J=d[x++])>>16&248|J>>13&7,J=J>>5&224|J>>3&31;F[W++]=K,F[W++]=J}}function Yt(d,x,N,F,W){for(N=x+N;x<N;){var K=d[x++];F[W++]=K>>0&255,F[W++]=K>>8&255,F[W++]=K>>16&255}}function fr(d,x,N,F,W,K){if(K==0)for(N=x+N;x<N;)ve(F,((K=d[x++])[0]>>24|K[1]>>8&65280|K[2]<<8&16711680|K[3]<<24)>>>0),W+=32;else n(F,W,d,x,N)}function Ui(d,x){C[x][0]=C[d+"0"],C[x][1]=C[d+"1"],C[x][2]=C[d+"2"],C[x][3]=C[d+"3"],C[x][4]=C[d+"4"],C[x][5]=C[d+"5"],C[x][6]=C[d+"6"],C[x][7]=C[d+"7"],C[x][8]=C[d+"8"],C[x][9]=C[d+"9"],C[x][10]=C[d+"10"],C[x][11]=C[d+"11"],C[x][12]=C[d+"12"],C[x][13]=C[d+"13"],C[x][14]=C[d+"0"],C[x][15]=C[d+"0"]}function Ut(d){return d==fp||d==dp||d==oh||d==hp}function Os(){this.eb=[],this.size=this.A=this.fb=0}function gr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function yi(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Os,this.f.kb=new gr,this.sd=null}function as(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function lr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _t(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Ht(d,x){var N=d.T,F=x.ba.f.RGBA,W=F.eb,K=F.fb+d.ka*F.A,J=Yi[x.ba.S],Q=d.y,Z=d.O,ie=d.f,ge=d.N,Ne=d.ea,ke=d.W,we=x.cc,Re=x.dc,Pe=x.Mc,xe=x.Nc,ye=d.ka,De=d.ka+d.T,Ue=d.U,Ie=Ue+1>>1;for(ye==0?J(Q,Z,null,null,ie,ge,Ne,ke,ie,ge,Ne,ke,W,K,null,null,Ue):(J(x.ec,x.fc,Q,Z,we,Re,Pe,xe,ie,ge,Ne,ke,W,K-F.A,W,K,Ue),++N);ye+2<De;ye+=2)we=ie,Re=ge,Pe=Ne,xe=ke,ge+=d.Rc,ke+=d.Rc,K+=2*F.A,J(Q,(Z+=2*d.fa)-d.fa,Q,Z,we,Re,Pe,xe,ie,ge,Ne,ke,W,K-F.A,W,K,Ue);return Z+=d.fa,d.j+De<d.o?(n(x.ec,x.fc,Q,Z,Ue),n(x.cc,x.dc,ie,ge,Ie),n(x.Mc,x.Nc,Ne,ke,Ie),N--):1&De||J(Q,Z,null,null,ie,ge,Ne,ke,ie,ge,Ne,ke,W,K+F.A,null,null,Ue),N}function ra(d,x,N){var F=d.F,W=[d.J];if(F!=null){var K=d.U,J=x.ba.S,Q=J==ah||J==oh;x=x.ba.f.RGBA;var Z=[0],ie=d.ka;Z[0]=d.T,d.Kb&&(ie==0?--Z[0]:(--ie,W[0]-=d.width),d.j+d.ka+d.T==d.o&&(Z[0]=d.o-d.j-ie));var ge=x.eb;ie=x.fb+ie*x.A,d=hr(F,W[0],d.width,K,Z,ge,ie+(Q?0:3),x.A),t(N==Z),d&&Ut(J)&&Vi(ge,ie,Q,K,Z,x.A)}return 0}function tn(d){var x=d.ma,N=x.ba.S,F=11>N,W=N==ih||N==sh||N==ah||N==up||N==12||Ut(N);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!Ou(x.Oa,d,W?11:12))return 0;if(W&&Ut(N)&&We(),d.da)alert("todo:use_scaling");else{if(F){if(x.Ib=_t,d.Kb){if(N=d.U+1>>1,x.memory=s(d.U+2*N),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+d.U,x.Mc=x.cc,x.Nc=x.dc+N,x.Ib=Ht,We()}}else alert("todo:EmitYUV");W&&(x.Jb=ra,F&&be())}if(F&&!Mx){for(d=0;256>d;++d)BS[d]=89858*(d-128)+ch>>lh,WS[d]=-22014*(d-128)+ch,zS[d]=-45773*(d-128),US[d]=113618*(d-128)+ch>>lh;for(d=Hu;d<gp;++d)x=76283*(d-16)+ch>>lh,HS[d-Hu]=_i(x,255),$S[d-Hu]=_i(x+8>>4,15);Mx=1}return 1}function zi(d){var x=d.ma,N=d.U,F=d.T;return t(!(1&d.ka)),0>=N||0>=F?0:(N=x.Ib(d,x),x.Jb!=null&&x.Jb(d,x,N),x.Dc+=N,1)}function Wi(d){d.ma.memory=null}function pt(d,x,N,F){return re(d,8)!=47?0:(x[0]=re(d,14)+1,N[0]=re(d,14)+1,F[0]=re(d,1),re(d,3)!=0?0:!d.h)}function wi(d,x){if(4>d)return d+1;var N=d-2>>1;return(2+(1&d)<<N)+re(x,N)+1}function ri(d,x){return 120<x?x-120:1<=(N=((N=kS[x-1])>>4)*d+(8-(15&N)))?N:1;var N}function Cn(d,x,N){var F=I(N),W=d[x+=255&F].g-8;return 0<W&&(D(N,N.u+8),F=I(N),x+=d[x].value,x+=F&(1<<W)-1),D(N,N.u+d[x].g),d[x].value}function Dr(d,x,N){return N.g+=d.g,N.value+=d.value<<x>>>0,t(8>=N.g),d.g}function jr(d,x,N){var F=d.xc;return t((x=F==0?0:d.vc[d.md*(N>>F)+(x>>F)])<d.Wb),d.Ya[x]}function X(d,x,N,F){var W=d.ab,K=d.c*x,J=d.C;x=J+x;var Q=N,Z=F;for(F=d.Ta,N=d.Ua;0<W--;){var ie=d.gc[W],ge=J,Ne=x,ke=Q,we=Z,Re=(Z=F,Q=N,ie.Ea);switch(t(ge<Ne),t(Ne<=ie.nc),ie.hc){case 2:Jd(ke,we,(Ne-ge)*Re,Z,Q);break;case 0:var Pe=ge,xe=Ne,ye=Z,De=Q,Ue=(rt=ie).Ea;Pe==0&&(lp(ke,we,null,null,1,ye,De),jt(ke,we+1,0,0,Ue-1,ye,De+1),we+=Ue,De+=Ue,++Pe);for(var Ie=1<<rt.b,lt=Ie-1,et=at(Ue,rt.b),gt=rt.K,rt=rt.w+(Pe>>rt.b)*et;Pe<xe;){var qt=gt,Xt=rt,zt=1;for(Ru(ke,we,ye,De-Ue,1,ye,De);zt<Ue;){var Dt=(zt&~lt)+Ie;Dt>Ue&&(Dt=Ue),(0,Da[qt[Xt++]>>8&15])(ke,we+ +zt,ye,De+zt-Ue,Dt-zt,ye,De+zt),zt=Dt}we+=Ue,De+=Ue,++Pe&lt||(rt+=et)}Ne!=ie.nc&&n(Z,Q-Re,Z,Q+(Ne-ge-1)*Re,Re);break;case 1:for(Re=ke,xe=we,Ue=(ke=ie.Ea)-(De=ke&~(ye=(we=1<<ie.b)-1)),Pe=at(ke,ie.b),Ie=ie.K,ie=ie.w+(ge>>ie.b)*Pe;ge<Ne;){for(lt=Ie,et=ie,gt=new Ze,rt=xe+De,qt=xe+ke;xe<rt;)Ot(lt[et++],gt),qo(gt,Re,xe,we,Z,Q),xe+=we,Q+=we;xe<qt&&(Ot(lt[et++],gt),qo(gt,Re,xe,Ue,Z,Q),xe+=Ue,Q+=Ue),++ge&ye||(ie+=Pe)}break;case 3:if(ke==Z&&we==Q&&0<ie.b){for(xe=Z,ke=Re=Q+(Ne-ge)*Re-(De=(Ne-ge)*at(ie.Ea,ie.b)),we=Z,ye=Q,Pe=[],De=(Ue=De)-1;0<=De;--De)Pe[De]=we[ye+De];for(De=Ue-1;0<=De;--De)xe[ke+De]=Pe[De];Hi(ie,ge,Ne,Z,Re,Z,Q)}else Hi(ie,ge,Ne,ke,we,Z,Q)}Q=F,Z=N}Z!=N&&n(F,N,Q,Z,K)}function oe(d,x){var N=d.V,F=d.Ba+d.c*d.C,W=x-d.C;if(t(x<=d.l.o),t(16>=W),0<W){var K=d.l,J=d.Ta,Q=d.Ua,Z=K.width;if(X(d,W,N,F),W=Q=[Q],t((N=d.C)<(F=x)),t(K.v<K.va),F>K.o&&(F=K.o),N<K.j){var ie=K.j-N;N=K.j,W[0]+=ie*Z}if(N>=F?N=0:(W[0]+=4*K.v,K.ka=N-K.j,K.U=K.va-K.v,K.T=F-N,N=1),N){if(Q=Q[0],11>(N=d.ca).S){var ge=N.f.RGBA,Ne=(F=N.S,W=K.U,K=K.T,ie=ge.eb,ge.A),ke=K;for(ge=ge.fb+d.Ma*ge.A;0<ke--;){var we=J,Re=Q,Pe=W,xe=ie,ye=ge;switch(F){case nh:si(we,Re,Pe,xe,ye);break;case ih:$n(we,Re,Pe,xe,ye);break;case fp:$n(we,Re,Pe,xe,ye),Vi(xe,ye,0,Pe,1,0);break;case Tx:oa(we,Re,Pe,xe,ye);break;case sh:fr(we,Re,Pe,xe,ye,1);break;case dp:fr(we,Re,Pe,xe,ye,1),Vi(xe,ye,0,Pe,1,0);break;case ah:fr(we,Re,Pe,xe,ye,0);break;case oh:fr(we,Re,Pe,xe,ye,0),Vi(xe,ye,1,Pe,1,0);break;case up:Ia(we,Re,Pe,xe,ye);break;case hp:Ia(we,Re,Pe,xe,ye),dr(xe,ye,Pe,1,0);break;case Cx:aa(we,Re,Pe,xe,ye);break;default:t(0)}Q+=Z,ge+=Ne}d.Ma+=K}else alert("todo:EmitRescaledRowsYUVA");t(d.Ma<=N.height)}}d.C=x,t(d.C<=d.i)}function ee(d){var x;if(0<d.ua)return 0;for(x=0;x<d.Wb;++x){var N=d.Ya[x].G,F=d.Ya[x].H;if(0<N[1][F[1]+0].g||0<N[2][F[2]+0].g||0<N[3][F[3]+0].g)return 0}return 1}function te(d,x,N,F,W,K){if(d.Z!=0){var J=d.qd,Q=d.rd;for(t(Ua[d.Z]!=null);x<N;++x)Ua[d.Z](J,Q,F,W,F,W,K),J=F,Q=W,W+=K;d.qd=J,d.rd=Q}}function ae(d,x){var N=d.l.ma,F=N.Z==0||N.Z==1?d.l.j:d.C;if(F=d.C<F?F:d.C,t(x<=d.l.o),x>F){var W=d.l.width,K=N.ca,J=N.tb+W*F,Q=d.V,Z=d.Ba+d.c*F,ie=d.gc;t(d.ab==1),t(ie[0].hc==3),Qd(ie[0],F,x,Q,Z,K,J),te(N,F,x,K,J,W)}d.C=d.Ma=x}function le(d,x,N,F,W,K,J){var Q=d.$/F,Z=d.$%F,ie=d.m,ge=d.s,Ne=N+d.$,ke=Ne;W=N+F*W;var we=N+F*K,Re=280+ge.ua,Pe=d.Pb?Q:16777216,xe=0<ge.ua?ge.Wa:null,ye=ge.wc,De=Ne<we?jr(ge,Z,Q):null;t(d.C<K),t(we<=W);var Ue=!1;e:for(;;){for(;Ue||Ne<we;){var Ie=0;if(Q>=Pe){var lt=Ne-N;t((Pe=d).Pb),Pe.wd=Pe.m,Pe.xd=lt,0<Pe.s.ua&&Te(Pe.s.Wa,Pe.s.vb),Pe=Q+jS}if(Z&ye||(De=jr(ge,Z,Q)),t(De!=null),De.Qb&&(x[Ne]=De.qb,Ue=!0),!Ue)if(V(ie),De.jc){Ie=ie,lt=x;var et=Ne,gt=De.pd[I(Ie)&yn-1];t(De.jc),256>gt.g?(D(Ie,Ie.u+gt.g),lt[et]=gt.value,Ie=0):(D(Ie,Ie.u+gt.g-256),t(256<=gt.value),Ie=gt.value),Ie==0&&(Ue=!0)}else Ie=Cn(De.G[0],De.H[0],ie);if(ie.h)break;if(Ue||256>Ie){if(!Ue)if(De.nd)x[Ne]=(De.qb|Ie<<8)>>>0;else{if(V(ie),Ue=Cn(De.G[1],De.H[1],ie),V(ie),lt=Cn(De.G[2],De.H[2],ie),et=Cn(De.G[3],De.H[3],ie),ie.h)break;x[Ne]=(et<<24|Ue<<16|Ie<<8|lt)>>>0}if(Ue=!1,++Ne,++Z>=F&&(Z=0,++Q,J!=null&&Q<=K&&!(Q%16)&&J(d,Q),xe!=null))for(;ke<Ne;)Ie=x[ke++],xe.X[(506832829*Ie&4294967295)>>>xe.Mb]=Ie}else if(280>Ie){if(Ie=wi(Ie-256,ie),lt=Cn(De.G[4],De.H[4],ie),V(ie),lt=ri(F,lt=wi(lt,ie)),ie.h)break;if(Ne-N<lt||W-Ne<Ie)break e;for(et=0;et<Ie;++et)x[Ne+et]=x[Ne+et-lt];for(Ne+=Ie,Z+=Ie;Z>=F;)Z-=F,++Q,J!=null&&Q<=K&&!(Q%16)&&J(d,Q);if(t(Ne<=W),Z&ye&&(De=jr(ge,Z,Q)),xe!=null)for(;ke<Ne;)Ie=x[ke++],xe.X[(506832829*Ie&4294967295)>>>xe.Mb]=Ie}else{if(!(Ie<Re))break e;for(Ue=Ie-280,t(xe!=null);ke<Ne;)Ie=x[ke++],xe.X[(506832829*Ie&4294967295)>>>xe.Mb]=Ie;Ie=Ne,t(!(Ue>>>(lt=xe).Xa)),x[Ie]=lt.X[Ue],Ue=!0}Ue||t(ie.h==M(ie))}if(d.Pb&&ie.h&&Ne<W)t(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&Te(d.s.vb,d.s.Wa);else{if(ie.h)break e;J!=null&&J(d,Q>K?K:Q),d.a=0,d.$=Ne-N}return 1}return d.a=3,0}function Se(d){t(d!=null),d.vc=null,d.yc=null,d.Ya=null;var x=d.Wa;x!=null&&(x.X=null),d.vb=null,t(d!=null)}function Ce(){var d=new op;return d==null?null:(d.a=0,d.xb=Fx,Ui("Predictor","VP8LPredictors"),Ui("Predictor","VP8LPredictors_C"),Ui("PredictorAdd","VP8LPredictorsAdd"),Ui("PredictorAdd","VP8LPredictorsAdd_C"),Jd=Lt,qo=xt,si=nt,$n=en,Ia=Rt,aa=ti,oa=Yt,C.VP8LMapColor32b=Zl,C.VP8LMapColor8b=Zd,d)}function _e(d,x,N,F,W){var K=1,J=[d],Q=[x],Z=F.m,ie=F.s,ge=null,Ne=0;e:for(;;){if(N)for(;K&&re(Z,1);){var ke=J,we=Q,Re=F,Pe=1,xe=Re.m,ye=Re.gc[Re.ab],De=re(xe,2);if(Re.Oc&1<<De)K=0;else{switch(Re.Oc|=1<<De,ye.hc=De,ye.Ea=ke[0],ye.nc=we[0],ye.K=[null],++Re.ab,t(4>=Re.ab),De){case 0:case 1:ye.b=re(xe,3)+2,Pe=_e(at(ye.Ea,ye.b),at(ye.nc,ye.b),0,Re,ye.K),ye.K=ye.K[0];break;case 3:var Ue,Ie=re(xe,8)+1,lt=16<Ie?0:4<Ie?1:2<Ie?2:3;if(ke[0]=at(ye.Ea,lt),ye.b=lt,Ue=Pe=_e(Ie,1,0,Re,ye.K)){var et,gt=Ie,rt=ye,qt=1<<(8>>rt.b),Xt=s(qt);if(Xt==null)Ue=0;else{var zt=rt.K[0],Dt=rt.w;for(Xt[0]=rt.K[0][0],et=1;et<1*gt;++et)Xt[et]=ze(zt[Dt+et],Xt[et-1]);for(;et<4*qt;++et)Xt[et]=0;rt.K[0]=null,rt.K[0]=Xt,Ue=1}}Pe=Ue;break;case 2:break;default:t(0)}K=Pe}}if(J=J[0],Q=Q[0],K&&re(Z,1)&&!(K=1<=(Ne=re(Z,4))&&11>=Ne)){F.a=3;break e}var cr;if(cr=K)t:{var ar,At,Gr,ai=F,Yr=J,oi=Q,Jt=Ne,Ni=N,ki=ai.m,cn=ai.s,wn=[null],Vn=1,Ki=0,Us=ES[Jt];r:for(;;){if(Ni&&re(ki,1)){var un=re(ki,3)+2,fa=at(Yr,un),Xo=at(oi,un),ic=fa*Xo;if(!_e(fa,Xo,0,ai,wn))break r;for(wn=wn[0],cn.xc=un,ar=0;ar<ic;++ar){var za=wn[ar]>>8&65535;wn[ar]=za,za>=Vn&&(Vn=za+1)}}if(ki.h)break r;for(At=0;5>At;++At){var Tr=Px[At];!At&&0<Jt&&(Tr+=1<<Jt),Ki<Tr&&(Ki=Tr)}var xp=a(Vn*Us,A),zx=Vn,Wx=a(zx,z);if(Wx==null)var fh=null;else t(65536>=zx),fh=Wx;var $u=s(Ki);if(fh==null||$u==null||xp==null){ai.a=1;break r}var dh=xp;for(ar=Gr=0;ar<Vn;++ar){var hs=fh[ar],sc=hs.G,ac=hs.H,Hx=0,hh=1,$x=0;for(At=0;5>At;++At){Tr=Px[At],sc[At]=dh,ac[At]=Gr,!At&&0<Jt&&(Tr+=1<<Jt);i:{var mh,vp=Tr,ph=ai,qu=$u,GS=dh,YS=Gr,yp=0,Wa=ph.m,KS=re(Wa,1);if(i(qu,0,0,vp),KS){var XS=re(Wa,1)+1,JS=re(Wa,1),qx=re(Wa,JS==0?1:8);qu[qx]=1,XS==2&&(qu[qx=re(Wa,8)]=1);var gh=1}else{var Vx=s(19),Gx=re(Wa,4)+4;if(19<Gx){ph.a=3;var xh=0;break i}for(mh=0;mh<Gx;++mh)Vx[NS[mh]]=re(Wa,3);var wp=void 0,Vu=void 0,Yx=ph,QS=Vx,vh=vp,Kx=qu,bp=0,Ha=Yx.m,Xx=8,Jx=a(128,A);n:for(;T(Jx,0,7,QS,19);){if(re(Ha,1)){var ZS=2+2*re(Ha,3);if((wp=2+re(Ha,ZS))>vh)break n}else wp=vh;for(Vu=0;Vu<vh&&wp--;){V(Ha);var Qx=Jx[0+(127&I(Ha))];D(Ha,Ha.u+Qx.g);var oc=Qx.value;if(16>oc)Kx[Vu++]=oc,oc!=0&&(Xx=oc);else{var eN=oc==16,Zx=oc-16,tN=_S[Zx],ev=re(Ha,bS[Zx])+tN;if(Vu+ev>vh)break n;for(var rN=eN?Xx:0;0<ev--;)Kx[Vu++]=rN}}bp=1;break n}bp||(Yx.a=3),gh=bp}(gh=gh&&!Wa.h)&&(yp=T(GS,YS,8,qu,vp)),gh&&yp!=0?xh=yp:(ph.a=3,xh=0)}if(xh==0)break r;if(hh&&SS[At]==1&&(hh=dh[Gr].g==0),Hx+=dh[Gr].g,Gr+=xh,3>=At){var Gu,_p=$u[0];for(Gu=1;Gu<Tr;++Gu)$u[Gu]>_p&&(_p=$u[Gu]);$x+=_p}}if(hs.nd=hh,hs.Qb=0,hh&&(hs.qb=(sc[3][ac[3]+0].value<<24|sc[1][ac[1]+0].value<<16|sc[2][ac[2]+0].value)>>>0,Hx==0&&256>sc[0][ac[0]+0].value&&(hs.Qb=1,hs.qb+=sc[0][ac[0]+0].value<<8)),hs.jc=!hs.Qb&&6>$x,hs.jc){var yh,da=hs;for(yh=0;yh<yn;++yh){var $a=yh,qa=da.pd[$a],wh=da.G[0][da.H[0]+$a];256<=wh.value?(qa.g=wh.g+256,qa.value=wh.value):(qa.g=0,qa.value=0,$a>>=Dr(wh,8,qa),$a>>=Dr(da.G[1][da.H[1]+$a],16,qa),$a>>=Dr(da.G[2][da.H[2]+$a],0,qa),Dr(da.G[3][da.H[3]+$a],24,qa))}}}cn.vc=wn,cn.Wb=Vn,cn.Ya=fh,cn.yc=xp,cr=1;break t}cr=0}if(!(K=cr)){F.a=3;break e}if(0<Ne){if(ie.ua=1<<Ne,!Qe(ie.Wa,Ne)){F.a=1,K=0;break e}}else ie.ua=0;var Sp=F,tv=J,nN=Q,Np=Sp.s,kp=Np.xc;if(Sp.c=tv,Sp.i=nN,Np.md=at(tv,kp),Np.wc=kp==0?-1:(1<<kp)-1,N){F.xb=OS;break e}if((ge=s(J*Q))==null){F.a=1,K=0;break e}K=(K=le(F,ge,0,J,Q,Q,null))&&!Z.h;break e}return K?(W!=null?W[0]=ge:(t(ge==null),t(N)),F.$=0,N||Se(ie)):Se(ie),K}function je(d,x){var N=d.c*d.i,F=N+x+16*x;return t(d.c<=x),d.V=s(F),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+N+x,1)}function Ae(d,x){var N=d.C,F=x-N,W=d.V,K=d.Ba+d.c*N;for(t(x<=d.l.o);0<F;){var J=16<F?16:F,Q=d.l.ma,Z=d.l.width,ie=Z*J,ge=Q.ca,Ne=Q.tb+Z*N,ke=d.Ta,we=d.Ua;X(d,J,W,K),Mr(ke,we,ge,Ne,ie),te(Q,N,N+J,ge,Ne,Z),F-=J,W+=J*d.c,N+=J}t(N==x),d.C=d.Ma=x}function He(){this.ub=this.yd=this.td=this.Rb=0}function Ke(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function st(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ge(){this.Yb=function(){var d=[];return function x(N,F,W){for(var K=W[F],J=0;J<K&&(N.push(W.length>F+1?[]:0),!(W.length<F+1));J++)x(N[J],F+1,W)}(d,0,[3,11]),d}()}function it(){this.jb=s(3),this.Wc=o([4,8],Ge),this.Xc=o([4,17],Ge)}function wt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Kt(){this.ld=this.La=this.dd=this.tc=0}function sr(){this.Na=this.la=0}function qr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function os(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function na(){this.uc=this.M=this.Nb=0,this.wa=Array(new Kt),this.Y=0,this.ya=Array(new os),this.aa=0,this.l=new Is}function Ds(){this.y=s(16),this.f=s(8),this.ea=s(8)}function ls(){this.cb=this.a=0,this.sc="",this.m=new he,this.Od=new He,this.Kc=new Ke,this.ed=new wt,this.Qa=new st,this.Ic=this.$c=this.Aa=0,this.D=new na,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,he),this.ia=0,this.pb=a(4,qr),this.Pa=new it,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ds),this.Hd=0,this.rb=Array(new sr),this.sb=0,this.wa=Array(new Kt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new os),this.L=this.aa=0,this.gd=o([4,2],Kt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Is(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function bi(){var d=new ls;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,Wu||(Wu=Id)),d}function Ir(d,x,N){return d.a==0&&(d.a=x,d.sc=N,d.cb=0),0}function Od(d,x,N){return 3<=N&&d[x+0]==157&&d[x+1]==1&&d[x+2]==42}function Dd(d,x){if(d==null)return 0;if(d.a=0,d.sc="OK",x==null)return Ir(d,2,"null VP8Io passed to VP8GetHeaders()");var N=x.data,F=x.w,W=x.ha;if(4>W)return Ir(d,7,"Truncated header.");var K=N[F+0]|N[F+1]<<8|N[F+2]<<16,J=d.Od;if(J.Rb=!(1&K),J.td=K>>1&7,J.yd=K>>4&1,J.ub=K>>5,3<J.td)return Ir(d,3,"Incorrect keyframe parameters.");if(!J.yd)return Ir(d,4,"Frame not displayable.");F+=3,W-=3;var Q=d.Kc;if(J.Rb){if(7>W)return Ir(d,7,"cannot parse picture header");if(!Od(N,F,W))return Ir(d,3,"Bad code word");Q.c=16383&(N[F+4]<<8|N[F+3]),Q.Td=N[F+4]>>6,Q.i=16383&(N[F+6]<<8|N[F+5]),Q.Ud=N[F+6]>>6,F+=7,W-=7,d.za=Q.c+15>>4,d.Ub=Q.i+15>>4,x.width=Q.c,x.height=Q.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,i((K=d.Pa).jb,0,255,K.jb.length),t((K=d.Qa)!=null),K.Cb=0,K.Bb=0,K.Fb=1,i(K.Zb,0,0,K.Zb.length),i(K.Lb,0,0,K.Lb)}if(J.ub>W)return Ir(d,7,"bad partition length");ne(K=d.m,N,F,J.ub),F+=J.ub,W-=J.ub,J.Rb&&(Q.Ld=fe(K),Q.Kd=fe(K)),Q=d.Qa;var Z,ie=d.Pa;if(t(K!=null),t(Q!=null),Q.Cb=fe(K),Q.Cb){if(Q.Bb=fe(K),fe(K)){for(Q.Fb=fe(K),Z=0;4>Z;++Z)Q.Zb[Z]=fe(K)?G(K,7):0;for(Z=0;4>Z;++Z)Q.Lb[Z]=fe(K)?G(K,6):0}if(Q.Bb)for(Z=0;3>Z;++Z)ie.jb[Z]=fe(K)?U(K,8):255}else Q.Bb=0;if(K.Ka)return Ir(d,3,"cannot parse segment header");if((Q=d.ed).zd=fe(K),Q.Tb=U(K,6),Q.wb=U(K,3),Q.Pc=fe(K),Q.Pc&&fe(K)){for(ie=0;4>ie;++ie)fe(K)&&(Q.vd[ie]=G(K,6));for(ie=0;4>ie;++ie)fe(K)&&(Q.od[ie]=G(K,6))}if(d.L=Q.Tb==0?0:Q.zd?1:2,K.Ka)return Ir(d,3,"cannot parse filter header");var ge=W;if(W=Z=F,F=Z+ge,Q=ge,d.Xb=(1<<U(d.m,2))-1,ge<3*(ie=d.Xb))N=7;else{for(Z+=3*ie,Q-=3*ie,ge=0;ge<ie;++ge){var Ne=N[W+0]|N[W+1]<<8|N[W+2]<<16;Ne>Q&&(Ne=Q),ne(d.Jc[+ge],N,Z,Ne),Z+=Ne,Q-=Ne,W+=3}ne(d.Jc[+ie],N,Z,Q),N=Z<F?0:5}if(N!=0)return Ir(d,N,"cannot parse partitions");for(N=U(Z=d.m,7),W=fe(Z)?G(Z,4):0,F=fe(Z)?G(Z,4):0,Q=fe(Z)?G(Z,4):0,ie=fe(Z)?G(Z,4):0,Z=fe(Z)?G(Z,4):0,ge=d.Qa,Ne=0;4>Ne;++Ne){if(ge.Cb){var ke=ge.Zb[Ne];ge.Fb||(ke+=N)}else{if(0<Ne){d.pb[Ne]=d.pb[0];continue}ke=N}var we=d.pb[Ne];we.Sc[0]=mp[_i(ke+W,127)],we.Sc[1]=pp[_i(ke+0,127)],we.Eb[0]=2*mp[_i(ke+F,127)],we.Eb[1]=101581*pp[_i(ke+Q,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=mp[_i(ke+ie,117)],we.Qc[1]=pp[_i(ke+Z,127)],we.lc=ke+Z}if(!J.Rb)return Ir(d,4,"Not a key frame.");for(fe(K),J=d.Pa,N=0;4>N;++N){for(W=0;8>W;++W)for(F=0;3>F;++F)for(Q=0;11>Q;++Q)ie=de(K,LS[N][W][F][Q])?U(K,8):CS[N][W][F][Q],J.Wc[N][W].Yb[F][Q]=ie;for(W=0;17>W;++W)J.Xc[N][W]=J.Wc[N][FS[W]]}return d.kc=fe(K),d.kc&&(d.Bd=U(K,8)),d.cb=1}function Id(d,x,N,F,W,K,J){var Q=x[W].Yb[N];for(N=0;16>W;++W){if(!de(d,Q[N+0]))return W;for(;!de(d,Q[N+1]);)if(Q=x[++W].Yb[0],N=0,W==16)return 16;var Z=x[W+1].Yb;if(de(d,Q[N+2])){var ie=d,ge=0;if(de(ie,(ke=Q)[(Ne=N)+3]))if(de(ie,ke[Ne+6])){for(Q=0,Ne=2*(ge=de(ie,ke[Ne+8]))+(ke=de(ie,ke[Ne+9+ge])),ge=0,ke=AS[Ne];ke[Q];++Q)ge+=ge+de(ie,ke[Q]);ge+=3+(8<<Ne)}else de(ie,ke[Ne+7])?(ge=7+2*de(ie,165),ge+=de(ie,145)):ge=5+de(ie,159);else ge=de(ie,ke[Ne+4])?3+de(ie,ke[Ne+5]):2;Q=Z[2]}else ge=1,Q=Z[1];Z=J+TS[W],0>(ie=d).b&&se(ie);var Ne,ke=ie.b,we=(Ne=ie.Ca>>1)-(ie.I>>ke)>>31;--ie.b,ie.Ca+=we,ie.Ca|=1,ie.I-=(Ne+1&we)<<ke,K[Z]=((ge^we)-we)*F[(0<W)+0]}return 16}function yu(d){var x=d.rb[d.sb-1];x.la=0,x.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function $m(d,x){if(d==null)return 0;if(x==null)return Ir(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!Dd(d,x))return 0;if(t(d.cb),x.ac==null||x.ac(x)){x.ob&&(d.L=0);var N=uh[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=x.v-N>>4,d.zb=x.j-N>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=x.o+15+N>>4,d.Hb=x.va+15+N>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var F=d.ed;for(N=0;4>N;++N){var W;if(d.Qa.Cb){var K=d.Qa.Lb[N];d.Qa.Fb||(K+=F.Tb)}else K=F.Tb;for(W=0;1>=W;++W){var J=d.gd[N][W],Q=K;if(F.Pc&&(Q+=F.vd[0],W&&(Q+=F.od[0])),0<(Q=0>Q?0:63<Q?63:Q)){var Z=Q;0<F.wb&&(Z=4<F.wb?Z>>2:Z>>1)>9-F.wb&&(Z=9-F.wb),1>Z&&(Z=1),J.dd=Z,J.tc=2*Q+Z,J.ld=40<=Q?2:15<=Q?1:0}else J.tc=0;J.La=W}}}N=0}else Ir(d,6,"Frame setup failed"),N=d.a;if(N=N==0){if(N){d.$c=0,0<d.Aa||(d.Ic=VS);e:{N=d.Ic,F=4*(Z=d.za);var ie=32*Z,ge=Z+1,Ne=0<d.L?Z*(0<d.Aa?2:1):0,ke=(d.Aa==2?2:1)*Z;if((J=F+832+(W=3*(16*N+uh[d.L])/2*ie)+(K=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=J)N=0;else{if(J>d.Vb){if(d.Vb=0,d.Ec=s(J),d.Fc=0,d.Ec==null){N=Ir(d,1,"no memory during frame initialization.");break e}d.Vb=J}J=d.Ec,Q=d.Fc,d.Ac=J,d.Bc=Q,Q+=F,d.Gd=a(ie,Ds),d.Hd=0,d.rb=a(ge+1,sr),d.sb=1,d.wa=Ne?a(Ne,Kt):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=Z),t(!0),d.oc=J,d.pc=Q,Q+=832,d.ya=a(ke,os),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=Z),d.R=16*Z,d.B=8*Z,Z=(ie=uh[d.L])*d.R,ie=ie/2*d.B,d.sa=J,d.ta=Q+Z,d.qa=d.sa,d.ra=d.ta+16*N*d.R+ie,d.Ha=d.qa,d.Ia=d.ra+8*N*d.B+ie,d.$c=0,Q+=W,d.mb=K?J:null,d.nb=K?Q:null,t(Q+K<=d.Fc+d.Vb),yu(d),i(d.Ac,d.Bc,0,F),N=1}}if(N){if(x.ka=0,x.y=d.sa,x.O=d.ta,x.f=d.qa,x.N=d.ra,x.ea=d.Ha,x.Vd=d.Ia,x.fa=d.R,x.Rc=d.B,x.F=null,x.J=0,!th){for(N=-255;255>=N;++N)rn[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)ca[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)zu[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)nc[255+N]=0>N?0:255<N?255:N;th=1}ec=Gm,la=qm,Mu=Md,qn=Vm,$i=Bd,Rr=Rd,tc=ku,eh=Ho,Bu=ap,Vo=Eu,Go=sp,Ra=ql,Yo=ju,rc=Yd,Ko=Gd,Ma=Ms,Uu=sa,qi=ip,ds[0]=Rs,ds[1]=Ym,ds[2]=Qm,ds[3]=Zm,ds[4]=Wd,ds[5]=Hl,ds[6]=Hd,ds[7]=_u,ds[8]=tp,ds[9]=ep,Ba[0]=Ud,Ba[1]=Xm,Ba[2]=ia,Ba[3]=zl,Ba[4]=Pn,Ba[5]=Jm,Ba[6]=zd,ua[0]=La,ua[1]=Km,ua[2]=rp,ua[3]=Su,ua[4]=Wo,ua[5]=np,ua[6]=Nu,N=1}else N=0}N&&(N=function(we,Re){for(we.M=0;we.M<we.Va;++we.M){var Pe,xe=we.Jc[we.M&we.Xb],ye=we.m,De=we;for(Pe=0;Pe<De.za;++Pe){var Ue=ye,Ie=De,lt=Ie.Ac,et=Ie.Bc+4*Pe,gt=Ie.zc,rt=Ie.ya[Ie.aa+Pe];if(Ie.Qa.Bb?rt.$b=de(Ue,Ie.Pa.jb[0])?2+de(Ue,Ie.Pa.jb[2]):de(Ue,Ie.Pa.jb[1]):rt.$b=0,Ie.kc&&(rt.Ad=de(Ue,Ie.Bd)),rt.Za=!de(Ue,145)+0,rt.Za){var qt=rt.Ob,Xt=0;for(Ie=0;4>Ie;++Ie){var zt,Dt=gt[0+Ie];for(zt=0;4>zt;++zt){Dt=PS[lt[et+zt]][Dt];for(var cr=Lx[de(Ue,Dt[0])];0<cr;)cr=Lx[2*cr+de(Ue,Dt[cr])];Dt=-cr,lt[et+zt]=Dt}n(qt,Xt,lt,et,4),Xt+=4,gt[0+Ie]=Dt}}else Dt=de(Ue,156)?de(Ue,128)?1:3:de(Ue,163)?2:0,rt.Ob[0]=Dt,i(lt,et,Dt,4),i(gt,0,Dt,4);rt.Dd=de(Ue,142)?de(Ue,114)?de(Ue,183)?1:3:2:0}if(De.m.Ka)return Ir(we,7,"Premature end-of-partition0 encountered.");for(;we.ja<we.za;++we.ja){if(De=xe,Ue=(ye=we).rb[ye.sb-1],lt=ye.rb[ye.sb+ye.ja],Pe=ye.ya[ye.aa+ye.ja],et=ye.kc?Pe.Ad:0)Ue.la=lt.la=0,Pe.Za||(Ue.Na=lt.Na=0),Pe.Hc=0,Pe.Gc=0,Pe.ia=0;else{var ar,At;if(Ue=lt,lt=De,et=ye.Pa.Xc,gt=ye.ya[ye.aa+ye.ja],rt=ye.pb[gt.$b],Ie=gt.ad,qt=0,Xt=ye.rb[ye.sb-1],Dt=zt=0,i(Ie,qt,0,384),gt.Za)var Gr=0,ai=et[3];else{cr=s(16);var Yr=Ue.Na+Xt.Na;if(Yr=Wu(lt,et[1],Yr,rt.Eb,0,cr,0),Ue.Na=Xt.Na=(0<Yr)+0,1<Yr)ec(cr,0,Ie,qt);else{var oi=cr[0]+3>>3;for(cr=0;256>cr;cr+=16)Ie[qt+cr]=oi}Gr=1,ai=et[0]}var Jt=15&Ue.la,Ni=15&Xt.la;for(cr=0;4>cr;++cr){var ki=1&Ni;for(oi=At=0;4>oi;++oi)Jt=Jt>>1|(ki=(Yr=Wu(lt,ai,Yr=ki+(1&Jt),rt.Sc,Gr,Ie,qt))>Gr)<<7,At=At<<2|(3<Yr?3:1<Yr?2:Ie[qt+0]!=0),qt+=16;Jt>>=4,Ni=Ni>>1|ki<<7,zt=(zt<<8|At)>>>0}for(ai=Jt,Gr=Ni>>4,ar=0;4>ar;ar+=2){for(At=0,Jt=Ue.la>>4+ar,Ni=Xt.la>>4+ar,cr=0;2>cr;++cr){for(ki=1&Ni,oi=0;2>oi;++oi)Yr=ki+(1&Jt),Jt=Jt>>1|(ki=0<(Yr=Wu(lt,et[2],Yr,rt.Qc,0,Ie,qt)))<<3,At=At<<2|(3<Yr?3:1<Yr?2:Ie[qt+0]!=0),qt+=16;Jt>>=2,Ni=Ni>>1|ki<<5}Dt|=At<<4*ar,ai|=Jt<<4<<ar,Gr|=(240&Ni)<<ar}Ue.la=ai,Xt.la=Gr,gt.Hc=zt,gt.Gc=Dt,gt.ia=43690&Dt?0:rt.ia,et=!(zt|Dt)}if(0<ye.L&&(ye.wa[ye.Y+ye.ja]=ye.gd[Pe.$b][Pe.Za],ye.wa[ye.Y+ye.ja].La|=!et),De.Ka)return Ir(we,7,"Premature end-of-file encountered.")}if(yu(we),ye=Re,De=1,Pe=(xe=we).D,Ue=0<xe.L&&xe.M>=xe.zb&&xe.M<=xe.Va,xe.Aa==0)e:{if(Pe.M=xe.M,Pe.uc=Ue,Fu(xe,Pe),De=1,Pe=(At=xe.D).Nb,Ue=(Dt=uh[xe.L])*xe.R,lt=Dt/2*xe.B,cr=16*Pe*xe.R,oi=8*Pe*xe.B,et=xe.sa,gt=xe.ta-Ue+cr,rt=xe.qa,Ie=xe.ra-lt+oi,qt=xe.Ha,Xt=xe.Ia-lt+oi,Ni=(Jt=At.M)==0,zt=Jt>=xe.Va-1,xe.Aa==2&&Fu(xe,At),At.uc)for(ki=(Yr=xe).D.M,t(Yr.D.uc),At=Yr.yb;At<Yr.Hb;++At){Gr=At,ai=ki;var cn=(wn=(Tr=Yr).D).Nb;ar=Tr.R;var wn=wn.wa[wn.Y+Gr],Vn=Tr.sa,Ki=Tr.ta+16*cn*ar+16*Gr,Us=wn.dd,un=wn.tc;if(un!=0)if(t(3<=un),Tr.L==1)0<Gr&&Ma(Vn,Ki,ar,un+4),wn.La&&qi(Vn,Ki,ar,un),0<ai&&Ko(Vn,Ki,ar,un+4),wn.La&&Uu(Vn,Ki,ar,un);else{var fa=Tr.B,Xo=Tr.qa,ic=Tr.ra+8*cn*fa+8*Gr,za=Tr.Ha,Tr=Tr.Ia+8*cn*fa+8*Gr;cn=wn.ld,0<Gr&&(eh(Vn,Ki,ar,un+4,Us,cn),Vo(Xo,ic,za,Tr,fa,un+4,Us,cn)),wn.La&&(Ra(Vn,Ki,ar,un,Us,cn),rc(Xo,ic,za,Tr,fa,un,Us,cn)),0<ai&&(tc(Vn,Ki,ar,un+4,Us,cn),Bu(Xo,ic,za,Tr,fa,un+4,Us,cn)),wn.La&&(Go(Vn,Ki,ar,un,Us,cn),Yo(Xo,ic,za,Tr,fa,un,Us,cn))}}if(xe.ia&&alert("todo:DitherRow"),ye.put!=null){if(At=16*Jt,Jt=16*(Jt+1),Ni?(ye.y=xe.sa,ye.O=xe.ta+cr,ye.f=xe.qa,ye.N=xe.ra+oi,ye.ea=xe.Ha,ye.W=xe.Ia+oi):(At-=Dt,ye.y=et,ye.O=gt,ye.f=rt,ye.N=Ie,ye.ea=qt,ye.W=Xt),zt||(Jt-=Dt),Jt>ye.o&&(Jt=ye.o),ye.F=null,ye.J=null,xe.Fa!=null&&0<xe.Fa.length&&At<Jt&&(ye.J=Pu(xe,ye,At,Jt-At),ye.F=xe.mb,ye.F==null&&ye.F.length==0)){De=Ir(xe,3,"Could not decode alpha data.");break e}At<ye.j&&(Dt=ye.j-At,At=ye.j,t(!(1&Dt)),ye.O+=xe.R*Dt,ye.N+=xe.B*(Dt>>1),ye.W+=xe.B*(Dt>>1),ye.F!=null&&(ye.J+=ye.width*Dt)),At<Jt&&(ye.O+=ye.v,ye.N+=ye.v>>1,ye.W+=ye.v>>1,ye.F!=null&&(ye.J+=ye.v),ye.ka=At-ye.j,ye.U=ye.va-ye.v,ye.T=Jt-At,De=ye.put(ye))}Pe+1!=xe.Ic||zt||(n(xe.sa,xe.ta-Ue,et,gt+16*xe.R,Ue),n(xe.qa,xe.ra-lt,rt,Ie+8*xe.B,lt),n(xe.Ha,xe.Ia-lt,qt,Xt+8*xe.B,lt))}if(!De)return Ir(we,6,"Output aborted.")}return 1}(d,x)),x.bc!=null&&x.bc(x),N&=1}return N?(d.cb=0,N):0}function cs(d,x,N,F,W){W=d[x+N+32*F]+(W>>3),d[x+N+32*F]=-256&W?0>W?0:255:W}function Ul(d,x,N,F,W,K){cs(d,x,0,N,F+W),cs(d,x,1,N,F+K),cs(d,x,2,N,F-K),cs(d,x,3,N,F-W)}function ni(d){return(20091*d>>16)+d}function wu(d,x,N,F){var W,K=0,J=s(16);for(W=0;4>W;++W){var Q=d[x+0]+d[x+8],Z=d[x+0]-d[x+8],ie=(35468*d[x+4]>>16)-ni(d[x+12]),ge=ni(d[x+4])+(35468*d[x+12]>>16);J[K+0]=Q+ge,J[K+1]=Z+ie,J[K+2]=Z-ie,J[K+3]=Q-ge,K+=4,x++}for(W=K=0;4>W;++W)Q=(d=J[K+0]+4)+J[K+8],Z=d-J[K+8],ie=(35468*J[K+4]>>16)-ni(J[K+12]),cs(N,F,0,0,Q+(ge=ni(J[K+4])+(35468*J[K+12]>>16))),cs(N,F,1,0,Z+ie),cs(N,F,2,0,Z-ie),cs(N,F,3,0,Q-ge),K++,F+=32}function Rd(d,x,N,F){var W=d[x+0]+4,K=35468*d[x+4]>>16,J=ni(d[x+4]),Q=35468*d[x+1]>>16;Ul(N,F,0,W+J,d=ni(d[x+1]),Q),Ul(N,F,1,W+K,d,Q),Ul(N,F,2,W-K,d,Q),Ul(N,F,3,W-J,d,Q)}function qm(d,x,N,F,W){wu(d,x,N,F),W&&wu(d,x+16,N,F+4)}function Md(d,x,N,F){la(d,x+0,N,F,1),la(d,x+32,N,F+128,1)}function Vm(d,x,N,F){var W;for(d=d[x+0]+4,W=0;4>W;++W)for(x=0;4>x;++x)cs(N,F,x,W,d)}function Bd(d,x,N,F){d[x+0]&&qn(d,x+0,N,F),d[x+16]&&qn(d,x+16,N,F+4),d[x+32]&&qn(d,x+32,N,F+128),d[x+48]&&qn(d,x+48,N,F+128+4)}function Gm(d,x,N,F){var W,K=s(16);for(W=0;4>W;++W){var J=d[x+0+W]+d[x+12+W],Q=d[x+4+W]+d[x+8+W],Z=d[x+4+W]-d[x+8+W],ie=d[x+0+W]-d[x+12+W];K[0+W]=J+Q,K[8+W]=J-Q,K[4+W]=ie+Z,K[12+W]=ie-Z}for(W=0;4>W;++W)J=(d=K[0+4*W]+3)+K[3+4*W],Q=K[1+4*W]+K[2+4*W],Z=K[1+4*W]-K[2+4*W],ie=d-K[3+4*W],N[F+0]=J+Q>>3,N[F+16]=ie+Z>>3,N[F+32]=J-Q>>3,N[F+48]=ie-Z>>3,F+=64}function bu(d,x,N){var F,W=x-32,K=Si,J=255-d[W-1];for(F=0;F<N;++F){var Q,Z=K,ie=J+d[x-1];for(Q=0;Q<N;++Q)d[x+Q]=Z[ie+d[W+Q]];x+=32}}function Ym(d,x){bu(d,x,4)}function Km(d,x){bu(d,x,8)}function Xm(d,x){bu(d,x,16)}function ia(d,x){var N;for(N=0;16>N;++N)n(d,x+32*N,d,x-32,16)}function zl(d,x){var N;for(N=16;0<N;--N)i(d,x,d[x-1],16),x+=32}function Wl(d,x,N){var F;for(F=0;16>F;++F)i(x,N+32*F,d,16)}function Ud(d,x){var N,F=16;for(N=0;16>N;++N)F+=d[x-1+32*N]+d[x+N-32];Wl(F>>5,d,x)}function Pn(d,x){var N,F=8;for(N=0;16>N;++N)F+=d[x-1+32*N];Wl(F>>4,d,x)}function Jm(d,x){var N,F=8;for(N=0;16>N;++N)F+=d[x+N-32];Wl(F>>4,d,x)}function zd(d,x){Wl(128,d,x)}function St(d,x,N){return d+2*x+N+2>>2}function Qm(d,x){var N,F=x-32;for(F=new Uint8Array([St(d[F-1],d[F+0],d[F+1]),St(d[F+0],d[F+1],d[F+2]),St(d[F+1],d[F+2],d[F+3]),St(d[F+2],d[F+3],d[F+4])]),N=0;4>N;++N)n(d,x+32*N,F,0,F.length)}function Zm(d,x){var N=d[x-1],F=d[x-1+32],W=d[x-1+64],K=d[x-1+96];ve(d,x+0,16843009*St(d[x-1-32],N,F)),ve(d,x+32,16843009*St(N,F,W)),ve(d,x+64,16843009*St(F,W,K)),ve(d,x+96,16843009*St(W,K,K))}function Rs(d,x){var N,F=4;for(N=0;4>N;++N)F+=d[x+N-32]+d[x-1+32*N];for(F>>=3,N=0;4>N;++N)i(d,x+32*N,F,4)}function Wd(d,x){var N=d[x-1+0],F=d[x-1+32],W=d[x-1+64],K=d[x-1-32],J=d[x+0-32],Q=d[x+1-32],Z=d[x+2-32],ie=d[x+3-32];d[x+0+96]=St(F,W,d[x-1+96]),d[x+1+96]=d[x+0+64]=St(N,F,W),d[x+2+96]=d[x+1+64]=d[x+0+32]=St(K,N,F),d[x+3+96]=d[x+2+64]=d[x+1+32]=d[x+0+0]=St(J,K,N),d[x+3+64]=d[x+2+32]=d[x+1+0]=St(Q,J,K),d[x+3+32]=d[x+2+0]=St(Z,Q,J),d[x+3+0]=St(ie,Z,Q)}function Hd(d,x){var N=d[x+1-32],F=d[x+2-32],W=d[x+3-32],K=d[x+4-32],J=d[x+5-32],Q=d[x+6-32],Z=d[x+7-32];d[x+0+0]=St(d[x+0-32],N,F),d[x+1+0]=d[x+0+32]=St(N,F,W),d[x+2+0]=d[x+1+32]=d[x+0+64]=St(F,W,K),d[x+3+0]=d[x+2+32]=d[x+1+64]=d[x+0+96]=St(W,K,J),d[x+3+32]=d[x+2+64]=d[x+1+96]=St(K,J,Q),d[x+3+64]=d[x+2+96]=St(J,Q,Z),d[x+3+96]=St(Q,Z,Z)}function Hl(d,x){var N=d[x-1+0],F=d[x-1+32],W=d[x-1+64],K=d[x-1-32],J=d[x+0-32],Q=d[x+1-32],Z=d[x+2-32],ie=d[x+3-32];d[x+0+0]=d[x+1+64]=K+J+1>>1,d[x+1+0]=d[x+2+64]=J+Q+1>>1,d[x+2+0]=d[x+3+64]=Q+Z+1>>1,d[x+3+0]=Z+ie+1>>1,d[x+0+96]=St(W,F,N),d[x+0+64]=St(F,N,K),d[x+0+32]=d[x+1+96]=St(N,K,J),d[x+1+32]=d[x+2+96]=St(K,J,Q),d[x+2+32]=d[x+3+96]=St(J,Q,Z),d[x+3+32]=St(Q,Z,ie)}function _u(d,x){var N=d[x+0-32],F=d[x+1-32],W=d[x+2-32],K=d[x+3-32],J=d[x+4-32],Q=d[x+5-32],Z=d[x+6-32],ie=d[x+7-32];d[x+0+0]=N+F+1>>1,d[x+1+0]=d[x+0+64]=F+W+1>>1,d[x+2+0]=d[x+1+64]=W+K+1>>1,d[x+3+0]=d[x+2+64]=K+J+1>>1,d[x+0+32]=St(N,F,W),d[x+1+32]=d[x+0+96]=St(F,W,K),d[x+2+32]=d[x+1+96]=St(W,K,J),d[x+3+32]=d[x+2+96]=St(K,J,Q),d[x+3+64]=St(J,Q,Z),d[x+3+96]=St(Q,Z,ie)}function ep(d,x){var N=d[x-1+0],F=d[x-1+32],W=d[x-1+64],K=d[x-1+96];d[x+0+0]=N+F+1>>1,d[x+2+0]=d[x+0+32]=F+W+1>>1,d[x+2+32]=d[x+0+64]=W+K+1>>1,d[x+1+0]=St(N,F,W),d[x+3+0]=d[x+1+32]=St(F,W,K),d[x+3+32]=d[x+1+64]=St(W,K,K),d[x+3+64]=d[x+2+64]=d[x+0+96]=d[x+1+96]=d[x+2+96]=d[x+3+96]=K}function tp(d,x){var N=d[x-1+0],F=d[x-1+32],W=d[x-1+64],K=d[x-1+96],J=d[x-1-32],Q=d[x+0-32],Z=d[x+1-32],ie=d[x+2-32];d[x+0+0]=d[x+2+32]=N+J+1>>1,d[x+0+32]=d[x+2+64]=F+N+1>>1,d[x+0+64]=d[x+2+96]=W+F+1>>1,d[x+0+96]=K+W+1>>1,d[x+3+0]=St(Q,Z,ie),d[x+2+0]=St(J,Q,Z),d[x+1+0]=d[x+3+32]=St(N,J,Q),d[x+1+32]=d[x+3+64]=St(F,N,J),d[x+1+64]=d[x+3+96]=St(W,F,N),d[x+1+96]=St(K,W,F)}function rp(d,x){var N;for(N=0;8>N;++N)n(d,x+32*N,d,x-32,8)}function Su(d,x){var N;for(N=0;8>N;++N)i(d,x,d[x-1],8),x+=32}function zo(d,x,N){var F;for(F=0;8>F;++F)i(x,N+32*F,d,8)}function La(d,x){var N,F=8;for(N=0;8>N;++N)F+=d[x+N-32]+d[x-1+32*N];zo(F>>4,d,x)}function np(d,x){var N,F=4;for(N=0;8>N;++N)F+=d[x+N-32];zo(F>>3,d,x)}function Wo(d,x){var N,F=4;for(N=0;8>N;++N)F+=d[x-1+32*N];zo(F>>3,d,x)}function Nu(d,x){zo(128,d,x)}function $l(d,x,N){var F=d[x-N],W=d[x+0],K=3*(W-F)+cp[1020+d[x-2*N]-d[x+N]],J=rh[112+(K+4>>3)];d[x-N]=Si[255+F+rh[112+(K+3>>3)]],d[x+0]=Si[255+W-J]}function $d(d,x,N,F){var W=d[x+0],K=d[x+N];return Gi[255+d[x-2*N]-d[x-N]]>F||Gi[255+K-W]>F}function qd(d,x,N,F){return 4*Gi[255+d[x-N]-d[x+0]]+Gi[255+d[x-2*N]-d[x+N]]<=F}function Vd(d,x,N,F,W){var K=d[x-3*N],J=d[x-2*N],Q=d[x-N],Z=d[x+0],ie=d[x+N],ge=d[x+2*N],Ne=d[x+3*N];return 4*Gi[255+Q-Z]+Gi[255+J-ie]>F?0:Gi[255+d[x-4*N]-K]<=W&&Gi[255+K-J]<=W&&Gi[255+J-Q]<=W&&Gi[255+Ne-ge]<=W&&Gi[255+ge-ie]<=W&&Gi[255+ie-Z]<=W}function Gd(d,x,N,F){var W=2*F+1;for(F=0;16>F;++F)qd(d,x+F,N,W)&&$l(d,x+F,N)}function Ms(d,x,N,F){var W=2*F+1;for(F=0;16>F;++F)qd(d,x+F*N,1,W)&&$l(d,x+F*N,1)}function sa(d,x,N,F){var W;for(W=3;0<W;--W)Gd(d,x+=4*N,N,F)}function ip(d,x,N,F){var W;for(W=3;0<W;--W)Ms(d,x+=4,N,F)}function Fa(d,x,N,F,W,K,J,Q){for(K=2*K+1;0<W--;){if(Vd(d,x,N,K,J))if($d(d,x,N,Q))$l(d,x,N);else{var Z=d,ie=x,ge=N,Ne=Z[ie-2*ge],ke=Z[ie-ge],we=Z[ie+0],Re=Z[ie+ge],Pe=Z[ie+2*ge],xe=27*(De=cp[1020+3*(we-ke)+cp[1020+Ne-Re]])+63>>7,ye=18*De+63>>7,De=9*De+63>>7;Z[ie-3*ge]=Si[255+Z[ie-3*ge]+De],Z[ie-2*ge]=Si[255+Ne+ye],Z[ie-ge]=Si[255+ke+xe],Z[ie+0]=Si[255+we-xe],Z[ie+ge]=Si[255+Re-ye],Z[ie+2*ge]=Si[255+Pe-De]}x+=F}}function us(d,x,N,F,W,K,J,Q){for(K=2*K+1;0<W--;){if(Vd(d,x,N,K,J))if($d(d,x,N,Q))$l(d,x,N);else{var Z=d,ie=x,ge=N,Ne=Z[ie-ge],ke=Z[ie+0],we=Z[ie+ge],Re=rh[112+((Pe=3*(ke-Ne))+4>>3)],Pe=rh[112+(Pe+3>>3)],xe=Re+1>>1;Z[ie-2*ge]=Si[255+Z[ie-2*ge]+xe],Z[ie-ge]=Si[255+Ne+Pe],Z[ie+0]=Si[255+ke-Re],Z[ie+ge]=Si[255+we-xe]}x+=F}}function ku(d,x,N,F,W,K){Fa(d,x,N,1,16,F,W,K)}function Ho(d,x,N,F,W,K){Fa(d,x,1,N,16,F,W,K)}function sp(d,x,N,F,W,K){var J;for(J=3;0<J;--J)us(d,x+=4*N,N,1,16,F,W,K)}function ql(d,x,N,F,W,K){var J;for(J=3;0<J;--J)us(d,x+=4,1,N,16,F,W,K)}function ap(d,x,N,F,W,K,J,Q){Fa(d,x,W,1,8,K,J,Q),Fa(N,F,W,1,8,K,J,Q)}function Eu(d,x,N,F,W,K,J,Q){Fa(d,x,1,W,8,K,J,Q),Fa(N,F,1,W,8,K,J,Q)}function ju(d,x,N,F,W,K,J,Q){us(d,x+4*W,W,1,8,K,J,Q),us(N,F+4*W,W,1,8,K,J,Q)}function Yd(d,x,N,F,W,K,J,Q){us(d,x+4,1,W,8,K,J,Q),us(N,F+4,1,W,8,K,J,Q)}function Vl(){this.ba=new yi,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new lr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Au(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Tu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Kd(){this.ua=0,this.Wa=new ue,this.vb=new ue,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new A}function op(){this.xb=this.a=0,this.l=new Is,this.ca=new yi,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Kd,this.ab=0,this.gc=a(4,Tu),this.Oc=0}function Gl(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Is,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function $o(d,x,N,F,W,K,J){for(d=d==null?0:d[x+0],x=0;x<J;++x)W[K+x]=d+N[F+x]&255,d=W[K+x]}function Cu(d,x,N,F,W,K,J){var Q;if(d==null)$o(null,null,N,F,W,K,J);else for(Q=0;Q<J;++Q)W[K+Q]=d[x+Q]+N[F+Q]&255}function Oa(d,x,N,F,W,K,J){if(d==null)$o(null,null,N,F,W,K,J);else{var Q,Z=d[x+0],ie=Z,ge=Z;for(Q=0;Q<J;++Q)ie=ge+(Z=d[x+Q])-ie,ge=N[F+Q]+(-256&ie?0>ie?0:255:ie)&255,ie=Z,W[K+Q]=ge}}function Pu(d,x,N,F){var W=x.width,K=x.o;if(t(d!=null&&x!=null),0>N||0>=F||N+F>K)return null;if(!d.Cc){if(d.ga==null){var J;if(d.ga=new Gl,(J=d.ga==null)||(J=x.width*x.o,t(d.Gb.length==0),d.Gb=s(J),d.Uc=0,d.Gb==null?J=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,J=1),J=!J),!J){J=d.ga;var Q=d.Fa,Z=d.P,ie=d.qc,ge=d.mb,Ne=d.nb,ke=Z+1,we=ie-1,Re=J.l;if(t(Q!=null&&ge!=null&&x!=null),Ua[0]=null,Ua[1]=$o,Ua[2]=Cu,Ua[3]=Oa,J.ca=ge,J.tb=Ne,J.c=x.width,J.i=x.height,t(0<J.c&&0<J.i),1>=ie)x=0;else if(J.$a=Q[Z+0]>>0&3,J.Z=Q[Z+0]>>2&3,J.Lc=Q[Z+0]>>4&3,Z=Q[Z+0]>>6&3,0>J.$a||1<J.$a||4<=J.Z||1<J.Lc||Z)x=0;else if(Re.put=zi,Re.ac=tn,Re.bc=Wi,Re.ma=J,Re.width=x.width,Re.height=x.height,Re.Da=x.Da,Re.v=x.v,Re.va=x.va,Re.j=x.j,Re.o=x.o,J.$a)e:{t(J.$a==1),x=Ce();t:for(;;){if(x==null){x=0;break e}if(t(J!=null),J.mc=x,x.c=J.c,x.i=J.i,x.l=J.l,x.l.ma=J,x.l.width=J.c,x.l.height=J.i,x.a=0,B(x.m,Q,ke,we),!_e(J.c,J.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&ee(x.s)?(J.ic=1,Q=x.c*x.i,x.Ta=null,x.Ua=0,x.V=s(Q),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(J.ic=0,x=je(x,J.c)),!x))break t;x=1;break e}J.mc=null,x=0}else x=we>=J.c*J.i;J=!x}if(J)return null;d.ga.Lc!=1?d.Ga=0:F=K-N}t(d.ga!=null),t(N+F<=K);e:{if(x=(Q=d.ga).c,K=Q.l.o,Q.$a==0){if(ke=d.rc,we=d.Vc,Re=d.Fa,Z=d.P+1+N*x,ie=d.mb,ge=d.nb+N*x,t(Z<=d.P+d.qc),Q.Z!=0)for(t(Ua[Q.Z]!=null),J=0;J<F;++J)Ua[Q.Z](ke,we,Re,Z,ie,ge,x),ke=ie,we=ge,ge+=x,Z+=x;else for(J=0;J<F;++J)n(ie,ge,Re,Z,x),ke=ie,we=ge,ge+=x,Z+=x;d.rc=ke,d.Vc=we}else{if(t(Q.mc!=null),x=N+F,t((J=Q.mc)!=null),t(x<=J.i),J.C>=x)x=1;else if(Q.ic||be(),Q.ic){Q=J.V,ke=J.Ba,we=J.c;var Pe=J.i,xe=(Re=1,Z=J.$/we,ie=J.$%we,ge=J.m,Ne=J.s,J.$),ye=we*Pe,De=we*x,Ue=Ne.wc,Ie=xe<De?jr(Ne,ie,Z):null;t(xe<=ye),t(x<=Pe),t(ee(Ne));t:for(;;){for(;!ge.h&&xe<De;){if(ie&Ue||(Ie=jr(Ne,ie,Z)),t(Ie!=null),V(ge),256>(Pe=Cn(Ie.G[0],Ie.H[0],ge)))Q[ke+xe]=Pe,++xe,++ie>=we&&(ie=0,++Z<=x&&!(Z%16)&&ae(J,Z));else{if(!(280>Pe)){Re=0;break t}Pe=wi(Pe-256,ge);var lt,et=Cn(Ie.G[4],Ie.H[4],ge);if(V(ge),!(xe>=(et=ri(we,et=wi(et,ge)))&&ye-xe>=Pe)){Re=0;break t}for(lt=0;lt<Pe;++lt)Q[ke+xe+lt]=Q[ke+xe+lt-et];for(xe+=Pe,ie+=Pe;ie>=we;)ie-=we,++Z<=x&&!(Z%16)&&ae(J,Z);xe<De&&ie&Ue&&(Ie=jr(Ne,ie,Z))}t(ge.h==M(ge))}ae(J,Z>x?x:Z);break t}!Re||ge.h&&xe<ye?(Re=0,J.a=ge.h?5:3):J.$=xe,x=Re}else x=le(J,J.V,J.Ba,J.c,J.i,x,Ae);if(!x){F=0;break e}}N+F>=K&&(d.Cc=1),F=1}if(!F)return null;if(d.Cc&&((F=d.ga)!=null&&(F.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+N*W}function S(d,x,N,F,W,K){for(;0<W--;){var J,Q=d,Z=x+(N?1:0),ie=d,ge=x+(N?0:3);for(J=0;J<F;++J){var Ne=ie[ge+4*J];Ne!=255&&(Ne*=32897,Q[Z+4*J+0]=Q[Z+4*J+0]*Ne>>23,Q[Z+4*J+1]=Q[Z+4*J+1]*Ne>>23,Q[Z+4*J+2]=Q[Z+4*J+2]*Ne>>23)}x+=K}}function H(d,x,N,F,W){for(;0<F--;){var K;for(K=0;K<N;++K){var J=d[x+2*K+0],Q=15&(ie=d[x+2*K+1]),Z=4369*Q,ie=(240&ie|ie>>4)*Z>>16;d[x+2*K+0]=(240&J|J>>4)*Z>>16&240|(15&J|J<<4)*Z>>16>>4&15,d[x+2*K+1]=240&ie|Q}x+=W}}function ce(d,x,N,F,W,K,J,Q){var Z,ie,ge=255;for(ie=0;ie<W;++ie){for(Z=0;Z<F;++Z){var Ne=d[x+Z];K[J+4*Z]=Ne,ge&=Ne}x+=N,J+=Q}return ge!=255}function pe(d,x,N,F,W){var K;for(K=0;K<W;++K)N[F+K]=d[x+K]>>8}function be(){Vi=S,dr=H,hr=ce,Mr=pe}function Le(d,x,N){C[d]=function(F,W,K,J,Q,Z,ie,ge,Ne,ke,we,Re,Pe,xe,ye,De,Ue){var Ie,lt=Ue-1>>1,et=Q[Z+0]|ie[ge+0]<<16,gt=Ne[ke+0]|we[Re+0]<<16;t(F!=null);var rt=3*et+gt+131074>>2;for(x(F[W+0],255&rt,rt>>16,Pe,xe),K!=null&&(rt=3*gt+et+131074>>2,x(K[J+0],255&rt,rt>>16,ye,De)),Ie=1;Ie<=lt;++Ie){var qt=Q[Z+Ie]|ie[ge+Ie]<<16,Xt=Ne[ke+Ie]|we[Re+Ie]<<16,zt=et+qt+gt+Xt+524296,Dt=zt+2*(qt+gt)>>3;rt=Dt+et>>1,et=(zt=zt+2*(et+Xt)>>3)+qt>>1,x(F[W+2*Ie-1],255&rt,rt>>16,Pe,xe+(2*Ie-1)*N),x(F[W+2*Ie-0],255&et,et>>16,Pe,xe+(2*Ie-0)*N),K!=null&&(rt=zt+gt>>1,et=Dt+Xt>>1,x(K[J+2*Ie-1],255&rt,rt>>16,ye,De+(2*Ie-1)*N),x(K[J+2*Ie+0],255&et,et>>16,ye,De+(2*Ie+0)*N)),et=qt,gt=Xt}1&Ue||(rt=3*et+gt+131074>>2,x(F[W+Ue-1],255&rt,rt>>16,Pe,xe+(Ue-1)*N),K!=null&&(rt=3*gt+et+131074>>2,x(K[J+Ue-1],255&rt,rt>>16,ye,De+(Ue-1)*N)))}}function We(){Yi[nh]=DS,Yi[ih]=Ox,Yi[Tx]=IS,Yi[sh]=Dx,Yi[ah]=Ix,Yi[up]=Rx,Yi[Cx]=RS,Yi[fp]=Ox,Yi[dp]=Dx,Yi[oh]=Ix,Yi[hp]=Rx}function ot(d){return d&-16384?0>d?0:255:d>>MS}function ht(d,x){return ot((19077*d>>8)+(26149*x>>8)-14234)}function Et(d,x,N){return ot((19077*d>>8)-(6419*x>>8)-(13320*N>>8)+8708)}function Nt(d,x){return ot((19077*d>>8)+(33050*x>>8)-17685)}function Bt(d,x,N,F,W){F[W+0]=ht(d,N),F[W+1]=Et(d,x,N),F[W+2]=Nt(d,x)}function Sr(d,x,N,F,W){F[W+0]=Nt(d,x),F[W+1]=Et(d,x,N),F[W+2]=ht(d,N)}function Ar(d,x,N,F,W){var K=Et(d,x,N);x=K<<3&224|Nt(d,x)>>3,F[W+0]=248&ht(d,N)|K>>5,F[W+1]=x}function Vr(d,x,N,F,W){var K=240&Nt(d,x)|15;F[W+0]=240&ht(d,N)|Et(d,x,N)>>4,F[W+1]=K}function Ln(d,x,N,F,W){F[W+0]=255,Bt(d,x,N,F,W+1)}function ln(d,x,N,F,W){Sr(d,x,N,F,W),F[W+3]=255}function fs(d,x,N,F,W){Bt(d,x,N,F,W),F[W+3]=255}function _i(d,x){return 0>d?0:d>x?x:d}function Bs(d,x,N){C[d]=function(F,W,K,J,Q,Z,ie,ge,Ne){for(var ke=ge+(-2&Ne)*N;ge!=ke;)x(F[W+0],K[J+0],Q[Z+0],ie,ge),x(F[W+1],K[J+0],Q[Z+0],ie,ge+N),W+=2,++J,++Z,ge+=2*N;1&Ne&&x(F[W+0],K[J+0],Q[Z+0],ie,ge)}}function Xd(d,x,N){return N==0?d==0?x==0?6:5:x==0?4:0:N}function Lu(d,x,N,F,W){switch(d>>>30){case 3:la(x,N,F,W,0);break;case 2:Rr(x,N,F,W);break;case 1:qn(x,N,F,W)}}function Fu(d,x){var N,F,W=x.M,K=x.Nb,J=d.oc,Q=d.pc+40,Z=d.oc,ie=d.pc+584,ge=d.oc,Ne=d.pc+600;for(N=0;16>N;++N)J[Q+32*N-1]=129;for(N=0;8>N;++N)Z[ie+32*N-1]=129,ge[Ne+32*N-1]=129;for(0<W?J[Q-1-32]=Z[ie-1-32]=ge[Ne-1-32]=129:(i(J,Q-32-1,127,21),i(Z,ie-32-1,127,9),i(ge,Ne-32-1,127,9)),F=0;F<d.za;++F){var ke=x.ya[x.aa+F];if(0<F){for(N=-1;16>N;++N)n(J,Q+32*N-4,J,Q+32*N+12,4);for(N=-1;8>N;++N)n(Z,ie+32*N-4,Z,ie+32*N+4,4),n(ge,Ne+32*N-4,ge,Ne+32*N+4,4)}var we=d.Gd,Re=d.Hd+F,Pe=ke.ad,xe=ke.Hc;if(0<W&&(n(J,Q-32,we[Re].y,0,16),n(Z,ie-32,we[Re].f,0,8),n(ge,Ne-32,we[Re].ea,0,8)),ke.Za){var ye=J,De=Q-32+16;for(0<W&&(F>=d.za-1?i(ye,De,we[Re].y[15],4):n(ye,De,we[Re+1].y,0,4)),N=0;4>N;N++)ye[De+128+N]=ye[De+256+N]=ye[De+384+N]=ye[De+0+N];for(N=0;16>N;++N,xe<<=2)ye=J,De=Q+Bx[N],ds[ke.Ob[N]](ye,De),Lu(xe,Pe,16*+N,ye,De)}else if(ye=Xd(F,W,ke.Ob[0]),Ba[ye](J,Q),xe!=0)for(N=0;16>N;++N,xe<<=2)Lu(xe,Pe,16*+N,J,Q+Bx[N]);for(N=ke.Gc,ye=Xd(F,W,ke.Dd),ua[ye](Z,ie),ua[ye](ge,Ne),xe=Pe,ye=Z,De=ie,255&(ke=N>>0)&&(170&ke?Mu(xe,256,ye,De):$i(xe,256,ye,De)),ke=ge,xe=Ne,255&(N>>=8)&&(170&N?Mu(Pe,320,ke,xe):$i(Pe,320,ke,xe)),W<d.Ub-1&&(n(we[Re].y,0,J,Q+480,16),n(we[Re].f,0,Z,ie+224,8),n(we[Re].ea,0,ge,Ne+224,8)),N=8*K*d.B,we=d.sa,Re=d.ta+16*F+16*K*d.R,Pe=d.qa,ke=d.ra+8*F+N,xe=d.Ha,ye=d.Ia+8*F+N,N=0;16>N;++N)n(we,Re+N*d.R,J,Q+32*N,16);for(N=0;8>N;++N)n(Pe,ke+N*d.B,Z,ie+32*N,8),n(xe,ye+N*d.B,ge,Ne+32*N,8)}}function Yl(d,x,N,F,W,K,J,Q,Z){var ie=[0],ge=[0],Ne=0,ke=Z!=null?Z.kd:0,we=Z??new Au;if(d==null||12>N)return 7;we.data=d,we.w=x,we.ha=N,x=[x],N=[N],we.gb=[we.gb];e:{var Re=x,Pe=N,xe=we.gb;if(t(d!=null),t(Pe!=null),t(xe!=null),xe[0]=0,12<=Pe[0]&&!r(d,Re[0],"RIFF")){if(r(d,Re[0]+8,"WEBP")){xe=3;break e}var ye=Ve(d,Re[0]+4);if(12>ye||4294967286<ye){xe=3;break e}if(ke&&ye>Pe[0]-8){xe=7;break e}xe[0]=ye,Re[0]+=12,Pe[0]-=12}xe=0}if(xe!=0)return xe;for(ye=0<we.gb[0],N=N[0];;){e:{var De=d;Pe=x,xe=N;var Ue=ie,Ie=ge,lt=Re=[0];if((rt=Ne=[Ne])[0]=0,8>xe[0])xe=7;else{if(!r(De,Pe[0],"VP8X")){if(Ve(De,Pe[0]+4)!=10){xe=3;break e}if(18>xe[0]){xe=7;break e}var et=Ve(De,Pe[0]+8),gt=1+Oe(De,Pe[0]+12);if(2147483648<=gt*(De=1+Oe(De,Pe[0]+15))){xe=3;break e}lt!=null&&(lt[0]=et),Ue!=null&&(Ue[0]=gt),Ie!=null&&(Ie[0]=De),Pe[0]+=18,xe[0]-=18,rt[0]=1}xe=0}}if(Ne=Ne[0],Re=Re[0],xe!=0)return xe;if(Pe=!!(2&Re),!ye&&Ne)return 3;if(K!=null&&(K[0]=!!(16&Re)),J!=null&&(J[0]=Pe),Q!=null&&(Q[0]=0),J=ie[0],Re=ge[0],Ne&&Pe&&Z==null){xe=0;break}if(4>N){xe=7;break}if(ye&&Ne||!ye&&!Ne&&!r(d,x[0],"ALPH")){N=[N],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{et=d,xe=x,ye=N;var rt=we.gb;Ue=we.na,Ie=we.P,lt=we.Sa,gt=22,t(et!=null),t(ye!=null),De=xe[0];var qt=ye[0];for(t(Ue!=null),t(lt!=null),Ue[0]=null,Ie[0]=null,lt[0]=0;;){if(xe[0]=De,ye[0]=qt,8>qt){xe=7;break e}var Xt=Ve(et,De+4);if(4294967286<Xt){xe=3;break e}var zt=8+Xt+1&-2;if(gt+=zt,0<rt&&gt>rt){xe=3;break e}if(!r(et,De,"VP8 ")||!r(et,De,"VP8L")){xe=0;break e}if(qt[0]<zt){xe=7;break e}r(et,De,"ALPH")||(Ue[0]=et,Ie[0]=De+8,lt[0]=Xt),De+=zt,qt-=zt}}if(N=N[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],xe!=0)break}N=[N],we.Ja=[we.Ja],we.xa=[we.xa];e:if(rt=d,xe=x,ye=N,Ue=we.gb[0],Ie=we.Ja,lt=we.xa,et=xe[0],De=!r(rt,et,"VP8 "),gt=!r(rt,et,"VP8L"),t(rt!=null),t(ye!=null),t(Ie!=null),t(lt!=null),8>ye[0])xe=7;else{if(De||gt){if(rt=Ve(rt,et+4),12<=Ue&&rt>Ue-12){xe=3;break e}if(ke&&rt>ye[0]-8){xe=7;break e}Ie[0]=rt,xe[0]+=8,ye[0]-=8,lt[0]=gt}else lt[0]=5<=ye[0]&&rt[et+0]==47&&!(rt[et+4]>>5),Ie[0]=ye[0];xe=0}if(N=N[0],we.Ja=we.Ja[0],we.xa=we.xa[0],x=x[0],xe!=0)break;if(4294967286<we.Ja)return 3;if(Q==null||Pe||(Q[0]=we.xa?2:1),J=[J],Re=[Re],we.xa){if(5>N){xe=7;break}Q=J,ke=Re,Pe=K,d==null||5>N?d=0:5<=N&&d[x+0]==47&&!(d[x+4]>>5)?(ye=[0],rt=[0],Ue=[0],B(Ie=new k,d,x,N),pt(Ie,ye,rt,Ue)?(Q!=null&&(Q[0]=ye[0]),ke!=null&&(ke[0]=rt[0]),Pe!=null&&(Pe[0]=Ue[0]),d=1):d=0):d=0}else{if(10>N){xe=7;break}Q=Re,d==null||10>N||!Od(d,x+3,N-3)?d=0:(ke=d[x+0]|d[x+1]<<8|d[x+2]<<16,Pe=16383&(d[x+7]<<8|d[x+6]),d=16383&(d[x+9]<<8|d[x+8]),1&ke||3<(ke>>1&7)||!(ke>>4&1)||ke>>5>=we.Ja||!Pe||!d?d=0:(J&&(J[0]=Pe),Q&&(Q[0]=d),d=1))}if(!d||(J=J[0],Re=Re[0],Ne&&(ie[0]!=J||ge[0]!=Re)))return 3;Z!=null&&(Z[0]=we,Z.offset=x-Z.w,t(4294967286>x-Z.w),t(Z.offset==Z.ha-N));break}return xe==0||xe==7&&Ne&&Z==null?(K!=null&&(K[0]|=we.na!=null&&0<we.na.length),F!=null&&(F[0]=J),W!=null&&(W[0]=Re),0):xe}function Ou(d,x,N){var F=x.width,W=x.height,K=0,J=0,Q=F,Z=W;if(x.Da=d!=null&&0<d.Da,x.Da&&(Q=d.cd,Z=d.bd,K=d.v,J=d.j,11>N||(K&=-2,J&=-2),0>K||0>J||0>=Q||0>=Z||K+Q>F||J+Z>W))return 0;if(x.v=K,x.j=J,x.va=K+Q,x.o=J+Z,x.U=Q,x.T=Z,x.da=d!=null&&0<d.da,x.da){if(!Me(Q,Z,N=[d.ib],K=[d.hb]))return 0;x.ib=N[0],x.hb=K[0]}return x.ob=d!=null&&d.ob,x.Kb=d==null||!d.Sd,x.da&&(x.ob=x.ib<3*F/4&&x.hb<3*W/4,x.Kb=0),1}function Du(d){if(d==null)return 2;if(11>d.S){var x=d.f.RGBA;x.fb+=(d.height-1)*x.A,x.A=-x.A}else x=d.f.kb,d=d.height,x.O+=(d-1)*x.fa,x.fa=-x.fa,x.N+=(d-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(d-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(d-1)*x.lb,x.lb=-x.lb);return 0}function Kl(d,x,N,F){if(F==null||0>=d||0>=x)return 2;if(N!=null){if(N.Da){var W=N.cd,K=N.bd,J=-2&N.v,Q=-2&N.j;if(0>J||0>Q||0>=W||0>=K||J+W>d||Q+K>x)return 2;d=W,x=K}if(N.da){if(!Me(d,x,W=[N.ib],K=[N.hb]))return 2;d=W[0],x=K[0]}}F.width=d,F.height=x;e:{var Z=F.width,ie=F.height;if(d=F.S,0>=Z||0>=ie||!(d>=nh&&13>d))d=2;else{if(0>=F.Rd&&F.sd==null){J=K=W=x=0;var ge=(Q=Z*Ux[d])*ie;if(11>d||(K=(ie+1)/2*(x=(Z+1)/2),d==12&&(J=(W=Z)*ie)),(ie=s(ge+2*K+J))==null){d=1;break e}F.sd=ie,11>d?((Z=F.f.RGBA).eb=ie,Z.fb=0,Z.A=Q,Z.size=ge):((Z=F.f.kb).y=ie,Z.O=0,Z.fa=Q,Z.Fd=ge,Z.f=ie,Z.N=0+ge,Z.Ab=x,Z.Cd=K,Z.ea=ie,Z.W=0+ge+K,Z.Db=x,Z.Ed=K,d==12&&(Z.F=ie,Z.J=0+ge+2*K),Z.Tc=J,Z.lb=W)}if(x=1,W=F.S,K=F.width,J=F.height,W>=nh&&13>W)if(11>W)d=F.f.RGBA,x&=(Q=Math.abs(d.A))*(J-1)+K<=d.size,x&=Q>=K*Ux[W],x&=d.eb!=null;else{d=F.f.kb,Q=(K+1)/2,ge=(J+1)/2,Z=Math.abs(d.fa),ie=Math.abs(d.Ab);var Ne=Math.abs(d.Db),ke=Math.abs(d.lb),we=ke*(J-1)+K;x&=Z*(J-1)+K<=d.Fd,x&=ie*(ge-1)+Q<=d.Cd,x=(x&=Ne*(ge-1)+Q<=d.Ed)&Z>=K&ie>=Q&Ne>=Q,x&=d.y!=null,x&=d.f!=null,x&=d.ea!=null,W==12&&(x&=ke>=K,x&=we<=d.Tc,x&=d.F!=null)}else x=0;d=x?0:2}}return d!=0||N!=null&&N.fd&&(d=Du(F)),d}var yn=64,Xl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Jl=24,Ql=32,Iu=8,ii=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ye("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(d){return d},C.Predictor2=function(d,x,N){return x[N+0]},C.Predictor3=function(d,x,N){return x[N+1]},C.Predictor4=function(d,x,N){return x[N-1]},C.Predictor5=function(d,x,N){return tt(tt(d,x[N+1]),x[N+0])},C.Predictor6=function(d,x,N){return tt(d,x[N-1])},C.Predictor7=function(d,x,N){return tt(d,x[N+0])},C.Predictor8=function(d,x,N){return tt(x[N-1],x[N+0])},C.Predictor9=function(d,x,N){return tt(x[N+0],x[N+1])},C.Predictor10=function(d,x,N){return tt(tt(d,x[N-1]),tt(x[N+0],x[N+1]))},C.Predictor11=function(d,x,N){var F=x[N+0];return 0>=bt(F>>24&255,d>>24&255,(x=x[N-1])>>24&255)+bt(F>>16&255,d>>16&255,x>>16&255)+bt(F>>8&255,d>>8&255,x>>8&255)+bt(255&F,255&d,255&x)?F:d},C.Predictor12=function(d,x,N){var F=x[N+0];return(ft((d>>24&255)+(F>>24&255)-((x=x[N-1])>>24&255))<<24|ft((d>>16&255)+(F>>16&255)-(x>>16&255))<<16|ft((d>>8&255)+(F>>8&255)-(x>>8&255))<<8|ft((255&d)+(255&F)-(255&x)))>>>0},C.Predictor13=function(d,x,N){var F=x[N-1];return(dt((d=tt(d,x[N+0]))>>24&255,F>>24&255)<<24|dt(d>>16&255,F>>16&255)<<16|dt(d>>8&255,F>>8&255)<<8|dt(d>>0&255,F>>0&255))>>>0};var lp=C.PredictorAdd0;C.PredictorAdd1=jt,Ye("Predictor2","PredictorAdd2"),Ye("Predictor3","PredictorAdd3"),Ye("Predictor4","PredictorAdd4"),Ye("Predictor5","PredictorAdd5"),Ye("Predictor6","PredictorAdd6"),Ye("Predictor7","PredictorAdd7"),Ye("Predictor8","PredictorAdd8"),Ye("Predictor9","PredictorAdd9"),Ye("Predictor10","PredictorAdd10"),Ye("Predictor11","PredictorAdd11"),Ye("Predictor12","PredictorAdd12"),Ye("Predictor13","PredictorAdd13");var Ru=C.PredictorAdd2;Ct("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),Ct("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var Jd,Hi=C.ColorIndexInverseTransform,Zl=C.MapARGB,Qd=C.VP8LColorIndexInverseTransformAlpha,Zd=C.MapAlpha,Da=C.VP8LPredictorsAdd=[];Da.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var qo,si,$n,Ia,aa,oa,ec,la,Rr,Mu,qn,$i,tc,eh,Bu,Vo,Go,Ra,Yo,rc,Ko,Ma,Uu,qi,Vi,dr,hr,Mr,rn=s(511),ca=s(2041),zu=s(225),nc=s(767),th=0,cp=ca,rh=zu,Si=nc,Gi=rn,nh=0,ih=1,Tx=2,sh=3,ah=4,up=5,Cx=6,fp=7,dp=8,oh=9,hp=10,bS=[2,3,7],_S=[3,3,11],Px=[280,256,256,256,40],SS=[0,1,1,1,0],NS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],kS=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ES=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],jS=8,mp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],pp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Wu=null,AS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],TS=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Lx=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],CS=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],PS=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],LS=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],FS=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ba=[],ds=[],ua=[],OS=1,Fx=2,Ua=[],Yi=[];Le("UpsampleRgbLinePair",Bt,3),Le("UpsampleBgrLinePair",Sr,3),Le("UpsampleRgbaLinePair",fs,4),Le("UpsampleBgraLinePair",ln,4),Le("UpsampleArgbLinePair",Ln,4),Le("UpsampleRgba4444LinePair",Vr,2),Le("UpsampleRgb565LinePair",Ar,2);var DS=C.UpsampleRgbLinePair,IS=C.UpsampleBgrLinePair,Ox=C.UpsampleRgbaLinePair,Dx=C.UpsampleBgraLinePair,Ix=C.UpsampleArgbLinePair,Rx=C.UpsampleRgba4444LinePair,RS=C.UpsampleRgb565LinePair,lh=16,ch=1<<lh-1,Hu=-227,gp=482,MS=6,Mx=0,BS=s(256),US=s(256),zS=s(256),WS=s(256),HS=s(gp-Hu),$S=s(gp-Hu);Bs("YuvToRgbRow",Bt,3),Bs("YuvToBgrRow",Sr,3),Bs("YuvToRgbaRow",fs,4),Bs("YuvToBgraRow",ln,4),Bs("YuvToArgbRow",Ln,4),Bs("YuvToRgba4444Row",Vr,2),Bs("YuvToRgb565Row",Ar,2);var Bx=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],uh=[0,2,8],qS=[8,7,6,4,4,2,2,2,1,1,1,1],VS=1;this.WebPDecodeRGBA=function(d,x,N,F,W){var K=ih,J=new Vl,Q=new yi;J.ba=Q,Q.S=K,Q.width=[Q.width],Q.height=[Q.height];var Z=Q.width,ie=Q.height,ge=new as;if(ge==null||d==null)var Ne=2;else t(ge!=null),Ne=Yl(d,x,N,ge.width,ge.height,ge.Pd,ge.Qd,ge.format,null);if(Ne!=0?Z=0:(Z!=null&&(Z[0]=ge.width[0]),ie!=null&&(ie[0]=ge.height[0]),Z=1),Z){Q.width=Q.width[0],Q.height=Q.height[0],F!=null&&(F[0]=Q.width),W!=null&&(W[0]=Q.height);e:{if(F=new Is,(W=new Au).data=d,W.w=x,W.ha=N,W.kd=1,x=[0],t(W!=null),((d=Yl(W.data,W.w,W.ha,null,null,null,x,null,W))==0||d==7)&&x[0]&&(d=4),(x=d)==0){if(t(J!=null),F.data=W.data,F.w=W.w+W.offset,F.ha=W.ha-W.offset,F.put=zi,F.ac=tn,F.bc=Wi,F.ma=J,W.xa){if((d=Ce())==null){J=1;break e}if(function(ke,we){var Re=[0],Pe=[0],xe=[0];t:for(;;){if(ke==null)return 0;if(we==null)return ke.a=2,0;if(ke.l=we,ke.a=0,B(ke.m,we.data,we.w,we.ha),!pt(ke.m,Re,Pe,xe)){ke.a=3;break t}if(ke.xb=Fx,we.width=Re[0],we.height=Pe[0],!_e(Re[0],Pe[0],1,ke,null))break t;return 1}return t(ke.a!=0),0}(d,F)){if(F=(x=Kl(F.width,F.height,J.Oa,J.ba))==0){t:{F=d;r:for(;;){if(F==null){F=0;break t}if(t(F.s.yc!=null),t(F.s.Ya!=null),t(0<F.s.Wb),t((N=F.l)!=null),t((W=N.ma)!=null),F.xb!=0){if(F.ca=W.ba,F.tb=W.tb,t(F.ca!=null),!Ou(W.Oa,N,sh)){F.a=2;break r}if(!je(F,N.width)||N.da)break r;if((N.da||Ut(F.ca.S))&&be(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&be()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!Qe(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!le(F,F.V,F.Ba,F.c,F.i,N.o,oe))break r;W.Dc=F.Ma,F=1;break t}t(F.a!=0),F=0}F=!F}F&&(x=d.a)}else x=d.a}else{if((d=new bi)==null){J=1;break e}if(d.Fa=W.na,d.P=W.P,d.qc=W.Sa,Dd(d,F)){if((x=Kl(F.width,F.height,J.Oa,J.ba))==0){if(d.Aa=0,N=J.Oa,t((W=d)!=null),N!=null){if(0<(Z=0>(Z=N.Md)?0:100<Z?255:255*Z/100)){for(ie=ge=0;4>ie;++ie)12>(Ne=W.pb[ie]).lc&&(Ne.ia=Z*qS[0>Ne.lc?0:Ne.lc]>>3),ge|=Ne.ia;ge&&(alert("todo:VP8InitRandom"),W.ia=1)}W.Ga=N.Id,100<W.Ga?W.Ga=100:0>W.Ga&&(W.Ga=0)}$m(d,F)||(x=d.a)}}else x=d.a}x==0&&J.Oa!=null&&J.Oa.fd&&(x=Du(J.ba))}J=x}K=J!=0?null:11>K?Q.f.RGBA.eb:Q.f.kb.y}else K=null;return K};var Ux=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,P){for(var R="",T=0;T<4;T++)R+=String.fromCharCode(C[P++]);return R}function f(C,P){return(C[P+0]<<0|C[P+1]<<8|C[P+2]<<16)>>>0}function m(C,P){return(C[P+0]<<0|C[P+1]<<8|C[P+2]<<16|C[P+3]<<24)>>>0}new l;var p=[0],h=[0],v=[],g=new l,b=e,y=function(C,P){var R={},T=0,A=!1,q=0,z=0;if(R.frames=[],!function(I,M,D,V){for(var se=0;se<V;se++)if(I[M+se]!=D.charCodeAt(se))return!0;return!1}(C,P,"RIFF",4)){var ne,U;for(m(C,P+=4),P+=8;P<C.length;){var G=u(C,P),B=m(C,P+=4);P+=4;var Y=B+(1&B);switch(G){case"VP8 ":case"VP8L":R.frames[T]===void 0&&(R.frames[T]={}),(k=R.frames[T]).src_off=A?z:P-8,k.src_size=q+B+8,T++,A&&(A=!1,q=0,z=0);break;case"VP8X":(k=R.header={}).feature_flags=C[P];var re=P+4;k.canvas_width=1+f(C,re),re+=3,k.canvas_height=1+f(C,re),re+=3;break;case"ALPH":A=!0,q=Y+8,z=P-8;break;case"ANIM":(k=R.header).bgcolor=m(C,P),re=P+4,k.loop_count=(ne=C)[(U=re)+0]<<0|ne[U+1]<<8,re+=2;break;case"ANMF":var he,k;(k=R.frames[T]={}).offset_x=2*f(C,P),P+=3,k.offset_y=2*f(C,P),P+=3,k.width=1+f(C,P),P+=3,k.height=1+f(C,P),P+=3,k.duration=f(C,P),P+=3,he=C[P++],k.dispose=1&he,k.blend=he>>1&1}G!="ANMF"&&(P+=Y)}return R}}(b,0);y.response=b,y.rgbaoutput=!0,y.dataurl=!1;var w=y.header?y.header:null,_=y.frames?y.frames:null;if(w){w.loop_counter=w.loop_count,p=[w.canvas_height],h=[w.canvas_width];for(var j=0;j<_.length&&_[j].blend!=0;j++);}var O=_[0],L=g.WebPDecodeRGBA(b,O.src_off,O.src_size,h,p);O.rgba=L,O.imgwidth=h[0],O.imgheight=p[0];for(var E=0;E<h[0]*p[0]*4;E++)v[E]=L[E];return this.width=h,this.height=p,this.data=v,this}(function(e){var t=function(){return typeof Bg=="function"},r=function(p,h,v,g){var b=4,y=a;switch(g){case e.image_compression.FAST:b=1,y=s;break;case e.image_compression.MEDIUM:b=6,y=o;break;case e.image_compression.SLOW:b=9,y=l}p=n(p,h,v,y);var w=Bg(p,{level:b});return e.__addimage__.arrayBufferToBinaryString(w)},n=function(p,h,v,g){for(var b,y,w,_=p.length/h,j=new Uint8Array(p.length+_),O=f(),L=0;L<_;L+=1){if(w=L*h,b=p.subarray(w,w+h),g)j.set(g(b,v,y),w+L);else{for(var E,C=O.length,P=[];E<C;E+=1)P[E]=O[E](b,v,y);var R=m(P.concat());j.set(P[R],w+L)}y=b}return j},i=function(p){var h=Array.apply([],p);return h.unshift(0),h},s=function(p,h){var v,g=[],b=p.length;g[0]=1;for(var y=0;y<b;y+=1)v=p[y-h]||0,g[y+1]=p[y]-v+256&255;return g},a=function(p,h,v){var g,b=[],y=p.length;b[0]=2;for(var w=0;w<y;w+=1)g=v&&v[w]||0,b[w+1]=p[w]-g+256&255;return b},o=function(p,h,v){var g,b,y=[],w=p.length;y[0]=3;for(var _=0;_<w;_+=1)g=p[_-h]||0,b=v&&v[_]||0,y[_+1]=p[_]+256-(g+b>>>1)&255;return y},l=function(p,h,v){var g,b,y,w,_=[],j=p.length;_[0]=4;for(var O=0;O<j;O+=1)g=p[O-h]||0,b=v&&v[O]||0,y=v&&v[O-h]||0,w=u(g,b,y),_[O+1]=p[O]-w+256&255;return _},u=function(p,h,v){if(p===h&&h===v)return p;var g=Math.abs(h-v),b=Math.abs(p-v),y=Math.abs(p+h-v-v);return g<=b&&g<=y?p:b<=y?h:v},f=function(){return[i,s,a,o,l]},m=function(p){var h=p.map(function(v){return v.reduce(function(g,b){return g+Math.abs(b)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(p,h,v,g){var b,y,w,_,j,O,L,E,C,P,R,T,A,q,z,ne=this.decode.FLATE_DECODE,U="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(w=new YC(p)).imgData,y=w.bits,b=w.colorSpace,j=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){C=(E=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,R=new Uint8Array(C*w.colors),P=new Uint8Array(C);var G,B=w.pixelBitlength-w.bits;for(q=0,z=0;q<C;q++){for(A=E[q],G=0;G<B;)R[z++]=A>>>G&255,G+=w.bits;P[q]=A>>>G&255}}if(w.bits===16){C=(E=new Uint32Array(w.decodePixels().buffer)).length,R=new Uint8Array(C*(32/w.pixelBitlength)*w.colors),P=new Uint8Array(C*(32/w.pixelBitlength)),T=w.colors>1,q=0,z=0;for(var Y=0;q<C;)A=E[q++],R[z++]=A>>>0&255,T&&(R[z++]=A>>>16&255,A=E[q++],R[z++]=A>>>0&255),P[Y++]=A>>>16&255;y=8}g!==e.image_compression.NONE&&t()?(p=r(R,w.width*w.colors,w.colors,g),L=r(P,w.width,1,g)):(p=R,L=P,ne=void 0)}if(w.colorType===3&&(b=this.color_spaces.INDEXED,O=w.palette,w.transparency.indexed)){var re=w.transparency.indexed,he=0;for(q=0,C=re.length;q<C;++q)he+=re[q];if((he/=255)===C-1&&re.indexOf(0)!==-1)_=[re.indexOf(0)];else if(he!==C){for(E=w.decodePixels(),P=new Uint8Array(E.length),q=0,C=E.length;q<C;q++)P[q]=re[E[q]];L=r(P,w.width,1)}}var k=function(I){var M;switch(I){case e.image_compression.FAST:M=11;break;case e.image_compression.MEDIUM:M=13;break;case e.image_compression.SLOW:M=14;break;default:M=12}return M}(g);return ne===this.decode.FLATE_DECODE&&(U="/Predictor "+k+" "),U+="/Colors "+j+" /BitsPerComponent "+y+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(L&&this.__addimage__.isArrayBuffer(L)||this.__addimage__.isArrayBufferView(L))&&(L=this.__addimage__.arrayBufferToBinaryString(L)),{alias:v,data:p,index:h,filter:ne,decodeParameters:U,transparency:_,palette:O,sMask:L,predictor:k,width:w.width,height:w.height,bitsPerComponent:y,colorSpace:b}}}})(mt.API),function(e){e.processGIF89A=function(t,r,n,i){var s=new KC(t),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:a,height:o},f=new g1(100).encode(u,100);return e.processJPEG.call(this,f,r,n,i)},e.processGIF87A=e.processGIF89A}(mt.API),gs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},gs.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){ur.log("bit decode error:"+r)}},gs.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}r!==0&&(this.pos+=4-r)}},gs.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*i*4,o=s>>4,l=15&s,u=this.palette[o];if(this.data[a]=u.blue,this.data[a+1]=u.green,this.data[a+2]=u.red,this.data[a+3]=255,2*i+1>=this.width)break;u=this.palette[l],this.data[a+4]=u.blue,this.data[a+4+1]=u.green,this.data[a+4+2]=u.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},gs.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},gs.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,u=s>>15?255:0,f=n*this.width*4+4*i;this.data[f]=l,this.data[f+1]=o,this.data[f+2]=a,this.data[f+3]=u}this.pos+=e}},gs.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,l=(a>>5&r)/r*255|0,u=(a>>11)/t*255|0,f=i*this.width*4+4*s;this.data[f]=u,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},gs.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*r;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},gs.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=a}},gs.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new gs(t,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},u=new g1(100).encode(l,100);return e.processJPEG.call(this,u,r,n,i)}}(mt.API),c5.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new c5(t),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},u=new g1(100).encode(l,100);return e.processJPEG.call(this,u,r,n,i)}}(mt.API),mt.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,l=0,u=0;u<i;u+=4){var f=n[u],m=n[u+1],p=n[u+2],h=n[u+3];s[o++]=f,s[o++]=m,s[o++]=p,a[l++]=h}var v=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},mt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},pc=mt.API,Vh=pc.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,l=o.fof?o.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,m=t.doKerning!==!1,p=0,h=e.length,v=0,g=o[0]||l,b=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?b.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(p=m&&tr(u[n])==="object"&&!isNaN(parseInt(u[n][v],10))?u[n][v]/f:0,b.push((o[n]||g)/l+p)),v=n;return b},s5=pc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return pc.processArabic&&(e=pc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:Vh.apply(this,arguments).reduce(function(s,a){return s+a},0)},a5=function(e,t,r,n){for(var i=[],s=0,a=e.length,o=0;s!==a&&o+t[s]<r;)o+=t[s],s++;i.push(e.slice(0,s));var l=s;for(o=0;s!==a;)o+t[s]>n&&(i.push(e.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&i.push(e.slice(l,s)),i},o5=function(e,t,r){r||(r={});var n,i,s,a,o,l,u,f=[],m=[f],p=r.textIndent||0,h=0,v=0,g=e.split(" "),b=Vh.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var y=Array(l).join(" "),w=[];g.map(function(j){(j=j.split(/\s*\n/)).length>1?w=w.concat(j.map(function(O,L){return(L&&O.length?`
`:"")+O})):w.push(j[0])}),g=w,l=s5.apply(this,[y,r])}for(s=0,a=g.length;s<a;s++){var _=0;if(n=g[s],l&&n[0]==`
`&&(n=n.substr(1),_=1),p+h+(v=(i=Vh.apply(this,[n,r])).reduce(function(j,O){return j+O},0))>t||_){if(v>t){for(o=a5.apply(this,[n,i,t-(p+h),t]),f.push(o.shift()),f=[o.pop()];o.length;)m.push([o.shift()]);v=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(j,O){return j+O},0)}else f=[n];m.push(f),p=v+l,h=b}else f.push(n),p+=h+v,h=b}return u=l?function(j,O){return(O?y:"")+j.join(" ")}:function(j){return j.join(" ")},m.map(u)},pc.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var m=this.internal.getFont(f.fontName,f.fontStyle);return m.metadata.Unicode?{widths:m.metadata.Unicode.widths||{0:1},kerning:m.metadata.Unicode.kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var o,l,u=[];for(o=0,l=n.length;o<l;o++)u=u.concat(o5.apply(this,[n[o],a,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},i=0;i<t.length;i++)r[t[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=t[i];var s=function(m){return"0x"+parseInt(m,10).toString(16)},a=e.__fontmetrics__.compress=function(m){var p,h,v,g,b=["{"];for(var y in m){if(p=m[y],isNaN(parseInt(y,10))?h="'"+y+"'":(y=parseInt(y,10),h=(h=s(y).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof p=="number")p<0?(v=s(p).slice(3),g="-"):(v=s(p).slice(2),g=""),v=g+v.slice(0,-1)+n[v.slice(-1)];else{if(tr(p)!=="object")throw new Error("Don't know what to do with value type "+tr(p)+".");v=a(p)}b.push(h+v)}return b.push("}"),b.join("")},o=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,h,v,g,b={},y=1,w=b,_=[],j="",O="",L=m.length-1,E=1;E<L;E+=1)(g=m[E])=="'"?p?(v=p.join(""),p=void 0):p=[]:p?p.push(g):g=="{"?(_.push([w,v]),w={},v=void 0):g=="}"?((h=_.pop())[0][h[1]]=w,v=void 0,w=h[0]):g=="-"?y=-1:v===void 0?r.hasOwnProperty(g)?(j+=r[g],v=parseInt(j,16)*y,y=1,j=""):j+=g:r.hasOwnProperty(g)?(O+=r[g],w[v]=parseInt(O,16)*y,y=1,v=void 0,O=""):O+=g;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},f={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var p=m.font,h=f.Unicode[p.postScriptName];h&&(p.metadata.Unicode={},p.metadata.Unicode.widths=h.widths,p.metadata.Unicode.kerning=h.kerning);var v=u.Unicode[p.postScriptName];v&&(p.metadata.Unicode.encoding=v,p.encoding=v.codePages[0])}])}(mt.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Cf(o)),a.metadata=e.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,n)}}])}(mt),function(e){function t(){return(vt.canvg?Promise.resolve(vt.canvg):ja(()=>import("./index.es-B94m-NNq.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}mt.API.addSvgAsImage=function(r,n,i,s,a,o,l,u){if(isNaN(n)||isNaN(i))throw ur.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw ur.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=s,f.height=a;var m=f.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,f.width,f.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(v){return v.fromString(m,r,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(p)}).then(function(){h.addImage(f.toDataURL("image/jpeg",1),n,i,s,a,l,u)})}}(),mt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},mt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],u=0,f=0,m=0;function p(v,g){var b,y=!1;for(b=0;b<v.length;b+=1)v[b]===g&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(m=0;m<h;m+=1)r[o[m]].value=r[o[m]].defaultValue,r[o[m]].explicitSet=!1}if(tr(e)==="object"){for(i in e)if(s=e[i],p(o,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&p(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")l.push(String(s[u]-1));else if(s[u].length>1){for(f=0;f<s[u].length;f+=1)typeof s[u][f]!="number"&&(n=!1);n===!0&&l.push([s[u][0]-1,s[u][1]-1].join(" "))}r[i].value="["+l.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+a.length+o.length+i.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(mt.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,a){for(var o,l=a.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],m=0,p=s.length;m<p;++m){if(o=a.metadata.characterToGlyph(s.charCodeAt(m)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(m),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(u[4-o.length],o)}return f.join("")},n=function(s){var a,o,l,u,f,m,p;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],m=0,p=(o=Object.keys(s).sort(function(h,v){return h-v})).length;m<p;m++)a=o[m],l.length>=100&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(u=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+u+">"));return l.length&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,u=a.newObject,f=a.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var m=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",v=0;v<p.length;v++)h+=String.fromCharCode(p[v]);var g=u();f({data:h,addLength1:!0,objectId:g}),l("endobj");var b=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var y=u();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+bc(o.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var w=u();l("<<"),l("/Type /Font"),l("/BaseFont /"+bc(o.fontName)),l("/FontDescriptor "+y+" 0 R"),l("/W "+e.API.PDFObject.convert(m)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=u(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+bc(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+w+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,u=a.newObject,f=a.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var m=o.metadata.rawData,p="",h=0;h<m.length;h++)p+=String.fromCharCode(m[h]);var v=u();f({data:p,addLength1:!0,objectId:v}),l("endobj");var g=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var b=u();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+v+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+bc(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=u();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+bc(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var a,o=s.text||"",l=s.x,u=s.y,f=s.options||{},m=s.mutex||{},p=m.pdfEscape,h=m.activeFontKey,v=m.fonts,g=h,b="",y=0,w="",_=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:o,x:l,y:u,options:f,mutex:m};for(w=o,g=h,Array.isArray(o)&&(w=o[0]),y=0;y<w.length;y+=1)v[g].metadata.hasOwnProperty("cmap")&&(a=v[g].metadata.cmap.unicode.codeMap[w[y].charCodeAt(0)]),a||w[y].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?b+=w[y]:b+="";var j="";return parseInt(g.slice(1))<14||_==="WinAnsiEncoding"?j=p(b,g).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(j=r(b,v[g])),m.isHex=!0,{text:j,x:l,y:u,options:f,mutex:m}};t.events.push(["postProcessText",function(s){var a=s.text||"",o=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var u=0;for(u=0;u<a.length;u+=1)Array.isArray(a[u])&&a[u].length===3?o.push([i(Object.assign({},l,{text:a[u][0]})).text,a[u][1],a[u][2]]):o.push(i(Object.assign({},l,{text:a[u]})).text);s.text=o}else s.text=i(Object.assign({},l,{text:a})).text}])}(mt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(mt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,a,o,l,u,f,m=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,_=0;this.__bidiEngine__={};var j=function(T){var A=T.charCodeAt(),q=A>>8,z=g[q];return z!==void 0?m[256*z+(255&A)]:q===252||q===253?"AL":y.test(q)?"L":q===8?"R":"N"},O=function(T){for(var A,q=0;q<T.length;q++){if((A=j(T.charAt(q)))==="L")return!1;if(A==="R")return!0}return!1},L=function(T,A,q,z){var ne,U,G,B,Y=A[z];switch(Y){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(Y="AN");break;case"AL":w=!0,Y="R";break;case"WS":Y="N";break;case"CS":z<1||z+1>=A.length||(ne=q[z-1])!=="EN"&&ne!=="AN"||(U=A[z+1])!=="EN"&&U!=="AN"?Y="N":w&&(U="AN"),Y=U===ne?U:"N";break;case"ES":Y=(ne=z>0?q[z-1]:"B")==="EN"&&z+1<A.length&&A[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&q[z-1]==="EN"){Y="EN";break}if(w){Y="N";break}for(G=z+1,B=A.length;G<B&&A[G]==="ET";)G++;Y=G<B&&A[G]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(B=A.length,G=z+1;G<B&&A[G]==="NSM";)G++;if(G<B){var re=T[z],he=re>=1425&&re<=2303||re===64286;if(ne=A[G],he&&(ne==="R"||ne==="AL")){Y="R";break}}}Y=z<1||(ne=A[z-1])==="B"?"N":q[z-1];break;case"B":w=!1,i=!0,Y=_;break;case"S":s=!0,Y="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":Y="N"}return Y},E=function(T,A,q){var z=T.split("");return q&&C(z,q,{hiLevel:_}),z.reverse(),A&&A.reverse(),z.join("")},C=function(T,A,q){var z,ne,U,G,B,Y=-1,re=T.length,he=0,k=[],I=_?h:p,M=[];for(w=!1,i=!1,s=!1,ne=0;ne<re;ne++)M[ne]=j(T[ne]);for(U=0;U<re;U++){if(B=he,k[U]=L(T,M,k,U),z=240&(he=I[B][v[k[U]]]),he&=15,A[U]=G=I[he][5],z>0)if(z===16){for(ne=Y;ne<U;ne++)A[ne]=1;Y=-1}else Y=-1;if(I[he][6])Y===-1&&(Y=U);else if(Y>-1){for(ne=Y;ne<U;ne++)A[ne]=G;Y=-1}M[U]==="B"&&(A[U]=0),q.hiLevel|=G}s&&function(D,V,se){for(var fe=0;fe<se;fe++)if(D[fe]==="S"){V[fe]=_;for(var de=fe-1;de>=0&&D[de]==="WS";de--)V[de]=_}}(M,A,re)},P=function(T,A,q,z,ne){if(!(ne.hiLevel<T)){if(T===1&&_===1&&!i)return A.reverse(),void(q&&q.reverse());for(var U,G,B,Y,re=A.length,he=0;he<re;){if(z[he]>=T){for(B=he+1;B<re&&z[B]>=T;)B++;for(Y=he,G=B-1;Y<G;Y++,G--)U=A[Y],A[Y]=A[G],A[G]=U,q&&(U=q[Y],q[Y]=q[G],q[G]=U);he=B}he++}}},R=function(T,A,q){var z=T.split(""),ne={hiLevel:_};return q||(q=[]),C(z,q,ne),function(U,G,B){if(B.hiLevel!==0&&f)for(var Y,re=0;re<U.length;re++)G[re]===1&&(Y=b.indexOf(U[re]))>=0&&(U[re]=b[Y+1])}(z,q,ne),P(2,z,A,q,ne),P(1,z,A,q,ne),z.join("")};return this.__bidiEngine__.doBidiReorder=function(T,A,q){if(function(ne,U){if(U)for(var G=0;G<ne.length;G++)U[G]=G;o===void 0&&(o=O(ne)),u===void 0&&(u=O(ne))}(T,A),a||!l||u)if(a&&l&&o^u)_=o?1:0,T=E(T,A,q);else if(!a&&l&&u)_=o?1:0,T=R(T,A,q),T=E(T,A);else if(!a||o||l||u){if(a&&!l&&o^u)T=E(T,A),o?(_=0,T=R(T,A,q)):(_=1,T=R(T,A,q),T=E(T,A));else if(a&&o&&!l&&u)_=1,T=R(T,A,q),T=E(T,A);else if(!a&&!l&&o^u){var z=f;o?(_=1,T=R(T,A,q),_=0,f=!1,T=R(T,A,q),f=z):(_=0,T=R(T,A,q),T=E(T,A),_=1,f=!1,T=R(T,A,q),f=z,T=E(T,A))}}else _=0,T=R(T,A,q);else _=o?1:0,T=R(T,A,q);return T},this.__bidiEngine__.setOptions=function(T){T&&(a=T.isInputVisual,l=T.isOutputVisual,o=T.isInputRtl,u=T.isOutputRtl,f=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text,s=(n.x,n.y,n.options||{}),a=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(a=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?a.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):a.push([r.doBidiReorder(i[o])]);n.text=a}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(mt),mt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Co(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new u7(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new XC(this.contents),this.head=new QC(this),this.name=new n7(this),this.cmap=new M_(this),this.toUnicode={},this.hhea=new ZC(this),this.maxp=new i7(this),this.hmtx=new s7(this),this.post=new t7(this),this.os2=new e7(this),this.loca=new c7(this),this.glyf=new a7(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,u;for(u=[],a=0,o=(l=this.bbox).length;a<o;a++)t=l[a],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,a,o;for(a=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=t.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return a*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Fs,Co=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,a,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*a+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),XC=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,a,o,l,u,f,m,p,h,v,g;for(g in h=Object.keys(r).length,l=Math.log(2),m=16*Math.floor(Math.log(h)/l),a=Math.floor(m/l),f=16*h-m,(i=new Co).writeInt(this.scalarType),i.writeShort(h),i.writeShort(m),i.writeShort(a),i.writeShort(f),s=16*h,u=i.pos+s,o=null,v=[],r)for(p=r[g],i.writeString(g),i.writeInt(e(p)),i.writeInt(u),i.writeInt(p.length),v=v.concat(p),g==="head"&&(o=u),u+=p.length;u%4;)v.push(0),u++;return i.write(v),n=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,a;for(r=B_.call(r);r.length%4;)r.push(0);for(s=new Co(r),i=0,n=0,a=r.length;n<a;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),JC={}.hasOwnProperty,ta=function(e,t){for(var r in t)JC.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Fs=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var QC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new Co).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),u5=function(){function e(t,r){var n,i,s,a,o,l,u,f,m,p,h,v,g,b,y,w,_;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),m=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,s=function(){var j,O;for(O=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)O.push(t.readUInt16());return O}(),t.pos+=2,g=function(){var j,O;for(O=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)O.push(t.readUInt16());return O}(),u=function(){var j,O;for(O=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)O.push(t.readUInt16());return O}(),f=function(){var j,O;for(O=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)O.push(t.readUInt16());return O}(),i=(this.length-t.pos+this.offset)/2,o=function(){var j,O;for(O=[],l=j=0;0<=i?j<i:j>i;l=0<=i?++j:--j)O.push(t.readUInt16());return O}(),l=y=0,_=s.length;y<_;l=++y)for(b=s[l],n=w=v=g[l];v<=b?w<=b:w>=b;n=v<=b?++w:--w)f[l]===0?a=n+u[l]:(a=o[f[l]/2+(n-v)-(p-l)]||0)!==0&&(a+=u[l]),this.codeMap[n]=65535&a}t.pos=m}return e.encode=function(t,r){var n,i,s,a,o,l,u,f,m,p,h,v,g,b,y,w,_,j,O,L,E,C,P,R,T,A,q,z,ne,U,G,B,Y,re,he,k,I,M,D,V,se,fe,de,ve,Ee,Oe;switch(z=new Co,a=Object.keys(t).sort(function(Ve,Qe){return Ve-Qe}),r){case"macroman":for(g=0,b=function(){var Ve=[];for(v=0;v<256;++v)Ve.push(0);return Ve}(),w={0:0},s={},ne=0,Y=a.length;ne<Y;ne++)w[de=t[i=a[ne]]]==null&&(w[de]=++g),s[i]={old:t[i],new:w[t[i]]},b[i]=w[t[i]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(b),{charMap:s,subtable:z.data,maxGlyphID:g+1};case"unicode":for(A=[],m=[],_=0,w={},n={},y=u=null,U=0,re=a.length;U<re;U++)w[O=t[i=a[U]]]==null&&(w[O]=++_),n[i]={old:O,new:w[O]},o=w[O]-i,y!=null&&o===u||(y&&m.push(y),A.push(i),u=o),y=i;for(y&&m.push(y),m.push(65535),A.push(65535),R=2*(P=A.length),C=2*Math.pow(Math.log(P)/Math.LN2,2),p=Math.log(C/2)/Math.LN2,E=2*P-C,l=[],L=[],h=[],v=G=0,he=A.length;G<he;v=++G){if(T=A[v],f=m[v],T===65535){l.push(0),L.push(0);break}if(T-(q=n[T].new)>=32768)for(l.push(0),L.push(2*(h.length+P-v)),i=B=T;T<=f?B<=f:B>=f;i=T<=f?++B:--B)h.push(n[i].new);else l.push(q-T),L.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*P+2*h.length),z.writeUInt16(0),z.writeUInt16(R),z.writeUInt16(C),z.writeUInt16(p),z.writeUInt16(E),se=0,k=m.length;se<k;se++)i=m[se],z.writeUInt16(i);for(z.writeUInt16(0),fe=0,I=A.length;fe<I;fe++)i=A[fe],z.writeUInt16(i);for(ve=0,M=l.length;ve<M;ve++)o=l[ve],z.writeUInt16(o);for(Ee=0,D=L.length;Ee<D;Ee++)j=L[Ee],z.writeUInt16(j);for(Oe=0,V=h.length;Oe<V;Oe++)g=h[Oe],z.writeUInt16(g);return{charMap:n,subtable:z.data,maxGlyphID:_+1}}},e}(),M_=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,i,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)n=new u5(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var i,s;return n==null&&(n="macroman"),i=u5.encode(r,n),(s=new Co).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},t}(),ZC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),e7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),t7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="post",t.prototype.parse=function(r){var n,i,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var a;for(i=r.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)n=r.readByte(),s.push(this.names.push(r.readString(n)));return s;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=(function(){var o,l,u;for(u=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)u.push(r.readUInt32());return u}).call(this)}},t}(),r7=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},n7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="name",t.prototype.parse=function(r){var n,i,s,a,o,l,u,f,m,p,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),i=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(u={},a=m=0,p=i.length;m<p;a=++m)s=i[a],r.pos=s.offset,f=r.readString(s.length),o=new r7(f,s),u[h=s.nameID]==null&&(u[h]=[]),u[s.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t}(),i7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),s7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,i,s,a,o,l,u;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,m;for(m=[],n=f=0;0<=s?f<s:f>s;n=0<=s?++f:--f)m.push(r.readInt16());return m}(),this.widths=(function(){var f,m,p,h;for(h=[],f=0,m=(p=this.metrics).length;f<m;f++)a=p[f],h.push(a.advance);return h}).call(this),i=this.widths[this.widths.length-1],u=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)u.push(this.widths.push(i));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),B_=[].slice,a7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,i,s,a,o,l,u,f,m,p;return r in this.cache?this.cache[r]:(a=this.file.loca,n=this.file.contents,i=a.indexOf(r),(s=a.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,o=(l=new Co(n.read(s))).readShort(),f=l.readShort(),p=l.readShort(),u=l.readShort(),m=l.readShort(),this.cache[r]=o===-1?new l7(l,f,p,u,m):new o7(l,o,f,p,u,m),this.cache[r]))},t.prototype.encode=function(r,n,i){var s,a,o,l,u;for(o=[],a=[],l=0,u=n.length;l<u;l++)s=r[n[l]],a.push(o.length),s&&(o=o.concat(s.encode(i)));return a.push(o.length),{table:o,offsets:a}},t}(),o7=function(){function e(t,r,n,i,s,a){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=a,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),l7=function(){function e(t,r,n,i,s){var a,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Co(B_.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),c7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fs),t.prototype.tag="loca",t.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=2)a.push(2*r.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=4)a.push(r.readUInt32());return a}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<i.length;++o)if(i[o]=s,a<n.length&&n[a]==o){++a,i[o]=s;var l=this.offsets[o],u=this.offsets[o+1]-l;u>0&&(s+=u)}for(var f=new Array(4*i.length),m=0;m<i.length;++m)f[4*m+3]=255&i[m],f[4*m+2]=(65280&i[m])>>8,f[4*m+1]=(16711680&i[m])>>16,f[4*m]=(4278190080&i[m])>>24;return f},t}(),u7=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,a,o,l;for(i={},a=0,o=t.length;a<o;a++)i[s=t[a]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in l=this.glyphsFor(r))n=l[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,a,o,l,u,f,m,p,h,v,g,b,y;for(i in n=M_.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),h={0:0},y=n.charMap)h[(l=y[i]).old]=l.new;for(v in p=n.maxGlyphID,a)v in h||(h[v]=p++);return f=function(w){var _,j;for(_ in j={},w)j[w[_]]=_;return j}(h),m=Object.keys(f).sort(function(w,_){return w-_}),g=function(){var w,_,j;for(j=[],w=0,_=m.length;w<_;w++)o=m[w],j.push(f[o]);return j}(),s=this.font.glyf.encode(a,g,h),u=this.font.loca.encode(s.offsets,g),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},e}();mt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,a;if(Array.isArray(r))return"["+function(){var o,l,u;for(u=[],o=0,l=r.length;o<l;o++)n=r[o],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)a=r[i],s.push("/"+i+" "+t.convert(a));return s.push(">>"),s.join(`
`)}return""+r},t}();const f7=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:WC,AcroFormAppearance:ut,AcroFormButton:an,AcroFormCheckBox:Ff,AcroFormChoiceField:pl,AcroFormComboBox:xl,AcroFormEditBox:Pf,AcroFormListBox:gl,AcroFormPasswordField:Of,AcroFormPushButton:Lf,AcroFormRadioButton:vl,AcroFormTextField:So,GState:fd,ShadingPattern:so,TilingPattern:cl,default:mt,jsPDF:mt},Symbol.toStringTag,{value:"Module"}));var U_={exports:{}};const d7=nw(f7);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(n,i){e.exports=i(function(){try{return d7}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Xn<"u"?Xn:typeof window<"u"?window:typeof self<"u"?self:Xn,function(r){return function(){var n={172:function(o,l){var u=this&&this.__extends||function(){var p=function(h,v){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,b){g.__proto__=b}||function(g,b){for(var y in b)Object.prototype.hasOwnProperty.call(b,y)&&(g[y]=b[y])},p(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");p(h,v);function g(){this.constructor=h}h.prototype=v===null?Object.create(v):(g.prototype=v.prototype,new g)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.CellHookData=l.HookData=void 0;var f=function(){function p(h,v,g){this.table=v,this.pageNumber=v.pageNumber,this.pageCount=this.pageNumber,this.settings=v.settings,this.cursor=g,this.doc=h.getDocument()}return p}();l.HookData=f;var m=function(p){u(h,p);function h(v,g,b,y,w,_){var j=p.call(this,v,g,_)||this;return j.cell=b,j.row=y,j.column=w,j.section=y.section,j}return h}(f);l.CellHookData=m},340:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0});var f=u(4),m=u(136),p=u(744),h=u(776),v=u(664),g=u(972);function b(y){y.API.autoTable=function(){for(var w=[],_=0;_<arguments.length;_++)w[_]=arguments[_];var j;w.length===1?j=w[0]:(console.error("Use of deprecated autoTable initiation"),j=w[2]||{},j.columns=w[0],j.body=w[1]);var O=(0,h.parseInput)(this,j),L=(0,g.createTable)(this,O);return(0,v.drawTable)(this,L),this},y.API.lastAutoTable=!1,y.API.previousAutoTable=!1,y.API.autoTable.previous=!1,y.API.autoTableText=function(w,_,j,O){(0,m.default)(w,_,j,O,this)},y.API.autoTableSetDefaults=function(w){return p.DocHandler.setDefaults(w,this),this},y.autoTableSetDefaults=function(w,_){p.DocHandler.setDefaults(w,_)},y.API.autoTableHtmlToJson=function(w,_){var j;if(_===void 0&&(_=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var O=new p.DocHandler(this),L=(0,f.parseHtml)(O,w,window,_,!1),E=L.head,C=L.body,P=((j=E[0])===null||j===void 0?void 0:j.map(function(R){return R.content}))||[];return{columns:P,rows:C,data:C}},y.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var w=this.lastAutoTable;return w&&w.finalY?w.finalY:0},y.API.autoTableAddPageContent=function(w){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),y.API.autoTable.globalDefaults||(y.API.autoTable.globalDefaults={}),y.API.autoTable.globalDefaults.addPageContent=w,this},y.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}l.default=b},136:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function u(f,m,p,h,v){h=h||{};var g=1.15,b=v.internal.scaleFactor,y=v.internal.getFontSize()/b,w=v.getLineHeightFactor?v.getLineHeightFactor():g,_=y*w,j=/\r\n|\r|\n/g,O="",L=1;if((h.valign==="middle"||h.valign==="bottom"||h.halign==="center"||h.halign==="right")&&(O=typeof f=="string"?f.split(j):f,L=O.length||1),p+=y*(2-g),h.valign==="middle"?p-=L/2*_:h.valign==="bottom"&&(p-=L*_),h.halign==="center"||h.halign==="right"){var E=y;if(h.halign==="center"&&(E*=.5),O&&L>=1){for(var C=0;C<O.length;C++)v.text(O[C],m-v.getStringUnitWidth(O[C])*E,p),p+=_;return v}m-=v.getStringUnitWidth(f)*E}return h.halign==="justify"?v.text(f,m,p,{maxWidth:h.maxWidth||100,align:"justify"}):v.text(f,m,p),v}l.default=u},420:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.getPageAvailableWidth=l.parseSpacing=l.getFillStyle=l.addTableBorder=l.getStringWidth=void 0;function u(v,g,b){b.applyStyles(g,!0);var y=Array.isArray(v)?v:[v],w=y.map(function(_){return b.getTextWidth(_)}).reduce(function(_,j){return Math.max(_,j)},0);return w}l.getStringWidth=u;function f(v,g,b,y){var w=g.settings.tableLineWidth,_=g.settings.tableLineColor;v.applyStyles({lineWidth:w,lineColor:_});var j=m(w,!1);j&&v.rect(b.x,b.y,g.getWidth(v.pageSize().width),y.y-b.y,j)}l.addTableBorder=f;function m(v,g){var b=v>0,y=g||g===0;return b&&y?"DF":b?"S":y?"F":null}l.getFillStyle=m;function p(v,g){var b,y,w,_;if(v=v||g,Array.isArray(v)){if(v.length>=4)return{top:v[0],right:v[1],bottom:v[2],left:v[3]};if(v.length===3)return{top:v[0],right:v[1],bottom:v[2],left:v[1]};if(v.length===2)return{top:v[0],right:v[1],bottom:v[0],left:v[1]};v.length===1?v=v[0]:v=g}return typeof v=="object"?(typeof v.vertical=="number"&&(v.top=v.vertical,v.bottom=v.vertical),typeof v.horizontal=="number"&&(v.right=v.horizontal,v.left=v.horizontal),{left:(b=v.left)!==null&&b!==void 0?b:g,top:(y=v.top)!==null&&y!==void 0?y:g,right:(w=v.right)!==null&&w!==void 0?w:g,bottom:(_=v.bottom)!==null&&_!==void 0?_:g}):(typeof v!="number"&&(v=g),{top:v,right:v,bottom:v,left:v})}l.parseSpacing=p;function h(v,g){var b=p(g.settings.margin,0);return v.pageSize().width-(b.left+b.right)}l.getPageAvailableWidth=h},796:function(o,l){var u=this&&this.__extends||function(){var h=function(v,g){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,y){b.__proto__=y}||function(b,y){for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(b[w]=y[w])},h(v,g)};return function(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");h(v,g);function b(){this.constructor=v}v.prototype=g===null?Object.create(g):(b.prototype=g.prototype,new b)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.getTheme=l.defaultStyles=l.HtmlRowInput=void 0;var f=function(h){u(v,h);function v(g){var b=h.call(this)||this;return b._element=g,b}return v}(Array);l.HtmlRowInput=f;function m(h){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/h,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}l.defaultStyles=m;function p(h){var v={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return v[h]}l.getTheme=p},903:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseCss=void 0;var f=u(420);function m(b,y,w,_,j){var O={},L=1.3333333333333333,E=h(y,function(Y){return j.getComputedStyle(Y).backgroundColor});E!=null&&(O.fillColor=E);var C=h(y,function(Y){return j.getComputedStyle(Y).color});C!=null&&(O.textColor=C);var P=g(_,w);P&&(O.cellPadding=P);var R="borderTopColor",T=L*w,A=_.borderTopWidth;if(_.borderBottomWidth===A&&_.borderRightWidth===A&&_.borderLeftWidth===A){var q=(parseFloat(A)||0)/T;q&&(O.lineWidth=q)}else O.lineWidth={top:(parseFloat(_.borderTopWidth)||0)/T,right:(parseFloat(_.borderRightWidth)||0)/T,bottom:(parseFloat(_.borderBottomWidth)||0)/T,left:(parseFloat(_.borderLeftWidth)||0)/T},O.lineWidth.top||(O.lineWidth.right?R="borderRightColor":O.lineWidth.bottom?R="borderBottomColor":O.lineWidth.left&&(R="borderLeftColor"));var z=h(y,function(Y){return j.getComputedStyle(Y)[R]});z!=null&&(O.lineColor=z);var ne=["left","right","center","justify"];ne.indexOf(_.textAlign)!==-1&&(O.halign=_.textAlign),ne=["middle","bottom","top"],ne.indexOf(_.verticalAlign)!==-1&&(O.valign=_.verticalAlign);var U=parseInt(_.fontSize||"");isNaN(U)||(O.fontSize=U/L);var G=p(_);G&&(O.fontStyle=G);var B=(_.fontFamily||"").toLowerCase();return b.indexOf(B)!==-1&&(O.font=B),O}l.parseCss=m;function p(b){var y="";return(b.fontWeight==="bold"||b.fontWeight==="bolder"||parseInt(b.fontWeight)>=700)&&(y="bold"),(b.fontStyle==="italic"||b.fontStyle==="oblique")&&(y+="italic"),y}function h(b,y){var w=v(b,y);if(!w)return null;var _=w.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!_||!Array.isArray(_))return null;var j=[parseInt(_[1]),parseInt(_[2]),parseInt(_[3])],O=parseInt(_[4]);return O===0||isNaN(j[0])||isNaN(j[1])||isNaN(j[2])?null:j}function v(b,y){var w=y(b);return w==="rgba(0, 0, 0, 0)"||w==="transparent"||w==="initial"||w==="inherit"?b.parentElement==null?null:v(b.parentElement,y):w}function g(b,y){var w=[b.paddingTop,b.paddingRight,b.paddingBottom,b.paddingLeft],_=96/(72/y),j=(parseInt(b.lineHeight)-parseInt(b.fontSize))/y/2,O=w.map(function(E){return parseInt(E||"0")/_}),L=(0,f.parseSpacing)(O,0);return j>L.top&&(L.top=j),j>L.bottom&&(L.bottom=j),L}},744:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocHandler=void 0;var u={},f=function(){function m(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return m.setDefaults=function(p,h){h===void 0&&(h=null),h?h.__autoTableDocumentDefaults=p:u=p},m.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},m.prototype.applyStyles=function(p,h){var v,g,b;h===void 0&&(h=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var y=this.jsPDFDocument.internal.getFont(),w=y.fontStyle,_=y.fontName;if(p.font&&(_=p.font),p.fontStyle){w=p.fontStyle;var j=this.getFontList()[_];j&&j.indexOf(w)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(j[0]),w=j[0])}if(this.jsPDFDocument.setFont(_,w),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!h){var O=m.unifyColor(p.fillColor);O&&(v=this.jsPDFDocument).setFillColor.apply(v,O),O=m.unifyColor(p.textColor),O&&(g=this.jsPDFDocument).setTextColor.apply(g,O),O=m.unifyColor(p.lineColor),O&&(b=this.jsPDFDocument).setDrawColor.apply(b,O),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},m.prototype.splitTextToSize=function(p,h,v){return this.jsPDFDocument.splitTextToSize(p,h,v)},m.prototype.rect=function(p,h,v,g,b){return this.jsPDFDocument.rect(p,h,v,g,b)},m.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},m.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},m.prototype.getDocument=function(){return this.jsPDFDocument},m.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},m.prototype.addPage=function(){return this.jsPDFDocument.addPage()},m.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},m.prototype.getGlobalOptions=function(){return u||{}},m.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},m.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},m.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},m.prototype.getLineHeightFactor=function(){var p=this.jsPDFDocument;return p.getLineHeightFactor?p.getLineHeightFactor():1.15},m.prototype.getLineHeight=function(p){return p/this.scaleFactor()*this.getLineHeightFactor()},m.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},m}();l.DocHandler=f},4:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseHtml=void 0;var f=u(903),m=u(796);function p(g,b,y,w,_){var j,O;w===void 0&&(w=!1),_===void 0&&(_=!1);var L;typeof b=="string"?L=y.document.querySelector(b):L=b;var E=Object.keys(g.getFontList()),C=g.scaleFactor(),P=[],R=[],T=[];if(!L)return console.error("Html table could not be found with input: ",b),{head:P,body:R,foot:T};for(var A=0;A<L.rows.length;A++){var q=L.rows[A],z=(O=(j=q==null?void 0:q.parentElement)===null||j===void 0?void 0:j.tagName)===null||O===void 0?void 0:O.toLowerCase(),ne=h(E,C,y,q,w,_);ne&&(z==="thead"?P.push(ne):z==="tfoot"?T.push(ne):R.push(ne))}return{head:P,body:R,foot:T}}l.parseHtml=p;function h(g,b,y,w,_,j){for(var O=new m.HtmlRowInput(w),L=0;L<w.cells.length;L++){var E=w.cells[L],C=y.getComputedStyle(E);if(_||C.display!=="none"){var P=void 0;j&&(P=(0,f.parseCss)(g,E,b,C,y)),O.push({rowSpan:E.rowSpan,colSpan:E.colSpan,styles:P,_element:E,content:v(E)})}}var R=y.getComputedStyle(w);if(O.length>0&&(_||R.display!=="none"))return O}function v(g){var b=g.cloneNode(!0);return b.innerHTML=b.innerHTML.replace(/\n/g,"").replace(/ +/g," "),b.innerHTML=b.innerHTML.split(/<br.*?>/).map(function(y){return y.trim()}).join(`
`),b.innerText||b.textContent||""}},776:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseInput=void 0;var f=u(4),m=u(356),p=u(420),h=u(744),v=u(792);function g(L,E){var C=new h.DocHandler(L),P=C.getDocumentOptions(),R=C.getGlobalOptions();(0,v.default)(C,R,P,E);var T=(0,m.assign)({},R,P,E),A;typeof window<"u"&&(A=window);var q=b(R,P,E),z=y(R,P,E),ne=w(C,T),U=j(C,T,A);return{id:E.tableId,content:U,hooks:z,styles:q,settings:ne}}l.parseInput=g;function b(L,E,C){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},R=function(z){if(z==="columnStyles"){var ne=L[z],U=E[z],G=C[z];P.columnStyles=(0,m.assign)({},ne,U,G)}else{var B=[L,E,C],Y=B.map(function(re){return re[z]||{}});P[z]=(0,m.assign)({},Y[0],Y[1],Y[2])}},T=0,A=Object.keys(P);T<A.length;T++){var q=A[T];R(q)}return P}function y(L,E,C){for(var P=[L,E,C],R={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},T=0,A=P;T<A.length;T++){var q=A[T];q.didParseCell&&R.didParseCell.push(q.didParseCell),q.willDrawCell&&R.willDrawCell.push(q.willDrawCell),q.didDrawCell&&R.didDrawCell.push(q.didDrawCell),q.willDrawPage&&R.willDrawPage.push(q.willDrawPage),q.didDrawPage&&R.didDrawPage.push(q.didDrawPage)}return R}function w(L,E){var C,P,R,T,A,q,z,ne,U,G,B,Y,re=(0,p.parseSpacing)(E.margin,40/L.scaleFactor()),he=(C=_(L,E.startY))!==null&&C!==void 0?C:re.top,k;E.showFoot===!0?k="everyPage":E.showFoot===!1?k="never":k=(P=E.showFoot)!==null&&P!==void 0?P:"everyPage";var I;E.showHead===!0?I="everyPage":E.showHead===!1?I="never":I=(R=E.showHead)!==null&&R!==void 0?R:"everyPage";var M=(T=E.useCss)!==null&&T!==void 0?T:!1,D=E.theme||(M?"plain":"striped"),V=!!E.horizontalPageBreak,se=(A=E.horizontalPageBreakRepeat)!==null&&A!==void 0?A:null;return{includeHiddenHtml:(q=E.includeHiddenHtml)!==null&&q!==void 0?q:!1,useCss:M,theme:D,startY:he,margin:re,pageBreak:(z=E.pageBreak)!==null&&z!==void 0?z:"auto",rowPageBreak:(ne=E.rowPageBreak)!==null&&ne!==void 0?ne:"auto",tableWidth:(U=E.tableWidth)!==null&&U!==void 0?U:"auto",showHead:I,showFoot:k,tableLineWidth:(G=E.tableLineWidth)!==null&&G!==void 0?G:0,tableLineColor:(B=E.tableLineColor)!==null&&B!==void 0?B:200,horizontalPageBreak:V,horizontalPageBreakRepeat:se,horizontalPageBreakBehaviour:(Y=E.horizontalPageBreakBehaviour)!==null&&Y!==void 0?Y:"afterAllRows"}}function _(L,E){var C=L.getLastAutoTable(),P=L.scaleFactor(),R=L.pageNumber(),T=!1;if(C&&C.startPageNumber){var A=C.startPageNumber+C.pageNumber-1;T=A===R}return typeof E=="number"?E:(E==null||E===!1)&&T&&(C==null?void 0:C.finalY)!=null?C.finalY+20/P:null}function j(L,E,C){var P=E.head||[],R=E.body||[],T=E.foot||[];if(E.html){var A=E.includeHiddenHtml;if(C){var q=(0,f.parseHtml)(L,E.html,C,A,E.useCss)||{};P=q.head||P,R=q.body||P,T=q.foot||P}else console.error("Cannot parse html in non browser environment")}var z=E.columns||O(P,R,T);return{columns:z,head:P,body:R,foot:T}}function O(L,E,C){var P=L[0]||E[0]||C[0]||[],R=[];return Object.keys(P).filter(function(T){return T!=="_element"}).forEach(function(T){var A=1,q;Array.isArray(P)?q=P[parseInt(T)]:q=P[T],typeof q=="object"&&!Array.isArray(q)&&(A=(q==null?void 0:q.colSpan)||1);for(var z=0;z<A;z++){var ne=void 0;Array.isArray(P)?ne=R.length:ne=T+(z>0?"_".concat(z):"");var U={dataKey:ne};R.push(U)}}),R}},792:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function u(m,p,h,v){for(var g=function(_){_&&typeof _!="object"&&console.error("The options parameter should be of type object, is: "+typeof _),typeof _.extendWidth<"u"&&(_.tableWidth=_.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof _.margins<"u"&&(typeof _.margin>"u"&&(_.margin=_.margins),console.error("Use of deprecated option: margins, use margin instead.")),_.startY&&typeof _.startY!="number"&&(console.error("Invalid value for startY option",_.startY),delete _.startY),!_.didDrawPage&&(_.afterPageContent||_.beforePageContent||_.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),_.didDrawPage=function(T){m.applyStyles(m.userStyles),_.beforePageContent&&_.beforePageContent(T),m.applyStyles(m.userStyles),_.afterPageContent&&_.afterPageContent(T),m.applyStyles(m.userStyles),_.afterPageAdd&&T.pageNumber>1&&T.afterPageAdd(T),m.applyStyles(m.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(T){_[T]&&console.error('The "'.concat(T,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(T){var A=T[0],q=T[1];_[q]&&(console.error("Use of deprecated option ".concat(q,". Use ").concat(A," instead")),_[A]=_[q])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(T){var A=typeof T=="string"?T:T[0],q=typeof T=="string"?T:T[1];typeof _[A]<"u"&&(typeof _.styles[q]>"u"&&(_.styles[q]=_[A]),console.error("Use of deprecated option: "+A+", use the style "+q+" instead."))});for(var j=0,O=["styles","bodyStyles","headStyles","footStyles"];j<O.length;j++){var L=O[j];f(_[L]||{})}for(var E=_.columnStyles||{},C=0,P=Object.keys(E);C<P.length;C++){var R=P[C];f(E[R]||{})}},b=0,y=[p,h,v];b<y.length;b++){var w=y[b];g(w)}}l.default=u;function f(m){m.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),m.minCellHeight||(m.minCellHeight=m.rowHeight)):m.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),m.cellWidth||(m.cellWidth=m.columnWidth))}},260:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.Column=l.Cell=l.Row=l.Table=void 0;var f=u(796),m=u(172),p=u(420),h=function(){function y(w,_){this.pageNumber=1,this.pageCount=1,this.id=w.id,this.settings=w.settings,this.styles=w.styles,this.hooks=w.hooks,this.columns=_.columns,this.head=_.head,this.body=_.body,this.foot=_.foot}return y.prototype.getHeadHeight=function(w){return this.head.reduce(function(_,j){return _+j.getMaxCellHeight(w)},0)},y.prototype.getFootHeight=function(w){return this.foot.reduce(function(_,j){return _+j.getMaxCellHeight(w)},0)},y.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},y.prototype.callCellHooks=function(w,_,j,O,L,E){for(var C=0,P=_;C<P.length;C++){var R=P[C],T=new m.CellHookData(w,this,j,O,L,E),A=R(T)===!1;if(j.text=Array.isArray(j.text)?j.text:[j.text],A)return!1}return!0},y.prototype.callEndPageHooks=function(w,_){w.applyStyles(w.userStyles);for(var j=0,O=this.hooks.didDrawPage;j<O.length;j++){var L=O[j];L(new m.HookData(w,this,_))}},y.prototype.callWillDrawPageHooks=function(w,_){for(var j=0,O=this.hooks.willDrawPage;j<O.length;j++){var L=O[j];L(new m.HookData(w,this,_))}},y.prototype.getWidth=function(w){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var _=this.columns.reduce(function(O,L){return O+L.wrappedWidth},0);return _}else{var j=this.settings.margin;return w-j.left-j.right}},y}();l.Table=h;var v=function(){function y(w,_,j,O,L){L===void 0&&(L=!1),this.height=0,this.raw=w,w instanceof f.HtmlRowInput&&(this.raw=w._element,this.element=w._element),this.index=_,this.section=j,this.cells=O,this.spansMultiplePages=L}return y.prototype.getMaxCellHeight=function(w){var _=this;return w.reduce(function(j,O){var L;return Math.max(j,((L=_.cells[O.index])===null||L===void 0?void 0:L.height)||0)},0)},y.prototype.hasRowSpan=function(w){var _=this;return w.filter(function(j){var O=_.cells[j.index];return O?O.rowSpan>1:!1}).length>0},y.prototype.canEntireRowFit=function(w,_){return this.getMaxCellHeight(_)<=w},y.prototype.getMinimumRowHeight=function(w,_){var j=this;return w.reduce(function(O,L){var E=j.cells[L.index];if(!E)return 0;var C=_.getLineHeight(E.styles.fontSize),P=E.padding("vertical"),R=P+C;return R>O?R:O},0)},y}();l.Row=v;var g=function(){function y(w,_,j){var O,L;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=_,this.section=j,this.raw=w;var E=w;w!=null&&typeof w=="object"&&!Array.isArray(w)?(this.rowSpan=w.rowSpan||1,this.colSpan=w.colSpan||1,E=(L=(O=w.content)!==null&&O!==void 0?O:w.title)!==null&&L!==void 0?L:w,w._element&&(this.raw=w._element)):(this.rowSpan=1,this.colSpan=1);var C=E!=null?""+E:"",P=/\r\n|\r|\n/g;this.text=C.split(P)}return y.prototype.getTextPos=function(){var w;if(this.styles.valign==="top")w=this.y+this.padding("top");else if(this.styles.valign==="bottom")w=this.y+this.height-this.padding("bottom");else{var _=this.height-this.padding("vertical");w=this.y+_/2+this.padding("top")}var j;if(this.styles.halign==="right")j=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var O=this.width-this.padding("horizontal");j=this.x+O/2+this.padding("left")}else j=this.x+this.padding("left");return{x:j,y:w}},y.prototype.getContentHeight=function(w,_){_===void 0&&(_=1.15);var j=Array.isArray(this.text)?this.text.length:1,O=this.styles.fontSize/w*_,L=j*O+this.padding("vertical");return Math.max(L,this.styles.minCellHeight)},y.prototype.padding=function(w){var _=(0,p.parseSpacing)(this.styles.cellPadding,0);return w==="vertical"?_.top+_.bottom:w==="horizontal"?_.left+_.right:_[w]},y}();l.Cell=g;var b=function(){function y(w,_,j){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=w,this.raw=_,this.index=j}return y.prototype.getMaxCustomCellWidth=function(w){for(var _=0,j=0,O=w.allRows();j<O.length;j++){var L=O[j],E=L.cells[this.index];E&&typeof E.styles.cellWidth=="number"&&(_=Math.max(_,E.styles.cellWidth))}return _},y}();l.Column=b},356:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.assign=void 0;function u(f,m,p,h,v){if(f==null)throw new TypeError("Cannot convert undefined or null to object");for(var g=Object(f),b=1;b<arguments.length;b++){var y=arguments[b];if(y!=null)for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(g[w]=y[w])}return g}l.assign=u},972:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.createTable=void 0;var f=u(744),m=u(260),p=u(324),h=u(796),v=u(356);function g(L,E){var C=new f.DocHandler(L),P=b(E,C.scaleFactor()),R=new m.Table(E,P);return(0,p.calculateWidths)(C,R),C.applyStyles(C.userStyles),R}l.createTable=g;function b(L,E){var C=L.content,P=j(C.columns);if(C.head.length===0){var R=w(P,"head");R&&C.head.push(R)}if(C.foot.length===0){var R=w(P,"foot");R&&C.foot.push(R)}var T=L.settings.theme,A=L.styles;return{columns:P,head:y("head",C.head,P,A,T,E),body:y("body",C.body,P,A,T,E),foot:y("foot",C.foot,P,A,T,E)}}function y(L,E,C,P,R,T){var A={},q=E.map(function(z,ne){for(var U=0,G={},B=0,Y=0,re=0,he=C;re<he.length;re++){var k=he[re];if(A[k.index]==null||A[k.index].left===0)if(Y===0){var I=void 0;Array.isArray(z)?I=z[k.index-B-U]:I=z[k.dataKey];var M={};typeof I=="object"&&!Array.isArray(I)&&(M=(I==null?void 0:I.styles)||{});var D=O(L,k,ne,R,P,T,M),V=new m.Cell(I,D,L);G[k.dataKey]=V,G[k.index]=V,Y=V.colSpan-1,A[k.index]={left:V.rowSpan-1,times:Y}}else Y--,B++;else A[k.index].left--,Y=A[k.index].times,U++}return new m.Row(z,ne,L,G)});return q}function w(L,E){var C={};return L.forEach(function(P){if(P.raw!=null){var R=_(E,P.raw);R!=null&&(C[P.dataKey]=R)}}),Object.keys(C).length>0?C:null}function _(L,E){if(L==="head"){if(typeof E=="object")return E.header||E.title||null;if(typeof E=="string"||typeof E=="number")return E}else if(L==="foot"&&typeof E=="object")return E.footer;return null}function j(L){return L.map(function(E,C){var P,R,T;return typeof E=="object"?T=(R=(P=E.dataKey)!==null&&P!==void 0?P:E.key)!==null&&R!==void 0?R:C:T=C,new m.Column(T,E,C)})}function O(L,E,C,P,R,T,A){var q=(0,h.getTheme)(P),z;L==="head"?z=R.headStyles:L==="body"?z=R.bodyStyles:L==="foot"&&(z=R.footStyles);var ne=(0,v.assign)({},q.table,q[L],R.styles,z),U=R.columnStyles[E.dataKey]||R.columnStyles[E.index]||{},G=L==="body"?U:{},B=L==="body"&&C%2===0?(0,v.assign)({},q.alternateRow,R.alternateRowStyles):{},Y=(0,h.defaultStyles)(T),re=(0,v.assign)({},Y,ne,B,G);return(0,v.assign)(re,A)}},664:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.addPage=l.drawTable=void 0;var f=u(420),m=u(260),p=u(744),h=u(356),v=u(136),g=u(224);function b(U,G){var B=G.settings,Y=B.startY,re=B.margin,he={x:re.left,y:Y},k=G.getHeadHeight(G.columns)+G.getFootHeight(G.columns),I=Y+re.bottom+k;if(B.pageBreak==="avoid"){var M=G.body,D=M.reduce(function(fe,de){return fe+de.height},0);I+=D}var V=new p.DocHandler(U);(B.pageBreak==="always"||B.startY!=null&&I>V.pageSize().height)&&(ne(V),he.y=re.top),G.callWillDrawPageHooks(V,he);var se=(0,h.assign)({},he);G.startPageNumber=V.pageNumber(),B.horizontalPageBreak?y(V,G,se,he):(V.applyStyles(V.userStyles),(B.showHead==="firstPage"||B.showHead==="everyPage")&&G.head.forEach(function(fe){return R(V,G,fe,he,G.columns)}),V.applyStyles(V.userStyles),G.body.forEach(function(fe,de){var ve=de===G.body.length-1;P(V,G,fe,ve,se,he,G.columns)}),V.applyStyles(V.userStyles),(B.showFoot==="lastPage"||B.showFoot==="everyPage")&&G.foot.forEach(function(fe){return R(V,G,fe,he,G.columns)})),(0,f.addTableBorder)(V,G,se,he),G.callEndPageHooks(V,he),G.finalY=he.y,U.lastAutoTable=G,U.previousAutoTable=G,U.autoTable&&(U.autoTable.previous=G),V.applyStyles(V.userStyles)}l.drawTable=b;function y(U,G,B,Y){var re=(0,g.calculateAllColumnsCanFitInPage)(U,G),he=G.settings;if(he.horizontalPageBreakBehaviour==="afterAllRows")re.forEach(function(D,V){U.applyStyles(U.userStyles),V>0?z(U,G,B,Y,D.columns,!0):w(U,G,Y,D.columns),_(U,G,B,Y,D.columns),O(U,G,Y,D.columns)});else for(var k=-1,I=re[0],M=function(){var D=k;if(I){U.applyStyles(U.userStyles);var V=I.columns;k>=0?z(U,G,B,Y,V,!0):w(U,G,Y,V),D=j(U,G,k+1,Y,V),O(U,G,Y,V)}var se=D-k;re.slice(1).forEach(function(fe){U.applyStyles(U.userStyles),z(U,G,B,Y,fe.columns,!0),j(U,G,k+1,Y,fe.columns,se),O(U,G,Y,fe.columns)}),k=D};k<G.body.length-1;)M()}function w(U,G,B,Y){var re=G.settings;U.applyStyles(U.userStyles),(re.showHead==="firstPage"||re.showHead==="everyPage")&&G.head.forEach(function(he){return R(U,G,he,B,Y)})}function _(U,G,B,Y,re){U.applyStyles(U.userStyles),G.body.forEach(function(he,k){var I=k===G.body.length-1;P(U,G,he,I,B,Y,re)})}function j(U,G,B,Y,re,he){U.applyStyles(U.userStyles),he=he??G.body.length;var k=Math.min(B+he,G.body.length),I=-1;return G.body.slice(B,k).forEach(function(M,D){var V=B+D===G.body.length-1,se=q(U,G,V,Y);M.canEntireRowFit(se,re)&&(R(U,G,M,Y,re),I=B+D)}),I}function O(U,G,B,Y){var re=G.settings;U.applyStyles(U.userStyles),(re.showFoot==="lastPage"||re.showFoot==="everyPage")&&G.foot.forEach(function(he){return R(U,G,he,B,Y)})}function L(U,G,B){var Y=B.getLineHeight(U.styles.fontSize),re=U.padding("vertical"),he=Math.floor((G-re)/Y);return Math.max(0,he)}function E(U,G,B,Y){var re={};U.spansMultiplePages=!0,U.height=0;for(var he=0,k=0,I=B.columns;k<I.length;k++){var M=I[k],D=U.cells[M.index];if(D){Array.isArray(D.text)||(D.text=[D.text]);var V=new m.Cell(D.raw,D.styles,D.section);V=(0,h.assign)(V,D),V.text=[];var se=L(D,G,Y);D.text.length>se&&(V.text=D.text.splice(se,D.text.length));var fe=Y.scaleFactor(),de=Y.getLineHeightFactor();D.contentHeight=D.getContentHeight(fe,de),D.contentHeight>=G&&(D.contentHeight=G,V.styles.minCellHeight-=G),D.contentHeight>U.height&&(U.height=D.contentHeight),V.contentHeight=V.getContentHeight(fe,de),V.contentHeight>he&&(he=V.contentHeight),re[M.index]=V}}var ve=new m.Row(U.raw,-1,U.section,re,!0);ve.height=he;for(var Ee=0,Oe=B.columns;Ee<Oe.length;Ee++){var M=Oe[Ee],V=ve.cells[M.index];V&&(V.height=ve.height);var D=U.cells[M.index];D&&(D.height=U.height)}return ve}function C(U,G,B,Y){var re=U.pageSize().height,he=Y.settings.margin,k=he.top+he.bottom,I=re-k;G.section==="body"&&(I-=Y.getHeadHeight(Y.columns)+Y.getFootHeight(Y.columns));var M=G.getMinimumRowHeight(Y.columns,U),D=M<B;if(M>I)return console.error("Will not be able to print row ".concat(G.index," correctly since it's minimum height is larger than page height")),!0;if(!D)return!1;var V=G.hasRowSpan(Y.columns),se=G.getMaxCellHeight(Y.columns)>I;return se?(V&&console.error("The content of row ".concat(G.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(V||Y.settings.rowPageBreak==="avoid")}function P(U,G,B,Y,re,he,k){var I=q(U,G,Y,he);if(B.canEntireRowFit(I,k))R(U,G,B,he,k);else if(C(U,B,I,G)){var M=E(B,I,G,U);R(U,G,B,he,k),z(U,G,re,he,k),P(U,G,M,Y,re,he,k)}else z(U,G,re,he,k),P(U,G,B,Y,re,he,k)}function R(U,G,B,Y,re){Y.x=G.settings.margin.left;for(var he=0,k=re;he<k.length;he++){var I=k[he],M=B.cells[I.index];if(!M){Y.x+=I.width;continue}U.applyStyles(M.styles),M.x=Y.x,M.y=Y.y;var D=G.callCellHooks(U,G.hooks.willDrawCell,M,B,I,Y);if(D===!1){Y.x+=I.width;continue}T(U,M,Y);var V=M.getTextPos();(0,v.default)(M.text,V.x,V.y,{halign:M.styles.halign,valign:M.styles.valign,maxWidth:Math.ceil(M.width-M.padding("left")-M.padding("right"))},U.getDocument()),G.callCellHooks(U,G.hooks.didDrawCell,M,B,I,Y),Y.x+=I.width}Y.y+=B.height}function T(U,G,B){var Y=G.styles;if(U.getDocument().setFillColor(U.getDocument().getFillColor()),typeof Y.lineWidth=="number"){var re=(0,f.getFillStyle)(Y.lineWidth,Y.fillColor);re&&U.rect(G.x,B.y,G.width,G.height,re)}else typeof Y.lineWidth=="object"&&(Y.fillColor&&U.rect(G.x,B.y,G.width,G.height,"F"),A(U,G,B,Y.lineWidth))}function A(U,G,B,Y){var re,he,k,I;Y.top&&(re=B.x,he=B.y,k=B.x+G.width,I=B.y,Y.right&&(k+=.5*Y.right),Y.left&&(re-=.5*Y.left),M(Y.top,re,he,k,I)),Y.bottom&&(re=B.x,he=B.y+G.height,k=B.x+G.width,I=B.y+G.height,Y.right&&(k+=.5*Y.right),Y.left&&(re-=.5*Y.left),M(Y.bottom,re,he,k,I)),Y.left&&(re=B.x,he=B.y,k=B.x,I=B.y+G.height,Y.top&&(he-=.5*Y.top),Y.bottom&&(I+=.5*Y.bottom),M(Y.left,re,he,k,I)),Y.right&&(re=B.x+G.width,he=B.y,k=B.x+G.width,I=B.y+G.height,Y.top&&(he-=.5*Y.top),Y.bottom&&(I+=.5*Y.bottom),M(Y.right,re,he,k,I));function M(D,V,se,fe,de){U.getDocument().setLineWidth(D),U.getDocument().line(V,se,fe,de,"S")}}function q(U,G,B,Y){var re=G.settings.margin.bottom,he=G.settings.showFoot;return(he==="everyPage"||he==="lastPage"&&B)&&(re+=G.getFootHeight(G.columns)),U.pageSize().height-Y.y-re}function z(U,G,B,Y,re,he){re===void 0&&(re=[]),he===void 0&&(he=!1),U.applyStyles(U.userStyles),G.settings.showFoot==="everyPage"&&!he&&G.foot.forEach(function(I){return R(U,G,I,Y,re)}),G.callEndPageHooks(U,Y);var k=G.settings.margin;(0,f.addTableBorder)(U,G,B,Y),ne(U),G.pageNumber++,G.pageCount++,Y.x=k.left,Y.y=k.top,B.y=k.top,G.callWillDrawPageHooks(U,Y),G.settings.showHead==="everyPage"&&(G.head.forEach(function(I){return R(U,G,I,Y,re)}),U.applyStyles(U.userStyles))}l.addPage=z;function ne(U){var G=U.pageNumber();U.setPage(G+1);var B=U.pageNumber();return B===G?(U.addPage(),!0):!1}},224:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.calculateAllColumnsCanFitInPage=void 0;var f=u(420);function m(h,v,g){var b;g===void 0&&(g={});var y=(0,f.getPageAvailableWidth)(h,v),w=new Map,_=[],j=[],O=[];v.settings.horizontalPageBreakRepeat,Array.isArray(v.settings.horizontalPageBreakRepeat)?O=v.settings.horizontalPageBreakRepeat:(typeof v.settings.horizontalPageBreakRepeat=="string"||typeof v.settings.horizontalPageBreakRepeat=="number")&&(O=[v.settings.horizontalPageBreakRepeat]),O.forEach(function(P){var R=v.columns.find(function(T){return T.dataKey===P||T.index===P});R&&!w.has(R.index)&&(w.set(R.index,!0),_.push(R.index),j.push(v.columns[R.index]),y-=R.wrappedWidth)});for(var L=!0,E=(b=g==null?void 0:g.start)!==null&&b!==void 0?b:0;E<v.columns.length;){if(w.has(E)){E++;continue}var C=v.columns[E].wrappedWidth;if(L||y>=C)L=!1,_.push(E),j.push(v.columns[E]),y-=C;else break;E++}return{colIndexes:_,columns:j,lastIndex:E-1}}function p(h,v){for(var g=[],b=0;b<v.columns.length;b++){var y=m(h,v,{start:b});y.columns.length&&(g.push(y),b=y.lastIndex)}return g}l.calculateAllColumnsCanFitInPage=p},324:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.ellipsize=l.resizeColumns=l.calculateWidths=void 0;var f=u(420);function m(_,j){p(_,j);var O=[],L=0;j.columns.forEach(function(C){var P=C.getMaxCustomCellWidth(j);P?C.width=P:(C.width=C.wrappedWidth,O.push(C)),L+=C.width});var E=j.getWidth(_.pageSize().width)-L;E&&(E=h(O,E,function(C){return Math.max(C.minReadableWidth,C.minWidth)})),E&&(E=h(O,E,function(C){return C.minWidth})),E=Math.abs(E),!j.settings.horizontalPageBreak&&E>.1/_.scaleFactor()&&(E=E<1?E:Math.round(E),console.warn("Of the table content, ".concat(E," units width could not fit page"))),g(j),b(j,_),v(j)}l.calculateWidths=m;function p(_,j){var O=_.scaleFactor(),L=j.settings.horizontalPageBreak,E=(0,f.getPageAvailableWidth)(_,j);j.allRows().forEach(function(C){for(var P=0,R=j.columns;P<R.length;P++){var T=R[P],A=C.cells[T.index];if(A){var q=j.hooks.didParseCell;j.callCellHooks(_,q,A,C,T,null);var z=A.padding("horizontal");A.contentWidth=(0,f.getStringWidth)(A.text,A.styles,_)+z;var ne=(0,f.getStringWidth)(A.text.join(" ").split(/[^\S\u00A0]+/),A.styles,_);if(A.minReadableWidth=ne+A.padding("horizontal"),typeof A.styles.cellWidth=="number")A.minWidth=A.styles.cellWidth,A.wrappedWidth=A.styles.cellWidth;else if(A.styles.cellWidth==="wrap"||L===!0)A.contentWidth>E?(A.minWidth=E,A.wrappedWidth=E):(A.minWidth=A.contentWidth,A.wrappedWidth=A.contentWidth);else{var U=10/O;A.minWidth=A.styles.minCellWidth||U,A.wrappedWidth=A.contentWidth,A.minWidth>A.wrappedWidth&&(A.wrappedWidth=A.minWidth)}}}}),j.allRows().forEach(function(C){for(var P=0,R=j.columns;P<R.length;P++){var T=R[P],A=C.cells[T.index];if(A&&A.colSpan===1)T.wrappedWidth=Math.max(T.wrappedWidth,A.wrappedWidth),T.minWidth=Math.max(T.minWidth,A.minWidth),T.minReadableWidth=Math.max(T.minReadableWidth,A.minReadableWidth);else{var q=j.styles.columnStyles[T.dataKey]||j.styles.columnStyles[T.index]||{},z=q.cellWidth||q.minCellWidth;z&&typeof z=="number"&&(T.minWidth=z,T.wrappedWidth=z)}A&&(A.colSpan>1&&!T.minWidth&&(T.minWidth=A.minWidth),A.colSpan>1&&!T.wrappedWidth&&(T.wrappedWidth=A.minWidth))}})}function h(_,j,O){for(var L=j,E=_.reduce(function(U,G){return U+G.wrappedWidth},0),C=0;C<_.length;C++){var P=_[C],R=P.wrappedWidth/E,T=L*R,A=P.width+T,q=O(P),z=A<q?q:A;j-=z-P.width,P.width=z}if(j=Math.round(j*1e10)/1e10,j){var ne=_.filter(function(U){return j<0?U.width>O(U):!0});ne.length&&(j=h(ne,j,O))}return j}l.resizeColumns=h;function v(_){for(var j={},O=1,L=_.allRows(),E=0;E<L.length;E++)for(var C=L[E],P=0,R=_.columns;P<R.length;P++){var T=R[P],A=j[T.index];if(O>1)O--,delete C.cells[T.index];else if(A)A.cell.height+=C.height,O=A.cell.colSpan,delete C.cells[T.index],A.left--,A.left<=1&&delete j[T.index];else{var q=C.cells[T.index];if(!q)continue;if(q.height=C.height,q.rowSpan>1){var z=L.length-E,ne=q.rowSpan>z?z:q.rowSpan;j[T.index]={cell:q,left:ne,row:C}}}}}function g(_){for(var j=_.allRows(),O=0;O<j.length;O++)for(var L=j[O],E=null,C=0,P=0,R=0;R<_.columns.length;R++){var T=_.columns[R];if(P-=1,P>1&&_.columns[R+1])C+=T.width,delete L.cells[T.index];else if(E){var A=E;delete L.cells[T.index],E=null,A.width=T.width+C}else{var A=L.cells[T.index];if(!A)continue;if(P=A.colSpan,C=0,A.colSpan>1){E=A,C+=T.width;continue}A.width=T.width+C}}}function b(_,j){for(var O={count:0,height:0},L=0,E=_.allRows();L<E.length;L++){for(var C=E[L],P=0,R=_.columns;P<R.length;P++){var T=R[P],A=C.cells[T.index];if(A){j.applyStyles(A.styles,!0);var q=A.width-A.padding("horizontal");if(A.styles.overflow==="linebreak")A.text=j.splitTextToSize(A.text,q+1/j.scaleFactor(),{fontSize:A.styles.fontSize});else if(A.styles.overflow==="ellipsize")A.text=y(A.text,q,A.styles,j,"...");else if(A.styles.overflow==="hidden")A.text=y(A.text,q,A.styles,j,"");else if(typeof A.styles.overflow=="function"){var z=A.styles.overflow(A.text,q);typeof z=="string"?A.text=[z]:A.text=z}A.contentHeight=A.getContentHeight(j.scaleFactor(),j.getLineHeightFactor());var ne=A.contentHeight/A.rowSpan;A.rowSpan>1&&O.count*O.height<ne*A.rowSpan?O={height:ne,count:A.rowSpan}:O&&O.count>0&&O.height>ne&&(ne=O.height),ne>C.height&&(C.height=ne)}}O.count--}}function y(_,j,O,L,E){return _.map(function(C){return w(C,j,O,L,E)})}l.ellipsize=y;function w(_,j,O,L,E){var C=1e4*L.scaleFactor();if(j=Math.ceil(j*C)/C,j>=(0,f.getStringWidth)(_,O,L))return _;for(;j<(0,f.getStringWidth)(_+E,O,L)&&!(_.length<=1);)_=_.substring(0,_.length-1);return _.trim()+E}},964:function(o){if(typeof r>"u"){var l=new Error("Cannot find module 'undefined'");throw l.code="MODULE_NOT_FOUND",l}o.exports=r}},i={};function s(o){var l=i[o];if(l!==void 0)return l.exports;var u=i[o]={exports:{}};return n[o].call(u.exports,u,u.exports,s),u.exports}var a={};return function(){var o=a;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var l=s(340),u=s(776),f=s(664),m=s(972),p=s(260);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return p.Table}});var h=s(172);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return h.CellHookData}});var v=s(260);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return v.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return v.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return v.Row}});function g(j){(0,l.default)(j)}o.applyPlugin=g;function b(j,O){var L=(0,u.parseInput)(j,O),E=(0,m.createTable)(j,L);(0,f.drawTable)(j,E)}function y(j,O){var L=(0,u.parseInput)(j,O);return(0,m.createTable)(j,L)}o.__createTable=y;function w(j,O){(0,f.drawTable)(j,O)}o.__drawTable=w;try{var _=s(964);_.jsPDF&&(_=_.jsPDF),g(_)}catch{}o.default=b}(),a}()})})(U_);var h7=U_.exports;const gf=Xg(h7);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var q0={};q0.version="0.18.5";var z_=1252,m7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],W_=function(e){m7.indexOf(e)!=-1&&(z_=e)};function p7(){W_(1252)}var dd=function(e){W_(e)};function g7(){dd(1200),p7()}var Gh=function(t){return String.fromCharCode(t)},f5=function(t){return String.fromCharCode(t)},d5,uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hd(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),a=(r&3)<<4|n>>4,i=e.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=uo.charAt(s)+uo.charAt(a)+uo.charAt(o)+uo.charAt(l);return t}function Aa(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=uo.indexOf(e.charAt(u++)),a=uo.indexOf(e.charAt(u++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=uo.indexOf(e.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=uo.indexOf(e.charAt(u++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function jl(e){return Vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function h5(e){return Vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ks=function(t){return Vt?Pa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Im(e){if(typeof ArrayBuffer>"u")return ks(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ad(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function x7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Nn=Vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Pa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function v7(e){for(var t=[],r=0,n=e.length+250,i=jl(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=jl(65535),n=65530)}return t.push(i.slice(0,r)),Nn(t)}var Df=/\u0000/g,Yh=/[\u0001-\u0006]/g;function $c(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function js(e,t){var r=""+e;return r.length>=t?r:Lr("0",t-r.length)+r}function lx(e,t){var r=""+e;return r.length>=t?r:Lr(" ",t-r.length)+r}function V0(e,t){var r=""+e;return r.length>=t?r:r+Lr(" ",t-r.length)}function y7(e,t){var r=""+Math.round(e);return r.length>=t?r:Lr("0",t-r.length)+r}function w7(e,t){var r=""+e;return r.length>=t?r:Lr("0",t-r.length)+r}var m5=Math.pow(2,32);function gc(e,t){if(e>m5||e<-m5)return y7(e,t);var r=Math.round(e);return w7(r,t)}function G0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var p5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],x1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function b7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Or={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},g5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Y0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,u=0,f=0,m=Math.floor(i);u<t&&(m=Math.floor(i),o=m*a+s,f=m*u+l,!(i-m<5e-8));)i=1/(i-m),s=a,a=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function Kh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=T7(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var H_=new Date(1899,11,31,0,0,0),S7=H_.getTime(),N7=new Date(1900,2,1,0,0,0);function $_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=N7&&(r+=24*60*60*1e3),(r-(S7+(e.getTimezoneOffset()-H_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function cx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function k7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function E7(e){var t=e<0?12:11,r=cx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function j7(e){var t=cx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function A7(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=E7(e):t===10?r=e.toFixed(10).substr(0,12):r=j7(e),cx(k7(r.toUpperCase()))}function Vg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):A7(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Po(14,$_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function T7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function C7(e,t,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return x1[r.m-1][1];case 5:return x1[r.m-1][0];default:return x1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return p5[r.q][0];default:return p5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?js(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=js(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?js(l,u):"";return f}function fo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var q_=/%/g;function P7(e,t,r){var n=t.replace(q_,""),i=t.length-n.length;return wa(e,n,r*Math.pow(10,2*i))+Lr("%",i)}function L7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function V_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+V_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var G_=/# (\?+)( ?)\/( ?)(\d+)/;function F7(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Lr(" ",e[1].length+1+e[4].length):lx(a,e[1].length)+e[2]+"/"+e[3]+js(o,e[4].length))}function O7(e,t,r){return r+(t===0?"":""+t)+Lr(" ",e[1].length+2+e[4].length)}var Y_=/^#*0*\.([0#]+)/,K_=/\).*[0#]/,X_=/\(###\) ###\\?-####/;function Yn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function x5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function v5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function D7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function I7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Xi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(K_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xi("n",n,r):"("+Xi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return L7(e,t,r);if(t.indexOf("%")!==-1)return P7(e,t,r);if(t.indexOf("E")!==-1)return V_(t,r);if(t.charCodeAt(0)===36)return"$"+Xi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+gc(l,t.length);if(t.match(/^[#?]+$/))return i=gc(r,0),i==="0"&&(i=""),i.length>t.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(G_))return F7(s,l,u);if(t.match(/^#+0+$/))return u+gc(l,t.length-t.indexOf("0"));if(s=t.match(Y_))return i=x5(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Yn(s[1])).replace(/\.$/,"."+Yn(s[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+Lr("0",Yn(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+x5(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+fo(gc(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xi(e,t,-r):fo(""+(Math.floor(r)+D7(r,s[1].length)))+"."+js(v5(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Xi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=$c(Xi(e,t.replace(/[\\-]/g,""),r)),a=0,$c($c(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(X_))return i=Xi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Y0(l,Math.pow(10,a)-1,!1),i=""+u,f=wa("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=V0(o[2],a),f.length<s[4].length&&(f=Yn(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Y0(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lx(o[1],a)+s[2]+"/"+s[3]+V0(o[2],a):Lr(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=gc(r,0),t.length<=i.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var m=t.indexOf(".")-a,p=t.length-i.length-m;return Yn(t.substr(0,m)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=v5(r,s[1].length),r<0?"-"+Xi(e,t,-r):fo(I7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?js(0,3-v.length):"")+v})+"."+js(a,s[1].length);switch(t){case"###,##0.00":return Xi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=fo(gc(l,0));return h!=="0"?u+h:"";case"###,###.00":return Xi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Xi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function R7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function M7(e,t,r){var n=t.replace(q_,""),i=t.length-n.length;return wa(e,n,r*Math.pow(10,2*i))+Lr("%",i)}function J_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+J_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $s(e,t,r){if(e.charCodeAt(0)===40&&!t.match(K_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$s("n",n,r):"("+$s("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return R7(e,t,r);if(t.indexOf("%")!==-1)return M7(e,t,r);if(t.indexOf("E")!==-1)return J_(t,r);if(t.charCodeAt(0)===36)return"$"+$s(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+js(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(G_))return O7(s,l,u);if(t.match(/^#+0+$/))return u+js(l,t.length-t.indexOf("0"));if(s=t.match(Y_))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Yn(s[1])).replace(/\.$/,"."+Yn(s[1])),i=i.replace(/\.(\d*)$/,function(v,g){return"."+g+Lr("0",Yn(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+fo(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$s(e,t,-r):fo(""+r)+"."+Lr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return $s(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=$c($s(e,t.replace(/[\\-]/g,""),r)),a=0,$c($c(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(X_))return i=$s(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Y0(l,Math.pow(10,a)-1,!1),i=""+u,f=wa("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=V0(o[2],a),f.length<s[4].length&&(f=Yn(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Y0(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lx(o[1],a)+s[2]+"/"+s[3]+V0(o[2],a):Lr(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var m=t.indexOf(".")-a,p=t.length-i.length-m;return Yn(t.substr(0,m)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$s(e,t,-r):fo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?js(0,3-v.length):"")+v})+"."+js(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=fo(""+l);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return $s(e,t.slice(0,t.lastIndexOf(".")),r)+Yn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wa(e,t,r){return(r|0)===r?$s(e,t,r):Xi(e,t,r)}function B7(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Q_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Z_(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":G0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Q_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function U7(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,m,p="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!G0(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(m=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(m);i[i.length]={t:"t",v:s},++a;break;case"\\":var h=e.charAt(++a),v=h==="("||h===")"?h:"t";i[i.length]={t:v,v:h},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(u==null&&(u=Kh(t,r,e.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Kh(t,r),u==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(u==null&&(u=Kh(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",a+=5,p="h"):e.substr(a,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",a+=5,p="h"):(g.t="t",++a),u==null&&g.t==="T")return"";i[i.length]=g,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Q_)){if(u==null&&(u=Kh(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Z_(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var b=0,y=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",b<1&&(b=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[a].v.match(/[Hh]/)&&(b=1),b<2&&i[a].v.match(/[Mm]/)&&(b=2),b<3&&i[a].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",j;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=C7(i[a].t.charCodeAt(0),i[a].v,u,y),i[a].t="t";break;case"n":case"?":for(j=a+1;i[j]!=null&&((o=i[j].t)==="?"||o==="D"||(o===" "||o==="t")&&i[j+1]!=null&&(i[j+1].t==="?"||i[j+1].t==="t"&&i[j+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[j].v==="/"||i[j].v===" "&&i[j+1]!=null&&i[j+1].t=="?"));)i[a].v+=i[j].v,i[j]={v:"",t:";"},++j;_+=i[a].v,a=j-1;break;case"G":i[a].t="t",i[a].v=Vg(t,r);break}var O="",L,E;if(_.length>0){_.charCodeAt(0)==40?(L=t<0&&_.charCodeAt(0)===45?-t:t,E=wa("n",_,L)):(L=t<0&&n>1?-t:t,E=wa("n",_,L),L<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),j=E.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var P=i.length;if(C===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(j>=i[a].v.length-1?(j-=i[a].v.length,i[a].v=E.substr(j+1,i[a].v.length)):j<0?i[a].v="":(i[a].v=E.substr(0,j+1),j=-1),i[a].t="t",P=a);j>=0&&P<i.length&&(i[P].v=E.substr(0,j+1)+i[P].v)}else if(C!==i.length&&E.indexOf("E")===-1){for(j=E.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,O=i[a].v.substr(f+1);f>=0;--f)j>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(O=E.charAt(j--)+O);i[a].v=O,i[a].t="t",P=a}for(j>=0&&P<i.length&&(i[P].v=E.substr(0,j+1)+i[P].v),j=E.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(f=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,O=i[a].v.substr(0,f);f<i[a].v.length;++f)j<E.length&&(O+=E.charAt(j++));i[a].v=O,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(L=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=wa(i[a].t,i[a].v,L),i[a].t="t");var R="";for(a=0;a!==i.length;++a)i[a]!=null&&(R+=i[a].v);return R}var y5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function w5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function z7(e,t){var r=B7(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(y5),o=r[1].match(y5);return w5(t,a)?[n,r[0]]:w5(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Po(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Or)[e],n==null&&(n=r.table&&r.table[g5[e]]||Or[g5[e]]),n==null&&(n=_7[e]||"General");break}if(G0(n,0))return Vg(t,r);t instanceof Date&&(t=$_(t,r.date1904));var i=z7(n,t);if(G0(i[1]))return Vg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return U7(i[1],t,r,i[0])}function e3(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Or[r]==null){t<0&&(t=r);continue}if(Or[r]==e){t=r;break}}t<0&&(t=391)}return Or[t]=e,t}function Rm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&e3(e[t],t)}function Mm(){Or=b7()}var t3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function W7(e){var t=typeof e=="number"?Or[e]:e;return t=t.replace(t3,"(\\d+)"),new RegExp("^"+t+"$")}function H7(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(t3)||[]).forEach(function(m,p){var h=parseInt(r[p+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":a=h;break;case"s":l=h;break;case"m":a>=0?o=h:i=h;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var $7=function(){var e={};e.version="1.2.0";function t(){for(var E=0,C=new Array(256),P=0;P!=256;++P)E=P,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,C[P]=E;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(E){var C=0,P=0,R=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)T[R]=E[R];for(R=0;R!=256;++R)for(P=E[R],C=256+R;C<4096;C+=256)P=T[C]=P>>>8^E[P&255];var A=[];for(R=1;R!=16;++R)A[R-1]=typeof Int32Array<"u"?T.subarray(R*256,R*256+256):T.slice(R*256,R*256+256);return A}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],m=i[6],p=i[7],h=i[8],v=i[9],g=i[10],b=i[11],y=i[12],w=i[13],_=i[14];function j(E,C){for(var P=C^-1,R=0,T=E.length;R<T;)P=P>>>8^r[(P^E.charCodeAt(R++))&255];return~P}function O(E,C){for(var P=C^-1,R=E.length-15,T=0;T<R;)P=_[E[T++]^P&255]^w[E[T++]^P>>8&255]^y[E[T++]^P>>16&255]^b[E[T++]^P>>>24]^g[E[T++]]^v[E[T++]]^h[E[T++]]^p[E[T++]]^m[E[T++]]^f[E[T++]]^u[E[T++]]^l[E[T++]]^o[E[T++]]^a[E[T++]]^s[E[T++]]^r[E[T++]];for(R+=15;T<R;)P=P>>>8^r[(P^E[T++])&255];return~P}function L(E,C){for(var P=C^-1,R=0,T=E.length,A=0,q=0;R<T;)A=E.charCodeAt(R++),A<128?P=P>>>8^r[(P^A)&255]:A<2048?(P=P>>>8^r[(P^(192|A>>6&31))&255],P=P>>>8^r[(P^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,q=E.charCodeAt(R++)&1023,P=P>>>8^r[(P^(240|A>>8&7))&255],P=P>>>8^r[(P^(128|A>>2&63))&255],P=P>>>8^r[(P^(128|q>>6&15|(A&3)<<4))&255],P=P>>>8^r[(P^(128|q&63))&255]):(P=P>>>8^r[(P^(224|A>>12&15))&255],P=P>>>8^r[(P^(128|A>>6&63))&255],P=P>>>8^r[(P^(128|A&63))&255]);return~P}return e.table=r,e.bstr=j,e.buf=O,e.str=L,e}(),or=function(){var t={};t.version="1.2.1";function r(X,oe){for(var ee=X.split("/"),te=oe.split("/"),ae=0,le=0,Se=Math.min(ee.length,te.length);ae<Se;++ae){if(le=ee[ae].length-te[ae].length)return le;if(ee[ae]!=te[ae])return ee[ae]<te[ae]?-1:1}return ee.length-te.length}function n(X){if(X.charAt(X.length-1)=="/")return X.slice(0,-1).indexOf("/")===-1?X:n(X.slice(0,-1));var oe=X.lastIndexOf("/");return oe===-1?X:X.slice(0,oe+1)}function i(X){if(X.charAt(X.length-1)=="/")return i(X.slice(0,-1));var oe=X.lastIndexOf("/");return oe===-1?X:X.slice(oe+1)}function s(X,oe){typeof oe=="string"&&(oe=new Date(oe));var ee=oe.getHours();ee=ee<<6|oe.getMinutes(),ee=ee<<5|oe.getSeconds()>>>1,X.write_shift(2,ee);var te=oe.getFullYear()-1980;te=te<<4|oe.getMonth()+1,te=te<<5|oe.getDate(),X.write_shift(2,te)}function a(X){var oe=X.read_shift(2)&65535,ee=X.read_shift(2)&65535,te=new Date,ae=ee&31;ee>>>=5;var le=ee&15;ee>>>=4,te.setMilliseconds(0),te.setFullYear(ee+1980),te.setMonth(le-1),te.setDate(ae);var Se=oe&31;oe>>>=5;var Ce=oe&63;return oe>>>=6,te.setHours(oe),te.setMinutes(Ce),te.setSeconds(Se<<1),te}function o(X){Ti(X,0);for(var oe={},ee=0;X.l<=X.length-4;){var te=X.read_shift(2),ae=X.read_shift(2),le=X.l+ae,Se={};switch(te){case 21589:ee=X.read_shift(1),ee&1&&(Se.mtime=X.read_shift(4)),ae>5&&(ee&2&&(Se.atime=X.read_shift(4)),ee&4&&(Se.ctime=X.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}X.l=le,oe[te]=Se}return oe}var l;function u(){return l||(l={})}function f(X,oe){if(X[0]==80&&X[1]==75)return gr(X,oe);if((X[0]|32)==109&&(X[1]|32)==105)return Wi(X,oe);if(X.length<512)throw new Error("CFB file size "+X.length+" < 512");var ee=3,te=512,ae=0,le=0,Se=0,Ce=0,_e=0,je=[],Ae=X.slice(0,512);Ti(Ae,0);var He=m(Ae);switch(ee=He[0],ee){case 3:te=512;break;case 4:te=4096;break;case 0:if(He[1]==0)return gr(X,oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}te!==512&&(Ae=X.slice(0,te),Ti(Ae,28));var Ke=X.slice(0,te);p(Ae,ee);var st=Ae.read_shift(4,"i");if(ee===3&&st!==0)throw new Error("# Directory Sectors: Expected 0 saw "+st);Ae.l+=4,Se=Ae.read_shift(4,"i"),Ae.l+=4,Ae.chk("00100000","Mini Stream Cutoff Size: "),Ce=Ae.read_shift(4,"i"),ae=Ae.read_shift(4,"i"),_e=Ae.read_shift(4,"i"),le=Ae.read_shift(4,"i");for(var Ge=-1,it=0;it<109&&(Ge=Ae.read_shift(4,"i"),!(Ge<0));++it)je[it]=Ge;var wt=h(X,te);b(_e,le,wt,te,je);var Kt=w(wt,Se,je,te);Kt[Se].name="!Directory",ae>0&&Ce!==q&&(Kt[Ce].name="!MiniFAT"),Kt[je[0]].name="!FAT",Kt.fat_addrs=je,Kt.ssz=te;var sr={},qr=[],os=[],na=[];_(Se,Kt,wt,qr,ae,sr,os,Ce),v(os,na,qr),qr.shift();var Ds={FileIndex:os,FullPaths:na};return oe&&oe.raw&&(Ds.raw={header:Ke,sectors:wt}),Ds}function m(X){if(X[X.l]==80&&X[X.l+1]==75)return[0,0];X.chk(z,"Header Signature: "),X.l+=16;var oe=X.read_shift(2,"u");return[X.read_shift(2,"u"),oe]}function p(X,oe){var ee=9;switch(X.l+=2,ee=X.read_shift(2)){case 9:if(oe!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(oe!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}X.chk("0600","Mini Sector Shift: "),X.chk("000000000000","Reserved: ")}function h(X,oe){for(var ee=Math.ceil(X.length/oe)-1,te=[],ae=1;ae<ee;++ae)te[ae-1]=X.slice(ae*oe,(ae+1)*oe);return te[ee-1]=X.slice(ee*oe),te}function v(X,oe,ee){for(var te=0,ae=0,le=0,Se=0,Ce=0,_e=ee.length,je=[],Ae=[];te<_e;++te)je[te]=Ae[te]=te,oe[te]=ee[te];for(;Ce<Ae.length;++Ce)te=Ae[Ce],ae=X[te].L,le=X[te].R,Se=X[te].C,je[te]===te&&(ae!==-1&&je[ae]!==ae&&(je[te]=je[ae]),le!==-1&&je[le]!==le&&(je[te]=je[le])),Se!==-1&&(je[Se]=te),ae!==-1&&te!=je[te]&&(je[ae]=je[te],Ae.lastIndexOf(ae)<Ce&&Ae.push(ae)),le!==-1&&te!=je[te]&&(je[le]=je[te],Ae.lastIndexOf(le)<Ce&&Ae.push(le));for(te=1;te<_e;++te)je[te]===te&&(le!==-1&&je[le]!==le?je[te]=je[le]:ae!==-1&&je[ae]!==ae&&(je[te]=je[ae]));for(te=1;te<_e;++te)if(X[te].type!==0){if(Ce=te,Ce!=je[Ce])do Ce=je[Ce],oe[te]=oe[Ce]+"/"+oe[te];while(Ce!==0&&je[Ce]!==-1&&Ce!=je[Ce]);je[te]=-1}for(oe[0]+="/",te=1;te<_e;++te)X[te].type!==2&&(oe[te]+="/")}function g(X,oe,ee){for(var te=X.start,ae=X.size,le=[],Se=te;ee&&ae>0&&Se>=0;)le.push(oe.slice(Se*A,Se*A+A)),ae-=A,Se=sl(ee,Se*4);return le.length===0?Fe(0):Nn(le).slice(0,X.size)}function b(X,oe,ee,te,ae){var le=q;if(X===q){if(oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(X!==-1){var Se=ee[X],Ce=(te>>>2)-1;if(!Se)return;for(var _e=0;_e<Ce&&(le=sl(Se,_e*4))!==q;++_e)ae.push(le);b(sl(Se,te-4),oe-1,ee,te,ae)}}function y(X,oe,ee,te,ae){var le=[],Se=[];ae||(ae=[]);var Ce=te-1,_e=0,je=0;for(_e=oe;_e>=0;){ae[_e]=!0,le[le.length]=_e,Se.push(X[_e]);var Ae=ee[Math.floor(_e*4/te)];if(je=_e*4&Ce,te<4+je)throw new Error("FAT boundary crossed: "+_e+" 4 "+te);if(!X[Ae])break;_e=sl(X[Ae],je)}return{nodes:le,data:A5([Se])}}function w(X,oe,ee,te){var ae=X.length,le=[],Se=[],Ce=[],_e=[],je=te-1,Ae=0,He=0,Ke=0,st=0;for(Ae=0;Ae<ae;++Ae)if(Ce=[],Ke=Ae+oe,Ke>=ae&&(Ke-=ae),!Se[Ke]){_e=[];var Ge=[];for(He=Ke;He>=0;){Ge[He]=!0,Se[He]=!0,Ce[Ce.length]=He,_e.push(X[He]);var it=ee[Math.floor(He*4/te)];if(st=He*4&je,te<4+st)throw new Error("FAT boundary crossed: "+He+" 4 "+te);if(!X[it]||(He=sl(X[it],st),Ge[He]))break}le[Ke]={nodes:Ce,data:A5([_e])}}return le}function _(X,oe,ee,te,ae,le,Se,Ce){for(var _e=0,je=te.length?2:0,Ae=oe[X].data,He=0,Ke=0,st;He<Ae.length;He+=128){var Ge=Ae.slice(He,He+128);Ti(Ge,64),Ke=Ge.read_shift(2),st=mx(Ge,0,Ke-je),te.push(st);var it={name:st,type:Ge.read_shift(1),color:Ge.read_shift(1),L:Ge.read_shift(4,"i"),R:Ge.read_shift(4,"i"),C:Ge.read_shift(4,"i"),clsid:Ge.read_shift(16),state:Ge.read_shift(4,"i"),start:0,size:0},wt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);wt!==0&&(it.ct=j(Ge,Ge.l-8));var Kt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);Kt!==0&&(it.mt=j(Ge,Ge.l-8)),it.start=Ge.read_shift(4,"i"),it.size=Ge.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=q,it.name=""),it.type===5?(_e=it.start,ae>0&&_e!==q&&(oe[_e].name="!StreamData")):it.size>=4096?(it.storage="fat",oe[it.start]===void 0&&(oe[it.start]=y(ee,it.start,oe.fat_addrs,oe.ssz)),oe[it.start].name=it.name,it.content=oe[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:_e!==q&&it.start!==q&&oe[_e]&&(it.content=g(it,oe[_e].data,(oe[Ce]||{}).data))),it.content&&Ti(it.content,0),le[st]=it,Se.push(it)}}function j(X,oe){return new Date((Pi(X,oe+4)/1e7*Math.pow(2,32)+Pi(X,oe)/1e7-11644473600)*1e3)}function O(X,oe){return u(),f(l.readFileSync(X),oe)}function L(X,oe){var ee=oe&&oe.type;switch(ee||Vt&&Buffer.isBuffer(X)&&(ee="buffer"),ee||"base64"){case"file":return O(X,oe);case"base64":return f(ks(Aa(X)),oe);case"binary":return f(ks(X),oe)}return f(X,oe)}function E(X,oe){var ee=oe||{},te=ee.root||"Root Entry";if(X.FullPaths||(X.FullPaths=[]),X.FileIndex||(X.FileIndex=[]),X.FullPaths.length!==X.FileIndex.length)throw new Error("inconsistent CFB structure");X.FullPaths.length===0&&(X.FullPaths[0]=te+"/",X.FileIndex[0]={name:te,type:5}),ee.CLSID&&(X.FileIndex[0].clsid=ee.CLSID),C(X)}function C(X){var oe="Sh33tJ5";if(!or.find(X,"/"+oe)){var ee=Fe(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,X.FileIndex.push({name:oe,type:2,content:ee,size:4,L:69,R:69,C:69}),X.FullPaths.push(X.FullPaths[0]+oe),P(X)}}function P(X,oe){E(X);for(var ee=!1,te=!1,ae=X.FullPaths.length-1;ae>=0;--ae){var le=X.FileIndex[ae];switch(le.type){case 0:te?ee=!0:(X.FileIndex.pop(),X.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(le.R*le.L*le.C)&&(ee=!0),le.R>-1&&le.L>-1&&le.R==le.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!oe)){var Se=new Date(1987,1,19),Ce=0,_e=Object.create?Object.create(null):{},je=[];for(ae=0;ae<X.FullPaths.length;++ae)_e[X.FullPaths[ae]]=!0,X.FileIndex[ae].type!==0&&je.push([X.FullPaths[ae],X.FileIndex[ae]]);for(ae=0;ae<je.length;++ae){var Ae=n(je[ae][0]);te=_e[Ae],te||(je.push([Ae,{name:i(Ae).replace("/",""),type:1,clsid:U,ct:Se,mt:Se,content:null}]),_e[Ae]=!0)}for(je.sort(function(st,Ge){return r(st[0],Ge[0])}),X.FullPaths=[],X.FileIndex=[],ae=0;ae<je.length;++ae)X.FullPaths[ae]=je[ae][0],X.FileIndex[ae]=je[ae][1];for(ae=0;ae<je.length;++ae){var He=X.FileIndex[ae],Ke=X.FullPaths[ae];if(He.name=i(Ke).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||U,ae===0)He.C=je.length>1?1:-1,He.size=0,He.type=5;else if(Ke.slice(-1)=="/"){for(Ce=ae+1;Ce<je.length&&n(X.FullPaths[Ce])!=Ke;++Ce);for(He.C=Ce>=je.length?-1:Ce,Ce=ae+1;Ce<je.length&&n(X.FullPaths[Ce])!=n(Ke);++Ce);He.R=Ce>=je.length?-1:Ce,He.type=1}else n(X.FullPaths[ae+1]||"")==n(Ke)&&(He.R=ae+1),He.type=2}}}function R(X,oe){var ee=oe||{};if(ee.fileType=="mad")return pt(X,ee);switch(P(X),ee.fileType){case"zip":return as(X,ee)}var te=function(st){for(var Ge=0,it=0,wt=0;wt<st.FileIndex.length;++wt){var Kt=st.FileIndex[wt];if(Kt.content){var sr=Kt.content.length;sr>0&&(sr<4096?Ge+=sr+63>>6:it+=sr+511>>9)}}for(var qr=st.FullPaths.length+3>>2,os=Ge+7>>3,na=Ge+127>>7,Ds=os+it+qr+na,ls=Ds+127>>7,Is=ls<=109?0:Math.ceil((ls-109)/127);Ds+ls+Is+127>>7>ls;)Is=++ls<=109?0:Math.ceil((ls-109)/127);var bi=[1,Is,ls,na,qr,it,Ge,0];return st.FileIndex[0].size=Ge<<6,bi[7]=(st.FileIndex[0].start=bi[0]+bi[1]+bi[2]+bi[3]+bi[4]+bi[5])+(bi[6]+7>>3),bi}(X),ae=Fe(te[7]<<9),le=0,Se=0;{for(le=0;le<8;++le)ae.write_shift(1,ne[le]);for(le=0;le<8;++le)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),le=0;le<3;++le)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,te[2]),ae.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:q),ae.write_shift(4,te[3]),ae.write_shift(-4,te[1]?te[0]-1:q),ae.write_shift(4,te[1]),le=0;le<109;++le)ae.write_shift(-4,le<te[2]?te[1]+le:-1)}if(te[1])for(Se=0;Se<te[1];++Se){for(;le<236+Se*127;++le)ae.write_shift(-4,le<te[2]?te[1]+le:-1);ae.write_shift(-4,Se===te[1]-1?q:Se+1)}var Ce=function(st){for(Se+=st;le<Se-1;++le)ae.write_shift(-4,le+1);st&&(++le,ae.write_shift(-4,q))};for(Se=le=0,Se+=te[1];le<Se;++le)ae.write_shift(-4,G.DIFSECT);for(Se+=te[2];le<Se;++le)ae.write_shift(-4,G.FATSECT);Ce(te[3]),Ce(te[4]);for(var _e=0,je=0,Ae=X.FileIndex[0];_e<X.FileIndex.length;++_e)Ae=X.FileIndex[_e],Ae.content&&(je=Ae.content.length,!(je<4096)&&(Ae.start=Se,Ce(je+511>>9)));for(Ce(te[6]+7>>3);ae.l&511;)ae.write_shift(-4,G.ENDOFCHAIN);for(Se=le=0,_e=0;_e<X.FileIndex.length;++_e)Ae=X.FileIndex[_e],Ae.content&&(je=Ae.content.length,!(!je||je>=4096)&&(Ae.start=Se,Ce(je+63>>6)));for(;ae.l&511;)ae.write_shift(-4,G.ENDOFCHAIN);for(le=0;le<te[4]<<2;++le){var He=X.FullPaths[le];if(!He||He.length===0){for(_e=0;_e<17;++_e)ae.write_shift(4,0);for(_e=0;_e<3;++_e)ae.write_shift(4,-1);for(_e=0;_e<12;++_e)ae.write_shift(4,0);continue}Ae=X.FileIndex[le],le===0&&(Ae.start=Ae.size?Ae.start-1:q);var Ke=le===0&&ee.root||Ae.name;if(je=2*(Ke.length+1),ae.write_shift(64,Ke,"utf16le"),ae.write_shift(2,je),ae.write_shift(1,Ae.type),ae.write_shift(1,Ae.color),ae.write_shift(-4,Ae.L),ae.write_shift(-4,Ae.R),ae.write_shift(-4,Ae.C),Ae.clsid)ae.write_shift(16,Ae.clsid,"hex");else for(_e=0;_e<4;++_e)ae.write_shift(4,0);ae.write_shift(4,Ae.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Ae.start),ae.write_shift(4,Ae.size),ae.write_shift(4,0)}for(le=1;le<X.FileIndex.length;++le)if(Ae=X.FileIndex[le],Ae.size>=4096)if(ae.l=Ae.start+1<<9,Vt&&Buffer.isBuffer(Ae.content))Ae.content.copy(ae,ae.l,0,Ae.size),ae.l+=Ae.size+511&-512;else{for(_e=0;_e<Ae.size;++_e)ae.write_shift(1,Ae.content[_e]);for(;_e&511;++_e)ae.write_shift(1,0)}for(le=1;le<X.FileIndex.length;++le)if(Ae=X.FileIndex[le],Ae.size>0&&Ae.size<4096)if(Vt&&Buffer.isBuffer(Ae.content))Ae.content.copy(ae,ae.l,0,Ae.size),ae.l+=Ae.size+63&-64;else{for(_e=0;_e<Ae.size;++_e)ae.write_shift(1,Ae.content[_e]);for(;_e&63;++_e)ae.write_shift(1,0)}if(Vt)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function T(X,oe){var ee=X.FullPaths.map(function(_e){return _e.toUpperCase()}),te=ee.map(function(_e){var je=_e.split("/");return je[je.length-(_e.slice(-1)=="/"?2:1)]}),ae=!1;oe.charCodeAt(0)===47?(ae=!0,oe=ee[0].slice(0,-1)+oe):ae=oe.indexOf("/")!==-1;var le=oe.toUpperCase(),Se=ae===!0?ee.indexOf(le):te.indexOf(le);if(Se!==-1)return X.FileIndex[Se];var Ce=!le.match(Yh);for(le=le.replace(Df,""),Ce&&(le=le.replace(Yh,"!")),Se=0;Se<ee.length;++Se)if((Ce?ee[Se].replace(Yh,"!"):ee[Se]).replace(Df,"")==le||(Ce?te[Se].replace(Yh,"!"):te[Se]).replace(Df,"")==le)return X.FileIndex[Se];return null}var A=64,q=-2,z="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],U="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:U,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function B(X,oe,ee){u();var te=R(X,ee);l.writeFileSync(oe,te)}function Y(X){for(var oe=new Array(X.length),ee=0;ee<X.length;++ee)oe[ee]=String.fromCharCode(X[ee]);return oe.join("")}function re(X,oe){var ee=R(X,oe);switch(oe&&oe.type||"buffer"){case"file":return u(),l.writeFileSync(oe.filename,ee),ee;case"binary":return typeof ee=="string"?ee:Y(ee);case"base64":return hd(typeof ee=="string"?ee:Y(ee));case"buffer":if(Vt)return Buffer.isBuffer(ee)?ee:Pa(ee);case"array":return typeof ee=="string"?ks(ee):ee}return ee}var he;function k(X){try{var oe=X.InflateRaw,ee=new oe;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)he=X;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function I(X,oe){if(!he)return Ut(X,oe);var ee=he.InflateRaw,te=new ee,ae=te._processChunk(X.slice(X.l),te._finishFlushFlag);return X.l+=te.bytesRead,ae}function M(X){return he?he.deflateRawSync(X):Ct(X)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(X){var oe=(X<<1|X<<11)&139536|(X<<5|X<<15)&558144;return(oe>>16|oe>>8|oe)&255}for(var de=typeof Uint8Array<"u",ve=de?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)ve[Ee]=fe(Ee);function Oe(X,oe){var ee=ve[X&255];return oe<=8?ee>>>8-oe:(ee=ee<<8|ve[X>>8&255],oe<=16?ee>>>16-oe:(ee=ee<<8|ve[X>>16&255],ee>>>24-oe))}function Ve(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=6?0:X[te+1]<<8))>>>ee&3}function Qe(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=5?0:X[te+1]<<8))>>>ee&7}function Te(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=4?0:X[te+1]<<8))>>>ee&15}function ue(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=3?0:X[te+1]<<8))>>>ee&31}function Me(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=1?0:X[te+1]<<8))>>>ee&127}function at(X,oe,ee){var te=oe&7,ae=oe>>>3,le=(1<<ee)-1,Se=X[ae]>>>te;return ee<8-te||(Se|=X[ae+1]<<8-te,ee<16-te)||(Se|=X[ae+2]<<16-te,ee<24-te)||(Se|=X[ae+3]<<24-te),Se&le}function ze(X,oe,ee){var te=oe&7,ae=oe>>>3;return te<=5?X[ae]|=(ee&7)<<te:(X[ae]|=ee<<te&255,X[ae+1]=(ee&7)>>8-te),oe+3}function Ye(X,oe,ee){var te=oe&7,ae=oe>>>3;return ee=(ee&1)<<te,X[ae]|=ee,oe+1}function Ze(X,oe,ee){var te=oe&7,ae=oe>>>3;return ee<<=te,X[ae]|=ee&255,ee>>>=8,X[ae+1]=ee,oe+8}function tt(X,oe,ee){var te=oe&7,ae=oe>>>3;return ee<<=te,X[ae]|=ee&255,ee>>>=8,X[ae+1]=ee&255,X[ae+2]=ee>>>8,oe+16}function ft(X,oe){var ee=X.length,te=2*ee>oe?2*ee:oe+5,ae=0;if(ee>=oe)return X;if(Vt){var le=h5(te);if(X.copy)X.copy(le);else for(;ae<X.length;++ae)le[ae]=X[ae];return le}else if(de){var Se=new Uint8Array(te);if(Se.set)Se.set(X);else for(;ae<ee;++ae)Se[ae]=X[ae];return Se}return X.length=te,X}function dt(X){for(var oe=new Array(X),ee=0;ee<X;++ee)oe[ee]=0;return oe}function bt(X,oe,ee){var te=1,ae=0,le=0,Se=0,Ce=0,_e=X.length,je=de?new Uint16Array(32):dt(32);for(le=0;le<32;++le)je[le]=0;for(le=_e;le<ee;++le)X[le]=0;_e=X.length;var Ae=de?new Uint16Array(_e):dt(_e);for(le=0;le<_e;++le)je[ae=X[le]]++,te<ae&&(te=ae),Ae[le]=0;for(je[0]=0,le=1;le<=te;++le)je[le+16]=Ce=Ce+je[le-1]<<1;for(le=0;le<_e;++le)Ce=X[le],Ce!=0&&(Ae[le]=je[Ce+16]++);var He=0;for(le=0;le<_e;++le)if(He=X[le],He!=0)for(Ce=Oe(Ae[le],te)>>te-He,Se=(1<<te+4-He)-1;Se>=0;--Se)oe[Ce|Se<<He]=He&15|le<<4;return te}var jt=de?new Uint16Array(512):dt(512),Lt=de?new Uint16Array(32):dt(32);if(!de){for(var Ot=0;Ot<512;++Ot)jt[Ot]=0;for(Ot=0;Ot<32;++Ot)Lt[Ot]=0}(function(){for(var X=[],oe=0;oe<32;oe++)X.push(5);bt(X,Lt,32);var ee=[];for(oe=0;oe<=143;oe++)ee.push(8);for(;oe<=255;oe++)ee.push(9);for(;oe<=279;oe++)ee.push(7);for(;oe<=287;oe++)ee.push(8);bt(ee,jt,288)})();var xt=function(){for(var oe=de?new Uint8Array(32768):[],ee=0,te=0;ee<se.length-1;++ee)for(;te<se[ee+1];++te)oe[te]=ee;for(;te<32768;++te)oe[te]=29;var ae=de?new Uint8Array(259):[];for(ee=0,te=0;ee<V.length-1;++ee)for(;te<V[ee+1];++te)ae[te]=ee;function le(Ce,_e){for(var je=0;je<Ce.length;){var Ae=Math.min(65535,Ce.length-je),He=je+Ae==Ce.length;for(_e.write_shift(1,+He),_e.write_shift(2,Ae),_e.write_shift(2,~Ae&65535);Ae-- >0;)_e[_e.l++]=Ce[je++]}return _e.l}function Se(Ce,_e){for(var je=0,Ae=0,He=de?new Uint16Array(32768):[];Ae<Ce.length;){var Ke=Math.min(65535,Ce.length-Ae);if(Ke<10){for(je=ze(_e,je,+(Ae+Ke==Ce.length)),je&7&&(je+=8-(je&7)),_e.l=je/8|0,_e.write_shift(2,Ke),_e.write_shift(2,~Ke&65535);Ke-- >0;)_e[_e.l++]=Ce[Ae++];je=_e.l*8;continue}je=ze(_e,je,+(Ae+Ke==Ce.length)+2);for(var st=0;Ke-- >0;){var Ge=Ce[Ae];st=(st<<5^Ge)&32767;var it=-1,wt=0;if((it=He[st])&&(it|=Ae&-32768,it>Ae&&(it-=32768),it<Ae))for(;Ce[it+wt]==Ce[Ae+wt]&&wt<250;)++wt;if(wt>2){Ge=ae[wt],Ge<=22?je=Ze(_e,je,ve[Ge+1]>>1)-1:(Ze(_e,je,3),je+=5,Ze(_e,je,ve[Ge-23]>>5),je+=3);var Kt=Ge<8?0:Ge-4>>2;Kt>0&&(tt(_e,je,wt-V[Ge]),je+=Kt),Ge=oe[Ae-it],je=Ze(_e,je,ve[Ge]>>3),je-=3;var sr=Ge<4?0:Ge-2>>1;sr>0&&(tt(_e,je,Ae-it-se[Ge]),je+=sr);for(var qr=0;qr<wt;++qr)He[st]=Ae&32767,st=(st<<5^Ce[Ae])&32767,++Ae;Ke-=wt-1}else Ge<=143?Ge=Ge+48:je=Ye(_e,je,1),je=Ze(_e,je,ve[Ge]),He[st]=Ae&32767,++Ae}je=Ze(_e,je,0)-1}return _e.l=(je+7)/8|0,_e.l}return function(_e,je){return _e.length<8?le(_e,je):Se(_e,je)}}();function Ct(X){var oe=Fe(50+Math.floor(X.length*1.1)),ee=xt(X,oe);return oe.slice(0,ee)}var nt=de?new Uint16Array(32768):dt(32768),en=de?new Uint16Array(32768):dt(32768),Rt=de?new Uint16Array(128):dt(128),ti=1,Yt=1;function fr(X,oe){var ee=ue(X,oe)+257;oe+=5;var te=ue(X,oe)+1;oe+=5;var ae=Te(X,oe)+4;oe+=4;for(var le=0,Se=de?new Uint8Array(19):dt(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,je=de?new Uint8Array(8):dt(8),Ae=de?new Uint8Array(8):dt(8),He=Se.length,Ke=0;Ke<ae;++Ke)Se[D[Ke]]=le=Qe(X,oe),_e<le&&(_e=le),je[le]++,oe+=3;var st=0;for(je[0]=0,Ke=1;Ke<=_e;++Ke)Ae[Ke]=st=st+je[Ke-1]<<1;for(Ke=0;Ke<He;++Ke)(st=Se[Ke])!=0&&(Ce[Ke]=Ae[st]++);var Ge=0;for(Ke=0;Ke<He;++Ke)if(Ge=Se[Ke],Ge!=0){st=ve[Ce[Ke]]>>8-Ge;for(var it=(1<<7-Ge)-1;it>=0;--it)Rt[st|it<<Ge]=Ge&7|Ke<<3}var wt=[];for(_e=1;wt.length<ee+te;)switch(st=Rt[Me(X,oe)],oe+=st&7,st>>>=3){case 16:for(le=3+Ve(X,oe),oe+=2,st=wt[wt.length-1];le-- >0;)wt.push(st);break;case 17:for(le=3+Qe(X,oe),oe+=3;le-- >0;)wt.push(0);break;case 18:for(le=11+Me(X,oe),oe+=7;le-- >0;)wt.push(0);break;default:wt.push(st),_e<st&&(_e=st);break}var Kt=wt.slice(0,ee),sr=wt.slice(ee);for(Ke=ee;Ke<286;++Ke)Kt[Ke]=0;for(Ke=te;Ke<30;++Ke)sr[Ke]=0;return ti=bt(Kt,nt,286),Yt=bt(sr,en,30),oe}function Ui(X,oe){if(X[0]==3&&!(X[1]&3))return[jl(oe),2];for(var ee=0,te=0,ae=h5(oe||1<<18),le=0,Se=ae.length>>>0,Ce=0,_e=0;!(te&1);){if(te=Qe(X,ee),ee+=3,te>>>1)te>>1==1?(Ce=9,_e=5):(ee=fr(X,ee),Ce=ti,_e=Yt);else{ee&7&&(ee+=8-(ee&7));var je=X[ee>>>3]|X[(ee>>>3)+1]<<8;if(ee+=32,je>0)for(!oe&&Se<le+je&&(ae=ft(ae,le+je),Se=ae.length);je-- >0;)ae[le++]=X[ee>>>3],ee+=8;continue}for(;;){!oe&&Se<le+32767&&(ae=ft(ae,le+32767),Se=ae.length);var Ae=at(X,ee,Ce),He=te>>>1==1?jt[Ae]:nt[Ae];if(ee+=He&15,He>>>=4,!(He>>>8&255))ae[le++]=He;else{if(He==256)break;He-=257;var Ke=He<8?0:He-4>>2;Ke>5&&(Ke=0);var st=le+V[He];Ke>0&&(st+=at(X,ee,Ke),ee+=Ke),Ae=at(X,ee,_e),He=te>>>1==1?Lt[Ae]:en[Ae],ee+=He&15,He>>>=4;var Ge=He<4?0:He-2>>1,it=se[He];for(Ge>0&&(it+=at(X,ee,Ge),ee+=Ge),!oe&&Se<st&&(ae=ft(ae,st+100),Se=ae.length);le<st;)ae[le]=ae[le-it],++le}}}return oe?[ae,ee+7>>>3]:[ae.slice(0,le),ee+7>>>3]}function Ut(X,oe){var ee=X.slice(X.l||0),te=Ui(ee,oe);return X.l+=te[1],te[0]}function Os(X,oe){if(X)typeof console<"u"&&console.error(oe);else throw new Error(oe)}function gr(X,oe){var ee=X;Ti(ee,0);var te=[],ae=[],le={FileIndex:te,FullPaths:ae};E(le,{root:oe.root});for(var Se=ee.length-4;(ee[Se]!=80||ee[Se+1]!=75||ee[Se+2]!=5||ee[Se+3]!=6)&&Se>=0;)--Se;ee.l=Se+4,ee.l+=4;var Ce=ee.read_shift(2);ee.l+=6;var _e=ee.read_shift(4);for(ee.l=_e,Se=0;Se<Ce;++Se){ee.l+=20;var je=ee.read_shift(4),Ae=ee.read_shift(4),He=ee.read_shift(2),Ke=ee.read_shift(2),st=ee.read_shift(2);ee.l+=8;var Ge=ee.read_shift(4),it=o(ee.slice(ee.l+He,ee.l+He+Ke));ee.l+=He+Ke+st;var wt=ee.l;ee.l=Ge+4,yi(ee,je,Ae,le,it),ee.l=wt}return le}function yi(X,oe,ee,te,ae){X.l+=2;var le=X.read_shift(2),Se=X.read_shift(2),Ce=a(X);if(le&8257)throw new Error("Unsupported ZIP encryption");for(var _e=X.read_shift(4),je=X.read_shift(4),Ae=X.read_shift(4),He=X.read_shift(2),Ke=X.read_shift(2),st="",Ge=0;Ge<He;++Ge)st+=String.fromCharCode(X[X.l++]);if(Ke){var it=o(X.slice(X.l,X.l+Ke));(it[21589]||{}).mt&&(Ce=it[21589].mt),((ae||{})[21589]||{}).mt&&(Ce=ae[21589].mt)}X.l+=Ke;var wt=X.slice(X.l,X.l+je);switch(Se){case 8:wt=I(X,Ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var Kt=!1;le&8&&(_e=X.read_shift(4),_e==134695760&&(_e=X.read_shift(4),Kt=!0),je=X.read_shift(4),Ae=X.read_shift(4)),je!=oe&&Os(Kt,"Bad compressed size: "+oe+" != "+je),Ae!=ee&&Os(Kt,"Bad uncompressed size: "+ee+" != "+Ae),ri(te,st,wt,{unsafe:!0,mt:Ce})}function as(X,oe){var ee=oe||{},te=[],ae=[],le=Fe(1),Se=ee.compression?8:0,Ce=0,_e=0,je=0,Ae=0,He=0,Ke=X.FullPaths[0],st=Ke,Ge=X.FileIndex[0],it=[],wt=0;for(_e=1;_e<X.FullPaths.length;++_e)if(st=X.FullPaths[_e].slice(Ke.length),Ge=X.FileIndex[_e],!(!Ge.size||!Ge.content||st=="Sh33tJ5")){var Kt=Ae,sr=Fe(st.length);for(je=0;je<st.length;++je)sr.write_shift(1,st.charCodeAt(je)&127);sr=sr.slice(0,sr.l),it[He]=$7.buf(Ge.content,0);var qr=Ge.content;Se==8&&(qr=M(qr)),le=Fe(30),le.write_shift(4,67324752),le.write_shift(2,20),le.write_shift(2,Ce),le.write_shift(2,Se),Ge.mt?s(le,Ge.mt):le.write_shift(4,0),le.write_shift(-4,it[He]),le.write_shift(4,qr.length),le.write_shift(4,Ge.content.length),le.write_shift(2,sr.length),le.write_shift(2,0),Ae+=le.length,te.push(le),Ae+=sr.length,te.push(sr),Ae+=qr.length,te.push(qr),le=Fe(46),le.write_shift(4,33639248),le.write_shift(2,0),le.write_shift(2,20),le.write_shift(2,Ce),le.write_shift(2,Se),le.write_shift(4,0),le.write_shift(-4,it[He]),le.write_shift(4,qr.length),le.write_shift(4,Ge.content.length),le.write_shift(2,sr.length),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(4,0),le.write_shift(4,Kt),wt+=le.l,ae.push(le),wt+=sr.length,ae.push(sr),++He}return le=Fe(22),le.write_shift(4,101010256),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,He),le.write_shift(2,He),le.write_shift(4,wt),le.write_shift(4,Ae),le.write_shift(2,0),Nn([Nn(te),Nn(ae),le])}var lr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _t(X,oe){if(X.ctype)return X.ctype;var ee=X.name||"",te=ee.match(/\.([^\.]+)$/);return te&&lr[te[1]]||oe&&(te=(ee=oe).match(/[\.\\]([^\.\\])+$/),te&&lr[te[1]])?lr[te[1]]:"application/octet-stream"}function Ht(X){for(var oe=hd(X),ee=[],te=0;te<oe.length;te+=76)ee.push(oe.slice(te,te+76));return ee.join(`\r
`)+`\r
`}function ra(X){var oe=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(je){var Ae=je.charCodeAt(0).toString(16).toUpperCase();return"="+(Ae.length==1?"0"+Ae:Ae)});oe=oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),oe.charAt(0)==`
`&&(oe="=0D"+oe.slice(1)),oe=oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],te=oe.split(`\r
`),ae=0;ae<te.length;++ae){var le=te[ae];if(le.length==0){ee.push("");continue}for(var Se=0;Se<le.length;){var Ce=76,_e=le.slice(Se,Se+Ce);_e.charAt(Ce-1)=="="?Ce--:_e.charAt(Ce-2)=="="?Ce-=2:_e.charAt(Ce-3)=="="&&(Ce-=3),_e=le.slice(Se,Se+Ce),Se+=Ce,Se<le.length&&(_e+="="),ee.push(_e)}}return ee.join(`\r
`)}function tn(X){for(var oe=[],ee=0;ee<X.length;++ee){for(var te=X[ee];ee<=X.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+X[++ee];oe.push(te)}for(var ae=0;ae<oe.length;++ae)oe[ae]=oe[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(le){return String.fromCharCode(parseInt(le.slice(1),16))});return ks(oe.join(`\r
`))}function zi(X,oe,ee){for(var te="",ae="",le="",Se,Ce=0;Ce<10;++Ce){var _e=oe[Ce];if(!_e||_e.match(/^\s*$/))break;var je=_e.match(/^(.*?):\s*([^\s].*)$/);if(je)switch(je[1].toLowerCase()){case"content-location":te=je[2].trim();break;case"content-type":le=je[2].trim();break;case"content-transfer-encoding":ae=je[2].trim();break}}switch(++Ce,ae.toLowerCase()){case"base64":Se=ks(Aa(oe.slice(Ce).join("")));break;case"quoted-printable":Se=tn(oe.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Ae=ri(X,te.slice(ee.length),Se,{unsafe:!0});le&&(Ae.ctype=le)}function Wi(X,oe){if(Y(X.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=oe&&oe.root||"",te=(Vt&&Buffer.isBuffer(X)?X.toString("binary"):Y(X)).split(`\r
`),ae=0,le="";for(ae=0;ae<te.length;++ae)if(le=te[ae],!!/^Content-Location:/i.test(le)&&(le=le.slice(le.indexOf("file")),ee||(ee=le.slice(0,le.lastIndexOf("/")+1)),le.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),le.slice(0,ee.length)!=ee););var Se=(te[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Ce="--"+(Se[1]||""),_e=[],je=[],Ae={FileIndex:_e,FullPaths:je};E(Ae);var He,Ke=0;for(ae=0;ae<te.length;++ae){var st=te[ae];st!==Ce&&st!==Ce+"--"||(Ke++&&zi(Ae,te.slice(He,ae),ee),He=ae)}return Ae}function pt(X,oe){var ee=oe||{},te=ee.boundary||"SheetJS";te="------="+te;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],le=X.FullPaths[0],Se=le,Ce=X.FileIndex[0],_e=1;_e<X.FullPaths.length;++_e)if(Se=X.FullPaths[_e].slice(le.length),Ce=X.FileIndex[_e],!(!Ce.size||!Ce.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wt){return"_x"+wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wt){return"_u"+wt.charCodeAt(0).toString(16)+"_"});for(var je=Ce.content,Ae=Vt&&Buffer.isBuffer(je)?je.toString("binary"):Y(je),He=0,Ke=Math.min(1024,Ae.length),st=0,Ge=0;Ge<=Ke;++Ge)(st=Ae.charCodeAt(Ge))>=32&&st<128&&++He;var it=He>=Ke*4/5;ae.push(te),ae.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+Se),ae.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),ae.push("Content-Type: "+_t(Ce,Se)),ae.push(""),ae.push(it?ra(Ae):Ht(Ae))}return ae.push(te+`--\r
`),ae.join(`\r
`)}function wi(X){var oe={};return E(oe,X),oe}function ri(X,oe,ee,te){var ae=te&&te.unsafe;ae||E(X);var le=!ae&&or.find(X,oe);if(!le){var Se=X.FullPaths[0];oe.slice(0,Se.length)==Se?Se=oe:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+oe).replace("//","/")),le={name:i(oe),type:2},X.FileIndex.push(le),X.FullPaths.push(Se),ae||or.utils.cfb_gc(X)}return le.content=ee,le.size=ee?ee.length:0,te&&(te.CLSID&&(le.clsid=te.CLSID),te.mt&&(le.mt=te.mt),te.ct&&(le.ct=te.ct)),le}function Cn(X,oe){E(X);var ee=or.find(X,oe);if(ee){for(var te=0;te<X.FileIndex.length;++te)if(X.FileIndex[te]==ee)return X.FileIndex.splice(te,1),X.FullPaths.splice(te,1),!0}return!1}function Dr(X,oe,ee){E(X);var te=or.find(X,oe);if(te){for(var ae=0;ae<X.FileIndex.length;++ae)if(X.FileIndex[ae]==te)return X.FileIndex[ae].name=i(ee),X.FullPaths[ae]=ee,!0}return!1}function jr(X){P(X,!0)}return t.find=T,t.read=L,t.parse=f,t.write=re,t.writeFile=B,t.utils={cfb_new:wi,cfb_add:ri,cfb_del:Cn,cfb_mov:Dr,cfb_gc:jr,ReadShift:Rf,CheckField:y3,prep_blob:Ti,bconcat:Nn,use_zlib:k,_deflateRaw:Ct,_inflateRaw:Ut,consts:G},t}();function q7(e){return typeof e=="string"?Im(e):Array.isArray(e)?x7(e):e}function Td(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Im(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?pd(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([q7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ad(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Tn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function b5(e,t){for(var r=[],n=Tn(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function ux(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Bm(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function V7(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var K0=new Date(1899,11,30,0,0,0);function gi(e,t){var r=e.getTime(),n=K0.getTime()+(e.getTimezoneOffset()-K0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var r3=new Date,G7=K0.getTime()+(r3.getTimezoneOffset()-K0.getTimezoneOffset())*6e4,_5=r3.getTimezoneOffset();function n3(e){var t=new Date;return t.setTime(e*24*60*60*1e3+G7),t.getTimezoneOffset()!==_5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-_5)*6e4),t}var S5=new Date("2017-02-19T19:06:09.000Z"),i3=isNaN(S5.getFullYear())?new Date("2/19/17"):S5,Y7=i3.getFullYear()==2017;function Qn(e,t){var r=new Date(e);if(Y7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(i3.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Um(e,t){if(Vt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function xi(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=xi(e[r]));return t}function Lr(e,t){for(var r="";r.length<t;)r+=e;return r}function ba(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var K7=["january","february","march","april","may","june","july","august","september","october","november","december"];function md(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&K7.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Pt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Vt?n=Pa(r):n=v7(r),or.utils.cfb_add(e,t,n)}or.utils.cfb_add(e,t,r)}else e.file(t,r)}function fx(){return or.utils.cfb_new()}var Zr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,X7={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},dx=ux(X7),hx=/[&<>'"]/g,J7=/[\u0000-\u0008\u000b-\u001f]/g;function rr(e){var t=e+"";return t.replace(hx,function(r){return dx[r]}).replace(J7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function N5(e){return rr(e).replace(/ /g,"_x0020_")}var s3=/[\u0000-\u001f]/g;function Q7(e){var t=e+"";return t.replace(hx,function(r){return dx[r]}).replace(/\n/g,"<br/>").replace(s3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Z7(e){var t=e+"";return t.replace(hx,function(r){return dx[r]}).replace(s3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function eP(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function tP(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function v1(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function k5(e){var t=jl(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function E5(e){return Pa(e,"binary").toString("utf8")}var Xh="foo bar bazâð£",If=Vt&&(E5(Xh)==v1(Xh)&&E5||k5(Xh)==v1(Xh)&&k5)||v1,pd=Vt?function(e){return Pa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},rP=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),a3=/(^\s|\s$|\n)/;function kn(e,t){return"<"+e+(t.match(a3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function gd(e){return Tn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Xe(e,t,r){return"<"+e+(r!=null?gd(r):"")+(t!=null?(t.match(a3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Gg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function nP(e,t){switch(typeof e){case"string":var r=Xe("vt:lpwstr",rr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Xe((e|0)==e?"vt:i4":"vt:r8",rr(String(e)));case"boolean":return Xe("vt:bool",e?"true":"false")}if(e instanceof Date)return Xe("vt:filetime",Gg(e));throw new Error("Unable to serialize "+e)}var hn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ci={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function iP(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function sP(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var j5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},A5=Vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Pa(t)})):j5(e)}:j5,T5=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(xf(e,i)));return n.join("").replace(Df,"")},mx=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Df,""):T5(e,t,r)}:T5,C5=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},o3=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):C5(e,t,r)}:C5,P5=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(_c(e,i)));return n.join("")},Cd=Vt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):P5(t,r,n)}:P5,l3=function(e,t){var r=Pi(e,t);return r>0?Cd(e,t+4,t+4+r-1):""},c3=l3,u3=function(e,t){var r=Pi(e,t);return r>0?Cd(e,t+4,t+4+r-1):""},f3=u3,d3=function(e,t){var r=2*Pi(e,t);return r>0?Cd(e,t+4,t+4+r-1):""},h3=d3,m3=function(t,r){var n=Pi(t,r);return n>0?mx(t,r+4,r+4+n):""},p3=m3,g3=function(e,t){var r=Pi(e,t);return r>0?Cd(e,t+4,t+4+r):""},x3=g3,v3=function(e,t){return iP(e,t)},X0=v3,px=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Vt&&(c3=function(t,r){if(!Buffer.isBuffer(t))return l3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},f3=function(t,r){if(!Buffer.isBuffer(t))return u3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},h3=function(t,r){if(!Buffer.isBuffer(t))return d3(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},p3=function(t,r){if(!Buffer.isBuffer(t))return m3(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},x3=function(t,r){if(!Buffer.isBuffer(t))return g3(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},X0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):v3(t,r)},px=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var _c=function(e,t){return e[t]},xf=function(e,t){return e[t+1]*256+e[t]},aP=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Pi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},sl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},oP=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Rf(e,t){var r="",n,i,s=[],a,o,l,u;switch(t){case"dbcs":if(u=this.l,Vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(xf(this,u)),u+=2;e*=2;break;case"utf8":r=Cd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=mx(this,this.l,this.l+e);break;case"wstr":return Rf.call(this,e,"dbcs");case"lpstr-ansi":r=c3(this,this.l),e=4+Pi(this,this.l);break;case"lpstr-cp":r=f3(this,this.l),e=4+Pi(this,this.l);break;case"lpwstr":r=h3(this,this.l),e=4+2*Pi(this,this.l);break;case"lpp4":e=4+Pi(this,this.l),r=p3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Pi(this,this.l),r=x3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=_c(this,this.l+e++))!==0;)s.push(Gh(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=xf(this,this.l+e))!==0;)s.push(Gh(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=_c(this,u),this.l=u+1,o=Rf.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Gh(xf(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=_c(this,u),this.l=u+1,o=Rf.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Gh(_c(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=_c(this,this.l),this.l++,n;case 2:return n=(t==="i"?aP:xf)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?sl:oP)(this,this.l),this.l+=4,n):(i=Pi(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=X0(this,this.l):i=X0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=o3(this,this.l,e);break}}return this.l+=e,r}var lP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},cP=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},uP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fP(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)uP(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,lP(this,t,this.l);break;case 8:if(n=8,r==="f"){sP(this,t,this.l);break}case 16:break;case-4:n=4,cP(this,t,this.l);break}return this.l+=n,this}function y3(e,t){var r=o3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ti(e,t){e.l=t,e.read_shift=Rf,e.chk=y3,e.write_shift=fP}function Zs(e,t){e.l+=t}function Fe(e){var t=jl(e);return Ti(t,0),t}function pi(){var e=[],t=Vt?256:2048,r=function(u){var f=Fe(u);return Ti(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},a=function(){return i(),Nn(e)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function Be(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=iI[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&px(r)&&e.push(r)}}function Mf(e,t,r){var n=xi(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function L5(e,t,r){var n=xi(e);return n.s=Mf(n.s,t.s,r),n.e=Mf(n.e,t.s,r),n}function Bf(e,t){if(e.cRel&&e.c<0)for(e=xi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=xi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ir(e);return!e.cRel&&e.cRel!=null&&(r=mP(r)),!e.rRel&&e.rRel!=null&&(r=dP(r)),r}function y1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+zn(e.s.c)+":"+(e.e.cRel?"":"$")+zn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+jn(e.s.r)+":"+(e.e.rRel?"":"$")+jn(e.e.r):Bf(e.s,t.biff)+":"+Bf(e.e,t.biff)}function gx(e){return parseInt(hP(e),10)-1}function jn(e){return""+(e+1)}function dP(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hP(e){return e.replace(/\$(\d+)$/,"$1")}function xx(e){for(var t=pP(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function zn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function mP(e){return e.replace(/^([A-Z])/,"$$$1")}function pP(e){return e.replace(/^\$([A-Z])/,"$1")}function gP(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ir(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ri(e){var t=e.indexOf(":");return t==-1?{s:pn(e),e:pn(e)}:{s:pn(e.slice(0,t)),e:pn(e.slice(t+1))}}function Qr(e,t){return typeof t>"u"||typeof t=="number"?Qr(e.s,e.e):(typeof e!="string"&&(e=ir(e)),typeof t!="string"&&(t=ir(t)),e==t?e:e+":"+t)}function wr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function F5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Po(e.z,r?gi(t):t)}catch{}try{return e.w=Po((e.XF||{}).numFmtId||(r?14:0),r?gi(t):t)}catch{return""+t}}function Ta(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Pd[e.v]||e.v:t==null?F5(e,e.v):F5(e,t))}function Dl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function w3(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?pn(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=wr(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[m].length;++p)if(!(typeof t[m][p]>"u")){var h={v:t[m][p]},v=a+m,g=o+p;if(u.s.r>v&&(u.s.r=v),u.s.c>g&&(u.s.c=g),u.e.r<v&&(u.e.r=v),u.e.c<g&&(u.e.c=g),t[m][p]&&typeof t[m][p]=="object"&&!Array.isArray(t[m][p])&&!(t[m][p]instanceof Date))h=t[m][p];else if(Array.isArray(h.v)&&(h.f=t[m][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Or[14],n.cellDates?(h.t="d",h.w=Po(h.z,gi(h.v))):(h.t="n",h.v=gi(h.v),h.w=Po(h.z,h.v))):h.t="s";if(i)s[v]||(s[v]=[]),s[v][g]&&s[v][g].z&&(h.z=s[v][g].z),s[v][g]=h;else{var b=ir({c:g,r:v});s[b]&&s[b].z&&(h.z=s[b].z),s[b]=h}}}return u.s.c<1e7&&(s["!ref"]=Qr(u)),s}function gu(e,t){return w3(null,e,t)}function xP(e){return e.read_shift(4,"i")}function Cs(e,t){return t||(t=Fe(4)),t.write_shift(4,e),t}function Wn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function gn(e,t){var r=!1;return t==null&&(r=!0,t=Fe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function vP(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yP(e,t){return t||(t=Fe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function vx(e,t){var r=e.l,n=e.read_shift(1),i=Wn(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(vP(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function wP(e,t){var r=!1;return t==null&&(r=!0,t=Fe(15+4*e.t.length)),t.write_shift(1,0),gn(e.t,t),r?t.slice(0,t.l):t}var bP=vx;function _P(e,t){var r=!1;return t==null&&(r=!0,t=Fe(23+4*e.t.length)),t.write_shift(1,1),gn(e.t,t),t.write_shift(4,1),yP({},t),r?t.slice(0,t.l):t}function ss(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Il(e,t){return t==null&&(t=Fe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Rl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ml(e,t){return t==null&&(t=Fe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var SP=Wn,b3=gn;function yx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function J0(e,t){var r=!1;return t==null&&(r=!0,t=Fe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var NP=Wn,Yg=yx,wx=J0;function _3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?X0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):sl(t,0)>>2;return r?i/100:i}function S3(e,t){t==null&&(t=Fe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function N3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function kP(e,t){return t||(t=Fe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Bl=N3,xu=kP;function vu(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Al(e,t){return(t||Fe(8)).write_shift(8,e,"f")}function EP(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=DP[i];u&&(t.rgb=$5(u));break;case 2:t.rgb=$5([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Q0(e,t){if(t||(t=Fe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function jP(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function AP(e,t){t||(t=Fe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var k3=2,ji=3,Jh=11,Z0=19,Qh=64,TP=65,CP=71,PP=4108,LP=4126,Sn=80,O5={1:{n:"CodePage",t:k3},2:{n:"Category",t:Sn},3:{n:"PresentationFormat",t:Sn},4:{n:"ByteCount",t:ji},5:{n:"LineCount",t:ji},6:{n:"ParagraphCount",t:ji},7:{n:"SlideCount",t:ji},8:{n:"NoteCount",t:ji},9:{n:"HiddenCount",t:ji},10:{n:"MultimediaClipCount",t:ji},11:{n:"ScaleCrop",t:Jh},12:{n:"HeadingPairs",t:PP},13:{n:"TitlesOfParts",t:LP},14:{n:"Manager",t:Sn},15:{n:"Company",t:Sn},16:{n:"LinksUpToDate",t:Jh},17:{n:"CharacterCount",t:ji},19:{n:"SharedDoc",t:Jh},22:{n:"HyperlinksChanged",t:Jh},23:{n:"AppVersion",t:ji,p:"version"},24:{n:"DigSig",t:TP},26:{n:"ContentType",t:Sn},27:{n:"ContentStatus",t:Sn},28:{n:"Language",t:Sn},29:{n:"Version",t:Sn},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}},D5={1:{n:"CodePage",t:k3},2:{n:"Title",t:Sn},3:{n:"Subject",t:Sn},4:{n:"Author",t:Sn},5:{n:"Keywords",t:Sn},6:{n:"Comments",t:Sn},7:{n:"Template",t:Sn},8:{n:"LastAuthor",t:Sn},9:{n:"RevNumber",t:Sn},10:{n:"EditTime",t:Qh},11:{n:"LastPrinted",t:Qh},12:{n:"CreatedDate",t:Qh},13:{n:"ModifiedDate",t:Qh},14:{n:"PageCount",t:ji},15:{n:"WordCount",t:ji},16:{n:"CharCount",t:ji},17:{n:"Thumbnail",t:CP},18:{n:"Application",t:Sn},19:{n:"DocSecurity",t:ji},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}};function FP(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var OP=FP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),DP=xi(OP),Pd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},IP={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function E3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function j3(e,t){var r=V7(IP),n=[],i;n[n.length]=Zr,n[n.length]=Xe("Types",null,{xmlns:hn.CT,"xmlns:xsd":hn.xsd,"xmlns:xsi":hn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Xe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=Xe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Zh[l][t.bookType]||Zh[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Zh[l][t.bookType]||Zh[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function A3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function qc(e){var t=[Zr,Xe("Relationships",null,{xmlns:hn.RELS})];return Tn(e["!id"]).forEach(function(r){t[t.length]=Xe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function er(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[$t.HLINK,$t.XPATH,$t.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function RP(e){var t=[Zr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function I5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function MP(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function BP(e){var t=[Zr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(I5(e[r][0],e[r][1])),t.push(MP("",e[r][0]));return t.push(I5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function T3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+q0.version+"</meta:generator></office:meta></office:document-meta>"}var yl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function w1(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=rr(t),n[n.length]=r?Xe(e,t,r):kn(e,t))}function C3(e,t){var r=t||{},n=[Zr,Xe("cp:coreProperties",null,{"xmlns:cp":hn.CORE_PROPS,"xmlns:dc":hn.dc,"xmlns:dcterms":hn.dcterms,"xmlns:dcmitype":hn.dcmitype,"xmlns:xsi":hn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&w1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Gg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&w1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Gg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=yl.length;++s){var a=yl[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&w1(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],P3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function L3(e){var t=[],r=Xe;return e||(e={}),e.Application="SheetJS",t[t.length]=Zr,t[t.length]=Xe("Properties",null,{xmlns:hn.EXT_PROPS,"xmlns:vt":hn.vt}),Vc.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=rr(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+rr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function F3(e){var t=[Zr,Xe("Properties",null,{xmlns:hn.CUST_PROPS,"xmlns:vt":hn.vt})];if(!e)return t.join("");var r=1;return Tn(e).forEach(function(i){++r,t[t.length]=Xe("property",nP(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rr(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var R5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function UP(e,t){var r=[];return Tn(R5).map(function(n){for(var i=0;i<yl.length;++i)if(yl[i][1]==n)return yl[i];for(i=0;i<Vc.length;++i)if(Vc[i][1]==n)return Vc[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(kn(R5[n[1]]||n[1],i))}}),Xe("DocumentProperties",r.join(""),{xmlns:Ci.o})}function zP(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Tn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<yl.length;++a)if(s==yl[a][1])return;for(a=0;a<Vc.length;++a)if(s==Vc[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Xe(N5(s),o,{"dt:dt":l}))}}),t&&Tn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Xe(N5(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Ci.o+'">'+i.join("")+"</"+n+">"}function WP(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Fe(8);return a.write_shift(4,n),a.write_shift(4,i),a}function M5(e,t){var r=Fe(4),n=Fe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Fe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=WP(t);break;case 31:case 80:for(n=Fe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Nn([r,n])}var O3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function HP(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function B5(e,t,r){var n=Fe(8),i=[],s=[],a=8,o=0,l=Fe(8),u=Fe(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!t){u=Fe(8),u.write_shift(4,0),i.unshift(u);var f=[Fe(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var m=e[o][0];for(l=Fe(8+2*(m.length+1)+(m.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,m.length+1),l.write_shift(0,m,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Nn(f),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(O3.indexOf(e[o][0])>-1||P3.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],h=0;if(t){h=+t[e[o][0]];var v=r[h];if(v.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}l=M5(v.t,p)}else{var b=HP(p);b==-1&&(b=31,p=String(p)),l=M5(b,p)}s.push(l),u=Fe(8),u.write_shift(4,t?h:2+o),i.push(u),a+=8+l.length}var y=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,y),y+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Nn([n].concat(i).concat(s))}function U5(e,t,r,n,i,s){var a=Fe(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,or.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=B5(e,r,n);if(o.push(l),i){var u=B5(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Nn(o)}function $P(e,t){t||(t=Fe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function qP(e,t){return e.read_shift(t)===1}function Kn(e,t){return t||(t=Fe(2)),t.write_shift(2,+!!e),t}function D3(e){return e.read_shift(2,"u")}function Ji(e,t){return t||(t=Fe(2)),t.write_shift(2,e),t}function I3(e,t,r){return r||(r=Fe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function R3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function VP(e){var t=e.t||"",r=Fe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Fe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Nn(i)}function GP(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function YP(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):GP(e,n,r)}function KP(e,t,r){if(r.biff>5)return YP(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function M3(e,t,r){return r||(r=Fe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function z5(e,t){t||(t=Fe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function XP(e){var t=Fe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),z5(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&z5(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Tl(e,t,r,n){return n||(n=Fe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function JP(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function QP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function B3(e,t){return t||(t=Fe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function bx(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Fe(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function ZP(e,t){var r=!t||t.biff==8,n=Fe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function eL(e,t){var r=!t||t.biff>=8?2:1,n=Fe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function tL(e,t){var r=Fe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=VP(e[i]);var s=Nn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function rL(){var e=Fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function nL(e){var t=Fe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function iL(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=Fe(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function sL(e,t,r,n){var i=Fe(10);return Tl(e,t,n,i),i.write_shift(4,r),i}function aL(e,t,r,n,i){var s=!i||i.biff==8,a=Fe(8+ +s+(1+s)*r.length);return Tl(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function oL(e,t,r,n){var i=r&&r.biff==5;n||(n=Fe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function lL(e,t){var r=t.biff==8||!t.biff?4:2,n=Fe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function W5(e,t,r,n){var i=r&&r.biff==5;n||(n=Fe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function cL(e){var t=Fe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function uL(e,t,r,n,i,s){var a=Fe(8);return Tl(e,t,n,a),I3(r,s,a),a}function fL(e,t,r,n){var i=Fe(14);return Tl(e,t,n,i),Al(r,i),i}function dL(e,t,r){if(r.biff<8)return hL(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(JP(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function hL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=R3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function mL(e){var t=Fe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)B3(e[r],t);return t}function pL(e){var t=Fe(24),r=pn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Nn([t,XP(e[1])])}function gL(e){var t=e[1].Tooltip,r=Fe(10+2*(t.length+1));r.write_shift(2,2048);var n=pn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function xL(e){return e||(e=Fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function vL(e,t,r){if(!r.cellStyles)return Zs(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function yL(e,t){var r=Fe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function wL(e){for(var t=Fe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function bL(e,t,r){var n=Fe(15);return Fd(n,e,t),n.write_shift(8,r,"f"),n}function _L(e,t,r){var n=Fe(9);return Fd(n,e,t),n.write_shift(2,r),n}var SL=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ux({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=jl(1);switch(l.type){case"base64":f=ks(Aa(o));break;case"binary":f=ks(o);break;case"buffer":case"array":f=o;break}Ti(f,0);var m=f.read_shift(1),p=!!(m&136),h=!1,v=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var g=0,b=521;m==2&&(g=f.read_shift(2)),f.l+=3,m!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),m!=2&&(b=f.read_shift(2));var y=f.read_shift(2),w=l.codepage||1252;m!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var _=[],j={},O=Math.min(f.length,m==2?521:b-10-(h?264:0)),L=v?32:11;f.l<O&&f[f.l]!=13;)switch(j={},j.name=d5.utils.decode(w,f.slice(f.l,f.l+L)).replace(/[\u0000\r\n].*$/g,""),f.l+=L,j.type=String.fromCharCode(f.read_shift(1)),m!=2&&!v&&(j.offset=f.read_shift(4)),j.len=f.read_shift(1),m==2&&(j.offset=f.read_shift(2)),j.dec=f.read_shift(1),j.name.length&&_.push(j),m!=2&&(f.l+=v?13:14),j.type){case"B":(!h||j.len!=8)&&l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(f[f.l]!==13&&(f.l=b-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=b;var E=0,C=0;for(u[0]=[],C=0;C!=_.length;++C)u[0][C]=_[C].name;for(;g-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++E]=[],C=0,C=0;C!=_.length;++C){var P=f.slice(f.l,f.l+_[C].len);f.l+=_[C].len,Ti(P,0);var R=d5.utils.decode(w,P);switch(_[C].type){case"C":R.trim().length&&(u[E][C]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[E][C]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[E][C]=R;break;case"F":u[E][C]=parseFloat(R.trim());break;case"+":case"I":u[E][C]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[E][C]=!0;break;case"N":case"F":u[E][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[E][C]="##MEMO##"+(v?parseInt(R.trim(),10):P.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[E][C]=+R||0);break;case"@":u[E][C]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[E][C]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[E][C]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][C]=-P.read_shift(-8,"f");break;case"B":if(h&&_[C].len==8){u[E][C]=P.read_shift(8,"f");break}case"G":case"P":P.l+=_[C].len;break;case"0":if(_[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[C].type)}}}if(m!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=gu(r(o,u),u);return f["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,f}function i(o,l){try{return Dl(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&dd(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=pi(),m=im(o,{header:1,raw:!0,cellDates:!0}),p=m[0],h=m.slice(1),v=o["!cols"]||[],g=0,b=0,y=0,w=1;for(g=0;g<p.length;++g){if(((v[g]||{}).DBF||{}).name){p[g]=v[g].DBF.name,++y;continue}if(p[g]!=null){if(++y,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(b=0;b<1024;++b)if(p.indexOf(p[g]+"_"+b)==-1){p[g]+="_"+b;break}}}}var _=wr(o["!ref"]),j=[],O=[],L=[];for(g=0;g<=_.e.c-_.s.c;++g){var E="",C="",P=0,R=[];for(b=0;b<h.length;++b)h[b][g]!=null&&R.push(h[b][g]);if(R.length==0||p[g]==null){j[g]="?";continue}for(b=0;b<R.length;++b){switch(typeof R[b]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=R[b]instanceof Date?"D":"C";break;default:C="C"}P=Math.max(P,String(R[b]).length),E=E&&E!=C?"C":C}P>250&&(P=250),C=((v[g]||{}).DBF||{}).type,C=="C"&&v[g].DBF.len>P&&(P=v[g].DBF.len),E=="B"&&C=="N"&&(E="N",L[g]=v[g].DBF.dec,P=v[g].DBF.len),O[g]=E=="C"||C=="N"?P:s[E]||0,w+=O[g],j[g]=E}var T=f.next(32);for(T.write_shift(4,318902576),T.write_shift(4,h.length),T.write_shift(2,296+32*y),T.write_shift(2,w),g=0;g<4;++g)T.write_shift(4,0);for(T.write_shift(4,0|(+t[z_]||3)<<8),g=0,b=0;g<p.length;++g)if(p[g]!=null){var A=f.next(32),q=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,q,"sbcs"),A.write_shift(1,j[g]=="?"?"C":j[g],"sbcs"),A.write_shift(4,b),A.write_shift(1,O[g]||s[j[g]]||0),A.write_shift(1,L[g]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),b+=O[g]||s[j[g]]||0}var z=f.next(264);for(z.write_shift(4,13),g=0;g<65;++g)z.write_shift(4,0);for(g=0;g<h.length;++g){var ne=f.next(w);for(ne.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(j[b]){case"L":ne.write_shift(1,h[g][b]==null?63:h[g][b]?84:70);break;case"B":ne.write_shift(8,h[g][b]||0,"f");break;case"N":var U="0";for(typeof h[g][b]=="number"&&(U=h[g][b].toFixed(L[b]||0)),y=0;y<O[b]-U.length;++y)ne.write_shift(1,32);ne.write_shift(1,U,"sbcs");break;case"D":h[g][b]?(ne.write_shift(4,("0000"+h[g][b].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(h[g][b].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+h[g][b].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var G=String(h[g][b]!=null?h[g][b]:"").slice(0,O[b]);for(ne.write_shift(1,G,"sbcs"),y=0;y<O[b]-G.length;++y)ne.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),NL=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var v=e[h];return typeof v=="number"?f5(v):v},n=function(p,h,v){var g=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?p:f5(g)};e["|"]=254;function i(p,h){switch(h.type){case"base64":return s(Aa(p),h);case"binary":return s(p,h);case"buffer":return s(Vt&&Buffer.isBuffer(p)?p.toString("binary"):Ad(p),h);case"array":return s(Um(p),h)}throw new Error("Unrecognized type "+h.type)}function s(p,h){var v=p.split(/[\n\r]+/),g=-1,b=-1,y=0,w=0,_=[],j=[],O=null,L={},E=[],C=[],P=[],R=0,T;for(+h.codepage>=0&&dd(+h.codepage);y!==v.length;++y){R=0;var A=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=A.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),z=q[0],ne;if(A.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&j.push(A.slice(3).replace(/;;/g,";"));break;case"C":var U=!1,G=!1,B=!1,Y=!1,re=-1,he=-1;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"A":break;case"X":b=parseInt(q[w].slice(1))-1,G=!0;break;case"Y":for(g=parseInt(q[w].slice(1))-1,G||(b=0),T=_.length;T<=g;++T)_[T]=[];break;case"K":ne=q[w].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(ba(ne))?isNaN(md(ne).getDate())||(ne=Qn(ne)):(ne=ba(ne),O!==null&&Z_(O)&&(ne=n3(ne))),U=!0;break;case"E":Y=!0;var k=_F(q[w].slice(1),{r:g,c:b});_[g][b]=[_[g][b],k];break;case"S":B=!0,_[g][b]=[_[g][b],"S5S"];break;case"G":break;case"R":re=parseInt(q[w].slice(1))-1;break;case"C":he=parseInt(q[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}if(U&&(_[g][b]&&_[g][b].length==2?_[g][b][0]=ne:_[g][b]=ne,O=null),B){if(Y)throw new Error("SYLK shared formula cannot have own formula");var I=re>-1&&_[re][he];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");_[g][b][1]=SF(I[1],{r:g-re,c:b-he})}break;case"F":var M=0;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"X":b=parseInt(q[w].slice(1))-1,++M;break;case"Y":for(g=parseInt(q[w].slice(1))-1,T=_.length;T<=g;++T)_[T]=[];break;case"M":R=parseInt(q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":O=j[parseInt(q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=q[w].slice(1).split(" "),T=parseInt(P[0],10);T<=parseInt(P[1],10);++T)R=parseInt(P[2],10),C[T-1]=R===0?{hidden:!0}:{wch:R},_x(C[T-1]);break;case"C":b=parseInt(q[w].slice(1))-1,C[b]||(C[b]={});break;case"R":g=parseInt(q[w].slice(1))-1,E[g]||(E[g]={}),R>0?(E[g].hpt=R,E[g].hpx=$3(R)):R===0&&(E[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}M<1&&(O=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}}return E.length>0&&(L["!rows"]=E),C.length>0&&(L["!cols"]=C),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,L]}function a(p,h){var v=i(p,h),g=v[0],b=v[1],y=gu(g,h);return Tn(b).forEach(function(w){y[w]=b[w]}),y}function o(p,h){return Dl(a(p,h),h)}function l(p,h,v,g){var b="C;Y"+(v+1)+";X"+(g+1)+";K";switch(p.t){case"n":b+=p.v||0,p.f&&!p.F&&(b+=";E"+Nx(p.f,{r:v,c:g}));break;case"b":b+=p.v?"TRUE":"FALSE";break;case"e":b+=p.w||p.v;break;case"d":b+='"'+(p.w||p.v)+'"';break;case"s":b+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function u(p,h){h.forEach(function(v,g){var b="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?b+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=em(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=tm(v.wpx)),typeof v.wch=="number"&&(b+=Math.round(v.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function f(p,h){h.forEach(function(v,g){var b="F;";v.hidden?b+="M0;":v.hpt?b+="M"+20*v.hpt+";":v.hpx&&(b+="M"+20*rm(v.hpx)+";"),b.length>2&&p.push(b+"R"+(g+1))})}function m(p,h){var v=["ID;PWXL;N;E"],g=[],b=wr(p["!ref"]),y,w=Array.isArray(p),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&u(v,p["!cols"]),p["!rows"]&&f(v,p["!rows"]),v.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var j=b.s.r;j<=b.e.r;++j)for(var O=b.s.c;O<=b.e.c;++O){var L=ir({r:j,c:O});y=w?(p[j]||[])[O]:p[L],!(!y||y.v==null&&(!y.f||y.F))&&g.push(l(y,p,j,O))}return v.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:m}}(),kL=function(){function e(s,a){switch(a.type){case"base64":return t(Aa(s),a);case"binary":return t(s,a);case"buffer":return t(Vt&&Buffer.isBuffer(s)?s.toString("binary"):Ad(s),a);case"array":return t(Um(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,m=[];f!==o.length;++f){if(o[f].trim()==="BOT"){m[++l]=[],u=0;continue}if(!(l<0)){var p=o[f].trim().split(","),h=p[0],v=p[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+h){case-1:if(g==="BOT"){m[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?m[l][u]=!0:g==="FALSE"?m[l][u]=!1:isNaN(ba(v))?isNaN(md(v).getDate())?m[l][u]=v:m[l][u]=Qn(v):m[l][u]=ba(v),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),m[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(m=m.slice(0,a.sheetRows)),m}function r(s,a){return gu(e(s,a),a)}function n(s,a){return Dl(r(s,a),a)}var i=function(){var s=function(l,u,f,m,p){l.push(u),l.push(f+","+m),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,u,f,m){l.push(u+","+f),l.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(l){var u=[],f=wr(l["!ref"]),m,p=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){a(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var g=ir({r:h,c:v});if(m=p?(l[h]||[])[v]:l[g],!m){a(u,1,0,"");continue}switch(m.t){case"n":var b=m.w;!b&&m.v!=null&&(b=m.v),b==null?m.f&&!m.F?a(u,1,0,"="+m.f):a(u,1,0,""):a(u,0,b,"V");break;case"b":a(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Po(m.z||Or[14],gi(Qn(m.v)))),a(u,0,m.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),U3=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,p){for(var h=m.split(`
`),v=-1,g=-1,b=0,y=[];b!==h.length;++b){var w=h[b].trim().split(":");if(w[0]==="cell"){var _=pn(w[1]);if(y.length<=_.r)for(v=y.length;v<=_.r;++v)y[v]||(y[v]=[]);switch(v=_.r,g=_.c,w[2]){case"t":y[v][g]=e(w[3]);break;case"v":y[v][g]=+w[3];break;case"vtf":var j=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[v][g]=!!+w[4];break;default:y[v][g]=+w[4];break}w[2]=="vtf"&&(y[v][g]=[y[v][g],j])}}}return p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),y}function n(m,p){return gu(r(m,p),p)}function i(m,p){return Dl(n(m,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var p=[],h=[],v,g="",b=Ri(m["!ref"]),y=Array.isArray(m),w=b.s.r;w<=b.e.r;++w)for(var _=b.s.c;_<=b.e.c;++_)if(g=ir({r:w,c:_}),v=y?(m[w]||[])[_]:m[g],!(!v||v.v==null||v.t==="z")){switch(h=["cell",g,"t"],v.t){case"s":case"str":h.push(t(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=t(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var j=gi(Qn(v.v));h[2]="vtc",h[3]="nd",h[4]=""+j,h[5]=v.w||Po(v.z||Or[14],j);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(m){return[s,a,o,a,u(m),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),EL=function(){function e(f,m,p,h,v){v.raw?m[p][h]=f:f===""||(f==="TRUE"?m[p][h]=!0:f==="FALSE"?m[p][h]=!1:isNaN(ba(f))?isNaN(md(f).getDate())?m[p][h]=f:m[p][h]=Qn(f):m[p][h]=ba(f))}function t(f,m){var p=m||{},h=[];if(!f||f.length===0)return h;for(var v=f.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var b=10,y=0,w=0;w<=g;++w)y=v[w].indexOf(" "),y==-1?y=v[w].length:y++,b=Math.max(b,y);for(w=0;w<=g;++w){h[w]=[];var _=0;for(e(v[w].slice(0,b).trim(),h,w,_,p),_=1;_<=(v[w].length-b)/10+1;++_)e(v[w].slice(b+(_-1)*10,b+_*10).trim(),h,w,_,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var m={},p=!1,h=0,v=0;h<f.length;++h)(v=f.charCodeAt(h))==34?p=!p:!p&&v in r&&(m[v]=(m[v]||0)+1);v=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&v.push([m[h],h]);if(!v.length){m=n;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&v.push([m[h],h])}return v.sort(function(g,b){return g[0]-b[0]||n[g[1]]-n[b[1]]}),r[v.pop()[1]]||44}function s(f,m){var p=m||{},h="",v=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=i(f.slice(0,1024)):p&&p.FS?h=p.FS:h=i(f.slice(0,1024));var b=0,y=0,w=0,_=0,j=0,O=h.charCodeAt(0),L=!1,E=0,C=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var P=p.dateNF!=null?W7(p.dateNF):null;function R(){var T=f.slice(_,j),A={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)A.t="z";else if(p.raw)A.t="s",A.v=T;else if(T.trim().length===0)A.t="s",A.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(A.t="s",A.v=T.slice(2,-1).replace(/""/g,'"')):NF(T)?(A.t="n",A.f=T.slice(1)):(A.t="s",A.v=T);else if(T=="TRUE")A.t="b",A.v=!0;else if(T=="FALSE")A.t="b",A.v=!1;else if(!isNaN(w=ba(T)))A.t="n",p.cellText!==!1&&(A.w=T),A.v=w;else if(!isNaN(md(T).getDate())||P&&T.match(P)){A.z=p.dateNF||Or[14];var q=0;P&&T.match(P)&&(T=H7(T,p.dateNF,T.match(P)||[]),q=1),p.cellDates?(A.t="d",A.v=Qn(T,q)):(A.t="n",A.v=gi(Qn(T,q))),p.cellText!==!1&&(A.w=Po(A.z,A.v instanceof Date?gi(A.v):A.v)),p.cellNF||delete A.z}else A.t="s",A.v=T;if(A.t=="z"||(p.dense?(v[b]||(v[b]=[]),v[b][y]=A):v[ir({c:y,r:b})]=A),_=j+1,C=f.charCodeAt(_),g.e.c<y&&(g.e.c=y),g.e.r<b&&(g.e.r=b),E==O)++y;else if(y=0,++b,p.sheetRows&&p.sheetRows<=b)return!0}e:for(;j<f.length;++j)switch(E=f.charCodeAt(j)){case 34:C===34&&(L=!L);break;case O:case 10:case 13:if(!L&&R())break e;break}return j-_>0&&R(),v["!ref"]=Qr(g),v}function a(f,m){return!(m&&m.PRN)||m.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,m):gu(t(f,m),m)}function o(f,m){var p="",h=m.type=="string"?[0,0,0,0]:MI(f,m);switch(m.type){case"base64":p=Aa(f);break;case"binary":p=f;break;case"buffer":m.codepage==65001?p=f.toString("utf8"):(m.codepage,p=Vt&&Buffer.isBuffer(f)?f.toString("binary"):Ad(f));break;case"array":p=Um(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=If(p.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?p=If(p):m.type=="binary",p.slice(0,19)=="socialcalc:version:"?U3.to_sheet(m.type=="string"?p:If(p),m):a(p,m)}function l(f,m){return Dl(o(f,m),m)}function u(f){for(var m=[],p=wr(f["!ref"]),h,v=Array.isArray(f),g=p.s.r;g<=p.e.r;++g){for(var b=[],y=p.s.c;y<=p.e.c;++y){var w=ir({r:g,c:y});if(h=v?(f[g]||[])[y]:f[w],!h||h.v==null){b.push("          ");continue}for(var _=(h.w||(Ta(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";b.push(_+(y===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),H5=function(){function e(k,I,M){if(k){Ti(k,k.l||0);for(var D=M.Enum||re;k.l<k.length;){var V=k.read_shift(2),se=D[V]||D[65535],fe=k.read_shift(2),de=k.l+fe,ve=se.f&&se.f(k,fe,M);if(k.l=de,I(ve,se,V))return}}}function t(k,I){switch(I.type){case"base64":return r(ks(Aa(k)),I);case"binary":return r(ks(k),I);case"buffer":case"array":return r(k,I)}throw"Unsupported type "+I.type}function r(k,I){if(!k)return k;var M=I||{},D=M.dense?[]:{},V="Sheet1",se="",fe=0,de={},ve=[],Ee=[],Oe={s:{r:0,c:0},e:{r:0,c:0}},Ve=M.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)M.Enum=re,e(k,function(Me,at,ze){switch(ze){case 0:M.vers=Me,Me>=4096&&(M.qpro=!0);break;case 6:Oe=Me;break;case 204:Me&&(se=Me);break;case 222:se=Me;break;case 15:case 51:M.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:ze==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=M.dateNF||Or[14],M.cellDates&&(Me[1].t="d",Me[1].v=n3(Me[1].v))),M.qpro&&Me[3]>fe&&(D["!ref"]=Qr(Oe),de[V]=D,ve.push(V),D=M.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],V=se||"Sheet"+(fe+1),se="");var Ye=M.dense?(D[Me[0].r]||[])[Me[0].c]:D[ir(Me[0])];if(Ye){Ye.t=Me[1].t,Ye.v=Me[1].v,Me[1].z!=null&&(Ye.z=Me[1].z),Me[1].f!=null&&(Ye.f=Me[1].f);break}M.dense?(D[Me[0].r]||(D[Me[0].r]=[]),D[Me[0].r][Me[0].c]=Me[1]):D[ir(Me[0])]=Me[1];break}},M);else if(k[2]==26||k[2]==14)M.Enum=he,k[2]==14&&(M.qpro=!0,k.l=0),e(k,function(Me,at,ze){switch(ze){case 204:V=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>fe&&(D["!ref"]=Qr(Oe),de[V]=D,ve.push(V),D=M.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],V="Sheet"+(fe+1)),Ve>0&&Me[0].r>=Ve)break;M.dense?(D[Me[0].r]||(D[Me[0].r]=[]),D[Me[0].r][Me[0].c]=Me[1]):D[ir(Me[0])]=Me[1],Oe.e.c<Me[0].c&&(Oe.e.c=Me[0].c),Oe.e.r<Me[0].r&&(Oe.e.r=Me[0].r);break;case 27:Me[14e3]&&(Ee[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Ee[Me[0]]=Me[1],Me[0]==fe&&(V=Me[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(D["!ref"]=Qr(Oe),de[se||V]=D,ve.push(se||V),!Ee.length)return{SheetNames:ve,Sheets:de};for(var Qe={},Te=[],ue=0;ue<Ee.length;++ue)de[ve[ue]]?(Te.push(Ee[ue]||ve[ue]),Qe[Ee[ue]]=de[Ee[ue]]||de[ve[ue]]):(Te.push(Ee[ue]),Qe[Ee[ue]]={"!ref":"A1"});return{SheetNames:Te,Sheets:Qe}}function n(k,I){var M=I||{};if(+M.codepage>=0&&dd(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var D=pi(),V=wr(k["!ref"]),se=Array.isArray(k),fe=[];Je(D,0,s(1030)),Je(D,6,l(V));for(var de=Math.min(V.e.r,8191),ve=V.s.r;ve<=de;++ve)for(var Ee=jn(ve),Oe=V.s.c;Oe<=V.e.c;++Oe){ve===V.s.r&&(fe[Oe]=zn(Oe));var Ve=fe[Oe]+Ee,Qe=se?(k[ve]||[])[Oe]:k[Ve];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")(Qe.v|0)==Qe.v&&Qe.v>=-32768&&Qe.v<=32767?Je(D,13,h(ve,Oe,Qe.v)):Je(D,14,g(ve,Oe,Qe.v));else{var Te=Ta(Qe);Je(D,15,m(ve,Oe,Te.slice(0,239)))}}return Je(D,1),D.end()}function i(k,I){var M=I||{};if(+M.codepage>=0&&dd(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var D=pi();Je(D,0,a(k));for(var V=0,se=0;V<k.SheetNames.length;++V)(k.Sheets[k.SheetNames[V]]||{})["!ref"]&&Je(D,27,Y(k.SheetNames[V],se++));var fe=0;for(V=0;V<k.SheetNames.length;++V){var de=k.Sheets[k.SheetNames[V]];if(!(!de||!de["!ref"])){for(var ve=wr(de["!ref"]),Ee=Array.isArray(de),Oe=[],Ve=Math.min(ve.e.r,8191),Qe=ve.s.r;Qe<=Ve;++Qe)for(var Te=jn(Qe),ue=ve.s.c;ue<=ve.e.c;++ue){Qe===ve.s.r&&(Oe[ue]=zn(ue));var Me=Oe[ue]+Te,at=Ee?(de[Qe]||[])[ue]:de[Me];if(!(!at||at.t=="z"))if(at.t=="n")Je(D,23,R(Qe,ue,fe,at.v));else{var ze=Ta(at);Je(D,22,E(Qe,ue,fe,ze.slice(0,239)))}}++fe}}return Je(D,1),D.end()}function s(k){var I=Fe(2);return I.write_shift(2,k),I}function a(k){var I=Fe(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var M=0,D=0,V=0,se=0;se<k.SheetNames.length;++se){var fe=k.SheetNames[se],de=k.Sheets[fe];if(!(!de||!de["!ref"])){++V;var ve=Ri(de["!ref"]);M<ve.e.r&&(M=ve.e.r),D<ve.e.c&&(D=ve.e.c)}}return M>8191&&(M=8191),I.write_shift(2,M),I.write_shift(1,V),I.write_shift(1,D),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(k,I,M){var D={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&M.qpro?(D.s.c=k.read_shift(1),k.l++,D.s.r=k.read_shift(2),D.e.c=k.read_shift(1),k.l++,D.e.r=k.read_shift(2),D):(D.s.c=k.read_shift(2),D.s.r=k.read_shift(2),I==12&&M.qpro&&(k.l+=2),D.e.c=k.read_shift(2),D.e.r=k.read_shift(2),I==12&&M.qpro&&(k.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function l(k){var I=Fe(8);return I.write_shift(2,k.s.c),I.write_shift(2,k.s.r),I.write_shift(2,k.e.c),I.write_shift(2,k.e.r),I}function u(k,I,M){var D=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(D[0].c=k.read_shift(1),D[3]=k.read_shift(1),D[0].r=k.read_shift(2),k.l+=2):(D[2]=k.read_shift(1),D[0].c=k.read_shift(2),D[0].r=k.read_shift(2)),D}function f(k,I,M){var D=k.l+I,V=u(k,I,M);if(V[1].t="s",M.vers==20768){k.l++;var se=k.read_shift(1);return V[1].v=k.read_shift(se,"utf8"),V}return M.qpro&&k.l++,V[1].v=k.read_shift(D-k.l,"cstr"),V}function m(k,I,M){var D=Fe(7+M.length);D.write_shift(1,255),D.write_shift(2,I),D.write_shift(2,k),D.write_shift(1,39);for(var V=0;V<D.length;++V){var se=M.charCodeAt(V);D.write_shift(1,se>=128?95:se)}return D.write_shift(1,0),D}function p(k,I,M){var D=u(k,I,M);return D[1].v=k.read_shift(2,"i"),D}function h(k,I,M){var D=Fe(7);return D.write_shift(1,255),D.write_shift(2,I),D.write_shift(2,k),D.write_shift(2,M,"i"),D}function v(k,I,M){var D=u(k,I,M);return D[1].v=k.read_shift(8,"f"),D}function g(k,I,M){var D=Fe(13);return D.write_shift(1,255),D.write_shift(2,I),D.write_shift(2,k),D.write_shift(8,M,"f"),D}function b(k,I,M){var D=k.l+I,V=u(k,I,M);if(V[1].v=k.read_shift(8,"f"),M.qpro)k.l=D;else{var se=k.read_shift(2);j(k.slice(k.l,k.l+se),V),k.l+=se}return V}function y(k,I,M){var D=I&32768;return I&=-32769,I=(D?k:0)+(I>=8192?I-16384:I),(D?"":"$")+(M?zn(I):jn(I))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(k,I){Ti(k,0);for(var M=[],D=0,V="",se="",fe="",de="";k.l<k.length;){var ve=k[k.l++];switch(ve){case 0:M.push(k.read_shift(8,"f"));break;case 1:se=y(I[0].c,k.read_shift(2),!0),V=y(I[0].r,k.read_shift(2),!1),M.push(se+V);break;case 2:{var Ee=y(I[0].c,k.read_shift(2),!0),Oe=y(I[0].r,k.read_shift(2),!1);se=y(I[0].c,k.read_shift(2),!0),V=y(I[0].r,k.read_shift(2),!1),M.push(Ee+Oe+":"+se+V)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(k.read_shift(2));break;case 6:{for(var Ve="";ve=k[k.l++];)Ve+=String.fromCharCode(ve);M.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:de=M.pop(),fe=M.pop(),M.push(["AND","OR"][ve-20]+"("+fe+","+de+")");break;default:if(ve<32&&_[ve])de=M.pop(),fe=M.pop(),M.push(fe+_[ve]+de);else if(w[ve]){if(D=w[ve][1],D==69&&(D=k[k.l++]),D>M.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+M.join("|")+"|");return}var Qe=M.slice(-D);M.length-=D,M.push(w[ve][0]+"("+Qe.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}M.length==1?I[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function O(k){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=k.read_shift(2),I[3]=k[k.l++],I[0].c=k[k.l++],I}function L(k,I){var M=O(k);return M[1].t="s",M[1].v=k.read_shift(I-4,"cstr"),M}function E(k,I,M,D){var V=Fe(6+D.length);V.write_shift(2,k),V.write_shift(1,M),V.write_shift(1,I),V.write_shift(1,39);for(var se=0;se<D.length;++se){var fe=D.charCodeAt(se);V.write_shift(1,fe>=128?95:fe)}return V.write_shift(1,0),V}function C(k,I){var M=O(k);M[1].v=k.read_shift(2);var D=M[1].v>>1;if(M[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return M[1].v=D,M}function P(k,I){var M=O(k),D=k.read_shift(4),V=k.read_shift(4),se=k.read_shift(2);if(se==65535)return D===0&&V===3221225472?(M[1].t="e",M[1].v=15):D===0&&V===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var fe=se&32768;return se=(se&32767)-16446,M[1].v=(1-fe*2)*(V*Math.pow(2,se+32)+D*Math.pow(2,se)),M}function R(k,I,M,D){var V=Fe(14);if(V.write_shift(2,k),V.write_shift(1,M),V.write_shift(1,I),D==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var se=0,fe=0,de=0,ve=0;return D<0&&(se=1,D=-D),fe=Math.log2(D)|0,D/=Math.pow(2,fe-31),ve=D>>>0,ve&2147483648||(D/=2,++fe,ve=D>>>0),D-=ve,ve|=2147483648,ve>>>=0,D*=Math.pow(2,32),de=D>>>0,V.write_shift(4,de),V.write_shift(4,ve),fe+=16383+(se?32768:0),V.write_shift(2,fe),V}function T(k,I){var M=P(k);return k.l+=I-14,M}function A(k,I){var M=O(k),D=k.read_shift(4);return M[1].v=D>>6,M}function q(k,I){var M=O(k),D=k.read_shift(8,"f");return M[1].v=D,M}function z(k,I){var M=q(k);return k.l+=I-10,M}function ne(k,I){return k[k.l+I-1]==0?k.read_shift(I,"cstr"):""}function U(k,I){var M=k[k.l++];M>I-1&&(M=I-1);for(var D="";D.length<M;)D+=String.fromCharCode(k[k.l++]);return D}function G(k,I,M){if(!(!M.qpro||I<21)){var D=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var V=k.read_shift(I-21,"cstr");return[D,V]}}function B(k,I){for(var M={},D=k.l+I;k.l<D;){var V=k.read_shift(2);if(V==14e3){for(M[V]=[0,""],M[V][0]=k.read_shift(2);k[k.l];)M[V][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return M}function Y(k,I){var M=Fe(5+k.length);M.write_shift(2,14e3),M.write_shift(2,I);for(var D=0;D<k.length;++D){var V=k.charCodeAt(D);M[M.l++]=V>127?95:V}return M[M.l++]=0,M}var re={0:{n:"BOF",f:D3},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:U},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:B},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:G},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),jL=/^\s|\s$|[\t\n\r]/;function z3(e,t){if(!t.bookSST)return"";var r=[Zr];r[r.length]=Xe("sst",null,{xmlns:pu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(jL)&&(s+=' xml:space="preserve"'),s+=">"+rr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function AL(e){return[e.read_shift(4),e.read_shift(4)]}function TL(e,t){return t||(t=Fe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var CL=wP;function PL(e){var t=pi();Be(t,159,TL(e));for(var r=0;r<e.length;++r)Be(t,19,CL(e[r]));return Be(t,160),t.end()}function LL(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function W3(e){var t=0,r,n=LL(e),i=n.length+1,s,a,o,l,u;for(r=jl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^a;return t^52811}var FL=function(){function e(i,s){switch(s.type){case"base64":return t(Aa(i),s);case"binary":return t(i,s);case"buffer":return t(Vt&&Buffer.isBuffer(i)?i.toString("binary"):Ad(i),s);case"array":return t(Um(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,m){Array.isArray(o)&&(o[m]=[]);for(var p=/\\\w+\b/g,h=0,v,g=-1;v=p.exec(f);){switch(v[0]){case"\\cell":var b=f.slice(h,p.lastIndex-v[0].length);if(b[0]==" "&&(b=b.slice(1)),++g,b.length){var y={v:b,t:"s"};Array.isArray(o)?o[m][g]=y:o[ir({r:m,c:g})]=y}break}h=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=Qr(u),o}function r(i,s){return Dl(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=wr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var m=ir({r:u,c:f});o=l?(i[u]||[])[f]:i[m],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ta(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function $5(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var OL=6,_a=OL;function em(e){return Math.floor((e+Math.round(128/_a)/256)*_a)}function tm(e){return Math.floor((e-5)/_a*100+.5)/100}function Kg(e){return Math.round((e*_a+5)/_a*256)/256}function _x(e){e.width?(e.wpx=em(e.width),e.wch=tm(e.wpx),e.MDW=_a):e.wpx?(e.wch=tm(e.wpx),e.width=Kg(e.wch),e.MDW=_a):typeof e.wch=="number"&&(e.width=Kg(e.wch),e.wpx=em(e.width),e.MDW=_a),e.customWidth&&delete e.customWidth}var DL=96,H3=DL;function rm(e){return e*96/H3}function $3(e){return e*H3/96}function IL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Xe("numFmt",null,{numFmtId:n,formatCode:rr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function RL(e){var t=[];return t[t.length]=Xe("cellXfs",null),e.forEach(function(r){t[t.length]=Xe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function q3(e,t){var r=[Zr,Xe("styleSheet",null,{xmlns:pu[0],"xmlns:vt":hn.vt})],n;return e.SSF&&(n=IL(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=RL(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ML(e,t){var r=e.read_shift(2),n=Wn(e);return[r,n]}function BL(e,t,r){r||(r=Fe(6+4*t.length)),r.write_shift(2,e),gn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function UL(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=jP(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=EP(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wn(e),n}function zL(e,t){t||(t=Fe(25+4*32)),t.write_shift(2,e.sz*20),AP(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Q0(e.color,t);var n=0;return n=2,t.write_shift(1,n),gn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var WL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],b1,HL=Zs;function q5(e,t){t||(t=Fe(4*3+8*7+16*1)),b1||(b1=ux(WL));var r=b1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Q0({auto:1},t),Q0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function $L(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function V3(e,t,r){r||(r=Fe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function lf(e,t){return t||(t=Fe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var qL=Zs;function VL(e,t){return t||(t=Fe(51)),t.write_shift(1,0),lf(null,t),lf(null,t),lf(null,t),lf(null,t),lf(null,t),t.length>t.l?t.slice(0,t.l):t}function GL(e,t){return t||(t=Fe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),J0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function YL(e,t,r){var n=Fe(2052);return n.write_shift(4,e),J0(t,n),J0(r,n),n.length>n.l?n.slice(0,n.l):n}function KL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Be(e,615,Cs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Be(e,44,BL(i,t[i]))}),Be(e,616))}}function XL(e){var t=1;Be(e,611,Cs(t)),Be(e,43,zL({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(e,612)}function JL(e){var t=2;Be(e,603,Cs(t)),Be(e,45,q5({patternType:"none"})),Be(e,45,q5({patternType:"gray125"})),Be(e,604)}function QL(e){var t=1;Be(e,613,Cs(t)),Be(e,46,VL()),Be(e,614)}function ZL(e){var t=1;Be(e,626,Cs(t)),Be(e,47,V3({numFmtId:0},65535)),Be(e,627)}function eF(e,t){Be(e,617,Cs(t.length)),t.forEach(function(r){Be(e,47,V3(r,0))}),Be(e,618)}function tF(e){var t=1;Be(e,619,Cs(t)),Be(e,48,GL({xfId:0,name:"Normal"})),Be(e,620)}function rF(e){var t=0;Be(e,505,Cs(t)),Be(e,506)}function nF(e){var t=0;Be(e,508,YL(t,"TableStyleMedium9","PivotStyleMedium4")),Be(e,509)}function iF(e,t){var r=pi();return Be(r,278),KL(r,e.SSF),XL(r),JL(r),QL(r),ZL(r),eF(r,t.cellXfs),tF(r),rF(r),nF(r),Be(r,279),r.end()}function G3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Zr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function sF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wn(e)}}function aF(e){var t=Fe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),gn(e.name,t),t.slice(0,t.l)}function oF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function lF(e){var t=Fe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function cF(e,t){var r=Fe(8+2*t.length);return r.write_shift(4,e),gn(t,r),r.slice(0,r.l)}function uF(e){return e.l+=4,e.read_shift(4)!=0}function fF(e,t){var r=Fe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function dF(){var e=pi();return Be(e,332),Be(e,334,Cs(1)),Be(e,335,aF({name:"XLDAPR",version:12e4,flags:3496657072})),Be(e,336),Be(e,339,cF(1,"XLDAPR")),Be(e,52),Be(e,35,Cs(514)),Be(e,4096,Cs(0)),Be(e,4097,Ji(1)),Be(e,36),Be(e,53),Be(e,340),Be(e,337,fF(1)),Be(e,51,lF([[1,0]])),Be(e,338),Be(e,333),e.end()}function Y3(){var e=[Zr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function hF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ir(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ic=1024;function K3(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Xe("xml",null,{"xmlns:v":Ci.v,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:mv":Ci.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ic<e*1e3;)Ic+=1e3;return t.forEach(function(s){var a=pn(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Xe("v:fill",l,o),f={on:"t",obscured:"t"};++Ic,i=i.concat(["<v:shape"+gd({id:"_x0000_s"+Ic,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Xe("v:shadow",null,f),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),kn("x:AutoFill","False"),kn("x:Row",String(a.r)),kn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function X3(e){var t=[Zr,Xe("comments",null,{xmlns:pu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=rr(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(rr(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(kn("t",rr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(kn("t",rr(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function mF(e,t,r){var n=[Zr,Xe("ThreadedComments",null,{xmlns:hn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(Xe("threadedComment",kn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function pF(e){var t=[Zr,Xe("personList",null,{xmlns:hn.TCMNT,"xmlns:x":pu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function gF(e){var t={};t.iauthor=e.read_shift(4);var r=Bl(e);return t.rfx=r.s,t.ref=ir(r.s),e.l+=16,t}function xF(e,t){return t==null&&(t=Fe(36)),t.write_shift(4,e[1].iauthor),xu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var vF=Wn;function yF(e){return gn(e.slice(0,54))}function wF(e){var t=pi(),r=[];return Be(t,628),Be(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Be(t,632,yF(i.a)))})}),Be(t,631),Be(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:pn(n[0]),e:pn(n[0])};Be(t,635,xF([s,i])),i.t&&i.t.length>0&&Be(t,637,_P(i)),Be(t,636),delete i.iauthor})}),Be(t,634),Be(t,629),t.end()}function bF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&or.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var J3=["xlsb","xlsm","xlam","biff8","xla"],_F=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,i+(o?"":"$")+zn(f)+(l?"":"$")+jn(u)}return function(i,s){return t=s,i.replace(e,r)}}(),Sx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Nx=function(){return function(t,r){return t.replace(Sx,function(n,i,s,a,o,l){var u=xx(a)-(s?0:r.c),f=gx(l)-(o?0:r.r),m=f==0?"":o?f+1:"["+f+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+m+"C"+p})}}();function SF(e,t){return e.replace(Sx,function(r,n,i,s,a,o){return n+(i=="$"?i+s:zn(xx(s)+t.c))+(a=="$"?a+o:jn(gx(o)+t.r))})}function NF(e){return e.length!=1}function Kr(e){e.l+=1}function Lo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Q3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Z3(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=Lo(e),o=Lo(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Z3(e){var t=Lo(e),r=Lo(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function kF(e,t,r){if(r.biff<8)return Z3(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Lo(e),a=Lo(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function eS(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return EF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Lo(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function EF(e){var t=Lo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function jF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function AF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return TF(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function TF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function CF(e,t,r){var n=(e[e.l++]&96)>>5,i=Q3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function PF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=Q3(e,s,r);return[n,i,a]}function LF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function OF(e,t,r){var n=(e[e.l++]&96)>>5,i=kF(e,t-1,r);return[n,i]}function DF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function V5(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function IF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function RF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function MF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function BF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function UF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function tS(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function zF(e){return e.read_shift(2),tS(e)}function WF(e){return e.read_shift(2),tS(e)}function HF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=eS(e,0,r);return[n,i]}function $F(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=AF(e,0,r);return[n,i]}function qF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=eS(e,0,r);return[n,i,s]}function VF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[VO[i],iS[i],n]}function GF(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:YF(e);return[i,(s[0]===0?iS:qO)[s[1]]]}function YF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function KF(e,t,r){e.l+=r&&r.biff==2?3:4}function XF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function JF(e){return e.l++,Pd[e.read_shift(1)]}function QF(e){return e.l++,e.read_shift(2)}function ZF(e){return e.l++,e.read_shift(1)!==0}function eO(e){return e.l++,vu(e)}function tO(e,t,r){return e.l++,R3(e,t-1,r)}function rO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=qP(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Pd[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vu(e);break;case 2:r[1]=KP(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function nO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Bl:QP)(e));return i}function iO(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=rO(e,r.biff);return a}function sO(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function aO(e,t,r){if(r.biff==5)return oO(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function oO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function lO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function cO(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function uO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function fO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var dO=Zs,hO=Zs,mO=Zs;function Ld(e,t,r){return e.l+=2,[jF(e)]}function kx(e){return e.l+=6,[]}var pO=Ld,gO=kx,xO=kx,vO=Ld;function rS(e){return e.l+=2,[D3(e),e.read_shift(2)&1]}var yO=Ld,wO=rS,bO=kx,_O=Ld,SO=Ld,NO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function kO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=NO[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function EO(e){return e.l+=2,[e.read_shift(4)]}function jO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function AO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function TO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function CO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function PO(e){return e.l+=4,[0,0]}var G5={1:{n:"PtgExp",f:XF},2:{n:"PtgTbl",f:mO},3:{n:"PtgAdd",f:Kr},4:{n:"PtgSub",f:Kr},5:{n:"PtgMul",f:Kr},6:{n:"PtgDiv",f:Kr},7:{n:"PtgPower",f:Kr},8:{n:"PtgConcat",f:Kr},9:{n:"PtgLt",f:Kr},10:{n:"PtgLe",f:Kr},11:{n:"PtgEq",f:Kr},12:{n:"PtgGe",f:Kr},13:{n:"PtgGt",f:Kr},14:{n:"PtgNe",f:Kr},15:{n:"PtgIsect",f:Kr},16:{n:"PtgUnion",f:Kr},17:{n:"PtgRange",f:Kr},18:{n:"PtgUplus",f:Kr},19:{n:"PtgUminus",f:Kr},20:{n:"PtgPercent",f:Kr},21:{n:"PtgParen",f:Kr},22:{n:"PtgMissArg",f:Kr},23:{n:"PtgStr",f:tO},26:{n:"PtgSheet",f:jO},27:{n:"PtgEndSheet",f:AO},28:{n:"PtgErr",f:JF},29:{n:"PtgBool",f:ZF},30:{n:"PtgInt",f:QF},31:{n:"PtgNum",f:eO},32:{n:"PtgArray",f:DF},33:{n:"PtgFunc",f:VF},34:{n:"PtgFuncVar",f:GF},35:{n:"PtgName",f:sO},36:{n:"PtgRef",f:HF},37:{n:"PtgArea",f:CF},38:{n:"PtgMemArea",f:lO},39:{n:"PtgMemErr",f:dO},40:{n:"PtgMemNoMem",f:hO},41:{n:"PtgMemFunc",f:cO},42:{n:"PtgRefErr",f:uO},43:{n:"PtgAreaErr",f:LF},44:{n:"PtgRefN",f:$F},45:{n:"PtgAreaN",f:OF},46:{n:"PtgMemAreaN",f:TO},47:{n:"PtgMemNoMemN",f:CO},57:{n:"PtgNameX",f:aO},58:{n:"PtgRef3d",f:qF},59:{n:"PtgArea3d",f:PF},60:{n:"PtgRefErr3d",f:fO},61:{n:"PtgAreaErr3d",f:FF},255:{}},LO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FO={1:{n:"PtgElfLel",f:rS},2:{n:"PtgElfRw",f:_O},3:{n:"PtgElfCol",f:pO},6:{n:"PtgElfRwV",f:SO},7:{n:"PtgElfColV",f:vO},10:{n:"PtgElfRadical",f:yO},11:{n:"PtgElfRadicalS",f:bO},13:{n:"PtgElfColS",f:gO},15:{n:"PtgElfColSV",f:xO},16:{n:"PtgElfRadicalLel",f:wO},25:{n:"PtgList",f:kO},29:{n:"PtgSxName",f:EO},255:{}},OO={0:{n:"PtgAttrNoop",f:PO},1:{n:"PtgAttrSemi",f:UF},2:{n:"PtgAttrIf",f:MF},4:{n:"PtgAttrChoose",f:IF},8:{n:"PtgAttrGoto",f:RF},16:{n:"PtgAttrSum",f:KF},32:{n:"PtgAttrBaxcel",f:V5},33:{n:"PtgAttrBaxcel",f:V5},64:{n:"PtgAttrSpace",f:zF},65:{n:"PtgAttrSpaceSemi",f:WF},128:{n:"PtgAttrIfError",f:BF},255:{}};function DO(e,t,r,n){if(n.biff<8)return Zs(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=iO(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=nO(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Zs(e,t)),s}function IO(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=G5[s]||G5[LO[s]],(s===24||s===25)&&(i=(s===24?FO:OO)[e[e.l+1]]),!i||!i.f?Zs(e,t):a.push([i.n,i.f(e,t,r)]);return a}function RO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var MO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function BO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function nS(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Y5(e,t,r){var n=nS(e,t,r);return n=="#REF"?n:BO(n,r)}function iu(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,m=0,p=0,h,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,b="",y=0,w=e[0].length;y<w;++y){var _=e[0][y];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:b=Lr(" ",e[0][g][1][1]);break;case 1:b=Lr("\r",e[0][g][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+b,g=-1}o.push(u+MO[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Mf(_[1][1],a,i),o.push(Bf(f,s));break;case"PtgRefN":f=r?Mf(_[1][1],r,i):_[1][1],o.push(Bf(f,s));break;case"PtgRef3d":m=_[1][1],f=Mf(_[1][2],a,i),v=Y5(n,m,i),o.push(v+"!"+Bf(f,s));break;case"PtgFunc":case"PtgFuncVar":var j=_[1][0],O=_[1][1];j||(j=0),j&=127;var L=j==0?[]:o.slice(-j);o.length-=j,O==="User"&&(O=L.shift()),o.push(O+"("+L.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":h=L5(_[1][1],r?{s:r}:a,i),o.push(y1(h,i));break;case"PtgArea":h=L5(_[1][1],a,i),o.push(y1(h,i));break;case"PtgArea3d":m=_[1][1],h=_[1][2],v=Y5(n,m,i),o.push(v+"!"+y1(h,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var E=(n.names||[])[p-1]||(n[0]||[])[p],C=E?E.Name:"SH33TJSNAME"+String(p);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var P=_[1][1];p=_[1][2];var R;if(i.biff<=5)P<0&&(P=-P),n[P]&&(R=n[P][p]);else{var T="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][p]&&n[P][p].itab>0&&(T=n.SheetNames[n[P][p].itab-1]+"!"):T=n.SheetNames[p-1]+"!"),n[P]&&n[P][p])T+=n[P][p].Name;else if(n[0]&&n[0][p])T+=n[0][p].Name;else{var A=(nS(n,P,i)||"").split(";;");A[p-1]?T=A[p-1]:T+="SH33TJSERRX"}o.push(T);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var q="(",z=")";if(g>=0){switch(b="",e[0][g][1][0]){case 2:q=Lr(" ",e[0][g][1][1])+q;break;case 3:q=Lr("\r",e[0][g][1][1])+q;break;case 4:z=Lr(" ",e[0][g][1][1])+z;break;case 5:z=Lr("\r",e[0][g][1][1])+z;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(q+o.pop()+z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var ne={c:r.c,r:r.r};if(n.sharedf[ir(f)]){var U=n.sharedf[ir(f)];o.push(iu(U,a,ne,n,i))}else{var G=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(iu(u[1],a,ne,n,i)),G=!0;break}G||o.push(_[1])}break;case"PtgArray":o.push("{"+RO(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var B=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&B.indexOf(e[0][y][0])==-1){_=e[0][g];var Y=!0;switch(_[1][0]){case 4:Y=!1;case 0:b=Lr(" ",_[1][1]);break;case 5:Y=!1;case 1:b=Lr("\r",_[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Y?b:"")+o.pop()+(Y?"":b)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function UO(e){if(e==null){var t=Fe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Al(e);return Al(0)}function zO(e,t,r,n,i){var s=Tl(t,r,i),a=UO(e.v),o=Fe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Fe(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var m=Nn([s,a,o,u]);return m}function zm(e,t,r){var n=e.read_shift(4),i=IO(e,n,r),s=e.read_shift(4),a=s>0?DO(e,s,i,r):null;return[i,a]}var WO=zm,Wm=zm,HO=zm,$O=zm,qO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},VO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function GO(e){var t="of:="+e.replace(Sx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function YO(e){return e.replace(/\./,"!")}var Uf=typeof Map<"u";function Ex(e,t,r){var n=0,i=e.length;if(r){if(Uf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Uf?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Uf?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Hm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(_a=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=tm(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Kg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function sS(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Uo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){e3(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function KO(e,t,r){if(e&&e["!ref"]){var n=wr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function XO(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Qr(e[r])+'"/>';return t+"</mergeCells>"}function JO(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=pd(rr(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Xe("outlinePr",null,u)}!s&&!o||(i[i.length]=Xe("sheetPr",o,a))}var QO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ZO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function eD(e){var t={sheet:1};return QO.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),ZO.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=W3(e.password).toString(16).toUpperCase()),Xe("sheetProtection",null,t)}function tD(e){return sS(e),Xe("pageMargins",null,e)}function rD(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Xe("col",null,Hm(i,n)));return r[r.length]="</cols>",r.join("")}function nD(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Qr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ri(i);a.s.r==a.e.r&&(a.e.r=Ri(t["!ref"]).e.r,i=Qr(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Xe("autoFilter",null,{ref:i})}function iD(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,i),{})}function sD(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Pd[e.v];break;case"d":n&&n.cellDates?i=Qn(e.v,-1).toISOString():(e=xi(e),e.t="n",i=""+(e.v=gi(Qn(e.v)))),typeof e.z>"u"&&(e.z=Or[14]);break;default:i=e.v;break}var o=kn("v",rr(i)),l={r:t},u=Uo(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=kn("v",""+Ex(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Xe("f",rr(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Xe("c",o,l)}function aD(e,t,r,n){var i=[],s=[],a=wr(e["!ref"]),o="",l,u="",f=[],m=0,p=0,h=e["!rows"],v=Array.isArray(e),g={r:u},b,y=-1;for(p=a.s.c;p<=a.e.c;++p)f[p]=zn(p);for(m=a.s.r;m<=a.e.r;++m){for(s=[],u=jn(m),p=a.s.c;p<=a.e.c;++p){l=f[p]+u;var w=v?(e[m]||[])[p]:e[l];w!==void 0&&(o=sD(w,l,e,t))!=null&&s.push(o)}(s.length>0||h&&h[m])&&(g={r:u},h&&h[m]&&(b=h[m],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=rm(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level)),i[i.length]=Xe("row",s.join(""),g))}if(h)for(;m<h.length;++m)h&&h[m]&&(g={r:m+1},b=h[m],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=rm(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level),i[i.length]=Xe("row","",g));return i.join("")}function aS(e,t,r,n){var i=[Zr,Xe("worksheet",null,{xmlns:pu[0],"xmlns:r":hn.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=wr(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Qr(f)}n||(n={}),l["!comments"]=[];var m=[];JO(l,r,e,t,i),i[i.length]=Xe("dimension",null,{ref:u}),i[i.length]=iD(l,t,e,r),t.sheetFormat&&(i[i.length]=Xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=rD(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=aD(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=eD(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=nD(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=XO(l["!merges"]));var p=-1,h,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=er(n,-1,rr(g[1].Target).replace(/#.*$/,""),$t.HLINK),h["r:id"]="rId"+v),(p=g[1].Target.indexOf("#"))>-1&&(h.location=rr(g[1].Target.slice(p+1))),g[1].Tooltip&&(h.tooltip=rr(g[1].Tooltip)),i[i.length]=Xe("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=tD(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=kn("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(v=er(n,-1,"../drawings/drawing"+(e+1)+".xml",$t.DRAW),i[i.length]=Xe("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=m),l["!comments"].length>0&&(v=er(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",$t.VML),i[i.length]=Xe("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function oD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function lD(e,t,r){var n=Fe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=rm(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var m=-1,p=-1,h=f<<10;h<f+1<<10;++h){u.c=h;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ir(u)];v&&(m<0&&(m=h),p=h)}m<0||(++o,n.write_shift(4,m),n.write_shift(4,p))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function cD(e,t,r,n){var i=lD(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Be(e,0,i)}var uD=Bl,fD=xu;function dD(){}function hD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=SP(e),r}function mD(e,t,r){r==null&&(r=Fe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Q0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),b3(e,r),r.slice(0,r.l)}function pD(e){var t=ss(e);return[t]}function gD(e,t,r){return r==null&&(r=Fe(8)),Il(t,r)}function xD(e){var t=Rl(e);return[t]}function vD(e,t,r){return r==null&&(r=Fe(4)),Ml(t,r)}function yD(e){var t=ss(e),r=e.read_shift(1);return[t,r,"b"]}function wD(e,t,r){return r==null&&(r=Fe(9)),Il(t,r),r.write_shift(1,e.v?1:0),r}function bD(e){var t=Rl(e),r=e.read_shift(1);return[t,r,"b"]}function _D(e,t,r){return r==null&&(r=Fe(5)),Ml(t,r),r.write_shift(1,e.v?1:0),r}function SD(e){var t=ss(e),r=e.read_shift(1);return[t,r,"e"]}function ND(e,t,r){return r==null&&(r=Fe(9)),Il(t,r),r.write_shift(1,e.v),r}function kD(e){var t=Rl(e),r=e.read_shift(1);return[t,r,"e"]}function ED(e,t,r){return r==null&&(r=Fe(8)),Ml(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function jD(e){var t=ss(e),r=e.read_shift(4);return[t,r,"s"]}function AD(e,t,r){return r==null&&(r=Fe(12)),Il(t,r),r.write_shift(4,t.v),r}function TD(e){var t=Rl(e),r=e.read_shift(4);return[t,r,"s"]}function CD(e,t,r){return r==null&&(r=Fe(8)),Ml(t,r),r.write_shift(4,t.v),r}function PD(e){var t=ss(e),r=vu(e);return[t,r,"n"]}function LD(e,t,r){return r==null&&(r=Fe(16)),Il(t,r),Al(e.v,r),r}function FD(e){var t=Rl(e),r=vu(e);return[t,r,"n"]}function OD(e,t,r){return r==null&&(r=Fe(12)),Ml(t,r),Al(e.v,r),r}function DD(e){var t=ss(e),r=_3(e);return[t,r,"n"]}function ID(e,t,r){return r==null&&(r=Fe(12)),Il(t,r),S3(e.v,r),r}function RD(e){var t=Rl(e),r=_3(e);return[t,r,"n"]}function MD(e,t,r){return r==null&&(r=Fe(8)),Ml(t,r),S3(e.v,r),r}function BD(e){var t=ss(e),r=vx(e);return[t,r,"is"]}function UD(e){var t=ss(e),r=Wn(e);return[t,r,"str"]}function zD(e,t,r){return r==null&&(r=Fe(12+4*e.v.length)),Il(t,r),gn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WD(e){var t=Rl(e),r=Wn(e);return[t,r,"str"]}function HD(e,t,r){return r==null&&(r=Fe(8+4*e.v.length)),Ml(t,r),gn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $D(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Wm(e,n-e.l,r);a[3]=iu(o,null,i,r.supbooks,r)}else e.l=n;return a}function qD(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Wm(e,n-e.l,r);a[3]=iu(o,null,i,r.supbooks,r)}else e.l=n;return a}function VD(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=vu(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Wm(e,n-e.l,r);a[3]=iu(o,null,i,r.supbooks,r)}else e.l=n;return a}function GD(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=Wn(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Wm(e,n-e.l,r);a[3]=iu(o,null,i,r.supbooks,r)}else e.l=n;return a}var YD=Bl,KD=xu;function XD(e,t){return t==null&&(t=Fe(4)),t.write_shift(4,e),t}function JD(e,t){var r=e.l+t,n=Bl(e),i=yx(e),s=Wn(e),a=Wn(e),o=Wn(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function QD(e,t){var r=Fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));xu({s:pn(e[0]),e:pn(e[0])},r),wx("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return gn(i||"",r),gn(e[1].Tooltip||"",r),gn("",r),r.slice(0,r.l)}function ZD(){}function e9(e,t,r){var n=e.l+t,i=N3(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=WO(e,n-e.l,r);a[1]=o}else e.l=n;return a}function t9(e,t,r){var n=e.l+t,i=Bl(e),s=[i];if(r.cellFormula){var a=$O(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function r9(e,t,r){r==null&&(r=Fe(18));var n=Hm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var oS=["left","right","top","bottom","header","footer"];function n9(e){var t={};return oS.forEach(function(r){t[r]=vu(e)}),t}function i9(e,t){return t==null&&(t=Fe(6*8)),sS(e),oS.forEach(function(r){Al(e[r],t)}),t}function s9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function a9(e,t,r){r==null&&(r=Fe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function o9(e){var t=Fe(24);return t.write_shift(4,4),t.write_shift(4,1),xu(e,t),t}function l9(e,t){return t==null&&(t=Fe(16*4+2)),t.write_shift(2,e.password?W3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function c9(){}function u9(){}function f9(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=xi(t),t.z=t.z||Or[14],t.v=gi(Qn(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Uo(i.cellXfs,t,i),t.l&&s["!links"].push([ir(l),t.l]),t.c&&s["!comments"].push([ir(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Ex(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?Be(e,18,CD(t,l)):Be(e,7,AD(t,l))):(l.t="str",a?Be(e,17,HD(t,l)):Be(e,6,zD(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Be(e,13,MD(t,l)):Be(e,2,ID(t,l)):a?Be(e,16,OD(t,l)):Be(e,5,LD(t,l)),!0;case"b":return l.t="b",a?Be(e,15,_D(t,l)):Be(e,4,wD(t,l)),!0;case"e":return l.t="e",a?Be(e,14,ED(t,l)):Be(e,3,ND(t,l)),!0}return a?Be(e,12,vD(t,l)):Be(e,1,gD(t,l)),!0}function d9(e,t,r,n){var i=wr(t["!ref"]||"A1"),s,a="",o=[];Be(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=jn(f),cD(e,t,i,f);var m=!1;if(f<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){f===i.s.r&&(o[p]=zn(p)),s=o[p]+a;var h=l?(t[f]||[])[p]:t[s];if(!h){m=!1;continue}m=f9(e,h,f,p,n,t,m)}}Be(e,146)}function h9(e,t){!t||!t["!merges"]||(Be(e,177,XD(t["!merges"].length)),t["!merges"].forEach(function(r){Be(e,176,KD(r))}),Be(e,178))}function m9(e,t){!t||!t["!cols"]||(Be(e,390),t["!cols"].forEach(function(r,n){r&&Be(e,60,r9(n,r))}),Be(e,391))}function p9(e,t){!t||!t["!ref"]||(Be(e,648),Be(e,649,o9(wr(t["!ref"]))),Be(e,650))}function g9(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=er(r,-1,n[1].Target.replace(/#.*$/,""),$t.HLINK);Be(e,494,QD(n,i))}}),delete t["!links"]}function x9(e,t,r,n){if(t["!comments"].length>0){var i=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$t.VML);Be(e,551,wx("rId"+i)),t["!legacy"]=i}}function v9(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:Qr(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ri(s);o.s.r==o.e.r&&(o.e.r=Ri(t["!ref"]).e.r,s=Qr(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Be(e,161,xu(wr(s))),Be(e,162)}}function y9(e,t,r){Be(e,133),Be(e,137,a9(t,r)),Be(e,138),Be(e,134)}function w9(e,t){t["!protect"]&&Be(e,535,l9(t["!protect"]))}function b9(e,t,r,n){var i=pi(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=wr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Be(i,129),(r.vbaraw||a["!outline"])&&Be(i,147,mD(o,a["!outline"])),Be(i,148,fD(l)),y9(i,a,r.Workbook),m9(i,a),d9(i,a,e,t),w9(i,a),v9(i,a,r,e),h9(i,a),g9(i,a,n),a["!margins"]&&Be(i,476,i9(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&p9(i,a),x9(i,a,e,n),Be(i,130),i.end()}function _9(e,t){e.l+=10;var r=Wn(e);return{name:r}}var S9=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function N9(e){return!e.Workbook||!e.Workbook.WBProps?"false":tP(e.Workbook.WBProps.date1904)?"true":"false"}var k9="][*?/\\".split("");function lS(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return k9.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function E9(e,t,r){e.forEach(function(n,i){lS(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function j9(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];E9(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)KO(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function cS(e){var t=[Zr];t[t.length]=Xe("workbook",null,{xmlns:pu[0],"xmlns:r":hn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(S9.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Xe("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:rr(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Xe("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Xe("definedName",rr(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function A9(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Yg(e),r.name=Wn(e),r}function T9(e,t){return t||(t=Fe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),wx(e.strRelID,t),gn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function C9(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Wn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function P9(e,t){t||(t=Fe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),b3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function L9(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=NP(e),a=HO(e,0,r),o=yx(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function F9(e,t){Be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Be(e,156,T9(i))}Be(e,144)}function O9(e,t){t||(t=Fe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return gn("SheetJS",t),gn(q0.version,t),gn(q0.version,t),gn("7262",t),t.length>t.l?t.slice(0,t.l):t}function D9(e,t){t||(t=Fe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function I9(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Be(e,135),Be(e,158,D9(i)),Be(e,136))}}function R9(e,t){var r=pi();return Be(r,131),Be(r,128,O9()),Be(r,153,P9(e.Workbook&&e.Workbook.WBProps||null)),I9(r,e),F9(r,e),Be(r,132),r.end()}function M9(e,t,r){return(t.slice(-4)===".bin"?R9:cS)(e)}function B9(e,t,r,n,i){return(t.slice(-4)===".bin"?b9:aS)(e,r,n,i)}function U9(e,t,r){return(t.slice(-4)===".bin"?iF:q3)(e,r)}function z9(e,t,r){return(t.slice(-4)===".bin"?PL:z3)(e,r)}function W9(e,t,r){return(t.slice(-4)===".bin"?wF:X3)(e)}function H9(e){return(e.slice(-4)===".bin"?dF:Y3)()}function $9(e,t){var r=[];return e.Props&&r.push(UP(e.Props,t)),e.Custprops&&r.push(zP(e.Props,e.Custprops)),r.join("")}function q9(){return""}function V9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Xe("NumberFormat",null,{"ss:Format":rr(Or[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Xe("Style",s.join(""),a))}),Xe("Styles",r.join(""))}function uS(e){return Xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Nx(e.Ref,{r:0,c:0})})}function G9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(uS(i)))}return Xe("Names",r.join(""))}function Y9(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(uS(o)))}return s.join("")}function K9(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Xe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Xe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(kn("ProtectContents","True")),e["!protect"].objects&&i.push(kn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(kn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(kn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(kn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Xe("WorksheetOptions",i.join(""),{xmlns:Ci.x})}function X9(e){return e.map(function(t){var r=eP(t.t||""),n=Xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Xe("Comment",n,{"ss:Author":t.a})}).join("")}function J9(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+rr(Nx(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=pn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=rr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=rr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var m="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",p=String(e.v);break;case"b":m="Boolean",p=e.v?"1":"0";break;case"e":m="Error",p=Pd[e.v];break;case"d":m="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Or[14]);break;case"s":m="String",p=Z7(e.v||"");break}var h=Uo(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=a.c+1;var v=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+m+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=X9(e.c)),Xe("Cell",g,o)}function Q9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=$3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Z9(e,t,r,n){if(!e["!ref"])return"";var i=wr(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(b,y){_x(b);var w=!!b.width,_=Hm(y,b),j={"ss:Index":y+1};w&&(j["ss:Width"]=em(_.width)),b.hidden&&(j["ss:Hidden"]="1"),o.push(Xe("Column",null,j))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var f=[Q9(u,(e["!rows"]||[])[u])],m=i.s.c;m<=i.e.c;++m){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>m)&&!(s[a].s.r>u)&&!(s[a].e.c<m)&&!(s[a].e.r<u)){(s[a].s.c!=m||s[a].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:m},v=ir(h),g=l?(e[u]||[])[m]:e[v];f.push(J9(g,v,e,t,r,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function eI(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?Y9(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?Z9(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(K9(s,t,e,r)),n.join("")}function tI(e,t){t||(t={}),e.SSF||(e.SSF=xi(Or)),e.SSF&&(Mm(),Rm(e.SSF),t.revssf=Bm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push($9(e,t)),r.push(q9()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Xe("Worksheet",eI(n,t,e),{"ss:Name":rr(e.SheetNames[n])}));return r[2]=V9(e,t),r[3]=G9(e),Zr+Xe("Workbook",r.join(""),{xmlns:Ci.ss,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:ss":Ci.ss,"xmlns:dt":Ci.dt,"xmlns:html":Ci.html})}var _1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function rI(e,t){var r=[],n=[],i=[],s=0,a,o=b5(O5,"n"),l=b5(D5,"n");if(e.Props)for(a=Tn(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Tn(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)O3.indexOf(i[s][0])>-1||P3.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&or.utils.cfb_add(t,"/SummaryInformation",U5(n,_1.SI,l,D5)),(r.length||u.length)&&or.utils.cfb_add(t,"/DocumentSummaryInformation",U5(r,_1.DSI,o,O5,u.length?u:null,_1.UDI))}function nI(e,t){var r=t||{},n=or.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return or.utils.cfb_add(n,i,fS(e,r)),r.biff==8&&(e.Props||e.Custprops)&&rI(e,n),r.biff==8&&e.vbaraw&&bF(n,or.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var iI={0:{f:oD},1:{f:pD},2:{f:DD},3:{f:SD},4:{f:yD},5:{f:PD},6:{f:UD},7:{f:jD},8:{f:GD},9:{f:VD},10:{f:$D},11:{f:qD},12:{f:xD},13:{f:RD},14:{f:kD},15:{f:bD},16:{f:FD},17:{f:WD},18:{f:TD},19:{f:vx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:L9},40:{},42:{},43:{f:UL},44:{f:ML},45:{f:HL},46:{f:qL},47:{f:$L},48:{},49:{f:xP},50:{},51:{f:oF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vL},62:{f:BD},63:{f:hF},64:{f:c9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:s9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hD},148:{f:uD,p:16},151:{f:ZD},152:{},153:{f:C9},154:{},155:{},156:{f:A9},157:{},158:{},159:{T:1,f:AL},160:{T:-1},161:{T:1,f:Bl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:YD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:sF},336:{T:-1},337:{f:uF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dL},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:e9},427:{f:t9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:n9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vF},633:{T:1},634:{T:-1},635:{T:1,f:gF},636:{T:-1},637:{f:bP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:u9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Je(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&px(r)&&e.push(r)}}function sI(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Je(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<i;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Fd(e,t,r){return e||(e=Fe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function aI(e,t,r,n){var i=Fe(9);return Fd(i,e,t),I3(r,n||"b",i),i}function oI(e,t,r){var n=Fe(8+2*r.length);return Fd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function lI(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?gi(Qn(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Je(e,2,_L(r,n,i)):Je(e,3,bL(r,n,i));return;case"b":case"e":Je(e,5,aI(r,n,t.v,t.t));return;case"s":case"str":Je(e,4,oI(r,n,(t.v||"").slice(0,255)));return}Je(e,1,Fd(null,r,n))}function cI(e,t,r,n){var i=Array.isArray(t),s=wr(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Qr(s)}for(var u=s.s.r;u<=s.e.r;++u){o=jn(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=zn(f)),a=l[f]+o;var m=i?(t[u]||[])[f]:t[a];m&&lI(e,m,u,f)}}}function uI(e,t){for(var r=t||{},n=pi(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Je(n,r.biff==4?1033:r.biff==3?521:9,bx(e,16,r)),cI(n,e.Sheets[e.SheetNames[i]],i,r),Je(n,10),n.end()}function fI(e,t,r){Je(e,49,iL({sz:12,name:"Arial"},r))}function dI(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Je(e,1054,oL(i,t[i],r))})}function hI(e,t){var r=Fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Je(e,2151,r),r=Fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),B3(wr(t["!ref"]||"A1"),r),r.write_shift(4,4),Je(e,2152,r)}function mI(e,t){for(var r=0;r<16;++r)Je(e,224,W5({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Je(e,224,W5(n,0,t))})}function pI(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Je(e,440,pL(n)),n[1].Tooltip&&Je(e,2048,gL(n))}delete t["!links"]}function gI(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Je(e,125,yL(Hm(i,n),i))})}}function xI(e,t,r,n,i){var s=16+Uo(i.cellXfs,t,i);if(t.v==null&&!t.bf){Je(e,513,Tl(r,n,s));return}if(t.bf)Je(e,6,zO(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?gi(Qn(t.v)):t.v;Je(e,515,fL(r,n,a,s));break;case"b":case"e":Je(e,517,uL(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Ex(i.Strings,t.v,i.revStrings);Je(e,253,sL(r,n,o,s))}else Je(e,516,aL(r,n,(t.v||"").slice(0,255),s,i));break;default:Je(e,513,Tl(r,n,s))}}function vI(e,t,r){var n=pi(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,f,m="",p=[],h=wr(s["!ref"]||"A1"),v=u?65536:16384;if(h.e.c>255||h.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,v-1)}Je(n,2057,bx(r,16,t)),Je(n,13,Ji(1)),Je(n,12,Ji(100)),Je(n,15,Kn(!0)),Je(n,17,Kn(!1)),Je(n,16,Al(.001)),Je(n,95,Kn(!0)),Je(n,42,Kn(!1)),Je(n,43,Kn(!1)),Je(n,130,Ji(1)),Je(n,128,cL()),Je(n,131,Kn(!1)),Je(n,132,Kn(!1)),u&&gI(n,s["!cols"]),Je(n,512,lL(h,t)),u&&(s["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){m=jn(g);for(var b=h.s.c;b<=h.e.c;++b){g===h.s.r&&(p[b]=zn(b)),f=p[b]+m;var y=l?(s[g]||[])[b]:s[f];y&&(xI(n,y,g,b,t),u&&y.l&&s["!links"].push([f,y.l]))}}var w=o.CodeName||o.name||i;return u&&Je(n,574,nL((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&Je(n,229,mL(s["!merges"])),u&&pI(n,s),Je(n,442,M3(w)),u&&hI(n,s),Je(n,10),n.end()}function yI(e,t,r){var n=pi(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Je(n,2057,bx(e,5,r)),r.bookType=="xla"&&Je(n,135),Je(n,225,o?Ji(1200):null),Je(n,193,$P(2)),l&&Je(n,191),l&&Je(n,192),Je(n,226),Je(n,92,ZP("SheetJS",r)),Je(n,66,Ji(o?1200:1252)),o&&Je(n,353,Ji(0)),o&&Je(n,448),Je(n,317,wL(e.SheetNames.length)),o&&e.vbaraw&&Je(n,211),o&&e.vbaraw){var u=a.CodeName||"ThisWorkbook";Je(n,442,M3(u))}Je(n,156,Ji(17)),Je(n,25,Kn(!1)),Je(n,18,Kn(!1)),Je(n,19,Ji(0)),o&&Je(n,431,Kn(!1)),o&&Je(n,444,Ji(0)),Je(n,61,rL()),Je(n,64,Kn(!1)),Je(n,141,Ji(0)),Je(n,34,Kn(N9(e)=="true")),Je(n,14,Kn(!0)),o&&Je(n,439,Kn(!1)),Je(n,218,Ji(0)),fI(n,e,r),dI(n,e.SSF,r),mI(n,r),o&&Je(n,352,Kn(!1));var f=n.end(),m=pi();o&&Je(m,140,xL()),o&&r.Strings&&sI(m,252,tL(r.Strings)),Je(m,10);var p=m.end(),h=pi(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var b=f.length+v+p.length;for(g=0;g<e.SheetNames.length;++g){var y=s[g]||{};Je(h,133,eL({pos:b,hs:y.Hidden||0,dt:0,name:e.SheetNames[g]},r)),b+=t[g].length}var w=h.end();if(v!=w.length)throw new Error("BS8 "+v+" != "+w.length);var _=[];return f.length&&_.push(f),w.length&&_.push(w),p.length&&_.push(p),Nn(_)}function wI(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=xi(Or)),e&&e.SSF&&(Mm(),Rm(e.SSF),r.revssf=Bm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,jx(r),r.cellXfs=[],Uo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=vI(i,r,e);return n.unshift(yI(e,n,r)),Nn(n)}function fS(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ri(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return wI(e,t);case 4:case 3:case 2:return uI(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function bI(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=ir({r,c:a}),m=n.dense?(e[r]||[])[a]:e[f],p=m&&m.v!=null&&(m.h||Q7(m.w||(Ta(m),m.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+m.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+f,s.push(Xe("td",p,h))}}var v="<tr>";return v+s.join("")+"</tr>"}var _I='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',SI="</body></html>";function NI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function dS(e,t){var r=t||{},n=r.header!=null?r.header:_I,i=r.footer!=null?r.footer:SI,s=[n],a=Ri(e["!ref"]);r.dense=Array.isArray(e),s.push(NI(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(bI(e,a,o,r));return s.push("</table>"+i),s.join("")}function hS(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?pn(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var f=Ri(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var m=[],p=0,h=e["!rows"]||(e["!rows"]=[]),v=0,g=0,b=0,y=0,w=0,_=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&g<l;++v){var j=o[v];if(K5(j)){if(n.display)continue;h[g]={hidden:!0}}var O=j.children;for(b=y=0;b<O.length;++b){var L=O[b];if(!(n.display&&K5(L))){var E=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):rP(L.innerHTML),C=L.getAttribute("data-z")||L.getAttribute("z");for(p=0;p<m.length;++p){var P=m[p];P.s.c==y+s&&P.s.r<g+i&&g+i<=P.e.r&&(y=P.e.c+1-s,p=-1)}_=+L.getAttribute("colspan")||1,((w=+L.getAttribute("rowspan")||1)>1||_>1)&&m.push({s:{r:g+i,c:y+s},e:{r:g+i+(w||1)-1,c:y+s+(_||1)-1}});var R={t:"s",v:E},T=L.getAttribute("data-t")||L.getAttribute("t")||"";E!=null&&(E.length==0?R.t=T||"z":n.raw||E.trim().length==0||T=="s"||(E==="TRUE"?R={t:"b",v:!0}:E==="FALSE"?R={t:"b",v:!1}:isNaN(ba(E))?isNaN(md(E).getDate())||(R={t:"d",v:Qn(E)},n.cellDates||(R={t:"n",v:gi(R.v)}),R.z=n.dateNF||Or[14]):R={t:"n",v:ba(E)})),R.z===void 0&&C!=null&&(R.z=C);var A="",q=L.getElementsByTagName("A");if(q&&q.length)for(var z=0;z<q.length&&!(q[z].hasAttribute("href")&&(A=q[z].getAttribute("href"),A.charAt(0)!="#"));++z);A&&A.charAt(0)!="#"&&(R.l={Target:A}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][y+s]=R):e[ir({c:y+s,r:g+i})]=R,u.e.c<y+s&&(u.e.c=y+s),y+=_}}++g}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=Qr(u),g>=l&&(e["!fullref"]=Qr((u.e.r=o.length-v+g-1+i,u))),e}function mS(e,t){var r=t||{},n=r.dense?[]:{};return hS(n,e,t)}function kI(e,t){return Dl(mS(e,t),t)}function K5(e){var t="",r=EI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function EI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var jI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+gd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Zr+t}}(),X5=function(){var e=function(s){return rr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+rr(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,m=Ri(s["!ref"]||"A1"),p=s["!merges"]||[],h=0,v=Array.isArray(s);if(s["!cols"])for(f=0;f<=m.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var g="",b=s["!rows"]||[];for(u=0;u<m.s.r;++u)g=b[u]?' table:style-name="ro'+b[u].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=m.e.r;++u){for(g=b[u]?' table:style-name="ro'+b[u].ods+'"':"",l.push("        <table:table-row"+g+`>
`),f=0;f<m.s.c;++f)l.push(t);for(;f<=m.e.c;++f){var y=!1,w={},_="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>f)&&!(p[h].s.r>u)&&!(p[h].e.c<f)&&!(p[h].e.r<u)){(p[h].s.c!=f||p[h].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,w["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(y){l.push(r);continue}var j=ir({r:u,c:f}),O=v?(s[u]||[])[f]:s[j];if(O&&O.f&&(w["table:formula"]=rr(GO(O.f)),O.F&&O.F.slice(0,j.length)==j)){var L=Ri(O.F);w["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,w["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!O){l.push(t);continue}switch(O.t){case"b":_=O.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=O.v?"true":"false";break;case"n":_=O.w||String(O.v||0),w["office:value-type"]="float",w["office:value"]=O.v||0;break;case"s":case"str":_=O.v==null?"":O.v,w["office:value-type"]="string";break;case"d":_=O.w||Qn(O.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Qn(O.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var E=e(_);if(O.l&&O.l.Target){var C=O.l.Target;C=C.charAt(0)=="#"?"#"+YO(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),E=Xe("text:a",E,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+Xe("table:table-cell",Xe("text:p",E,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var m=u["!cols"][f];if(m.width==null&&m.wpx==null&&m.wch==null)continue;_x(m),m.ods=o;var p=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var m=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Zr],u=gd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=gd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(T3().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var m=0;m!=a.SheetNames.length;++m)l.push(n(a.Sheets[a.SheetNames[m]],a,m));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function pS(e,t){if(t.bookType=="fods")return X5(e,t);var r=fx(),n="",i=[],s=[];return n="mimetype",Pt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Pt(r,n,X5(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Pt(r,n,jI(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Pt(r,n,Zr+T3()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Pt(r,n,BP(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Pt(r,n,RP(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function AI(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ks(pd(e))}function TI(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Fo(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function CI(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function xd(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Qt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Gc(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function nn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=xd(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=xd(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function bn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Qt(n*8+i.type)),i.type==2&&t.push(Qt(i.data.length)),t.push(i.data))})}),Fo(t)}function xs(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=xd(e,n),s=nn(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Gc(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=nn(o.data),u=Gc(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(a.merge=Gc(s[3][0].data)>>>0>0),r.push(a)}return r}function xc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Qt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Qt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Qt(a.data.length)}],n[2].push({data:bn(a.meta),type:2})});var s=bn(n);t.push(Qt(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),Fo(t)}function PI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=xd(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Fo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=Fo(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function vs(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(PI(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Fo(t)}function vc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Qt(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Fo(t)}function S1(e,t){var r=new Uint8Array(32),n=nm(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,CI(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function N1(e,t){var r=new Uint8Array(32),n=nm(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Xa(e){var t=nn(e);return xd(t[1][0].data)}function LI(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&Gc(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=nm(e[7][0].data),f=0,m=[],p=nm(e[4][0].data),h=0,v=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,f,!0),p.setUint16(g*2,h,!0);var b,y;switch(typeof t[g]){case"string":b=S1({t:"s",v:t[g]},r),y=N1({t:"s",v:t[g]},r);break;case"number":b=S1({t:"n",v:t[g]},r),y=N1({t:"n",v:t[g]},r);break;case"boolean":b=S1({t:"b",v:t[g]},r),y=N1({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}m.push(b),f+=b.length,v.push(y),h+=y.length,++l}for(e[2][0].data=Qt(l);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Fo(m),e[3][0].data=Fo(v),l}function FI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ri(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Qr(n)));var s=im(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(I){return I.forEach(function(M){typeof M=="string"&&a.push(M)})});var o={},l=[],u=or.read(t.numbers,{type:"base64"});u.FileIndex.map(function(I,M){return[I,u.FullPaths[M]]}).forEach(function(I){var M=I[0],D=I[1];if(M.type==2&&M.name.match(/\.iwa/)){var V=M.content,se=vs(V),fe=xs(se);fe.forEach(function(de){l.push(de.id),o[de.id]={deps:[],location:D,type:Gc(de.messages[0].meta[1][0].data)}})}}),l.sort(function(I,M){return I-M});var f=l.filter(function(I){return I>1}).map(function(I){return[I,Qt(I)]});u.FileIndex.map(function(I,M){return[I,u.FullPaths[M]]}).forEach(function(I){var M=I[0];if(I[1],!!M.name.match(/\.iwa/)){var D=xs(vs(M.content));D.forEach(function(V){V.messages.forEach(function(se){f.forEach(function(fe){V.messages.some(function(de){return Gc(de.meta[1][0].data)!=11006&&TI(de.data,fe[1])})&&o[fe[0]].deps.push(V.id)})})})}});for(var m=or.find(u,o[1].location),p=xs(vs(m.content)),h,v=0;v<p.length;++v){var g=p[v];g.id==1&&(h=g)}var b=Xa(nn(h.messages[0].data)[1][0].data);for(m=or.find(u,o[b].location),p=xs(vs(m.content)),v=0;v<p.length;++v)g=p[v],g.id==b&&(h=g);for(b=Xa(nn(h.messages[0].data)[2][0].data),m=or.find(u,o[b].location),p=xs(vs(m.content)),v=0;v<p.length;++v)g=p[v],g.id==b&&(h=g);for(b=Xa(nn(h.messages[0].data)[2][0].data),m=or.find(u,o[b].location),p=xs(vs(m.content)),v=0;v<p.length;++v)g=p[v],g.id==b&&(h=g);var y=nn(h.messages[0].data);{y[6][0].data=Qt(n.e.r+1),y[7][0].data=Qt(n.e.c+1);var w=Xa(y[46][0].data),_=or.find(u,o[w].location),j=xs(vs(_.content));{for(var O=0;O<j.length&&j[O].id!=w;++O);if(j[O].id!=w)throw"Bad ColumnRowUIDMapArchive";var L=nn(j[O].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var E=0;E<=n.e.c;++E){var C=[];C[1]=C[2]=[{type:0,data:Qt(E+420690)}],L[1].push({type:2,data:bn(C)}),L[2].push({type:0,data:Qt(E)}),L[3].push({type:0,data:Qt(E)})}L[4]=[],L[5]=[],L[6]=[];for(var P=0;P<=n.e.r;++P)C=[],C[1]=C[2]=[{type:0,data:Qt(P+726270)}],L[4].push({type:2,data:bn(C)}),L[5].push({type:0,data:Qt(P)}),L[6].push({type:0,data:Qt(P)});j[O].messages[0].data=bn(L)}_.content=vc(xc(j)),_.size=_.content.length,delete y[46];var R=nn(y[4][0].data);{R[7][0].data=Qt(n.e.r+1);var T=nn(R[1][0].data),A=Xa(T[2][0].data);_=or.find(u,o[A].location),j=xs(vs(_.content));{if(j[0].id!=A)throw"Bad HeaderStorageBucket";var q=nn(j[0].messages[0].data);for(P=0;P<s.length;++P){var z=nn(q[2][0].data);z[1][0].data=Qt(P),z[4][0].data=Qt(s[P].length),q[2][P]={type:q[2][0].type,data:bn(z)}}j[0].messages[0].data=bn(q)}_.content=vc(xc(j)),_.size=_.content.length;var ne=Xa(R[2][0].data);_=or.find(u,o[ne].location),j=xs(vs(_.content));{if(j[0].id!=ne)throw"Bad HeaderStorageBucket";for(q=nn(j[0].messages[0].data),E=0;E<=n.e.c;++E)z=nn(q[2][0].data),z[1][0].data=Qt(E),z[4][0].data=Qt(n.e.r+1),q[2][E]={type:q[2][0].type,data:bn(z)};j[0].messages[0].data=bn(q)}_.content=vc(xc(j)),_.size=_.content.length;var U=Xa(R[4][0].data);(function(){for(var I=or.find(u,o[U].location),M=xs(vs(I.content)),D,V=0;V<M.length;++V){var se=M[V];se.id==U&&(D=se)}var fe=nn(D.messages[0].data);{fe[3]=[];var de=[];a.forEach(function(Oe,Ve){de[1]=[{type:0,data:Qt(Ve)}],de[2]=[{type:0,data:Qt(1)}],de[3]=[{type:2,data:AI(Oe)}],fe[3].push({type:2,data:bn(de)})})}D.messages[0].data=bn(fe);var ve=xc(M),Ee=vc(ve);I.content=Ee,I.size=I.content.length})();var G=nn(R[3][0].data);{var B=G[1][0];delete G[2];var Y=nn(B.data);{var re=Xa(Y[2][0].data);(function(){for(var I=or.find(u,o[re].location),M=xs(vs(I.content)),D,V=0;V<M.length;++V){var se=M[V];se.id==re&&(D=se)}var fe=nn(D.messages[0].data);{delete fe[6],delete G[7];var de=new Uint8Array(fe[5][0].data);fe[5]=[];for(var ve=0,Ee=0;Ee<=n.e.r;++Ee){var Oe=nn(de);ve+=LI(Oe,s[Ee],a),Oe[1][0].data=Qt(Ee),fe[5].push({data:bn(Oe),type:2})}fe[1]=[{type:0,data:Qt(n.e.c+1)}],fe[2]=[{type:0,data:Qt(n.e.r+1)}],fe[3]=[{type:0,data:Qt(ve)}],fe[4]=[{type:0,data:Qt(n.e.r+1)}]}D.messages[0].data=bn(fe);var Ve=xc(M),Qe=vc(Ve);I.content=Qe,I.size=I.content.length})()}B.data=bn(Y)}R[3][0].data=bn(G)}y[4][0].data=bn(R)}h.messages[0].data=bn(y);var he=xc(p),k=vc(he);return m.content=k,m.size=m.content.length,u}function OI(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function jx(e){OI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function DI(e,t){return t.bookType=="ods"?pS(e,t):t.bookType=="numbers"?FI(e,t):t.bookType=="xlsb"?II(e,t):RI(e,t)}function II(e,t){Ic=1024,e&&!e.SSF&&(e.SSF=xi(Or)),e&&e.SSF&&(Mm(),Rm(e.SSF),t.revssf=Bm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Uf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=J3.indexOf(t.bookType)>-1,i=E3();jx(t=t||{});var s=fx(),a="",o=0;if(t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pt(s,a,C3(e.Props,t)),i.coreprops.push(a),er(t.rels,2,a,$t.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Pt(s,a,L3(e.Props)),i.extprops.push(a),er(t.rels,3,a,$t.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pt(s,a,F3(e.Custprops)),i.custprops.push(a),er(t.rels,4,a,$t.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],p=(m||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Pt(s,a,B9(o-1,a,t,e,f)),i.sheets.push(a),er(t.wbrels,-1,"worksheets/sheet"+o+"."+r,$t.WS[0])}if(m){var h=m["!comments"],v=!1,g="";h&&h.length>0&&(g="xl/comments"+o+"."+r,Pt(s,g,W9(h,g)),i.comments.push(g),er(f,-1,"../comments"+o+"."+r,$t.CMNT),v=!0),m["!legacy"]&&v&&Pt(s,"xl/drawings/vmlDrawing"+o+".vml",K3(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&Pt(s,A3(a),qc(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pt(s,a,z9(t.Strings,a,t)),i.strs.push(a),er(t.wbrels,-1,"sharedStrings."+r,$t.SST)),a="xl/workbook."+r,Pt(s,a,M9(e,a)),i.workbooks.push(a),er(t.rels,1,a,$t.WB),a="xl/theme/theme1.xml",Pt(s,a,G3(e.Themes,t)),i.themes.push(a),er(t.wbrels,-1,"theme/theme1.xml",$t.THEME),a="xl/styles."+r,Pt(s,a,U9(e,a,t)),i.styles.push(a),er(t.wbrels,-1,"styles."+r,$t.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pt(s,a,e.vbaraw),i.vba.push(a),er(t.wbrels,-1,"vbaProject.bin",$t.VBA)),a="xl/metadata."+r,Pt(s,a,H9(a)),i.metadata.push(a),er(t.wbrels,-1,"metadata."+r,$t.XLMETA),Pt(s,"[Content_Types].xml",j3(i,t)),Pt(s,"_rels/.rels",qc(t.rels)),Pt(s,"xl/_rels/workbook."+r+".rels",qc(t.wbrels)),delete t.revssf,delete t.ssf,s}function RI(e,t){Ic=1024,e&&!e.SSF&&(e.SSF=xi(Or)),e&&e.SSF&&(Mm(),Rm(e.SSF),t.revssf=Bm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Uf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=J3.indexOf(t.bookType)>-1,i=E3();jx(t=t||{});var s=fx(),a="",o=0;if(t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pt(s,a,C3(e.Props,t)),i.coreprops.push(a),er(t.rels,2,a,$t.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Pt(s,a,L3(e.Props)),i.extprops.push(a),er(t.rels,3,a,$t.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pt(s,a,F3(e.Custprops)),i.custprops.push(a),er(t.rels,4,a,$t.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Pt(s,a,aS(o-1,t,e,m)),i.sheets.push(a),er(t.wbrels,-1,"worksheets/sheet"+o+"."+r,$t.WS[0])}if(p){var v=p["!comments"],g=!1,b="";if(v&&v.length>0){var y=!1;v.forEach(function(w){w[1].forEach(function(_){_.T==!0&&(y=!0)})}),y&&(b="xl/threadedComments/threadedComment"+o+"."+r,Pt(s,b,mF(v,f,t)),i.threadedcomments.push(b),er(m,-1,"../threadedComments/threadedComment"+o+"."+r,$t.TCMNT)),b="xl/comments"+o+"."+r,Pt(s,b,X3(v)),i.comments.push(b),er(m,-1,"../comments"+o+"."+r,$t.CMNT),g=!0}p["!legacy"]&&g&&Pt(s,"xl/drawings/vmlDrawing"+o+".vml",K3(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}m["!id"].rId1&&Pt(s,A3(a),qc(m))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pt(s,a,z3(t.Strings,t)),i.strs.push(a),er(t.wbrels,-1,"sharedStrings."+r,$t.SST)),a="xl/workbook."+r,Pt(s,a,cS(e)),i.workbooks.push(a),er(t.rels,1,a,$t.WB),a="xl/theme/theme1.xml",Pt(s,a,G3(e.Themes,t)),i.themes.push(a),er(t.wbrels,-1,"theme/theme1.xml",$t.THEME),a="xl/styles."+r,Pt(s,a,q3(e,t)),i.styles.push(a),er(t.wbrels,-1,"styles."+r,$t.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pt(s,a,e.vbaraw),i.vba.push(a),er(t.wbrels,-1,"vbaProject.bin",$t.VBA)),a="xl/metadata."+r,Pt(s,a,Y3()),i.metadata.push(a),er(t.wbrels,-1,"metadata."+r,$t.XLMETA),f.length>1&&(a="xl/persons/person.xml",Pt(s,a,pF(f)),i.people.push(a),er(t.wbrels,-1,"persons/person.xml",$t.PEOPLE)),Pt(s,"[Content_Types].xml",j3(i,t)),Pt(s,"_rels/.rels",qc(t.rels)),Pt(s,"xl/_rels/workbook."+r+".rels",qc(t.wbrels)),delete t.revssf,delete t.ssf,s}function MI(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Aa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function gS(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Td(t.file,or.write(e,{type:Vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return or.write(e,t)}function BI(e,t){var r=xi(t||{}),n=DI(e,r);return UI(n,r)}function UI(e,t){var r={},n=Vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?or.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Im(i))}return t.password&&typeof encrypt_agile<"u"?gS(encrypt_agile(i,t.password),t):t.type==="file"?Td(t.file,i):t.type=="string"?If(i):i}function zI(e,t){var r=t||{},n=nI(e,r);return gS(n,r)}function qs(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return hd(pd(n));case"binary":return pd(n);case"string":return e;case"file":return Td(t.file,n,"utf8");case"buffer":return Vt?Pa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):qs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function WI(e,t){switch(t.type){case"base64":return hd(e);case"binary":return e;case"string":return e;case"file":return Td(t.file,e,"binary");case"buffer":return Vt?Pa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function e0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?hd(r):t.type=="string"?If(r):r;case"file":return Td(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function xS(e,t){g7(),j9(e);var r=xi(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=xS(e,r);return r.type="array",Im(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return qs(tI(e,r),r);case"slk":case"sylk":return qs(NL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return qs(dS(e.Sheets[e.SheetNames[i]],r),r);case"txt":return WI(vS(e.Sheets[e.SheetNames[i]],r),r);case"csv":return qs(Ax(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return qs(kL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return e0(SL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return qs(EL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return qs(FL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return qs(U3.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return qs(pS(e,r),r);case"wk1":return e0(H5.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return e0(H5.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),e0(fS(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),zI(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return BI(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function HI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function $I(e,t,r){var n={};return n.type="file",n.file=t,HI(n),xS(e,n)}function qI(e,t,r,n,i,s,a,o){var l=jn(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||e[r])for(var h=t.s.c;h<=t.e.c;++h){var v=a?e[r][h]:e[n[h]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[h]!=null&&(p[s[h]]=u);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[h]!=null){if(g==null)if(v.t=="e"&&g===null)p[s[h]]=null;else if(u!==void 0)p[s[h]]=u;else if(f&&g===null)p[s[h]]=null;else continue;else p[s[h]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?g:Ta(v,g,o);g!=null&&(m=!1)}}return{row:p,isempty:m}}function im(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=wr(f);break;case"number":l=wr(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var m=jn(l.s.r),p=[],h=[],v=0,g=0,b=Array.isArray(e),y=l.s.r,w=0,_={};b&&!e[y]&&(e[y]=[]);var j=u.skipHidden&&e["!cols"]||[],O=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(j[w]||{}).hidden)switch(p[w]=zn(w),r=b?e[y][w]:e[p[w]+m],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=p[w];break;case 3:s[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ta(r,null,u),g=_[a]||0,!g)_[a]=1;else{do o=a+"_"+g++;while(_[o]);_[a]=g,_[o]=1}s[w]=o}for(y=l.s.r+i;y<=l.e.r;++y)if(!(O[y]||{}).hidden){var L=qI(e,l,y,p,n,s,b,u);(L.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[v++]=L.row)}return h.length=v,h}var J5=/"/g;function VI(e,t,r,n,i,s,a,o){for(var l=!0,u=[],f="",m=jn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=o.dense?(e[r]||[])[p]:e[n[p]+m];if(h==null)f="";else if(h.v!=null){l=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Ta(h,null,o));for(var v=0,g=0;v!==f.length;++v)if((g=f.charCodeAt(v))===i||g===s||g===34||o.forceQuotes){f='"'+f.replace(J5,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(l=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(J5,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function Ax(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=wr(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",m=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(m[v]=zn(v));for(var g=0,b=i.s.r;b<=i.e.r;++b)(h[b]||{}).hidden||(f=VI(e,i,b,m,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function vS(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ax(e,t);return r}function GI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=wr(e["!ref"]),s="",a=[],o,l=[],u=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=zn(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=jn(f),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function yS(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?pn(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var m=wr(s["!ref"]);f.e.c=Math.max(f.e.c,m.e.c),f.e.r=Math.max(f.e.r,m.e.r),a==-1&&(a=m.e.r+1,f.e.r=a+t.length-1+i)}else a==-1&&(a=0,f.e.r=t.length-1+i);var p=n.header||[],h=0;t.forEach(function(g,b){Tn(g).forEach(function(y){(h=p.indexOf(y))==-1&&(p[h=p.length]=y);var w=g[y],_="z",j="",O=ir({c:o+h,r:a+b+i});u=vd(s,O),w&&typeof w=="object"&&!(w instanceof Date)?s[O]=w:(typeof w=="number"?_="n":typeof w=="boolean"?_="b":typeof w=="string"?_="s":w instanceof Date?(_="d",n.cellDates||(_="n",w=gi(w)),j=n.dateNF||Or[14]):w===null&&n.nullError&&(_="e",w=0),u?(u.t=_,u.v=w,delete u.w,delete u.R,j&&(u.z=j)):s[O]=u={t:_,v:w},j&&(u.z=j))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var v=jn(a);if(i)for(h=0;h<p.length;++h)s[zn(h+o)+v]={t:"s",v:p[h]};return s["!ref"]=Qr(f),s}function YI(e,t){return yS(null,e,t)}function vd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=pn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vd(e,ir(t)):vd(e,ir({r:t,c:r||0}))}function KI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function XI(){return{SheetNames:[],Sheets:{}}}function JI(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(lS(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function QI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=KI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function ZI(e,t){return e.z=t,e}function wS(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function eR(e,t,r){return wS(e,"#"+t,r)}function tR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function rR(e,t,r,n){for(var i=typeof t!="string"?t:wr(t),s=typeof t=="string"?t:Qr(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=vd(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var k1={encode_col:zn,encode_row:jn,encode_cell:ir,encode_range:Qr,decode_col:xx,decode_row:gx,split_cell:gP,decode_cell:pn,decode_range:Ri,format_cell:Ta,sheet_add_aoa:w3,sheet_add_json:yS,sheet_add_dom:hS,aoa_to_sheet:gu,json_to_sheet:YI,table_to_sheet:mS,table_to_book:kI,sheet_to_csv:Ax,sheet_to_txt:vS,sheet_to_json:im,sheet_to_html:dS,sheet_to_formulae:GI,sheet_to_row_object_array:im,sheet_get_cell:vd,book_new:XI,book_append_sheet:JI,book_set_sheet_visibility:QI,cell_set_number_format:ZI,cell_set_hyperlink:wS,cell_set_internal_link:eR,cell_add_comment:tR,sheet_set_array_formula:rR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Q5=(e,t,r,n,i,s="GHS")=>{var g;const a=new mt;a.setFont("helvetica","bold"),a.setFontSize(20),a.text(`Worker Report: ${e.name}`,14,20),a.setFont("helvetica","normal"),a.setFontSize(12),a.text(`Period: ${Mt(n,"MMM dd, yyyy")} - ${Mt(i,"MMM dd, yyyy")}`,14,30);const o=((g=$r[s])==null?void 0:g.symbol)||s,l=t.filter(b=>b.status==="completed"),u=t.filter(b=>b.status==="pending");l.reduce((b,y)=>{var w;return b+(((w=y.deductions)==null?void 0:w.reduce((_,j)=>_+j.amount,0))||0)},0);const f=l.reduce((b,y)=>{var _;const w=((_=y.deductions)==null?void 0:_.reduce((j,O)=>j+O.amount,0))||0;return b+(y.amount-w)},0),m=t.reduce((b,y)=>b+y.amount,0);a.setFont("helvetica","bold"),a.text("Summary:",14,40);const p=48;a.setFont("helvetica","normal"),a.text(`Total Tasks: ${t.length}`,20,p),a.text(`Assigned Tasks: ${u.length}`,20,p+8),a.text(`Completed Tasks: ${l.length}`,20,p+16),a.text(`Weekly Project Total: ${o} ${m.toFixed(2)}`,20,p+24),a.text(`Completed Earnings: ${o} ${f.toFixed(2)}`,20,p+32),a.setFont("helvetica","bold"),a.text("Tasks Details:",14,p+56),a.setFont("helvetica","normal");let h=p+70;t.forEach((b,y)=>{var O,L,E;const w=(O=r.find(C=>C.project_id===b.project_id))==null?void 0:O.project,_=((L=b.deductions)==null?void 0:L.reduce((C,P)=>C+P.amount,0))||0,j=b.amount-_;if(h>250&&(a.addPage(),h=20),gf(a,{startY:h,head:[[{content:`Task ${y+1}`,styles:{halign:"left",fillColor:[37,99,235]}}]],theme:"plain",headStyles:{textColor:255,fontSize:12,fontStyle:"bold",cellPadding:8},margin:{left:20}}),gf(a,{startY:a.lastAutoTable.finalY,body:[["Date",Mt(new Date(b.date),"MMM dd, yyyy")],["Project",(w==null?void 0:w.name)||"Unknown Project"],["Status",b.status.charAt(0).toUpperCase()+b.status.slice(1)],["Completed",b.completed_at?Mt(new Date(b.completed_at),"MMM dd, yyyy HH:mm"):"-"],["Amount",`${o} ${b.amount.toFixed(2)}`],["Deductions",`${o} ${_.toFixed(2)}`],["Net Amount",`${o} ${j.toFixed(2)}`]],theme:"striped",styles:{fontSize:10,cellPadding:8,overflow:"linebreak",minCellWidth:80},columnStyles:{0:{fontStyle:"bold",fillColor:[243,244,246]}},margin:{left:20}}),b.description&&gf(a,{startY:a.lastAutoTable.finalY+2,head:[["Description"]],body:[[b.description]],theme:"plain",styles:{fontSize:10,cellPadding:8,overflow:"linebreak",cellWidth:"wrap"},headStyles:{fillColor:[253,224,71],textColor:[120,53,15],fontStyle:"bold"},margin:{left:20}}),(E=b.deductions)!=null&&E.length){const C=b.deductions.map(P=>[`GHS ${P.amount.toFixed(2)}`,P.reason]);gf(a,{startY:a.lastAutoTable.finalY+2,head:[["Deduction Amount","Deduction Reason"]],body:C,theme:"plain",styles:{fontSize:10,cellPadding:8,overflow:"linebreak"},headStyles:{fillColor:[252,165,165],textColor:[127,29,29],fontStyle:"bold"},margin:{left:20}})}h=a.lastAutoTable.finalY+15});const v=`
*Work Report for ${e.name}*
Period: ${Mt(n,"MMM dd, yyyy")} - ${Mt(i,"MMM dd, yyyy")}

*Summary*
Total Tasks: ${t.length} 
Assigned Tasks: ${u.length}
Tasks Completed: ${l.length}
Weekly Project Total: ${o} ${m.toFixed(2)}
Completed Earnings: ${o} ${f.toFixed(2)}

Your detailed report has been attached as a PDF.

Thank you for your service!
`;return{pdf:a.save(`${e.name}_report_${Mt(n,"yyyy-MM-dd")}.pdf`),whatsappMessage:encodeURIComponent(v)}},nR=(e,t,r="GHS")=>{var f;const n=((f=$r[r])==null?void 0:f.symbol)||r,i=k1.book_new(),s=e.map(m=>({Date:Mt(new Date(m.date),"MMM dd, yyyy"),"Total Tasks":m.totalTasks,"Total Amount":`${n} ${m.totalAmount.toFixed(2)}`,"Total Deductions":`${n} ${m.totalDeductions.toFixed(2)}`,"Net Amount":`${n} ${m.netAmount.toFixed(2)}`})),a=k1.json_to_sheet(s);k1.book_append_sheet(i,a,"Financial Report");const o=new mt;o.setFontSize(20),o.text("Financial Report",14,20),o.setFontSize(12),o.text(`Period: ${Mt(t.start,"MMM dd, yyyy")} - ${Mt(t.end,"MMM dd, yyyy")}`,14,30);const l=e.reduce((m,p)=>({tasks:m.tasks+p.totalTasks,amount:m.amount+p.totalAmount,deductions:m.deductions+p.totalDeductions,net:m.net+p.netAmount}),{tasks:0,amount:0,deductions:0,net:0});o.text("Summary:",14,40),o.text(`Total Tasks: ${l.tasks}`,20,48),o.text(`Total Amount: ${n} ${l.amount.toFixed(2)}`,20,56),o.text(`Total Deductions: ${n} ${l.deductions.toFixed(2)}`,20,64),o.text(`Net Amount: ${n} ${l.net.toFixed(2)}`,20,72);const u=e.map(m=>[Mt(new Date(m.date),"MMM dd, yyyy"),m.totalTasks.toString(),`${n} ${m.totalAmount.toFixed(2)}`,`${n} ${m.totalDeductions.toFixed(2)}`,`${n} ${m.netAmount.toFixed(2)}`]);return gf(o,{startY:80,head:[["Date","Tasks","Amount","Deductions","Net Amount"]],body:u,theme:"striped",styles:{fontSize:8},headStyles:{fillColor:[59,130,246]}}),{workbook:i,pdf:o}};function iR({worker:e,tasks:t,workerProjects:r,isEditing:n,setIsEditing:i,editedWorker:s,setEditedWorker:a,handleEditWorker:o,handleDeleteWorker:l}){var C;const[u,f]=me.useState(!1),m=me.useRef(null),{addToast:p}=vn(),{organization:h}=Gt(),v=new Date,g=Di(v,{weekStartsOn:1}),b=_o(v,{weekStartsOn:1}),y=t.filter(P=>P.status==="pending"),w=t.filter(P=>P.status==="completed"),_=async P=>{var T,A;const R=(T=P.target.files)==null?void 0:T[0];if(!(!R||!e))try{if(f(!0),!["image/jpeg","image/jpg","image/png"].includes(R.type))throw new Error("Please upload a JPG, JPEG, or PNG file");if(R.size>5*1024*1024)throw new Error("Image must be less than 5MB");const z=(A=R.name.split(".").pop())==null?void 0:A.toLowerCase();if(!z||!["jpg","jpeg","png"].includes(z))throw new Error("Invalid file extension");const ne=`${Math.random().toString(36).substring(2)}.${z}`,U=`worker-${e.id}/${ne}`,{error:G}=await $e.storage.from("profiles").upload(U,R,{cacheControl:"3600",upsert:!0});if(G)throw G;const{data:{publicUrl:B}}=$e.storage.from("profiles").getPublicUrl(U),{error:Y}=await $e.from("workers").update({image:B}).eq("id",e.id);if(Y)throw Y;a(re=>re?{...re,image:B}:null),p({type:"success",title:"Image Uploaded",message:"Profile image has been updated successfully."})}catch(q){console.error("Error uploading image:",q),p({type:"error",title:"Upload Failed",message:q instanceof Error?q.message:"Failed to upload image"})}finally{f(!1),m.current&&(m.current.value="")}},j=()=>{e&&Q5(e,t,r,g,b,h.currency)},O=()=>{if(!(e!=null&&e.whatsapp))return;const{whatsappMessage:P}=Q5(e,t,r,g,b,h.currency);window.open(`https://wa.me/${e.whatsapp}?text=${P}`,"_blank")},L=w.reduce((P,R)=>{var A;const T=((A=R.deductions)==null?void 0:A.reduce((q,z)=>q+z.amount,0))||0;return P+(R.amount-T)},0),E=((C=$r[h.currency])==null?void 0:C.symbol)||h.currency;return c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"flex items-start justify-between",children:c.jsxs("div",{className:"flex items-center space-x-5",children:[c.jsxs("div",{className:"relative h-20 w-20 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:[e.image?c.jsx("img",{src:e.image,alt:e.name,className:"h-full w-full object-cover",onError:P=>{console.error("Image failed to load:",e.image),P.currentTarget.src="",P.currentTarget.onerror=null}}):c.jsx("span",{className:"text-3xl font-medium text-gray-600",children:e.name[0].toUpperCase()}),n&&c.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:[c.jsx("input",{type:"file",ref:m,onChange:_,accept:"image/jpeg,image/jpg,image/png",className:"hidden"}),c.jsx("button",{onClick:()=>{var P;return(P=m.current)==null?void 0:P.click()},disabled:u,className:"p-2 bg-white rounded-full hover:bg-gray-100",children:u?c.jsx(kl,{className:"h-5 w-5 text-gray-600 animate-spin"}):c.jsx(cd,{className:"h-5 w-5 text-gray-600"})})]})]}),c.jsx("div",{children:n?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),c.jsx("input",{type:"text",value:(s==null?void 0:s.name)||"",onChange:P=>a(R=>R?{...R,name:P.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp"}),c.jsx("input",{type:"text",value:(s==null?void 0:s.whatsapp)||"",onChange:P=>a(R=>R?{...R,whatsapp:P.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter WhatsApp number"})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:o,disabled:u,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400",children:u?"Uploading...":"Save Changes"}),c.jsx("button",{onClick:()=>{i(!1),a(e)},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"})]})]}):c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e.name}),e.whatsapp&&c.jsxs("div",{className:"mt-2 flex items-center text-gray-500",children:[c.jsx(rx,{className:"h-4 w-4 mr-2"}),c.jsx("span",{children:e.whatsapp})]}),c.jsxs("div",{className:"mt-4 flex flex-wrap gap-3",children:[c.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(mu,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),c.jsxs("button",{onClick:j,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(Fg,{className:"h-4 w-4 mr-2"}),"Download Report"]}),e.whatsapp&&c.jsxs("button",{onClick:O,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(o_,{className:"h-4 w-4 mr-2"}),"WhatsApp"]}),c.jsxs("button",{onClick:l,className:"inline-flex items-center px-3 py-1.5 border border-red-300 rounded-md text-sm font-medium text-red-700 bg-white hover:bg-red-50",children:[c.jsx(is,{className:"h-4 w-4 mr-2"}),"Delete Worker"]})]})]})})]})}),c.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-5 sm:grid-cols-3",children:[c.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Fl,{className:"h-6 w-6 text-yellow-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Assigned Tasks"}),c.jsx("p",{className:"mt-1 text-2xl font-semibold text-yellow-900",children:y.length})]})]})}),c.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Ns,{className:"h-6 w-6 text-green-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-sm font-medium text-green-900",children:"Completed Tasks"}),c.jsx("p",{className:"mt-1 text-2xl font-semibold text-green-900",children:w.length})]})]})}),c.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(jo,{className:"h-6 w-6 text-yellow-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Completed Earnings"}),c.jsxs("p",{className:"mt-1 text-2xl font-semibold text-yellow-900",children:[E," ",L.toFixed(2)]})]})]})})]})]})})}const t0="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function sR({worker:e,workerProjects:t,setWorkerProjects:r,organization:n}){var j;const[i,s]=me.useState(!1),[a,o]=me.useState(null),[l,u]=me.useState(0),[f,m]=me.useState(""),[p,h]=me.useState({name:"",rate:0}),{confirm:v}=u_(),{addToast:g}=f_(),b=((j=$r[n.currency])==null?void 0:j.symbol)||n.currency,y=async()=>{if(!(!n||!e||!p.name.trim()||!p.rate))try{const{data:O,error:L}=await $e.from("projects").insert([{organization_id:n.id,name:p.name.trim(),base_price:p.rate}]).select().single();if(L)throw L;const{data:E,error:C}=await $e.from("worker_project_rates").insert([{worker_id:e.id,project_id:O.id,rate:p.rate}]).select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).single();if(C)throw C;r(P=>[...P,E]),h({name:"",rate:0}),s(!1),g({type:"success",title:"Project Added",message:"The project has been added successfully."})}catch(O){console.error("Error adding project:",O),g({type:"error",title:"Error",message:"Failed to add project. Please try again."})}},w=async O=>{var L;try{const{error:E}=await $e.from("projects").update({name:f}).eq("id",(L=t.find(P=>P.id===O))==null?void 0:L.project_id);if(E)throw E;const{error:C}=await $e.from("worker_project_rates").update({rate:l}).eq("id",O);if(C)throw C;r(P=>P.map(R=>R.id===O?{...R,rate:l,project:{...R.project,name:f}}:R)),o(null),m(""),u(0),g({type:"success",title:"Rate Updated",message:"The project has been updated successfully."})}catch(E){console.error("Error updating project rate:",E),g({type:"error",title:"Error",message:"Failed to update project rate. Please try again."})}},_=async O=>{if(await v({title:"Delete Project",message:"Are you sure you want to delete this project? This action cannot be undone.",type:"warning",confirmText:"Delete",cancelText:"Cancel"}))try{const E=t.find(P=>P.id===O);if(!E)throw new Error("Project not found");const{error:C}=await $e.from("projects").delete().eq("id",E.project_id);if(C)throw C;r(P=>P.filter(R=>R.id!==O)),g({type:"success",title:"Project Deleted",message:"Project deleted successfully"})}catch(E){console.error("Error deleting project:",E),g({type:"error",title:"Error",message:E instanceof Error?E.message:"Failed to delete project"})}};return c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Projects and Rates"}),c.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Project"]})]}),i&&c.jsxs("div",{className:"mb-6 bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add New Project"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Project Name"}),c.jsx("input",{type:"text",value:p.name,onChange:O=>h(L=>({...L,name:O.target.value})),className:t0,placeholder:"Enter project name"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Rate (",b,")"]}),c.jsx("input",{type:"number",value:p.rate||"",onChange:O=>h(L=>({...L,rate:parseFloat(O.target.value)||0})),className:t0,min:"0",step:"0.01",placeholder:"Enter project rate"})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:y,disabled:!p.name.trim()||!p.rate,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Project"})]})]})]}),c.jsx("div",{className:"mt-4",children:t.length===0?c.jsx("p",{className:"text-center text-gray-500 py-4",children:"No projects assigned yet."}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(O=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===O.id?c.jsx("input",{type:"text",value:f,onChange:L=>m(L.target.value),className:`${t0} w-full`,placeholder:"Enter project name"}):O.project.name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===O.id?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"number",value:l||"",onChange:L=>u(parseFloat(L.target.value)||0),className:`${t0} w-24`,min:"0",step:"0.01"}),c.jsx("button",{onClick:()=>w(O.id),className:"text-green-600 hover:text-green-700",children:c.jsx(Ns,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>o(null),className:"text-red-600 hover:text-red-700",children:c.jsx(Bo,{className:"h-5 w-5"})})]}):c.jsxs("span",{children:[b," ",O.rate.toFixed(2)]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a!==O.id&&c.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[c.jsx("button",{onClick:()=>{o(O.id),u(O.rate),m(O.project.name)},className:"text-blue-600 hover:text-blue-700",children:c.jsx(mu,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>_(O.id),className:"text-red-600 hover:text-red-700",title:"Delete project",children:c.jsx(is,{className:"h-5 w-5"})})]})})]},O.id))})]})})})]})})}const Z5="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function aR({task:e,tasks:t,setTasks:r,organization:n}){var m;const[i,s]=me.useState({amount:0,reason:""}),{confirm:a,addToast:o}=vn(),l=((m=$r[n.currency])==null?void 0:m.symbol)||n.currency,u=async()=>{if(!(!e.id||!i.amount||!i.reason))try{const{data:p,error:h}=await $e.from("deductions").insert([{task_id:e.id,amount:i.amount,reason:i.reason.trim()}]).select().single();if(h)throw h;r(v=>v.map(g=>g.id===e.id?{...g,deductions:[...g.deductions||[],p]}:g)),s({amount:0,reason:""}),o({type:"success",title:"Deduction Added",message:"The deduction has been added successfully."})}catch(p){console.error("Error adding deduction:",p),o({type:"error",title:"Error",message:"Failed to add deduction. Please try again."})}},f=async p=>{if(await a({title:"Remove Deduction",message:"Are you sure you want to remove this deduction? This action cannot be undone.",type:"danger",confirmText:"Remove",cancelText:"Cancel"}))try{const{error:v}=await $e.from("deductions").delete().eq("id",p);if(v)throw v;r(g=>g.map(b=>{var y;return b.id===e.id?{...b,deductions:(y=b.deductions)==null?void 0:y.filter(w=>w.id!==p)}:b})),o({type:"success",title:"Deduction Removed",message:"The deduction has been removed successfully."})}catch(v){console.error("Error removing deduction:",v),o({type:"error",title:"Error",message:"Failed to remove deduction. Please try again."})}};return c.jsxs("div",{className:"mt-4 border-t pt-4",children:[c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Deduction"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm text-gray-700",children:["Amount (",l,")"]}),c.jsx("input",{type:"number",value:i.amount||"",onChange:p=>s(h=>({...h,amount:parseFloat(p.target.value)||0})),className:Z5,min:"0",step:"0.01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-700",children:"Reason"}),c.jsx("input",{type:"text",value:i.reason,onChange:p=>s(h=>({...h,reason:p.target.value})),className:Z5})]})]}),c.jsx("button",{onClick:u,disabled:!i.amount||!i.reason.trim(),className:"mt-4 w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Deduction"})]}),e.deductions&&e.deductions.length>0&&c.jsxs("div",{className:"mt-4 space-y-2",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Deductions"}),e.deductions.map(p=>c.jsxs("div",{className:"flex items-center justify-between bg-red-50 p-3 rounded",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-sm font-medium text-red-900",children:[l," ",p.amount.toFixed(2)]}),c.jsx("p",{className:"text-sm text-red-700",children:p.reason}),c.jsx("p",{className:"text-xs text-red-600",children:Mt(new Date(p.created_at),"MMM d, yyyy HH:mm")})]}),c.jsx("button",{onClick:()=>f(p.id),className:"p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-100",children:c.jsx(Bo,{className:"h-5 w-5"})})]},p.id))]})]})}const E1={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},delayed:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"}},j1={pending:"Assigned",in_progress:"In Progress",delayed:"Delayed",completed:"Completed"},cf="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function oR({worker:e,tasks:t,setTasks:r,workerProjects:n,organization:i}){var O;const[s,a]=me.useState(!1),[o,l]=me.useState(null),[u,f]=me.useState(null),[m,p]=me.useState(""),[h,v]=me.useState({project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),{confirm:g,addToast:b}=vn(),y=((O=$r[i.currency])==null?void 0:O.symbol)||i.currency,w=async(L,E,C)=>{try{const P={status:E};E==="completed"?P.completed_at=new Date().toISOString():E==="delayed"&&(P.delay_reason=C),P.status_changed_at=new Date().toISOString();const{error:R}=await $e.from("tasks").update(P).eq("id",L);if(R)throw R;r(T=>T.map(A=>A.id===L?{...A,...P}:A)),f(null),p(""),b({type:"success",title:"Status Updated",message:`Task marked as ${j1[E]}`})}catch(P){console.error("Error updating task status:",P),b({type:"error",title:"Error",message:"Failed to update task status"})}},_=async()=>{var R;if(!i||!e||!h.project_id)return;const L=((R=n.find(T=>T.project_id===h.project_id))==null?void 0:R.rate)||0,E=new Date(h.date),C=El(new Date),P=ml(C,E);if(P&&!h.late_reason){b({type:"warning",title:"Late Entry",message:"Please provide a reason for adding a task for a past date."});return}try{const{data:T,error:A}=await $e.from("tasks").insert([{organization_id:i.id,worker_id:e.id,project_id:h.project_id,description:h.description.trim()||null,date:h.date,amount:L,status:"pending",late_reason:P?h.late_reason:null}]).select(`
          *,
          deductions (*)
        `).single();if(A)throw A;r(q=>[T,...q]),v({project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),a(!1),b({type:"success",title:"Task Added",message:"The task has been added successfully."})}catch(T){console.error("Error adding task:",T),b({type:"error",title:"Error",message:"Failed to add task. Please try again."})}},j=async L=>{if(await g({title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:C}=await $e.from("tasks").delete().eq("id",L);if(C)throw C;r(P=>P.filter(R=>R.id!==L)),b({type:"success",title:"Task Deleted",message:"The task has been deleted successfully."})}catch(C){console.error("Error deleting task:",C),b({type:"error",title:"Error",message:"Failed to delete task. Please try again."})}};return c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Tasks"}),c.jsxs("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Task"]})]}),s&&c.jsxs("div",{className:"mb-6 bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"New Task"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Project"}),c.jsxs("select",{value:h.project_id,onChange:L=>v(E=>({...E,project_id:L.target.value})),className:cf,children:[c.jsx("option",{value:"",children:"Select a project"}),n.map(L=>c.jsxs("option",{value:L.project_id,children:[L.project.name," - ",y," ",L.rate.toFixed(2)]},L.project_id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),c.jsx("input",{type:"text",value:h.description,onChange:L=>v(E=>({...E,description:L.target.value})),className:cf,placeholder:"Enter task description (optional)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),c.jsx("input",{type:"date",value:h.date,onChange:L=>v(E=>({...E,date:L.target.value})),className:cf,max:new Date().toISOString().split("T")[0]})]}),ml(El(new Date),new Date(h.date))&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Late Entry"}),c.jsx("textarea",{value:h.late_reason,onChange:L=>v(E=>({...E,late_reason:L.target.value})),className:`${cf} h-20`,placeholder:"Please provide a reason for adding this task after the date",required:!0})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:_,disabled:!h.project_id,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Task"})]})]})]}),c.jsx("div",{className:"space-y-4",children:t.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No tasks found. Start by adding a new task."}):t.map(L=>{var R,T;const E=(R=n.find(A=>A.project_id===L.project_id))==null?void 0:R.project,C=((T=L.deductions)==null?void 0:T.reduce((A,q)=>A+q.amount,0))||0,P=L.amount-C;return c.jsx("div",{className:"bg-white border rounded-lg shadow-sm",children:c.jsxs("div",{className:"p-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("span",{className:`mt-1 ${L.status==="completed"?"text-green-500":"text-yellow-500"}`,children:L.status==="completed"?c.jsx(Ns,{className:"h-5 w-5"}):c.jsx(Bo,{className:"h-5 w-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:c.jsx("h4",{className:"text-lg font-medium text-gray-900",children:E==null?void 0:E.name})}),L.description&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:L.description}),L.late_reason&&c.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["Late entry: ",L.late_reason]}),L.status==="delayed"&&L.delay_reason&&c.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Delay reason: ",L.delay_reason]}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-gray-500",children:[c.jsxs("span",{children:["Created: ",Mt(new Date(L.created_at),"MMM d, yyyy HH:mm")]}),L.completed_at&&c.jsxs("span",{children:["Completed: ",Mt(new Date(L.completed_at),"MMM d, yyyy HH:mm")]})]})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-3",children:[c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Amount: ",y," ",L.amount.toFixed(2)]}),C>0&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-sm font-medium text-red-600",children:["-",y," ",C.toFixed(2)]}),c.jsxs("p",{className:"text-sm font-medium text-green-600",children:["Net: ",y," ",P.toFixed(2)]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>{f(u===L.id?null:L.id)},className:`px-3 py-1.5 text-xs font-medium rounded-full ${E1[L.status].bg} ${E1[L.status].text} ${E1[L.status].hover}`,children:j1[L.status]}),c.jsx("button",{onClick:()=>l(o===L.id?null:L.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:c.jsx(Og,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>j(L.id),className:"p-2 text-red-400 hover:text-red-600 rounded-full hover:bg-red-50",children:c.jsx(is,{className:"h-5 w-5"})})]})]})]}),u===L.id&&c.jsx("div",{className:"mt-4 border-t pt-4",children:c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Update Task Status"}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(j1).map(([A,q])=>A!==L.status&&(A!=="delayed"?c.jsx("button",{onClick:()=>w(L.id,A),className:"px-3 py-1.5 text-sm font-medium rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:q},A):null))}),L.status!=="delayed"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Delay Reason"}),c.jsx("textarea",{value:m,onChange:A=>p(A.target.value),className:`${cf} h-20`,placeholder:"Please provide a reason for the delay",required:!0}),c.jsx("button",{onClick:()=>w(L.id,"delayed",m),disabled:!m.trim(),className:"mt-4 w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Mark as Delayed"})]})]})]})}),o===L.id&&c.jsx(aR,{task:L,tasks:t,setTasks:r,organization:i})]})},L.id)})})]})})}function lR(){const[e,t]=me.useState(null),[r,n]=me.useState(!1),[i,s]=me.useState(null),[a,o]=me.useState([]),[l,u]=me.useState([]),[f,m]=me.useState(!0),[p,h]=me.useState(new Date),v=Di(p,{weekStartsOn:1}),g=_o(p,{weekStartsOn:1}),b=new Date,y=Lm(p,{weekStartsOn:1}),w=ix(p),{id:_}=K2(),j=fu(),{organization:O}=Gt(),{confirm:L,addToast:E}=vn();me.useEffect(()=>{!O||!_||C()},[_,O,p]);const C=async()=>{try{const{data:A,error:q}=await $e.from("workers").select("*, organization:organizations(id)").eq("id",_).single();if(q)throw q;t({...A,organization_id:A.organization.id}),s({...A,organization_id:A.organization.id});const{data:z,error:ne}=await $e.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).eq("worker_id",_);if(ne)throw ne;o(z||[]);const{data:U,error:G}=await $e.from("tasks").select(`
          *,
          deductions (*)
        `).eq("worker_id",_).gte("date",v.toISOString()).lte("date",g.toISOString()).order("created_at",{ascending:!1});if(G)throw G;u(U||[])}catch(A){console.error("Error loading data:",A),E({type:"error",title:"Error",message:"Failed to load worker data. Please try again."})}finally{m(!1)}},P=async()=>{if(!(!e||!i||!O))try{const{error:A}=await $e.from("workers").update({name:i.name,whatsapp:i.whatsapp,image:i.image}).eq("id",e.id).eq("organization_id",O.id);if(A)throw A;t(i),n(!1),E({type:"success",title:"Worker Updated",message:"Worker details have been updated successfully."})}catch(A){console.error("Error updating worker:",A),E({type:"error",title:"Error",message:"Failed to update worker. Please try again."})}},R=async()=>{if(!(!e||!await L({title:"Delete Worker",message:"Are you sure you want to delete this worker? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"})))try{if(e.image){const z=e.image.split("/").slice(-2).join("/");await $e.storage.from("profiles").remove([z])}const{error:q}=await $e.from("workers").delete().eq("id",e.id);if(q)throw q;E({type:"success",title:"Worker Deleted",message:"The worker has been deleted successfully."}),j("/dashboard/workers")}catch(q){console.error("Error deleting worker:",q),E({type:"error",title:"Error",message:"Failed to delete worker. Please try again."})}},T=A=>{h(q=>{const z=new Date(q);return A==="prev"?z.setDate(z.getDate()-7):z.setDate(z.getDate()+7),z})};return f?c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading worker details..."})]})}):e?c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>T("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:c.jsx(Cm,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"text-sm",children:[c.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",y,", ",w]}),c.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[Mt(v,"MMM d")," - ",Mt(g,"MMM d")]})]}),c.jsx("button",{onClick:()=>T("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:ml(g,b),children:c.jsx(Pm,{className:"h-5 w-5 text-gray-600"})})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[l.length," tasks this week"]})]})}),c.jsx(iR,{worker:e,tasks:l,workerProjects:a,isEditing:r,setIsEditing:n,editedWorker:i,setEditedWorker:s,handleEditWorker:P,handleDeleteWorker:R}),c.jsx(sR,{worker:e,workerProjects:a,setWorkerProjects:o,organization:O}),c.jsx(oR,{worker:e,tasks:l,setTasks:u,workerProjects:a,organization:O})]}):c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600",children:"Worker not found."}),c.jsxs("button",{onClick:()=>j("/dashboard/workers"),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(ld,{className:"h-4 w-4 mr-2"}),"Back to Workers"]})]})})}function cR(){var o;const{organization:e}=Gt(),[t,r]=me.useState({totalWorkers:0,pendingTasks:0,inProgressTasks:0,delayedTasks:0,completedTasks:0,totalPayouts:0}),[n,i]=me.useState(!0),s=((o=$r[e.currency])==null?void 0:o.symbol)||e.currency;if(me.useEffect(()=>{(async()=>{if(e)try{const{count:u}=await $e.from("workers").select("*",{count:"exact",head:!0}).eq("organization_id",e.id),{data:f}=await $e.from("tasks").select("status, amount, deductions(*)").eq("organization_id",e.id),m=(f==null?void 0:f.filter(b=>b.status==="pending").length)||0,p=(f==null?void 0:f.filter(b=>b.status==="in_progress").length)||0,h=(f==null?void 0:f.filter(b=>b.status==="delayed").length)||0,v=(f==null?void 0:f.filter(b=>b.status==="completed").length)||0,g=(f==null?void 0:f.reduce((b,y)=>{var _;const w=((_=y.deductions)==null?void 0:_.reduce((j,O)=>j+(O.amount||0),0))||0;return b+(y.amount-w)},0))||0;r({totalWorkers:u||0,pendingTasks:m,inProgressTasks:p,delayedTasks:h,completedTasks:v,totalPayouts:g})}catch(u){console.error("Error loading stats:",u)}finally{i(!1)}})()},[e]),n)return c.jsx("div",{className:"animate-pulse",children:c.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((l,u)=>c.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:c.jsxs("div",{className:"p-5",children:[c.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-4"}),c.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"})]})},u))})});const a=[{name:"Total Workers",value:t.totalWorkers,icon:nu,color:"text-blue-600",bg:"bg-blue-100",link:"/dashboard/workers"},{name:"Assigned Tasks",value:t.pendingTasks,icon:Dc,color:"text-yellow-600",bg:"bg-yellow-100",link:"/dashboard/tasks/pending"},{name:"In Progress",value:t.inProgressTasks,icon:Dc,color:"text-blue-600",bg:"bg-blue-100",link:"/dashboard/tasks/in_progress"},{name:"Delayed Tasks",value:t.delayedTasks,icon:Dc,color:"text-red-600",bg:"bg-red-100",link:"/dashboard/tasks/delayed"},{name:"Completed Tasks",value:t.completedTasks,icon:$A,color:"text-green-600",bg:"bg-green-100",link:"/dashboard/tasks/completed"},{name:"Total Payouts",value:`${s} ${t.totalPayouts.toFixed(2)}`,icon:jo,color:"text-purple-600",bg:"bg-purple-100",link:"/dashboard/finances"}];return c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:a.map(l=>c.jsx(Fr,{to:l.link,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow",children:c.jsx("div",{className:"p-5",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:`flex-shrink-0 ${l.bg} rounded-md p-3`,children:c.jsx(l.icon,{className:`h-6 w-6 ${l.color}`,"aria-hidden":"true"})}),c.jsx("div",{className:"ml-5 w-0 flex-1",children:c.jsxs("dl",{children:[c.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:l.name}),c.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:l.value})]})})]})})},l.name))}),c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Quick Actions"}),c.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[c.jsxs(Fr,{to:"/dashboard/workers",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[c.jsx("div",{className:"flex-shrink-0 bg-blue-100 rounded-md p-3",children:c.jsx(nu,{className:"h-6 w-6 text-blue-600","aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Manage Workers"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Add or edit worker details"})]})]}),c.jsxs(Fr,{to:"/dashboard/tasks",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[c.jsx("div",{className:"flex-shrink-0 bg-yellow-100 rounded-md p-3",children:c.jsx(Dc,{className:"h-6 w-6 text-yellow-600","aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Manage Tasks"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Create and track tasks"})]})]}),c.jsxs(Fr,{to:"/dashboard/finances",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[c.jsx("div",{className:"flex-shrink-0 bg-purple-100 rounded-md p-3",children:c.jsx(jo,{className:"h-6 w-6 text-purple-600","aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Financial Reports"}),c.jsx("p",{className:"text-sm text-gray-500",children:"View and export financial data"})]})]})]})]})})]})}const r0={pending:"Pending",in_progress:"In Progress",completed:"Completed",delayed:"Delayed"},Qo={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},delayed:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"}};function uf({status:e}){var M;const{organization:t}=Gt(),[r,n]=me.useState([]),[i,s]=me.useState([]),[a,o]=me.useState([]),[l,u]=me.useState(!0),[f,m]=me.useState(!1),[p,h]=me.useState(null),[v,g]=me.useState(null),[b,y]=me.useState(new Date),{weekStart:w,weekEnd:_,currentWeek:j,currentYear:O}=me.useMemo(()=>{const D=Di(b,{weekStartsOn:1}),V=_o(b,{weekStartsOn:1}),se=Lm(b,{weekStartsOn:1}),fe=ix(b);return{weekStart:D,weekEnd:V,currentWeek:se,currentYear:fe}},[b]),L=new Date,[E,C]=me.useState(""),[P,R]=me.useState({worker_id:"",project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),[T,A]=me.useState({amount:0,reason:""}),{confirm:q,addToast:z}=vn(),ne=t!=null&&t.currency?((M=$r[t.currency])==null?void 0:M.symbol)||t.currency:"";me.useEffect(()=>{t!=null&&t.id&&U()},[t==null?void 0:t.id,w,_,e]),me.useEffect(()=>{!t||!P.worker_id||G(P.worker_id)},[t,P.worker_id]);const U=async()=>{if(!(t!=null&&t.id))return;const D=t.id;try{const{data:V,error:se}=await $e.from("workers").select("id, name").eq("organization_id",D);if(se)throw se;s(V||[]);let fe=$e.from("tasks").select(`
          *,
          deductions (*),
          project:projects(
            id,
            name
          ),
          worker:workers(
            id,
            name
          )
        `).eq("organization_id",D).gte("date",w.toISOString()).lte("date",_.toISOString()).order("created_at",{ascending:!1});e&&(fe=fe.eq("status",e));const{data:de,error:ve}=await fe;if(ve)throw ve;n(de||[])}catch(V){console.error("Error loading data:",V)}finally{u(!1)}},G=async D=>{if(t!=null&&t.id)try{const{data:se,error:fe}=await $e.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects!inner(
            id,
            name
          )
        `).eq("worker_id",D).returns();if(fe)throw fe;o(se||[])}catch(se){console.error("Error loading worker projects:",se)}},B=async()=>{var de;if(!t||!P.worker_id||!P.project_id)return;const D=((de=a.find(ve=>ve.project_id===P.project_id))==null?void 0:de.rate)||0,V=new Date(P.date),se=El(new Date),fe=ml(se,V);if(fe&&!P.late_reason){alert("Please provide a reason for adding a task for a past date.");return}try{const{data:ve,error:Ee}=await $e.from("tasks").insert([{organization_id:t.id,worker_id:P.worker_id,project_id:P.project_id,description:P.description.trim()||null,date:P.date,amount:D,status:"pending",late_reason:fe?P.late_reason:null}]).select(`
          *,
          deductions (*)
        `).single();if(Ee)throw Ee;n(Oe=>[ve,...Oe]),R({worker_id:"",project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),m(!1)}catch(ve){console.error("Error adding task:",ve)}},Y=async D=>{if(await q({title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:se}=await $e.from("tasks").delete().eq("id",D);if(se)throw se;n(fe=>fe.filter(de=>de.id!==D)),z({type:"success",title:"Task Deleted",message:"The task has been deleted successfully."})}catch(se){console.error("Error deleting task:",se),z({type:"error",title:"Error",message:"Failed to delete task. Please try again."})}},re=async(D,V,se)=>{try{const fe={status:V};V==="completed"?fe.completed_at=new Date().toISOString():V==="delayed"&&(fe.delay_reason=se),fe.status_changed_at=new Date().toISOString();const{error:de}=await $e.from("tasks").update(fe).eq("id",D);if(de)throw de;n(ve=>ve.map(Ee=>Ee.id===D?{...Ee,...fe}:Ee)),g(null),C(""),z({type:"success",title:"Status Updated",message:`Task marked as ${r0[V]}`})}catch(fe){console.error("Error updating task status:",fe),z({type:"error",title:"Error",message:"Failed to update task status"})}},he=async D=>{if(!(!D||!T.amount||!T.reason))try{const{data:V,error:se}=await $e.from("deductions").insert([{task_id:D,amount:T.amount,reason:T.reason.trim()}]).select().single();if(se)throw se;n(fe=>fe.map(de=>de.id===D?{...de,deductions:[...de.deductions||[],V]}:de)),A({amount:0,reason:""}),h(null)}catch(V){console.error("Error adding deduction:",V)}},k=async(D,V)=>{try{const{error:se}=await $e.from("deductions").delete().eq("id",V);if(se)throw se;n(fe=>fe.map(de=>{var ve;return de.id===D?{...de,deductions:(ve=de.deductions)==null?void 0:ve.filter(Ee=>Ee.id!==V)}:de}))}catch(se){console.error("Error removing deduction:",se)}},I=D=>{y(V=>{const se=new Date(V);return D==="prev"?se.setDate(se.getDate()-7):se.setDate(se.getDate()+7),se})};return l?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex gap-2 bg-white rounded-lg p-1 shadow-sm",children:[c.jsx(Fr,{to:"/dashboard/tasks",className:`px-3 py-1.5 text-sm font-medium rounded-md ${e?"text-gray-500 hover:bg-gray-50":"bg-gray-100 text-gray-900"}`,children:"All Tasks"}),Object.entries(r0).map(([D,V])=>c.jsx(Fr,{to:`/dashboard/tasks/${D}`,className:`px-3 py-1.5 text-sm font-medium rounded-md ${e===D?`${Qo[D].bg} ${Qo[D].text}`:"text-gray-500 hover:bg-gray-100"}`,children:V},D))]}),c.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>I("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:c.jsx(Cm,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"text-sm",children:[c.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",j,", ",O]}),c.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[Mt(w,"MMM d")," - ",Mt(_,"MMM d")]})]}),c.jsx("button",{onClick:()=>I("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:ml(_,L),children:c.jsx(Pm,{className:"h-5 w-5 text-gray-600"})})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," tasks this week"]})]})}),f&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border border-gray-100",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Task"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Worker *"}),c.jsxs("select",{value:P.worker_id,onChange:D=>R(V=>({...V,worker_id:D.target.value,project_id:""})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a worker"}),i.map(D=>c.jsx("option",{value:D.id,children:D.name},D.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project *"}),c.jsxs("select",{value:P.project_id,onChange:D=>R(V=>({...V,project_id:D.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",disabled:!P.worker_id,children:[c.jsx("option",{value:"",children:"Select a project"}),a.map(D=>c.jsxs("option",{value:D.project_id,children:[D.project.name," - ",ne," ",D.rate.toFixed(2)]},D.project_id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),c.jsx("input",{type:"text",value:P.description,onChange:D=>R(V=>({...V,description:D.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter task description (optional)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),c.jsx("input",{type:"date",value:P.date,onChange:D=>R(V=>({...V,date:D.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",max:new Date().toISOString().split("T")[0]})]}),ml(El(new Date),new Date(P.date))&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Late Entry"}),c.jsx("textarea",{value:P.late_reason,onChange:D=>R(V=>({...V,late_reason:D.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm h-20",placeholder:"Please provide a reason for adding this task after the date",required:!0})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{onClick:()=>m(!1),className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:B,disabled:!P.worker_id||!P.project_id,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsx("div",{className:"p-4 space-y-4",children:r.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:e?"No tasks found matching this status.":"No tasks found for this week."}):r.map(D=>{var fe,de,ve;const V=((fe=D.deductions)==null?void 0:fe.reduce((Ee,Oe)=>Ee+Oe.amount,0))||0,se=D.amount-V;return c.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("span",{className:`mt-1 ${D.status==="completed"?"text-green-500":D.status==="delayed"?"text-red-500":"text-yellow-500"}`,children:D.status==="completed"?c.jsx(Ns,{className:"h-5 w-5"}):D.status==="delayed"?c.jsx(Bo,{className:"h-5 w-5"}):c.jsx(Og,{className:"h-5 w-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[c.jsx("h4",{className:"text-lg font-medium text-gray-900",children:((de=D.project)==null?void 0:de.name)||"Unknown Project"}),c.jsxs("span",{className:"text-sm text-gray-500",children:["• Assigned to ",((ve=D.worker)==null?void 0:ve.name)||"Unknown Worker"]})]}),D.description&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:D.description}),D.late_reason&&c.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["Late entry: ",D.late_reason]}),D.status==="delayed"&&D.delay_reason&&c.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Delay reason: ",D.delay_reason]}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-gray-500",children:[c.jsxs("span",{children:["Created: ",Mt(new Date(D.created_at),"MMM d, yyyy HH:mm")]}),D.completed_at&&c.jsxs("span",{children:["Completed: ",Mt(new Date(D.completed_at),"MMM d, yyyy HH:mm")]})]})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-3",children:[c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Amount: ",ne," ",D.amount.toFixed(2)]}),V>0&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-sm font-medium text-red-600",children:["-",ne," ",V.toFixed(2)]}),c.jsxs("p",{className:"text-sm font-medium text-green-600",children:["Net: ",ne," ",se.toFixed(2)]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>g(v===D.id?null:D.id),className:`px-3 py-1.5 text-xs font-medium rounded-full ${Qo[D.status].bg} ${Qo[D.status].text} ${Qo[D.status].hover}`,children:r0[D.status]}),c.jsx("button",{onClick:()=>h(p===D.id?null:D.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:c.jsx(Og,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>Y(D.id),className:"p-2 text-red-400 hover:text-red-600 rounded-full hover:bg-red-50",children:c.jsx(is,{className:"h-5 w-5"})})]})]})]})}),v===D.id&&c.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Update Status"}),c.jsxs("div",{className:"space-y-3",children:[Object.entries(r0).map(([Ee,Oe])=>c.jsx("button",{onClick:()=>{if(Ee==="delayed"&&!E){z({type:"error",title:"Error",message:"Please provide a reason for the delay"});return}re(D.id,Ee,Ee==="delayed"?E:void 0)},className:`w-full px-3 py-2 text-sm font-medium rounded-md ${D.status===Ee?`${Qo[Ee].bg} ${Qo[Ee].text}`:"bg-white text-gray-700 hover:bg-gray-100"}`,children:Oe},Ee)),v===D.id&&c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Delay Reason"}),c.jsx("textarea",{value:E,onChange:Ee=>C(Ee.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm h-20",placeholder:"Required if marking as delayed"})]})]})]}),p===D.id&&c.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Deductions"}),D.deductions&&D.deductions.length>0&&c.jsx("div",{className:"mb-4 space-y-2",children:D.deductions.map(Ee=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{children:[c.jsxs("span",{className:"font-medium text-gray-900",children:[ne," ",Ee.amount.toFixed(2)]}),c.jsxs("span",{className:"text-gray-500 ml-2",children:["- ",Ee.reason]})]}),c.jsx("button",{onClick:()=>k(D.id,Ee.id),className:"text-red-400 hover:text-red-600",children:c.jsx(is,{className:"h-4 w-4"})})]},Ee.id))}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),c.jsx("input",{type:"number",value:T.amount,onChange:Ee=>A(Oe=>({...Oe,amount:parseFloat(Ee.target.value)||0})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason"}),c.jsx("input",{type:"text",value:T.reason,onChange:Ee=>A(Oe=>({...Oe,reason:Ee.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsx("button",{onClick:()=>he(D.id),disabled:!T.amount||!T.reason.trim(),className:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Deduction"})]})]})]},D.id)})})})]})}const ew=[{value:15,label:"0-15 employees"},{value:30,label:"15-30 employees"},{value:50,label:"30-50 employees"},{value:100,label:"50-100 employees"},{value:200,label:"100-200 employees"},{value:201,label:"200+ employees"}],A1={GHS:{name:"Ghanaian Cedi",symbol:"₵"},USD:{name:"US Dollar",symbol:"$"},EUR:{name:"Euro",symbol:"€"},GBP:{name:"British Pound",symbol:"£"},NGN:{name:"Nigerian Naira",symbol:"₦"}};function uR(){var p,h,v;const{organization:e,signOut:t}=Gt();fu();const[r,n]=me.useState(!1),[i,s]=me.useState({name:e.name,country:e.country||"",city:e.city||"",address:e.address||"",employee_count:e.employee_count||15,currency:e.currency||"GHS"}),[a,o]=me.useState(!1),{confirm:l,addToast:u}=vn(),f=async()=>{if(!i.name.trim()){n(!1);return}o(!0);try{const{error:g}=await $e.from("organizations").update({name:i.name.trim(),country:i.country,city:i.city,address:i.address,employee_count:i.employee_count,currency:i.currency}).eq("id",e.id);if(g)throw g;Gt.setState({organization:{...e,...i}}),n(!1),u({type:"success",title:"Organization Updated",message:"Organization details have been updated successfully."})}catch(g){console.error("Error updating organization:",g),u({type:"error",title:"Error",message:"Failed to update organization name. Please try again."})}finally{o(!1)}},m=async()=>{if(await l({title:"Delete Organization",message:"Are you sure you want to delete your organization? This will permanently delete all workers, tasks, and associated data. This action cannot be undone.",type:"danger",confirmText:"Delete Organization",cancelText:"Cancel"}))try{const{error:b}=await $e.from("organizations").delete().eq("id",e.id);if(b)throw b;await t(),window.location.href="/",u({type:"success",title:"Organization Deleted",message:"Your organization and all associated data have been permanently deleted."})}catch(b){console.error("Error deleting organization:",b),u({type:"error",title:"Error",message:"Failed to delete organization. Please try again."})}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg divide-y",children:[c.jsxs("div",{className:"px-6 py-5",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Qs,{className:"h-6 w-6 text-gray-400"}),c.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Services"})]}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage the services your organization provides."})]}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"space-y-4",children:c.jsxs(Fr,{to:"/dashboard/settings/services",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Manage Services"]})})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg divide-y",children:[c.jsxs("div",{className:"px-6 py-5",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Eo,{className:"h-6 w-6 text-gray-400"}),c.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Organization Settings"})]}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your organization's basic information and settings."})]}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"space-y-6",children:c.jsx("div",{children:r?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organization Name"}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{type:"text",value:i.name,onChange:g=>s(b=>({...b,name:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter organization name"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{type:"text",value:i.country,onChange:g=>s(b=>({...b,country:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{type:"text",value:i.city,onChange:g=>s(b=>({...b,city:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),c.jsx("div",{className:"mt-1",children:c.jsx("textarea",{value:i.address,onChange:g=>s(b=>({...b,address:g.target.value})),rows:3,className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Employees"}),c.jsx("div",{className:"mt-1",children:c.jsx("select",{value:i.employee_count||"",onChange:g=>s(b=>({...b,employee_count:parseInt(g.target.value)})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:ew.map((g,b)=>c.jsx("option",{value:g.value,children:g.label},b))})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Currency"}),c.jsx("div",{className:"mt-1",children:c.jsx("select",{value:i.currency,onChange:g=>s(b=>({...b,currency:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:Object.entries(A1).map(([g,{name:b,symbol:y}])=>c.jsxs("option",{value:g,children:[g," (",y,") - ",b]},g))})})]}),c.jsx("button",{onClick:f,disabled:a||!i.name.trim(),className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:a?"Saving...":"Save"}),c.jsx("button",{onClick:()=>{n(!1),s({name:e.name,country:e.country,city:e.city,address:e.address,employee_count:e.employee_count,currency:e.currency})},className:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Eo,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Organization Name"}),c.jsx("p",{className:"text-base text-gray-900",children:e.name})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(FA,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Country"}),c.jsx("p",{className:"text-base text-gray-900",children:e.country})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(TA,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"City"}),c.jsx("p",{className:"text-base text-gray-900",children:e.city})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(tx,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Address"}),c.jsx("p",{className:"text-base text-gray-900",children:e.address})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(nu,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Number of Employees"}),c.jsx("p",{className:"text-base text-gray-900",children:((p=ew.find(g=>g.value===e.employee_count))==null?void 0:p.label)||"Not set"})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(PA,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Currency"}),c.jsxs("p",{className:"text-base text-gray-900",children:[e.currency," (",(h=A1[e.currency])==null?void 0:h.symbol,") - ",(v=A1[e.currency])==null?void 0:v.name]})]})]})]}),c.jsx("button",{onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Edit Organization Details"})]})})})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg divide-y space-y-4",children:[c.jsxs("div",{className:"px-6 py-5",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(od,{className:"h-6 w-6 text-red-500"}),c.jsx("h3",{className:"ml-3 text-lg font-medium text-red-600",children:"Danger Zone"})]}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Irreversible and destructive actions"})]}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(od,{className:"h-5 w-5 text-red-400"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Delete Organization"}),c.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[c.jsx("p",{children:"Once you delete your organization, there is no going back. Please be certain. This will delete:"}),c.jsxs("ul",{className:"list-disc list-inside mt-2",children:[c.jsx("li",{children:"All workers and their data"}),c.jsx("li",{children:"All tasks and financial records"}),c.jsx("li",{children:"All projects and rates"}),c.jsx("li",{children:"All uploaded files and images"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx("button",{type:"button",onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Organization"})})]})]})})}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(qA,{className:"h-5 w-5 text-red-400"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Delete Account"}),c.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[c.jsx("p",{children:"Permanently delete your account and all associated data. This action cannot be undone. This will:"}),c.jsxs("ul",{className:"list-disc list-inside mt-2",children:[c.jsx("li",{children:"Delete your user account"}),c.jsx("li",{children:"Delete your organization"}),c.jsx("li",{children:"Remove all workers and their data"}),c.jsx("li",{children:"Remove all tasks and financial records"}),c.jsx("li",{children:"Delete all uploaded files"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx("button",{type:"button",onClick:async()=>{if(await l({title:"Delete Account",message:"Are you absolutely sure you want to delete your account? This action cannot be undone.",type:"danger",confirmText:"Delete Account",cancelText:"Cancel"}))try{await Gt.getState().deleteAccount(),window.location.href="/"}catch(b){console.error("Error deleting account:",b)}},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Account Permanently"})})]})]})})})]})]})}function fR(){var q;const[e,t]=me.useState([]),[r,n]=me.useState(!0),[i,s]=me.useState(""),[a,o]=me.useState(null),[l,u]=me.useState(!1),[f,m]=me.useState({title:"",value:"",type:"text",file:null}),[p,h]=me.useState({name:"",phone:"",address:"",date_of_birth:"",customFields:[{title:"",value:"",type:"text",file:null}]}),[v,g]=me.useState(!1),{organization:b}=Gt(),{confirm:y,addToast:w}=vn(),_=b!=null&&b.currency?((q=$r[b.currency])==null?void 0:q.symbol)||b.currency:"";me.useEffect(()=>{b&&j()},[b]);const j=async()=>{if(b!=null&&b.id)try{const{data:z,error:ne}=await $e.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*),
          orders:orders(outstanding_balance)
        `).eq("organization_id",b.id).order("name");if(ne)throw ne;const U=(z==null?void 0:z.map(G=>{var B;return{...G,total_balance:((B=G.orders)==null?void 0:B.reduce((Y,re)=>Y+(re.outstanding_balance||0),0))||0}}))||[];t(U)}catch(z){console.error("Error loading clients:",z),w({type:"error",title:"Error",message:"Failed to load clients"})}finally{n(!1)}},O=async()=>{var z;if(!(!b||!p.name.trim())){g(!0);try{const{data:ne,error:U}=await $e.from("clients").insert([{organization_id:b.id,name:p.name.trim(),phone:p.phone.trim(),address:p.address.trim(),date_of_birth:p.date_of_birth||null}]).select().single();if(U)throw U;const G=p.customFields.filter(B=>B.title.trim()&&(B.type==="text"?B.value.trim():B.file));if(G.length>0)for(const B of G){let Y=B.value;if(B.type==="file"&&B.file){const he=(z=B.file.name.split(".").pop())==null?void 0:z.toLowerCase(),k=`${Math.random().toString(36).substring(2)}.${he}`,I=`${b.id}/clients/${ne.id}/${k}`,{error:M}=await $e.storage.from("profiles").upload(I,B.file,{cacheControl:"3600",upsert:!1});if(M)throw M;const{data:{publicUrl:D}}=$e.storage.from("profiles").getPublicUrl(I);Y=D}const{error:re}=await $e.from("client_custom_fields").insert({client_id:ne.id,title:B.title.trim(),value:Y,type:B.type});if(re)throw re}await j(),h({name:"",phone:"",address:"",date_of_birth:"",customFields:[{title:"",value:"",type:"text",file:null}]}),u(!1),w({type:"success",title:"Client Added",message:"New client has been added successfully."})}catch(ne){console.error("Error adding client:",ne),w({type:"error",title:"Error",message:"Failed to add client"})}finally{g(!1)}}},L=async z=>{if(await y({title:"Delete Client",message:"Are you sure you want to delete this client? This will also delete all their custom information.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:U}=await $e.from("clients").delete().eq("id",z);if(U)throw U;t(G=>G.filter(B=>B.id!==z)),w({type:"success",title:"Client Deleted",message:"Client has been deleted successfully."})}catch(U){console.error("Error deleting client:",U),w({type:"error",title:"Error",message:"Failed to delete client"})}},E=async(z,ne,U,G="text")=>{try{const{data:B,error:Y}=await $e.from("client_custom_fields").insert([{client_id:z,title:ne.trim(),value:U.trim(),type:G}]).select().single();if(Y)throw Y;t(re=>re.map(he=>he.id===z?{...he,custom_fields:[...he.custom_fields||[],B]}:he)),w({type:"success",title:"Field Added",message:"Custom field has been added successfully."})}catch(B){console.error("Error adding custom field:",B),w({type:"error",title:"Error",message:"Failed to add custom field"})}},C=async(z,ne)=>{try{const{error:U}=await $e.from("client_custom_fields").delete().eq("id",ne);if(U)throw U;t(G=>G.map(B=>{var Y;return B.id===z?{...B,custom_fields:(Y=B.custom_fields)==null?void 0:Y.filter(re=>re.id!==ne)}:B})),w({type:"success",title:"Field Deleted",message:"Custom field has been deleted successfully."})}catch(U){console.error("Error deleting custom field:",U),w({type:"error",title:"Error",message:"Failed to delete custom field"})}},P=()=>{h(z=>({...z,customFields:[...z.customFields,{title:"",value:"",type:"text",file:null}]}))},R=z=>{h(ne=>({...ne,customFields:ne.customFields.filter((U,G)=>G!==z)}))},T=(z,ne)=>{h(U=>({...U,customFields:U.customFields.map((G,B)=>B===z?{...G,...ne}:G)}))};if(r)return c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const A=e.filter(z=>{var ne,U;return z.name.toLowerCase().includes(i.toLowerCase())||((ne=z.phone)==null?void 0:ne.toLowerCase().includes(i.toLowerCase()))||((U=z.address)==null?void 0:U.toLowerCase().includes(i.toLowerCase()))});return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Clients"}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Client"]})]}),l&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Client"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),c.jsx("input",{type:"text",value:p.name,onChange:z=>h(ne=>({...ne,name:z.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter client name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),c.jsx("input",{type:"tel",value:p.phone,onChange:z=>h(ne=>({...ne,phone:z.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter phone number"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),c.jsx("textarea",{value:p.address,onChange:z=>h(ne=>({...ne,address:z.target.value})),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter address"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),c.jsx("input",{type:"date",value:p.date_of_birth,onChange:z=>h(ne=>({...ne,date_of_birth:z.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Custom Information"}),c.jsxs("button",{type:"button",onClick:P,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:[c.jsx(mn,{className:"h-4 w-4 mr-1"}),"Add Field"]})]}),p.customFields.map((z,ne)=>c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex-1 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),c.jsx("input",{type:"text",value:z.title,onChange:U=>T(ne,{title:U.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),c.jsxs("select",{value:z.type,onChange:U=>T(ne,{type:U.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"text",children:"Text"}),c.jsx("option",{value:"file",children:"File"})]})]}),z.type==="text"?c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),c.jsx("input",{type:"text",value:z.value||"",onChange:U=>T(ne,{value:U.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),c.jsxs("div",{className:"mt-1 flex items-center",children:[c.jsx("input",{type:"file",onChange:U=>{var B;const G=(B=U.target.files)==null?void 0:B[0];G&&T(ne,{file:G})},className:"hidden",id:`file-${ne}`}),c.jsxs("label",{htmlFor:`file-${ne}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(cd,{className:"h-4 w-4 mr-2"}),"Choose File"]}),z.file&&c.jsx("span",{className:"ml-3 text-sm text-gray-500",children:z.file.name})]})]})]}),c.jsx("button",{type:"button",onClick:()=>R(ne),className:"mt-8 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:c.jsx(is,{className:"h-5 w-5"})})]},ne))]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:O,disabled:!p.name.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:v?c.jsxs(c.Fragment,{children:[c.jsx(kl,{className:"animate-spin h-4 w-4 mr-2"}),"Adding..."]}):"Add Client"})]})]})]}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsx("div",{className:"p-4 border-b",children:c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Ed,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:z=>s(z.target.value),placeholder:"Search clients...",className:"ml-2 flex-1 outline-none bg-transparent"})]})}),c.jsx("div",{className:"overflow-x-auto",children:A.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:i?"No clients found matching your search.":"No clients added yet."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date of Birth"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Custom Information"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(z=>{var ne;return c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a===z.id?c.jsx("input",{type:"text",value:z.name,onChange:U=>t(G=>G.map(B=>B.id===z.id?{...B,name:U.target.value}:B)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):c.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.name})}),c.jsx("td",{className:"px-6 py-4",children:a===z.id?c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"tel",value:z.phone||"",onChange:U=>t(G=>G.map(B=>B.id===z.id?{...B,phone:U.target.value}:B)),placeholder:"Phone",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),c.jsx("textarea",{value:z.address||"",onChange:U=>t(G=>G.map(B=>B.id===z.id?{...B,address:U.target.value}:B)),placeholder:"Address",rows:2,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}):c.jsxs("div",{className:"text-sm text-gray-500",children:[z.phone&&c.jsxs("div",{className:"flex items-center",children:[c.jsx(rx,{className:"h-4 w-4 mr-1"}),z.phone]}),z.address&&c.jsxs("div",{className:"flex items-center mt-1",children:[c.jsx(tx,{className:"h-4 w-4 mr-1"}),z.address]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a===z.id?c.jsx("input",{type:"date",value:z.date_of_birth||"",onChange:U=>t(G=>G.map(B=>B.id===z.id?{...B,date_of_birth:U.target.value}:B)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):z.date_of_birth?c.jsx("div",{className:"text-sm text-gray-500",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Fl,{className:"h-4 w-4 mr-1"}),Mt(new Date(z.date_of_birth),"MMM d, yyyy")]})}):null}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"text-sm text-gray-900",children:[(ne=z.custom_fields)==null?void 0:ne.map((U,G)=>c.jsxs("div",{className:"flex items-center justify-between mb-2 bg-gray-50 p-2 rounded",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("span",{className:"font-medium",children:[U.title,": "]}),U.type==="file"?c.jsx("a",{href:U.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"View File"}):c.jsx("span",{children:U.value})]}),c.jsx("button",{onClick:()=>C(z.id,U.id),className:"ml-2 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:c.jsx(Es,{className:"h-4 w-4"})})]},U.id)),a===z.id&&c.jsxs("div",{className:"mt-4 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Custom Information"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),c.jsxs("select",{value:f.type,onChange:U=>m(G=>({...G,type:U.target.value,value:"",file:null})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"text",children:"Text"}),c.jsx("option",{value:"file",children:"File"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),c.jsx("input",{type:"text",value:f.title,onChange:U=>m(G=>({...G,title:U.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),f.type==="text"?c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),c.jsx("input",{type:"text",value:f.value||"",onChange:U=>m(G=>({...G,value:U.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),c.jsxs("div",{className:"mt-1 flex items-center",children:[c.jsx("input",{type:"file",onChange:U=>{var B;const G=(B=U.target.files)==null?void 0:B[0];G&&m(Y=>({...Y,file:G}))},className:"hidden",id:`custom-file-${z.id}`}),c.jsxs("label",{htmlFor:`custom-file-${z.id}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(cd,{className:"h-4 w-4 mr-2"}),"Choose File"]}),f.file&&c.jsx("span",{className:"ml-3 text-sm text-gray-500",children:f.file.name})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>m({title:"",value:"",type:"text",file:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Clear"}),c.jsx("button",{onClick:()=>{f.title&&(f.value||f.file)&&(E(z.id,f.title,f.value||"",f.type),m({title:"",value:"",type:"text",file:null}))},disabled:!f.title||!f.value&&!f.file,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Field"})]})]})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("span",{className:`text-sm font-medium ${z.total_balance>0?"text-red-600":"text-green-600"}`,children:[_," ",z.total_balance.toFixed(2)]}),c.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:"Outstanding"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Fr,{to:`/clients/${z.id}`,className:"text-blue-600 hover:text-blue-800",children:c.jsx(UA,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>L(z.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},z.id)})})]})})]})]})}function dR(){var m;const{organization:e}=Gt(),[t,r]=me.useState(new Date),[n,i]=me.useState([]),[s,a]=me.useState(!0),o=((m=$r[e.currency])==null?void 0:m.symbol)||e.currency;me.useEffect(()=>{if(!e)return;(async()=>{a(!0);try{const h=Di(t,{weekStartsOn:1}),v=_o(t,{weekStartsOn:1}),{data:g,error:b}=await $e.from("tasks").select(`
            *,
            deductions (
              amount
            )
          `).eq("organization_id",e.id).gte("date",h.toISOString()).lte("date",v.toISOString());if(b)throw b;const y=(g||[]).reduce((_,j)=>{var E;const O=j.date;_[O]||(_[O]={date:O,totalTasks:0,totalAmount:0,totalDeductions:0,netAmount:0});const L=((E=j.deductions)==null?void 0:E.reduce((C,P)=>C+(P.amount||0),0))||0;return _[O].totalTasks+=1,_[O].totalAmount+=j.amount,_[O].totalDeductions+=L,_[O].netAmount+=j.amount-L,_},{}),w=Object.values(y).sort((_,j)=>new Date(_.date).getTime()-new Date(j.date).getTime());i(w)}catch(h){console.error("Error loading financial data:",h)}finally{a(!1)}})()},[e,t]);const l=p=>{r(h=>p==="prev"?aC(h):p_(h,1))},u=p=>{const h=Di(t,{weekStartsOn:1}),v=_o(t,{weekStartsOn:1}),{workbook:g,pdf:b}=nR(n,{start:h,end:v},e.currency),y=`financial_report_${Mt(t,"yyyy-MM-dd")}`;p==="excel"?$I(g,`${y}.xlsx`):b.save(`${y}.pdf`)},f=n.reduce((p,h)=>({tasks:p.tasks+h.totalTasks,amount:p.amount+h.totalAmount,deductions:p.deductions+h.totalDeductions,net:p.net+h.netAmount}),{tasks:0,amount:0,deductions:0,net:0});return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Financial Dashboard"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{onClick:()=>u("excel"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(Fg,{className:"h-4 w-4 mr-2"}),"Export to Excel"]}),c.jsxs("button",{onClick:()=>u("pdf"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700",children:[c.jsx(Fg,{className:"h-4 w-4 mr-2"}),"Export to PDF"]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>l("prev"),className:"p-2 hover:bg-gray-100 rounded-full",children:c.jsx(Cm,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Fl,{className:"h-5 w-5 text-gray-600"}),c.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[Mt(Di(t,{weekStartsOn:1}),"MMM d, yyyy")," - "," ",Mt(_o(t,{weekStartsOn:1}),"MMM d, yyyy")]})]}),c.jsx("button",{onClick:()=>l("next"),className:"p-2 hover:bg-gray-100 rounded-full",children:c.jsx(Pm,{className:"h-5 w-5 text-gray-600"})})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Tasks"}),c.jsx("p",{className:"mt-2 text-3xl font-bold text-blue-900",children:f.tasks})]}),c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Amount"}),c.jsxs("p",{className:"mt-2 text-3xl font-bold text-green-900",children:[o," ",f.amount.toFixed(2)]})]}),c.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-red-600",children:"Total Deductions"}),c.jsxs("p",{className:"mt-2 text-3xl font-bold text-red-900",children:[o," ",f.deductions.toFixed(2)]})]}),c.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Net Amount"}),c.jsxs("p",{className:"mt-2 text-3xl font-bold text-purple-900",children:[o," ",f.net.toFixed(2)]})]})]}),s?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.length===0?c.jsx("div",{className:"text-center py-12",children:c.jsx("p",{className:"text-gray-500",children:"No financial data available for this week."})}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tasks"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deductions"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Amount"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(p=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Mt(new Date(p.date),"MMM d, yyyy")}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.totalTasks}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[o," ",p.totalAmount.toFixed(2)]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:[o," ",p.totalDeductions.toFixed(2)]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:[o," ",p.netAmount.toFixed(2)]})]},p.date))})]})})]})})]})}function hR(){var w;const[e,t]=me.useState([]),[r,n]=me.useState(!0),[i,s]=me.useState(!1),[a,o]=me.useState(null),[l,u]=me.useState({name:"",cost:0}),{organization:f}=Gt(),{confirm:m,addToast:p}=vn(),h=((w=$r[f.currency])==null?void 0:w.symbol)||f.currency;me.useEffect(()=>{f&&v()},[f]);const v=async()=>{try{const{data:_,error:j}=await $e.from("services").select("*").eq("organization_id",f.id).order("name");if(j)throw j;t(_||[])}catch(_){console.error("Error loading services:",_),p({type:"error",title:"Error",message:"Failed to load services"})}finally{n(!1)}},g=async()=>{if(!(!f||!l.name.trim()||!l.cost))try{const{data:_,error:j}=await $e.from("services").insert([{organization_id:f.id,name:l.name.trim(),cost:l.cost}]).select().single();if(j)throw j;t(O=>[...O,_]),u({name:"",cost:0}),s(!1),p({type:"success",title:"Service Added",message:"The service has been added successfully."})}catch(_){console.error("Error adding service:",_),p({type:"error",title:"Error",message:"Failed to add service. Please try again."})}},b=async _=>{const j=e.find(O=>O.id===_);if(j)try{const{error:O}=await $e.from("services").update({name:j.name,cost:j.cost}).eq("id",_);if(O)throw O;o(null),p({type:"success",title:"Service Updated",message:"The service has been updated successfully."})}catch(O){console.error("Error updating service:",O),p({type:"error",title:"Error",message:"Failed to update service. Please try again."})}},y=async _=>{if(await m({title:"Delete Service",message:"Are you sure you want to delete this service? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:O}=await $e.from("services").delete().eq("id",_);if(O)throw O;t(L=>L.filter(E=>E.id!==_)),p({type:"success",title:"Service Deleted",message:"The service has been deleted successfully."})}catch(O){console.error("Error deleting service:",O),p({type:"error",title:"Error",message:"Failed to delete service. Please try again."})}};return r?c.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Services"}),c.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Service"]})]}),i&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Service"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Name *"}),c.jsx("input",{type:"text",value:l.name,onChange:_=>u(j=>({...j,name:_.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter service name"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Cost (",h,") *"]}),c.jsx("input",{type:"number",value:l.cost||"",onChange:_=>u(j=>({...j,cost:parseFloat(_.target.value)||0})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01",placeholder:"Enter service cost"})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{onClick:()=>s(!1),className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:g,disabled:!l.name.trim()||!l.cost,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Service"]})]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No services added yet. Start by adding a new service."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Service Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(_=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===_.id?c.jsx("input",{type:"text",value:_.name,onChange:j=>t(O=>O.map(L=>L.id===_.id?{...L,name:j.target.value}:L)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):_.name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===_.id?c.jsx("input",{type:"number",value:_.cost,onChange:j=>t(O=>O.map(L=>L.id===_.id?{...L,cost:parseFloat(j.target.value)||0}:L)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01"}):`${h} ${_.cost.toFixed(2)}`}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a===_.id?c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>b(_.id),className:"text-green-600 hover:text-green-900",children:"Save"}),c.jsx("button",{onClick:()=>{o(null),v()},className:"text-gray-600 hover:text-gray-900",children:"Cancel"})]}):c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>o(_.id),className:"text-blue-600 hover:text-blue-900",children:c.jsx(mu,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>y(_.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},_.id))})]})})]})}const tw={raw_material:"Raw Material",finished_good:"Finished Good",packaging:"Packaging",other:"Other"},T1={unpaid:"Unpaid",partially_paid:"Partially Paid",paid:"Paid"},n0={unpaid:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"},partially_paid:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},paid:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"}},rw={raw_material:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},finished_good:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},packaging:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},other:{bg:"bg-gray-100",text:"text-gray-800",hover:"hover:bg-gray-200"}};function mR({onClose:e,onSuccess:t}){const{organization:r}=Gt(),{addToast:n}=vn(),[i,s]=me.useState(!1),[a,o]=me.useState({name:"",sku:"",category:"finished_good",description:"",unit_price:"",stock_quantity:"",reorder_point:""}),l=async u=>{if(u.preventDefault(),!r)return;const f=parseFloat(a.unit_price),m=parseInt(a.stock_quantity),p=parseInt(a.reorder_point);if(isNaN(f)||f<0){n({type:"error",title:"Invalid Price",message:"Please enter a valid unit price"});return}if(isNaN(m)||m<0){n({type:"error",title:"Invalid Quantity",message:"Please enter a valid stock quantity"});return}if(isNaN(p)||p<0){n({type:"error",title:"Invalid Reorder Point",message:"Please enter a valid reorder point"});return}s(!0);try{const{error:h}=await $e.from("products").insert([{organization_id:r.id,name:a.name.trim(),sku:a.sku.trim(),category:a.category,description:a.description.trim()||null,unit_price:f,stock_quantity:m,reorder_point:p}]);if(h)throw h;n({type:"success",title:"Product Created",message:"Product has been created successfully"}),t(),e()}catch(h){console.error("Error creating product:",h),n({type:"error",title:"Error",message:"Failed to create product"})}finally{s(!1)}};return c.jsxs("form",{onSubmit:l,className:"p-6 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Product"}),c.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-500",children:c.jsx(Es,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),c.jsx("input",{type:"text",required:!0,value:a.name,onChange:u=>o(f=>({...f,name:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SKU *"}),c.jsx("input",{type:"text",required:!0,value:a.sku,onChange:u=>o(f=>({...f,sku:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category *"}),c.jsxs("select",{required:!0,value:a.category,onChange:u=>o(f=>({...f,category:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"raw_material",children:"Raw Material"}),c.jsx("option",{value:"finished_good",children:"Finished Good"}),c.jsx("option",{value:"packaging",children:"Packaging"}),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),c.jsx("textarea",{value:a.description,onChange:u=>o(f=>({...f,description:u.target.value})),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Price *"}),c.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:a.unit_price,onChange:u=>o(f=>({...f,unit_price:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity *"}),c.jsx("input",{type:"number",required:!0,min:"0",step:"1",value:a.stock_quantity,onChange:u=>o(f=>({...f,stock_quantity:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reorder Point *"}),c.jsx("input",{type:"number",required:!0,min:"0",step:"1",value:a.reorder_point,onChange:u=>o(f=>({...f,reorder_point:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:i?c.jsxs(c.Fragment,{children:[c.jsx(kl,{className:"animate-spin h-4 w-4 mr-2"}),"Creating..."]}):"Create Product"})]})]})}function pR(){var y;const[e,t]=me.useState([]),[r,n]=me.useState(!0),[i,s]=me.useState(""),[a,o]=me.useState("all"),[l,u]=me.useState(!1),{organization:f}=Gt(),{confirm:m,addToast:p}=vn(),h=f!=null&&f.currency?((y=$r[f.currency])==null?void 0:y.symbol)||f.currency:"";me.useEffect(()=>{f&&v()},[f]);const v=async()=>{if(f!=null&&f.id)try{const{data:w,error:_}=await $e.from("products").select("*").eq("organization_id",f.id).order("name");if(_)throw _;t(w||[])}catch(w){console.error("Error loading products:",w),p({type:"error",title:"Error",message:"Failed to load products"})}finally{n(!1)}},g=async w=>{if(await m({title:"Delete Product",message:"Are you sure you want to delete this product? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:j}=await $e.from("products").delete().eq("id",w);if(j)throw j;t(O=>O.filter(L=>L.id!==w)),p({type:"success",title:"Product Deleted",message:"Product has been deleted successfully."})}catch(j){console.error("Error deleting product:",j),p({type:"error",title:"Error",message:"Failed to delete product"})}},b=e.filter(w=>{var _;return(a==="all"||w.category===a)&&(w.name.toLowerCase().includes(i.toLowerCase())||((_=w.description)==null?void 0:_.toLowerCase().includes(i.toLowerCase())))});return r?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Products"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your inventory"})]}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Product"]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"Search products...",className:"block w-full rounded-lg border border-gray-300 py-2 pl-10 pr-3 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"}),c.jsx(Ed,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"})]}),c.jsxs("select",{value:a,onChange:w=>o(w.target.value),className:"block w-full sm:w-48 rounded-lg border border-gray-300 py-2 pl-3 pr-10 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[c.jsx("option",{value:"all",children:"All Categories"}),Object.entries(tw).map(([w,_])=>c.jsx("option",{value:w,children:_},w))]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:b.length===0?c.jsx("div",{className:"p-6 text-center text-gray-500",children:"No products found."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),c.jsx("th",{scope:"col",className:"relative px-6 py-3",children:c.jsx("span",{className:"sr-only",children:"Actions"})})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(w=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center",children:c.jsx(Qs,{className:"h-6 w-6 text-gray-400"})}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name}),w.description&&c.jsx("div",{className:"text-sm text-gray-500",children:w.description})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${rw[w.category].bg} ${rw[w.category].text}`,children:tw[w.category]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w.sku}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h," ",w.unit_price.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:`text-sm font-medium ${w.stock_quantity<=w.reorder_point?"text-red-600":"text-gray-900"}`,children:w.stock_quantity}),w.stock_quantity<=w.reorder_point&&c.jsx("span",{className:"text-xs text-red-500 ml-2",children:"Low stock"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>{},className:"text-blue-600 hover:text-blue-900",children:c.jsx(mu,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>g(w.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},w.id))})]})}),l&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:c.jsx(mR,{onClose:()=>u(!1),onSuccess:v})})]})})]})}function gR({onClose:e,onSuccess:t}){var ne;const[r,n]=me.useState(!1),[i,s]=me.useState([]),[a,o]=me.useState([]),[l,u]=me.useState(""),[f,m]=me.useState([]),[p,h]=me.useState({name:"",quantity:1,unit_price:0}),[v,g]=me.useState(""),{organization:b}=Gt(),{addToast:y}=vn(),w=b!=null&&b.currency?((ne=$r[b.currency])==null?void 0:ne.symbol)||b.currency:"",[_,j]=me.useState(!0),[O,L]=me.useState(!0);me.useEffect(()=>{b&&(E(),C())},[b]);const E=async()=>{if(b!=null&&b.id)try{const{data:U,error:G}=await $e.from("clients").select("*").eq("organization_id",b.id).order("name");if(G)throw G;s(U||[])}catch(U){console.error("Error loading clients:",U),y({type:"error",title:"Error",message:"Failed to load clients"})}finally{j(!1)}},C=async()=>{if(b!=null&&b.id)try{const{data:U,error:G}=await $e.from("products").select("*").eq("organization_id",b.id).order("name");if(G)throw G;o(U||[])}catch(U){console.error("Error loading products:",U),y({type:"error",title:"Error",message:"Failed to load products"})}finally{L(!1)}},P=U=>{const G=a.find(Y=>Y.id===U);if(!G)return;if(G.stock_quantity<=0){y({type:"error",title:"Error",message:"This product is out of stock"});return}const B=f.find(Y=>Y.product_id===U);if(B){if(B.quantity>=G.stock_quantity){y({type:"error",title:"Error",message:"Not enough stock available"});return}m(Y=>Y.map(re=>re.product_id===U?{...re,quantity:re.quantity+1,total_price:(re.quantity+1)*re.unit_price}:re))}else m(Y=>[...Y,{product_id:G.id,name:G.name,quantity:1,unit_price:G.unit_price,total_price:G.unit_price,is_custom_item:!1,product:G}])},R=()=>{!p.name.trim()||p.quantity<=0||p.unit_price<=0||(m(U=>[...U,{product_id:null,name:p.name.trim(),quantity:p.quantity,unit_price:p.unit_price,total_price:p.quantity*p.unit_price,is_custom_item:!0}]),h({name:"",quantity:1,unit_price:0}))},T=U=>{m(G=>G.filter((B,Y)=>Y!==U))},A=(U,G)=>{const B=f[U];if(B){if(!B.is_custom_item&&B.product&&G>B.product.stock_quantity){y({type:"error",title:"Error",message:"Not enough stock available"});return}if(G<=0){T(U);return}m(Y=>Y.map((re,he)=>he===U?{...re,quantity:G,total_price:G*re.unit_price}:re))}},q=()=>f.reduce((U,G)=>U+G.total_price,0),z=async U=>{if(U.preventDefault(),!(!b||!l||f.length===0)){n(!0);try{const{data:G,error:B}=await $e.from("sales_orders").insert([{organization_id:b.id,client_id:l,total_amount:q(),outstanding_balance:q(),notes:v.trim()||null}]).select().single();if(B)throw B;const{error:Y}=await $e.from("sales_order_items").insert(f.map(re=>({sales_order_id:G.id,product_id:re.product_id,name:re.name,quantity:re.quantity,unit_price:re.unit_price,total_price:re.total_price,is_custom_item:re.is_custom_item})));if(Y)throw Y;y({type:"success",title:"Order Created",message:"Sales order has been created successfully."}),t(),e()}catch(G){console.error("Error creating order:",G),y({type:"error",title:"Error",message:"Failed to create order"})}finally{n(!1)}}};return _||O?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("form",{onSubmit:z,className:"p-6 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Sales Order"}),c.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-500",children:c.jsx(Es,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client *"}),c.jsxs("select",{required:!0,value:l,onChange:U=>u(U.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a client"}),i.map(U=>c.jsx("option",{value:U.id,children:U.name},U.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Products"}),c.jsxs("select",{value:"",onChange:U=>P(U.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a product"}),a.map(U=>c.jsxs("option",{value:U.id,disabled:U.stock_quantity<=0,children:[U.name," - ",w,U.unit_price.toFixed(2)," (",U.stock_quantity," in stock)"]},U.id))]})]}),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Custom Item Name"}),c.jsx("input",{type:"text",value:p.name,onChange:U=>h(G=>({...G,name:U.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter item name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),c.jsx("input",{type:"number",min:"1",value:p.quantity,onChange:U=>h(G=>({...G,quantity:parseInt(U.target.value)||1})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Price"}),c.jsx("input",{type:"number",min:"0",step:"0.01",value:p.unit_price,onChange:U=>h(G=>({...G,unit_price:parseFloat(U.target.value)||0})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"0.00"})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{type:"button",onClick:R,disabled:!p.name.trim()||p.quantity<=0||p.unit_price<=0,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Custom Item"]})})]}),c.jsx("div",{className:"border rounded-lg overflow-hidden",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[f.map((U,G)=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Qs,{className:"h-5 w-5 text-gray-400 mr-2"}),c.jsx("div",{className:"text-sm text-gray-900",children:U.name})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{type:"button",onClick:()=>A(G,U.quantity-1),className:"p-1 rounded-full hover:bg-gray-100",children:c.jsx(l_,{className:"h-4 w-4 text-gray-500"})}),c.jsx("span",{className:"text-sm text-gray-900",children:U.quantity}),c.jsx("button",{type:"button",onClick:()=>A(G,U.quantity+1),className:"p-1 rounded-full hover:bg-gray-100",disabled:!U.is_custom_item&&U.product&&U.quantity>=U.product.stock_quantity,children:c.jsx(mn,{className:"h-4 w-4 text-gray-500"})})]})}),c.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[w," ",U.unit_price.toFixed(2)]}),c.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[w," ",U.total_price.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsx("button",{type:"button",onClick:()=>T(G),className:"text-red-600 hover:text-red-900",children:c.jsx(Es,{className:"h-4 w-4"})})})]},G)),f.length>0&&c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("td",{colSpan:3,className:"px-6 py-4 text-sm font-medium text-gray-900 text-right",children:"Total Amount:"}),c.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:[w," ",q().toFixed(2)]}),c.jsx("td",{})]})]})]})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),c.jsx("textarea",{value:v,onChange:U=>g(U.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Add any notes about this order"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:r||!l||f.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:r?c.jsxs(c.Fragment,{children:[c.jsx(kl,{className:"animate-spin h-4 w-4 mr-2"}),"Creating..."]}):"Create Sale"})]})]})}function xR(){var O;const[e,t]=me.useState([]),[r,n]=me.useState(!0),[i,s]=me.useState(""),[a,o]=me.useState("all"),[l,u]=me.useState(!1),[f,m]=me.useState(null),[p,h]=me.useState(!1),{organization:v}=Gt(),{confirm:g,addToast:b}=vn(),y=v!=null&&v.currency?((O=$r[v.currency])==null?void 0:O.symbol)||v.currency:"";me.useEffect(()=>{v&&w()},[v]);const w=async()=>{if(v!=null&&v.id)try{const{data:L,error:E}=await $e.from("sales_orders").select(`
          *,
          client:clients(name),
          items:sales_order_items(
            id,
            product_id,
            name,
            quantity,
            unit_price,
            total_price,
            is_custom_item,
            product:products(*)
          ),
          payments:payments(
            id,
            amount,
            payment_method,
            transaction_reference,
            created_at,
            recorded_by
          )
        `).eq("organization_id",v.id).order("created_at",{ascending:!1});if(E)throw E;t(L||[])}catch(L){console.error("Error loading orders:",L),b({type:"error",title:"Error",message:"Failed to load orders"})}finally{n(!1)}},_=async L=>{if(await g({title:"Delete Order",message:"Are you sure you want to delete this order? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:C}=await $e.from("sales_orders").delete().eq("id",L);if(C)throw C;t(P=>P.filter(R=>R.id!==L)),b({type:"success",title:"Order Deleted",message:"Order has been deleted successfully."})}catch(C){console.error("Error deleting order:",C),b({type:"error",title:"Error",message:"Failed to delete order"})}},j=e.filter(L=>{var E,C;return(a==="all"||L.payment_status===a)&&(((E=L.order_number)==null?void 0:E.toLowerCase().includes(i.toLowerCase()))||((C=L.client)==null?void 0:C.name.toLowerCase().includes(i.toLowerCase())))});return r?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Sales Orders"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your sales orders and payments"})]}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[c.jsx(mn,{className:"h-4 w-4 mr-2"}),"Create Sale"]})]}),l&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl",children:c.jsx(gR,{onClose:()=>u(!1),onSuccess:w})})]})}),p&&f&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>{h(!1),m(null)}}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:c.jsx("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:c.jsx("div",{className:"sm:flex sm:items-start",children:c.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:"Record Payment"}),c.jsxs("button",{onClick:()=>{h(!1),m(null)},className:"text-gray-400 hover:text-gray-500",children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]})]}),c.jsx(v_,{orderId:f.id,outstandingBalance:f.outstanding_balance,onPaymentRecorded:()=>{h(!1),m(null),w()},onCancel:()=>{h(!1),m(null)}})]})})})})]})}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50"}`,children:"All Orders"}),Object.entries(T1).map(([L,E])=>c.jsx("button",{onClick:()=>o(L),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a===L?`${n0[L].bg} ${n0[L].text}`:"text-gray-500 hover:bg-gray-50"}`,children:E},L))]}),c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Ed,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:L=>s(L.target.value),placeholder:"Search orders...",className:"ml-2 flex-1 outline-none bg-transparent"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:j.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:i||a!=="all"?"No orders found matching your search.":"No orders created yet. Start by creating a new order."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Number"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(L=>{var E,C;return c.jsxs("tr",{children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:L.order_number}),c.jsx("div",{className:"text-xs text-gray-500",children:Mt(new Date(L.created_at),"MMM d, yyyy")})]}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400 mr-2"}),c.jsx("div",{className:"text-sm font-medium text-gray-900",children:(E=L.client)==null?void 0:E.name})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"flex flex-col space-y-1",children:(C=L.items)==null?void 0:C.map(P=>c.jsxs("div",{className:"flex items-center text-sm",children:[c.jsx(Qs,{className:"h-4 w-4 text-gray-400 mr-2"}),c.jsx("span",{className:"text-gray-900",children:P.name}),c.jsxs("span",{className:"text-gray-500 ml-2",children:["× ",P.quantity]})]},P.id))})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[y," ",L.total_amount.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("span",{className:`text-sm font-medium ${L.payment_status==="paid"?"text-green-600":L.payment_status==="partially_paid"?"text-orange-600":"text-red-600"}`,children:[y," ",L.outstanding_balance.toFixed(2)]}),c.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:T1[L.payment_status]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${n0[L.payment_status].bg} ${n0[L.payment_status].text}`,children:T1[L.payment_status]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[L.payment_status!=="paid"&&c.jsx("button",{onClick:()=>{m(L),h(!0)},className:"text-green-600 hover:text-green-900",children:c.jsx(s_,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>{},className:"text-blue-600 hover:text-blue-900",children:c.jsx(mu,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>_(L.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},L.id)})})]})})]})]})}function vR(){const{user:e,organization:t}=Gt(),r=fu(),n=uu();if(!(t&&t.country&&t.city&&t.address&&t.employee_count&&t.currency))return c.jsx(dl,{to:"/organization-setup"});if(!e||!t)return null;const s=async()=>{try{await Gt.getState().signOut(),r("/signin")}catch(o){console.error("Error signing out:",o)}},a=[{name:"Overview",path:"/dashboard",icon:Eo},{name:"Workers",path:"/dashboard/workers",icon:nu},{name:"Clients",path:"/dashboard/clients",icon:c_},{name:"Orders",path:"/dashboard/orders",icon:nx},{name:"Tasks",path:"/dashboard/tasks",icon:Dc},{name:"Inventory",path:"/dashboard/inventory",icon:Qs},{name:"Sales",path:"/dashboard/sales",icon:jo},{name:"Settings",path:"/dashboard/settings",icon:WA}];return c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("header",{className:"bg-white shadow-sm",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Eo,{className:"h-8 w-8 text-blue-600"}),c.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:t.name})]}),c.jsxs("button",{onClick:s,className:"ml-4 inline-flex items-center px-3 py-1.5 text-sm text-gray-700 hover:text-gray-900",children:[c.jsx(MA,{className:"h-4 w-4 mr-1"}),"Sign out"]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:c.jsx("nav",{className:"flex items-center justify-center space-x-1 bg-white shadow-sm rounded-lg p-1",children:a.map(o=>{const l=n.pathname===o.path;return c.jsxs(Fr,{to:o.path,className:`px-4 py-2 text-sm font-medium rounded-md flex items-center ${l?"text-blue-700 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:[c.jsx(o.icon,{className:`h-5 w-5 mr-2 ${l?"text-blue-700":"text-gray-400"}`}),o.name]},o.name)})})}),c.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:c.jsxs(A4,{children:[c.jsx(br,{index:!0,element:c.jsx(cR,{})}),c.jsx(br,{path:"workers",element:c.jsx(dC,{})}),c.jsx(br,{path:"workers/:id",element:c.jsx(lR,{})}),c.jsx(br,{path:"clients",element:c.jsx(fR,{})}),c.jsx(br,{path:"orders",element:c.jsx(fC,{})}),c.jsx(br,{path:"orders/:id",element:c.jsx(cC,{})}),c.jsx(br,{path:"tasks",element:c.jsx(uf,{status:void 0})}),c.jsx(br,{path:"tasks/pending",element:c.jsx(uf,{status:"pending"})}),c.jsx(br,{path:"tasks/in_progress",element:c.jsx(uf,{status:"in_progress"})}),c.jsx(br,{path:"tasks/delayed",element:c.jsx(uf,{status:"delayed"})}),c.jsx(br,{path:"tasks/completed",element:c.jsx(uf,{status:"completed"})}),c.jsx(br,{path:"inventory",element:c.jsx(pR,{})}),c.jsx(br,{path:"sales",element:c.jsx(xR,{})}),c.jsx(br,{path:"finances",element:c.jsx(dR,{})}),c.jsx(br,{path:"settings",element:c.jsx(uR,{})}),c.jsx(br,{path:"settings/services",element:c.jsx(hR,{})})]})})]})}const yR=[{label:"0-15 employees",value:15},{label:"15-30 employees",value:30},{label:"30-50 employees",value:50},{label:"50-100 employees",value:100},{label:"100-200 employees",value:200},{label:"200+ employees",value:201}],wR=[{code:"GHS",name:"Ghanaian Cedi"},{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"NGN",name:"Nigerian Naira"}],bR=["Ghana","Nigeria","Kenya","South Africa","United States","United Kingdom","Canada"].sort();function _R(){const e=fu(),{organization:t}=Gt(),[r,n]=me.useState(!1),[i,s]=me.useState({country:(t==null?void 0:t.country)||"",city:(t==null?void 0:t.city)||"",address:(t==null?void 0:t.address)||"",employee_count:(t==null?void 0:t.employee_count)||15,currency:(t==null?void 0:t.currency)||"GHS"}),a=async o=>{if(o.preventDefault(),!r){n(!0);try{const{error:l}=await $e.from("organizations").update({country:i.country,city:i.city,address:i.address,employee_count:i.employee_count,currency:i.currency}).eq("id",t.id);if(l)throw l;Gt.setState({organization:{...t,...i}}),e("/dashboard")}catch(l){console.error("Error updating organization:",l),alert("Failed to update organization. Please try again.")}finally{n(!1)}}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex flex-col justify-center py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"max-w-2xl mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"mx-auto h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:c.jsx(Eo,{className:"h-8 w-8 text-blue-600"})}),c.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Complete Your Organization Setup"}),c.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Please provide additional information about your organization"})]}),c.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:c.jsxs("form",{onSubmit:a,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),c.jsxs("select",{id:"country",value:i.country,onChange:o=>s(l=>({...l,country:o.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a country"}),bR.map(o=>c.jsx("option",{value:o,children:o},o))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),c.jsx("input",{type:"text",id:"city",value:i.city,onChange:o=>s(l=>({...l,city:o.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),c.jsx("textarea",{id:"address",value:i.address,onChange:o=>s(l=>({...l,address:o.target.value})),required:!0,rows:3,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"employee_count",className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Employees"}),c.jsx("select",{id:"employee_count",value:i.employee_count,onChange:o=>s(l=>({...l,employee_count:parseInt(o.target.value)})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:yR.map(o=>c.jsx("option",{value:o.value,children:o.label},o.value))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Currency"}),c.jsx("select",{id:"currency",value:i.currency,onChange:o=>s(l=>({...l,currency:o.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:wR.map(o=>c.jsxs("option",{value:o.code,children:[o.code," - ",o.name]},o.code))})]}),c.jsx("div",{children:c.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:r?"Saving...":"Save Organization Details"})})]})})]})})}const SR=[{icon:zA,name:"Fashion & Tailoring",description:"Perfect for fashion houses, tailoring shops, and clothing manufacturers."},{icon:Qs,name:"Service-Based Businesses",description:"Ideal for businesses offering services like cleaning, repairs, or installations."},{icon:nu,name:"Contractors & Freelancers",description:"Great for managing contract workers, freelancers, and project-based teams."},{icon:nx,name:"Retail & Custom Orders",description:"Suitable for retail businesses handling custom orders and made-to-order products."}],NR=[{icon:nu,title:"Workforce Management",description:"Track workers, assign tasks, and manage project rates with WhatsApp integration."},{icon:c_,title:"Client Management",description:"Maintain client profiles with custom fields and track client-specific information."},{icon:Qs,title:"Service Catalog",description:"Define and price your services, create service packages, and track service delivery."},{icon:nx,title:"Order Management",description:"Process client orders, assign workers, and track order fulfillment end-to-end."},{icon:Dc,title:"Task & Project Tracking",description:"Monitor tasks, track progress, and manage project timelines efficiently."},{icon:LA,title:"Detailed Reports",description:"Export financial reports, worker performance, and order analytics in Excel/PDF."},{icon:jo,title:"Financial Controls",description:"Track earnings, manage deductions, and monitor financial performance."},{icon:o_,title:"Communication",description:"Integrated WhatsApp messaging for seamless communication."},{icon:AA,title:"Business Analytics",description:"Get insights into your business performance, worker productivity, and client trends."},{icon:HA,title:"Secure & Reliable",description:"Enterprise-grade security with role-based access control and data protection."}],kR=[{title:"Save Time",description:"Streamline operations and reduce administrative overhead with automated workflows."},{title:"Grow Revenue",description:"Manage more clients, track orders efficiently, and increase business throughput."},{title:"Better Insights",description:"Make data-driven decisions with comprehensive business analytics and reporting."},{title:"Improve Client Satisfaction",description:"Deliver better service with organized client management and order tracking."}];function ER(){return c.jsxs("div",{className:"bg-white",children:[c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-50 transform -skew-y-6 origin-top-left"}),c.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-24 sm:pb-32",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"flex justify-center mb-8",children:c.jsx("div",{className:"h-16 w-16 bg-blue-100 rounded-2xl flex items-center justify-center",children:c.jsx(Eo,{className:"h-10 w-10 text-blue-600"})})}),c.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-extrabold text-gray-900 tracking-tight leading-tight",children:["Sten360: ",c.jsx("span",{className:"text-blue-600",children:"Business Management"})," Platform"]}),c.jsx("p",{className:"mt-6 max-w-2xl mx-auto text-xl text-gray-500",children:"A Sten Business solution for managing your entire operation - from clients and orders to workers and finances - all in one integrated platform. Built for growing organizations that demand efficiency."}),c.jsxs("div",{className:"mt-10 flex justify-center gap-4",children:[c.jsxs(Fr,{to:"/signup",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:["Get Started Free",c.jsx(a1,{className:"ml-2 h-5 w-5"})]}),c.jsx(Fr,{to:"/signin",className:"inline-flex items-center px-6 py-3 border border-gray-300 text-base font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200",children:"Sign In"})]})]})})]}),c.jsx("div",{className:"py-24 bg-gradient-to-br from-gray-50 to-blue-50",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Industries We Serve"}),c.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Our platform is tailored for businesses that rely on skilled workers and custom orders"})]}),c.jsx("div",{className:"mt-20 grid grid-cols-1 gap-8 sm:grid-cols-2",children:SR.map((e,t)=>c.jsx("div",{className:"relative bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"flex-shrink-0 rounded-lg inline-flex p-3 bg-blue-50 text-blue-600",children:c.jsx(e.icon,{className:"h-6 w-6","aria-hidden":"true"})}),c.jsxs("div",{className:"ml-4",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),c.jsx("p",{className:"mt-2 text-base text-gray-500",children:e.description})]})]})},t))})]})}),c.jsx("div",{className:"py-24 bg-white",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Your All-in-One Business Solution"}),c.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Powerful features designed to help you manage and grow your business efficiently"})]}),c.jsx("div",{className:"mt-20 grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3",children:NR.map((e,t)=>c.jsxs("div",{className:"relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-blue-500 rounded-lg hover:shadow-lg transition-shadow duration-200",children:[c.jsx("div",{children:c.jsx("span",{className:"rounded-lg inline-flex p-3 bg-blue-50 text-blue-600 ring-4 ring-white",children:c.jsx(e.icon,{className:"h-6 w-6","aria-hidden":"true"})})}),c.jsxs("div",{className:"mt-8",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.title}),c.jsx("p",{className:"mt-2 text-base text-gray-500",children:e.description})]})]},t))})]})}),c.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 py-24",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Transform Your Business Operations"}),c.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Streamline operations, boost efficiency, and accelerate growth with our integrated platform"})]}),c.jsx("div",{className:"mt-20",children:c.jsx("dl",{className:"space-y-10 md:space-y-0 md:grid md:grid-cols-2 md:gap-x-8 md:gap-y-12",children:kR.map((e,t)=>c.jsxs("div",{className:"relative",children:[c.jsxs("dt",{children:[c.jsx("div",{className:"absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white",children:c.jsx(Ns,{className:"h-6 w-6","aria-hidden":"true"})}),c.jsx("p",{className:"ml-16 text-lg leading-6 font-medium text-gray-900",children:e.title})]}),c.jsx("dd",{className:"mt-2 ml-16 text-base text-gray-500",children:e.description})]},t))})})]})}),c.jsx("div",{className:"py-24 bg-white",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 sm:p-12",children:c.jsxs("div",{className:"max-w-3xl mx-auto",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-8 text-center",children:"How Kofi Ghana Kloding Scaled with Sten360"}),c.jsx("p",{className:"text-gray-600 mb-8",children:"Before switching to Sten360, Kofi Ghana Kloding struggled with disorganized client records, delayed orders, and inefficient workforce management. Manual processes made it difficult to track tailor assignments, manage finances, and keep up with growing customer demand."}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-6",children:"With Sten360, Kofi Ghana Kloding transformed its operations:"}),c.jsxs("div",{className:"space-y-4 mb-8",children:[c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Seamless Order & Client Management"}),c.jsx("p",{className:"text-gray-600",children:"Orders are tracked end-to-end, ensuring every client gets timely service."})]})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Workforce Efficiency"}),c.jsx("p",{className:"text-gray-600",children:"Tailors receive assignments instantly, and their progress is monitored in real-time."})]})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Smarter Financial Controls"}),c.jsx("p",{className:"text-gray-600",children:"Earnings, expenses, and worker payments are automatically tracked, reducing financial errors."})]})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Stronger Customer Relationships"}),c.jsx("p",{className:"text-gray-600",children:"With detailed client profiles and history, Kofi delivers a more personalized experience."})]})]})]}),c.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Now, Kofi Ghana spends less time handling admin tasks and more time growing his brand."}),c.jsxs("div",{className:"text-center",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Ready to take your business to the next level?"}),c.jsxs(Fr,{to:"/signup",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700",children:["Get Started with Sten360 Today!",c.jsx(a1,{className:"ml-2 h-5 w-5"})]})]})]})})})}),c.jsx("div",{className:"bg-white",children:c.jsx("div",{className:"max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"bg-blue-600 rounded-lg shadow-xl overflow-hidden",children:c.jsx("div",{className:"pt-10 pb-12 px-6 sm:pt-16 sm:px-16 lg:py-16 lg:pr-0 xl:py-20 xl:px-20",children:c.jsxs("div",{className:"lg:self-center",children:[c.jsxs("h2",{className:"text-3xl font-extrabold text-white sm:text-4xl",children:[c.jsx("span",{className:"block",children:"Ready to get started?"}),c.jsx("span",{className:"block",children:"Transform your business today."})]}),c.jsx("p",{className:"mt-4 text-lg leading-6 text-blue-200",children:"Sign up for free and experience the difference. No credit card required."}),c.jsxs(Fr,{to:"/signup",className:"mt-8 inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-blue-600 bg-white hover:bg-blue-50 transition-colors duration-200",children:["Get Started Free",c.jsx(a1,{className:"ml-2 h-5 w-5"})]})]})})})})}),c.jsx("footer",{className:"bg-gray-50",children:c.jsx("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(Eo,{className:"h-6 w-6 text-gray-400"}),c.jsx("span",{className:"ml-2 text-gray-500",children:"© 2024 Sten Media Network. All rights reserved."})]}),c.jsx("p",{className:"text-sm text-gray-400",children:"Sten360 is a product of Sten Business, a subsidiary of Sten Media Network"})]})})})]})}function jR(){var w,_,j,O;const{id:e}=K2(),[t,r]=me.useState(null),[n,i]=me.useState(!0),[s,a]=me.useState(!1),[o,l]=me.useState(!1),[u,f]=me.useState({title:"",value:"",type:"text",file:null}),{organization:m}=Gt(),{addToast:p}=vn(),h=m!=null&&m.currency?((w=$r[m.currency])==null?void 0:w.symbol)||m.currency:"";me.useEffect(()=>{!e||!m||v()},[e,m]);const v=async()=>{var L;try{const{data:E,error:C}=await $e.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*),
          orders:orders(
            id,
            order_number,
            total_amount,
            outstanding_balance,
            created_at,
            status
          )
        `).eq("id",e).eq("organization_id",m==null?void 0:m.id).single();if(C)throw C;const P=((L=E.orders)==null?void 0:L.reduce((R,T)=>R+(T.outstanding_balance||0),0))||0;r({...E,total_balance:P})}catch(E){console.error("Error loading client details:",E),p({type:"error",title:"Error",message:"Failed to load client details"})}finally{i(!1)}},g=async()=>{if(!(!t||!m)){l(!0);try{const{error:L}=await $e.from("clients").update({name:t.name,phone:t.phone,address:t.address,date_of_birth:t.date_of_birth}).eq("id",t.id).eq("organization_id",m.id);if(L)throw L;a(!1),p({type:"success",title:"Success",message:"Client details updated successfully"})}catch(L){console.error("Error updating client:",L),p({type:"error",title:"Error",message:"Failed to update client details"})}finally{l(!1)}}},b=async()=>{var L;if(!(!t||!m)){l(!0);try{let E=u.value;if(u.type==="file"&&u.file){const P=(L=u.file.name.split(".").pop())==null?void 0:L.toLowerCase(),R=`${Math.random().toString(36).substring(2)}.${P}`,T=`${m.id}/clients/${t.id}/${R}`,{error:A}=await $e.storage.from("profiles").upload(T,u.file,{cacheControl:"3600",upsert:!1});if(A)throw A;const{data:{publicUrl:q}}=$e.storage.from("profiles").getPublicUrl(T);E=q}const{error:C}=await $e.from("client_custom_fields").insert({client_id:t.id,title:u.title.trim(),value:E,type:u.type});if(C)throw C;f({title:"",value:"",type:"text",file:null}),v(),p({type:"success",title:"Success",message:"Custom field added successfully"})}catch(E){console.error("Error adding custom field:",E),p({type:"error",title:"Error",message:"Failed to add custom field"})}finally{l(!1)}}},y=async L=>{if(t)try{const{error:E}=await $e.from("client_custom_fields").delete().eq("id",L);if(E)throw E;v(),p({type:"success",title:"Success",message:"Custom field deleted successfully"})}catch(E){console.error("Error deleting custom field:",E),p({type:"error",title:"Error",message:"Failed to delete custom field"})}};return n?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t?c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsx("div",{className:"mb-8",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs(Fr,{to:"/dashboard/clients",className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[c.jsx(ld,{className:"h-4 w-4 mr-2"}),"Back to Clients"]}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Client ID: ",t.id]})]})]}),c.jsx("div",{className:"flex items-center space-x-3",children:s?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),c.jsx("button",{onClick:g,disabled:o,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:o?c.jsxs(c.Fragment,{children:[c.jsx(kl,{className:"animate-spin h-4 w-4 mr-2"}),"Saving..."]}):"Save Changes"})]}):c.jsx("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Edit Details"})})]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),s?c.jsx("input",{type:"text",value:t.name,onChange:L=>r(E=>E?{...E,name:L.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):c.jsx("div",{className:"mt-1 text-sm text-gray-900",children:t.name})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),s?c.jsx("input",{type:"tel",value:t.phone||"",onChange:L=>r(E=>E?{...E,phone:L.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):c.jsxs("div",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[c.jsx(rx,{className:"h-4 w-4 mr-2 text-gray-400"}),t.phone||"Not provided"]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),s?c.jsx("textarea",{value:t.address||"",onChange:L=>r(E=>E?{...E,address:L.target.value}:null),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):c.jsxs("div",{className:"mt-1 text-sm text-gray-900 flex items-start",children:[c.jsx(tx,{className:"h-4 w-4 mr-2 mt-1 text-gray-400"}),t.address||"Not provided"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),s?c.jsx("input",{type:"date",value:t.date_of_birth||"",onChange:L=>r(E=>E?{...E,date_of_birth:L.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):c.jsxs("div",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[c.jsx(Fl,{className:"h-4 w-4 mr-2 text-gray-400"}),t.date_of_birth?Mt(new Date(t.date_of_birth),"MMM d, yyyy"):"Not provided"]})]})]})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Custom Information"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsxs("div",{className:"space-y-4",children:[(_=t.custom_fields)==null?void 0:_.map(L=>c.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("span",{className:"font-medium",children:[L.title,": "]}),L.type==="file"?c.jsx("a",{href:L.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"View File"}):c.jsx("span",{children:L.value})]}),c.jsx("button",{onClick:()=>y(L.id),className:"ml-4 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:c.jsx(Es,{className:"h-4 w-4"})})]},L.id)),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Custom Information"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),c.jsxs("select",{value:u.type,onChange:L=>{const E=L.target.value;f(C=>({...C,type:E,value:"",file:null}))},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"text",children:"Text"}),c.jsx("option",{value:"file",children:"File"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),c.jsx("input",{type:"text",value:u.title,onChange:L=>f(E=>({...E,title:L.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),u.type==="text"?c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),c.jsx("input",{type:"text",value:u.value,onChange:L=>f(E=>({...E,value:L.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),c.jsxs("div",{className:"mt-1 flex items-center",children:[c.jsx("input",{type:"file",onChange:L=>{var C;const E=(C=L.target.files)==null?void 0:C[0];E&&f(P=>({...P,file:E}))},className:"hidden",id:"custom-file"}),c.jsxs("label",{htmlFor:"custom-file",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(cd,{className:"h-4 w-4 mr-2"}),"Choose File"]}),u.file&&c.jsx("span",{className:"ml-3 text-sm text-gray-500",children:u.file.name})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{onClick:b,disabled:o||!u.title||!u.value&&!u.file,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:o?c.jsxs(c.Fragment,{children:[c.jsx(kl,{className:"animate-spin h-4 w-4 mr-2"}),"Adding..."]}):"Add Field"})})]})]})]})})]})]}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Financial Summary"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Balance"}),c.jsxs("span",{className:`text-lg font-bold ${t.total_balance>0?"text-red-600":"text-green-600"}`,children:[h," ",t.total_balance.toFixed(2)]})]})}),c.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Orders"}),c.jsx("span",{className:"text-lg font-bold text-gray-900",children:((j=t.orders)==null?void 0:j.length)||0})]})}),c.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Spent"}),c.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[h," ",(O=t.orders)==null?void 0:O.reduce((L,E)=>L+(E.total_amount-E.outstanding_balance),0).toFixed(2)]})]})})]})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Orders History"})}),c.jsx("div",{className:"overflow-x-auto",children:t.orders&&t.orders.length>0?c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Number"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.orders.map(L=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:L.order_number}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Mt(new Date(L.created_at),"MMM d, yyyy")}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h," ",L.total_amount.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("span",{className:`text-sm font-medium ${L.outstanding_balance>0?"text-red-600":"text-green-600"}`,children:[h," ",L.outstanding_balance.toFixed(2)]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${L.status==="completed"?"bg-green-100 text-green-800":L.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:L.status.charAt(0).toUpperCase()+L.status.slice(1)})})]},L.id))})]}):c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No orders found for this client."})})]})]})]})]}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Client not found"}),c.jsxs(Fr,{to:"/clients",className:"mt-4 inline-flex items-center text-blue-600 hover:text-blue-800",children:[c.jsx(ld,{className:"h-4 w-4 mr-1"}),"Back to Clients"]})]})}function AR(){const{user:e,error:t,initialized:r}=Gt();return r?t?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50",children:c.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[c.jsxs("div",{className:"text-red-600 mb-2",children:["Error: ",t]}),c.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})}):c.jsx(ZA,{children:c.jsx(PE,{children:c.jsxs(A4,{children:[c.jsx(br,{path:"/",element:e?c.jsx(dl,{to:"/dashboard",replace:!0}):c.jsx(ER,{})}),c.jsxs(br,{element:c.jsx(VA,{}),children:[c.jsx(br,{path:"/signin",element:c.jsx(YA,{})}),c.jsx(br,{path:"/signup",element:c.jsx(KA,{})})]}),c.jsx(br,{path:"/organization-setup",element:e?c.jsx(_R,{}):c.jsx(dl,{to:"/signin",replace:!0})}),c.jsx(br,{path:"/dashboard/*",element:e?c.jsx(vR,{}):c.jsx(dl,{to:"/signin",replace:!0})}),c.jsx(br,{path:"/clients/:id",element:c.jsx(jR,{})})]})})}):c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading application..."})]})})}x4(document.getElementById("root")).render(c.jsx(me.StrictMode,{children:c.jsx(AR,{})}));export{tr as _,Xn as c,Xg as g};
