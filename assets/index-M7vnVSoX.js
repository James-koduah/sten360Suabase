function rS(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Xn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function rw(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var nw={exports:{}},im={},sw={exports:{}},Ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yf=Symbol.for("react.element"),nS=Symbol.for("react.portal"),sS=Symbol.for("react.fragment"),iS=Symbol.for("react.strict_mode"),aS=Symbol.for("react.profiler"),oS=Symbol.for("react.provider"),lS=Symbol.for("react.context"),cS=Symbol.for("react.forward_ref"),uS=Symbol.for("react.suspense"),dS=Symbol.for("react.memo"),fS=Symbol.for("react.lazy"),nv=Symbol.iterator;function hS(e){return e===null||typeof e!="object"?null:(e=nv&&e[nv]||e["@@iterator"],typeof e=="function"?e:null)}var iw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},aw=Object.assign,ow={};function ou(e,t,r){this.props=e,this.context=t,this.refs=ow,this.updater=r||iw}ou.prototype.isReactComponent={};ou.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ou.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lw(){}lw.prototype=ou.prototype;function Zg(e,t,r){this.props=e,this.context=t,this.refs=ow,this.updater=r||iw}var ex=Zg.prototype=new lw;ex.constructor=Zg;aw(ex,ou.prototype);ex.isPureReactComponent=!0;var sv=Array.isArray,cw=Object.prototype.hasOwnProperty,tx={current:null},uw={key:!0,ref:!0,__self:!0,__source:!0};function dw(e,t,r){var n,s={},i=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)cw.call(t,n)&&!uw.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:yf,type:e,key:i,ref:a,props:s,_owner:tx.current}}function mS(e,t){return{$$typeof:yf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function rx(e){return typeof e=="object"&&e!==null&&e.$$typeof===yf}function pS(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var iv=/\/+/g;function Ap(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pS(""+e.key):t.toString(36)}function n0(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case yf:case nS:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+Ap(a,0):n,sv(s)?(r="",e!=null&&(r=e.replace(iv,"$&/")+"/"),n0(s,t,r,"",function(u){return u})):s!=null&&(rx(s)&&(s=mS(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(iv,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",sv(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Ap(i,l);a+=n0(i,t,r,c,s)}else if(c=hS(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Ap(i,l++),a+=n0(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function bh(e,t,r){if(e==null)return e;var n=[],s=0;return n0(e,n,"","",function(i){return t.call(r,i,s++)}),n}function gS(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Zn={current:null},s0={transition:null},xS={ReactCurrentDispatcher:Zn,ReactCurrentBatchConfig:s0,ReactCurrentOwner:tx};function fw(){throw Error("act(...) is not supported in production builds of React.")}Ot.Children={map:bh,forEach:function(e,t,r){bh(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return bh(e,function(){t++}),t},toArray:function(e){return bh(e,function(t){return t})||[]},only:function(e){if(!rx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ot.Component=ou;Ot.Fragment=sS;Ot.Profiler=aS;Ot.PureComponent=Zg;Ot.StrictMode=iS;Ot.Suspense=uS;Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xS;Ot.act=fw;Ot.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=aw({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=tx.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)cw.call(t,c)&&!uw.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:yf,type:e.type,key:s,ref:i,props:n,_owner:a}};Ot.createContext=function(e){return e={$$typeof:lS,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:oS,_context:e},e.Consumer=e};Ot.createElement=dw;Ot.createFactory=function(e){var t=dw.bind(null,e);return t.type=e,t};Ot.createRef=function(){return{current:null}};Ot.forwardRef=function(e){return{$$typeof:cS,render:e}};Ot.isValidElement=rx;Ot.lazy=function(e){return{$$typeof:fS,_payload:{_status:-1,_result:e},_init:gS}};Ot.memo=function(e,t){return{$$typeof:dS,type:e,compare:t===void 0?null:t}};Ot.startTransition=function(e){var t=s0.transition;s0.transition={};try{e()}finally{s0.transition=t}};Ot.unstable_act=fw;Ot.useCallback=function(e,t){return Zn.current.useCallback(e,t)};Ot.useContext=function(e){return Zn.current.useContext(e)};Ot.useDebugValue=function(){};Ot.useDeferredValue=function(e){return Zn.current.useDeferredValue(e)};Ot.useEffect=function(e,t){return Zn.current.useEffect(e,t)};Ot.useId=function(){return Zn.current.useId()};Ot.useImperativeHandle=function(e,t,r){return Zn.current.useImperativeHandle(e,t,r)};Ot.useInsertionEffect=function(e,t){return Zn.current.useInsertionEffect(e,t)};Ot.useLayoutEffect=function(e,t){return Zn.current.useLayoutEffect(e,t)};Ot.useMemo=function(e,t){return Zn.current.useMemo(e,t)};Ot.useReducer=function(e,t,r){return Zn.current.useReducer(e,t,r)};Ot.useRef=function(e){return Zn.current.useRef(e)};Ot.useState=function(e){return Zn.current.useState(e)};Ot.useSyncExternalStore=function(e,t,r){return Zn.current.useSyncExternalStore(e,t,r)};Ot.useTransition=function(){return Zn.current.useTransition()};Ot.version="18.3.1";sw.exports=Ot;var he=sw.exports;const hw=Qg(he),vS=rS({__proto__:null,default:hw},[he]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yS=he,wS=Symbol.for("react.element"),bS=Symbol.for("react.fragment"),_S=Object.prototype.hasOwnProperty,NS=yS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SS={key:!0,ref:!0,__self:!0,__source:!0};function mw(e,t,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)_S.call(t,n)&&!SS.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:wS,type:e,key:i,ref:a,props:s,_owner:NS.current}}im.Fragment=bS;im.jsx=mw;im.jsxs=mw;nw.exports=im;var o=nw.exports,pw={exports:{}},Ms={},gw={exports:{}},xw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,Y){var se=B.length;B.push(Y);e:for(;0<se;){var me=se-1>>>1,S=B[me];if(0<s(S,Y))B[me]=Y,B[se]=S,se=me;else break e}}function r(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var Y=B[0],se=B.pop();if(se!==Y){B[0]=se;e:for(var me=0,S=B.length,L=S>>>1;me<L;){var R=2*(me+1)-1,O=B[R],V=R+1,ne=B[V];if(0>s(O,se))V<S&&0>s(ne,O)?(B[me]=ne,B[V]=se,me=V):(B[me]=O,B[R]=se,me=R);else if(V<S&&0>s(ne,se))B[me]=ne,B[V]=se,me=V;else break e}}return Y}function s(B,Y){var se=B.sortIndex-Y.sortIndex;return se!==0?se:B.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,m=null,p=3,h=!1,y=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(B){for(var Y=r(u);Y!==null;){if(Y.callback===null)n(u);else if(Y.startTime<=B)n(u),Y.sortIndex=Y.expirationTime,t(c,Y);else break;Y=r(u)}}function E(B){if(g=!1,_(B),!y)if(r(c)!==null)y=!0,z(D);else{var Y=r(u);Y!==null&&G(E,Y.startTime-B)}}function D(B,Y){y=!1,g&&(g=!1,v(P),P=-1),h=!0;var se=p;try{for(_(Y),m=r(c);m!==null&&(!(m.expirationTime>Y)||B&&!j());){var me=m.callback;if(typeof me=="function"){m.callback=null,p=m.priorityLevel;var S=me(m.expirationTime<=Y);Y=e.unstable_now(),typeof S=="function"?m.callback=S:m===r(c)&&n(c),_(Y)}else n(c);m=r(c)}if(m!==null)var L=!0;else{var R=r(u);R!==null&&G(E,R.startTime-Y),L=!1}return L}finally{m=null,p=se,h=!1}}var I=!1,A=null,P=-1,C=5,M=-1;function j(){return!(e.unstable_now()-M<C)}function T(){if(A!==null){var B=e.unstable_now();M=B;var Y=!0;try{Y=A(!0,B)}finally{Y?q():(I=!1,A=null)}}else I=!1}var q;if(typeof b=="function")q=function(){b(T)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,re=U.port2;U.port1.onmessage=T,q=function(){re.postMessage(null)}}else q=function(){w(T,0)};function z(B){A=B,I||(I=!0,q())}function G(B,Y){P=w(function(){B(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,z(D))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(B){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var se=p;p=Y;try{return B()}finally{p=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,Y){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var se=p;p=B;try{return Y()}finally{p=se}},e.unstable_scheduleCallback=function(B,Y,se){var me=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?me+se:me):se=me,B){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=se+S,B={id:d++,callback:Y,priorityLevel:B,startTime:se,expirationTime:S,sortIndex:-1},se>me?(B.sortIndex=se,t(u,B),r(c)===null&&B===r(u)&&(g?(v(P),P=-1):g=!0,G(E,se-me))):(B.sortIndex=S,t(c,B),y||h||(y=!0,z(D))),B},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(B){var Y=p;return function(){var se=p;p=Y;try{return B.apply(this,arguments)}finally{p=se}}}})(xw);gw.exports=xw;var kS=gw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jS=he,Is=kS;function Ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vw=new Set,zd={};function Pl(e,t){Xc(e,t),Xc(e+"Capture",t)}function Xc(e,t){for(zd[e]=t,e=0;e<t.length;e++)vw.add(t[e])}var Na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),P1=Object.prototype.hasOwnProperty,ES=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,av={},ov={};function AS(e){return P1.call(ov,e)?!0:P1.call(av,e)?!1:ES.test(e)?ov[e]=!0:(av[e]=!0,!1)}function TS(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CS(e,t,r,n){if(t===null||typeof t>"u"||TS(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function es(e,t,r,n,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){An[e]=new es(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];An[t]=new es(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){An[e]=new es(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){An[e]=new es(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){An[e]=new es(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){An[e]=new es(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){An[e]=new es(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){An[e]=new es(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){An[e]=new es(e,5,!1,e.toLowerCase(),null,!1,!1)});var nx=/[\-:]([a-z])/g;function sx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(nx,sx);An[t]=new es(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(nx,sx);An[t]=new es(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(nx,sx);An[t]=new es(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){An[e]=new es(e,1,!1,e.toLowerCase(),null,!1,!1)});An.xlinkHref=new es("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){An[e]=new es(e,1,!1,e.toLowerCase(),null,!0,!0)});function ix(e,t,r,n){var s=An.hasOwnProperty(t)?An[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CS(t,r,s,n)&&(r=null),n||s===null?AS(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Pa=jS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_h=Symbol.for("react.element"),Sc=Symbol.for("react.portal"),kc=Symbol.for("react.fragment"),ax=Symbol.for("react.strict_mode"),L1=Symbol.for("react.profiler"),yw=Symbol.for("react.provider"),ww=Symbol.for("react.context"),ox=Symbol.for("react.forward_ref"),F1=Symbol.for("react.suspense"),O1=Symbol.for("react.suspense_list"),lx=Symbol.for("react.memo"),eo=Symbol.for("react.lazy"),bw=Symbol.for("react.offscreen"),lv=Symbol.iterator;function Ku(e){return e===null||typeof e!="object"?null:(e=lv&&e[lv]||e["@@iterator"],typeof e=="function"?e:null)}var Er=Object.assign,Tp;function dd(e){if(Tp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Tp=t&&t[1]||""}return`
`+Tp+e}var Cp=!1;function Pp(e,t){if(!e||Cp)return"";Cp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{Cp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?dd(e):""}function PS(e){switch(e.tag){case 5:return dd(e.type);case 16:return dd("Lazy");case 13:return dd("Suspense");case 19:return dd("SuspenseList");case 0:case 2:case 15:return e=Pp(e.type,!1),e;case 11:return e=Pp(e.type.render,!1),e;case 1:return e=Pp(e.type,!0),e;default:return""}}function D1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case kc:return"Fragment";case Sc:return"Portal";case L1:return"Profiler";case ax:return"StrictMode";case F1:return"Suspense";case O1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ww:return(e.displayName||"Context")+".Consumer";case yw:return(e._context.displayName||"Context")+".Provider";case ox:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lx:return t=e.displayName||null,t!==null?t:D1(e.type)||"Memo";case eo:t=e._payload,e=e._init;try{return D1(e(t))}catch{}}return null}function LS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D1(t);case 8:return t===ax?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _w(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function FS(e){var t=_w(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Nh(e){e._valueTracker||(e._valueTracker=FS(e))}function Nw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=_w(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function p0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function I1(e,t){var r=t.checked;return Er({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function cv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=jo(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Sw(e,t){t=t.checked,t!=null&&ix(e,"checked",t,!1)}function R1(e,t){Sw(e,t);var r=jo(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?M1(e,t.type,r):t.hasOwnProperty("defaultValue")&&M1(e,t.type,jo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function uv(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function M1(e,t,r){(t!=="number"||p0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var fd=Array.isArray;function Bc(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+jo(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function B1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ge(91));return Er({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function dv(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ge(92));if(fd(r)){if(1<r.length)throw Error(Ge(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:jo(r)}}function kw(e,t){var r=jo(t.value),n=jo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function fv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function jw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function U1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?jw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sh,Ew=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sh=Sh||document.createElement("div"),Sh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wd(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OS=["Webkit","ms","Moz","O"];Object.keys(vd).forEach(function(e){OS.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vd[t]=vd[e]})});function Aw(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||vd.hasOwnProperty(e)&&vd[e]?(""+t).trim():t+"px"}function Tw(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Aw(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var DS=Er({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function z1(e,t){if(t){if(DS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ge(62))}}function W1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var H1=null;function cx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $1=null,Uc=null,zc=null;function hv(e){if(e=_f(e)){if(typeof $1!="function")throw Error(Ge(280));var t=e.stateNode;t&&(t=um(t),$1(e.stateNode,e.type,t))}}function Cw(e){Uc?zc?zc.push(e):zc=[e]:Uc=e}function Pw(){if(Uc){var e=Uc,t=zc;if(zc=Uc=null,hv(e),t)for(e=0;e<t.length;e++)hv(t[e])}}function Lw(e,t){return e(t)}function Fw(){}var Lp=!1;function Ow(e,t,r){if(Lp)return e(t,r);Lp=!0;try{return Lw(e,t,r)}finally{Lp=!1,(Uc!==null||zc!==null)&&(Fw(),Pw())}}function Hd(e,t){var r=e.stateNode;if(r===null)return null;var n=um(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ge(231,t,typeof r));return r}var q1=!1;if(Na)try{var Xu={};Object.defineProperty(Xu,"passive",{get:function(){q1=!0}}),window.addEventListener("test",Xu,Xu),window.removeEventListener("test",Xu,Xu)}catch{q1=!1}function IS(e,t,r,n,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var yd=!1,g0=null,x0=!1,V1=null,RS={onError:function(e){yd=!0,g0=e}};function MS(e,t,r,n,s,i,a,l,c){yd=!1,g0=null,IS.apply(RS,arguments)}function BS(e,t,r,n,s,i,a,l,c){if(MS.apply(this,arguments),yd){if(yd){var u=g0;yd=!1,g0=null}else throw Error(Ge(198));x0||(x0=!0,V1=u)}}function Ll(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Dw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function mv(e){if(Ll(e)!==e)throw Error(Ge(188))}function US(e){var t=e.alternate;if(!t){if(t=Ll(e),t===null)throw Error(Ge(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return mv(s),e;if(i===n)return mv(s),t;i=i.sibling}throw Error(Ge(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(Ge(189))}}if(r.alternate!==n)throw Error(Ge(190))}if(r.tag!==3)throw Error(Ge(188));return r.stateNode.current===r?e:t}function Iw(e){return e=US(e),e!==null?Rw(e):null}function Rw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Rw(e);if(t!==null)return t;e=e.sibling}return null}var Mw=Is.unstable_scheduleCallback,pv=Is.unstable_cancelCallback,zS=Is.unstable_shouldYield,WS=Is.unstable_requestPaint,Ur=Is.unstable_now,HS=Is.unstable_getCurrentPriorityLevel,ux=Is.unstable_ImmediatePriority,Bw=Is.unstable_UserBlockingPriority,v0=Is.unstable_NormalPriority,$S=Is.unstable_LowPriority,Uw=Is.unstable_IdlePriority,am=null,Ki=null;function qS(e){if(Ki&&typeof Ki.onCommitFiberRoot=="function")try{Ki.onCommitFiberRoot(am,e,void 0,(e.current.flags&128)===128)}catch{}}var Ei=Math.clz32?Math.clz32:YS,VS=Math.log,GS=Math.LN2;function YS(e){return e>>>=0,e===0?32:31-(VS(e)/GS|0)|0}var kh=64,jh=4194304;function hd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function y0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=hd(l):(i&=a,i!==0&&(n=hd(i)))}else a=r&~s,a!==0?n=hd(a):i!==0&&(n=hd(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ei(t),s=1<<r,n|=e[r],t&=~s;return n}function KS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Ei(i),l=1<<a,c=s[a];c===-1?(!(l&r)||l&n)&&(s[a]=KS(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function G1(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function zw(){var e=kh;return kh<<=1,!(kh&4194240)&&(kh=64),e}function Fp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function wf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ei(t),e[t]=r}function JS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Ei(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function dx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ei(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var nr=0;function Ww(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Hw,fx,$w,qw,Vw,Y1=!1,Eh=[],mo=null,po=null,go=null,$d=new Map,qd=new Map,no=[],QS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gv(e,t){switch(e){case"focusin":case"focusout":mo=null;break;case"dragenter":case"dragleave":po=null;break;case"mouseover":case"mouseout":go=null;break;case"pointerover":case"pointerout":$d.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qd.delete(t.pointerId)}}function Ju(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=_f(t),t!==null&&fx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ZS(e,t,r,n,s){switch(t){case"focusin":return mo=Ju(mo,e,t,r,n,s),!0;case"dragenter":return po=Ju(po,e,t,r,n,s),!0;case"mouseover":return go=Ju(go,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return $d.set(i,Ju($d.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,qd.set(i,Ju(qd.get(i)||null,e,t,r,n,s)),!0}return!1}function Gw(e){var t=ll(e.target);if(t!==null){var r=Ll(t);if(r!==null){if(t=r.tag,t===13){if(t=Dw(r),t!==null){e.blockedOn=t,Vw(e.priority,function(){$w(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function i0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=K1(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);H1=n,r.target.dispatchEvent(n),H1=null}else return t=_f(r),t!==null&&fx(t),e.blockedOn=r,!1;t.shift()}return!0}function xv(e,t,r){i0(e)&&r.delete(t)}function e6(){Y1=!1,mo!==null&&i0(mo)&&(mo=null),po!==null&&i0(po)&&(po=null),go!==null&&i0(go)&&(go=null),$d.forEach(xv),qd.forEach(xv)}function Qu(e,t){e.blockedOn===t&&(e.blockedOn=null,Y1||(Y1=!0,Is.unstable_scheduleCallback(Is.unstable_NormalPriority,e6)))}function Vd(e){function t(s){return Qu(s,e)}if(0<Eh.length){Qu(Eh[0],e);for(var r=1;r<Eh.length;r++){var n=Eh[r];n.blockedOn===e&&(n.blockedOn=null)}}for(mo!==null&&Qu(mo,e),po!==null&&Qu(po,e),go!==null&&Qu(go,e),$d.forEach(t),qd.forEach(t),r=0;r<no.length;r++)n=no[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<no.length&&(r=no[0],r.blockedOn===null);)Gw(r),r.blockedOn===null&&no.shift()}var Wc=Pa.ReactCurrentBatchConfig,w0=!0;function t6(e,t,r,n){var s=nr,i=Wc.transition;Wc.transition=null;try{nr=1,hx(e,t,r,n)}finally{nr=s,Wc.transition=i}}function r6(e,t,r,n){var s=nr,i=Wc.transition;Wc.transition=null;try{nr=4,hx(e,t,r,n)}finally{nr=s,Wc.transition=i}}function hx(e,t,r,n){if(w0){var s=K1(e,t,r,n);if(s===null)Hp(e,t,n,b0,r),gv(e,n);else if(ZS(s,e,t,r,n))n.stopPropagation();else if(gv(e,n),t&4&&-1<QS.indexOf(e)){for(;s!==null;){var i=_f(s);if(i!==null&&Hw(i),i=K1(e,t,r,n),i===null&&Hp(e,t,n,b0,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Hp(e,t,n,null,r)}}var b0=null;function K1(e,t,r,n){if(b0=null,e=cx(n),e=ll(e),e!==null)if(t=Ll(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Dw(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return b0=e,null}function Yw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(HS()){case ux:return 1;case Bw:return 4;case v0:case $S:return 16;case Uw:return 536870912;default:return 16}default:return 16}}var oo=null,mx=null,a0=null;function Kw(){if(a0)return a0;var e,t=mx,r=t.length,n,s="value"in oo?oo.value:oo.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[i-n];n++);return a0=s.slice(e,1<n?1-n:void 0)}function o0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ah(){return!0}function vv(){return!1}function Bs(e){function t(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ah:vv,this.isPropagationStopped=vv,this}return Er(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ah)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ah)},persist:function(){},isPersistent:Ah}),t}var lu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},px=Bs(lu),bf=Er({},lu,{view:0,detail:0}),n6=Bs(bf),Op,Dp,Zu,om=Er({},bf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zu&&(Zu&&e.type==="mousemove"?(Op=e.screenX-Zu.screenX,Dp=e.screenY-Zu.screenY):Dp=Op=0,Zu=e),Op)},movementY:function(e){return"movementY"in e?e.movementY:Dp}}),yv=Bs(om),s6=Er({},om,{dataTransfer:0}),i6=Bs(s6),a6=Er({},bf,{relatedTarget:0}),Ip=Bs(a6),o6=Er({},lu,{animationName:0,elapsedTime:0,pseudoElement:0}),l6=Bs(o6),c6=Er({},lu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),u6=Bs(c6),d6=Er({},lu,{data:0}),wv=Bs(d6),f6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p6(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=m6[e])?!!t[e]:!1}function gx(){return p6}var g6=Er({},bf,{key:function(e){if(e.key){var t=f6[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=o0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?h6[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gx,charCode:function(e){return e.type==="keypress"?o0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?o0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),x6=Bs(g6),v6=Er({},om,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bv=Bs(v6),y6=Er({},bf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gx}),w6=Bs(y6),b6=Er({},lu,{propertyName:0,elapsedTime:0,pseudoElement:0}),_6=Bs(b6),N6=Er({},om,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),S6=Bs(N6),k6=[9,13,27,32],xx=Na&&"CompositionEvent"in window,wd=null;Na&&"documentMode"in document&&(wd=document.documentMode);var j6=Na&&"TextEvent"in window&&!wd,Xw=Na&&(!xx||wd&&8<wd&&11>=wd),_v=" ",Nv=!1;function Jw(e,t){switch(e){case"keyup":return k6.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var jc=!1;function E6(e,t){switch(e){case"compositionend":return Qw(t);case"keypress":return t.which!==32?null:(Nv=!0,_v);case"textInput":return e=t.data,e===_v&&Nv?null:e;default:return null}}function A6(e,t){if(jc)return e==="compositionend"||!xx&&Jw(e,t)?(e=Kw(),a0=mx=oo=null,jc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xw&&t.locale!=="ko"?null:t.data;default:return null}}var T6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!T6[e.type]:t==="textarea"}function Zw(e,t,r,n){Cw(n),t=_0(t,"onChange"),0<t.length&&(r=new px("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var bd=null,Gd=null;function C6(e){ub(e,0)}function lm(e){var t=Tc(e);if(Nw(t))return e}function P6(e,t){if(e==="change")return t}var eb=!1;if(Na){var Rp;if(Na){var Mp="oninput"in document;if(!Mp){var kv=document.createElement("div");kv.setAttribute("oninput","return;"),Mp=typeof kv.oninput=="function"}Rp=Mp}else Rp=!1;eb=Rp&&(!document.documentMode||9<document.documentMode)}function jv(){bd&&(bd.detachEvent("onpropertychange",tb),Gd=bd=null)}function tb(e){if(e.propertyName==="value"&&lm(Gd)){var t=[];Zw(t,Gd,e,cx(e)),Ow(C6,t)}}function L6(e,t,r){e==="focusin"?(jv(),bd=t,Gd=r,bd.attachEvent("onpropertychange",tb)):e==="focusout"&&jv()}function F6(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lm(Gd)}function O6(e,t){if(e==="click")return lm(t)}function D6(e,t){if(e==="input"||e==="change")return lm(t)}function I6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ci=typeof Object.is=="function"?Object.is:I6;function Yd(e,t){if(Ci(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!P1.call(t,s)||!Ci(e[s],t[s]))return!1}return!0}function Ev(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Av(e,t){var r=Ev(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ev(r)}}function rb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function nb(){for(var e=window,t=p0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=p0(e.document)}return t}function vx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function R6(e){var t=nb(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&rb(r.ownerDocument.documentElement,r)){if(n!==null&&vx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Av(r,i);var a=Av(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var M6=Na&&"documentMode"in document&&11>=document.documentMode,Ec=null,X1=null,_d=null,J1=!1;function Tv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;J1||Ec==null||Ec!==p0(n)||(n=Ec,"selectionStart"in n&&vx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_d&&Yd(_d,n)||(_d=n,n=_0(X1,"onSelect"),0<n.length&&(t=new px("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ec)))}function Th(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ac={animationend:Th("Animation","AnimationEnd"),animationiteration:Th("Animation","AnimationIteration"),animationstart:Th("Animation","AnimationStart"),transitionend:Th("Transition","TransitionEnd")},Bp={},sb={};Na&&(sb=document.createElement("div").style,"AnimationEvent"in window||(delete Ac.animationend.animation,delete Ac.animationiteration.animation,delete Ac.animationstart.animation),"TransitionEvent"in window||delete Ac.transitionend.transition);function cm(e){if(Bp[e])return Bp[e];if(!Ac[e])return e;var t=Ac[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in sb)return Bp[e]=t[r];return e}var ib=cm("animationend"),ab=cm("animationiteration"),ob=cm("animationstart"),lb=cm("transitionend"),cb=new Map,Cv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Io(e,t){cb.set(e,t),Pl(t,[e])}for(var Up=0;Up<Cv.length;Up++){var zp=Cv[Up],B6=zp.toLowerCase(),U6=zp[0].toUpperCase()+zp.slice(1);Io(B6,"on"+U6)}Io(ib,"onAnimationEnd");Io(ab,"onAnimationIteration");Io(ob,"onAnimationStart");Io("dblclick","onDoubleClick");Io("focusin","onFocus");Io("focusout","onBlur");Io(lb,"onTransitionEnd");Xc("onMouseEnter",["mouseout","mouseover"]);Xc("onMouseLeave",["mouseout","mouseover"]);Xc("onPointerEnter",["pointerout","pointerover"]);Xc("onPointerLeave",["pointerout","pointerover"]);Pl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var md="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z6=new Set("cancel close invalid load scroll toggle".split(" ").concat(md));function Pv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,BS(n,t,void 0,e),e.currentTarget=null}function ub(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Pv(s,l,u),i=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Pv(s,l,u),i=c}}}if(x0)throw e=V1,x0=!1,V1=null,e}function vr(e,t){var r=t[rg];r===void 0&&(r=t[rg]=new Set);var n=e+"__bubble";r.has(n)||(db(t,e,2,!1),r.add(n))}function Wp(e,t,r){var n=0;t&&(n|=4),db(r,e,n,t)}var Ch="_reactListening"+Math.random().toString(36).slice(2);function Kd(e){if(!e[Ch]){e[Ch]=!0,vw.forEach(function(r){r!=="selectionchange"&&(z6.has(r)||Wp(r,!1,e),Wp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ch]||(t[Ch]=!0,Wp("selectionchange",!1,t))}}function db(e,t,r,n){switch(Yw(t)){case 1:var s=t6;break;case 4:s=r6;break;default:s=hx}r=s.bind(null,t,r,e),s=void 0,!q1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Hp(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ll(l),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}l=l.parentNode}}n=n.return}Ow(function(){var u=i,d=cx(r),m=[];e:{var p=cb.get(e);if(p!==void 0){var h=px,y=e;switch(e){case"keypress":if(o0(r)===0)break e;case"keydown":case"keyup":h=x6;break;case"focusin":y="focus",h=Ip;break;case"focusout":y="blur",h=Ip;break;case"beforeblur":case"afterblur":h=Ip;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=yv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=i6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=w6;break;case ib:case ab:case ob:h=l6;break;case lb:h=_6;break;case"scroll":h=n6;break;case"wheel":h=S6;break;case"copy":case"cut":case"paste":h=u6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=bv}var g=(t&4)!==0,w=!g&&e==="scroll",v=g?p!==null?p+"Capture":null:p;g=[];for(var b=u,_;b!==null;){_=b;var E=_.stateNode;if(_.tag===5&&E!==null&&(_=E,v!==null&&(E=Hd(b,v),E!=null&&g.push(Xd(b,E,_)))),w)break;b=b.return}0<g.length&&(p=new h(p,y,null,r,d),m.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==H1&&(y=r.relatedTarget||r.fromElement)&&(ll(y)||y[Sa]))break e;if((h||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,h?(y=r.relatedTarget||r.toElement,h=u,y=y?ll(y):null,y!==null&&(w=Ll(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=u),h!==y)){if(g=yv,E="onMouseLeave",v="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=bv,E="onPointerLeave",v="onPointerEnter",b="pointer"),w=h==null?p:Tc(h),_=y==null?p:Tc(y),p=new g(E,b+"leave",h,r,d),p.target=w,p.relatedTarget=_,E=null,ll(d)===u&&(g=new g(v,b+"enter",y,r,d),g.target=_,g.relatedTarget=w,E=g),w=E,h&&y)t:{for(g=h,v=y,b=0,_=g;_;_=cc(_))b++;for(_=0,E=v;E;E=cc(E))_++;for(;0<b-_;)g=cc(g),b--;for(;0<_-b;)v=cc(v),_--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=cc(g),v=cc(v)}g=null}else g=null;h!==null&&Lv(m,p,h,g,!1),y!==null&&w!==null&&Lv(m,w,y,g,!0)}}e:{if(p=u?Tc(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var D=P6;else if(Sv(p))if(eb)D=D6;else{D=F6;var I=L6}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(D=O6);if(D&&(D=D(e,u))){Zw(m,D,r,d);break e}I&&I(e,p,u),e==="focusout"&&(I=p._wrapperState)&&I.controlled&&p.type==="number"&&M1(p,"number",p.value)}switch(I=u?Tc(u):window,e){case"focusin":(Sv(I)||I.contentEditable==="true")&&(Ec=I,X1=u,_d=null);break;case"focusout":_d=X1=Ec=null;break;case"mousedown":J1=!0;break;case"contextmenu":case"mouseup":case"dragend":J1=!1,Tv(m,r,d);break;case"selectionchange":if(M6)break;case"keydown":case"keyup":Tv(m,r,d)}var A;if(xx)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else jc?Jw(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(Xw&&r.locale!=="ko"&&(jc||P!=="onCompositionStart"?P==="onCompositionEnd"&&jc&&(A=Kw()):(oo=d,mx="value"in oo?oo.value:oo.textContent,jc=!0)),I=_0(u,P),0<I.length&&(P=new wv(P,e,null,r,d),m.push({event:P,listeners:I}),A?P.data=A:(A=Qw(r),A!==null&&(P.data=A)))),(A=j6?E6(e,r):A6(e,r))&&(u=_0(u,"onBeforeInput"),0<u.length&&(d=new wv("onBeforeInput","beforeinput",null,r,d),m.push({event:d,listeners:u}),d.data=A))}ub(m,t)})}function Xd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function _0(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Hd(e,r),i!=null&&n.unshift(Xd(e,i,s)),i=Hd(e,t),i!=null&&n.push(Xd(e,i,s))),e=e.return}return n}function cc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Lv(e,t,r,n,s){for(var i=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Hd(r,i),c!=null&&a.unshift(Xd(r,c,l))):s||(c=Hd(r,i),c!=null&&a.push(Xd(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var W6=/\r\n?/g,H6=/\u0000|\uFFFD/g;function Fv(e){return(typeof e=="string"?e:""+e).replace(W6,`
`).replace(H6,"")}function Ph(e,t,r){if(t=Fv(t),Fv(e)!==t&&r)throw Error(Ge(425))}function N0(){}var Q1=null,Z1=null;function eg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var tg=typeof setTimeout=="function"?setTimeout:void 0,$6=typeof clearTimeout=="function"?clearTimeout:void 0,Ov=typeof Promise=="function"?Promise:void 0,q6=typeof queueMicrotask=="function"?queueMicrotask:typeof Ov<"u"?function(e){return Ov.resolve(null).then(e).catch(V6)}:tg;function V6(e){setTimeout(function(){throw e})}function $p(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Vd(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Vd(t)}function xo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Dv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var cu=Math.random().toString(36).slice(2),Gi="__reactFiber$"+cu,Jd="__reactProps$"+cu,Sa="__reactContainer$"+cu,rg="__reactEvents$"+cu,G6="__reactListeners$"+cu,Y6="__reactHandles$"+cu;function ll(e){var t=e[Gi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Sa]||r[Gi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Dv(e);e!==null;){if(r=e[Gi])return r;e=Dv(e)}return t}e=r,r=e.parentNode}return null}function _f(e){return e=e[Gi]||e[Sa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ge(33))}function um(e){return e[Jd]||null}var ng=[],Cc=-1;function Ro(e){return{current:e}}function br(e){0>Cc||(e.current=ng[Cc],ng[Cc]=null,Cc--)}function pr(e,t){Cc++,ng[Cc]=e.current,e.current=t}var Eo={},Hn=Ro(Eo),fs=Ro(!1),bl=Eo;function Jc(e,t){var r=e.type.contextTypes;if(!r)return Eo;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function hs(e){return e=e.childContextTypes,e!=null}function S0(){br(fs),br(Hn)}function Iv(e,t,r){if(Hn.current!==Eo)throw Error(Ge(168));pr(Hn,t),pr(fs,r)}function fb(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Ge(108,LS(e)||"Unknown",s));return Er({},r,n)}function k0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Eo,bl=Hn.current,pr(Hn,e),pr(fs,fs.current),!0}function Rv(e,t,r){var n=e.stateNode;if(!n)throw Error(Ge(169));r?(e=fb(e,t,bl),n.__reactInternalMemoizedMergedChildContext=e,br(fs),br(Hn),pr(Hn,e)):br(fs),pr(fs,r)}var ga=null,dm=!1,qp=!1;function hb(e){ga===null?ga=[e]:ga.push(e)}function K6(e){dm=!0,hb(e)}function Mo(){if(!qp&&ga!==null){qp=!0;var e=0,t=nr;try{var r=ga;for(nr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ga=null,dm=!1}catch(s){throw ga!==null&&(ga=ga.slice(e+1)),Mw(ux,Mo),s}finally{nr=t,qp=!1}}return null}var Pc=[],Lc=0,j0=null,E0=0,Qs=[],Zs=0,_l=null,xa=1,va="";function tl(e,t){Pc[Lc++]=E0,Pc[Lc++]=j0,j0=e,E0=t}function mb(e,t,r){Qs[Zs++]=xa,Qs[Zs++]=va,Qs[Zs++]=_l,_l=e;var n=xa;e=va;var s=32-Ei(n)-1;n&=~(1<<s),r+=1;var i=32-Ei(t)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,xa=1<<32-Ei(t)+s|r<<s|n,va=i+e}else xa=1<<i|r<<s|n,va=e}function yx(e){e.return!==null&&(tl(e,1),mb(e,1,0))}function wx(e){for(;e===j0;)j0=Pc[--Lc],Pc[Lc]=null,E0=Pc[--Lc],Pc[Lc]=null;for(;e===_l;)_l=Qs[--Zs],Qs[Zs]=null,va=Qs[--Zs],Qs[Zs]=null,xa=Qs[--Zs],Qs[Zs]=null}var Os=null,Ls=null,Nr=!1,Ni=null;function pb(e,t){var r=ei(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Mv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Os=e,Ls=xo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Os=e,Ls=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_l!==null?{id:xa,overflow:va}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ei(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Os=e,Ls=null,!0):!1;default:return!1}}function sg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ig(e){if(Nr){var t=Ls;if(t){var r=t;if(!Mv(e,t)){if(sg(e))throw Error(Ge(418));t=xo(r.nextSibling);var n=Os;t&&Mv(e,t)?pb(n,r):(e.flags=e.flags&-4097|2,Nr=!1,Os=e)}}else{if(sg(e))throw Error(Ge(418));e.flags=e.flags&-4097|2,Nr=!1,Os=e}}}function Bv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Os=e}function Lh(e){if(e!==Os)return!1;if(!Nr)return Bv(e),Nr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!eg(e.type,e.memoizedProps)),t&&(t=Ls)){if(sg(e))throw gb(),Error(Ge(418));for(;t;)pb(e,t),t=xo(t.nextSibling)}if(Bv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ls=xo(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ls=null}}else Ls=Os?xo(e.stateNode.nextSibling):null;return!0}function gb(){for(var e=Ls;e;)e=xo(e.nextSibling)}function Qc(){Ls=Os=null,Nr=!1}function bx(e){Ni===null?Ni=[e]:Ni.push(e)}var X6=Pa.ReactCurrentBatchConfig;function ed(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ge(309));var n=r.stateNode}if(!n)throw Error(Ge(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ge(284));if(!r._owner)throw Error(Ge(290,e))}return e}function Fh(e,t){throw e=Object.prototype.toString.call(t),Error(Ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Uv(e){var t=e._init;return t(e._payload)}function xb(e){function t(v,b){if(e){var _=v.deletions;_===null?(v.deletions=[b],v.flags|=16):_.push(b)}}function r(v,b){if(!e)return null;for(;b!==null;)t(v,b),b=b.sibling;return null}function n(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function s(v,b){return v=bo(v,b),v.index=0,v.sibling=null,v}function i(v,b,_){return v.index=_,e?(_=v.alternate,_!==null?(_=_.index,_<b?(v.flags|=2,b):_):(v.flags|=2,b)):(v.flags|=1048576,b)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,b,_,E){return b===null||b.tag!==6?(b=Qp(_,v.mode,E),b.return=v,b):(b=s(b,_),b.return=v,b)}function c(v,b,_,E){var D=_.type;return D===kc?d(v,b,_.props.children,E,_.key):b!==null&&(b.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===eo&&Uv(D)===b.type)?(E=s(b,_.props),E.ref=ed(v,b,_),E.return=v,E):(E=m0(_.type,_.key,_.props,null,v.mode,E),E.ref=ed(v,b,_),E.return=v,E)}function u(v,b,_,E){return b===null||b.tag!==4||b.stateNode.containerInfo!==_.containerInfo||b.stateNode.implementation!==_.implementation?(b=Zp(_,v.mode,E),b.return=v,b):(b=s(b,_.children||[]),b.return=v,b)}function d(v,b,_,E,D){return b===null||b.tag!==7?(b=hl(_,v.mode,E,D),b.return=v,b):(b=s(b,_),b.return=v,b)}function m(v,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Qp(""+b,v.mode,_),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _h:return _=m0(b.type,b.key,b.props,null,v.mode,_),_.ref=ed(v,null,b),_.return=v,_;case Sc:return b=Zp(b,v.mode,_),b.return=v,b;case eo:var E=b._init;return m(v,E(b._payload),_)}if(fd(b)||Ku(b))return b=hl(b,v.mode,_,null),b.return=v,b;Fh(v,b)}return null}function p(v,b,_,E){var D=b!==null?b.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return D!==null?null:l(v,b,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case _h:return _.key===D?c(v,b,_,E):null;case Sc:return _.key===D?u(v,b,_,E):null;case eo:return D=_._init,p(v,b,D(_._payload),E)}if(fd(_)||Ku(_))return D!==null?null:d(v,b,_,E,null);Fh(v,_)}return null}function h(v,b,_,E,D){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(_)||null,l(b,v,""+E,D);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case _h:return v=v.get(E.key===null?_:E.key)||null,c(b,v,E,D);case Sc:return v=v.get(E.key===null?_:E.key)||null,u(b,v,E,D);case eo:var I=E._init;return h(v,b,_,I(E._payload),D)}if(fd(E)||Ku(E))return v=v.get(_)||null,d(b,v,E,D,null);Fh(b,E)}return null}function y(v,b,_,E){for(var D=null,I=null,A=b,P=b=0,C=null;A!==null&&P<_.length;P++){A.index>P?(C=A,A=null):C=A.sibling;var M=p(v,A,_[P],E);if(M===null){A===null&&(A=C);break}e&&A&&M.alternate===null&&t(v,A),b=i(M,b,P),I===null?D=M:I.sibling=M,I=M,A=C}if(P===_.length)return r(v,A),Nr&&tl(v,P),D;if(A===null){for(;P<_.length;P++)A=m(v,_[P],E),A!==null&&(b=i(A,b,P),I===null?D=A:I.sibling=A,I=A);return Nr&&tl(v,P),D}for(A=n(v,A);P<_.length;P++)C=h(A,v,P,_[P],E),C!==null&&(e&&C.alternate!==null&&A.delete(C.key===null?P:C.key),b=i(C,b,P),I===null?D=C:I.sibling=C,I=C);return e&&A.forEach(function(j){return t(v,j)}),Nr&&tl(v,P),D}function g(v,b,_,E){var D=Ku(_);if(typeof D!="function")throw Error(Ge(150));if(_=D.call(_),_==null)throw Error(Ge(151));for(var I=D=null,A=b,P=b=0,C=null,M=_.next();A!==null&&!M.done;P++,M=_.next()){A.index>P?(C=A,A=null):C=A.sibling;var j=p(v,A,M.value,E);if(j===null){A===null&&(A=C);break}e&&A&&j.alternate===null&&t(v,A),b=i(j,b,P),I===null?D=j:I.sibling=j,I=j,A=C}if(M.done)return r(v,A),Nr&&tl(v,P),D;if(A===null){for(;!M.done;P++,M=_.next())M=m(v,M.value,E),M!==null&&(b=i(M,b,P),I===null?D=M:I.sibling=M,I=M);return Nr&&tl(v,P),D}for(A=n(v,A);!M.done;P++,M=_.next())M=h(A,v,P,M.value,E),M!==null&&(e&&M.alternate!==null&&A.delete(M.key===null?P:M.key),b=i(M,b,P),I===null?D=M:I.sibling=M,I=M);return e&&A.forEach(function(T){return t(v,T)}),Nr&&tl(v,P),D}function w(v,b,_,E){if(typeof _=="object"&&_!==null&&_.type===kc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case _h:e:{for(var D=_.key,I=b;I!==null;){if(I.key===D){if(D=_.type,D===kc){if(I.tag===7){r(v,I.sibling),b=s(I,_.props.children),b.return=v,v=b;break e}}else if(I.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===eo&&Uv(D)===I.type){r(v,I.sibling),b=s(I,_.props),b.ref=ed(v,I,_),b.return=v,v=b;break e}r(v,I);break}else t(v,I);I=I.sibling}_.type===kc?(b=hl(_.props.children,v.mode,E,_.key),b.return=v,v=b):(E=m0(_.type,_.key,_.props,null,v.mode,E),E.ref=ed(v,b,_),E.return=v,v=E)}return a(v);case Sc:e:{for(I=_.key;b!==null;){if(b.key===I)if(b.tag===4&&b.stateNode.containerInfo===_.containerInfo&&b.stateNode.implementation===_.implementation){r(v,b.sibling),b=s(b,_.children||[]),b.return=v,v=b;break e}else{r(v,b);break}else t(v,b);b=b.sibling}b=Zp(_,v.mode,E),b.return=v,v=b}return a(v);case eo:return I=_._init,w(v,b,I(_._payload),E)}if(fd(_))return y(v,b,_,E);if(Ku(_))return g(v,b,_,E);Fh(v,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,b!==null&&b.tag===6?(r(v,b.sibling),b=s(b,_),b.return=v,v=b):(r(v,b),b=Qp(_,v.mode,E),b.return=v,v=b),a(v)):r(v,b)}return w}var Zc=xb(!0),vb=xb(!1),A0=Ro(null),T0=null,Fc=null,_x=null;function Nx(){_x=Fc=T0=null}function Sx(e){var t=A0.current;br(A0),e._currentValue=t}function ag(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Hc(e,t){T0=e,_x=Fc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ds=!0),e.firstContext=null)}function ni(e){var t=e._currentValue;if(_x!==e)if(e={context:e,memoizedValue:t,next:null},Fc===null){if(T0===null)throw Error(Ge(308));Fc=e,T0.dependencies={lanes:0,firstContext:e}}else Fc=Fc.next=e;return t}var cl=null;function kx(e){cl===null?cl=[e]:cl.push(e)}function yb(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,kx(t)):(r.next=s.next,s.next=r),t.interleaved=r,ka(e,n)}function ka(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var to=!1;function jx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wb(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ya(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vo(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Wt&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ka(e,r)}return s=n.interleaved,s===null?(t.next=t,kx(n)):(t.next=s.next,s.next=t),n.interleaved=t,ka(e,r)}function l0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dx(e,r)}}function zv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function C0(e,t,r,n){var s=e.updateQueue;to=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;a=0,d=u=c=null,l=i;do{var p=l.lane,h=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,g=l;switch(p=t,h=r,g.tag){case 1:if(y=g.payload,typeof y=="function"){m=y.call(h,m,p);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,p=typeof y=="function"?y.call(h,m,p):y,p==null)break e;m=Er({},m,p);break e;case 2:to=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=m):d=d.next=h,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Sl|=a,e.lanes=a,e.memoizedState=m}}function Wv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ge(191,s));s.call(n)}}}var Nf={},Xi=Ro(Nf),Qd=Ro(Nf),Zd=Ro(Nf);function ul(e){if(e===Nf)throw Error(Ge(174));return e}function Ex(e,t){switch(pr(Zd,t),pr(Qd,e),pr(Xi,Nf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:U1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=U1(t,e)}br(Xi),pr(Xi,t)}function eu(){br(Xi),br(Qd),br(Zd)}function bb(e){ul(Zd.current);var t=ul(Xi.current),r=U1(t,e.type);t!==r&&(pr(Qd,e),pr(Xi,r))}function Ax(e){Qd.current===e&&(br(Xi),br(Qd))}var kr=Ro(0);function P0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vp=[];function Tx(){for(var e=0;e<Vp.length;e++)Vp[e]._workInProgressVersionPrimary=null;Vp.length=0}var c0=Pa.ReactCurrentDispatcher,Gp=Pa.ReactCurrentBatchConfig,Nl=0,jr=null,on=null,mn=null,L0=!1,Nd=!1,ef=0,J6=0;function Fn(){throw Error(Ge(321))}function Cx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ci(e[r],t[r]))return!1;return!0}function Px(e,t,r,n,s,i){if(Nl=i,jr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,c0.current=e===null||e.memoizedState===null?tk:rk,e=r(n,s),Nd){i=0;do{if(Nd=!1,ef=0,25<=i)throw Error(Ge(301));i+=1,mn=on=null,t.updateQueue=null,c0.current=nk,e=r(n,s)}while(Nd)}if(c0.current=F0,t=on!==null&&on.next!==null,Nl=0,mn=on=jr=null,L0=!1,t)throw Error(Ge(300));return e}function Lx(){var e=ef!==0;return ef=0,e}function Vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mn===null?jr.memoizedState=mn=e:mn=mn.next=e,mn}function si(){if(on===null){var e=jr.alternate;e=e!==null?e.memoizedState:null}else e=on.next;var t=mn===null?jr.memoizedState:mn.next;if(t!==null)mn=t,on=e;else{if(e===null)throw Error(Ge(310));on=e,e={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},mn===null?jr.memoizedState=mn=e:mn=mn.next=e}return mn}function tf(e,t){return typeof t=="function"?t(e):t}function Yp(e){var t=si(),r=t.queue;if(r===null)throw Error(Ge(311));r.lastRenderedReducer=e;var n=on,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,c=null,u=i;do{var d=u.lane;if((Nl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,a=n):c=c.next=m,jr.lanes|=d,Sl|=d}u=u.next}while(u!==null&&u!==i);c===null?a=n:c.next=l,Ci(n,t.memoizedState)||(ds=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,jr.lanes|=i,Sl|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Kp(e){var t=si(),r=t.queue;if(r===null)throw Error(Ge(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Ci(i,t.memoizedState)||(ds=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function _b(){}function Nb(e,t){var r=jr,n=si(),s=t(),i=!Ci(n.memoizedState,s);if(i&&(n.memoizedState=s,ds=!0),n=n.queue,Fx(jb.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||mn!==null&&mn.memoizedState.tag&1){if(r.flags|=2048,rf(9,kb.bind(null,r,n,s,t),void 0,null),vn===null)throw Error(Ge(349));Nl&30||Sb(r,t,s)}return s}function Sb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=jr.updateQueue,t===null?(t={lastEffect:null,stores:null},jr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function kb(e,t,r,n){t.value=r,t.getSnapshot=n,Eb(t)&&Ab(e)}function jb(e,t,r){return r(function(){Eb(t)&&Ab(e)})}function Eb(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ci(e,r)}catch{return!0}}function Ab(e){var t=ka(e,1);t!==null&&Ai(t,e,1,-1)}function Hv(e){var t=Vi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tf,lastRenderedState:e},t.queue=e,e=e.dispatch=ek.bind(null,jr,e),[t.memoizedState,e]}function rf(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=jr.updateQueue,t===null?(t={lastEffect:null,stores:null},jr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Tb(){return si().memoizedState}function u0(e,t,r,n){var s=Vi();jr.flags|=e,s.memoizedState=rf(1|t,r,void 0,n===void 0?null:n)}function fm(e,t,r,n){var s=si();n=n===void 0?null:n;var i=void 0;if(on!==null){var a=on.memoizedState;if(i=a.destroy,n!==null&&Cx(n,a.deps)){s.memoizedState=rf(t,r,i,n);return}}jr.flags|=e,s.memoizedState=rf(1|t,r,i,n)}function $v(e,t){return u0(8390656,8,e,t)}function Fx(e,t){return fm(2048,8,e,t)}function Cb(e,t){return fm(4,2,e,t)}function Pb(e,t){return fm(4,4,e,t)}function Lb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Fb(e,t,r){return r=r!=null?r.concat([e]):null,fm(4,4,Lb.bind(null,t,e),r)}function Ox(){}function Ob(e,t){var r=si();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Cx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Db(e,t){var r=si();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Cx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ib(e,t,r){return Nl&21?(Ci(r,t)||(r=zw(),jr.lanes|=r,Sl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ds=!0),e.memoizedState=r)}function Q6(e,t){var r=nr;nr=r!==0&&4>r?r:4,e(!0);var n=Gp.transition;Gp.transition={};try{e(!1),t()}finally{nr=r,Gp.transition=n}}function Rb(){return si().memoizedState}function Z6(e,t,r){var n=wo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Mb(e))Bb(t,r);else if(r=yb(e,t,r,n),r!==null){var s=Jn();Ai(r,e,n,s),Ub(r,t,n)}}function ek(e,t,r){var n=wo(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Mb(e))Bb(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,Ci(l,a)){var c=t.interleaved;c===null?(s.next=s,kx(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=yb(e,t,s,n),r!==null&&(s=Jn(),Ai(r,e,n,s),Ub(r,t,n))}}function Mb(e){var t=e.alternate;return e===jr||t!==null&&t===jr}function Bb(e,t){Nd=L0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Ub(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dx(e,r)}}var F0={readContext:ni,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useInsertionEffect:Fn,useLayoutEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useMutableSource:Fn,useSyncExternalStore:Fn,useId:Fn,unstable_isNewReconciler:!1},tk={readContext:ni,useCallback:function(e,t){return Vi().memoizedState=[e,t===void 0?null:t],e},useContext:ni,useEffect:$v,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,u0(4194308,4,Lb.bind(null,t,e),r)},useLayoutEffect:function(e,t){return u0(4194308,4,e,t)},useInsertionEffect:function(e,t){return u0(4,2,e,t)},useMemo:function(e,t){var r=Vi();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Vi();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Z6.bind(null,jr,e),[n.memoizedState,e]},useRef:function(e){var t=Vi();return e={current:e},t.memoizedState=e},useState:Hv,useDebugValue:Ox,useDeferredValue:function(e){return Vi().memoizedState=e},useTransition:function(){var e=Hv(!1),t=e[0];return e=Q6.bind(null,e[1]),Vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=jr,s=Vi();if(Nr){if(r===void 0)throw Error(Ge(407));r=r()}else{if(r=t(),vn===null)throw Error(Ge(349));Nl&30||Sb(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,$v(jb.bind(null,n,i,e),[e]),n.flags|=2048,rf(9,kb.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Vi(),t=vn.identifierPrefix;if(Nr){var r=va,n=xa;r=(n&~(1<<32-Ei(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ef++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=J6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},rk={readContext:ni,useCallback:Ob,useContext:ni,useEffect:Fx,useImperativeHandle:Fb,useInsertionEffect:Cb,useLayoutEffect:Pb,useMemo:Db,useReducer:Yp,useRef:Tb,useState:function(){return Yp(tf)},useDebugValue:Ox,useDeferredValue:function(e){var t=si();return Ib(t,on.memoizedState,e)},useTransition:function(){var e=Yp(tf)[0],t=si().memoizedState;return[e,t]},useMutableSource:_b,useSyncExternalStore:Nb,useId:Rb,unstable_isNewReconciler:!1},nk={readContext:ni,useCallback:Ob,useContext:ni,useEffect:Fx,useImperativeHandle:Fb,useInsertionEffect:Cb,useLayoutEffect:Pb,useMemo:Db,useReducer:Kp,useRef:Tb,useState:function(){return Kp(tf)},useDebugValue:Ox,useDeferredValue:function(e){var t=si();return on===null?t.memoizedState=e:Ib(t,on.memoizedState,e)},useTransition:function(){var e=Kp(tf)[0],t=si().memoizedState;return[e,t]},useMutableSource:_b,useSyncExternalStore:Nb,useId:Rb,unstable_isNewReconciler:!1};function yi(e,t){if(e&&e.defaultProps){t=Er({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function og(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Er({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var hm={isMounted:function(e){return(e=e._reactInternals)?Ll(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jn(),s=wo(e),i=ya(n,s);i.payload=t,r!=null&&(i.callback=r),t=vo(e,i,s),t!==null&&(Ai(t,e,s,n),l0(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jn(),s=wo(e),i=ya(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=vo(e,i,s),t!==null&&(Ai(t,e,s,n),l0(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jn(),n=wo(e),s=ya(r,n);s.tag=2,t!=null&&(s.callback=t),t=vo(e,s,n),t!==null&&(Ai(t,e,n,r),l0(t,e,n))}};function qv(e,t,r,n,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,a):t.prototype&&t.prototype.isPureReactComponent?!Yd(r,n)||!Yd(s,i):!0}function zb(e,t,r){var n=!1,s=Eo,i=t.contextType;return typeof i=="object"&&i!==null?i=ni(i):(s=hs(t)?bl:Hn.current,n=t.contextTypes,i=(n=n!=null)?Jc(e,s):Eo),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=hm,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Vv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&hm.enqueueReplaceState(t,t.state,null)}function lg(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},jx(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=ni(i):(i=hs(t)?bl:Hn.current,s.context=Jc(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(og(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&hm.enqueueReplaceState(s,s.state,null),C0(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function tu(e,t){try{var r="",n=t;do r+=PS(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Xp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function cg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sk=typeof WeakMap=="function"?WeakMap:Map;function Wb(e,t,r){r=ya(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){D0||(D0=!0,yg=n),cg(e,t)},r}function Hb(e,t,r){r=ya(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){cg(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){cg(e,t),typeof n!="function"&&(yo===null?yo=new Set([this]):yo.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Gv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sk;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=vk.bind(null,e,t,r),t.then(e,e))}function Yv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Kv(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ya(-1,1),t.tag=2,vo(r,t,1))),r.lanes|=1),e)}var ik=Pa.ReactCurrentOwner,ds=!1;function Gn(e,t,r,n){t.child=e===null?vb(t,null,r,n):Zc(t,e.child,r,n)}function Xv(e,t,r,n,s){r=r.render;var i=t.ref;return Hc(t,s),n=Px(e,t,r,n,i,s),r=Lx(),e!==null&&!ds?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ja(e,t,s)):(Nr&&r&&yx(t),t.flags|=1,Gn(e,t,n,s),t.child)}function Jv(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!Wx(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,$b(e,t,i,n,s)):(e=m0(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Yd,r(a,n)&&e.ref===t.ref)return ja(e,t,s)}return t.flags|=1,e=bo(i,n),e.ref=t.ref,e.return=t,t.child=e}function $b(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Yd(i,n)&&e.ref===t.ref)if(ds=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(ds=!0);else return t.lanes=e.lanes,ja(e,t,s)}return ug(e,t,r,n,s)}function qb(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pr(Dc,As),As|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,pr(Dc,As),As|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,pr(Dc,As),As|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,pr(Dc,As),As|=n;return Gn(e,t,s,r),t.child}function Vb(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ug(e,t,r,n,s){var i=hs(r)?bl:Hn.current;return i=Jc(t,i),Hc(t,s),r=Px(e,t,r,n,i,s),n=Lx(),e!==null&&!ds?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ja(e,t,s)):(Nr&&n&&yx(t),t.flags|=1,Gn(e,t,r,s),t.child)}function Qv(e,t,r,n,s){if(hs(r)){var i=!0;k0(t)}else i=!1;if(Hc(t,s),t.stateNode===null)d0(e,t),zb(t,r,n),lg(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=ni(u):(u=hs(r)?bl:Hn.current,u=Jc(t,u));var d=r.getDerivedStateFromProps,m=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==u)&&Vv(t,a,n,u),to=!1;var p=t.memoizedState;a.state=p,C0(t,n,a,s),c=t.memoizedState,l!==n||p!==c||fs.current||to?(typeof d=="function"&&(og(t,r,d,n),c=t.memoizedState),(l=to||qv(t,r,l,n,p,c,u))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=u,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,wb(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:yi(t.type,l),a.props=u,m=t.pendingProps,p=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=ni(c):(c=hs(r)?bl:Hn.current,c=Jc(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==m||p!==c)&&Vv(t,a,n,c),to=!1,p=t.memoizedState,a.state=p,C0(t,n,a,s);var y=t.memoizedState;l!==m||p!==y||fs.current||to?(typeof h=="function"&&(og(t,r,h,n),y=t.memoizedState),(u=to||qv(t,r,u,n,p,y,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),a.props=n,a.state=y,a.context=c,n=u):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return dg(e,t,r,n,i,s)}function dg(e,t,r,n,s,i){Vb(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&Rv(t,r,!1),ja(e,t,i);n=t.stateNode,ik.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Zc(t,e.child,null,i),t.child=Zc(t,null,l,i)):Gn(e,t,l,i),t.memoizedState=n.state,s&&Rv(t,r,!0),t.child}function Gb(e){var t=e.stateNode;t.pendingContext?Iv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Iv(e,t.context,!1),Ex(e,t.containerInfo)}function Zv(e,t,r,n,s){return Qc(),bx(s),t.flags|=256,Gn(e,t,r,n),t.child}var fg={dehydrated:null,treeContext:null,retryLane:0};function hg(e){return{baseLanes:e,cachePool:null,transitions:null}}function Yb(e,t,r){var n=t.pendingProps,s=kr.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),pr(kr,s&1),e===null)return ig(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,i?(n=t.mode,i=t.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=gm(a,n,0,null),e=hl(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=hg(r),t.memoizedState=fg,e):Dx(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return ak(e,t,a,n,l,s,r);if(i){i=n.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=bo(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=bo(l,i):(i=hl(i,a,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,a=e.child.memoizedState,a=a===null?hg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,t.memoizedState=fg,n}return i=e.child,e=i.sibling,n=bo(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Dx(e,t){return t=gm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Oh(e,t,r,n){return n!==null&&bx(n),Zc(t,e.child,null,r),e=Dx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ak(e,t,r,n,s,i,a){if(r)return t.flags&256?(t.flags&=-257,n=Xp(Error(Ge(422))),Oh(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=gm({mode:"visible",children:n.children},s,0,null),i=hl(i,s,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Zc(t,e.child,null,a),t.child.memoizedState=hg(a),t.memoizedState=fg,i);if(!(t.mode&1))return Oh(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Ge(419)),n=Xp(i,n,void 0),Oh(e,t,a,n)}if(l=(a&e.childLanes)!==0,ds||l){if(n=vn,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ka(e,s),Ai(n,e,s,-1))}return zx(),n=Xp(Error(Ge(421))),Oh(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=yk.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Ls=xo(s.nextSibling),Os=t,Nr=!0,Ni=null,e!==null&&(Qs[Zs++]=xa,Qs[Zs++]=va,Qs[Zs++]=_l,xa=e.id,va=e.overflow,_l=t),t=Dx(t,n.children),t.flags|=4096,t)}function ey(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ag(e.return,t,r)}function Jp(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Kb(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Gn(e,t,n.children,r),n=kr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ey(e,r,t);else if(e.tag===19)ey(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(pr(kr,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&P0(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Jp(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&P0(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Jp(t,!0,r,null,i);break;case"together":Jp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function d0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ja(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ge(153));if(t.child!==null){for(e=t.child,r=bo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=bo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ok(e,t,r){switch(t.tag){case 3:Gb(t),Qc();break;case 5:bb(t);break;case 1:hs(t.type)&&k0(t);break;case 4:Ex(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;pr(A0,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(pr(kr,kr.current&1),t.flags|=128,null):r&t.child.childLanes?Yb(e,t,r):(pr(kr,kr.current&1),e=ja(e,t,r),e!==null?e.sibling:null);pr(kr,kr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Kb(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),pr(kr,kr.current),n)break;return null;case 22:case 23:return t.lanes=0,qb(e,t,r)}return ja(e,t,r)}var Xb,mg,Jb,Qb;Xb=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};mg=function(){};Jb=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,ul(Xi.current);var i=null;switch(r){case"input":s=I1(e,s),n=I1(e,n),i=[];break;case"select":s=Er({},s,{value:void 0}),n=Er({},n,{value:void 0}),i=[];break;case"textarea":s=B1(e,s),n=B1(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=N0)}z1(r,n);var a;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(zd.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(zd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&vr("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};Qb=function(e,t,r,n){r!==n&&(t.flags|=4)};function td(e,t){if(!Nr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function On(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function lk(e,t,r){var n=t.pendingProps;switch(wx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(t),null;case 1:return hs(t.type)&&S0(),On(t),null;case 3:return n=t.stateNode,eu(),br(fs),br(Hn),Tx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Lh(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ni!==null&&(_g(Ni),Ni=null))),mg(e,t),On(t),null;case 5:Ax(t);var s=ul(Zd.current);if(r=t.type,e!==null&&t.stateNode!=null)Jb(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ge(166));return On(t),null}if(e=ul(Xi.current),Lh(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Gi]=t,n[Jd]=i,e=(t.mode&1)!==0,r){case"dialog":vr("cancel",n),vr("close",n);break;case"iframe":case"object":case"embed":vr("load",n);break;case"video":case"audio":for(s=0;s<md.length;s++)vr(md[s],n);break;case"source":vr("error",n);break;case"img":case"image":case"link":vr("error",n),vr("load",n);break;case"details":vr("toggle",n);break;case"input":cv(n,i),vr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},vr("invalid",n);break;case"textarea":dv(n,i),vr("invalid",n)}z1(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ph(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ph(n.textContent,l,e),s=["children",""+l]):zd.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&vr("scroll",n)}switch(r){case"input":Nh(n),uv(n,i,!0);break;case"textarea":Nh(n),fv(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=N0)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=jw(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Gi]=t,e[Jd]=n,Xb(e,t,!1,!1),t.stateNode=e;e:{switch(a=W1(r,n),r){case"dialog":vr("cancel",e),vr("close",e),s=n;break;case"iframe":case"object":case"embed":vr("load",e),s=n;break;case"video":case"audio":for(s=0;s<md.length;s++)vr(md[s],e);s=n;break;case"source":vr("error",e),s=n;break;case"img":case"image":case"link":vr("error",e),vr("load",e),s=n;break;case"details":vr("toggle",e),s=n;break;case"input":cv(e,n),s=I1(e,n),vr("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Er({},n,{value:void 0}),vr("invalid",e);break;case"textarea":dv(e,n),s=B1(e,n),vr("invalid",e);break;default:s=n}z1(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Tw(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ew(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Wd(e,c):typeof c=="number"&&Wd(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(zd.hasOwnProperty(i)?c!=null&&i==="onScroll"&&vr("scroll",e):c!=null&&ix(e,i,c,a))}switch(r){case"input":Nh(e),uv(e,n,!1);break;case"textarea":Nh(e),fv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+jo(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Bc(e,!!n.multiple,i,!1):n.defaultValue!=null&&Bc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=N0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return On(t),null;case 6:if(e&&t.stateNode!=null)Qb(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ge(166));if(r=ul(Zd.current),ul(Xi.current),Lh(t)){if(n=t.stateNode,r=t.memoizedProps,n[Gi]=t,(i=n.nodeValue!==r)&&(e=Os,e!==null))switch(e.tag){case 3:Ph(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ph(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gi]=t,t.stateNode=n}return On(t),null;case 13:if(br(kr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Nr&&Ls!==null&&t.mode&1&&!(t.flags&128))gb(),Qc(),t.flags|=98560,i=!1;else if(i=Lh(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Ge(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ge(317));i[Gi]=t}else Qc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;On(t),i=!1}else Ni!==null&&(_g(Ni),Ni=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||kr.current&1?cn===0&&(cn=3):zx())),t.updateQueue!==null&&(t.flags|=4),On(t),null);case 4:return eu(),mg(e,t),e===null&&Kd(t.stateNode.containerInfo),On(t),null;case 10:return Sx(t.type._context),On(t),null;case 17:return hs(t.type)&&S0(),On(t),null;case 19:if(br(kr),i=t.memoizedState,i===null)return On(t),null;if(n=(t.flags&128)!==0,a=i.rendering,a===null)if(n)td(i,!1);else{if(cn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=P0(e),a!==null){for(t.flags|=128,td(i,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return pr(kr,kr.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ur()>ru&&(t.flags|=128,n=!0,td(i,!1),t.lanes=4194304)}else{if(!n)if(e=P0(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),td(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Nr)return On(t),null}else 2*Ur()-i.renderingStartTime>ru&&r!==1073741824&&(t.flags|=128,n=!0,td(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(r=i.last,r!==null?r.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ur(),t.sibling=null,r=kr.current,pr(kr,n?r&1|2:r&1),t):(On(t),null);case 22:case 23:return Ux(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?As&1073741824&&(On(t),t.subtreeFlags&6&&(t.flags|=8192)):On(t),null;case 24:return null;case 25:return null}throw Error(Ge(156,t.tag))}function ck(e,t){switch(wx(t),t.tag){case 1:return hs(t.type)&&S0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return eu(),br(fs),br(Hn),Tx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ax(t),null;case 13:if(br(kr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ge(340));Qc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return br(kr),null;case 4:return eu(),null;case 10:return Sx(t.type._context),null;case 22:case 23:return Ux(),null;case 24:return null;default:return null}}var Dh=!1,Bn=!1,uk=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Oc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Fr(e,t,n)}else r.current=null}function pg(e,t,r){try{r()}catch(n){Fr(e,t,n)}}var ty=!1;function dk(e,t){if(Q1=w0,e=nb(),vx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,u=0,d=0,m=e,p=null;t:for(;;){for(var h;m!==r||s!==0&&m.nodeType!==3||(l=a+s),m!==i||n!==0&&m.nodeType!==3||(c=a+n),m.nodeType===3&&(a+=m.nodeValue.length),(h=m.firstChild)!==null;)p=m,m=h;for(;;){if(m===e)break t;if(p===r&&++u===s&&(l=a),p===i&&++d===n&&(c=a),(h=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Z1={focusedElem:e,selectionRange:r},w0=!1,ct=t;ct!==null;)if(t=ct,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ct=e;else for(;ct!==null;){t=ct;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,w=y.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:yi(t.type,g),w);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ge(163))}}catch(E){Fr(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,ct=e;break}ct=t.return}return y=ty,ty=!1,y}function Sd(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&pg(t,r,i)}s=s.next}while(s!==n)}}function mm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function gg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Zb(e){var t=e.alternate;t!==null&&(e.alternate=null,Zb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gi],delete t[Jd],delete t[rg],delete t[G6],delete t[Y6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function e4(e){return e.tag===5||e.tag===3||e.tag===4}function ry(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||e4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=N0));else if(n!==4&&(e=e.child,e!==null))for(xg(e,t,r),e=e.sibling;e!==null;)xg(e,t,r),e=e.sibling}function vg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(vg(e,t,r),e=e.sibling;e!==null;)vg(e,t,r),e=e.sibling}var _n=null,bi=!1;function Ga(e,t,r){for(r=r.child;r!==null;)t4(e,t,r),r=r.sibling}function t4(e,t,r){if(Ki&&typeof Ki.onCommitFiberUnmount=="function")try{Ki.onCommitFiberUnmount(am,r)}catch{}switch(r.tag){case 5:Bn||Oc(r,t);case 6:var n=_n,s=bi;_n=null,Ga(e,t,r),_n=n,bi=s,_n!==null&&(bi?(e=_n,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):_n.removeChild(r.stateNode));break;case 18:_n!==null&&(bi?(e=_n,r=r.stateNode,e.nodeType===8?$p(e.parentNode,r):e.nodeType===1&&$p(e,r),Vd(e)):$p(_n,r.stateNode));break;case 4:n=_n,s=bi,_n=r.stateNode.containerInfo,bi=!0,Ga(e,t,r),_n=n,bi=s;break;case 0:case 11:case 14:case 15:if(!Bn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&pg(r,t,a),s=s.next}while(s!==n)}Ga(e,t,r);break;case 1:if(!Bn&&(Oc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Fr(r,t,l)}Ga(e,t,r);break;case 21:Ga(e,t,r);break;case 22:r.mode&1?(Bn=(n=Bn)||r.memoizedState!==null,Ga(e,t,r),Bn=n):Ga(e,t,r);break;default:Ga(e,t,r)}}function ny(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new uk),t.forEach(function(n){var s=wk.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function mi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:_n=l.stateNode,bi=!1;break e;case 3:_n=l.stateNode.containerInfo,bi=!0;break e;case 4:_n=l.stateNode.containerInfo,bi=!0;break e}l=l.return}if(_n===null)throw Error(Ge(160));t4(i,a,s),_n=null,bi=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Fr(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)r4(t,e),t=t.sibling}function r4(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mi(t,e),zi(e),n&4){try{Sd(3,e,e.return),mm(3,e)}catch(g){Fr(e,e.return,g)}try{Sd(5,e,e.return)}catch(g){Fr(e,e.return,g)}}break;case 1:mi(t,e),zi(e),n&512&&r!==null&&Oc(r,r.return);break;case 5:if(mi(t,e),zi(e),n&512&&r!==null&&Oc(r,r.return),e.flags&32){var s=e.stateNode;try{Wd(s,"")}catch(g){Fr(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Sw(s,i),W1(l,a);var u=W1(l,i);for(a=0;a<c.length;a+=2){var d=c[a],m=c[a+1];d==="style"?Tw(s,m):d==="dangerouslySetInnerHTML"?Ew(s,m):d==="children"?Wd(s,m):ix(s,d,m,u)}switch(l){case"input":R1(s,i);break;case"textarea":kw(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Bc(s,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?Bc(s,!!i.multiple,i.defaultValue,!0):Bc(s,!!i.multiple,i.multiple?[]:"",!1))}s[Jd]=i}catch(g){Fr(e,e.return,g)}}break;case 6:if(mi(t,e),zi(e),n&4){if(e.stateNode===null)throw Error(Ge(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){Fr(e,e.return,g)}}break;case 3:if(mi(t,e),zi(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vd(t.containerInfo)}catch(g){Fr(e,e.return,g)}break;case 4:mi(t,e),zi(e);break;case 13:mi(t,e),zi(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Mx=Ur())),n&4&&ny(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Bn=(u=Bn)||d,mi(t,e),Bn=u):mi(t,e),zi(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ct=e,d=e.child;d!==null;){for(m=ct=d;ct!==null;){switch(p=ct,h=p.child,p.tag){case 0:case 11:case 14:case 15:Sd(4,p,p.return);break;case 1:Oc(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(g){Fr(n,r,g)}}break;case 5:Oc(p,p.return);break;case 22:if(p.memoizedState!==null){iy(m);continue}}h!==null?(h.return=p,ct=h):iy(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Aw("display",a))}catch(g){Fr(e,e.return,g)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(g){Fr(e,e.return,g)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:mi(t,e),zi(e),n&4&&ny(e);break;case 21:break;default:mi(t,e),zi(e)}}function zi(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(e4(r)){var n=r;break e}r=r.return}throw Error(Ge(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Wd(s,""),n.flags&=-33);var i=ry(e);vg(e,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=ry(e);xg(e,l,a);break;default:throw Error(Ge(161))}}catch(c){Fr(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function fk(e,t,r){ct=e,n4(e)}function n4(e,t,r){for(var n=(e.mode&1)!==0;ct!==null;){var s=ct,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Dh;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Bn;l=Dh;var u=Bn;if(Dh=a,(Bn=c)&&!u)for(ct=s;ct!==null;)a=ct,c=a.child,a.tag===22&&a.memoizedState!==null?ay(s):c!==null?(c.return=a,ct=c):ay(s);for(;i!==null;)ct=i,n4(i),i=i.sibling;ct=s,Dh=l,Bn=u}sy(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ct=i):sy(e)}}function sy(e){for(;ct!==null;){var t=ct;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Bn||mm(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Bn)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:yi(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Wv(t,i,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Wv(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Vd(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ge(163))}Bn||t.flags&512&&gg(t)}catch(p){Fr(t,t.return,p)}}if(t===e){ct=null;break}if(r=t.sibling,r!==null){r.return=t.return,ct=r;break}ct=t.return}}function iy(e){for(;ct!==null;){var t=ct;if(t===e){ct=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ct=r;break}ct=t.return}}function ay(e){for(;ct!==null;){var t=ct;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{mm(4,t)}catch(c){Fr(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Fr(t,s,c)}}var i=t.return;try{gg(t)}catch(c){Fr(t,i,c)}break;case 5:var a=t.return;try{gg(t)}catch(c){Fr(t,a,c)}}}catch(c){Fr(t,t.return,c)}if(t===e){ct=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ct=l;break}ct=t.return}}var hk=Math.ceil,O0=Pa.ReactCurrentDispatcher,Ix=Pa.ReactCurrentOwner,ri=Pa.ReactCurrentBatchConfig,Wt=0,vn=null,Xr=null,jn=0,As=0,Dc=Ro(0),cn=0,nf=null,Sl=0,pm=0,Rx=0,kd=null,cs=null,Mx=0,ru=1/0,ma=null,D0=!1,yg=null,yo=null,Ih=!1,lo=null,I0=0,jd=0,wg=null,f0=-1,h0=0;function Jn(){return Wt&6?Ur():f0!==-1?f0:f0=Ur()}function wo(e){return e.mode&1?Wt&2&&jn!==0?jn&-jn:X6.transition!==null?(h0===0&&(h0=zw()),h0):(e=nr,e!==0||(e=window.event,e=e===void 0?16:Yw(e.type)),e):1}function Ai(e,t,r,n){if(50<jd)throw jd=0,wg=null,Error(Ge(185));wf(e,r,n),(!(Wt&2)||e!==vn)&&(e===vn&&(!(Wt&2)&&(pm|=r),cn===4&&so(e,jn)),ms(e,n),r===1&&Wt===0&&!(t.mode&1)&&(ru=Ur()+500,dm&&Mo()))}function ms(e,t){var r=e.callbackNode;XS(e,t);var n=y0(e,e===vn?jn:0);if(n===0)r!==null&&pv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&pv(r),t===1)e.tag===0?K6(oy.bind(null,e)):hb(oy.bind(null,e)),q6(function(){!(Wt&6)&&Mo()}),r=null;else{switch(Ww(n)){case 1:r=ux;break;case 4:r=Bw;break;case 16:r=v0;break;case 536870912:r=Uw;break;default:r=v0}r=d4(r,s4.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function s4(e,t){if(f0=-1,h0=0,Wt&6)throw Error(Ge(327));var r=e.callbackNode;if($c()&&e.callbackNode!==r)return null;var n=y0(e,e===vn?jn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=R0(e,n);else{t=n;var s=Wt;Wt|=2;var i=a4();(vn!==e||jn!==t)&&(ma=null,ru=Ur()+500,fl(e,t));do try{gk();break}catch(l){i4(e,l)}while(!0);Nx(),O0.current=i,Wt=s,Xr!==null?t=0:(vn=null,jn=0,t=cn)}if(t!==0){if(t===2&&(s=G1(e),s!==0&&(n=s,t=bg(e,s))),t===1)throw r=nf,fl(e,0),so(e,n),ms(e,Ur()),r;if(t===6)so(e,n);else{if(s=e.current.alternate,!(n&30)&&!mk(s)&&(t=R0(e,n),t===2&&(i=G1(e),i!==0&&(n=i,t=bg(e,i))),t===1))throw r=nf,fl(e,0),so(e,n),ms(e,Ur()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Ge(345));case 2:rl(e,cs,ma);break;case 3:if(so(e,n),(n&130023424)===n&&(t=Mx+500-Ur(),10<t)){if(y0(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Jn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=tg(rl.bind(null,e,cs,ma),t);break}rl(e,cs,ma);break;case 4:if(so(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Ei(n);i=1<<a,a=t[a],a>s&&(s=a),n&=~i}if(n=s,n=Ur()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hk(n/1960))-n,10<n){e.timeoutHandle=tg(rl.bind(null,e,cs,ma),n);break}rl(e,cs,ma);break;case 5:rl(e,cs,ma);break;default:throw Error(Ge(329))}}}return ms(e,Ur()),e.callbackNode===r?s4.bind(null,e):null}function bg(e,t){var r=kd;return e.current.memoizedState.isDehydrated&&(fl(e,t).flags|=256),e=R0(e,t),e!==2&&(t=cs,cs=r,t!==null&&_g(t)),e}function _g(e){cs===null?cs=e:cs.push.apply(cs,e)}function mk(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ci(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function so(e,t){for(t&=~Rx,t&=~pm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ei(t),n=1<<r;e[r]=-1,t&=~n}}function oy(e){if(Wt&6)throw Error(Ge(327));$c();var t=y0(e,0);if(!(t&1))return ms(e,Ur()),null;var r=R0(e,t);if(e.tag!==0&&r===2){var n=G1(e);n!==0&&(t=n,r=bg(e,n))}if(r===1)throw r=nf,fl(e,0),so(e,t),ms(e,Ur()),r;if(r===6)throw Error(Ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,rl(e,cs,ma),ms(e,Ur()),null}function Bx(e,t){var r=Wt;Wt|=1;try{return e(t)}finally{Wt=r,Wt===0&&(ru=Ur()+500,dm&&Mo())}}function kl(e){lo!==null&&lo.tag===0&&!(Wt&6)&&$c();var t=Wt;Wt|=1;var r=ri.transition,n=nr;try{if(ri.transition=null,nr=1,e)return e()}finally{nr=n,ri.transition=r,Wt=t,!(Wt&6)&&Mo()}}function Ux(){As=Dc.current,br(Dc)}function fl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,$6(r)),Xr!==null)for(r=Xr.return;r!==null;){var n=r;switch(wx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&S0();break;case 3:eu(),br(fs),br(Hn),Tx();break;case 5:Ax(n);break;case 4:eu();break;case 13:br(kr);break;case 19:br(kr);break;case 10:Sx(n.type._context);break;case 22:case 23:Ux()}r=r.return}if(vn=e,Xr=e=bo(e.current,null),jn=As=t,cn=0,nf=null,Rx=pm=Sl=0,cs=kd=null,cl!==null){for(t=0;t<cl.length;t++)if(r=cl[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}cl=null}return e}function i4(e,t){do{var r=Xr;try{if(Nx(),c0.current=F0,L0){for(var n=jr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}L0=!1}if(Nl=0,mn=on=jr=null,Nd=!1,ef=0,Ix.current=null,r===null||r.return===null){cn=1,nf=t,Xr=null;break}e:{var i=e,a=r.return,l=r,c=t;if(t=jn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=Yv(a);if(h!==null){h.flags&=-257,Kv(h,a,l,i,t),h.mode&1&&Gv(i,u,t),t=h,c=u;var y=t.updateQueue;if(y===null){var g=new Set;g.add(c),t.updateQueue=g}else y.add(c);break e}else{if(!(t&1)){Gv(i,u,t),zx();break e}c=Error(Ge(426))}}else if(Nr&&l.mode&1){var w=Yv(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Kv(w,a,l,i,t),bx(tu(c,l));break e}}i=c=tu(c,l),cn!==4&&(cn=2),kd===null?kd=[i]:kd.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=Wb(i,c,t);zv(i,v);break e;case 1:l=c;var b=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(yo===null||!yo.has(_)))){i.flags|=65536,t&=-t,i.lanes|=t;var E=Hb(i,l,t);zv(i,E);break e}}i=i.return}while(i!==null)}l4(r)}catch(D){t=D,Xr===r&&r!==null&&(Xr=r=r.return);continue}break}while(!0)}function a4(){var e=O0.current;return O0.current=F0,e===null?F0:e}function zx(){(cn===0||cn===3||cn===2)&&(cn=4),vn===null||!(Sl&268435455)&&!(pm&268435455)||so(vn,jn)}function R0(e,t){var r=Wt;Wt|=2;var n=a4();(vn!==e||jn!==t)&&(ma=null,fl(e,t));do try{pk();break}catch(s){i4(e,s)}while(!0);if(Nx(),Wt=r,O0.current=n,Xr!==null)throw Error(Ge(261));return vn=null,jn=0,cn}function pk(){for(;Xr!==null;)o4(Xr)}function gk(){for(;Xr!==null&&!zS();)o4(Xr)}function o4(e){var t=u4(e.alternate,e,As);e.memoizedProps=e.pendingProps,t===null?l4(e):Xr=t,Ix.current=null}function l4(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=ck(r,t),r!==null){r.flags&=32767,Xr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cn=6,Xr=null;return}}else if(r=lk(r,t,As),r!==null){Xr=r;return}if(t=t.sibling,t!==null){Xr=t;return}Xr=t=e}while(t!==null);cn===0&&(cn=5)}function rl(e,t,r){var n=nr,s=ri.transition;try{ri.transition=null,nr=1,xk(e,t,r,n)}finally{ri.transition=s,nr=n}return null}function xk(e,t,r,n){do $c();while(lo!==null);if(Wt&6)throw Error(Ge(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ge(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(JS(e,i),e===vn&&(Xr=vn=null,jn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ih||(Ih=!0,d4(v0,function(){return $c(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ri.transition,ri.transition=null;var a=nr;nr=1;var l=Wt;Wt|=4,Ix.current=null,dk(e,r),r4(r,e),R6(Z1),w0=!!Q1,Z1=Q1=null,e.current=r,fk(r),WS(),Wt=l,nr=a,ri.transition=i}else e.current=r;if(Ih&&(Ih=!1,lo=e,I0=s),i=e.pendingLanes,i===0&&(yo=null),qS(r.stateNode),ms(e,Ur()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(D0)throw D0=!1,e=yg,yg=null,e;return I0&1&&e.tag!==0&&$c(),i=e.pendingLanes,i&1?e===wg?jd++:(jd=0,wg=e):jd=0,Mo(),null}function $c(){if(lo!==null){var e=Ww(I0),t=ri.transition,r=nr;try{if(ri.transition=null,nr=16>e?16:e,lo===null)var n=!1;else{if(e=lo,lo=null,I0=0,Wt&6)throw Error(Ge(331));var s=Wt;for(Wt|=4,ct=e.current;ct!==null;){var i=ct,a=i.child;if(ct.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ct=u;ct!==null;){var d=ct;switch(d.tag){case 0:case 11:case 15:Sd(8,d,i)}var m=d.child;if(m!==null)m.return=d,ct=m;else for(;ct!==null;){d=ct;var p=d.sibling,h=d.return;if(Zb(d),d===u){ct=null;break}if(p!==null){p.return=h,ct=p;break}ct=h}}}var y=i.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}ct=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ct=a;else e:for(;ct!==null;){if(i=ct,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Sd(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ct=v;break e}ct=i.return}}var b=e.current;for(ct=b;ct!==null;){a=ct;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,ct=_;else e:for(a=b;ct!==null;){if(l=ct,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:mm(9,l)}}catch(D){Fr(l,l.return,D)}if(l===a){ct=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,ct=E;break e}ct=l.return}}if(Wt=s,Mo(),Ki&&typeof Ki.onPostCommitFiberRoot=="function")try{Ki.onPostCommitFiberRoot(am,e)}catch{}n=!0}return n}finally{nr=r,ri.transition=t}}return!1}function ly(e,t,r){t=tu(r,t),t=Wb(e,t,1),e=vo(e,t,1),t=Jn(),e!==null&&(wf(e,1,t),ms(e,t))}function Fr(e,t,r){if(e.tag===3)ly(e,e,r);else for(;t!==null;){if(t.tag===3){ly(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(yo===null||!yo.has(n))){e=tu(r,e),e=Hb(t,e,1),t=vo(t,e,1),e=Jn(),t!==null&&(wf(t,1,e),ms(t,e));break}}t=t.return}}function vk(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jn(),e.pingedLanes|=e.suspendedLanes&r,vn===e&&(jn&r)===r&&(cn===4||cn===3&&(jn&130023424)===jn&&500>Ur()-Mx?fl(e,0):Rx|=r),ms(e,t)}function c4(e,t){t===0&&(e.mode&1?(t=jh,jh<<=1,!(jh&130023424)&&(jh=4194304)):t=1);var r=Jn();e=ka(e,t),e!==null&&(wf(e,t,r),ms(e,r))}function yk(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),c4(e,r)}function wk(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ge(314))}n!==null&&n.delete(t),c4(e,r)}var u4;u4=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||fs.current)ds=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ds=!1,ok(e,t,r);ds=!!(e.flags&131072)}else ds=!1,Nr&&t.flags&1048576&&mb(t,E0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;d0(e,t),e=t.pendingProps;var s=Jc(t,Hn.current);Hc(t,r),s=Px(null,t,n,e,s,r);var i=Lx();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,hs(n)?(i=!0,k0(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,jx(t),s.updater=hm,t.stateNode=s,s._reactInternals=t,lg(t,n,e,r),t=dg(null,t,n,!0,i,r)):(t.tag=0,Nr&&i&&yx(t),Gn(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(d0(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=_k(n),e=yi(n,e),s){case 0:t=ug(null,t,n,e,r);break e;case 1:t=Qv(null,t,n,e,r);break e;case 11:t=Xv(null,t,n,e,r);break e;case 14:t=Jv(null,t,n,yi(n.type,e),r);break e}throw Error(Ge(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yi(n,s),ug(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yi(n,s),Qv(e,t,n,s,r);case 3:e:{if(Gb(t),e===null)throw Error(Ge(387));n=t.pendingProps,i=t.memoizedState,s=i.element,wb(e,t),C0(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=tu(Error(Ge(423)),t),t=Zv(e,t,n,r,s);break e}else if(n!==s){s=tu(Error(Ge(424)),t),t=Zv(e,t,n,r,s);break e}else for(Ls=xo(t.stateNode.containerInfo.firstChild),Os=t,Nr=!0,Ni=null,r=vb(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Qc(),n===s){t=ja(e,t,r);break e}Gn(e,t,n,r)}t=t.child}return t;case 5:return bb(t),e===null&&ig(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,eg(n,s)?a=null:i!==null&&eg(n,i)&&(t.flags|=32),Vb(e,t),Gn(e,t,a,r),t.child;case 6:return e===null&&ig(t),null;case 13:return Yb(e,t,r);case 4:return Ex(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Zc(t,null,n,r):Gn(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yi(n,s),Xv(e,t,n,s,r);case 7:return Gn(e,t,t.pendingProps,r),t.child;case 8:return Gn(e,t,t.pendingProps.children,r),t.child;case 12:return Gn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,pr(A0,n._currentValue),n._currentValue=a,i!==null)if(Ci(i.value,a)){if(i.children===s.children&&!fs.current){t=ja(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=ya(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),ag(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Ge(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),ag(a,r,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Gn(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Hc(t,r),s=ni(s),n=n(s),t.flags|=1,Gn(e,t,n,r),t.child;case 14:return n=t.type,s=yi(n,t.pendingProps),s=yi(n.type,s),Jv(e,t,n,s,r);case 15:return $b(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yi(n,s),d0(e,t),t.tag=1,hs(n)?(e=!0,k0(t)):e=!1,Hc(t,r),zb(t,n,s),lg(t,n,s,r),dg(null,t,n,!0,e,r);case 19:return Kb(e,t,r);case 22:return qb(e,t,r)}throw Error(Ge(156,t.tag))};function d4(e,t){return Mw(e,t)}function bk(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(e,t,r,n){return new bk(e,t,r,n)}function Wx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _k(e){if(typeof e=="function")return Wx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ox)return 11;if(e===lx)return 14}return 2}function bo(e,t){var r=e.alternate;return r===null?(r=ei(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function m0(e,t,r,n,s,i){var a=2;if(n=e,typeof e=="function")Wx(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case kc:return hl(r.children,s,i,t);case ax:a=8,s|=8;break;case L1:return e=ei(12,r,t,s|2),e.elementType=L1,e.lanes=i,e;case F1:return e=ei(13,r,t,s),e.elementType=F1,e.lanes=i,e;case O1:return e=ei(19,r,t,s),e.elementType=O1,e.lanes=i,e;case bw:return gm(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yw:a=10;break e;case ww:a=9;break e;case ox:a=11;break e;case lx:a=14;break e;case eo:a=16,n=null;break e}throw Error(Ge(130,e==null?e:typeof e,""))}return t=ei(a,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function hl(e,t,r,n){return e=ei(7,e,n,t),e.lanes=r,e}function gm(e,t,r,n){return e=ei(22,e,n,t),e.elementType=bw,e.lanes=r,e.stateNode={isHidden:!1},e}function Qp(e,t,r){return e=ei(6,e,null,t),e.lanes=r,e}function Zp(e,t,r){return t=ei(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nk(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fp(0),this.expirationTimes=Fp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fp(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Hx(e,t,r,n,s,i,a,l,c){return e=new Nk(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ei(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},jx(i),e}function Sk(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sc,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function f4(e){if(!e)return Eo;e=e._reactInternals;e:{if(Ll(e)!==e||e.tag!==1)throw Error(Ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(hs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ge(171))}if(e.tag===1){var r=e.type;if(hs(r))return fb(e,r,t)}return t}function h4(e,t,r,n,s,i,a,l,c){return e=Hx(r,n,!0,e,s,i,a,l,c),e.context=f4(null),r=e.current,n=Jn(),s=wo(r),i=ya(n,s),i.callback=t??null,vo(r,i,s),e.current.lanes=s,wf(e,s,n),ms(e,n),e}function xm(e,t,r,n){var s=t.current,i=Jn(),a=wo(s);return r=f4(r),t.context===null?t.context=r:t.pendingContext=r,t=ya(i,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=vo(s,t,a),e!==null&&(Ai(e,s,a,i),l0(e,s,a)),a}function M0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function cy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function $x(e,t){cy(e,t),(e=e.alternate)&&cy(e,t)}function kk(){return null}var m4=typeof reportError=="function"?reportError:function(e){console.error(e)};function qx(e){this._internalRoot=e}vm.prototype.render=qx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ge(409));xm(e,t,null,null)};vm.prototype.unmount=qx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;kl(function(){xm(null,e,null,null)}),t[Sa]=null}};function vm(e){this._internalRoot=e}vm.prototype.unstable_scheduleHydration=function(e){if(e){var t=qw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<no.length&&t!==0&&t<no[r].priority;r++);no.splice(r,0,e),r===0&&Gw(e)}};function Vx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ym(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function uy(){}function jk(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=M0(a);i.call(u)}}var a=h4(t,n,e,0,null,!1,!1,"",uy);return e._reactRootContainer=a,e[Sa]=a.current,Kd(e.nodeType===8?e.parentNode:e),kl(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=M0(c);l.call(u)}}var c=Hx(e,0,!1,null,null,!1,!1,"",uy);return e._reactRootContainer=c,e[Sa]=c.current,Kd(e.nodeType===8?e.parentNode:e),kl(function(){xm(t,c,r,n)}),c}function wm(e,t,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=M0(a);l.call(c)}}xm(t,a,e,s)}else a=jk(r,t,e,s,n);return M0(a)}Hw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=hd(t.pendingLanes);r!==0&&(dx(t,r|1),ms(t,Ur()),!(Wt&6)&&(ru=Ur()+500,Mo()))}break;case 13:kl(function(){var n=ka(e,1);if(n!==null){var s=Jn();Ai(n,e,1,s)}}),$x(e,1)}};fx=function(e){if(e.tag===13){var t=ka(e,134217728);if(t!==null){var r=Jn();Ai(t,e,134217728,r)}$x(e,134217728)}};$w=function(e){if(e.tag===13){var t=wo(e),r=ka(e,t);if(r!==null){var n=Jn();Ai(r,e,t,n)}$x(e,t)}};qw=function(){return nr};Vw=function(e,t){var r=nr;try{return nr=e,t()}finally{nr=r}};$1=function(e,t,r){switch(t){case"input":if(R1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=um(n);if(!s)throw Error(Ge(90));Nw(n),R1(n,s)}}}break;case"textarea":kw(e,r);break;case"select":t=r.value,t!=null&&Bc(e,!!r.multiple,t,!1)}};Lw=Bx;Fw=kl;var Ek={usingClientEntryPoint:!1,Events:[_f,Tc,um,Cw,Pw,Bx]},rd={findFiberByHostInstance:ll,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ak={bundleType:rd.bundleType,version:rd.version,rendererPackageName:rd.rendererPackageName,rendererConfig:rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Iw(e),e===null?null:e.stateNode},findFiberByHostInstance:rd.findFiberByHostInstance||kk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rh.isDisabled&&Rh.supportsFiber)try{am=Rh.inject(Ak),Ki=Rh}catch{}}Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ek;Ms.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vx(t))throw Error(Ge(200));return Sk(e,t,null,r)};Ms.createRoot=function(e,t){if(!Vx(e))throw Error(Ge(299));var r=!1,n="",s=m4;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Hx(e,1,!1,null,null,r,!1,n,s),e[Sa]=t.current,Kd(e.nodeType===8?e.parentNode:e),new qx(t)};Ms.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ge(188)):(e=Object.keys(e).join(","),Error(Ge(268,e)));return e=Iw(t),e=e===null?null:e.stateNode,e};Ms.flushSync=function(e){return kl(e)};Ms.hydrate=function(e,t,r){if(!ym(t))throw Error(Ge(200));return wm(null,e,t,!0,r)};Ms.hydrateRoot=function(e,t,r){if(!Vx(e))throw Error(Ge(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=m4;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=h4(t,null,e,1,r??null,s,!1,i,a),e[Sa]=t.current,Kd(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new vm(t)};Ms.render=function(e,t,r){if(!ym(t))throw Error(Ge(200));return wm(null,e,t,!1,r)};Ms.unmountComponentAtNode=function(e){if(!ym(e))throw Error(Ge(40));return e._reactRootContainer?(kl(function(){wm(null,null,e,!1,function(){e._reactRootContainer=null,e[Sa]=null})}),!0):!1};Ms.unstable_batchedUpdates=Bx;Ms.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ym(r))throw Error(Ge(200));if(e==null||e._reactInternals===void 0)throw Error(Ge(38));return wm(e,t,r,!1,n)};Ms.version="18.3.1-next-f1338f8080-20240426";function p4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p4)}catch(e){console.error(e)}}p4(),pw.exports=Ms;var Tk=pw.exports,g4,dy=Tk;g4=dy.createRoot,dy.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sf(){return sf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sf.apply(this,arguments)}var co;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(co||(co={}));const fy="popstate";function Ck(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:a,hash:l}=n.location;return Ng("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:B0(s)}return Lk(t,r,null,e)}function $r(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function x4(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Pk(){return Math.random().toString(36).substr(2,8)}function hy(e,t){return{usr:e.state,key:e.key,idx:t}}function Ng(e,t,r,n){return r===void 0&&(r=null),sf({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?uu(t):t,{state:r,key:t&&t.key||n||Pk()})}function B0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function uu(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Lk(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,l=co.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(sf({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function m(){l=co.Pop;let w=d(),v=w==null?null:w-u;u=w,c&&c({action:l,location:g.location,delta:v})}function p(w,v){l=co.Push;let b=Ng(g.location,w,v);u=d()+1;let _=hy(b,u),E=g.createHref(b);try{a.pushState(_,"",E)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(E)}i&&c&&c({action:l,location:g.location,delta:1})}function h(w,v){l=co.Replace;let b=Ng(g.location,w,v);u=d();let _=hy(b,u),E=g.createHref(b);a.replaceState(_,"",E),i&&c&&c({action:l,location:g.location,delta:0})}function y(w){let v=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof w=="string"?w:B0(w);return b=b.replace(/ $/,"%20"),$r(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let g={get action(){return l},get location(){return e(s,a)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(fy,m),c=w,()=>{s.removeEventListener(fy,m),c=null}},createHref(w){return t(s,w)},createURL:y,encodeLocation(w){let v=y(w);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:h,go(w){return a.go(w)}};return g}var my;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(my||(my={}));function Fk(e,t,r){return r===void 0&&(r="/"),Ok(e,t,r)}function Ok(e,t,r,n){let s=typeof t=="string"?uu(t):t,i=Gx(s.pathname||"/",r);if(i==null)return null;let a=v4(e);Dk(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=Gk(i);l=$k(a[c],u)}return l}function v4(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&($r(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=_o([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&($r(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),v4(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:Wk(u,i.index),routesMeta:d})};return e.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let c of y4(i.path))s(i,a,c)}),t}function y4(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=y4(n.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function Dk(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Hk(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Ik=/^:[\w-]+$/,Rk=3,Mk=2,Bk=1,Uk=10,zk=-2,py=e=>e==="*";function Wk(e,t){let r=e.split("/"),n=r.length;return r.some(py)&&(n+=zk),t&&(n+=Mk),r.filter(s=>!py(s)).reduce((s,i)=>s+(Ik.test(i)?Rk:i===""?Bk:Uk),n)}function Hk(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function $k(e,t,r){let{routesMeta:n}=e,s={},i="/",a=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",m=qk({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!m)return null;Object.assign(s,m.params),a.push({params:s,pathname:_o([i,m.pathname]),pathnameBase:Jk(_o([i,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(i=_o([i,m.pathnameBase]))}return a}function qk(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Vk(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,d,m)=>{let{paramName:p,isOptional:h}=d;if(p==="*"){let g=l[m]||"";a=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const y=l[m];return h&&!y?u[p]=void 0:u[p]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:e}}function Vk(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),x4(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Gk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return x4(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Gx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Yk(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?uu(e):e;return{pathname:r?r.startsWith("/")?r:Kk(r,t):t,search:Qk(n),hash:Zk(s)}}function Kk(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function e1(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Xk(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Yx(e,t){let r=Xk(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Kx(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=uu(e):(s=sf({},e),$r(!s.pathname||!s.pathname.includes("?"),e1("?","pathname","search",s)),$r(!s.pathname||!s.pathname.includes("#"),e1("#","pathname","hash",s)),$r(!s.search||!s.search.includes("#"),e1("#","search","hash",s)));let i=e===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=r;else{let m=t.length-1;if(!n&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}l=m>=0?t[m]:"/"}let c=Yk(s,l),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const _o=e=>e.join("/").replace(/\/\/+/g,"/"),Jk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Qk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Zk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ej(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const w4=["post","put","patch","delete"];new Set(w4);const tj=["get",...w4];new Set(tj);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function af(){return af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},af.apply(this,arguments)}const Xx=he.createContext(null),rj=he.createContext(null),Bo=he.createContext(null),bm=he.createContext(null),ea=he.createContext({outlet:null,matches:[],isDataRoute:!1}),b4=he.createContext(null);function nj(e,t){let{relative:r}=t===void 0?{}:t;du()||$r(!1);let{basename:n,navigator:s}=he.useContext(Bo),{hash:i,pathname:a,search:l}=N4(e,{relative:r}),c=a;return n!=="/"&&(c=a==="/"?n:_o([n,a])),s.createHref({pathname:c,search:l,hash:i})}function du(){return he.useContext(bm)!=null}function fu(){return du()||$r(!1),he.useContext(bm).location}function _4(e){he.useContext(Bo).static||he.useLayoutEffect(e)}function hu(){let{isDataRoute:e}=he.useContext(ea);return e?vj():sj()}function sj(){du()||$r(!1);let e=he.useContext(Xx),{basename:t,future:r,navigator:n}=he.useContext(Bo),{matches:s}=he.useContext(ea),{pathname:i}=fu(),a=JSON.stringify(Yx(s,r.v7_relativeSplatPath)),l=he.useRef(!1);return _4(()=>{l.current=!0}),he.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let m=Kx(u,JSON.parse(a),i,d.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:_o([t,m.pathname])),(d.replace?n.replace:n.push)(m,d.state,d)},[t,n,a,i,e])}const ij=he.createContext(null);function aj(e){let t=he.useContext(ea).outlet;return t&&he.createElement(ij.Provider,{value:e},t)}function _m(){let{matches:e}=he.useContext(ea),t=e[e.length-1];return t?t.params:{}}function N4(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=he.useContext(Bo),{matches:s}=he.useContext(ea),{pathname:i}=fu(),a=JSON.stringify(Yx(s,n.v7_relativeSplatPath));return he.useMemo(()=>Kx(e,JSON.parse(a),i,r==="path"),[e,a,i,r])}function oj(e,t){return lj(e,t)}function lj(e,t,r,n){du()||$r(!1);let{navigator:s,static:i}=he.useContext(Bo),{matches:a}=he.useContext(ea),l=a[a.length-1],c=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let d=fu(),m;if(t){var p;let v=typeof t=="string"?uu(t):t;u==="/"||(p=v.pathname)!=null&&p.startsWith(u)||$r(!1),m=v}else m=d;let h=m.pathname||"/",y=h;if(u!=="/"){let v=u.replace(/^\//,"").split("/");y="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let g=Fk(e,{pathname:y}),w=hj(g&&g.map(v=>Object.assign({},v,{params:Object.assign({},c,v.params),pathname:_o([u,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:_o([u,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),a,r,n);return t&&w?he.createElement(bm.Provider,{value:{location:af({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:co.Pop}},w):w}function cj(){let e=xj(),t=ej(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return he.createElement(he.Fragment,null,he.createElement("h2",null,"Unexpected Application Error!"),he.createElement("h3",{style:{fontStyle:"italic"}},t),r?he.createElement("pre",{style:s},r):null,null)}const uj=he.createElement(cj,null);class dj extends he.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?he.createElement(ea.Provider,{value:this.props.routeContext},he.createElement(b4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fj(e){let{routeContext:t,match:r,children:n}=e,s=he.useContext(Xx);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),he.createElement(ea.Provider,{value:t},n)}function hj(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,l=(s=r)==null?void 0:s.errors;if(l!=null){let d=a.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);d>=0||$r(!1),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<a.length;d++){let m=a[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=d),m.route.id){let{loaderData:p,errors:h}=r,y=m.route.loader&&p[m.route.id]===void 0&&(!h||h[m.route.id]===void 0);if(m.route.lazy||y){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,m,p)=>{let h,y=!1,g=null,w=null;r&&(h=l&&m.route.id?l[m.route.id]:void 0,g=m.route.errorElement||uj,c&&(u<0&&p===0?(yj("route-fallback"),y=!0,w=null):u===p&&(y=!0,w=m.route.hydrateFallbackElement||null)));let v=t.concat(a.slice(0,p+1)),b=()=>{let _;return h?_=g:y?_=w:m.route.Component?_=he.createElement(m.route.Component,null):m.route.element?_=m.route.element:_=d,he.createElement(fj,{match:m,routeContext:{outlet:d,matches:v,isDataRoute:r!=null},children:_})};return r&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?he.createElement(dj,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}var S4=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(S4||{}),k4=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(k4||{});function mj(e){let t=he.useContext(Xx);return t||$r(!1),t}function pj(e){let t=he.useContext(rj);return t||$r(!1),t}function gj(e){let t=he.useContext(ea);return t||$r(!1),t}function j4(e){let t=gj(),r=t.matches[t.matches.length-1];return r.route.id||$r(!1),r.route.id}function xj(){var e;let t=he.useContext(b4),r=pj(),n=j4();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function vj(){let{router:e}=mj(S4.UseNavigateStable),t=j4(k4.UseNavigateStable),r=he.useRef(!1);return _4(()=>{r.current=!0}),he.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,af({fromRouteId:t},i)))},[e,t])}const gy={};function yj(e,t,r){gy[e]||(gy[e]=!0)}function wj(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function ml(e){let{to:t,replace:r,state:n,relative:s}=e;du()||$r(!1);let{future:i,static:a}=he.useContext(Bo),{matches:l}=he.useContext(ea),{pathname:c}=fu(),u=hu(),d=Kx(t,Yx(l,i.v7_relativeSplatPath),c,s==="path"),m=JSON.stringify(d);return he.useEffect(()=>u(JSON.parse(m),{replace:r,state:n,relative:s}),[u,m,s,r,n]),null}function bj(e){return aj(e.context)}function yr(e){$r(!1)}function _j(e){let{basename:t="/",children:r=null,location:n,navigationType:s=co.Pop,navigator:i,static:a=!1,future:l}=e;du()&&$r(!1);let c=t.replace(/^\/*/,"/"),u=he.useMemo(()=>({basename:c,navigator:i,static:a,future:af({v7_relativeSplatPath:!1},l)}),[c,l,i,a]);typeof n=="string"&&(n=uu(n));let{pathname:d="/",search:m="",hash:p="",state:h=null,key:y="default"}=n,g=he.useMemo(()=>{let w=Gx(d,c);return w==null?null:{location:{pathname:w,search:m,hash:p,state:h,key:y},navigationType:s}},[c,d,m,p,h,y,s]);return g==null?null:he.createElement(Bo.Provider,{value:u},he.createElement(bm.Provider,{children:r,value:g}))}function E4(e){let{children:t,location:r}=e;return oj(Sg(t),r)}new Promise(()=>{});function Sg(e,t){t===void 0&&(t=[]);let r=[];return he.Children.forEach(e,(n,s)=>{if(!he.isValidElement(n))return;let i=[...t,s];if(n.type===he.Fragment){r.push.apply(r,Sg(n.props.children,i));return}n.type!==yr&&$r(!1),!n.props.index||!n.props.children||$r(!1);let a={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=Sg(n.props.children,i)),r.push(a)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function kg(){return kg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kg.apply(this,arguments)}function Nj(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Sj(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function kj(e,t){return e.button===0&&(!t||t==="_self")&&!Sj(e)}const jj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ej="6";try{window.__reactRouterVersion=Ej}catch{}const Aj="startTransition",xy=vS[Aj];function Tj(e){let{basename:t,children:r,future:n,window:s}=e,i=he.useRef();i.current==null&&(i.current=Ck({window:s,v5Compat:!0}));let a=i.current,[l,c]=he.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},d=he.useCallback(m=>{u&&xy?xy(()=>c(m)):c(m)},[c,u]);return he.useLayoutEffect(()=>a.listen(d),[a,d]),he.useEffect(()=>wj(n),[n]),he.createElement(_j,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:a,future:n})}const Cj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gr=he.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:d,viewTransition:m}=t,p=Nj(t,jj),{basename:h}=he.useContext(Bo),y,g=!1;if(typeof u=="string"&&Pj.test(u)&&(y=u,Cj))try{let _=new URL(window.location.href),E=u.startsWith("//")?new URL(_.protocol+u):new URL(u),D=Gx(E.pathname,h);E.origin===_.origin&&D!=null?u=D+E.search+E.hash:g=!0}catch{}let w=nj(u,{relative:s}),v=Lj(u,{replace:a,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:m});function b(_){n&&n(_),_.defaultPrevented||v(_)}return he.createElement("a",kg({},p,{href:y||w,onClick:g||i?n:b,ref:r,target:c}))});var vy;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(vy||(vy={}));var yy;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(yy||(yy={}));function Lj(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:l}=t===void 0?{}:t,c=hu(),u=fu(),d=N4(e,{relative:a});return he.useCallback(m=>{if(kj(m,r)){m.preventDefault();let p=n!==void 0?n:B0(u)===B0(d);c(e,{replace:p,state:s,preventScrollReset:i,relative:a,viewTransition:l})}},[u,c,d,n,s,r,e,i,a,l])}const Fj={},wy=e=>{let t;const r=new Set,n=(d,m)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const h=t;t=m??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(y=>y(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(Fj?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,s,c);return c},Oj=e=>e?wy(e):wy;var A4={exports:{}},T4={},C4={exports:{}},P4={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nu=he;function Dj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ij=typeof Object.is=="function"?Object.is:Dj,Rj=nu.useState,Mj=nu.useEffect,Bj=nu.useLayoutEffect,Uj=nu.useDebugValue;function zj(e,t){var r=t(),n=Rj({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return Bj(function(){s.value=r,s.getSnapshot=t,t1(s)&&i({inst:s})},[e,r,t]),Mj(function(){return t1(s)&&i({inst:s}),e(function(){t1(s)&&i({inst:s})})},[e]),Uj(r),r}function t1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ij(e,r)}catch{return!0}}function Wj(e,t){return t()}var Hj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Wj:zj;P4.useSyncExternalStore=nu.useSyncExternalStore!==void 0?nu.useSyncExternalStore:Hj;C4.exports=P4;var $j=C4.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm=he,qj=$j;function Vj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Gj=typeof Object.is=="function"?Object.is:Vj,Yj=qj.useSyncExternalStore,Kj=Nm.useRef,Xj=Nm.useEffect,Jj=Nm.useMemo,Qj=Nm.useDebugValue;T4.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=Kj(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=Jj(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&a.hasValue){var y=a.value;if(s(y,h))return m=y}return m=h}if(y=m,Gj(d,h))return y;var g=n(h);return s!==void 0&&s(y,g)?(d=h,y):(d=h,m=g)}var u=!1,d,m,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,s]);var l=Yj(e,i[0],i[1]);return Xj(function(){a.hasValue=!0,a.value=l},[l]),Qj(l),l};A4.exports=T4;var Zj=A4.exports;const eE=Qg(Zj),L4={},{useDebugValue:tE}=hw,{useSyncExternalStoreWithSelector:rE}=eE;let by=!1;const nE=e=>e;function sE(e,t=nE,r){(L4?"production":void 0)!=="production"&&r&&!by&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),by=!0);const n=rE(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return tE(n),n}const _y=e=>{(L4?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Oj(e):e,r=(n,s)=>sE(t,n,s);return Object.assign(r,t),r},iE=e=>e?_y(e):_y,aE="modulepreload",oE=function(e){return"/"+e},Ny={},Ea=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=oE(c),c in Ny)return;Ny[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":aE,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((p,h)=>{m.addEventListener("load",p),m.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},lE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ea(async()=>{const{default:n}=await Promise.resolve().then(()=>mu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Jx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class cE extends Jx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class uE extends Jx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class dE extends Jx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jg;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jg||(jg={}));var fE=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class hE{constructor(t,{headers:r={},customFetch:n,region:s=jg.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=lE(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return fE(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=r;let l={},{region:c}=r;c||(c=this.region),c&&c!=="any"&&(l["x-region"]=c);let u;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(l["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(l["Content-Type"]="application/json",u=JSON.stringify(a)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:u}).catch(y=>{throw new cE(y)}),m=d.headers.get("x-relay-error");if(m&&m==="true")throw new uE(d);if(!d.ok)throw new dE(d);let p=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),h;return p==="application/json"?h=yield d.json():p==="application/octet-stream"?h=yield d.blob():p==="text/event-stream"?h=d:p==="multipart/form-data"?h=yield d.formData():h=yield d.text(),{data:h,error:null}}catch(s){return{data:null,error:s}}})}}var us={},Qx={},Sm={},Sf={},km={},jm={},mE=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},su=mE();const pE=su.fetch,F4=su.fetch.bind(su),O4=su.Headers,gE=su.Request,xE=su.Response,mu=Object.freeze(Object.defineProperty({__proto__:null,Headers:O4,Request:gE,Response:xE,default:F4,fetch:pE},Symbol.toStringTag,{value:"Module"})),vE=rw(mu);var Em={};Object.defineProperty(Em,"__esModule",{value:!0});let yE=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Em.default=yE;var D4=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jm,"__esModule",{value:!0});const wE=D4(vE),bE=D4(Em);let _E=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=wE.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,l,c;let u=null,d=null,m=null,p=i.status,h=i.statusText;if(i.ok){if(this.method!=="HEAD"){const v=await i.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=v:d=JSON.parse(v))}const g=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),w=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&w&&w.length>1&&(m=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,m=null,p=406,h="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const g=await i.text();try{u=JSON.parse(g),Array.isArray(u)&&i.status===404&&(d=[],u=null,p=200,h="OK")}catch{i.status===404&&g===""?(p=204,h="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,p=200,h="OK"),u&&this.shouldThrowOnError)throw new bE.default(u)}return{error:u,data:d,count:m,status:p,statusText:h}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,l,c;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};jm.default=_E;var NE=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(km,"__esModule",{value:!0});const SE=NE(jm);let kE=class extends SE.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${c};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};km.default=kE;var jE=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sf,"__esModule",{value:!0});const EE=jE(km);let AE=class extends EE.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Sf.default=AE;var TE=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sm,"__esModule",{value:!0});const nd=TE(Sf);let CE=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const a=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new nd.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const a=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new nd.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const a="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new nd.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new nd.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new nd.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Sm.default=CE;var Am={},Tm={};Object.defineProperty(Tm,"__esModule",{value:!0});Tm.version=void 0;Tm.version="0.0.0-automated";Object.defineProperty(Am,"__esModule",{value:!0});Am.DEFAULT_HEADERS=void 0;const PE=Tm;Am.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${PE.version}`};var I4=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qx,"__esModule",{value:!0});const LE=I4(Sm),FE=I4(Sf),OE=Am;let DE=class R4{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},OE.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new LE.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new R4(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let a;const l=new URL(`${this.url}/rpc/${t}`);let c;n||s?(a=n?"HEAD":"GET",Object.entries(r).filter(([d,m])=>m!==void 0).map(([d,m])=>[d,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([d,m])=>{l.searchParams.append(d,m)})):(a="POST",c=r);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new FE.default({method:a,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Qx.default=DE;var pu=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(us,"__esModule",{value:!0});us.PostgrestError=us.PostgrestBuilder=us.PostgrestTransformBuilder=us.PostgrestFilterBuilder=us.PostgrestQueryBuilder=us.PostgrestClient=void 0;const M4=pu(Qx);us.PostgrestClient=M4.default;const B4=pu(Sm);us.PostgrestQueryBuilder=B4.default;const U4=pu(Sf);us.PostgrestFilterBuilder=U4.default;const z4=pu(km);us.PostgrestTransformBuilder=z4.default;const W4=pu(jm);us.PostgrestBuilder=W4.default;const H4=pu(Em);us.PostgrestError=H4.default;var IE=us.default={PostgrestClient:M4.default,PostgrestQueryBuilder:B4.default,PostgrestFilterBuilder:U4.default,PostgrestTransformBuilder:z4.default,PostgrestBuilder:W4.default,PostgrestError:H4.default};const{PostgrestClient:RE,PostgrestQueryBuilder:OR,PostgrestFilterBuilder:DR,PostgrestTransformBuilder:IR,PostgrestBuilder:RR,PostgrestError:MR}=IE,ME="2.11.2",BE={"X-Client-Info":`realtime-js/${ME}`},UE="1.0.0",$4=1e4,zE=1e3;var qc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(qc||(qc={}));var js;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(js||(js={}));var _i;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_i||(_i={}));var Eg;(function(e){e.websocket="websocket"})(Eg||(Eg={}));var al;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(al||(al={}));class WE{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(t.slice(a,a+s));a=a+s;const c=n.decode(t.slice(a,a+i));a=a+i;const u=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class q4{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var mr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(mr||(mr={}));const Sy=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,a)=>(i[a]=HE(a,e,t,s),i),{})},HE=(e,t,r,n)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,a=r[e];return i&&!n.includes(i)?V4(i,a):Ag(a)},V4=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return GE(t,r)}switch(e){case mr.bool:return $E(t);case mr.float4:case mr.float8:case mr.int2:case mr.int4:case mr.int8:case mr.numeric:case mr.oid:return qE(t);case mr.json:case mr.jsonb:return VE(t);case mr.timestamp:return YE(t);case mr.abstime:case mr.date:case mr.daterange:case mr.int4range:case mr.int8range:case mr.money:case mr.reltime:case mr.text:case mr.time:case mr.timestamptz:case mr.timetz:case mr.tsrange:case mr.tstzrange:return Ag(t);default:return Ag(t)}},Ag=e=>e,$E=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},qE=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},VE=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},GE=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const a=e.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>V4(t,l))}return e},YE=e=>typeof e=="string"?e.replace(" ","T"):e,G4=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class r1{constructor(t,r,n={},s=$4){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ky;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ky||(ky={}));class Ed{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ed.syncState(this.state,s,i,a),this.pendingDiffs.forEach(c=>{this.state=Ed.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ed.syncDiff(this.state,s,i,a),l())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),a=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{a[u]||(c[u]=d)}),this.map(a,(u,d)=>{const m=i[u];if(m){const p=d.map(w=>w.presence_ref),h=m.map(w=>w.presence_ref),y=d.filter(w=>h.indexOf(w.presence_ref)<0),g=m.filter(w=>p.indexOf(w.presence_ref)<0);y.length>0&&(l[u]=y),g.length>0&&(c[u]=g)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const m=t[l].map(h=>h.presence_ref),p=d.filter(h=>m.indexOf(h.presence_ref)<0);t[l].unshift(...p)}n(l,d,c)}),this.map(a,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(m=>m.presence_ref);u=u.filter(m=>d.indexOf(m.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jy;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(jy||(jy={}));var Ey;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ey||(Ey={}));var pa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(pa||(pa={}));class Zx{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=js.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new r1(this,_i.join,this.params,this.timeout),this.rejoinTimer=new q4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=js.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=js.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_i.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ed(this),this.broadcastEndpointURL=G4(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:l}}=this.params;this._onError(d=>t==null?void 0:t(pa.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(pa.CLOSED));const c={},u={broadcast:i,presence:a,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var m;if(this.socket.setAuth(),d===void 0){t==null||t(pa.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,h=(m=p==null?void 0:p.length)!==null&&m!==void 0?m:0,y=[];for(let g=0;g<h;g++){const w=p[g],{filter:{event:v,schema:b,table:_,filter:E}}=w,D=d&&d[g];if(D&&D.event===v&&D.schema===b&&D.table===_&&D.filter===E)y.push(Object.assign(Object.assign({},w),{id:D.id}));else{this.unsubscribe(),t==null||t(pa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(pa.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(pa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=js.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_i.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new r1(this,_i.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new r1(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const a=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=_i;if(n&&[l,c,u,d].indexOf(a)>=0&&n!==this._joinRef())return;let p=this._onMessage(a,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var y,g,w;return((y=h.filter)===null||y===void 0?void 0:y.event)==="*"||((w=(g=h.filter)===null||g===void 0?void 0:g.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===a}).map(h=>h.callback(p,n)):(i=this.bindings[a])===null||i===void 0||i.filter(h=>{var y,g,w,v,b,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in h){const E=h.id,D=(y=h.filter)===null||y===void 0?void 0:y.event;return E&&((g=r.ids)===null||g===void 0?void 0:g.includes(E))&&(D==="*"||(D==null?void 0:D.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const E=(b=(v=h==null?void 0:h.filter)===null||v===void 0?void 0:v.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return E==="*"||E===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===a}).map(h=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:g,table:w,commit_timestamp:v,type:b,errors:_}=y;p=Object.assign(Object.assign({},{schema:g,table:w,commit_timestamp:v,eventType:b,new:{},old:{},errors:_}),this._getPayloadRecords(y))}h.callback(p,n)})}_isClosed(){return this.state===js.closed}_isJoined(){return this.state===js.joined}_isJoining(){return this.state===js.joining}_isLeaving(){return this.state===js.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Zx.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_i.close,{},t)}_onError(t){this._on(_i.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=js.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Sy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Sy(t.columns,t.old_record)),r}}const KE=()=>{},XE=typeof WebSocket<"u",JE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class QE{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=BE,this.params={},this.timeout=$4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=KE,this.conn=null,this.sendBuffer=[],this.serializer=new WE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...l)=>Ea(async()=>{const{default:c}=await Promise.resolve().then(()=>mu);return{default:c}},void 0).then(({default:c})=>c(...l)):a=fetch,(...l)=>a(...l)},this.endPoint=`${t}/${Eg.websocket}`,this.httpEndpoint=G4(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,a)=>a(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new q4(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(XE){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new ZE(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ea(async()=>{const{default:t}=await import("./browser-CahjXdRl.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:UE}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case qc.connecting:return al.Connecting;case qc.open:return al.Open;case qc.closing:return al.Closing;default:return al.Closed}}isConnected(){return this.connectionState()===al.Open}channel(t,r={config:{}}){const n=new Zx(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:s,ref:i}=t,a=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(s=>{r&&s.updateJoinPayload({access_token:r}),s.joinedOnce&&s._isJoined()&&s._push(_i.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(zE,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:a}=r;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${a&&"("+a+")"||""}`,i),this.channels.filter(l=>l._isMember(n)).forEach(l=>l._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(l=>l(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(_i.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([JE],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class ZE{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=qc.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class e2 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function hn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class e8 extends e2{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Tg extends e2{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var t8=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const Y4=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ea(async()=>{const{default:n}=await Promise.resolve().then(()=>mu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},r8=()=>t8(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ea(()=>Promise.resolve().then(()=>mu),void 0)).Response:Response}),Cg=e=>{if(Array.isArray(e))return e.map(r=>Cg(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Cg(n)}),t};var Fl=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const n1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),n8=(e,t,r)=>Fl(void 0,void 0,void 0,function*(){const n=yield r8();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new e8(n1(s),e.status||500))}).catch(s=>{t(new Tg(n1(s),s))}):t(new Tg(n1(e),e))}),s8=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function kf(e,t,r,n,s,i){return Fl(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,s8(t,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>n8(c,l,n))})})}function U0(e,t,r,n){return Fl(this,void 0,void 0,function*(){return kf(e,"GET",t,r,n)})}function ro(e,t,r,n,s){return Fl(this,void 0,void 0,function*(){return kf(e,"POST",t,n,s,r)})}function i8(e,t,r,n,s){return Fl(this,void 0,void 0,function*(){return kf(e,"PUT",t,n,s,r)})}function a8(e,t,r,n){return Fl(this,void 0,void 0,function*(){return kf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function K4(e,t,r,n,s){return Fl(this,void 0,void 0,function*(){return kf(e,"DELETE",t,n,s,r)})}var ls=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const o8={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ay={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class l8{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Y4(s)}uploadOrUpdate(t,r,n,s){return ls(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Ay),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),m=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{})),p=yield m.json();return m.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(hn(i))return{data:null,error:i};throw i}})}upload(t,r,n){return ls(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return ls(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Ay.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const m=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:d}),p=yield m.json();return m.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(c){if(hn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return ls(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield ro(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),l=a.searchParams.get("token");if(!l)throw new e2("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}update(t,r,n){return ls(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return ls(this,void 0,void 0,function*(){try{return{data:yield ro(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(hn(s))return{data:null,error:s};throw s}})}copy(t,r,n){return ls(this,void 0,void 0,function*(){try{return{data:{path:(yield ro(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(hn(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return ls(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield ro(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(hn(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return ls(this,void 0,void 0,function*(){try{const s=yield ro(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(hn(s))return{data:null,error:s};throw s}})}download(t,r){return ls(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield U0(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(hn(l))return{data:null,error:l};throw l}})}info(t){return ls(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield U0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Cg(n),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}exists(t){return ls(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield a8(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(hn(n)&&n instanceof Tg){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return ls(this,void 0,void 0,function*(){try{return{data:yield K4(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}list(t,r,n){return ls(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},o8),r),{prefix:t||""});return{data:yield ro(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(hn(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const c8="2.7.1",u8={"X-Client-Info":`storage-js/${c8}`};var uc=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class d8{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},u8),r),this.fetch=Y4(n)}listBuckets(){return uc(this,void 0,void 0,function*(){try{return{data:yield U0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(hn(t))return{data:null,error:t};throw t}})}getBucket(t){return uc(this,void 0,void 0,function*(){try{return{data:yield U0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return uc(this,void 0,void 0,function*(){try{return{data:yield ro(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return uc(this,void 0,void 0,function*(){try{return{data:yield i8(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return uc(this,void 0,void 0,function*(){try{return{data:yield ro(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return uc(this,void 0,void 0,function*(){try{return{data:yield K4(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}}class f8 extends d8{constructor(t,r={},n){super(t,r,n)}from(t){return new l8(this.url,this.headers,t,this.fetch)}}const h8="2.49.2";let pd="";typeof Deno<"u"?pd="deno":typeof document<"u"?pd="web":typeof navigator<"u"&&navigator.product==="ReactNative"?pd="react-native":pd="node";const m8={"X-Client-Info":`supabase-js-${pd}/${h8}`},p8={headers:m8},g8={schema:"public"},x8={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},v8={};var y8=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const w8=e=>{let t;return e?t=e:typeof fetch>"u"?t=F4:t=fetch,(...r)=>t(...r)},b8=()=>typeof Headers>"u"?O4:Headers,_8=(e,t,r)=>{const n=w8(r),s=b8();return(i,a)=>y8(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new s(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},a),{headers:u}))})};var N8=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};function S8(e){return e.replace(/\/$/,"")}function k8(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:a,auth:l,realtime:c,global:u}=t,d={db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},l),n),realtime:Object.assign(Object.assign({},c),s),global:Object.assign(Object.assign({},u),i),accessToken:()=>N8(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const X4="2.69.0",wc=30*1e3,Pg=3,s1=Pg*wc,j8="http://localhost:9999",E8="supabase.auth.token",A8={"X-Client-Info":`gotrue-js/${X4}`},Lg="X-Supabase-Api-Version",J4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},T8=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,C8=6e5;class t2 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Tt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class P8 extends t2{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function L8(e){return Tt(e)&&e.name==="AuthApiError"}class Q4 extends t2{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Uo extends t2{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Qa extends Uo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function F8(e){return Tt(e)&&e.name==="AuthSessionMissingError"}class i1 extends Uo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mh extends Uo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Bh extends Uo{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function O8(e){return Tt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Ty extends Uo{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fg extends Uo{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function a1(e){return Tt(e)&&e.name==="AuthRetryableFetchError"}class Cy extends Uo{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Ad extends Uo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const z0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Py=` 	
\r=`.split(""),D8=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Py.length;t+=1)e[Py[t].charCodeAt(0)]=-2;for(let t=0;t<z0.length;t+=1)e[z0[t].charCodeAt(0)]=t;return e})();function Ly(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(z0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(z0[n]),t.queuedBits-=6}}function Z4(e,t,r){const n=D8[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function I8(e){const t=[],r=s=>{t.push(s)},n={queue:0,queuedBits:0};return e_(e,s=>{Ly(s,n,r)}),Ly(null,n,r),t.join("")}function Fy(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{M8(a,n,r)};for(let a=0;a<e.length;a+=1)Z4(e.charCodeAt(a),s,i);return t.join("")}function R8(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function e_(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}R8(n,t)}}function M8(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function B8(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Z4(e.charCodeAt(s),r,n);return new Uint8Array(t)}function U8(e){const t=[];return e_(e,r=>t.push(r)),new Uint8Array(t)}function z8(e){return Math.round(Date.now()/1e3)+e}function W8(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Wi=()=>typeof window<"u"&&typeof document<"u",Zo={tested:!1,writable:!1},Td=()=>{if(!Wi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zo.tested)return Zo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Zo.tested=!0,Zo.writable=!0}catch{Zo.tested=!0,Zo.writable=!1}return Zo.writable};function H8(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const t_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ea(async()=>{const{default:n}=await Promise.resolve().then(()=>mu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},$8=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",r_=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Uh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},zh=async(e,t)=>{await e.removeItem(t)};class Cm{constructor(){this.promise=new Cm.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Cm.promiseConstructor=Promise;function o1(e){const t=e.split(".");if(t.length!==3)throw new Ad("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!T8.test(t[n]))throw new Ad("JWT not in base64url format");return{header:JSON.parse(Fy(t[0])),payload:JSON.parse(Fy(t[1])),signature:B8(t[2]),raw:{header:t[0],payload:t[1]}}}async function q8(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function V8(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await e(i);if(!t(i,null,a)){n(a);return}}catch(a){if(!t(i,a)){s(a);return}}})()})}function G8(e){return("0"+e.toString(16)).substr(-2)}function Y8(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,G8).join("")}async function K8(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function X8(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await K8(e);return I8(r)}async function dc(e,t,r=!1){const n=Y8();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await r_(e,`${t}-code-verifier`,s);const i=await X8(n);return[i,n===i?"plain":"s256"]}const J8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Q8(e){const t=e.headers.get(Lg);if(!t||!t.match(J8))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Z8(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function eA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var tA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const nl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),rA=[502,503,504];async function Oy(e){var t;if(!$8(e))throw new Fg(nl(e),0);if(rA.includes(e.status))throw new Fg(nl(e),e.status);let r;try{r=await e.json()}catch(i){throw new Q4(nl(i),i)}let n;const s=Q8(e);if(s&&s.getTime()>=J4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Cy(nl(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Qa}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Cy(nl(r),e.status,r.weak_password.reasons);throw new P8(nl(r),e.status||500,n)}const nA=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Rt(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Lg]||(i[Lg]=J4["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await sA(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function sA(e,t,r,n,s,i){const a=nA(t,n,s,i);let l;try{l=await e(r,Object.assign({},a))}catch(c){throw console.error(c),new Fg(nl(c),0)}if(l.ok||await Oy(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Oy(c)}}function Za(e){var t;let r=null;lA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=z8(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Dy(e){const t=Za(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function io(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function iA(e){return{data:e,error:null}}function aA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,a=tA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function oA(e){return e}function lA(e){return e.access_token&&e.refresh_token&&e.expires_in}var cA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class uA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=t_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Rt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Tt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Rt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:io})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=cA(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Rt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:aA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Tt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Rt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:io})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Rt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:oA});if(d.error)throw d.error;const m=await d.json(),p=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,h=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(y=>{const g=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);u[`${w}Page`]=g}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(Tt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){try{return await Rt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:io})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Rt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:io})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Rt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:io})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Rt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Rt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}}const dA={getItem:e=>Td()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Td()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Td()&&globalThis.localStorage.removeItem(e)}};function Iy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function fA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const fc={debug:!!(globalThis&&Td()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class n_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class hA extends n_{}async function mA(e,t,r){fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),fc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new hA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(fc.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}fA();const pA={url:j8,storageKey:E8,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:A8,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ry(e,t,r){return await r()}class of{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=of.nextInstanceID,of.nextInstanceID+=1,this.instanceID>0&&Wi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},pA),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new uA({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=t_(s.fetch),this.lock=s.lock||Ry,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Wi()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=mA:this.lock=Ry,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Td()?this.storage=dA:(this.memoryStorage={},this.storage=Iy(this.memoryStorage)):(this.memoryStorage={},this.storage=Iy(this.memoryStorage)),Wi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${X4}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=H8(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Wi()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),O8(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Tt(r)?{error:r}:{error:new Q4("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Za}),{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Tt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:m,options:p}=t;let h=null,y=null;this.flowType==="pkce"&&([h,y]=await dc(this.storage,this.storageKey)),i=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:m,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:h,code_challenge_method:y},xform:Za})}else if("phone"in t){const{phone:d,password:m,options:p}=t;i=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:m,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Za})}else throw new Mh("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Tt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:a,options:l}=t;r=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Dy})}else if("phone"in t){const{phone:i,password:a,options:l}=t;r=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Dy})}else throw new Mh("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new i1}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await Uh(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:a}=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Za});if(await zh(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new i1}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(Tt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=t,l=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Za}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new i1}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,a;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await dc(this.storage,this.storageKey));const{error:m}=await Rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await Rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Mh("You must provide either an email or phone number.")}catch(l){if(Tt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await Rt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Za});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Tt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await dc(this.storage,this.storageKey)),await Rt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:iA})}catch(i){if(Tt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Qa;const{error:s}=await Rt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Tt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:a}=await Rt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:a,error:l}=await Rt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new Mh("You must provide either an email or phone number and a type")}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Uh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<s1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:io}):await this._useSession(async r=>{var n,s,i;const{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qa}:await Rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:io})})}catch(r){if(Tt(r))return F8(r)&&(await this._removeSession(),await zh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Qa;const a=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await dc(this.storage,this.storageKey));const{data:u,error:d}=await Rt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:io});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qa;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=o1(t.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Tt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:l}=r;if(l)throw l;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Qa;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Wi())throw new Bh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Bh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ty("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ty("No code detected.");const{data:b,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!a||!u)throw new Bh("No session defined in URL");const d=Math.round(Date.now()/1e3),m=parseInt(l);let p=d+m;c&&(p=parseInt(c));const h=p-d;h*1e3<=wc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${m}s`);const y=p-m;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,d);const{data:g,error:w}=await this._getUser(i);if(w)throw w;const v={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:m,expires_at:p,refresh_token:a,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(n){if(Tt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Uh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(L8(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await zh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=W8(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await dc(this.storage,this.storageKey,!0));try{return await Rt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Tt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,l,c,u,d;const{data:m,error:p}=i;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Rt(this.fetch,"GET",h,{headers:this.headers,jwt:(d=(u=m.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Wi()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Tt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await Rt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await V8(async s=>(s>0&&await q8(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Rt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Za})),(s,i)=>{const a=200*Math.pow(2,s);return i&&a1(i)&&Date.now()+a-n<wc})}catch(n){if(this._debug(r,"error",n),Tt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Wi()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Uh(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<s1;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${s1}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),a1(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Qa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Cm;const{data:i,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!i.session)throw new Qa;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Tt(i)){const a={session:null,error:i};return a1(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await r_(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await zh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Wi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),wc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/wc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${wc}ms, refresh threshold is ${Pg} ticks`),s<=Pg&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof n_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Wi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await dc(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Rt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await Rt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:a,error:l}=await Rt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Rt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Tt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=o1(s.access_token);let l=null;a.aal&&(l=a.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+C8>Date.now()))return n;const{data:s,error:i}=await Rt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Ad("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(a=>a.kid===t),!n)throw new Ad("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:h,error:y}=await this.getSession();if(y||!h.session)return{data:null,error:y};n=h.session.access_token}const{header:s,payload:i,signature:a,raw:{header:l,payload:c}}=o1(n);if(Z8(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:s,signature:a},error:null}}const u=eA(s.alg),d=await this.fetchJwk(s.kid,r),m=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,m,a,U8(`${l}.${c}`)))throw new Ad("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(Tt(n))return{data:null,error:n};throw n}}}of.nextInstanceID=0;const gA=of;class xA extends gA{constructor(t){super(t)}}var vA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(m){a(m)}}function c(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class yA{constructor(t,r,n){var s,i,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=S8(t);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const c=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:g8,realtime:v8,auth:Object.assign(Object.assign({},x8),{storageKey:c}),global:p8},d=k8(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=_8(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new RE(`${l}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new hE(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new f8(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return vA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:a,lock:l,debug:c},u,d){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new xA({url:this.authUrl,headers:Object.assign(Object.assign({},m),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:a,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new QE(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wA=(e,t,r)=>new yA(e,t,r),bA="https://egtgfkxlkdgjtnicyfxr.supabase.co",_A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVndGdma3hsa2RnanRuaWN5ZnhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI1OTA0MzMsImV4cCI6MjA1ODE2NjQzM30.JTai6zEgGVb99zNGAoeK8wvdg3waV0hnrSCCZtyPlR0",We=wA(bA,_A,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),hc=async()=>{try{await We.auth.signOut({scope:"global"}),localStorage.clear(),sessionStorage.clear(),await new Promise(e=>setTimeout(e,100))}catch(e){throw console.error("Error killing sessions:",e),e}},qt=iE(e=>({user:null,organization:null,error:null,initialized:!1,refreshSession:async()=>{try{const{data:t,error:r}=await We.auth.getSession(),n=t.session;if(r)throw r;if(n!=null&&n.user){const{data:s,error:i}=await We.from("users_organizations").select("organizations:organization_id(*)").eq("user_id",n.user.id).maybeSingle();if(i)throw i;if(s!=null&&s.organizations){const c=s.organizations;e({user:n.user,organization:c,error:null,initialized:!0});return}const{data:a,error:l}=await We.from("organizations").select().eq("owner_id",n.user.id).maybeSingle();if(l)throw l;e({user:n.user,organization:a,error:null,initialized:!0})}else e({user:null,organization:null,error:null,initialized:!0})}catch(t){console.error("Error refreshing session:",t),await hc(),e({user:null,organization:null,error:t instanceof Error?t.message:"Session expired. Please sign in again.",initialized:!0})}},signIn:async(t,r)=>{e({error:null});try{await hc();const{data:n,error:s}=await We.auth.signInWithPassword({email:t.trim().toLowerCase(),password:r});if(s)throw s.message==="Invalid login credentials"?new Error("Invalid email or password"):s;if(!n.user)throw new Error("No user returned from sign in");const{data:i,error:a}=await We.from("users_organizations").select("organizations:organization_id(*)").eq("user_id",n.user.id).maybeSingle();if(a)throw a;if(i!=null&&i.organizations){const u=i.organizations;e({user:n.user,organization:u,error:null,initialized:!0});return}const{data:l,error:c}=await We.from("organizations").select().eq("owner_id",n.user.id).maybeSingle();if(c)throw c;e({user:n.user,organization:l,error:null,initialized:!0})}catch(n){throw console.error("Sign in error:",n),e({user:null,organization:null,error:n instanceof Error?n.message:"Failed to sign in",initialized:!0}),n}},signUp:async(t,r,n)=>{e({error:null});try{await hc();const{data:s,error:i}=await We.auth.signUp({email:t.trim().toLowerCase(),password:r});if(i)throw i;if(!s.user)throw new Error("No user returned from sign up");const{data:a,error:l}=await We.from("organizations").insert([{name:n.trim(),owner_id:s.user.id}]).select().single();if(l)throw l;const{error:c}=await We.from("users_organizations").insert([{user_id:s.user.id,organization_id:a.id,role:"owner"}]);if(c)throw c;e({user:s.user,organization:a,error:null,initialized:!0})}catch(s){throw console.error("Sign up error:",s),e({user:null,organization:null,error:s instanceof Error?s.message:"Failed to sign up",initialized:!0}),s}},deleteAccount:async()=>{try{const{error:t}=await We.rpc("delete_user_account");if(t)throw t;await hc(),e({user:null,organization:null,error:null,initialized:!0})}catch(t){throw console.error("Delete account error:",t),e({error:t instanceof Error?t.message:"Failed to delete account",initialized:!0}),t}},signOut:async()=>{try{const{error:t}=await We.auth.signOut();e({user:null,organization:null,error:null,initialized:!0}),t&&await hc()}catch(t){throw console.error("Sign out error:",t),e({error:t instanceof Error?t.message:"Failed to sign out",initialized:!0}),t}},killAllSessions:hc})),NA=async()=>{try{await qt.getState().refreshSession(),console.log("initAuth")}catch(e){console.error("Auth initialization error:",e)}};NA();We.auth.onAuthStateChange(async(e,t)=>{if(e==="SIGNED_OUT"){qt.setState({user:null,organization:null,error:null,initialized:!0});return}});setInterval(async()=>{const e=qt.getState();e.user&&await e.refreshSession()},10*60*1e3);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var SA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),yt=(e,t)=>{const r=he.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:c,...u},d)=>he.createElement("svg",{ref:d,...SA,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${kA(e)}`,l].join(" "),...u},[...t.map(([m,p])=>he.createElement(m,p)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=yt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=yt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=yt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=yt("BarChart4",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=yt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=yt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=yt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=yt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=yt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=yt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=yt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ic=yt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=yt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=yt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=yt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=yt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=yt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=yt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=yt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=yt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=yt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OA=yt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=yt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=yt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=yt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RA=yt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=yt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r2=yt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=yt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=yt("MinusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=yt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=yt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=yt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=yt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=yt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=yt("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=yt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=yt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=yt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=yt("SquareUserRound",[["path",{d:"M18 21a6 6 0 0 0-12 0",key:"kaz2du"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=yt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=yt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=yt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=yt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=yt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=yt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=yt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function $A(){const{user:e}=qt();return e?o.jsx(ml,{to:"/dashboard",replace:!0}):o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[o.jsx("div",{className:"flex justify-center",children:o.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:o.jsx(Ao,{className:"h-8 w-8 text-blue-600"})})}),o.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sten360"}),o.jsxs("div",{className:"mt-2 text-center",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Complete Business Management Platform"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"A Sten Business Solution"})]})]}),o.jsx(bj,{})]})}function qA(e){return e&&e.country&&e.city&&e.address&&e.employee_count&&e.currency}function VA(){const[e,t]=he.useState(""),[r,n]=he.useState(""),[s,i]=he.useState(!1),[a,l]=he.useState(null),{signIn:c,user:u,organization:d}=qt();if(u)return qA(d)?o.jsx(ml,{to:"/dashboard",replace:!0}):o.jsx(ml,{to:"/organization-setup",replace:!0});const m=async p=>{if(p.preventDefault(),!s){l(null),i(!0);try{await c(e,r)}catch(h){console.error("Sign in error:",h),l(h instanceof Error?h.message:"An error occurred during sign in"),i(!1)}}};return o.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:o.jsxs("div",{className:"bg-white py-8 px-4 shadow-xl sm:rounded-lg sm:px-10",children:[o.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md mb-8",children:[o.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:o.jsx(IA,{className:"h-6 w-6 text-blue-600"})}),o.jsx("h2",{className:"mt-6 text-center text-2xl font-bold tracking-tight text-gray-900",children:"Sign in to your account"})]}),a&&o.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-400 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),o.jsx("div",{className:"ml-3",children:o.jsx("p",{className:"text-sm text-red-700",children:a})})]})}),o.jsxs("form",{onSubmit:m,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),o.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(MA,{className:"h-5 w-5 text-gray-400"})}),o.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:p=>t(p.target.value),disabled:s,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your email"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),o.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(DA,{className:"h-5 w-5 text-gray-400"})}),o.jsx("input",{id:"password",type:"password",required:!0,value:r,onChange:p=>n(p.target.value),disabled:s,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your password"})]})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",disabled:s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed transition-colors duration-200",children:s?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]}),o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-gray-300"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Don't have an account?"})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx(gr,{to:"/signup",className:"font-medium text-blue-600 hover:text-blue-500 transition-colors duration-200",children:"Sign up for free"})})]})]})})}function GA(){const[e,t]=he.useState(""),[r,n]=he.useState(""),[s,i]=he.useState(""),[a,l]=he.useState(null),c=qt(d=>d.signUp),u=async d=>{d.preventDefault();try{await c(e,r,s)}catch(m){l(m instanceof Error?m.message:"An error occurred")}};return o.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:o.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[o.jsx("h2",{className:"text-2xl font-bold mb-8 text-center",children:"Create your account"}),a&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:a}),o.jsxs("form",{onSubmit:u,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"organization",className:"block text-sm font-medium text-gray-700",children:"Organization name"}),o.jsx("input",{id:"organization",type:"text",required:!0,value:s,onChange:d=>i(d.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),o.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:d=>t(d.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),o.jsx("input",{id:"password",type:"password",required:!0,value:r,onChange:d=>n(d.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign up"})})]}),o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-gray-300"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Already have an account?"})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx(gr,{to:"/signin",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in instead"})})]})]})})}function l_(){const[e,t]=he.useState({isOpen:!1,title:"",message:"",type:"info",confirmText:"Confirm",cancelText:"Cancel",resolve:null});return{confirm:i=>new Promise(a=>{t({...i,isOpen:!0,resolve:a})}),dialog:e,handleConfirm:()=>{e.resolve&&e.resolve(!0),t(i=>({...i,isOpen:!1}))},handleCancel:()=>{e.resolve&&e.resolve(!1),t(i=>({...i,isOpen:!1}))}}}function c_(){const[e,t]=he.useState([]),r=he.useCallback(s=>{const i=Math.random().toString(36).substr(2,9);t(a=>[...a,{...s,id:i}])},[]),n=he.useCallback(s=>{t(i=>i.filter(a=>a.id!==s))},[]);return{toasts:e,addToast:r,removeToast:n}}function YA({isOpen:e,title:t,message:r,type:n="info",confirmText:s="Confirm",cancelText:i="Cancel",onConfirm:a,onCancel:l}){if(!e)return null;const c={danger:o.jsx(zo,{className:"h-6 w-6 text-red-600"}),warning:o.jsx(lf,{className:"h-6 w-6 text-yellow-600"}),info:o.jsx(FA,{className:"h-6 w-6 text-blue-600"})},u={danger:{button:"bg-red-600 hover:bg-red-700 focus:ring-red-500",icon:"bg-red-100"},warning:{button:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500",icon:"bg-yellow-100"},info:{button:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",icon:"bg-blue-100"}};return o.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 transition-opacity"}),o.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:o.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:[o.jsxs("div",{className:"sm:flex sm:items-start",children:[o.jsx("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full ${u[n].icon} sm:mx-0 sm:h-10 sm:w-10`,children:c[n]}),o.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[o.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:t}),o.jsx("div",{className:"mt-2",children:o.jsx("p",{className:"text-sm text-gray-500",children:r})})]})]}),o.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse gap-3",children:[o.jsx("button",{type:"button",className:`inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm sm:w-auto ${u[n].button} focus:outline-none focus:ring-2 focus:ring-offset-2`,onClick:a,children:s}),o.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:l,children:i})]})]})})]})}function KA({id:e,type:t,title:r,message:n,duration:s=5e3,onClose:i}){he.useEffect(()=>{if(s>0){const c=setTimeout(()=>{i(e)},s);return()=>clearTimeout(c)}},[s,e,i]);const a={success:o.jsx(Si,{className:"h-6 w-6 text-green-400"}),error:o.jsx(zo,{className:"h-6 w-6 text-red-400"}),warning:o.jsx(lf,{className:"h-6 w-6 text-yellow-400"}),info:o.jsx(OA,{className:"h-6 w-6 text-blue-400"})},l={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200"};return o.jsx("div",{className:`pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg border shadow-lg ${l[t]}`,children:o.jsx("div",{className:"p-4",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("div",{className:"flex-shrink-0",children:a[t]}),o.jsxs("div",{className:"ml-3 w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:r}),n&&o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n})]}),o.jsx("div",{className:"ml-4 flex flex-shrink-0",children:o.jsxs("button",{type:"button",className:"inline-flex rounded-md text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>i(e),children:[o.jsx("span",{className:"sr-only",children:"Close"}),o.jsx(ti,{className:"h-5 w-5"})]})})]})})})}function XA({toasts:e,onClose:t}){return o.jsx("div",{"aria-live":"assertive",className:"pointer-events-none fixed inset-0 z-50 flex flex-col items-end gap-2 px-4 py-6 sm:p-6",children:o.jsx("div",{className:"flex w-full flex-col items-end space-y-4",children:e.map(r=>o.jsx(KA,{...r,onClose:t},r.id))})})}const u_=he.createContext(null);function JA({children:e}){const{confirm:t,dialog:r,handleConfirm:n,handleCancel:s}=l_(),{toasts:i,addToast:a,removeToast:l}=c_();return o.jsxs(u_.Provider,{value:{confirm:t,addToast:a},children:[e,o.jsx(YA,{isOpen:r.isOpen,title:r.title,message:r.message,type:r.type,confirmText:r.confirmText,cancelText:r.cancelText,onConfirm:n,onCancel:s}),o.jsx(XA,{toasts:i,onClose:l})]})}function en(){const e=he.useContext(u_);if(!e)throw new Error("useUI must be used within a UIProvider");return e}const Ar={GHS:{name:"Ghanaian Cedi",symbol:""},USD:{name:"US Dollar",symbol:"$"},EUR:{name:"Euro",symbol:""},GBP:{name:"British Pound",symbol:""},NGN:{name:"Nigerian Naira",symbol:""}},Wh={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},delayed:{bg:"bg-orange-100",text:"text-orange-800",hover:"hover:bg-orange-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},cancelled:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"}},My={pending:"Pending",in_progress:"In Progress",delayed:"Delayed",completed:"Completed",cancelled:"Cancelled"};function Qr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Co(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function QA(e,t){const r=Qr(e);return isNaN(t)?Co(e,NaN):(t&&r.setDate(r.getDate()+t),r)}const d_=6048e5,ZA=864e5;let eT={};function Ef(){return eT}function Ds(e,t){var l,c,u,d;const r=Ef(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=Qr(e),i=s.getDay(),a=(i<n?7:0)+i-n;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function H0(e){return Ds(e,{weekStartsOn:1})}function f_(e){const t=Qr(e),r=t.getFullYear(),n=Co(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=H0(n),i=Co(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const a=H0(i);return t.getTime()>=s.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function El(e){const t=Qr(e);return t.setHours(0,0,0,0),t}function By(e){const t=Qr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function tT(e,t){const r=El(e),n=El(t),s=+r-By(r),i=+n-By(n);return Math.round((s-i)/ZA)}function rT(e){const t=f_(e),r=Co(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),H0(r)}function h_(e,t){const r=t*7;return QA(e,r)}function nT(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function sT(e){if(!nT(e)&&typeof e!="number")return!1;const t=Qr(e);return!isNaN(Number(t))}function iT(e){const t=Qr(e);return t.setHours(23,59,59,999),t}function aT(e){const t=Qr(e),r=Co(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function So(e,t){var l,c,u,d;const r=Ef(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=Qr(e),i=s.getDay(),a=(i<n?-7:0)+6-(i-n);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}const oT={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},lT=(e,t,r)=>{let n;const s=oT[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function c1(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const cT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},uT={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dT={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fT={date:c1({formats:cT,defaultWidth:"full"}),time:c1({formats:uT,defaultWidth:"full"}),dateTime:c1({formats:dT,defaultWidth:"full"})},hT={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},mT=(e,t,r,n)=>hT[e];function sd(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):a;s=e.formattingValues[l]||e.formattingValues[a]}else{const a=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[l]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const pT={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},gT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},xT={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},vT={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},yT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bT=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},_T={ordinalNumber:bT,era:sd({values:pT,defaultWidth:"wide"}),quarter:sd({values:gT,defaultWidth:"wide",argumentCallback:e=>e-1}),month:sd({values:xT,defaultWidth:"wide"}),day:sd({values:vT,defaultWidth:"wide"}),dayPeriod:sd({values:yT,defaultWidth:"wide",formattingValues:wT,defaultFormattingWidth:"wide"})};function id(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?ST(l,m=>m.test(a)):NT(l,m=>m.test(a));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(a.length);return{value:u,rest:d}}}function NT(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function ST(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function kT(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=r.valueCallback?r.valueCallback(a):a;const l=t.slice(s.length);return{value:a,rest:l}}}const jT=/^(\d+)(th|st|nd|rd)?/i,ET=/\d+/i,AT={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},TT={any:[/^b/i,/^(a|c)/i]},CT={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},PT={any:[/1/i,/2/i,/3/i,/4/i]},LT={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},FT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},OT={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},DT={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},IT={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},RT={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},MT={ordinalNumber:kT({matchPattern:jT,parsePattern:ET,valueCallback:e=>parseInt(e,10)}),era:id({matchPatterns:AT,defaultMatchWidth:"wide",parsePatterns:TT,defaultParseWidth:"any"}),quarter:id({matchPatterns:CT,defaultMatchWidth:"wide",parsePatterns:PT,defaultParseWidth:"any",valueCallback:e=>e+1}),month:id({matchPatterns:LT,defaultMatchWidth:"wide",parsePatterns:FT,defaultParseWidth:"any"}),day:id({matchPatterns:OT,defaultMatchWidth:"wide",parsePatterns:DT,defaultParseWidth:"any"}),dayPeriod:id({matchPatterns:IT,defaultMatchWidth:"any",parsePatterns:RT,defaultParseWidth:"any"})},BT={code:"en-US",formatDistance:lT,formatLong:fT,formatRelative:mT,localize:_T,match:MT,options:{weekStartsOn:0,firstWeekContainsDate:1}};function UT(e){const t=Qr(e);return tT(t,aT(t))+1}function zT(e){const t=Qr(e),r=+H0(t)-+rT(t);return Math.round(r/d_)+1}function m_(e,t){var d,m,p,h;const r=Qr(e),n=r.getFullYear(),s=Ef(),i=(t==null?void 0:t.firstWeekContainsDate)??((m=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(p=s.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,a=Co(e,0);a.setFullYear(n+1,0,i),a.setHours(0,0,0,0);const l=Ds(a,t),c=Co(e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=Ds(c,t);return r.getTime()>=l.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function WT(e,t){var l,c,u,d;const r=Ef(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=m_(e,t),i=Co(e,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),Ds(i,t)}function Om(e,t){const r=Qr(e),n=+Ds(r,t)-+WT(r,t);return Math.round(n/d_)+1}function Zt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Ya={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Zt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Zt(r+1,2)},d(e,t){return Zt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Zt(e.getHours()%12||12,t.length)},H(e,t){return Zt(e.getHours(),t.length)},m(e,t){return Zt(e.getMinutes(),t.length)},s(e,t){return Zt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return Zt(s,t.length)}},mc={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Uy={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Ya.y(e,t)},Y:function(e,t,r,n){const s=m_(e,n),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return Zt(a,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Zt(i,t.length)},R:function(e,t){const r=f_(e);return Zt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Zt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Zt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Zt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Ya.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Zt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=Om(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Zt(s,t.length)},I:function(e,t,r){const n=zT(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Zt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ya.d(e,t)},D:function(e,t,r){const n=UT(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Zt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Zt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Zt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return Zt(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=mc.noon:n===0?s=mc.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=mc.evening:n>=12?s=mc.afternoon:n>=4?s=mc.morning:s=mc.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Ya.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ya.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Zt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Zt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ya.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ya.s(e,t)},S:function(e,t){return Ya.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Wy(n);case"XXXX":case"XX":return sl(n);case"XXXXX":case"XXX":default:return sl(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Wy(n);case"xxxx":case"xx":return sl(n);case"xxxxx":case"xxx":default:return sl(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+zy(n,":");case"OOOO":default:return"GMT"+sl(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+zy(n,":");case"zzzz":default:return"GMT"+sl(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Zt(n,t.length)},T:function(e,t,r){const n=e.getTime();return Zt(n,t.length)}};function zy(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+t+Zt(i,2)}function Wy(e,t){return e%60===0?(e>0?"-":"+")+Zt(Math.abs(e)/60,2):sl(e,t)}function sl(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Zt(Math.trunc(n/60),2),i=Zt(n%60,2);return r+s+t+i}const Hy=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},p_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},HT=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Hy(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Hy(n,t)).replace("{{time}}",p_(s,t))},$T={p:p_,P:HT},qT=/^D+$/,VT=/^Y+$/,GT=["D","DD","YY","YYYY"];function YT(e){return qT.test(e)}function KT(e){return VT.test(e)}function XT(e,t,r){const n=JT(e,t,r);if(console.warn(n),GT.includes(e))throw new RangeError(n)}function JT(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const QT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ZT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eC=/^'([^]*?)'?$/,tC=/''/g,rC=/[a-zA-Z]/;function Lt(e,t,r){var d,m,p,h;const n=Ef(),s=n.locale??BT,i=n.firstWeekContainsDate??((m=(d=n.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??1,a=n.weekStartsOn??((h=(p=n.locale)==null?void 0:p.options)==null?void 0:h.weekStartsOn)??0,l=Qr(e);if(!sT(l))throw new RangeError("Invalid time value");let c=t.match(ZT).map(y=>{const g=y[0];if(g==="p"||g==="P"){const w=$T[g];return w(y,s.formatLong)}return y}).join("").match(QT).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const g=y[0];if(g==="'")return{isToken:!1,value:nC(y)};if(Uy[g])return{isToken:!0,value:y};if(g.match(rC))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:y}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const u={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return c.map(y=>{if(!y.isToken)return y.value;const g=y.value;(KT(g)||YT(g))&&XT(g,t,String(e));const w=Uy[g[0]];return w(l,g,s.localize,u)}).join("")}function nC(e){const t=e.match(eC);return t?t[1].replace(tC,"'"):e}function i2(e){return Qr(e).getFullYear()}function pl(e,t){const r=Qr(e),n=Qr(t);return r.getTime()>n.getTime()}function $y(e,t){const r=+Qr(e),[n,s]=[+Qr(t.start),+Qr(t.end)].sort((i,a)=>i-a);return r>=n&&r<=s}function sC(e,t){return h_(e,-1)}const g_=({orderId:e,outstandingBalance:t,onPaymentRecorded:r})=>{const{addToast:n}=en(),{organization:s}=qt(),[i,a]=he.useState(!1),[l,c]=he.useState(""),[u,d]=he.useState(""),[m,p]=he.useState(""),[h,y]=he.useState(!1),g=async w=>{if(w.preventDefault(),!l||!u){n({type:"error",title:"Error",message:"Please fill in all required fields"});return}const v=parseFloat(l);if(isNaN(v)||v<=0){n({type:"error",title:"Error",message:"Please enter a valid payment amount"});return}if(v>t){n({type:"error",title:"Error",message:"Payment amount cannot exceed outstanding balance"});return}y(!0);try{const{data:{user:b},error:_}=await We.auth.getUser();if(_)throw _;if(!b)throw new Error("User not authenticated");const{error:E}=await We.rpc("record_payment",{p_organization_id:s==null?void 0:s.id,p_order_id:e,p_amount:v,p_payment_method:u,p_payment_reference:m||null,p_recorded_by:b.id});if(E)throw E;n({type:"success",title:"Success",message:"Payment recorded successfully"}),c(""),d(""),p(""),a(!1),r()}catch(b){n({type:"error",title:"Error",message:b.message||"Failed to record payment"})}finally{y(!1)}};return o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>a(!0),className:"ml-2 inline-flex items-center px-3 py-1.5 border border-blue-600 text-blue-600 hover:bg-blue-50 rounded-md text-sm font-medium transition-colors",children:[o.jsx(Aa,{className:"h-4 w-4 mr-1"}),"Record Payment"]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:o.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),o.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Record Payment"}),o.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-500",children:o.jsx(ti,{className:"h-5 w-5"})})]}),o.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount*"}),o.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),o.jsx("input",{type:"number",step:"0.01",min:"0.01",max:t,value:l,onChange:w=>c(w.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"0.00",required:!0})]}),o.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Outstanding Balance: $",t.toFixed(2)]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method*"}),o.jsxs("select",{value:u,onChange:w=>d(w.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",required:!0,children:[o.jsx("option",{value:"",children:"Select a payment method"}),o.jsx("option",{value:"mobile_money",children:"Mobile Money"}),o.jsx("option",{value:"cash",children:"Cash"}),o.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),o.jsx("option",{value:"credit_card",children:"Credit Card"}),o.jsx("option",{value:"check",children:"Check"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Reference"}),o.jsx("input",{type:"text",value:m,onChange:w=>p(w.target.value),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"e.g., Check number, Transaction ID"})]}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300",children:h?"Recording Payment...":"Record Payment"})]})]})]})]})})]})},iC={pending:"bg-yellow-100 text-yellow-800 border-yellow-200",in_progress:"bg-blue-100 text-blue-800 border-blue-200",completed:"bg-green-100 text-green-800 border-green-200",cancelled:"bg-red-100 text-red-800 border-red-200"},qy={pending:"Pending",in_progress:"In Progress",completed:"Completed",cancelled:"Cancelled"},aC={pending:lf,in_progress:TA,completed:Si,cancelled:zo};function oC(){var p,h,y;const{id:e}=_m(),[t,r]=he.useState(null),[n,s]=he.useState(!0),{organization:i}=qt(),{addToast:a}=en(),l=i!=null&&i.currency?((p=Ar[i.currency])==null?void 0:p.symbol)||i.currency:Ar.USD.symbol;he.useEffect(()=>{e&&c()},[e]);const c=async()=>{try{const{data:g,error:w}=await We.from("orders").select(`
          *,
          client:clients(name),
          workers:order_workers(
            id,
            worker_id,
            worker:workers(name),
            project:projects(name)
          ),
          services:order_services(
            id,
            service_id,
            quantity,
            cost,
            service:services(name)
          ),
          custom_fields:order_custom_fields(
            id,
            field:client_custom_fields(title, value)
          ),
          payments:service_payments(
            id,
            amount,
            payment_method,
            payment_reference,
            created_at
          )
        `).eq("id",e).single();if(w)throw w;r(g)}catch(g){console.error("Error loading order:",g),a({type:"error",title:"Error",message:"Failed to load order details"})}finally{s(!1)}},u=async g=>{if(t)try{const{error:w}=await We.from("orders").update({status:g}).eq("id",t.id);if(w)throw w;r(v=>v?{...v,status:g}:null),a({type:"success",title:"Status Updated",message:`Order status updated to ${qy[g]}`})}catch(w){console.error("Error updating status:",w),a({type:"error",title:"Error",message:"Failed to update order status"})}},d=async g=>{if(window.confirm("Are you sure you want to delete this order? This action cannot be undone."))try{const{error:v}=await We.from("orders").delete().eq("id",g);if(v)throw v;a({type:"success",title:"Order Deleted",message:"The order has been deleted successfully."}),window.location.href="/dashboard/orders"}catch(v){console.error("Error deleting order:",v),a({type:"error",title:"Error",message:"Failed to delete order. Please try again."})}};if(n)return o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!t)return o.jsxs("div",{className:"text-center py-12",children:[o.jsx("p",{className:"text-gray-500",children:"Order not found."}),o.jsxs(gr,{to:"/dashboard/orders",className:"mt-4 inline-flex items-center text-blue-600 hover:text-blue-800",children:[o.jsx(jl,{className:"h-4 w-4 mr-2"}),"Back to Orders"]})]});const m=aC[t.status];return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(gr,{to:"/dashboard/orders",className:"text-gray-500 hover:text-gray-700",children:o.jsx(jl,{className:"h-5 w-5"})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Order ",t.order_number]}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created on ",Lt(new Date(t.created_at),"MMM d, yyyy HH:mm")]})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:`px-4 py-2 rounded-full border ${iC[t.status]} flex items-center space-x-2`,children:[o.jsx(m,{className:"h-4 w-4"}),o.jsx("span",{className:"text-sm font-medium",children:qy[t.status]})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:t.status,onChange:g=>u(g.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg py-2 pl-3 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"pending",children:"Mark as Pending"}),o.jsx("option",{value:"in_progress",children:"Mark as In Progress"}),o.jsx("option",{value:"completed",children:"Mark as Completed"}),o.jsx("option",{value:"cancelled",children:"Mark as Cancelled"})]}),o.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500",children:o.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Services"})}),o.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[o.jsx("div",{className:"space-y-4",children:t.services.map(g=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Qi,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.service.name}),o.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",g.quantity]})]})]}),o.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[l," ",g.cost.toFixed(2)]})]},g.id))}),o.jsx("div",{className:"mt-6 pt-6 border-t",children:o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"font-medium text-gray-900",children:"Total Amount"}),o.jsxs("span",{className:"font-bold text-gray-900",children:[l," ",t.total_amount.toFixed(2)]})]})})]})]}),((h=t.custom_fields)==null?void 0:h.length)>0&&o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Custom Information"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-4",children:t.custom_fields.map(g=>o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(s_,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.field.title}),o.jsx("p",{className:"text-sm text-gray-500",children:g.field.value})]})]},g.id))})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx(Aa,{className:"h-5 w-5 mr-2 text-gray-500"}),"Payment Details"]}),t.payment_status!=="paid"&&o.jsx(g_,{orderId:t.id,outstandingBalance:t.outstanding_balance,onPaymentRecorded:c})]})}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[o.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Amount"}),o.jsxs("p",{className:"text-xl font-bold text-blue-900",children:[l," ",t==null?void 0:t.total_amount.toFixed(2)]})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[o.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Amount Paid"}),o.jsxs("p",{className:"text-xl font-bold text-green-900",children:[l," ",((t==null?void 0:t.total_amount)-((t==null?void 0:t.outstanding_balance)||0)).toFixed(2)]})]}),o.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[o.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Outstanding Balance"}),o.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[l," ",((t==null?void 0:t.outstanding_balance)||0).toFixed(2)]})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-200",children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Payment Status"}),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                    ${(t==null?void 0:t.payment_status)==="paid"?"bg-green-100 text-green-800":(t==null?void 0:t.payment_status)==="partially_paid"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:(t==null?void 0:t.payment_status)==="paid"?"Paid":(t==null?void 0:t.payment_status)==="partially_paid"?"Partially Paid":"Unpaid"})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Payment History"}),t!=null&&t.payments&&t.payments.length>0?o.jsx("div",{className:"border rounded-lg divide-y",children:t.payments.map(g=>o.jsxs("div",{className:"p-4 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[l," ",g.amount.toFixed(2)]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[g.payment_method,"  ",g.payment_reference]})]}),o.jsx("div",{className:"text-right",children:o.jsx("p",{className:"text-xs text-gray-500",children:Lt(new Date(g.created_at),"MMM d, yyyy h:mm a")})})]},g.id))}):o.jsx("p",{className:"text-sm text-gray-500 italic",children:"No payments recorded yet"})]})]})})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Client"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(No,{className:"h-5 w-5 text-gray-400"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.client.name})]})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Assigned Workers"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-4",children:(y=t.workers)!=null&&y.length?t.workers.map(g=>o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(No,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.worker.name}),o.jsx("p",{className:"text-sm text-gray-500",children:g.project.name})]})]},g.id)):o.jsx("p",{className:"text-sm text-gray-500",children:"No workers assigned"})})})]}),t.due_date&&o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Due Date"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ol,{className:"h-5 w-5 text-gray-400"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:Lt(new Date(t.due_date),"MMM d, yyyy")})]})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Danger Zone"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("button",{onClick:()=>d(t.id),className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Order"})})]}),t.description&&o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Description"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("p",{className:"text-sm text-gray-500",children:t.description})})]})]})]})]})}function lC({onClose:e,onSuccess:t}){var G;const[r,n]=he.useState([]),[s,i]=he.useState([]),[a,l]=he.useState([]),[c,u]=he.useState({}),[d,m]=he.useState(null),[p,h]=he.useState([]),[y,g]=he.useState([]),[w,v]=he.useState([]),[b,_]=he.useState(""),[E,D]=he.useState(!1),[I,A]=he.useState({description:"",due_date:"",initial_payment:0,payment_method:""}),{organization:P}=qt(),{addToast:C}=en(),M=P!=null&&P.currency?((G=Ar[P.currency])==null?void 0:G.symbol)||P.currency:Ar.USD.symbol;he.useEffect(()=>{P!=null&&P.id&&j()},[P]);const j=async()=>{if(P!=null&&P.id)try{const{data:B,error:Y}=await We.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*)
        `).eq("organization_id",P.id);if(Y)throw Y;n(B||[]);const{data:se,error:me}=await We.from("workers").select("id, name").eq("organization_id",P.id);if(me)throw me;i(se||[]);const{data:S,error:L}=await We.from("services").select("*").eq("organization_id",P.id);if(L)throw L;l(S||[])}catch(B){console.error("Error loading data:",B),C({type:"error",title:"Error",message:"Failed to load required data"})}},T=async B=>{try{const{data:Y,error:se}=await We.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).eq("worker_id",B);if(se)throw se;u(me=>({...me,[B]:Y||[]}))}catch(Y){console.error("Error loading worker projects:",Y),C({type:"error",title:"Error",message:"Failed to load worker projects"})}},q=async B=>{var se;if(B.preventDefault(),!d||y.length===0||!w.some(me=>me.worker_id&&me.project_id)){C({type:"error",title:"Validation Error",message:"Please select a client, at least one service, and assign at least one worker with a project."});return}if(!(P!=null&&P.id)){C({type:"error",title:"Error",message:"Organization information is missing."});return}const Y=y.reduce((me,{service:S,quantity:L})=>me+S.cost*L,0);if(I.initial_payment>Y){C({type:"error",title:"Validation Error",message:"Initial payment cannot be greater than the total amount."});return}D(!0);try{const{data:me,error:S}=await We.rpc("create_order",{p_organization_id:P.id,p_client_id:d.id,p_description:I.description.trim()||null,p_due_date:I.due_date||null,p_total_amount:Y,p_workers:w.filter(L=>L.worker_id&&L.project_id).map(L=>({worker_id:L.worker_id,project_id:L.project_id})),p_services:y.map(({service:L,quantity:R})=>({service_id:L.id,quantity:R,cost:L.cost*R})),p_custom_fields:p});if(S)throw S;if(!me)throw new Error("Failed to create order");if(I.initial_payment>0&&I.payment_method){const{error:L}=await We.rpc("record_payment",{p_organization_id:P.id,p_order_id:me.id,p_amount:I.initial_payment,p_payment_method:I.payment_method,p_payment_reference:`Initial payment for order ${me.order_number}`,p_recorded_by:(se=(await We.auth.getUser()).data.user)==null?void 0:se.id});if(L)throw L}C({type:"success",title:"Order Created",message:"The order has been created successfully."}),t(),e()}catch(me){console.error("Error creating order:",me),C({type:"error",title:"Error",message:me instanceof Error?me.message:"Failed to create order. Please try again."})}finally{D(!1)}},U=r.filter(B=>B.name.toLowerCase().includes(b.toLowerCase())),re=(B,Y,se)=>{g(me=>{const S=me.find(L=>L.service.id===B.id);return Y==="add"&&!S?[...me,{service:B,quantity:1}]:Y==="remove"?me.filter(L=>L.service.id!==B.id):Y==="update"&&se!==void 0?me.map(L=>L.service.id===B.id?{...L,quantity:Math.max(1,se)}:L):me})},z=y.reduce((B,{service:Y,quantity:se})=>B+Y.cost*se,0);return o.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-auto overflow-y-auto max-h-[90vh] border border-gray-100",children:o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-8 py-6 border-b",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Order"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Fill in the order details below"})]}),o.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-400 hover:text-gray-500 hover:bg-white rounded-full transition-colors duration-200",children:o.jsx(ti,{className:"h-5 w-5"})})]}),o.jsxs("form",{onSubmit:q,className:"space-y-8",children:[o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[o.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[o.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"1"}),"General Order Info"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-800",children:"Select Client *"}),o.jsxs("div",{className:"mt-1 relative",children:[o.jsxs("div",{className:"relative",children:[o.jsx(No,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:b,onChange:B=>_(B.target.value),placeholder:"Search clients by name...",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400"})]}),b&&o.jsx("div",{className:"absolute z-10 mt-2 w-full bg-white shadow-xl rounded-lg border border-gray-200 max-h-60 overflow-auto divide-y divide-gray-100",children:U.map(B=>o.jsxs("button",{type:"button",onClick:()=>{var Y;m(B),_(""),h(((Y=B.custom_fields)==null?void 0:Y.map(se=>se.id))||[])},className:"w-full text-left px-4 py-3 hover:bg-blue-50 transition-colors duration-150 flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:o.jsx(No,{className:"h-4 w-4 text-blue-600"})}),o.jsx("div",{children:B.name})]},B.id))})]}),d&&!b&&o.jsxs("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg flex items-center justify-between animate-fadeIn shadow-sm",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center",children:o.jsx(No,{className:"h-5 w-5 text-blue-600"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("span",{className:"text-sm font-semibold text-blue-900",children:d.name}),o.jsx("p",{className:"text-xs text-blue-600 mt-0.5",children:"Selected Client"})]})]}),o.jsx("button",{type:"button",onClick:()=>m(null),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-full transition-colors duration-200",children:o.jsx(ti,{className:"h-4 w-4"})})]}),(d==null?void 0:d.custom_fields)&&d.custom_fields.length>0&&o.jsxs("div",{className:"mt-6 animate-fadeIn",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Fields"}),o.jsx("div",{className:"space-y-2",children:d.custom_fields.map(B=>o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:p.includes(B.id),onChange:Y=>{Y.target.checked?h(se=>[...se,B.id]):h(se=>se.filter(me=>me!==B.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-900",children:B.title})]},B.id))})]}),o.jsxs("div",{className:"mt-6 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-800",children:"Assign Workers"}),o.jsxs("button",{type:"button",onClick:()=>v([...w,{worker_id:"",project_id:""}]),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Worker"]})]}),w.map((B,Y)=>{var se;return o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("select",{value:B.worker_id||"",onChange:me=>{const S=me.target.value;S&&T(S);const L=[...w];L[Y]={...L[Y],worker_id:S,project_id:""},v(L)},className:"block w-full px-3 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"Select Worker"}),s.map(me=>o.jsx("option",{value:me.id,children:me.name},me.id))]})}),o.jsx("div",{className:"flex-1",children:o.jsxs("select",{value:B.project_id||"",onChange:me=>{const S=[...w];S[Y].project_id=me.target.value,v(S)},disabled:!B.worker_id,className:"block w-full px-3 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"Select Project"}),B.worker_id&&((se=c[B.worker_id])==null?void 0:se.map(me=>o.jsx("option",{value:me.project_id,children:me.project.name},me.project_id)))]})}),o.jsx("button",{type:"button",onClick:()=>{const me=w.filter((S,L)=>L!==Y);v(me)},className:"p-2 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:o.jsx(ti,{className:"h-5 w-5"})})]},Y)})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Description"}),o.jsxs("div",{className:"relative",children:[o.jsx(s_,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),o.jsx("textarea",{value:I.description,onChange:B=>A(Y=>({...Y,description:B.target.value})),rows:3,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400 resize-none",placeholder:"Enter order description"})]})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Due Date"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ol,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:I.due_date,onChange:B=>A(Y=>({...Y,due_date:B.target.value})),min:Lt(new Date,"yyyy-MM-dd"),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400"})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[o.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[o.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"2"}),"Services"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:a.map(B=>{const Y=y.find(se=>se.service.id===B.id);return o.jsx("div",{className:`p-4 rounded-lg border ${Y?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-gray-900",children:B.name}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[M," ",B.cost.toFixed(2)]})]}),Y?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>re(B,"update",Y.quantity-1),className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(a_,{className:"h-4 w-4"})}),o.jsx("span",{className:"text-gray-900 min-w-[2rem] text-center",children:Y.quantity}),o.jsx("button",{type:"button",onClick:()=>re(B,"update",Y.quantity+1),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:o.jsx(Jr,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",onClick:()=>re(B,"remove"),className:"p-1 text-red-400 hover:text-red-600",children:o.jsx(ti,{className:"h-4 w-4"})})]}):o.jsx("button",{type:"button",onClick:()=>re(B,"add"),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-full transition-all duration-200",children:o.jsx(Jr,{className:"h-4 w-4"})})]})},B.id)})}),y.length>0&&o.jsx("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg shadow-sm",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),o.jsxs("span",{className:"text-xl font-bold text-blue-600",children:[M," ",z.toFixed(2)]})]})})]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[o.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[o.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"3"}),"Payment Details"]}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Order Amount"}),o.jsxs("span",{className:"text-xl font-bold text-blue-600",children:[M," ",z.toFixed(2)]})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Initial Payment (Optional)"}),o.jsxs("div",{className:"relative",children:[o.jsx(Aa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"number",min:"0",max:z,step:"0.01",value:I.initial_payment,onChange:B=>A(Y=>({...Y,initial_payment:parseFloat(B.target.value)||0})),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400",placeholder:"Enter initial payment amount"})]})]}),I.initial_payment>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Payment Method *"}),o.jsxs("div",{className:"relative",children:[o.jsx(W0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsxs("select",{value:I.payment_method,onChange:B=>A(Y=>({...Y,payment_method:B.target.value})),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400",required:I.initial_payment>0,children:[o.jsx("option",{value:"",children:"Select Payment Method"}),o.jsx("option",{value:"mobile_money",children:"Mobile Money"}),o.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),o.jsx("option",{value:"cash",children:"Cash"}),o.jsx("option",{value:"other",children:"Other"})]})]})]}),I.initial_payment>0&&o.jsx("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-100 rounded-lg",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outstanding Balance"}),o.jsxs("span",{className:"text-xl font-bold text-green-600",children:[M," ",(z-I.initial_payment).toFixed(2)]})]})})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[o.jsx("button",{type:"button",onClick:e,className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:E||!d||y.length===0,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:E?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Order..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Create Order"]})})]})]})]})})}function cC(){var P;const[e,t]=he.useState([]),[r,n]=he.useState(!0),[s,i]=he.useState(""),[a,l]=he.useState("all"),[c,u]=he.useState(!1),[d,m]=he.useState(new Date),p=Ds(d,{weekStartsOn:1}),h=So(d,{weekStartsOn:1}),y=new Date,g=Om(d,{weekStartsOn:1}),w=i2(d),{organization:v}=qt(),{confirm:b,addToast:_}=en(),E=v!=null&&v.currency?((P=Ar[v.currency])==null?void 0:P.symbol)||v.currency:"";he.useEffect(()=>{v&&D()},[v,d]);const D=async()=>{if(v!=null&&v.id)try{const{data:C,error:M}=await We.from("orders").select(`
          *,
          client:clients(name),
          workers:order_workers(
            id,
            worker_id,
            worker:workers(name),
            project_id,
            project:projects(name),
            status
          ),
          services:order_services(
            id,
            service_id,
            service:services(name),
            quantity,
            cost
          ),
          outstanding_balance,
          payment_status
        `).eq("organization_id",v.id).gte("created_at",p.toISOString()).lte("created_at",h.toISOString()).order("created_at",{ascending:!1});if(M)throw M;t(C||[])}catch(C){console.error("Error loading orders:",C),_({type:"error",title:"Error",message:"Failed to load orders"})}finally{n(!1)}},I=C=>{m(M=>{const j=new Date(M);return C==="prev"?j.setDate(j.getDate()-7):j.setDate(j.getDate()+7),j})},A=e.filter(C=>C.client.name.toLowerCase().includes(s.toLowerCase())&&(a==="all"||C.status===a));return r?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage and track your customer orders"})]}),o.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Create Order"]})]}),o.jsx("div",{className:"bg-white shadow rounded-lg",children:o.jsxs("div",{className:"p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>I("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:o.jsx(Pm,{className:"h-5 w-5 text-gray-600"})}),o.jsxs("div",{className:"text-sm",children:[o.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",g,", ",w]}),o.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[Lt(p,"MMM d")," - ",Lt(h,"MMM d")]})]}),o.jsx("button",{onClick:()=>I("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:pl(h,y),children:o.jsx(Lm,{className:"h-5 w-5 text-gray-600"})})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[e.length," orders this week"]})]})}),c&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),o.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl",children:o.jsx(lC,{onClose:()=>u(!1),onSuccess:D})})]})}),o.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b space-y-4",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx("button",{onClick:()=>l("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50"}`,children:"All Orders"}),Object.entries(My).map(([C,M])=>o.jsx("button",{onClick:()=>l(C),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a===C?`${Wh[C].bg} ${Wh[C].text}`:"text-gray-500 hover:bg-gray-50"}`,children:M},C))]}),o.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[o.jsx(jf,{className:"h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:s,onChange:C=>i(C.target.value),placeholder:"Search orders...",className:"ml-2 flex-1 outline-none bg-transparent"})]})]}),o.jsx("div",{className:"overflow-x-auto",children:A.length===0?o.jsx("div",{className:"text-center text-gray-500 py-8",children:"No orders found. Start by creating a new order."}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Workers"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(C=>{var M;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.jsx(gr,{to:`/dashboard/orders/${C.id}`,className:"text-blue-600 hover:text-blue-800",children:C.order_number})})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(No,{className:"h-5 w-5 text-gray-400 mr-2"}),o.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.client.name})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:(M=C.workers)!=null&&M.length?C.workers.map(j=>j.worker.name).join(", "):"Unassigned"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[o.jsx(Ol,{className:"h-4 w-4 text-gray-400 mr-2"}),C.due_date?Lt(new Date(C.due_date),"MMM d, yyyy"):"No due date"]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Wh[C.status].bg} ${Wh[C.status].text}`,children:My[C.status]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[E," ",C.total_amount.toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("span",{className:`text-sm font-medium ${C.payment_status==="paid"?"text-green-600":C.payment_status==="partially_paid"?"text-orange-600":"text-red-600"}`,children:[E," ",C.outstanding_balance.toFixed(2)]}),o.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:C.payment_status==="paid"?"Paid":C.payment_status==="partially_paid"?"Outstanding":"Unpaid"})]})})]},C.id)})})]})})]})]})}function uC(){var P;const[e,t]=he.useState([]),[r,n]=he.useState(!0),[s,i]=he.useState(""),[a,l]=he.useState(!1),[c,u]=he.useState({name:"",whatsapp:"",image:""}),[d,m]=he.useState(!1),p=he.useRef(null),[h,y]=he.useState(null),{organization:g}=qt(),{confirm:w,addToast:v}=en(),b=((P=Ar[g.currency])==null?void 0:P.symbol)||g.currency,_=C=>{var j;const M=(j=C.target.files)==null?void 0:j[0];if(M){if(!["image/jpeg","image/jpg","image/png"].includes(M.type)){alert("Please upload a JPG, JPEG, or PNG file");return}if(M.size>5*1024*1024){alert("Image must be less than 5MB");return}y(M)}},E=async()=>{if(g)try{n(!0);const{data:C,error:M}=await We.from("workers").select("*").eq("organization_id",g.id).order("name");if(M)throw M;const j=new Date,T=Ds(j,{weekStartsOn:1}),q=So(j,{weekStartsOn:1}),U=El(j),re=iT(j),{data:z,error:G}=await We.from("tasks").select(`
          *,
          deductions (
            amount
          )
        `).eq("organization_id",g.id);if(G)throw G;const B=(C==null?void 0:C.map(Y=>{const se=(z==null?void 0:z.filter(ne=>ne.worker_id===Y.id))||[],me=se.filter(ne=>$y(new Date(ne.created_at),{start:T,end:q})),S=me.filter(ne=>ne.status==="completed"),L=me.filter(ne=>ne.status==="pending"),R=S.reduce((ne,ue)=>{var ye;const fe=((ye=ue.deductions)==null?void 0:ye.reduce((pe,_e)=>pe+(_e.amount||0),0))||0;return ne+(ue.amount-fe)},0),O=me.reduce((ne,ue)=>{var ye;const fe=((ye=ue.deductions)==null?void 0:ye.reduce((pe,_e)=>pe+(_e.amount||0),0))||0;return ne+(ue.amount-fe)},0),V={completedEarnings:R,weeklyProjectTotal:O,assignedTasks:L.length,completedTasks:S.length,allTimeTasks:se.length,weeklyTasks:me.length,dailyTasks:se.filter(ne=>$y(new Date(ne.created_at),{start:U,end:re})).length};return{...Y,stats:V}}))||[];t(B)}catch(C){console.error("Error loading workers:",C)}finally{n(!1)}};he.useEffect(()=>{E()},[g]);const D=async()=>{var C;if(!(!g||!c.name.trim()))try{m(!0);let M=null;if(h){const q=(C=h.name.split(".").pop())==null?void 0:C.toLowerCase();if(!q||!["jpg","jpeg","png"].includes(q))throw new Error("Invalid file extension");const U=`${Math.random().toString(36).substring(2)}.${q}`,re=`${g.id}/${U}`,{error:z,data:G}=await We.storage.from("profiles").upload(re,h,{contentType:h.type,cacheControl:"3600",upsert:!1});if(z)throw z;const{data:{publicUrl:B}}=We.storage.from("profiles").getPublicUrl(re);M=B}const{data:j,error:T}=await We.from("workers").insert([{organization_id:g.id,name:c.name.trim(),whatsapp:c.whatsapp.trim()||null,image:M}]).select().single();if(T)throw T;t(q=>[...q,{...j,stats:{completedEarnings:0,weeklyProjectTotal:0,assignedTasks:0,completedTasks:0,allTimeTasks:0,weeklyTasks:0,dailyTasks:0}}]),u({name:"",whatsapp:"",image:""}),y(null),p.current&&(p.current.value=""),l(!1)}catch(M){console.error("Error adding worker:",M),alert(M instanceof Error?M.message:"Failed to add worker")}finally{m(!1)}},I=async C=>{if(await w({title:"Delete Worker",message:"Are you sure you want to delete this worker? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const j=e.find(q=>q.id===C);if(j!=null&&j.image){const q=j.image.split("/").slice(-2).join("/");await We.storage.from("profiles").remove([q])}const{error:T}=await We.from("workers").delete().eq("id",C);if(T)throw T;t(q=>q.filter(U=>U.id!==C)),v({type:"success",title:"Worker Deleted",message:"The worker has been deleted successfully."})}catch(j){console.error("Error deleting worker:",j),v({type:"error",title:"Error",message:"Failed to delete worker. Please try again."})}},A=e.filter(C=>C.name.toLowerCase().includes(s.toLowerCase()));return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading workers..."})]})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Workers"}),o.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Worker"]})]}),a&&o.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Worker"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),o.jsx("input",{type:"text",value:c.name,onChange:C=>u(M=>({...M,name:C.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",placeholder:"Enter worker name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp Number"}),o.jsx("input",{type:"text",value:c.whatsapp,onChange:C=>u(M=>({...M,whatsapp:C.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",placeholder:"Enter WhatsApp number"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Profile Image"}),o.jsx("input",{type:"file",ref:p,onChange:_,accept:"image/*",className:"hidden"}),o.jsx("div",{className:"mt-1 flex items-center space-x-4",children:h?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm text-gray-500",children:h.name}),o.jsx("button",{onClick:()=>{y(null),p.current&&(p.current.value="")},className:"text-red-600 hover:text-red-700",children:o.jsx(zo,{className:"h-5 w-5"})})]}):o.jsxs("button",{onClick:()=>{var C;return(C=p.current)==null?void 0:C.click()},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(cf,{className:"h-4 w-4 mr-2"}),"Choose Image"]})})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>{l(!1),y(null),p.current&&(p.current.value="")},className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),o.jsx("button",{onClick:D,disabled:!c.name.trim()||d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center",children:d?o.jsxs(o.Fragment,{children:[o.jsx(To,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):"Add Worker"})]})]})]}),o.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[o.jsx(jf,{className:"h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:s,onChange:C=>i(C.target.value),placeholder:"Search workers...",className:"ml-2 flex-1 outline-none bg-transparent"})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-4",children:A.length===0?o.jsx("div",{className:"col-span-full text-center text-gray-500 py-4",children:s?"No workers found matching your search.":"No workers added yet."}):A.map(C=>{var M,j,T,q,U,re,z;return o.jsxs("div",{className:"relative",children:[o.jsx(gr,{to:`/dashboard/workers/${C.id}`,className:"block bg-white border rounded-lg shadow-sm hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:C.image?o.jsx("img",{src:C.image,alt:C.name,className:"h-full w-full object-cover"}):o.jsx("span",{className:"text-2xl font-medium text-gray-600",children:C.name[0].toUpperCase()})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:C.name}),C.whatsapp&&o.jsxs("p",{className:"text-sm text-gray-500",children:["WhatsApp: ",C.whatsapp]})]})]}),o.jsxs("div",{className:"mt-6 space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Completed Earnings: ",b," ",(M=C.stats)==null?void 0:M.completedEarnings.toFixed(2)]}),o.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:["Weekly Project Total: ",b," ",(j=C.stats)==null?void 0:j.weeklyProjectTotal.toFixed(2)]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("p",{className:"text-sm text-yellow-600 font-medium",children:["Tasks Assigned: ",(T=C.stats)==null?void 0:T.assignedTasks]}),o.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Tasks Completed: ",(q=C.stats)==null?void 0:q.completedTasks]})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[o.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"All-time"}),o.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(U=C.stats)==null?void 0:U.allTimeTasks})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[o.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"This week"}),o.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(re=C.stats)==null?void 0:re.weeklyTasks})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[o.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Today"}),o.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(z=C.stats)==null?void 0:z.dailyTasks})]})]})]})]})}),o.jsx("button",{onClick:()=>I(C.id),className:"absolute top-4 right-4 p-2 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50 z-10",children:o.jsx(Pi,{className:"h-5 w-5"})})]},C.id)})})]})]})}function tr(e){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tr(e)}var Un=Uint8Array,Fs=Uint16Array,a2=Int32Array,Dm=new Un([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Im=new Un([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ig=new Un([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),x_=function(e,t){for(var r=new Fs(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new a2(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},v_=x_(Dm,2),y_=v_.b,Rg=v_.r;y_[28]=258,Rg[258]=28;var w_=x_(Im,0),dC=w_.b,Vy=w_.r,Mg=new Fs(32768);for(var wr=0;wr<32768;++wr){var Ka=(wr&43690)>>1|(wr&21845)<<1;Ka=(Ka&52428)>>2|(Ka&13107)<<2,Ka=(Ka&61680)>>4|(Ka&3855)<<4,Mg[wr]=((Ka&65280)>>8|(Ka&255)<<8)>>1}var Ji=function(e,t,r){for(var n=e.length,s=0,i=new Fs(t);s<n;++s)e[s]&&++i[e[s]-1];var a=new Fs(t);for(s=1;s<t;++s)a[s]=a[s-1]+i[s-1]<<1;var l;if(r){l=new Fs(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var u=s<<4|e[s],d=t-e[s],m=a[e[s]-1]++<<d,p=m|(1<<d)-1;m<=p;++m)l[Mg[m]>>c]=u}else for(l=new Fs(n),s=0;s<n;++s)e[s]&&(l[s]=Mg[a[e[s]-1]++]>>15-e[s]);return l},Po=new Un(288);for(var wr=0;wr<144;++wr)Po[wr]=8;for(var wr=144;wr<256;++wr)Po[wr]=9;for(var wr=256;wr<280;++wr)Po[wr]=7;for(var wr=280;wr<288;++wr)Po[wr]=8;var uf=new Un(32);for(var wr=0;wr<32;++wr)uf[wr]=5;var fC=Ji(Po,9,0),hC=Ji(Po,9,1),mC=Ji(uf,5,0),pC=Ji(uf,5,1),u1=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},pi=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},d1=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},o2=function(e){return(e+7)/8|0},b_=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Un(e.subarray(t,r))},gC=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wi=function(e,t,r){var n=new Error(t||gC[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,wi),!r)throw n;return n},xC=function(e,t,r,n){var s=e.length,i=0;if(!s||t.f&&!t.l)return r||new Un(0);var a=!r,l=a||t.i!=2,c=t.i;a&&(r=new Un(s*3));var u=function(pe){var _e=r.length;if(pe>_e){var Ue=new Un(Math.max(_e*2,pe));Ue.set(r),r=Ue}},d=t.f||0,m=t.p||0,p=t.b||0,h=t.l,y=t.d,g=t.m,w=t.n,v=s*8;do{if(!h){d=pi(e,m,1);var b=pi(e,m+1,3);if(m+=3,b)if(b==1)h=hC,y=pC,g=9,w=5;else if(b==2){var I=pi(e,m,31)+257,A=pi(e,m+10,15)+4,P=I+pi(e,m+5,31)+1;m+=14;for(var C=new Un(P),M=new Un(19),j=0;j<A;++j)M[Ig[j]]=pi(e,m+j*3,7);m+=A*3;for(var T=u1(M),q=(1<<T)-1,U=Ji(M,T,1),j=0;j<P;){var re=U[pi(e,m,q)];m+=re&15;var _=re>>4;if(_<16)C[j++]=_;else{var z=0,G=0;for(_==16?(G=3+pi(e,m,3),m+=2,z=C[j-1]):_==17?(G=3+pi(e,m,7),m+=3):_==18&&(G=11+pi(e,m,127),m+=7);G--;)C[j++]=z}}var B=C.subarray(0,I),Y=C.subarray(I);g=u1(B),w=u1(Y),h=Ji(B,g,1),y=Ji(Y,w,1)}else wi(1);else{var _=o2(m)+4,E=e[_-4]|e[_-3]<<8,D=_+E;if(D>s){c&&wi(0);break}l&&u(p+E),r.set(e.subarray(_,D),p),t.b=p+=E,t.p=m=D*8,t.f=d;continue}if(m>v){c&&wi(0);break}}l&&u(p+131072);for(var se=(1<<g)-1,me=(1<<w)-1,S=m;;S=m){var z=h[d1(e,m)&se],L=z>>4;if(m+=z&15,m>v){c&&wi(0);break}if(z||wi(2),L<256)r[p++]=L;else if(L==256){S=m,h=null;break}else{var R=L-254;if(L>264){var j=L-257,O=Dm[j];R=pi(e,m,(1<<O)-1)+y_[j],m+=O}var V=y[d1(e,m)&me],ne=V>>4;V||wi(3),m+=V&15;var Y=dC[ne];if(ne>3){var O=Im[ne];Y+=d1(e,m)&(1<<O)-1,m+=O}if(m>v){c&&wi(0);break}l&&u(p+131072);var ue=p+R;if(p<Y){var fe=i-Y,ye=Math.min(Y,ue);for(fe+p<0&&wi(3);p<ye;++p)r[p]=n[fe+p]}for(;p<ue;++p)r[p]=r[p-Y]}}t.l=h,t.p=S,t.b=p,t.f=d,h&&(d=1,t.m=g,t.d=y,t.n=w)}while(!d);return p!=r.length&&a?b_(r,0,p):r.subarray(0,p)},ha=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},ad=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},f1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,i=r.slice();if(!s)return{t:N_,l:0};if(s==1){var a=new Un(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(D,I){return D.f-I.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,m=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=s-1;)l=r[r[u].f<r[m].f?u++:m++],c=r[u!=d&&r[u].f<r[m].f?u++:m++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var p=i[0].s,n=1;n<s;++n)i[n].s>p&&(p=i[n].s);var h=new Fs(p+1),y=Bg(r[d-1],h,0);if(y>t){var n=0,g=0,w=y-t,v=1<<w;for(i.sort(function(I,A){return h[A.s]-h[I.s]||I.f-A.f});n<s;++n){var b=i[n].s;if(h[b]>t)g+=v-(1<<y-h[b]),h[b]=t;else break}for(g>>=w;g>0;){var _=i[n].s;h[_]<t?g-=1<<t-h[_]++-1:++n}for(;n>=0&&g;--n){var E=i[n].s;h[E]==t&&(--h[E],++g)}y=t}return{t:new Un(h),l:y}},Bg=function(e,t,r){return e.s==-1?Math.max(Bg(e.l,t,r+1),Bg(e.r,t,r+1)):t[e.s]=r},Gy=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Fs(++t),n=0,s=e[0],i=1,a=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(s),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(s);i=1,s=e[l]}return{c:r.subarray(0,n),n:t}},od=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},__=function(e,t,r){var n=r.length,s=o2(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<n;++i)e[s+i+4]=r[i];return(s+4+n)*8},Yy=function(e,t,r,n,s,i,a,l,c,u,d){ha(t,d++,r),++s[256];for(var m=f1(s,15),p=m.t,h=m.l,y=f1(i,15),g=y.t,w=y.l,v=Gy(p),b=v.c,_=v.n,E=Gy(g),D=E.c,I=E.n,A=new Fs(19),P=0;P<b.length;++P)++A[b[P]&31];for(var P=0;P<D.length;++P)++A[D[P]&31];for(var C=f1(A,7),M=C.t,j=C.l,T=19;T>4&&!M[Ig[T-1]];--T);var q=u+5<<3,U=od(s,Po)+od(i,uf)+a,re=od(s,p)+od(i,g)+a+14+3*T+od(A,M)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&q<=U&&q<=re)return __(t,d,e.subarray(c,c+u));var z,G,B,Y;if(ha(t,d,1+(re<U)),d+=2,re<U){z=Ji(p,h,0),G=p,B=Ji(g,w,0),Y=g;var se=Ji(M,j,0);ha(t,d,_-257),ha(t,d+5,I-1),ha(t,d+10,T-4),d+=14;for(var P=0;P<T;++P)ha(t,d+3*P,M[Ig[P]]);d+=3*T;for(var me=[b,D],S=0;S<2;++S)for(var L=me[S],P=0;P<L.length;++P){var R=L[P]&31;ha(t,d,se[R]),d+=M[R],R>15&&(ha(t,d,L[P]>>5&127),d+=L[P]>>12)}}else z=fC,G=Po,B=mC,Y=uf;for(var P=0;P<l;++P){var O=n[P];if(O>255){var R=O>>18&31;ad(t,d,z[R+257]),d+=G[R+257],R>7&&(ha(t,d,O>>23&31),d+=Dm[R]);var V=O&31;ad(t,d,B[V]),d+=Y[V],V>3&&(ad(t,d,O>>5&8191),d+=Im[V])}else ad(t,d,z[O]),d+=G[O]}return ad(t,d,z[256]),d+G[256]},vC=new a2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),N_=new Un(0),yC=function(e,t,r,n,s,i){var a=i.z||e.length,l=new Un(n+a+5*(1+Math.ceil(a/7e3))+s),c=l.subarray(n,l.length-s),u=i.l,d=(i.r||0)&7;if(t){d&&(c[0]=i.r>>3);for(var m=vC[t-1],p=m>>13,h=m&8191,y=(1<<r)-1,g=i.p||new Fs(32768),w=i.h||new Fs(y+1),v=Math.ceil(r/3),b=2*v,_=function(Ve){return(e[Ve]^e[Ve+1]<<v^e[Ve+2]<<b)&y},E=new a2(25e3),D=new Fs(288),I=new Fs(32),A=0,P=0,C=i.i||0,M=0,j=i.w||0,T=0;C+2<a;++C){var q=_(C),U=C&32767,re=w[q];if(g[U]=re,w[q]=U,j<=C){var z=a-C;if((A>7e3||M>24576)&&(z>423||!u)){d=Yy(e,c,0,E,D,I,P,M,T,C-T,d),M=A=P=0,T=C;for(var G=0;G<286;++G)D[G]=0;for(var G=0;G<30;++G)I[G]=0}var B=2,Y=0,se=h,me=U-re&32767;if(z>2&&q==_(C-me))for(var S=Math.min(p,z)-1,L=Math.min(32767,C),R=Math.min(258,z);me<=L&&--se&&U!=re;){if(e[C+B]==e[C+B-me]){for(var O=0;O<R&&e[C+O]==e[C+O-me];++O);if(O>B){if(B=O,Y=me,O>S)break;for(var V=Math.min(me,O-2),ne=0,G=0;G<V;++G){var ue=C-me+G&32767,fe=g[ue],ye=ue-fe&32767;ye>ne&&(ne=ye,re=ue)}}}U=re,re=g[U],me+=U-re&32767}if(Y){E[M++]=268435456|Rg[B]<<18|Vy[Y];var pe=Rg[B]&31,_e=Vy[Y]&31;P+=Dm[pe]+Im[_e],++D[257+pe],++I[_e],j=C+B,++A}else E[M++]=e[C],++D[e[C]]}}for(C=Math.max(C,j);C<a;++C)E[M++]=e[C],++D[e[C]];d=Yy(e,c,u,E,D,I,P,M,T,C-T,d),u||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=w,i.p=g,i.i=C,i.w=j)}else{for(var C=i.w||0;C<a+u;C+=65535){var Ue=C+65535;Ue>=a&&(c[d/8|0]=u,Ue=a),d=__(c,d+1,e.subarray(C,Ue))}i.i=a}return b_(l,0,n+o2(d)+s)},S_=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,i=r.length|0,a=0;a!=i;){for(var l=Math.min(a+2655,i);a<l;++a)s+=n+=r[a];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},wC=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),a=new Un(i.length+e.length);a.set(i),a.set(e,i.length),e=a,s.w=i.length}return yC(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},k_=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},bC=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=S_();s.p(t.dictionary),k_(e,2,s.d())}},_C=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&wi(6,"invalid zlib data"),(e[1]>>5&1)==1&&wi(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Ug(e,t){t||(t={});var r=S_();r.p(e);var n=wC(e,t,t.dictionary?6:2,4);return bC(n,t),k_(n,n.length-4,r.d()),n}function NC(e,t){return xC(e.subarray(_C(e),-4),{i:2},t,t)}var SC=typeof TextDecoder<"u"&&new TextDecoder,kC=0;try{SC.decode(N_,{stream:!0}),kC=1}catch{}var vt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function h1(){vt.console&&typeof vt.console.log=="function"&&vt.console.log.apply(vt.console,arguments)}var ur={log:h1,warn:function(e){vt.console&&(typeof vt.console.warn=="function"?vt.console.warn.apply(vt.console,arguments):h1.call(null,arguments))},error:function(e){vt.console&&(typeof vt.console.error=="function"?vt.console.error.apply(vt.console,arguments):h1(e))}};function m1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){il(n.response,t,r)},n.onerror=function(){ur.error("could not download file")},n.send()}function Ky(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Hh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Cd,zg,il=vt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==vt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=vt.URL||vt.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?Ky(s.href)?m1(e,t,r):Hh(s,s.target="_blank"):Hh(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Hh(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Ky(e))m1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Hh(n)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:tr(i)!=="object"&&(ur.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return m1(e,t,r);var s=e.type==="application/octet-stream",i=/constructor/i.test(vt.HTMLElement)||vt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||s&&i)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=a?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=vt.URL||vt.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function j_(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,i=r[n].process,a=s.exec(e);a&&(t=i(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function p1(e,t){var r=e[0],n=e[1],s=e[2],i=e[3];r=Dn(r,n,s,i,t[0],7,-680876936),i=Dn(i,r,n,s,t[1],12,-389564586),s=Dn(s,i,r,n,t[2],17,606105819),n=Dn(n,s,i,r,t[3],22,-1044525330),r=Dn(r,n,s,i,t[4],7,-176418897),i=Dn(i,r,n,s,t[5],12,1200080426),s=Dn(s,i,r,n,t[6],17,-1473231341),n=Dn(n,s,i,r,t[7],22,-45705983),r=Dn(r,n,s,i,t[8],7,1770035416),i=Dn(i,r,n,s,t[9],12,-1958414417),s=Dn(s,i,r,n,t[10],17,-42063),n=Dn(n,s,i,r,t[11],22,-1990404162),r=Dn(r,n,s,i,t[12],7,1804603682),i=Dn(i,r,n,s,t[13],12,-40341101),s=Dn(s,i,r,n,t[14],17,-1502002290),r=In(r,n=Dn(n,s,i,r,t[15],22,1236535329),s,i,t[1],5,-165796510),i=In(i,r,n,s,t[6],9,-1069501632),s=In(s,i,r,n,t[11],14,643717713),n=In(n,s,i,r,t[0],20,-373897302),r=In(r,n,s,i,t[5],5,-701558691),i=In(i,r,n,s,t[10],9,38016083),s=In(s,i,r,n,t[15],14,-660478335),n=In(n,s,i,r,t[4],20,-405537848),r=In(r,n,s,i,t[9],5,568446438),i=In(i,r,n,s,t[14],9,-1019803690),s=In(s,i,r,n,t[3],14,-187363961),n=In(n,s,i,r,t[8],20,1163531501),r=In(r,n,s,i,t[13],5,-1444681467),i=In(i,r,n,s,t[2],9,-51403784),s=In(s,i,r,n,t[7],14,1735328473),r=Rn(r,n=In(n,s,i,r,t[12],20,-1926607734),s,i,t[5],4,-378558),i=Rn(i,r,n,s,t[8],11,-2022574463),s=Rn(s,i,r,n,t[11],16,1839030562),n=Rn(n,s,i,r,t[14],23,-35309556),r=Rn(r,n,s,i,t[1],4,-1530992060),i=Rn(i,r,n,s,t[4],11,1272893353),s=Rn(s,i,r,n,t[7],16,-155497632),n=Rn(n,s,i,r,t[10],23,-1094730640),r=Rn(r,n,s,i,t[13],4,681279174),i=Rn(i,r,n,s,t[0],11,-358537222),s=Rn(s,i,r,n,t[3],16,-722521979),n=Rn(n,s,i,r,t[6],23,76029189),r=Rn(r,n,s,i,t[9],4,-640364487),i=Rn(i,r,n,s,t[12],11,-421815835),s=Rn(s,i,r,n,t[15],16,530742520),r=Mn(r,n=Rn(n,s,i,r,t[2],23,-995338651),s,i,t[0],6,-198630844),i=Mn(i,r,n,s,t[7],10,1126891415),s=Mn(s,i,r,n,t[14],15,-1416354905),n=Mn(n,s,i,r,t[5],21,-57434055),r=Mn(r,n,s,i,t[12],6,1700485571),i=Mn(i,r,n,s,t[3],10,-1894986606),s=Mn(s,i,r,n,t[10],15,-1051523),n=Mn(n,s,i,r,t[1],21,-2054922799),r=Mn(r,n,s,i,t[8],6,1873313359),i=Mn(i,r,n,s,t[15],10,-30611744),s=Mn(s,i,r,n,t[6],15,-1560198380),n=Mn(n,s,i,r,t[13],21,1309151649),r=Mn(r,n,s,i,t[4],6,-145523070),i=Mn(i,r,n,s,t[11],10,-1120210379),s=Mn(s,i,r,n,t[2],15,718787259),n=Mn(n,s,i,r,t[9],21,-343485551),e[0]=uo(r,e[0]),e[1]=uo(n,e[1]),e[2]=uo(s,e[2]),e[3]=uo(i,e[3])}function Rm(e,t,r,n,s,i){return t=uo(uo(t,e),uo(n,i)),uo(t<<s|t>>>32-s,r)}function Dn(e,t,r,n,s,i,a){return Rm(t&r|~t&n,e,t,s,i,a)}function In(e,t,r,n,s,i,a){return Rm(t&n|r&~n,e,t,s,i,a)}function Rn(e,t,r,n,s,i,a){return Rm(t^r^n,e,t,s,i,a)}function Mn(e,t,r,n,s,i,a){return Rm(r^(t|~n),e,t,s,i,a)}function E_(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)p1(n,jC(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(p1(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,p1(n,s),n}function jC(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Cd=vt.atob.bind(vt),zg=vt.btoa.bind(vt);var Xy="0123456789abcdef".split("");function EC(e){for(var t="",r=0;r<4;r++)t+=Xy[e>>8*r+4&15]+Xy[e>>8*r&15];return t}function AC(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Wg(e){return E_(e).map(AC).join("")}var TC=function(e){for(var t=0;t<e.length;t++)e[t]=EC(e[t]);return e.join("")}(E_("hello"))!="5d41402abc4b2a76b9719d911017c592";function uo(e,t){if(TC){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Hg(e,t){var r,n,s,i;if(e!==r){for(var a=(s=e,i=1+(256/e.length>>0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+a.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var m=t.length,p=0,h=0,y="";for(c=0;c<m;c++)h=(h+(d=l[p=(p+1)%256]))%256,l[p]=l[h],l[h]=d,a=l[(l[p]+l[h])%256],y+=String.fromCharCode(t.charCodeAt(c)^a);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Jy={print:4,modify:8,copy:16,"annot-forms":32};function bc(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(Jy.perm!==void 0)throw new Error("Invalid permission: "+l);s+=Jy[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),a=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,a),this.P=-(1+(255^s)),this.encryptionKey=Wg(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Hg(this.encryptionKey,this.padding)}function _c(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?t+="#"+("0"+s.toString(16)).slice(-2):t+=e[n]}return t}function Qy(e){if(tr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!s],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[r]){var a=t[r][i];try{a[0].apply(e,n)}catch(l){vt.console&&ur.error("jsPDF PubSub Error",l.message,l)}a[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function df(e){if(!(this instanceof df))return new df(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function A_(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function ao(e,t,r,n,s){if(!(this instanceof ao))return new ao(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,A_.call(this,n,s)}function dl(e,t,r,n,s){if(!(this instanceof dl))return new dl(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,A_.call(this,n,s)}function mt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],a=[],l=1,c=16,u="S",d=null;tr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),a=e.filters||(i===!0?["FlateEncode"]:a),n=n||"mm",r=(""+(r||"P")).toLowerCase();var m=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=Qy;var y="1.3",g=h.__private__.getPdfVersion=function(){return y};h.__private__.setPdfVersion=function(N){y=N};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return w};var v=h.__private__.getPageFormat=function(N){return w[N]};s=s||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},_=b.COMPAT;function E(){this.saveGraphicsState(),le(new pt(st,0,0,-st,0,Da()*st).toString()+" cm"),this.setFontSize(this.getFontSize()/st),u="n",_=b.ADVANCED}function D(){this.restoreGraphicsState(),u="S",_=b.COMPAT}var I=h.__private__.combineFontStyleAndFontWeight=function(N,H){if(N=="bold"&&H=="normal"||N=="bold"&&H==400||N=="normal"&&H=="italic"||N=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(N=H==400||H==="normal"?N==="italic"?"italic":"normal":H!=700&&H!=="bold"||N!=="normal"?(H==700?"bold":H)+""+N:"bold"),N};h.advancedAPI=function(N){var H=_===b.COMPAT;return H&&E.call(this),typeof N!="function"||(N(this),H&&D.call(this)),this},h.compatAPI=function(N){var H=_===b.ADVANCED;return H&&D.call(this),typeof N!="function"||(N(this),H&&E.call(this)),this},h.isAdvancedAPI=function(){return _===b.ADVANCED};var A,P=function(N){if(_!==b.ADVANCED)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},C=h.roundToPrecision=h.__private__.roundToPrecision=function(N,H){var de=t||H;if(isNaN(N)||isNaN(de))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(de).replace(/0+$/,"")};A=h.hpf=h.__private__.hpf=typeof c=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return C(N,c)}:c==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return C(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return C(N,16)};var M=h.f2=h.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return C(N,2)},j=h.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return C(N,3)},T=h.scale=h.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return _===b.COMPAT?N*st:_===b.ADVANCED?N:void 0},q=function(N){return _===b.COMPAT?Da()-N:_===b.ADVANCED?N:void 0},U=function(N){return T(q(N))};h.__private__.setPrecision=h.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(t=parseInt(N,10))};var re,z="00000000000000000000000000000000",G=h.__private__.getFileId=function(){return z},B=h.__private__.setFileId=function(N){return z=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Pn=new bc(d.userPermissions,d.userPassword,d.ownerPassword,z)),z};h.setFileId=function(N){return B(N),this},h.getFileId=function(){return G()};var Y=h.__private__.convertDateToPDFDate=function(N){var H=N.getTimezoneOffset(),de=H<0?"+":"-",ge=Math.floor(Math.abs(H/60)),Ne=Math.abs(H%60),Fe=[de,R(ge),"'",R(Ne),"'"].join("");return["D:",N.getFullYear(),R(N.getMonth()+1),R(N.getDate()),R(N.getHours()),R(N.getMinutes()),R(N.getSeconds()),Fe].join("")},se=h.__private__.convertPDFDateToDate=function(N){var H=parseInt(N.substr(2,4),10),de=parseInt(N.substr(6,2),10)-1,ge=parseInt(N.substr(8,2),10),Ne=parseInt(N.substr(10,2),10),Fe=parseInt(N.substr(12,2),10),$e=parseInt(N.substr(14,2),10);return new Date(H,de,ge,Ne,Fe,$e,0)},me=h.__private__.setCreationDate=function(N){var H;if(N===void 0&&(N=new Date),N instanceof Date)H=Y(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=N}return re=H},S=h.__private__.getCreationDate=function(N){var H=re;return N==="jsDate"&&(H=se(re)),H};h.setCreationDate=function(N){return me(N),this},h.getCreationDate=function(N){return S(N)};var L,R=h.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},O=h.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},V=0,ne=[],ue=[],fe=0,ye=[],pe=[],_e=!1,Ue=ue,Ve=function(){V=0,fe=0,ue=[],ne=[],ye=[],ee=Tr(),te=Tr()};h.__private__.setCustomOutputDestination=function(N){_e=!0,Ue=N};var Se=function(N){_e||(Ue=N)};h.__private__.resetCustomOutputDestination=function(){_e=!1,Ue=ue};var le=h.__private__.out=function(N){return N=N.toString(),fe+=N.length+1,Ue.push(N),Ue},Me=h.__private__.write=function(N){return le(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},rt=h.__private__.getArrayBuffer=function(N){for(var H=N.length,de=new ArrayBuffer(H),ge=new Uint8Array(de);H--;)ge[H]=N.charCodeAt(H);return de},He=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return He};var Ke=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(N){return Ke=_===b.ADVANCED?N/st:N,this};var Ze,tt=h.__private__.getFontSize=h.getFontSize=function(){return _===b.COMPAT?Ke:Ke*st},dt=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(N){return dt=N,this},h.__private__.getR2L=h.getR2L=function(){return dt};var ft,bt=h.__private__.setZoomMode=function(N){var H=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))Ze=N;else if(isNaN(N)){if(H.indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');Ze=N}else Ze=parseInt(N,10)};h.__private__.getZoomMode=function(){return Ze};var Et,Ft=h.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');ft=N};h.__private__.getPageMode=function(){return ft};var Dt=h.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');Et=N};h.__private__.getLayoutMode=function(){return Et},h.__private__.setDisplayMode=h.setDisplayMode=function(N,H,de){return bt(N),Dt(H),Ft(de),this};var xt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(N){if(Object.keys(xt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt[N]},h.__private__.getDocumentProperties=function(){return xt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(N){for(var H in xt)xt.hasOwnProperty(H)&&N[H]&&(xt[H]=N[H]);return this},h.__private__.setDocumentProperty=function(N,H){if(Object.keys(xt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt[N]=H};var Ct,st,rn,Mt,ts,Yt={},dr={},Us=[],Ut={},Oi={},xr={},ys={},ai=null,lr=0,_t=[],Ht=new Qy(h),ra=e.hotfixes||[],nn={},zs={},Ws=[],pt=function N(H,de,ge,Ne,Fe,$e){if(!(this instanceof N))return new N(H,de,ge,Ne,Fe,$e);isNaN(H)&&(H=1),isNaN(de)&&(de=0),isNaN(ge)&&(ge=0),isNaN(Ne)&&(Ne=1),isNaN(Fe)&&(Fe=0),isNaN($e)&&($e=0),this._matrix=[H,de,ge,Ne,Fe,$e]};Object.defineProperty(pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),pt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(A).join(N)},pt.prototype.multiply=function(N){var H=N.sx*this.sx+N.shy*this.shx,de=N.sx*this.shy+N.shy*this.sy,ge=N.shx*this.sx+N.sy*this.shx,Ne=N.shx*this.shy+N.sy*this.sy,Fe=N.tx*this.sx+N.ty*this.shx+this.tx,$e=N.tx*this.shy+N.ty*this.sy+this.ty;return new pt(H,de,ge,Ne,Fe,$e)},pt.prototype.decompose=function(){var N=this.sx,H=this.shy,de=this.shx,ge=this.sy,Ne=this.tx,Fe=this.ty,$e=Math.sqrt(N*N+H*H),ot=(N/=$e)*de+(H/=$e)*ge;de-=N*ot,ge-=H*ot;var ht=Math.sqrt(de*de+ge*ge);return ot/=ht,N*(ge/=ht)<H*(de/=ht)&&(N=-N,H=-H,ot=-ot,$e=-$e),{scale:new pt($e,0,0,ht,0,0),translate:new pt(1,0,0,1,Ne,Fe),rotate:new pt(N,H,-H,N,0,0),skew:new pt(1,0,ot,1,0,0)}},pt.prototype.toString=function(N){return this.join(" ")},pt.prototype.inversed=function(){var N=this.sx,H=this.shy,de=this.shx,ge=this.sy,Ne=this.tx,Fe=this.ty,$e=1/(N*ge-H*de),ot=ge*$e,ht=-H*$e,jt=-de*$e,St=N*$e;return new pt(ot,ht,jt,St,-ot*Ne-jt*Fe,-ht*Ne-St*Fe)},pt.prototype.applyToPoint=function(N){var H=N.x*this.sx+N.y*this.shx+this.tx,de=N.x*this.shy+N.y*this.sy+this.ty;return new Gl(H,de)},pt.prototype.applyToRectangle=function(N){var H=this.applyToPoint(N),de=this.applyToPoint(new Gl(N.x+N.w,N.y+N.h));return new Tu(H.x,H.y,de.x-H.x,de.y-H.y)},pt.prototype.clone=function(){var N=this.sx,H=this.shy,de=this.shx,ge=this.sy,Ne=this.tx,Fe=this.ty;return new pt(N,H,de,ge,Ne,Fe)},h.Matrix=pt;var ws=h.matrixMult=function(N,H){return H.multiply(N)},rs=new pt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=rs;var Cn=function(N,H){if(!Oi[N]){var de=(H instanceof ao?"Sh":"P")+(Object.keys(Ut).length+1).toString(10);H.id=de,Oi[N]=de,Ut[de]=H,Ht.publish("addPattern",H)}};h.ShadingPattern=ao,h.TilingPattern=dl,h.addShadingPattern=function(N,H){return P("addShadingPattern()"),Cn(N,H),this},h.beginTilingPattern=function(N){P("beginTilingPattern()"),Kf(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},h.endTilingPattern=function(N,H){P("endTilingPattern()"),H.stream=pe[L].join(`
`),Cn(N,H),Ht.publish("endTilingPattern",H),Ws.pop().restore()};var Ir=h.__private__.newObject=function(){var N=Tr();return X(N,!0),N},Tr=h.__private__.newObjectDeferred=function(){return V++,ne[V]=function(){return fe},V},X=function(N,H){return H=typeof H=="boolean"&&H,ne[N]=fe,H&&le(N+" 0 obj"),N},oe=h.__private__.newAdditionalObject=function(){var N={objId:Tr(),content:""};return ye.push(N),N},ee=Tr(),te=Tr(),ae=h.__private__.decodeColorString=function(N){var H=N.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length===5&&(H[4]==="k"||H[4]==="K")&&(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var de=parseFloat(H[0]);H=[de,de,de,"r"]}for(var ge="#",Ne=0;Ne<3;Ne++)ge+=("0"+Math.floor(255*parseFloat(H[Ne])).toString(16)).slice(-2);return ge},ce=h.__private__.encodeColorString=function(N){var H;typeof N=="string"&&(N={ch1:N});var de=N.ch1,ge=N.ch2,Ne=N.ch3,Fe=N.ch4,$e=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof de=="string"&&de.charAt(0)!=="#"){var ot=new j_(de);if(ot.ok)de=ot.toHex();else if(!/^\d*\.?\d*$/.test(de))throw new Error('Invalid color "'+de+'" passed to jsPDF.encodeColorString.')}if(typeof de=="string"&&/^#[0-9A-Fa-f]{3}$/.test(de)&&(de="#"+de[1]+de[1]+de[2]+de[2]+de[3]+de[3]),typeof de=="string"&&/^#[0-9A-Fa-f]{6}$/.test(de)){var ht=parseInt(de.substr(1),16);de=ht>>16&255,ge=ht>>8&255,Ne=255&ht}if(ge===void 0||Fe===void 0&&de===ge&&ge===Ne)if(typeof de=="string")H=de+" "+$e[0];else switch(N.precision){case 2:H=M(de/255)+" "+$e[0];break;case 3:default:H=j(de/255)+" "+$e[0]}else if(Fe===void 0||tr(Fe)==="object"){if(Fe&&!isNaN(Fe.a)&&Fe.a===0)return H=["1.","1.","1.",$e[1]].join(" ");if(typeof de=="string")H=[de,ge,Ne,$e[1]].join(" ");else switch(N.precision){case 2:H=[M(de/255),M(ge/255),M(Ne/255),$e[1]].join(" ");break;default:case 3:H=[j(de/255),j(ge/255),j(Ne/255),$e[1]].join(" ")}}else if(typeof de=="string")H=[de,ge,Ne,Fe,$e[2]].join(" ");else switch(N.precision){case 2:H=[M(de),M(ge),M(Ne),M(Fe),$e[2]].join(" ");break;case 3:default:H=[j(de),j(ge),j(Ne),j(Fe),$e[2]].join(" ")}return H},je=h.__private__.getFilters=function(){return a},Pe=h.__private__.putStream=function(N){var H=(N=N||{}).data||"",de=N.filters||je(),ge=N.alreadyAppliedFilters||[],Ne=N.addLength1||!1,Fe=H.length,$e=N.objectId,ot=function(Ln){return Ln};if(d!==null&&$e===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(ot=Pn.encryptor($e,0));var ht={};de===!0&&(de=["FlateEncode"]);var jt=N.additionalKeyValues||[],St=(ht=mt.API.processDataByFilters!==void 0?mt.API.processDataByFilters(H,de):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(ge)?ge.join(" "):ge.toString());if(ht.data.length!==0&&(jt.push({key:"Length",value:ht.data.length}),Ne===!0&&jt.push({key:"Length1",value:Fe})),St.length!=0)if(St.split("/").length-1==1)jt.push({key:"Filter",value:St});else{jt.push({key:"Filter",value:"["+St+"]"});for(var Bt=0;Bt<jt.length;Bt+=1)if(jt[Bt].key==="DecodeParms"){for(var Sr=[],Cr=0;Cr<ht.reverseChain.split("/").length-1;Cr+=1)Sr.push("null");Sr.push(jt[Bt].value),jt[Bt].value="["+Sr.join(" ")+"]"}}le("<<");for(var Vr=0;Vr<jt.length;Vr++)le("/"+jt[Vr].key+" "+jt[Vr].value);le(">>"),ht.data.length!==0&&(le("stream"),le(ot(ht.data)),le("endstream"))},ke=h.__private__.putPage=function(N){var H=N.number,de=N.data,ge=N.objId,Ne=N.contentsObjId;X(ge,!0),le("<</Type /Page"),le("/Parent "+N.rootDictionaryObjId+" 0 R"),le("/Resources "+N.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(A(N.mediaBox.bottomLeftX))+" "+parseFloat(A(N.mediaBox.bottomLeftY))+" "+A(N.mediaBox.topRightX)+" "+A(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&le("/CropBox ["+A(N.cropBox.bottomLeftX)+" "+A(N.cropBox.bottomLeftY)+" "+A(N.cropBox.topRightX)+" "+A(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&le("/BleedBox ["+A(N.bleedBox.bottomLeftX)+" "+A(N.bleedBox.bottomLeftY)+" "+A(N.bleedBox.topRightX)+" "+A(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&le("/TrimBox ["+A(N.trimBox.bottomLeftX)+" "+A(N.trimBox.bottomLeftY)+" "+A(N.trimBox.topRightX)+" "+A(N.trimBox.topRightY)+"]"),N.artBox!==null&&le("/ArtBox ["+A(N.artBox.bottomLeftX)+" "+A(N.artBox.bottomLeftY)+" "+A(N.artBox.topRightX)+" "+A(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&le("/UserUnit "+N.userUnit),Ht.publish("putPage",{objId:ge,pageContext:_t[H],pageNumber:H,page:de}),le("/Contents "+Ne+" 0 R"),le(">>"),le("endobj");var Fe=de.join(`
`);return _===b.ADVANCED&&(Fe+=`
Q`),X(Ne,!0),Pe({data:Fe,filters:je(),objectId:Ne}),le("endobj"),ge},Te=h.__private__.putPages=function(){var N,H,de=[];for(N=1;N<=lr;N++)_t[N].objId=Tr(),_t[N].contentsObjId=Tr();for(N=1;N<=lr;N++)de.push(ke({number:N,data:pe[N],objId:_t[N].objId,contentsObjId:_t[N].contentsObjId,mediaBox:_t[N].mediaBox,cropBox:_t[N].cropBox,bleedBox:_t[N].bleedBox,trimBox:_t[N].trimBox,artBox:_t[N].artBox,userUnit:_t[N].userUnit,rootDictionaryObjId:ee,resourceDictionaryObjId:te}));X(ee,!0),le("<</Type /Pages");var ge="/Kids [";for(H=0;H<lr;H++)ge+=de[H]+" 0 R ";le(ge+"]"),le("/Count "+lr),le(">>"),le("endobj"),Ht.publish("postPutPages")},Ce=function(N){Ht.publish("putFont",{font:N,out:le,newObject:Ir,putStream:Pe}),N.isAlreadyPutted!==!0&&(N.objectNumber=Ir(),le("<<"),le("/Type /Font"),le("/BaseFont /"+_c(N.postScriptName)),le("/Subtype /Type1"),typeof N.encoding=="string"&&le("/Encoding /"+N.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},qe=function(){for(var N in Yt)Yt.hasOwnProperty(N)&&(m===!1||m===!0&&p.hasOwnProperty(N))&&Ce(Yt[N])},Xe=function(N){N.objectNumber=Ir();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[A(N.x),A(N.y),A(N.x+N.width),A(N.y+N.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var de=N.pages[1].join(`
`);Pe({data:de,additionalKeyValues:H,objectId:N.objectNumber}),le("endobj")},at=function(){for(var N in nn)nn.hasOwnProperty(N)&&Xe(nn[N])},Ye=function(N,H){var de,ge=[],Ne=1/(H-1);for(de=0;de<1;de+=Ne)ge.push(de);if(ge.push(1),N[0].offset!=0){var Fe={offset:0,color:N[0].color};N.unshift(Fe)}if(N[N.length-1].offset!=1){var $e={offset:1,color:N[N.length-1].color};N.push($e)}for(var ot="",ht=0,jt=0;jt<ge.length;jt++){for(de=ge[jt];de>N[ht+1].offset;)ht++;var St=N[ht].offset,Bt=(de-St)/(N[ht+1].offset-St),Sr=N[ht].color,Cr=N[ht+1].color;ot+=O(Math.round((1-Bt)*Sr[0]+Bt*Cr[0]).toString(16))+O(Math.round((1-Bt)*Sr[1]+Bt*Cr[1]).toString(16))+O(Math.round((1-Bt)*Sr[2]+Bt*Cr[2]).toString(16))}return ot.trim()},it=function(N,H){H||(H=21);var de=Ir(),ge=Ye(N.colors,H),Ne=[];Ne.push({key:"FunctionType",value:"0"}),Ne.push({key:"Domain",value:"[0.0 1.0]"}),Ne.push({key:"Size",value:"["+H+"]"}),Ne.push({key:"BitsPerSample",value:"8"}),Ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pe({data:ge,additionalKeyValues:Ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:de}),le("endobj"),N.objectNumber=Ir(),le("<< /ShadingType "+N.type),le("/ColorSpace /DeviceRGB");var Fe="/Coords ["+A(parseFloat(N.coords[0]))+" "+A(parseFloat(N.coords[1]))+" ";N.type===2?Fe+=A(parseFloat(N.coords[2]))+" "+A(parseFloat(N.coords[3])):Fe+=A(parseFloat(N.coords[2]))+" "+A(parseFloat(N.coords[3]))+" "+A(parseFloat(N.coords[4]))+" "+A(parseFloat(N.coords[5])),le(Fe+="]"),N.matrix&&le("/Matrix ["+N.matrix.toString()+"]"),le("/Function "+de+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},wt=function(N,H){var de=Tr(),ge=Ir();H.push({resourcesOid:de,objectOid:ge}),N.objectNumber=ge;var Ne=[];Ne.push({key:"Type",value:"/Pattern"}),Ne.push({key:"PatternType",value:"1"}),Ne.push({key:"PaintType",value:"1"}),Ne.push({key:"TilingType",value:"1"}),Ne.push({key:"BBox",value:"["+N.boundingBox.map(A).join(" ")+"]"}),Ne.push({key:"XStep",value:A(N.xStep)}),Ne.push({key:"YStep",value:A(N.yStep)}),Ne.push({key:"Resources",value:de+" 0 R"}),N.matrix&&Ne.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),Pe({data:N.stream,additionalKeyValues:Ne,objectId:N.objectNumber}),le("endobj")},Kt=function(N){var H;for(H in Ut)Ut.hasOwnProperty(H)&&(Ut[H]instanceof ao?it(Ut[H]):Ut[H]instanceof dl&&wt(Ut[H],N))},ir=function(N){for(var H in N.objectNumber=Ir(),le("<<"),N)switch(H){case"opacity":le("/ca "+M(N[H]));break;case"stroke-opacity":le("/CA "+M(N[H]))}le(">>"),le("endobj")},qr=function(){var N;for(N in xr)xr.hasOwnProperty(N)&&ir(xr[N])},oi=function(){for(var N in le("/XObject <<"),nn)nn.hasOwnProperty(N)&&nn[N].objectNumber>=0&&le("/"+N+" "+nn[N].objectNumber+" 0 R");Ht.publish("putXobjectDict"),le(">>")},na=function(){Pn.oid=Ir(),le("<<"),le("/Filter /Standard"),le("/V "+Pn.v),le("/R "+Pn.r),le("/U <"+Pn.toHexString(Pn.U)+">"),le("/O <"+Pn.toHexString(Pn.O)+">"),le("/P "+Pn.P),le(">>"),le("endobj")},Di=function(){for(var N in le("/Font <<"),Yt)Yt.hasOwnProperty(N)&&(m===!1||m===!0&&p.hasOwnProperty(N))&&le("/"+N+" "+Yt[N].objectNumber+" 0 R");le(">>")},li=function(){if(Object.keys(Ut).length>0){for(var N in le("/Shading <<"),Ut)Ut.hasOwnProperty(N)&&Ut[N]instanceof ao&&Ut[N].objectNumber>=0&&le("/"+N+" "+Ut[N].objectNumber+" 0 R");Ht.publish("putShadingPatternDict"),le(">>")}},Ii=function(N){if(Object.keys(Ut).length>0){for(var H in le("/Pattern <<"),Ut)Ut.hasOwnProperty(H)&&Ut[H]instanceof h.TilingPattern&&Ut[H].objectNumber>=0&&Ut[H].objectNumber<N&&le("/"+H+" "+Ut[H].objectNumber+" 0 R");Ht.publish("putTilingPatternDict"),le(">>")}},bs=function(){if(Object.keys(xr).length>0){var N;for(N in le("/ExtGState <<"),xr)xr.hasOwnProperty(N)&&xr[N].objectNumber>=0&&le("/"+N+" "+xr[N].objectNumber+" 0 R");Ht.publish("putGStateDict"),le(">>")}},Rr=function(N){X(N.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Di(),li(),Ii(N.objectOid),bs(),oi(),le(">>"),le("endobj")},Of=function(){var N=[];qe(),qr(),at(),Kt(N),Ht.publish("putResources"),N.forEach(Rr),Rr({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),Ht.publish("postPutResources")},Df=function(){Ht.publish("putAdditionalObjects");for(var N=0;N<ye.length;N++){var H=ye[N];X(H.objId,!0),le(H.content),le("endobj")}Ht.publish("postPutAdditionalObjects")},If=function(N){dr[N.fontName]=dr[N.fontName]||{},dr[N.fontName][N.fontStyle]=N.id},wu=function(N,H,de,ge,Ne){var Fe={id:"F"+(Object.keys(Yt).length+1).toString(10),postScriptName:N,fontName:H,fontStyle:de,encoding:ge,isStandardFont:Ne||!1,metadata:{}};return Ht.publish("addFont",{font:Fe,instance:this}),Yt[Fe.id]=Fe,If(Fe),Fe.id},Vm=function(N){for(var H=0,de=He.length;H<de;H++){var ge=wu.call(this,N[H][0],N[H][1],N[H][2],He[H][3],!0);m===!1&&(p[ge]=!0);var Ne=N[H][0].split("-");If({id:ge,fontName:Ne[0],fontStyle:Ne[1]||""})}Ht.publish("addFonts",{fonts:Yt,dictionary:dr})},ci=function(N){return N.foo=function(){try{return N.apply(this,arguments)}catch(ge){var H=ge.stack||"";~H.indexOf(" at ")&&(H=H.split(" at ")[1]);var de="Error in function "+H.split(`
`)[0].split("<")[0]+": "+ge.message;if(!vt.console)throw new Error(de);vt.console.error(de,ge),vt.alert&&alert(de)}},N.foo.bar=N,N.foo},zl=function(N,H){var de,ge,Ne,Fe,$e,ot,ht,jt,St;if(Ne=(H=H||{}).sourceEncoding||"Unicode",$e=H.outputEncoding,(H.autoencode||$e)&&Yt[Ct].metadata&&Yt[Ct].metadata[Ne]&&Yt[Ct].metadata[Ne].encoding&&(Fe=Yt[Ct].metadata[Ne].encoding,!$e&&Yt[Ct].encoding&&($e=Yt[Ct].encoding),!$e&&Fe.codePages&&($e=Fe.codePages[0]),typeof $e=="string"&&($e=Fe[$e]),$e)){for(ht=!1,ot=[],de=0,ge=N.length;de<ge;de++)(jt=$e[N.charCodeAt(de)])?ot.push(String.fromCharCode(jt)):ot.push(N[de]),ot[de].charCodeAt(0)>>8&&(ht=!0);N=ot.join("")}for(de=N.length;ht===void 0&&de!==0;)N.charCodeAt(de-1)>>8&&(ht=!0),de--;if(!ht)return N;for(ot=H.noBOM?[]:[254,255],de=0,ge=N.length;de<ge;de++){if((St=(jt=N.charCodeAt(de))>>8)>>8)throw new Error("Character at position "+de+" of string '"+N+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ot.push(St),ot.push(jt-(St<<8))}return String.fromCharCode.apply(void 0,ot)},ns=h.__private__.pdfEscape=h.pdfEscape=function(N,H){return zl(N,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bu=h.__private__.beginPage=function(N){pe[++lr]=[],_t[lr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Mf(lr),Se(pe[L])},Rf=function(N,H){var de,ge,Ne;switch(r=H||r,typeof N=="string"&&(de=v(N.toLowerCase()),Array.isArray(de)&&(ge=de[0],Ne=de[1])),Array.isArray(N)&&(ge=N[0]*st,Ne=N[1]*st),isNaN(ge)&&(ge=s[0],Ne=s[1]),(ge>14400||Ne>14400)&&(ur.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ge=Math.min(14400,ge),Ne=Math.min(14400,Ne)),s=[ge,Ne],r.substr(0,1)){case"l":Ne>ge&&(s=[Ne,ge]);break;case"p":ge>Ne&&(s=[Ne,ge])}bu(s),$f(ku),le(ui),Eu!==0&&le(Eu+" J"),Au!==0&&le(Au+" j"),Ht.publish("addPage",{pageNumber:lr})},Gm=function(N){N>0&&N<=lr&&(pe.splice(N,1),_t.splice(N,1),lr--,L>lr&&(L=lr),this.setPage(L))},Mf=function(N){N>0&&N<=lr&&(L=N)},Ym=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return pe.length-1},Bf=function(N,H,de){var ge,Ne=void 0;return de=de||{},N=N!==void 0?N:Yt[Ct].fontName,H=H!==void 0?H:Yt[Ct].fontStyle,ge=N.toLowerCase(),dr[ge]!==void 0&&dr[ge][H]!==void 0?Ne=dr[ge][H]:dr[N]!==void 0&&dr[N][H]!==void 0?Ne=dr[N][H]:de.disableWarning===!1&&ur.warn("Unable to look up font label for font '"+N+"', '"+H+"'. Refer to getFontList() for available fonts."),Ne||de.noFallback||(Ne=dr.times[H])==null&&(Ne=dr.times.normal),Ne},Km=h.__private__.putInfo=function(){var N=Ir(),H=function(ge){return ge};for(var de in d!==null&&(H=Pn.encryptor(N,0)),le("<<"),le("/Producer ("+ns(H("jsPDF "+mt.version))+")"),xt)xt.hasOwnProperty(de)&&xt[de]&&le("/"+de.substr(0,1).toUpperCase()+de.substr(1)+" ("+ns(H(xt[de]))+")");le("/CreationDate ("+ns(H(re))+")"),le(">>"),le("endobj")},_u=h.__private__.putCatalog=function(N){var H=(N=N||{}).rootDictionaryObjId||ee;switch(Ir(),le("<<"),le("/Type /Catalog"),le("/Pages "+H+" 0 R"),Ze||(Ze="fullwidth"),Ze){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var de=""+Ze;de.substr(de.length-1)==="%"&&(Ze=parseInt(Ze)/100),typeof Ze=="number"&&le("/OpenAction [3 0 R /XYZ null null "+M(Ze)+"]")}switch(Et||(Et="continuous"),Et){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}ft&&le("/PageMode /"+ft),Ht.publish("putCatalog"),le(">>"),le("endobj")},Xm=h.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(V+1)),le("/Root "+V+" 0 R"),le("/Info "+(V-1)+" 0 R"),d!==null&&le("/Encrypt "+Pn.oid+" 0 R"),le("/ID [ <"+z+"> <"+z+"> ]"),le(">>")},Jm=h.__private__.putHeader=function(){le("%PDF-"+y),le("%")},Qm=h.__private__.putXRef=function(){var N="0000000000";le("xref"),le("0 "+(V+1)),le("0000000000 65535 f ");for(var H=1;H<=V;H++)typeof ne[H]=="function"?le((N+ne[H]()).slice(-10)+" 00000 n "):ne[H]!==void 0?le((N+ne[H]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},sa=h.__private__.buildDocument=function(){Ve(),Se(ue),Ht.publish("buildDocument"),Jm(),Te(),Df(),Of(),d!==null&&na(),Km(),_u();var N=fe;return Qm(),Xm(),le("startxref"),le(""+N),le("%%EOF"),Se(pe[L]),ue.join(`
`)},Wl=h.__private__.getBlob=function(N){return new Blob([rt(N)],{type:"application/pdf"})},Hl=h.output=h.__private__.output=ci(function(N,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",N){case void 0:return sa();case"save":h.save(H.filename);break;case"arraybuffer":return rt(sa());case"blob":return Wl(sa());case"bloburi":case"bloburl":if(vt.URL!==void 0&&typeof vt.URL.createObjectURL=="function")return vt.URL&&vt.URL.createObjectURL(Wl(sa()))||void 0;ur.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var de="",ge=sa();try{de=zg(ge)}catch{de=zg(unescape(encodeURIComponent(ge)))}return"data:application/pdf;filename="+H.filename+";base64,"+de;case"pdfobjectnewwindow":if(Object.prototype.toString.call(vt)==="[object Window]"){var Ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Fe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(Ne=H.pdfObjectUrl,Fe="");var $e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ne+'"'+Fe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",ot=vt.open();return ot!==null&&ot.document.write($e),ot}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(vt)==="[object Window]"){var ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',jt=vt.open();if(jt!==null){jt.document.write(ht);var St=this;jt.document.documentElement.querySelector("#pdfViewer").onload=function(){jt.document.title=H.filename,jt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(St.output("bloburl"))}}return jt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(vt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Bt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',Sr=vt.open();if(Sr!==null&&(Sr.document.write(Bt),Sr.document.title=H.filename),Sr||typeof safari>"u")return Sr;break;case"datauri":case"dataurl":return vt.document.location.href=this.output("datauristring",H);default:return null}}),Uf=function(N){return Array.isArray(ra)===!0&&ra.indexOf(N)>-1};switch(n){case"pt":st=1;break;case"mm":st=72/25.4;break;case"cm":st=72/2.54;break;case"in":st=72;break;case"px":st=Uf("px_scaling")==1?.75:96/72;break;case"pc":case"em":st=12;break;case"ex":st=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);st=n}var Pn=null;me(),B();var Zm=function(N){return d!==null?Pn.encryptor(N,0):function(H){return H}},zf=h.__private__.getPageInfo=h.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_t[N].objId,pageNumber:N,pageContext:_t[N]}},Nt=h.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in _t)if(_t[H].objId===N)break;return zf(H)},ep=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:_t[L].objId,pageNumber:L,pageContext:_t[L]}};h.addPage=function(){return Rf.apply(this,arguments),this},h.setPage=function(){return Mf.apply(this,arguments),Se.call(this,pe[L]),this},h.insertPage=function(N){return this.addPage(),this.movePage(L,N),this},h.movePage=function(N,H){var de,ge;if(N>H){de=pe[N],ge=_t[N];for(var Ne=N;Ne>H;Ne--)pe[Ne]=pe[Ne-1],_t[Ne]=_t[Ne-1];pe[H]=de,_t[H]=ge,this.setPage(H)}else if(N<H){de=pe[N],ge=_t[N];for(var Fe=N;Fe<H;Fe++)pe[Fe]=pe[Fe+1],_t[Fe]=_t[Fe+1];pe[H]=de,_t[H]=ge,this.setPage(H)}return this},h.deletePage=function(){return Gm.apply(this,arguments),this},h.__private__.text=h.text=function(N,H,de,ge,Ne){var Fe,$e,ot,ht,jt,St,Bt,Sr,Cr,Vr=(ge=ge||{}).scope||this;if(typeof N=="number"&&typeof H=="number"&&(typeof de=="string"||Array.isArray(de))){var Ln=de;de=H,H=N,N=Ln}if(arguments[3]instanceof pt?(P("The transform parameter of text() with a Matrix value"),Cr=Ne):(ot=arguments[4],ht=arguments[5],tr(Bt=arguments[3])==="object"&&Bt!==null||(typeof ot=="string"&&(ht=ot,ot=null),typeof Bt=="string"&&(ht=Bt,Bt=null),typeof Bt=="number"&&(ot=Bt,Bt=null),ge={flags:Bt,angle:ot,align:ht})),isNaN(H)||isNaN(de)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return Vr;var un="",di=!1,_s=typeof ge.lineHeightFactor=="number"?ge.lineHeightFactor:$o,Bi=Vr.internal.scaleFactor;function Xf(fr){return fr=fr.split("	").join(Array(ge.TabLen||9).join(" ")),ns(fr,Bt)}function Fu(fr){for(var hr,Br=fr.concat(),sn=[],ca=Br.length;ca--;)typeof(hr=Br.shift())=="string"?sn.push(hr):Array.isArray(fr)&&(hr.length===1||hr[1]===void 0&&hr[2]===void 0)?sn.push(hr[0]):sn.push([hr[0],hr[1],hr[2]]);return sn}function Ou(fr,hr){var Br;if(typeof fr=="string")Br=hr(fr)[0];else if(Array.isArray(fr)){for(var sn,ca,Wu=fr.concat(),sc=[],th=Wu.length;th--;)typeof(sn=Wu.shift())=="string"?sc.push(hr(sn)[0]):Array.isArray(sn)&&typeof sn[0]=="string"&&(ca=hr(sn[0],sn[1],sn[2]),sc.push([ca[0],ca[1],ca[2]]));Br=sc}return Br}var Kl=!1,Du=!0;if(typeof N=="string")Kl=!0;else if(Array.isArray(N)){var Iu=N.concat();$e=[];for(var Xl,yn=Iu.length;yn--;)(typeof(Xl=Iu.shift())!="string"||Array.isArray(Xl)&&typeof Xl[0]!="string")&&(Du=!1);Kl=Du}if(Kl===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var Jl=Ke/Vr.internal.scaleFactor,Ql=Jl*(_s-1);switch(ge.baseline){case"bottom":de-=Ql;break;case"top":de+=Jl-Ql;break;case"hanging":de+=Jl-2*Ql;break;case"middle":de+=Jl/2-Ql}if((St=ge.maxWidth||0)>0&&(typeof N=="string"?N=Vr.splitTextToSize(N,St):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(fr,hr){return fr.concat(Vr.splitTextToSize(hr,St))},[]))),Fe={text:N,x:H,y:de,options:ge,mutex:{pdfEscape:ns,activeFontKey:Ct,fonts:Yt,activeFontSize:Ke}},Ht.publish("preProcessText",Fe),N=Fe.text,ot=(ge=Fe.options).angle,!(Cr instanceof pt)&&ot&&typeof ot=="number"){ot*=Math.PI/180,ge.rotationDirection===0&&(ot=-ot),_===b.ADVANCED&&(ot=-ot);var Zl=Math.cos(ot),Ru=Math.sin(ot);Cr=new pt(Zl,Ru,-Ru,Zl,0,0)}else ot&&ot instanceof pt&&(Cr=ot);_!==b.ADVANCED||Cr||(Cr=rs),(jt=ge.charSpace||Vl)!==void 0&&(un+=A(T(jt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Sr=ge.horizontalScale)!==void 0&&(un+=A(100*Sr)+` Tz
`),ge.lang;var ss=-1,up=ge.renderingMode!==void 0?ge.renderingMode:ge.stroke,Mu=Vr.internal.getCurrentPageInfo().pageContext;switch(up){case 0:case!1:case"fill":ss=0;break;case 1:case!0:case"stroke":ss=1;break;case 2:case"fillThenStroke":ss=2;break;case 3:case"invisible":ss=3;break;case 4:case"fillAndAddForClipping":ss=4;break;case 5:case"strokeAndAddPathForClipping":ss=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ss=6;break;case 7:case"addToPathForClipping":ss=7}var Jf=Mu.usedRenderingMode!==void 0?Mu.usedRenderingMode:-1;ss!==-1?un+=ss+` Tr
`:Jf!==-1&&(un+=`0 Tr
`),ss!==-1&&(Mu.usedRenderingMode=ss),ht=ge.align||"left";var Hs,ec=Ke*_s,Qf=Vr.internal.pageSize.getWidth(),Zf=Yt[Ct];jt=ge.charSpace||Vl,St=ge.maxWidth||0,Bt=Object.assign({autoencode:!0,noBOM:!0},ge.flags);var Ia=[],Go=function(fr){return Vr.getStringUnitWidth(fr,{font:Zf,charSpace:jt,fontSize:Ke,doKerning:!1})*Ke/Bi};if(Object.prototype.toString.call(N)==="[object Array]"){var is;$e=Fu(N),ht!=="left"&&(Hs=$e.map(Go));var $n,Ra=0;if(ht==="right"){H-=Hs[0],N=[],yn=$e.length;for(var aa=0;aa<yn;aa++)aa===0?($n=Mi(H),is=ia(de)):($n=T(Ra-Hs[aa]),is=-ec),N.push([$e[aa],$n,is]),Ra=Hs[aa]}else if(ht==="center"){H-=Hs[0]/2,N=[],yn=$e.length;for(var oa=0;oa<yn;oa++)oa===0?($n=Mi(H),is=ia(de)):($n=T((Ra-Hs[oa])/2),is=-ec),N.push([$e[oa],$n,is]),Ra=Hs[oa]}else if(ht==="left"){N=[],yn=$e.length;for(var tc=0;tc<yn;tc++)N.push($e[tc])}else if(ht==="justify"&&Zf.encoding==="Identity-H"){N=[],yn=$e.length,St=St!==0?St:Qf;for(var la=0,Mr=0;Mr<yn;Mr++)if(is=Mr===0?ia(de):-ec,$n=Mr===0?Mi(H):la,Mr<yn-1){var Bu=T((St-Hs[Mr])/($e[Mr].split(" ").length-1)),qn=$e[Mr].split(" ");N.push([qn[0]+" ",$n,is]),la=0;for(var $s=1;$s<qn.length;$s++){var rc=(Go(qn[$s-1]+" "+qn[$s])-Go(qn[$s]))*Bi+Bu;$s==qn.length-1?N.push([qn[$s],rc,0]):N.push([qn[$s]+" ",rc,0]),la-=rc}}else N.push([$e[Mr],$n,is]);N.push(["",la,0])}else{if(ht!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],yn=$e.length,St=St!==0?St:Qf,Mr=0;Mr<yn;Mr++)is=Mr===0?ia(de):-ec,$n=Mr===0?Mi(H):0,Mr<yn-1?Ia.push(A(T((St-Hs[Mr])/($e[Mr].split(" ").length-1)))):Ia.push(0),N.push([$e[Mr],$n,is])}}var eh=typeof ge.R2L=="boolean"?ge.R2L:dt;eh===!0&&(N=Ou(N,function(fr,hr,Br){return[fr.split("").reverse().join(""),hr,Br]})),Fe={text:N,x:H,y:de,options:ge,mutex:{pdfEscape:ns,activeFontKey:Ct,fonts:Yt,activeFontSize:Ke}},Ht.publish("postProcessText",Fe),N=Fe.text,di=Fe.mutex.isHex||!1;var Uu=Yt[Ct].encoding;Uu!=="WinAnsiEncoding"&&Uu!=="StandardEncoding"||(N=Ou(N,function(fr,hr,Br){return[Xf(fr),hr,Br]})),$e=Fu(N),N=[];for(var Yo,Ko,Ma,Xo=0,nc=1,Jo=Array.isArray($e[0])?nc:Xo,Ba="",zu=function(fr,hr,Br){var sn="";return Br instanceof pt?(Br=typeof ge.angle=="number"?ws(Br,new pt(1,0,0,1,fr,hr)):ws(new pt(1,0,0,1,fr,hr),Br),_===b.ADVANCED&&(Br=ws(new pt(1,0,0,-1,0,0),Br)),sn=Br.join(" ")+` Tm
`):sn=A(fr)+" "+A(hr)+` Td
`,sn},qs=0;qs<$e.length;qs++){switch(Ba="",Jo){case nc:Ma=(di?"<":"(")+$e[qs][0]+(di?">":")"),Yo=parseFloat($e[qs][1]),Ko=parseFloat($e[qs][2]);break;case Xo:Ma=(di?"<":"(")+$e[qs]+(di?">":")"),Yo=Mi(H),Ko=ia(de)}Ia!==void 0&&Ia[qs]!==void 0&&(Ba=Ia[qs]+` Tw
`),qs===0?N.push(Ba+zu(Yo,Ko,Cr)+Ma):Jo===Xo?N.push(Ba+Ma):Jo===nc&&N.push(Ba+zu(Yo,Ko,Cr)+Ma)}N=Jo===Xo?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var Vs=`BT
/`;return Vs+=Ct+" "+Ke+` Tf
`,Vs+=A(Ke*_s)+` TL
`,Vs+=qo+`
`,Vs+=un,Vs+=N,le(Vs+="ET"),p[Ct]=!0,Vr};var tp=h.__private__.clip=h.clip=function(N){return le(N==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return tp("evenodd")},h.__private__.discardPath=h.discardPath=function(){return le("n"),this};var Ri=h.__private__.isValidStyle=function(N){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(H=!0),H};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(N){return Ri(N)&&(u=N),this};var Wf=h.__private__.getStyle=h.getStyle=function(N){var H=u;switch(N){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=N}return H},Hf=h.close=function(){return le("h"),this};h.stroke=function(){return le("S"),this},h.fill=function(N){return $l("f",N),this},h.fillEvenOdd=function(N){return $l("f*",N),this},h.fillStroke=function(N){return $l("B",N),this},h.fillStrokeEvenOdd=function(N){return $l("B*",N),this};var $l=function(N,H){tr(H)==="object"?np(H,N):le(N)},Nu=function(N){N===null||_===b.ADVANCED&&N===void 0||(N=Wf(N),le(N))};function rp(N,H,de,ge,Ne){var Fe=new dl(H||this.boundingBox,de||this.xStep,ge||this.yStep,this.gState,Ne||this.matrix);Fe.stream=this.stream;var $e=N+"$$"+this.cloneIndex+++"$$";return Cn($e,Fe),Fe}var np=function(N,H){var de=Oi[N.key],ge=Ut[de];if(ge instanceof ao)le("q"),le(sp(H)),ge.gState&&h.setGState(ge.gState),le(N.matrix.toString()+" cm"),le("/"+de+" sh"),le("Q");else if(ge instanceof dl){var Ne=new pt(1,0,0,-1,0,Da());N.matrix&&(Ne=Ne.multiply(N.matrix||rs),de=rp.call(ge,N.key,N.boundingBox,N.xStep,N.yStep,Ne).id),le("q"),le("/Pattern cs"),le("/"+de+" scn"),ge.gState&&h.setGState(ge.gState),le(H),le("Q")}},sp=function(N){switch(N){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Su=h.moveTo=function(N,H){return le(A(T(N))+" "+A(U(H))+" m"),this},Ho=h.lineTo=function(N,H){return le(A(T(N))+" "+A(U(H))+" l"),this},Fa=h.curveTo=function(N,H,de,ge,Ne,Fe){return le([A(T(N)),A(U(H)),A(T(de)),A(U(ge)),A(T(Ne)),A(U(Fe)),"c"].join(" ")),this};h.__private__.line=h.line=function(N,H,de,ge,Ne){if(isNaN(N)||isNaN(H)||isNaN(de)||isNaN(ge)||!Ri(Ne))throw new Error("Invalid arguments passed to jsPDF.line");return _===b.COMPAT?this.lines([[de-N,ge-H]],N,H,[1,1],Ne||"S"):this.lines([[de-N,ge-H]],N,H,[1,1]).stroke()},h.__private__.lines=h.lines=function(N,H,de,ge,Ne,Fe){var $e,ot,ht,jt,St,Bt,Sr,Cr,Vr,Ln,un,di;if(typeof N=="number"&&(di=de,de=H,H=N,N=di),ge=ge||[1,1],Fe=Fe||!1,isNaN(H)||isNaN(de)||!Array.isArray(N)||!Array.isArray(ge)||!Ri(Ne)||typeof Fe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Su(H,de),$e=ge[0],ot=ge[1],jt=N.length,Ln=H,un=de,ht=0;ht<jt;ht++)(St=N[ht]).length===2?(Ln=St[0]*$e+Ln,un=St[1]*ot+un,Ho(Ln,un)):(Bt=St[0]*$e+Ln,Sr=St[1]*ot+un,Cr=St[2]*$e+Ln,Vr=St[3]*ot+un,Ln=St[4]*$e+Ln,un=St[5]*ot+un,Fa(Bt,Sr,Cr,Vr,Ln,un));return Fe&&Hf(),Nu(Ne),this},h.path=function(N){for(var H=0;H<N.length;H++){var de=N[H],ge=de.c;switch(de.op){case"m":Su(ge[0],ge[1]);break;case"l":Ho(ge[0],ge[1]);break;case"c":Fa.apply(this,ge);break;case"h":Hf()}}return this},h.__private__.rect=h.rect=function(N,H,de,ge,Ne){if(isNaN(N)||isNaN(H)||isNaN(de)||isNaN(ge)||!Ri(Ne))throw new Error("Invalid arguments passed to jsPDF.rect");return _===b.COMPAT&&(ge=-ge),le([A(T(N)),A(U(H)),A(T(de)),A(T(ge)),"re"].join(" ")),Nu(Ne),this},h.__private__.triangle=h.triangle=function(N,H,de,ge,Ne,Fe,$e){if(isNaN(N)||isNaN(H)||isNaN(de)||isNaN(ge)||isNaN(Ne)||isNaN(Fe)||!Ri($e))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[de-N,ge-H],[Ne-de,Fe-ge],[N-Ne,H-Fe]],N,H,[1,1],$e,!0),this},h.__private__.roundedRect=h.roundedRect=function(N,H,de,ge,Ne,Fe,$e){if(isNaN(N)||isNaN(H)||isNaN(de)||isNaN(ge)||isNaN(Ne)||isNaN(Fe)||!Ri($e))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ot=4/3*(Math.SQRT2-1);return Ne=Math.min(Ne,.5*de),Fe=Math.min(Fe,.5*ge),this.lines([[de-2*Ne,0],[Ne*ot,0,Ne,Fe-Fe*ot,Ne,Fe],[0,ge-2*Fe],[0,Fe*ot,-Ne*ot,Fe,-Ne,Fe],[2*Ne-de,0],[-Ne*ot,0,-Ne,-Fe*ot,-Ne,-Fe],[0,2*Fe-ge],[0,-Fe*ot,Ne*ot,-Fe,Ne,-Fe]],N+Ne,H,[1,1],$e,!0),this},h.__private__.ellipse=h.ellipse=function(N,H,de,ge,Ne){if(isNaN(N)||isNaN(H)||isNaN(de)||isNaN(ge)||!Ri(Ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Fe=4/3*(Math.SQRT2-1)*de,$e=4/3*(Math.SQRT2-1)*ge;return Su(N+de,H),Fa(N+de,H-$e,N+Fe,H-ge,N,H-ge),Fa(N-Fe,H-ge,N-de,H-$e,N-de,H),Fa(N-de,H+$e,N-Fe,H+ge,N,H+ge),Fa(N+Fe,H+ge,N+de,H+$e,N+de,H),Nu(Ne),this},h.__private__.circle=h.circle=function(N,H,de,ge){if(isNaN(N)||isNaN(H)||isNaN(de)||!Ri(ge))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,H,de,de,ge)},h.setFont=function(N,H,de){return de&&(H=I(H,de)),Ct=Bf(N,H,{disableWarning:!1}),this};var ip=h.__private__.getFont=h.getFont=function(){return Yt[Bf.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var N,H,de={};for(N in dr)if(dr.hasOwnProperty(N))for(H in de[N]=[],dr[N])dr[N].hasOwnProperty(H)&&de[N].push(H);return de},h.addFont=function(N,H,de,ge,Ne){var Fe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Fe.indexOf(arguments[3])!==-1?Ne=arguments[3]:arguments[3]&&Fe.indexOf(arguments[3])==-1&&(de=I(de,ge)),Ne=Ne||"Identity-H",wu.call(this,N,H,de,Ne)};var $o,ku=e.lineWidth||.200025,ql=h.__private__.getLineWidth=h.getLineWidth=function(){return ku},$f=h.__private__.setLineWidth=h.setLineWidth=function(N){return ku=N,le(A(T(N))+" w"),this};h.__private__.setLineDash=mt.API.setLineDash=mt.API.setLineDashPattern=function(N,H){if(N=N||[],H=H||0,isNaN(H)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(de){return A(T(de))}).join(" "),H=A(T(H)),le("["+N+"] "+H+" d"),this};var qf=h.__private__.getLineHeight=h.getLineHeight=function(){return Ke*$o};h.__private__.getLineHeight=h.getLineHeight=function(){return Ke*$o};var Vf=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&($o=N),this},Gf=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return $o};Vf(e.lineHeight);var Mi=h.__private__.getHorizontalCoordinate=function(N){return T(N)},ia=h.__private__.getVerticalCoordinate=function(N){return _===b.ADVANCED?N:_t[L].mediaBox.topRightY-_t[L].mediaBox.bottomLeftY-T(N)},ap=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(N){return A(Mi(N))},Oa=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(N){return A(ia(N))},ui=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ae(ui)},h.__private__.setStrokeColor=h.setDrawColor=function(N,H,de,ge){return ui=ce({ch1:N,ch2:H,ch3:de,ch4:ge,pdfColorType:"draw",precision:2}),le(ui),this};var ju=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ae(ju)},h.__private__.setFillColor=h.setFillColor=function(N,H,de,ge){return ju=ce({ch1:N,ch2:H,ch3:de,ch4:ge,pdfColorType:"fill",precision:2}),le(ju),this};var qo=e.textColor||"0 g",op=h.__private__.getTextColor=h.getTextColor=function(){return ae(qo)};h.__private__.setTextColor=h.setTextColor=function(N,H,de,ge){return qo=ce({ch1:N,ch2:H,ch3:de,ch4:ge,pdfColorType:"text",precision:3}),this};var Vl=e.charSpace,lp=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Vl||0)};h.__private__.setCharSpace=h.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Vl=N,this};var Eu=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(N){var H=h.CapJoinStyles[N];if(H===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Eu=H,le(H+" J"),this};var Au=0;h.__private__.setLineJoin=h.setLineJoin=function(N){var H=h.CapJoinStyles[N];if(H===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Au=H,le(H+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(A(T(N))+" M"),this},h.GState=df,h.setGState=function(N){(N=typeof N=="string"?xr[ys[N]]:Yf(null,N)).equals(ai)||(le("/"+N.id+" gs"),ai=N)};var Yf=function(N,H){if(!N||!ys[N]){var de=!1;for(var ge in xr)if(xr.hasOwnProperty(ge)&&xr[ge].equals(H)){de=!0;break}if(de)H=xr[ge];else{var Ne="GS"+(Object.keys(xr).length+1).toString(10);xr[Ne]=H,H.id=Ne}return N&&(ys[N]=H.id),Ht.publish("addGState",H),H}};h.addGState=function(N,H){return Yf(N,H),this},h.saveGraphicsState=function(){return le("q"),Us.push({key:Ct,size:Ke,color:qo}),this},h.restoreGraphicsState=function(){le("Q");var N=Us.pop();return Ct=N.key,Ke=N.size,qo=N.color,ai=null,this},h.setCurrentTransformationMatrix=function(N){return le(N.toString()+" cm"),this},h.comment=function(N){return le("#"+N),this};var Gl=function(N,H){var de=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return de},set:function(Fe){isNaN(Fe)||(de=parseFloat(Fe))}});var ge=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ge},set:function(Fe){isNaN(Fe)||(ge=parseFloat(Fe))}});var Ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ne},set:function(Fe){Ne=Fe.toString()}}),this},Tu=function(N,H,de,ge){Gl.call(this,N,H),this.type="rect";var Ne=de||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ne},set:function($e){isNaN($e)||(Ne=parseFloat($e))}});var Fe=ge||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Fe},set:function($e){isNaN($e)||(Fe=parseFloat($e))}}),this},Cu=function(){this.page=lr,this.currentPage=L,this.pages=pe.slice(0),this.pagesContext=_t.slice(0),this.x=rn,this.y=Mt,this.matrix=ts,this.width=Vo(L),this.height=Da(L),this.outputDestination=Ue,this.id="",this.objectNumber=-1};Cu.prototype.restore=function(){lr=this.page,L=this.currentPage,_t=this.pagesContext,pe=this.pages,rn=this.x,Mt=this.y,ts=this.matrix,Pu(L,this.width),Lu(L,this.height),Ue=this.outputDestination};var Kf=function(N,H,de,ge,Ne){Ws.push(new Cu),lr=L=0,pe=[],rn=N,Mt=H,ts=Ne,bu([de,ge])},cp=function(N){if(zs[N])Ws.pop().restore();else{var H=new Cu,de="Xo"+(Object.keys(nn).length+1).toString(10);H.id=de,zs[N]=de,nn[de]=H,Ht.publish("addFormObject",H),Ws.pop().restore()}};for(var Yl in h.beginFormObject=function(N,H,de,ge,Ne){return Kf(N,H,de,ge,Ne),this},h.endFormObject=function(N){return cp(N),this},h.doFormObject=function(N,H){var de=nn[zs[N]];return le("q"),le(H.toString()+" cm"),le("/"+de.id+" Do"),le("Q"),this},h.getFormObject=function(N){var H=nn[zs[N]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},h.save=function(N,H){return N=N||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(il(Wl(sa()),N),typeof il.unload=="function"&&vt.setTimeout&&setTimeout(il.unload,911),this):new Promise(function(de,ge){try{var Ne=il(Wl(sa()),N);typeof il.unload=="function"&&vt.setTimeout&&setTimeout(il.unload,911),de(Ne)}catch(Fe){ge(Fe.message)}})},mt.API)mt.API.hasOwnProperty(Yl)&&(Yl==="events"&&mt.API.events.length?function(N,H){var de,ge,Ne;for(Ne=H.length-1;Ne!==-1;Ne--)de=H[Ne][0],ge=H[Ne][1],N.subscribe.apply(N,[de].concat(typeof ge=="function"?[ge]:ge))}(Ht,mt.API.events):h[Yl]=mt.API[Yl]);var Vo=h.getPageWidth=function(N){return(_t[N=N||L].mediaBox.topRightX-_t[N].mediaBox.bottomLeftX)/st},Pu=h.setPageWidth=function(N,H){_t[N].mediaBox.topRightX=H*st+_t[N].mediaBox.bottomLeftX},Da=h.getPageHeight=function(N){return(_t[N=N||L].mediaBox.topRightY-_t[N].mediaBox.bottomLeftY)/st},Lu=h.setPageHeight=function(N,H){_t[N].mediaBox.topRightY=H*st+_t[N].mediaBox.bottomLeftY};return h.internal={pdfEscape:ns,getStyle:Wf,getFont:ip,getFontSize:tt,getCharSpace:lp,getTextColor:op,getLineHeight:qf,getLineHeightFactor:Gf,getLineWidth:ql,write:Me,getHorizontalCoordinate:Mi,getVerticalCoordinate:ia,getCoordinateString:ap,getVerticalCoordinateString:Oa,collections:{},newObject:Ir,newAdditionalObject:oe,newObjectDeferred:Tr,newObjectDeferredBegin:X,getFilters:je,putStream:Pe,events:Ht,scaleFactor:st,pageSize:{getWidth:function(){return Vo(L)},setWidth:function(N){Pu(L,N)},getHeight:function(){return Da(L)},setHeight:function(N){Lu(L,N)}},encryptionOptions:d,encryption:Pn,getEncryptor:Zm,output:Hl,getNumberOfPages:Ym,pages:pe,out:le,f2:M,f3:j,getPageInfo:zf,getPageInfoByObjId:Nt,getCurrentPageInfo:ep,getPDFVersion:g,Point:Gl,Rectangle:Tu,Matrix:pt,hasHotfix:Uf},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Vo(L)},set:function(N){Pu(L,N)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Da(L)},set:function(N){Lu(L,N)},enumerable:!0,configurable:!0}),Vm.call(h,He),Ct="F1",Rf(s,r),Ht.publish("initialized"),h}bc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},bc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},bc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},bc.prototype.processOwnerPassword=function(e,t){return Hg(Wg(t).substr(0,5),e)},bc.prototype.encryptor=function(e,t){var r=Wg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Hg(r,n)}},df.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||tr(e)!==tr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},mt.API={events:[]},mt.version="2.5.2";var Lr=mt.API,l2=1,Dl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},pc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},kt=function(e){return e.toFixed(2)},Xa=function(e){return e.toFixed(5)};Lr.__acroform__={};var vs=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Zy=function(e){return e*l2},Hi=function(e){var t=new C_,r=ut.internal.getHeight(e)||0,n=ut.internal.getWidth(e)||0;return t.BBox=[0,0,Number(kt(n)),Number(kt(r))],t},CC=Lr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},PC=Lr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},LC=Lr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},zr=Lr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return LC(e,t-1)},Wr=Lr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return CC(e,t-1)},Hr=Lr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return PC(e,t-1)},FC=Lr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],i=e[1],a=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(s+a)||0,c.upperRight_Y=n(i)||0,[Number(kt(c.lowerLeft_X)),Number(kt(c.lowerLeft_Y)),Number(kt(c.upperRight_X)),Number(kt(c.upperRight_Y))]},OC=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=$g(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+kt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Hi(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},$g=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(j){return j.split(`
`)}):s.map(function(j){return[j]});var i=r,a=ut.internal.getHeight(e)||0;a=a<0?-a:a;var l=ut.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(j,T,q){if(j+1<s.length){var U=T+" "+s[j+1][0];return $h(U,e,q).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var u,d,m=$h("3",e,i).height,p=e.multiline?a-i:(a-m)/2,h=p+=2,y=0,g=0,w=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+$h(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var v="",b=0,_=0;_<s.length;_++)if(s.hasOwnProperty(_)){var E=!1;if(s[_].length!==1&&w!==s[_].length-1){if((m+2)*(b+2)+2>a)continue e;v+=s[_][w],E=!0,g=_,_--}else{v=(v+=s[_][w]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var D=parseInt(_),I=c(D,v,i),A=_>=s.length-1;if(I&&!A){v+=" ",w=0;continue}if(I||A){if(A)g=D;else if(e.multiline&&(m+2)*(b+2)+2>a)continue e}else{if(!e.multiline||(m+2)*(b+2)+2>a)continue e;g=D}}for(var P="",C=y;C<=g;C++){var M=s[C];if(e.multiline){if(C===g){P+=M[w]+" ",w=(w+1)%M.length;continue}if(C===y){P+=M[M.length-1]+" ";continue}}P+=M[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,d=$h(P,e,i).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;case"left":default:u=2}t+=kt(u)+" "+kt(h)+` Td
`,t+="("+Dl(P)+`) Tj
`,t+=-kt(u)+` 0 Td
`,h=-(i+2),d=0,y=E?g:g+1,b++,v=""}break}return n.text=t,n.fontSize=i,n},$h=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},DC={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},IC=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},RC=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,s=e[r];t.internal.newObjectDeferredBegin(s.objId,!0),tr(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete e[n]}},MC=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Li.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(DC)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");l2=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new P_,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&IC(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var i=!n;for(var a in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var l=n[a],c=[],u=l.Rect;if(l.Rect&&(l.Rect=FC(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ut.createDefaultAppearanceStream(l),tr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=OC(l);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var m="";for(var p in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(p)){var h=l.appearanceStreamContent[p];if(m+="/"+p+" ",m+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var a in h)if(h.hasOwnProperty(a)){var y=h[a];typeof y=="function"&&(y=y.call(s,l)),m+="/"+a+" "+y+" ",s.internal.acroformPlugin.xForms.indexOf(y)>=0||s.internal.acroformPlugin.xForms.push(y)}}else typeof(y=h)=="function"&&(y=y.call(s,l)),m+="/"+a+" "+y,s.internal.acroformPlugin.xForms.indexOf(y)>=0||s.internal.acroformPlugin.xForms.push(y);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&RC(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},T_=Lr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(a){return a};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),tr(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+Dl(n(e[i].toString()))+")"):s+=e[i].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},g1=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Dl(n(e))+")"},Yi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Yi.prototype.toString=function(){return this.objId+" 0 R"},Yi.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Yi.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:T_(s,this.objId,this.scope)}):s instanceof Yi?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var C_=function(){Yi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};vs(C_,Yi);var P_=function(){Yi.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Dl(r(e))+")"}},set:function(r){e=r}})};vs(P_,Yi);var Li=function e(){Yi.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');t=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!zr(t,3)},set:function(v){v?this.F=Wr(t,3):this.F=Hr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof $0)return;i="FieldObject"+e.FieldNum++}var v=function(b){return b};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Dl(v(i))+")"},set:function(v){i=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(v){i=v}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(v){a=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/l2:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof $0||this instanceof ko))return g1(m,this.objId,this.scope)},set:function(v){v=v.toString(),m=v}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ln?p:g1(p,this.objId,this.scope)},set:function(v){v=v.toString(),p=this instanceof ln?v:v.substr(0,1)==="("?pc(v.substr(1,v.length-2)):pc(v)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ln?pc(p.substr(1,p.length-1)):p},set:function(v){v=v.toString(),p=this instanceof ln?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ln?h:g1(h,this.objId,this.scope)},set:function(v){v=v.toString(),h=this instanceof ln?v:v.substr(0,1)==="("?pc(v.substr(1,v.length-2)):pc(v)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ln?pc(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof ln?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(v){v=!!v,g=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(v){y=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,1)},set:function(v){v?this.Ff=Wr(this.Ff,1):this.Ff=Hr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,2)},set:function(v){v?this.Ff=Wr(this.Ff,2):this.Ff=Hr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,3)},set:function(v){v?this.Ff=Wr(this.Ff,3):this.Ff=Hr(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');w=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(w){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};vs(Li,Yi);var gl=function(){Li.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return T_(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(i,a,l){l||(l=1);for(var c,u=[];c=a.exec(i);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,18)},set:function(r){r?this.Ff=Wr(this.Ff,18):this.Ff=Hr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Wr(this.Ff,19):this.Ff=Hr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,20)},set:function(r){r?(this.Ff=Wr(this.Ff,20),t.sort()):this.Ff=Hr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,22)},set:function(r){r?this.Ff=Wr(this.Ff,22):this.Ff=Hr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,23)},set:function(r){r?this.Ff=Wr(this.Ff,23):this.Ff=Hr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,27)},set:function(r){r?this.Ff=Wr(this.Ff,27):this.Ff=Hr(this.Ff,27)}}),this.hasAppearanceStream=!1};vs(gl,Li);var xl=function(){gl.call(this),this.fontName="helvetica",this.combo=!1};vs(xl,gl);var vl=function(){xl.call(this),this.combo=!0};vs(vl,xl);var Pd=function(){vl.call(this),this.edit=!0};vs(Pd,vl);var ln=function(){Li.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,15)},set:function(r){r?this.Ff=Wr(this.Ff,15):this.Ff=Hr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,16)},set:function(r){r?this.Ff=Wr(this.Ff,16):this.Ff=Hr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,17)},set:function(r){r?this.Ff=Wr(this.Ff,17):this.Ff=Hr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,26)},set:function(r){r?this.Ff=Wr(this.Ff,26):this.Ff=Hr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+Dl(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){tr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};vs(ln,Li);var Ld=function(){ln.call(this),this.pushButton=!0};vs(Ld,ln);var yl=function(){ln.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};vs(yl,ln);var $0=function(){var e,t;Li.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,a=[];for(i in a.push("<<"),n)a.push("/"+i+" ("+Dl(s(n[i]))+")");return a.push(">>"),a.join(`
`)},set:function(s){tr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ut.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};vs($0,Li),yl.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},yl.prototype.createOption=function(e){var t=new $0;return t.Parent=this,t.optionName=e,this.Kids.push(t),BC.call(this.scope,t),t};var Fd=function(){ln.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ut.CheckBox.createAppearanceStream()};vs(Fd,ln);var ko=function(){Li.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,13)},set:function(t){t?this.Ff=Wr(this.Ff,13):this.Ff=Hr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,21)},set:function(t){t?this.Ff=Wr(this.Ff,21):this.Ff=Hr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,23)},set:function(t){t?this.Ff=Wr(this.Ff,23):this.Ff=Hr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,24)},set:function(t){t?this.Ff=Wr(this.Ff,24):this.Ff=Hr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,25)},set:function(t){t?this.Ff=Wr(this.Ff,25):this.Ff=Hr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,26)},set:function(t){t?this.Ff=Wr(this.Ff,26):this.Ff=Hr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};vs(ko,Li);var Od=function(){ko.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!zr(this.Ff,14)},set:function(e){e?this.Ff=Wr(this.Ff,14):this.Ff=Hr(this.Ff,14)}}),this.password=!0};vs(Od,ko);var ut={CheckBox:{createAppearanceStream:function(){return{N:{On:ut.CheckBox.YesNormal},D:{On:ut.CheckBox.YesPushDown,Off:ut.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Hi(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=$g(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+kt(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Hi(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],i=ut.internal.getHeight(e),a=ut.internal.getWidth(e),l=$g(e,e.caption);return s.push("1 g"),s.push("0 0 "+kt(a)+" "+kt(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+kt(a-1)+" "+kt(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+kt(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=Hi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Circle.YesNormal,t.D[e]=ut.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Hi(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=ut.internal.Bezier_C,i=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Xa(ut.internal.getWidth(e)/2)+" "+Xa(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Hi(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*ut.internal.Bezier_C).toFixed(5)),a=Number((n*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Xa(ut.internal.getWidth(e)/2)+" "+Xa(ut.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Xa(ut.internal.getWidth(e)/2)+" "+Xa(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Hi(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Xa(ut.internal.getWidth(e)/2)+" "+Xa(ut.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Cross.YesNormal,t.D[e]=ut.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Hi(e);t.scope=e.scope;var r=[],n=ut.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+kt(ut.internal.getWidth(e)-2)+" "+kt(ut.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(kt(n.x1.x)+" "+kt(n.x1.y)+" m"),r.push(kt(n.x2.x)+" "+kt(n.x2.y)+" l"),r.push(kt(n.x4.x)+" "+kt(n.x4.y)+" m"),r.push(kt(n.x3.x)+" "+kt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Hi(e);t.scope=e.scope;var r=ut.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+kt(ut.internal.getWidth(e)-2)+" "+kt(ut.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(kt(r.x1.x)+" "+kt(r.x1.y)+" m"),n.push(kt(r.x2.x)+" "+kt(r.x2.y)+" l"),n.push(kt(r.x4.x)+" "+kt(r.x4.y)+" m"),n.push(kt(r.x3.x)+" "+kt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Hi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ut.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ut.internal.getWidth(e),r=ut.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ut.internal.getWidth=function(e){var t=0;return tr(e)==="object"&&(t=Zy(e.Rect[2])),t},ut.internal.getHeight=function(e){var t=0;return tr(e)==="object"&&(t=Zy(e.Rect[3])),t};var BC=Lr.addField=function(e){if(MC(this,e),!(e instanceof Li))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Lr.AcroFormChoiceField=gl,Lr.AcroFormListBox=xl,Lr.AcroFormComboBox=vl,Lr.AcroFormEditBox=Pd,Lr.AcroFormButton=ln,Lr.AcroFormPushButton=Ld,Lr.AcroFormRadioButton=yl,Lr.AcroFormCheckBox=Fd,Lr.AcroFormTextField=ko,Lr.AcroFormPasswordField=Od,Lr.AcroFormAppearance=ut,Lr.AcroForm={ChoiceField:gl,ListBox:xl,ComboBox:vl,EditBox:Pd,Button:ln,PushButton:Ld,RadioButton:yl,CheckBox:Fd,TextField:ko,PasswordField:Od,Appearance:ut},mt.AcroForm={ChoiceField:gl,ListBox:xl,ComboBox:vl,EditBox:Pd,Button:ln,PushButton:Ld,RadioButton:yl,CheckBox:Fd,TextField:ko,PasswordField:Od,Appearance:ut};var UC=mt.AcroForm;function L_(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(j,T){var q,U,re,z,G,B=t;if((T=T||t)==="RGBA"||j.data!==void 0&&j.data instanceof Uint8ClampedArray&&"height"in j&&"width"in j)return"RGBA";if(I(j))for(G in r)for(re=r[G],q=0;q<re.length;q+=1){for(z=!0,U=0;U<re[q].length;U+=1)if(re[q][U]!==void 0&&re[q][U]!==j[U]){z=!1;break}if(z===!0){B=G;break}}else for(G in r)for(re=r[G],q=0;q<re.length;q+=1){for(z=!0,U=0;U<re[q].length;U+=1)if(re[q][U]!==void 0&&re[q][U]!==j.charCodeAt(U)){z=!1;break}if(z===!0){B=G;break}}return B===t&&T!==t&&(B=T),B},s=function j(T){for(var q=this.internal.write,U=this.internal.putStream,re=(0,this.internal.getFilters)();re.indexOf("FlateEncode")!==-1;)re.splice(re.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var z=[];if(z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Image"}),z.push({key:"Width",value:T.width}),z.push({key:"Height",value:T.height}),T.colorSpace===w.INDEXED?z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(z.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===w.DEVICE_CMYK&&z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),z.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&z.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var G="",B=0,Y=T.transparency.length;B<Y;B++)G+=T.transparency[B]+" "+T.transparency[B]+" ";z.push({key:"Mask",value:"["+G+"]"})}T.sMask!==void 0&&z.push({key:"SMask",value:T.objectId+1+" 0 R"});var se=T.filter!==void 0?["/"+T.filter]:void 0;if(U({data:T.data,additionalKeyValues:z,alreadyAppliedFilters:se,objectId:T.objectId}),q("endobj"),"sMask"in T&&T.sMask!==void 0){var me="/Predictor "+T.predictor+" /Colors 1 /BitsPerComponent "+T.bitsPerComponent+" /Columns "+T.width,S={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:me,data:T.sMask};"filter"in T&&(S.filter=T.filter),j.call(this,S)}if(T.colorSpace===w.INDEXED){var L=this.internal.newObject();U({data:P(new Uint8Array(T.palette)),objectId:L}),q("endobj")}},i=function(){var j=this.internal.collections.addImage_images;for(var T in j)s.call(this,j[T])},a=function(){var j,T=this.internal.collections.addImage_images,q=this.internal.write;for(var U in T)q("/I"+(j=T[U]).index,j.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",a))},c=function(){var j=this.internal.collections.addImage_images;return l.call(this),j},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(j){return typeof e["process"+j.toUpperCase()]=="function"},m=function(j){return tr(j)==="object"&&j.nodeType===1},p=function(j,T){if(j.nodeName==="IMG"&&j.hasAttribute("src")){var q=""+j.getAttribute("src");if(q.indexOf("data:image/")===0)return Cd(unescape(q).split("base64,").pop());var U=e.loadFile(q,!0);if(U!==void 0)return U}if(j.nodeName==="CANVAS"){if(j.width===0||j.height===0)throw new Error("Given canvas must have data. Canvas width: "+j.width+", height: "+j.height);var re;switch(T){case"PNG":re="image/png";break;case"WEBP":re="image/webp";break;case"JPEG":case"JPG":default:re="image/jpeg"}return Cd(j.toDataURL(re,1).split("base64,").pop())}},h=function(j){var T=this.internal.collections.addImage_images;if(T){for(var q in T)if(j===T[q].alias)return T[q]}},y=function(j,T,q){return j||T||(j=-96,T=-96),j<0&&(j=-1*q.width*72/j/this.internal.scaleFactor),T<0&&(T=-1*q.height*72/T/this.internal.scaleFactor),j===0&&(j=T*q.width/q.height),T===0&&(T=j*q.height/q.width),[j,T]},g=function(j,T,q,U,re,z){var G=y.call(this,q,U,re),B=this.internal.getCoordinateString,Y=this.internal.getVerticalCoordinateString,se=c.call(this);if(q=G[0],U=G[1],se[re.index]=re,z){z*=Math.PI/180;var me=Math.cos(z),S=Math.sin(z),L=function(O){return O.toFixed(4)},R=[L(me),L(S),L(-1*S),L(me),0,0,"cm"]}this.internal.write("q"),z?(this.internal.write([1,"0","0",1,B(j),Y(T+U),"cm"].join(" ")),this.internal.write(R.join(" ")),this.internal.write([B(q),"0","0",B(U),"0","0","cm"].join(" "))):this.internal.write([B(q),"0","0",B(U),B(j),Y(T+U),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+re.index+" Do"),this.internal.write("Q")},w=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(j){var T,q,U=0;if(typeof j=="string")for(q=j.length,T=0;T<q;T++)U=(U<<5)-U+j.charCodeAt(T),U|=0;else if(I(j))for(q=j.byteLength/2,T=0;T<q;T++)U=(U<<5)-U+j[T],U|=0;return U},_=e.__addimage__.validateStringAsBase64=function(j){(j=j||"").toString().trim();var T=!0;return j.length===0&&(T=!1),j.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(j.substr(0,j.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(j.substr(-2))===!1&&(T=!1),T},E=e.__addimage__.extractImageFromDataUrl=function(j){var T=(j=j||"").split("base64,"),q=null;if(T.length===2){var U=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(T[0]);Array.isArray(U)&&(q={mimeType:U[1],charset:U[2],data:T[1]})}return q},D=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(j){return D()&&j instanceof ArrayBuffer};var I=e.__addimage__.isArrayBufferView=function(j){return D()&&typeof Uint32Array<"u"&&(j instanceof Int8Array||j instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&j instanceof Uint8ClampedArray||j instanceof Int16Array||j instanceof Uint16Array||j instanceof Int32Array||j instanceof Uint32Array||j instanceof Float32Array||j instanceof Float64Array)},A=e.__addimage__.binaryStringToUint8Array=function(j){for(var T=j.length,q=new Uint8Array(T),U=0;U<T;U++)q[U]=j.charCodeAt(U);return q},P=e.__addimage__.arrayBufferToBinaryString=function(j){for(var T="",q=I(j)?j:new Uint8Array(j),U=0;U<q.length;U+=8192)T+=String.fromCharCode.apply(null,q.subarray(U,U+8192));return T};e.addImage=function(){var j,T,q,U,re,z,G,B,Y;if(typeof arguments[1]=="number"?(T=t,q=arguments[1],U=arguments[2],re=arguments[3],z=arguments[4],G=arguments[5],B=arguments[6],Y=arguments[7]):(T=arguments[1],q=arguments[2],U=arguments[3],re=arguments[4],z=arguments[5],G=arguments[6],B=arguments[7],Y=arguments[8]),tr(j=arguments[0])==="object"&&!m(j)&&"imageData"in j){var se=j;j=se.imageData,T=se.format||T||t,q=se.x||q||0,U=se.y||U||0,re=se.w||se.width||re,z=se.h||se.height||z,G=se.alias||G,B=se.compression||B,Y=se.rotation||se.angle||Y}var me=this.internal.getFilters();if(B===void 0&&me.indexOf("FlateEncode")!==-1&&(B="SLOW"),isNaN(q)||isNaN(U))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var S=C.call(this,j,T,G,B);return g.call(this,q,U,re,z,S,Y),this};var C=function(j,T,q,U){var re,z,G;if(typeof j=="string"&&n(j)===t){j=unescape(j);var B=M(j,!1);(B!==""||(B=e.loadFile(j,!0))!==void 0)&&(j=B)}if(m(j)&&(j=p(j,T)),T=n(j,T),!d(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((G=q)==null||G.length===0)&&(q=function(Y){return typeof Y=="string"||I(Y)?b(Y):I(Y.data)?b(Y.data):null}(j)),(re=h.call(this,q))||(D()&&(j instanceof Uint8Array||T==="RGBA"||(z=j,j=A(j))),re=this["process"+T.toUpperCase()](j,u.call(this),q,function(Y){return Y&&typeof Y=="string"&&(Y=Y.toUpperCase()),Y in e.image_compression?Y:v.NONE}(U),z)),!re)throw new Error("An unknown error occurred whilst processing the image.");return re},M=e.__addimage__.convertBase64ToBinaryString=function(j,T){var q;T=typeof T!="boolean"||T;var U,re="";if(typeof j=="string"){U=(q=E(j))!==null?q.data:j;try{re=Cd(U)}catch(z){if(T)throw _(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return re};e.getImageProperties=function(j){var T,q,U="";if(m(j)&&(j=p(j)),typeof j=="string"&&n(j)===t&&((U=M(j,!1))===""&&(U=e.loadFile(j)||""),j=U),q=n(j),!d(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(!D()||j instanceof Uint8Array||(j=A(j)),!(T=this["process"+q.toUpperCase()](j)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=q,T}})(mt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};mt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,i,a=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,m=0;m<u.length&&!d;m++)switch((n=u[m]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,y=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(g.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+a(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",i+=" /Popup "+w.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(v(b))+") >>",g.content=i;var _=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+a(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(i+=" /Open true"),i+=" >>",w.content=i,this.internal.write(g.objId,"0 R",w.objId,"0 R");break;case"freetext":s="/Rect ["+a(n.bounds.x)+" "+l(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var E=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(y(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var D=this.annotations._nameMap[n.options.name];n.options.pageNumber=D.page,n.options.top=D.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var I=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,i,a){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+s),h:u(n+i)},options:a,type:"link"})},e.textWithLink=function(r,n,s,i){var a,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var d=this.splitTextToSize(r,l).length;a=Math.ceil(u*d)}else l=c,a=u;return this.text(r,n,s,i),s+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,s-u,l,a,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(mt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},a=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return a(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return a(g)&&s.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return a(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return a(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return a(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return a(g)&&i(g)&&t[g.charCodeAt(0)].length==4},m=e.__arabicParser__.resolveLigatures=function(g){var w=0,v=r,b="",_=0;for(w=0;w<g.length;w+=1)v[g.charCodeAt(w)]!==void 0?(_++,typeof(v=v[g.charCodeAt(w)])=="number"&&(b+=String.fromCharCode(v),v=r,_=0),w===g.length-1&&(v=r,b+=g.charAt(w-(_-1)),w-=_-1,_=0)):(v=r,b+=g.charAt(w-_),w-=_,_=0);return b};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,w,v){return a(g)?i(g)===!1?-1:!u(g)||!a(w)&&!a(v)||!a(v)&&l(w)||l(g)&&!a(w)||l(g)&&c(w)||l(g)&&l(w)?0:d(g)&&a(w)&&!l(w)&&a(v)&&u(v)?3:l(g)||!a(v)?1:2:-1},h=function(g){var w=0,v=0,b=0,_="",E="",D="",I=(g=g||"").split("\\s+"),A=[];for(w=0;w<I.length;w+=1){for(A.push(""),v=0;v<I[w].length;v+=1)_=I[w][v],E=I[w][v-1],D=I[w][v+1],a(_)?(b=p(_,E,D),A[w]+=b!==-1?String.fromCharCode(t[_.charCodeAt(0)][b]):_):A[w]+=_;A[w]=m(A[w])}return A.join(" ")},y=e.__arabicParser__.processArabic=e.processArabic=function(){var g,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(w)){var b=0;for(v=[],b=0;b<w.length;b+=1)Array.isArray(w[b])?v.push([h(w[b][0]),w[b][1],w[b][2]]):v.push([h(w[b])]);g=v}else g=h(w);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",y])}(mt.API),mt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(l){a=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(mt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(g){y=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),m=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,y=0,g=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(_,E){return _.concat(w.splitTextToSize(E,v))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)h<(g=this.getStringUnitWidth(c[b],{font:m})*d)&&(h=g);return h!==0&&(y=c.length),{w:h/=p,h:Math.max((y*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,m=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,h&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,m,p){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,y,g,w,v=[],b=[],_=[],E={},D={},I=[],A=[],P=(p=p||{}).autoSize||!1,C=p.printHeaders!==!1,M=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,j=p.margins||Object.assign({width:this.getPageWidth()},t),T=typeof p.padding=="number"?p.padding:3,q=p.headerBackgroundColor||"#c8c8c8",U=p.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=C,this.internal.__cell__.margins=j,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=q,this.internal.__cell__.headerTextColor=U,this.setFontSize(M),m==null)b=v=Object.keys(d[0]),_=v.map(function(){return"left"});else if(Array.isArray(m)&&tr(m[0])==="object")for(v=m.map(function(se){return se.name}),b=m.map(function(se){return se.prompt||se.name||""}),_=m.map(function(se){return se.align||"left"}),h=0;h<m.length;h+=1)D[m[h].name]=m[h].width*(19.049976/25.4);else Array.isArray(m)&&typeof m[0]=="string"&&(b=v=m,_=v.map(function(){return"left"}));if(P||Array.isArray(m)&&typeof m[0]=="string")for(h=0;h<v.length;h+=1){for(E[w=v[h]]=d.map(function(se){return se[w]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=E[w],this.setFont(void 0,"normal"),g=0;g<y.length;g+=1)I.push(this.getTextDimensions(y[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[w]=Math.max.apply(null,I)+T+T,I=[]}if(C){var re={};for(h=0;h<v.length;h+=1)re[v[h]]={},re[v[h]].text=b[h],re[v[h]].align=_[h];var z=l.call(this,re,D);A=v.map(function(se){return new i(c,u,D[se],z,re[se].text,void 0,re[se].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var G=m.reduce(function(se,me){return se[me.name]=me.align,se},{});for(h=0;h<d.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:d[h]},this);var B=l.call(this,d[h],D);for(g=0;g<v.length;g+=1){var Y=d[h][v[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:Y},this),a.call(this,new i(c,u,D[v[g]],B,Y,h+2,G[v[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(h){var y=c[h];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*m/p+d+d},this).reduce(function(h,y){return Math.max(h,y)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=c;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,d),this.setTextColor(y)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(mt.API);var F_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},O_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qg=L_(O_),D_=[100,200,300,400,500,600,700,800,900],zC=L_(D_);function Vg(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return F_[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),s=function(i){return typeof qg[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function e5(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var WC={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},t5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function r5(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function HC(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},WC,r.genericFontFamilies||{}),i=null,a=null,l=0;l<t.length;++l)if(s[(i=Vg(t[l])).family]&&(i.family=s[i.family]),e.hasOwnProperty(i.family)){a=e[i.family];break}if(!(a=a||e[n]))throw new Error("Could not find a font-family for the rule '"+r5(i)+"' and default family '"+n+"'.");if(a=function(c,u){if(u[c])return u[c];var d=qg[c],m=d<=qg.normal?-1:1,p=e5(u,O_,d,m);if(!p)throw new Error("Could not find a matching font-stretch value for "+c);return p}(i.stretch,a),a=function(c,u){if(u[c])return u[c];for(var d=F_[c],m=0;m<d.length;++m)if(u[d[m]])return u[d[m]];throw new Error("Could not find a matching font-style for "+c)}(i.style,a),!(a=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var d=zC[c],m=e5(u,D_,d,c<400?-1:1);if(!m)throw new Error("Could not find a matching font-weight for value "+c);return m}(i.weight,a)))throw new Error("Failed to resolve a font for the rule '"+r5(i)+"'.");return a}function n5(e){return e.trimLeft()}function $C(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function qC(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var qh,s5,i5,x1=["times"];(function(e){var t,r,n,s,i,a,l,c,u,d=function(S){return S=S||{},this.isStrokeTransparent=S.isStrokeTransparent||!1,this.strokeOpacity=S.strokeOpacity||1,this.strokeStyle=S.strokeStyle||"#000000",this.fillStyle=S.fillStyle||"#000000",this.isFillTransparent=S.isFillTransparent||!1,this.fillOpacity=S.fillOpacity||1,this.font=S.font||"10px sans-serif",this.textBaseline=S.textBaseline||"alphabetic",this.textAlign=S.textAlign||"left",this.lineWidth=S.lineWidth||1,this.lineJoin=S.lineJoin||"miter",this.lineCap=S.lineCap||"butt",this.path=S.path||[],this.transform=S.transform!==void 0?S.transform.clone():new c,this.globalCompositeOperation=S.globalCompositeOperation||"normal",this.globalAlpha=S.globalAlpha||1,this.clip_path=S.clip_path||[],this.currentPoint=S.currentPoint||new a,this.miterLimit=S.miterLimit||10,this.lastPoint=S.lastPoint||new a,this.lineDashOffset=S.lineDashOffset||0,this.lineDash=S.lineDash||[],this.margin=S.margin||[0,0,0,0],this.prevPageLastElemOffset=S.prevPageLastElemOffset||0,this.ignoreClearRect=typeof S.ignoreClearRect!="boolean"||S.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new m(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,a=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var m=function(S){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=S;Object.defineProperty(this,"pdf",{get:function(){return L}});var R=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return R},set:function(Se){R=!!Se}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(Se){O=!!Se}});var V=0;Object.defineProperty(this,"posX",{get:function(){return V},set:function(Se){isNaN(Se)||(V=Se)}});var ne=0;Object.defineProperty(this,"posY",{get:function(){return ne},set:function(Se){isNaN(Se)||(ne=Se)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Se){var le;typeof Se=="number"?le=[Se,Se,Se,Se]:((le=new Array(4))[0]=Se[0],le[1]=Se.length>=2?Se[1]:le[0],le[2]=Se.length>=3?Se[2]:le[0],le[3]=Se.length>=4?Se[3]:le[1]),u.margin=le}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(Se){ue=Se}});var fe=0;Object.defineProperty(this,"lastBreak",{get:function(){return fe},set:function(Se){fe=Se}});var ye=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ye},set:function(Se){ye=Se}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Se){Se instanceof d&&(u=Se)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Se){u.path=Se}});var pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return pe},set:function(Se){pe=Se}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Se){var le;le=p(Se),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Se){var le=p(Se);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Se){["butt","round","square"].indexOf(Se)!==-1&&(this.ctx.lineCap=Se,this.pdf.setLineCap(Se))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Se){isNaN(Se)||(this.ctx.lineWidth=Se,this.pdf.setLineWidth(Se))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Se){["bevel","round","miter"].indexOf(Se)!==-1&&(this.ctx.lineJoin=Se,this.pdf.setLineJoin(Se))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Se){isNaN(Se)||(this.ctx.miterLimit=Se,this.pdf.setMiterLimit(Se))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Se){this.ctx.textBaseline=Se}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Se){["right","end","center","left","start"].indexOf(Se)!==-1&&(this.ctx.textAlign=Se)}});var _e=null;function Ue(Se,le){if(_e===null){var Me=function(rt){var He=[];return Object.keys(rt).forEach(function(Ke){rt[Ke].forEach(function(Ze){var tt=null;switch(Ze){case"bold":tt={family:Ke,weight:"bold"};break;case"italic":tt={family:Ke,style:"italic"};break;case"bolditalic":tt={family:Ke,weight:"bold",style:"italic"};break;case"":case"normal":tt={family:Ke}}tt!==null&&(tt.ref={name:Ke,style:Ze},He.push(tt))})}),He}(Se.getFontList());_e=function(rt){for(var He={},Ke=0;Ke<rt.length;++Ke){var Ze=Vg(rt[Ke]),tt=Ze.family,dt=Ze.stretch,ft=Ze.style,bt=Ze.weight;He[tt]=He[tt]||{},He[tt][dt]=He[tt][dt]||{},He[tt][dt][ft]=He[tt][dt][ft]||{},He[tt][dt][ft][bt]=Ze}return He}(Me.concat(le))}return _e}var Ve=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ve},set:function(Se){_e=null,Ve=Se}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Se){var le;if(this.ctx.font=Se,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Se))!==null){var Me=le[1],rt=(le[2],le[3]),He=le[4],Ke=(le[5],le[6]),Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(He)[2];He=Math.floor(Ze==="px"?parseFloat(He)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(He)*this.pdf.getFontSize():parseFloat(He)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(He);var tt=function(xt){var Ct,st,rn=[],Mt=xt.trim();if(Mt==="")return x1;if(Mt in t5)return[t5[Mt]];for(;Mt!=="";){switch(st=null,Ct=(Mt=n5(Mt)).charAt(0)){case'"':case"'":st=$C(Mt.substring(1),Ct);break;default:st=qC(Mt)}if(st===null||(rn.push(st[0]),(Mt=n5(st[1]))!==""&&Mt.charAt(0)!==","))return x1;Mt=Mt.replace(/^,/,"")}return rn}(Ke);if(this.fontFaces){var dt=HC(Ue(this.pdf,this.fontFaces),tt.map(function(xt){return{family:xt,stretch:"normal",weight:rt,style:Me}}));this.pdf.setFont(dt.ref.name,dt.ref.style)}else{var ft="";(rt==="bold"||parseInt(rt,10)>=700||Me==="bold")&&(ft="bold"),Me==="italic"&&(ft+="italic"),ft.length===0&&(ft="normal");for(var bt="",Et={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ft=0;Ft<tt.length;Ft++){if(this.pdf.internal.getFont(tt[Ft],ft,{noFallback:!0,disableWarning:!0})!==void 0){bt=tt[Ft];break}if(ft==="bolditalic"&&this.pdf.internal.getFont(tt[Ft],"bold",{noFallback:!0,disableWarning:!0})!==void 0)bt=tt[Ft],ft="bold";else if(this.pdf.internal.getFont(tt[Ft],"normal",{noFallback:!0,disableWarning:!0})!==void 0){bt=tt[Ft],ft="normal";break}}if(bt===""){for(var Dt=0;Dt<tt.length;Dt++)if(Et[tt[Dt]]){bt=Et[tt[Dt]];break}}bt=bt===""?"Times":bt,this.pdf.setFont(bt,ft)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Se){this.ctx.globalCompositeOperation=Se}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Se){this.ctx.globalAlpha=Se}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Se){this.ctx.lineDashOffset=Se,me.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Se){this.ctx.lineDash=Se,me.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Se){this.ctx.ignoreClearRect=!!Se}})};m.prototype.setLineDash=function(S){this.lineDash=S},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){E.call(this,"fill",!1)},m.prototype.stroke=function(){E.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(S,L){if(isNaN(S)||isNaN(L))throw ur.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var R=this.ctx.transform.applyToPoint(new a(S,L));this.path.push({type:"mt",x:R.x,y:R.y}),this.ctx.lastPoint=new a(S,L)},m.prototype.closePath=function(){var S=new a(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&tr(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){S=new a(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(S.x,S.y)},m.prototype.lineTo=function(S,L){if(isNaN(S)||isNaN(L))throw ur.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var R=this.ctx.transform.applyToPoint(new a(S,L));this.path.push({type:"lt",x:R.x,y:R.y}),this.ctx.lastPoint=new a(R.x,R.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},m.prototype.quadraticCurveTo=function(S,L,R,O){if(isNaN(R)||isNaN(O)||isNaN(S)||isNaN(L))throw ur.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var V=this.ctx.transform.applyToPoint(new a(R,O)),ne=this.ctx.transform.applyToPoint(new a(S,L));this.path.push({type:"qct",x1:ne.x,y1:ne.y,x:V.x,y:V.y}),this.ctx.lastPoint=new a(V.x,V.y)},m.prototype.bezierCurveTo=function(S,L,R,O,V,ne){if(isNaN(V)||isNaN(ne)||isNaN(S)||isNaN(L)||isNaN(R)||isNaN(O))throw ur.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new a(V,ne)),fe=this.ctx.transform.applyToPoint(new a(S,L)),ye=this.ctx.transform.applyToPoint(new a(R,O));this.path.push({type:"bct",x1:fe.x,y1:fe.y,x2:ye.x,y2:ye.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new a(ue.x,ue.y)},m.prototype.arc=function(S,L,R,O,V,ne){if(isNaN(S)||isNaN(L)||isNaN(R)||isNaN(O)||isNaN(V))throw ur.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ne=!!ne,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new a(S,L));S=ue.x,L=ue.y;var fe=this.ctx.transform.applyToPoint(new a(0,R)),ye=this.ctx.transform.applyToPoint(new a(0,0));R=Math.sqrt(Math.pow(fe.x-ye.x,2)+Math.pow(fe.y-ye.y,2))}Math.abs(V-O)>=2*Math.PI&&(O=0,V=2*Math.PI),this.path.push({type:"arc",x:S,y:L,radius:R,startAngle:O,endAngle:V,counterclockwise:ne})},m.prototype.arcTo=function(S,L,R,O,V){throw new Error("arcTo not implemented.")},m.prototype.rect=function(S,L,R,O){if(isNaN(S)||isNaN(L)||isNaN(R)||isNaN(O))throw ur.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(S,L),this.lineTo(S+R,L),this.lineTo(S+R,L+O),this.lineTo(S,L+O),this.lineTo(S,L),this.lineTo(S+R,L),this.lineTo(S,L)},m.prototype.fillRect=function(S,L,R,O){if(isNaN(S)||isNaN(L)||isNaN(R)||isNaN(O))throw ur.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var V={};this.lineCap!=="butt"&&(V.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(V.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(S,L,R,O),this.fill(),V.hasOwnProperty("lineCap")&&(this.lineCap=V.lineCap),V.hasOwnProperty("lineJoin")&&(this.lineJoin=V.lineJoin)}},m.prototype.strokeRect=function(S,L,R,O){if(isNaN(S)||isNaN(L)||isNaN(R)||isNaN(O))throw ur.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(S,L,R,O),this.stroke())},m.prototype.clearRect=function(S,L,R,O){if(isNaN(S)||isNaN(L)||isNaN(R)||isNaN(O))throw ur.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(S,L,R,O))},m.prototype.save=function(S){S=typeof S!="boolean"||S;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,R=0;R<this.pdf.internal.getNumberOfPages();R++)this.pdf.setPage(R+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),S){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},m.prototype.restore=function(S){S=typeof S!="boolean"||S;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,R=0;R<this.pdf.internal.getNumberOfPages();R++)this.pdf.setPage(R+1),this.pdf.internal.out("Q");this.pdf.setPage(L),S&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(S){var L,R,O,V;if(S.isCanvasGradient===!0&&(S=S.getColor()),!S)return{r:0,g:0,b:0,a:0,style:S};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(S))L=0,R=0,O=0,V=0;else{var ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(S);if(ne!==null)L=parseInt(ne[1]),R=parseInt(ne[2]),O=parseInt(ne[3]),V=1;else if((ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(S))!==null)L=parseInt(ne[1]),R=parseInt(ne[2]),O=parseInt(ne[3]),V=parseFloat(ne[4]);else{if(V=1,typeof S=="string"&&S.charAt(0)!=="#"){var ue=new j_(S);S=ue.ok?ue.toHex():"#000000"}S.length===4?(L=S.substring(1,2),L+=L,R=S.substring(2,3),R+=R,O=S.substring(3,4),O+=O):(L=S.substring(1,3),R=S.substring(3,5),O=S.substring(5,7)),L=parseInt(L,16),R=parseInt(R,16),O=parseInt(O,16)}}return{r:L,g:R,b:O,a:V,style:S}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(S,L,R,O){if(isNaN(L)||isNaN(R)||typeof S!="string")throw ur.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!h.call(this)){var V=B(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;T.call(this,{text:S,x:L,y:R,scale:ne,angle:V,align:this.textAlign,maxWidth:O})}},m.prototype.strokeText=function(S,L,R,O){if(isNaN(L)||isNaN(R)||typeof S!="string")throw ur.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){O=isNaN(O)?void 0:O;var V=B(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;T.call(this,{text:S,x:L,y:R,scale:ne,renderingMode:"stroke",angle:V,align:this.textAlign,maxWidth:O})}},m.prototype.measureText=function(S){if(typeof S!="string")throw ur.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,R=this.pdf.internal.scaleFactor,O=L.internal.getFontSize(),V=L.getStringUnitWidth(S)*O/L.internal.scaleFactor,ne=function(ue){var fe=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return fe}}),this};return new ne({width:V*=Math.round(96*R/72*1e4)/1e4})},m.prototype.scale=function(S,L){if(isNaN(S)||isNaN(L))throw ur.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var R=new c(S,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(R)},m.prototype.rotate=function(S){if(isNaN(S))throw ur.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(S),Math.sin(S),-Math.sin(S),Math.cos(S),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},m.prototype.translate=function(S,L){if(isNaN(S)||isNaN(L))throw ur.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var R=new c(1,0,0,1,S,L);this.ctx.transform=this.ctx.transform.multiply(R)},m.prototype.transform=function(S,L,R,O,V,ne){if(isNaN(S)||isNaN(L)||isNaN(R)||isNaN(O)||isNaN(V)||isNaN(ne))throw ur.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new c(S,L,R,O,V,ne);this.ctx.transform=this.ctx.transform.multiply(ue)},m.prototype.setTransform=function(S,L,R,O,V,ne){S=isNaN(S)?1:S,L=isNaN(L)?0:L,R=isNaN(R)?0:R,O=isNaN(O)?1:O,V=isNaN(V)?0:V,ne=isNaN(ne)?0:ne,this.ctx.transform=new c(S,L,R,O,V,ne)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(S,L,R,O,V,ne,ue,fe,ye){var pe=this.pdf.getImageProperties(S),_e=1,Ue=1,Ve=1,Se=1;O!==void 0&&fe!==void 0&&(Ve=fe/O,Se=ye/V,_e=pe.width/O*fe/O,Ue=pe.height/V*ye/V),ne===void 0&&(ne=L,ue=R,L=0,R=0),O!==void 0&&fe===void 0&&(fe=O,ye=V),O===void 0&&fe===void 0&&(fe=pe.width,ye=pe.height);for(var le,Me=this.ctx.transform.decompose(),rt=B(Me.rotate.shx),He=new c,Ke=(He=(He=(He=He.multiply(Me.translate)).multiply(Me.skew)).multiply(Me.scale)).applyToRectangle(new l(ne-L*Ve,ue-R*Se,O*_e,V*Ue)),Ze=w.call(this,Ke),tt=[],dt=0;dt<Ze.length;dt+=1)tt.indexOf(Ze[dt])===-1&&tt.push(Ze[dt]);if(_(tt),this.autoPaging)for(var ft=tt[0],bt=tt[tt.length-1],Et=ft;Et<bt+1;Et++){this.pdf.setPage(Et);var Ft=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Dt=Et===1?this.posY+this.margin[0]:this.margin[0],xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],st=Et===1?0:xt+(Et-2)*Ct;if(this.ctx.clip_path.length!==0){var rn=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(le,this.posX+this.margin[3],-st+Dt+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=rn}var Mt=JSON.parse(JSON.stringify(Ke));Mt=b([Mt],this.posX+this.margin[3],-st+Dt+this.ctx.prevPageLastElemOffset)[0];var ts=(Et>ft||Et<bt)&&g.call(this);ts&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ft,Ct,null).clip().discardPath()),this.pdf.addImage(S,"JPEG",Mt.x,Mt.y,Mt.w,Mt.h,null,null,rt),ts&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(S,"JPEG",Ke.x,Ke.y,Ke.w,Ke.h,null,null,rt)};var w=function(S,L,R){var O=[];L=L||this.pdf.internal.pageSize.width,R=R||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var V=this.posY+this.ctx.prevPageLastElemOffset;switch(S.type){default:case"mt":case"lt":O.push(Math.floor((S.y+V)/R)+1);break;case"arc":O.push(Math.floor((S.y+V-S.radius)/R)+1),O.push(Math.floor((S.y+V+S.radius)/R)+1);break;case"qct":var ne=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x,S.y);O.push(Math.floor((ne.y+V)/R)+1),O.push(Math.floor((ne.y+ne.h+V)/R)+1);break;case"bct":var ue=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x2,S.y2,S.x,S.y);O.push(Math.floor((ue.y+V)/R)+1),O.push(Math.floor((ue.y+ue.h+V)/R)+1);break;case"rect":O.push(Math.floor((S.y+V)/R)+1),O.push(Math.floor((S.y+S.h+V)/R)+1)}for(var fe=0;fe<O.length;fe+=1)for(;this.pdf.internal.getNumberOfPages()<O[fe];)v.call(this);return O},v=function(){var S=this.fillStyle,L=this.strokeStyle,R=this.font,O=this.lineCap,V=this.lineWidth,ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=S,this.strokeStyle=L,this.font=R,this.lineCap=O,this.lineWidth=V,this.lineJoin=ne},b=function(S,L,R){for(var O=0;O<S.length;O++)switch(S[O].type){case"bct":S[O].x2+=L,S[O].y2+=R;case"qct":S[O].x1+=L,S[O].y1+=R;case"mt":case"lt":case"arc":default:S[O].x+=L,S[O].y+=R}return S},_=function(S){return S.sort(function(L,R){return L-R})},E=function(S,L){for(var R,O,V=this.fillStyle,ne=this.strokeStyle,ue=this.lineCap,fe=this.lineWidth,ye=Math.abs(fe*this.ctx.transform.scaleX),pe=this.lineJoin,_e=JSON.parse(JSON.stringify(this.path)),Ue=JSON.parse(JSON.stringify(this.path)),Ve=[],Se=0;Se<Ue.length;Se++)if(Ue[Se].x!==void 0)for(var le=w.call(this,Ue[Se]),Me=0;Me<le.length;Me+=1)Ve.indexOf(le[Me])===-1&&Ve.push(le[Me]);for(var rt=0;rt<Ve.length;rt++)for(;this.pdf.internal.getNumberOfPages()<Ve[rt];)v.call(this);if(_(Ve),this.autoPaging)for(var He=Ve[0],Ke=Ve[Ve.length-1],Ze=He;Ze<Ke+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=V,this.strokeStyle=ne,this.lineCap=ue,this.lineWidth=ye,this.lineJoin=pe;var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],dt=Ze===1?this.posY+this.margin[0]:this.margin[0],ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Et=Ze===1?0:ft+(Ze-2)*bt;if(this.ctx.clip_path.length!==0){var Ft=this.path;R=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(R,this.posX+this.margin[3],-Et+dt+this.ctx.prevPageLastElemOffset),D.call(this,S,!0),this.path=Ft}if(O=JSON.parse(JSON.stringify(_e)),this.path=b(O,this.posX+this.margin[3],-Et+dt+this.ctx.prevPageLastElemOffset),L===!1||Ze===0){var Dt=(Ze>He||Ze<Ke)&&g.call(this);Dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,bt,null).clip().discardPath()),D.call(this,S,L),Dt&&this.pdf.restoreGraphicsState()}this.lineWidth=fe}else this.lineWidth=ye,D.call(this,S,L),this.lineWidth=fe;this.path=_e},D=function(S,L){if((S!=="stroke"||L||!y.call(this))&&(S==="stroke"||L||!h.call(this))){for(var R,O,V=[],ne=this.path,ue=0;ue<ne.length;ue++){var fe=ne[ue];switch(fe.type){case"begin":V.push({begin:!0});break;case"close":V.push({close:!0});break;case"mt":V.push({start:fe,deltas:[],abs:[]});break;case"lt":var ye=V.length;if(ne[ue-1]&&!isNaN(ne[ue-1].x)&&(R=[fe.x-ne[ue-1].x,fe.y-ne[ue-1].y],ye>0)){for(;ye>=0;ye--)if(V[ye-1].close!==!0&&V[ye-1].begin!==!0){V[ye-1].deltas.push(R),V[ye-1].abs.push(fe);break}}break;case"bct":R=[fe.x1-ne[ue-1].x,fe.y1-ne[ue-1].y,fe.x2-ne[ue-1].x,fe.y2-ne[ue-1].y,fe.x-ne[ue-1].x,fe.y-ne[ue-1].y],V[V.length-1].deltas.push(R);break;case"qct":var pe=ne[ue-1].x+2/3*(fe.x1-ne[ue-1].x),_e=ne[ue-1].y+2/3*(fe.y1-ne[ue-1].y),Ue=fe.x+2/3*(fe.x1-fe.x),Ve=fe.y+2/3*(fe.y1-fe.y),Se=fe.x,le=fe.y;R=[pe-ne[ue-1].x,_e-ne[ue-1].y,Ue-ne[ue-1].x,Ve-ne[ue-1].y,Se-ne[ue-1].x,le-ne[ue-1].y],V[V.length-1].deltas.push(R);break;case"arc":V.push({deltas:[],abs:[],arc:!0}),Array.isArray(V[V.length-1].abs)&&V[V.length-1].abs.push(fe)}}O=L?null:S==="stroke"?"stroke":"fill";for(var Me=!1,rt=0;rt<V.length;rt++)if(V[rt].arc)for(var He=V[rt].abs,Ke=0;Ke<He.length;Ke++){var Ze=He[Ke];Ze.type==="arc"?P.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,L,!Me):q.call(this,Ze.x,Ze.y),Me=!0}else if(V[rt].close===!0)this.pdf.internal.out("h"),Me=!1;else if(V[rt].begin!==!0){var tt=V[rt].start.x,dt=V[rt].start.y;U.call(this,V[rt].deltas,tt,dt),Me=!0}O&&C.call(this,O),L&&M.call(this)}},I=function(S){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,R=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return S-R;case"top":return S+L-R;case"hanging":return S+L-2*R;case"middle":return S+L/2-R;case"ideographic":return S;case"alphabetic":default:return S}},A=function(S){return S+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var S=function(){};return S.colorStops=[],S.addColorStop=function(L,R){this.colorStops.push([L,R])},S.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},S.isCanvasGradient=!0,S},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(S,L,R,O,V,ne,ue,fe,ye){for(var pe=z.call(this,R,O,V,ne),_e=0;_e<pe.length;_e++){var Ue=pe[_e];_e===0&&(ye?j.call(this,Ue.x1+S,Ue.y1+L):q.call(this,Ue.x1+S,Ue.y1+L)),re.call(this,S,L,Ue.x2,Ue.y2,Ue.x3,Ue.y3,Ue.x4,Ue.y4)}fe?M.call(this):C.call(this,ue)},C=function(S){switch(S){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},j=function(S,L){this.pdf.internal.out(r(S)+" "+n(L)+" m")},T=function(S){var L;switch(S.align){case"right":case"end":L="right";break;case"center":L="center";break;case"left":case"start":default:L="left"}var R=this.pdf.getTextDimensions(S.text),O=I.call(this,S.y),V=A.call(this,O)-R.h,ne=this.ctx.transform.applyToPoint(new a(S.x,O)),ue=this.ctx.transform.decompose(),fe=new c;fe=(fe=(fe=fe.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var ye,pe,_e,Ue=this.ctx.transform.applyToRectangle(new l(S.x,O,R.w,R.h)),Ve=fe.applyToRectangle(new l(S.x,V,R.w,R.h)),Se=w.call(this,Ve),le=[],Me=0;Me<Se.length;Me+=1)le.indexOf(Se[Me])===-1&&le.push(Se[Me]);if(_(le),this.autoPaging)for(var rt=le[0],He=le[le.length-1],Ke=rt;Ke<He+1;Ke++){this.pdf.setPage(Ke);var Ze=Ke===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[2],ft=dt-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],Et=bt-this.margin[3],Ft=Ke===1?0:tt+(Ke-2)*ft;if(this.ctx.clip_path.length!==0){var Dt=this.path;ye=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ye,this.posX+this.margin[3],-1*Ft+Ze),D.call(this,"fill",!0),this.path=Dt}var xt=b([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-Ft+Ze+this.ctx.prevPageLastElemOffset)[0];S.scale>=.01&&(pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(pe*S.scale),_e=this.lineWidth,this.lineWidth=_e*S.scale);var Ct=this.autoPaging!=="text";if(Ct||xt.y+xt.h<=dt){if(Ct||xt.y>=Ze&&xt.x<=bt){var st=Ct?S.text:this.pdf.splitTextToSize(S.text,S.maxWidth||bt-xt.x)[0],rn=b([JSON.parse(JSON.stringify(Ue))],this.posX+this.margin[3],-Ft+Ze+this.ctx.prevPageLastElemOffset)[0],Mt=Ct&&(Ke>rt||Ke<He)&&g.call(this);Mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,ft,null).clip().discardPath()),this.pdf.text(st,rn.x,rn.y,{angle:S.angle,align:L,renderingMode:S.renderingMode}),Mt&&this.pdf.restoreGraphicsState()}}else xt.y<dt&&(this.ctx.prevPageLastElemOffset+=dt-xt.y);S.scale>=.01&&(this.pdf.setFontSize(pe),this.lineWidth=_e)}else S.scale>=.01&&(pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(pe*S.scale),_e=this.lineWidth,this.lineWidth=_e*S.scale),this.pdf.text(S.text,ne.x+this.posX,ne.y+this.posY,{angle:S.angle,align:L,renderingMode:S.renderingMode,maxWidth:S.maxWidth}),S.scale>=.01&&(this.pdf.setFontSize(pe),this.lineWidth=_e)},q=function(S,L,R,O){R=R||0,O=O||0,this.pdf.internal.out(r(S+R)+" "+n(L+O)+" l")},U=function(S,L,R){return this.pdf.lines(S,L,R,null,null)},re=function(S,L,R,O,V,ne,ue,fe){this.pdf.internal.out([t(s(R+S)),t(i(O+L)),t(s(V+S)),t(i(ne+L)),t(s(ue+S)),t(i(fe+L)),"c"].join(" "))},z=function(S,L,R,O){for(var V=2*Math.PI,ne=Math.PI/2;L>R;)L-=V;var ue=Math.abs(R-L);ue<V&&O&&(ue=V-ue);for(var fe=[],ye=O?-1:1,pe=L;ue>1e-5;){var _e=pe+ye*Math.min(ue,ne);fe.push(G.call(this,S,pe,_e)),ue-=Math.abs(_e-pe),pe=_e}return fe},G=function(S,L,R){var O=(R-L)/2,V=S*Math.cos(O),ne=S*Math.sin(O),ue=V,fe=-ne,ye=ue*ue+fe*fe,pe=ye+ue*V+fe*ne,_e=4/3*(Math.sqrt(2*ye*pe)-pe)/(ue*ne-fe*V),Ue=ue-_e*fe,Ve=fe+_e*ue,Se=Ue,le=-Ve,Me=O+L,rt=Math.cos(Me),He=Math.sin(Me);return{x1:S*Math.cos(L),y1:S*Math.sin(L),x2:Ue*rt-Ve*He,y2:Ue*He+Ve*rt,x3:Se*rt-le*He,y3:Se*He+le*rt,x4:S*Math.cos(R),y4:S*Math.sin(R)}},B=function(S){return 180*S/Math.PI},Y=function(S,L,R,O,V,ne){var ue=S+.5*(R-S),fe=L+.5*(O-L),ye=V+.5*(R-V),pe=ne+.5*(O-ne),_e=Math.min(S,V,ue,ye),Ue=Math.max(S,V,ue,ye),Ve=Math.min(L,ne,fe,pe),Se=Math.max(L,ne,fe,pe);return new l(_e,Ve,Ue-_e,Se-Ve)},se=function(S,L,R,O,V,ne,ue,fe){var ye,pe,_e,Ue,Ve,Se,le,Me,rt,He,Ke,Ze,tt,dt,ft=R-S,bt=O-L,Et=V-R,Ft=ne-O,Dt=ue-V,xt=fe-ne;for(pe=0;pe<41;pe++)rt=(le=(_e=S+(ye=pe/40)*ft)+ye*((Ve=R+ye*Et)-_e))+ye*(Ve+ye*(V+ye*Dt-Ve)-le),He=(Me=(Ue=L+ye*bt)+ye*((Se=O+ye*Ft)-Ue))+ye*(Se+ye*(ne+ye*xt-Se)-Me),pe==0?(Ke=rt,Ze=He,tt=rt,dt=He):(Ke=Math.min(Ke,rt),Ze=Math.min(Ze,He),tt=Math.max(tt,rt),dt=Math.max(dt,He));return new l(Math.round(Ke),Math.round(Ze),Math.round(tt-Ke),Math.round(dt-Ze))},me=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var S,L,R=(S=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:S,lineDashOffset:L}));this.prevLineDash!==R&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=R)}}})(mt.API),function(e){var t=function(i){var a,l,c,u,d,m,p,h,y,g;for(l=[],c=0,u=(i+=a="\0\0\0\0".slice(i.length%4||4)).length;u>c;c+=4)(d=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(m=(d=((d=((d=((d=(d-(g=d%85))/85)-(y=d%85))/85)-(h=d%85))/85)-(p=d%85))/85)%85,l.push(m+33,p+33,h+33,y+33,g+33)):l.push(122);return function(w,v){for(var b=v;b>0;b--)w.pop()}(l,a.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var a,l,c,u,d,m=String,p="length",h=255,y="charCodeAt",g="slice",w="replace";for(i[g](-2),i=i[g](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],u=0,d=(i+=a="uuuuu"[g](i[p]%5||5))[p];d>u;u+=5)l=52200625*(i[y](u)-33)+614125*(i[y](u+1)-33)+7225*(i[y](u+2)-33)+85*(i[y](u+3)-33)+(i[y](u+4)-33),c.push(h&l>>24,h&l>>16,h&l>>8,h&l);return function(v,b){for(var _=b;_>0;_--)v.pop()}(c,a[p]),m.fromCharCode.apply(m,c)},n=function(i){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),a.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},s=function(i){for(var a=new Uint8Array(i.length),l=i.length;l--;)a[l]=i.charCodeAt(l);return i=(a=Ug(a)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};e.processDataByFilters=function(i,a){var l=0,c=i||"",u=[];for(typeof(a=a||[])=="string"&&(a=[a]),l=0;l<a.length;l+=1)switch(a[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(mt.API),function(e){e.loadFile=function(t,r,n){return function(s,i,a){i=i!==!1,a=typeof a=="function"?a:function(){};var l=void 0;try{l=function(c,u,d){var m=new XMLHttpRequest,p=0,h=function(y){var g=y.length,w=[],v=String.fromCharCode;for(p=0;p<g;p+=1)w.push(v(255&y.charCodeAt(p)));return w.join("")};if(m.open("GET",c,!u),m.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(m.onload=function(){m.status===200?d(h(this.responseText)):d(void 0)}),m.send(null),u&&m.status===200)return h(m.responseText)}(s,i,a)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(mt.API),function(e){function t(){return(vt.html2canvas?Promise.resolve(vt.html2canvas):Ea(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function r(){return(vt.DOMPurify?Promise.resolve(vt.DOMPurify):Ea(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var l=tr(a);return l==="undefined"?"undefined":l==="string"||a instanceof String?"string":l==="number"||a instanceof Number?"number":l==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(a,l){var c=document.createElement(a);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},i=function a(l){var c=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),u=a.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,a,1,[a])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(a,l){return a.__proto__=l||i.prototype,a},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(a,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(r).then(function(c){return this.set({src:s("div",{innerHTML:a,dompurify:c})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},i.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,d){for(var m=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),p=u.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||m.appendChild(c(p,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(m.width=u.width,m.height=u.height,m.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(m.value=u.value),m.addEventListener("load",function(){m.scrollTop=u.scrollTop,m.scrollLeft=u.scrollLeft},!0)),m}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var p=0;p<u.length;++p){var h=u[p],y=h.src.find(function(g){return g.format==="truetype"});y&&c.addFont(y.url,h.ref.name,h.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,c.context2d.save(!0),l(this.prop.container,m)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(a,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(a,l):this.outputPdf(a,l)},i.prototype.outputPdf=function(a,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,l)})},i.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},i.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(a){if(n(a)!=="object")return this;var l=Object.keys(a||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=a[c]};switch(c){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[c]=a[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(a,l){return this.then(function(){var c=a in i.template.prop?this.prop[a]:this.opt[a];return l?l(c):c})},i.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},i.prototype.setPageSize=function(a){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(a=a||mt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:l(a.inner.width,a.k),height:l(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},i.prototype.setProgress=function(a,l,c,u){return a!=null&&(this.progress.val=a),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(a,l,c,u){return this.setProgress(a?this.progress.val+a:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(a,l){var c=this;return this.thenCore(a,l,function(u,d){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return c.updateProgress(null,u),m}).then(u,d).then(function(m){return c.updateProgress(1),m})})},i.prototype.thenCore=function(a,l,c){c=c||Promise.prototype.then,a&&(a=a.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=c.call(u,a,l);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(a,l){return Promise.prototype.then.call(this,a,l)},i.prototype.thenList=function(a){var l=this;return a.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(a){a&&(a=a.bind(this));var l=Promise.prototype.catch.call(this,a);return i.convert(l,this)},i.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},i.prototype.error=function(a){return this.then(function(){throw new Error(a)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,mt.getPageSize=function(a,l,c){if(tr(a)==="object"){var u=a;a=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",a=(""+(a||"P")).toLowerCase();var d,m=(""+c).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var h,y=0,g=0;if(p.hasOwnProperty(m))y=p[m][1]/d,g=p[m][0]/d;else try{y=c[1],g=c[0]}catch{throw new Error("Invalid format: "+c)}if(a==="p"||a==="portrait")a="p",g>y&&(h=g,g=y,y=h);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",y>g&&(h=g,g=y,y=h)}return{width:g,height:y,unit:l,k:d,orientation:a}},e.html=function(a,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Vg):null;var c=new i(l);return l.worker?c:c.from(a).doCallback()}}(mt.API),mt.API.addJS=function(e){return i5=e,this.internal.events.subscribe("postPutResources",function(){qh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(qh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),s5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+i5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){qh!==void 0&&s5!==void 0&&this.internal.out("/Names <</JavaScript "+qh+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var a=s[i],l=n.exec(a);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(a)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(i=0;i<u;i++){var m=r.internal.newObject();d.push(m);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,i){var a={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(a),a},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var a=n.children[i];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var l=this.count=this.count_r({count:0},a);if(l>0&&this.line("/Count "+l),a.options&&a.options.pageNumber){var c=r.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])}(mt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,i,a,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=a||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(m){for(var p,h=256*m.charCodeAt(4)+m.charCodeAt(5),y=m.length,g={width:0,height:0,numcomponents:1},w=4;w<y;w+=2){if(w+=h,t.indexOf(m.charCodeAt(w+1))!==-1){p=256*m.charCodeAt(w+5)+m.charCodeAt(w+6),g={width:256*m.charCodeAt(w+7)+m.charCodeAt(w+8),height:p,numcomponents:m.charCodeAt(w+9)};break}h=256*m.charCodeAt(w+2)+m.charCodeAt(w+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:s}}return d}}(mt.API);var gc,Vh,a5,o5,l5,VC=function(){var e,t,r;function n(i){var a,l,c,u,d,m,p,h,y,g,w,v,b,_;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},m=null;;){switch(a=this.readUInt32(),y=(function(){var E,D;for(D=[],E=0;E<4;++E)D.push(String.fromCharCode(this.data[this.pos++]));return D}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":m&&this.animation.frames.push(m),this.pos+=4,m={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,m.delay=1e3*d/u,m.disposeOp=this.data[this.pos++],m.blendOp=this.data[this.pos++],m.data=[];break;case"IDAT":case"fdAT":for(y==="fdAT"&&(this.pos+=4,a-=4),i=(m!=null?m.data:void 0)||this.imgData,v=0;0<=a?v<a:v>a;0<=a?++v:--v)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((g=c-this.transparency.indexed.length)>0)for(b=0;0<=g?b<g:b>g;0<=g?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":p=(w=this.read(a)).indexOf(0),h=String.fromCharCode.apply(String,w.slice(0,p)),this.text[h]=String.fromCharCode.apply(String,w.slice(p+1));break;case"IEND":return m&&this.animation.frames.push(m),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var a,l;for(l=[],a=0;0<=i?a<i:a>i;0<=i?++a:--a)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var a=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*a),c=0,u=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(m,p,h,y){var g,w,v,b,_,E,D,I,A,P,C,M,j,T,q,U,re,z,G,B,Y,se=Math.ceil((u.width-m)/h),me=Math.ceil((u.height-p)/y),S=u.width==se&&u.height==me;for(T=a*se,M=S?l:new Uint8Array(T*me),E=i.length,j=0,w=0;j<me&&c<E;){switch(i[c++]){case 0:for(b=re=0;re<T;b=re+=1)M[w++]=i[c++];break;case 1:for(b=z=0;z<T;b=z+=1)g=i[c++],_=b<a?0:M[w-a],M[w++]=(g+_)%256;break;case 2:for(b=G=0;G<T;b=G+=1)g=i[c++],v=(b-b%a)/a,q=j&&M[(j-1)*T+v*a+b%a],M[w++]=(q+g)%256;break;case 3:for(b=B=0;B<T;b=B+=1)g=i[c++],v=(b-b%a)/a,_=b<a?0:M[w-a],q=j&&M[(j-1)*T+v*a+b%a],M[w++]=(g+Math.floor((_+q)/2))%256;break;case 4:for(b=Y=0;Y<T;b=Y+=1)g=i[c++],v=(b-b%a)/a,_=b<a?0:M[w-a],j===0?q=U=0:(q=M[(j-1)*T+v*a+b%a],U=v&&M[(j-1)*T+(v-1)*a+b%a]),D=_+q-U,I=Math.abs(D-_),P=Math.abs(D-q),C=Math.abs(D-U),A=I<=P&&I<=C?_:P<=C?q:U,M[w++]=(g+A)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!S){var L=((p+j*y)*u.width+m)*a,R=j*T;for(b=0;b<se;b+=1){for(var O=0;O<a;O+=1)l[L++]=M[R++];L+=(h-1)*a}}j++}}return i=NC(i),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),l},n.prototype.decodePalette=function(){var i,a,l,c,u,d,m,p,h;for(l=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+l.length),c=0,i=0,a=m=0,p=l.length;m<p;a=m+=3)u[c++]=l[a],u[c++]=l[a+1],u[c++]=l[a+2],u[c++]=(h=d[i++])!=null?h:255;return u},n.prototype.copyToImageData=function(i,a){var l,c,u,d,m,p,h,y,g,w,v;if(c=this.colors,g=null,l=this.hasAlphaChannel,this.palette.length&&(g=(v=this._decodedPalette)!=null?v:this._decodedPalette=this.decodePalette(),c=4,l=!0),y=(u=i.data||i).length,m=g||a,d=p=0,c===1)for(;d<y;)h=g?4*a[d/4]:p,w=m[h++],u[d++]=w,u[d++]=w,u[d++]=w,u[d++]=l?m[h++]:255,p=h;else for(;d<y;)h=g?4*a[d/4]:p,u[d++]=m[h++],u[d++]=m[h++],u[d++]=m[h++],u[d++]=l?m[h++]:255,p=h},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var s=function(){if(Object.prototype.toString.call(vt)==="[object Window]"){try{t=vt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return s(),e=function(i){var a;if(s()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var a,l,c,u,d,m,p,h;if(this.animation){for(h=[],l=d=0,m=(p=this.animation.frames).length;d<m;l=++d)a=p[l],c=i.createImageData(a.width,a.height),u=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(c,u),a.imageData=c,h.push(a.image=e(c));return h}},n.prototype.renderFrame=function(i,a){var l,c,u;return l=(c=this.animation.frames)[a],u=c[a-1],a===0&&i.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?i.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&i.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(i){var a,l,c,u,d,m,p=this;return l=0,m=this.animation,u=m.numFrames,c=m.frames,d=m.numPlays,(a=function(){var h,y;if(h=l++%u,y=c[h],p.renderFrame(i,h),u>1&&l/u<d)return p.animation._timeout=setTimeout(a,y.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var a,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,a=i.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(l=a.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),a.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function GC(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,a=1<<(7&s)+1;e[t++],e[t++];var l=null,c=null;i&&(l=t,c=a,t+=3*a);var u=!0,d=[],m=0,p=null,h=0,y=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,y=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];m=e[t++]|e[t++]<<8,p=e[t++],!(1&g)&&(p=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var w=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,E=e[t++],D=E>>6&1,I=1<<(7&E)+1,A=l,P=c,C=!1;E>>7&&(C=!0,A=t,P=I,t+=3*I);var M=t;for(t++;;){var j;if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}d.push({x:w,y:v,width:b,height:_,has_local_palette:C,palette_offset:A,palette_size:P,data_offset:M,data_length:t-M,transparent_index:p,interlaced:!!D,delay:m,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return y},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,q){var U=this.frameInfo(T),re=U.width*U.height,z=new Uint8Array(re);c5(e,U.data_offset,z,re);var G=U.palette_offset,B=U.transparent_index;B===null&&(B=256);var Y=U.width,se=r-Y,me=Y,S=4*(U.y*r+U.x),L=4*((U.y+U.height)*r+U.x),R=S,O=4*se;U.interlaced===!0&&(O+=4*r*7);for(var V=8,ne=0,ue=z.length;ne<ue;++ne){var fe=z[ne];if(me===0&&(me=Y,(R+=O)>=L&&(O=4*se+4*r*(V-1),R=S+(Y+se)*(V<<1),V>>=1)),fe===B)R+=4;else{var ye=e[G+3*fe],pe=e[G+3*fe+1],_e=e[G+3*fe+2];q[R++]=_e,q[R++]=pe,q[R++]=ye,q[R++]=255}--me}},this.decodeAndBlitFrameRGBA=function(T,q){var U=this.frameInfo(T),re=U.width*U.height,z=new Uint8Array(re);c5(e,U.data_offset,z,re);var G=U.palette_offset,B=U.transparent_index;B===null&&(B=256);var Y=U.width,se=r-Y,me=Y,S=4*(U.y*r+U.x),L=4*((U.y+U.height)*r+U.x),R=S,O=4*se;U.interlaced===!0&&(O+=4*r*7);for(var V=8,ne=0,ue=z.length;ne<ue;++ne){var fe=z[ne];if(me===0&&(me=Y,(R+=O)>=L&&(O=4*se+4*r*(V-1),R=S+(Y+se)*(V<<1),V>>=1)),fe===B)R+=4;else{var ye=e[G+3*fe],pe=e[G+3*fe+1],_e=e[G+3*fe+2];q[R++]=ye,q[R++]=pe,q[R++]=_e,q[R++]=255}--me}}}function c5(e,t,r,n){for(var s=e[t++],i=1<<s,a=i+1,l=a+1,c=s+1,u=(1<<c)-1,d=0,m=0,p=0,h=e[t++],y=new Int32Array(4096),g=null;;){for(;d<16&&h!==0;)m|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var w=m&u;if(m>>=c,d-=c,w!==i){if(w===a)break;for(var v=w<l?w:g,b=0,_=v;_>i;)_=y[_]>>8,++b;var E=_;if(p+b+(v!==w?1:0)>n)return void ur.log("Warning, gif stream longer than expected.");r[p++]=E;var D=p+=b;for(v!==w&&(r[p++]=E),_=v;b--;)_=y[_],r[--D]=255&_,_>>=8;g!==null&&l<4096&&(y[l++]=g<<8|E,l>=u+1&&c<12&&(++c,u=u<<1|1)),g=w}else l=a+1,u=(1<<(c=s+1))-1,g=null}return p!==n&&ur.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function v1(e){var t,r,n,s,i,a=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),m=new Array(65535),p=new Array(65535),h=new Array(64),y=new Array(64),g=[],w=0,v=7,b=new Array(64),_=new Array(64),E=new Array(64),D=new Array(256),I=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],j=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],re=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function z(S,L){for(var R=0,O=0,V=new Array,ne=1;ne<=16;ne++){for(var ue=1;ue<=S[ne];ue++)V[L[O]]=[],V[L[O]][0]=R,V[L[O]][1]=ne,O++,R++;R*=2}return V}function G(S){for(var L=S[0],R=S[1]-1;R>=0;)L&1<<R&&(w|=1<<v),R--,--v<0&&(w==255?(B(255),B(0)):B(w),v=7,w=0)}function B(S){g.push(S)}function Y(S){B(S>>8&255),B(255&S)}function se(S,L,R,O,V){for(var ne,ue=V[0],fe=V[240],ye=function(He,Ke){var Ze,tt,dt,ft,bt,Et,Ft,Dt,xt,Ct,st=0;for(xt=0;xt<8;++xt){Ze=He[st],tt=He[st+1],dt=He[st+2],ft=He[st+3],bt=He[st+4],Et=He[st+5],Ft=He[st+6];var rn=Ze+(Dt=He[st+7]),Mt=Ze-Dt,ts=tt+Ft,Yt=tt-Ft,dr=dt+Et,Us=dt-Et,Ut=ft+bt,Oi=ft-bt,xr=rn+Ut,ys=rn-Ut,ai=ts+dr,lr=ts-dr;He[st]=xr+ai,He[st+4]=xr-ai;var _t=.707106781*(lr+ys);He[st+2]=ys+_t,He[st+6]=ys-_t;var Ht=.382683433*((xr=Oi+Us)-(lr=Yt+Mt)),ra=.5411961*xr+Ht,nn=1.306562965*lr+Ht,zs=.707106781*(ai=Us+Yt),Ws=Mt+zs,pt=Mt-zs;He[st+5]=pt+ra,He[st+3]=pt-ra,He[st+1]=Ws+nn,He[st+7]=Ws-nn,st+=8}for(st=0,xt=0;xt<8;++xt){Ze=He[st],tt=He[st+8],dt=He[st+16],ft=He[st+24],bt=He[st+32],Et=He[st+40],Ft=He[st+48];var ws=Ze+(Dt=He[st+56]),rs=Ze-Dt,Cn=tt+Ft,Ir=tt-Ft,Tr=dt+Et,X=dt-Et,oe=ft+bt,ee=ft-bt,te=ws+oe,ae=ws-oe,ce=Cn+Tr,je=Cn-Tr;He[st]=te+ce,He[st+32]=te-ce;var Pe=.707106781*(je+ae);He[st+16]=ae+Pe,He[st+48]=ae-Pe;var ke=.382683433*((te=ee+X)-(je=Ir+rs)),Te=.5411961*te+ke,Ce=1.306562965*je+ke,qe=.707106781*(ce=X+Ir),Xe=rs+qe,at=rs-qe;He[st+40]=at+Te,He[st+24]=at-Te,He[st+8]=Xe+Ce,He[st+56]=Xe-Ce,st++}for(xt=0;xt<64;++xt)Ct=He[xt]*Ke[xt],h[xt]=Ct>0?Ct+.5|0:Ct-.5|0;return h}(S,L),pe=0;pe<64;++pe)y[A[pe]]=ye[pe];var _e=y[0]-R;R=y[0],_e==0?G(O[0]):(G(O[p[ne=32767+_e]]),G(m[ne]));for(var Ue=63;Ue>0&&y[Ue]==0;)Ue--;if(Ue==0)return G(ue),R;for(var Ve,Se=1;Se<=Ue;){for(var le=Se;y[Se]==0&&Se<=Ue;)++Se;var Me=Se-le;if(Me>=16){Ve=Me>>4;for(var rt=1;rt<=Ve;++rt)G(fe);Me&=15}ne=32767+y[Se],G(V[(Me<<4)+p[ne]]),G(m[ne]),Se++}return Ue!=63&&G(ue),R}function me(S){S=Math.min(Math.max(S,1),100),i!=S&&(function(L){for(var R=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var V=a((R[O]*L+50)/100);V=Math.min(Math.max(V,1),255),l[A[O]]=V}for(var ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var fe=a((ne[ue]*L+50)/100);fe=Math.min(Math.max(fe,1),255),c[A[ue]]=fe}for(var ye=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],pe=0,_e=0;_e<8;_e++)for(var Ue=0;Ue<8;Ue++)u[pe]=1/(l[A[pe]]*ye[_e]*ye[Ue]*8),d[pe]=1/(c[A[pe]]*ye[_e]*ye[Ue]*8),pe++}(S<50?Math.floor(5e3/S):Math.floor(200-2*S)),i=S)}this.encode=function(S,L){L&&me(L),g=new Array,w=0,v=7,Y(65496),Y(65504),Y(16),B(74),B(70),B(73),B(70),B(0),B(1),B(1),B(0),Y(1),Y(1),B(0),B(0),function(){Y(65499),Y(132),B(0);for(var tt=0;tt<64;tt++)B(l[tt]);B(1);for(var dt=0;dt<64;dt++)B(c[dt])}(),function(tt,dt){Y(65472),Y(17),B(8),Y(dt),Y(tt),B(3),B(1),B(17),B(0),B(2),B(17),B(1),B(3),B(17),B(1)}(S.width,S.height),function(){Y(65476),Y(418),B(0);for(var tt=0;tt<16;tt++)B(P[tt+1]);for(var dt=0;dt<=11;dt++)B(C[dt]);B(16);for(var ft=0;ft<16;ft++)B(M[ft+1]);for(var bt=0;bt<=161;bt++)B(j[bt]);B(1);for(var Et=0;Et<16;Et++)B(T[Et+1]);for(var Ft=0;Ft<=11;Ft++)B(q[Ft]);B(17);for(var Dt=0;Dt<16;Dt++)B(U[Dt+1]);for(var xt=0;xt<=161;xt++)B(re[xt])}(),Y(65498),Y(12),B(3),B(1),B(0),B(2),B(17),B(3),B(17),B(0),B(63),B(0);var R=0,O=0,V=0;w=0,v=7,this.encode.displayName="_encode_";for(var ne,ue,fe,ye,pe,_e,Ue,Ve,Se,le=S.data,Me=S.width,rt=S.height,He=4*Me,Ke=0;Ke<rt;){for(ne=0;ne<He;){for(pe=He*Ke+ne,Ue=-1,Ve=0,Se=0;Se<64;Se++)_e=pe+(Ve=Se>>3)*He+(Ue=4*(7&Se)),Ke+Ve>=rt&&(_e-=He*(Ke+1+Ve-rt)),ne+Ue>=He&&(_e-=ne+Ue-He+4),ue=le[_e++],fe=le[_e++],ye=le[_e++],b[Se]=(I[ue]+I[fe+256>>0]+I[ye+512>>0]>>16)-128,_[Se]=(I[ue+768>>0]+I[fe+1024>>0]+I[ye+1280>>0]>>16)-128,E[Se]=(I[ue+1280>>0]+I[fe+1536>>0]+I[ye+1792>>0]>>16)-128;R=se(b,u,R,t,n),O=se(_,d,O,r,s),V=se(E,d,V,r,s),ne+=32}Ke+=8}if(v>=0){var Ze=[];Ze[1]=v+1,Ze[0]=(1<<v+1)-1,G(Ze)}return Y(65497),new Uint8Array(g)},e=e||50,function(){for(var S=String.fromCharCode,L=0;L<256;L++)D[L]=S(L)}(),t=z(P,C),r=z(T,q),n=z(M,j),s=z(U,re),function(){for(var S=1,L=2,R=1;R<=15;R++){for(var O=S;O<L;O++)p[32767+O]=R,m[32767+O]=[],m[32767+O][1]=R,m[32767+O][0]=O;for(var V=-(L-1);V<=-S;V++)p[32767+V]=R,m[32767+V]=[],m[32767+V][1]=R,m[32767+V][0]=L-1+V;S<<=1,L<<=1}}(),function(){for(var S=0;S<256;S++)I[S]=19595*S,I[S+256>>0]=38470*S,I[S+512>>0]=7471*S+32768,I[S+768>>0]=-11059*S,I[S+1024>>0]=-21709*S,I[S+1280>>0]=32768*S+8421375,I[S+1536>>0]=-27439*S,I[S+1792>>0]=-5329*S}(),me(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function gi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function u5(e){function t(P){if(!P)throw Error("assert :P")}function r(P,C,M){for(var j=0;4>j;j++)if(P[C+j]!=M.charCodeAt(j))return!0;return!1}function n(P,C,M,j,T){for(var q=0;q<T;q++)P[C+q]=M[j+q]}function s(P,C,M,j){for(var T=0;T<j;T++)P[C+T]=M}function i(P){return new Int32Array(P)}function a(P,C){for(var M=[],j=0;j<P;j++)M.push(new C);return M}function l(P,C){var M=[];return function j(T,q,U){for(var re=U[q],z=0;z<re&&(T.push(U.length>q+1?[]:new C),!(U.length<q+1));z++)j(T[z],q+1,U)}(M,0,P),M}var c=function(){var P=this;function C(f,x){for(var k=1<<x-1>>>0;f&k;)k>>>=1;return k?(f&k-1)+k:f}function M(f,x,k,F,W){t(!(F%k));do f[x+(F-=k)]=W;while(0<F)}function j(f,x,k,F,W){if(t(2328>=W),512>=W)var K=i(512);else if((K=i(W))==null)return 0;return function(J,Q,Z,ie,xe,Ee){var Ae,be,Re=Q,Le=1<<Z,ve=i(16),we=i(16);for(t(xe!=0),t(ie!=null),t(J!=null),t(0<Z),be=0;be<xe;++be){if(15<ie[be])return 0;++ve[ie[be]]}if(ve[0]==xe)return 0;for(we[1]=0,Ae=1;15>Ae;++Ae){if(ve[Ae]>1<<Ae)return 0;we[Ae+1]=we[Ae]+ve[Ae]}for(be=0;be<xe;++be)Ae=ie[be],0<ie[be]&&(Ee[we[Ae]++]=be);if(we[15]==1)return(ie=new T).g=0,ie.value=Ee[0],M(J,Re,1,Le,ie),Le;var De,ze=-1,Ie=Le-1,lt=0,et=1,gt=1,nt=1<<Z;for(be=0,Ae=1,xe=2;Ae<=Z;++Ae,xe<<=1){if(et+=gt<<=1,0>(gt-=ve[Ae]))return 0;for(;0<ve[Ae];--ve[Ae])(ie=new T).g=Ae,ie.value=Ee[be++],M(J,Re+lt,xe,nt,ie),lt=C(lt,Ae)}for(Ae=Z+1,xe=2;15>=Ae;++Ae,xe<<=1){if(et+=gt<<=1,0>(gt-=ve[Ae]))return 0;for(;0<ve[Ae];--ve[Ae]){if(ie=new T,(lt&Ie)!=ze){for(Re+=nt,De=1<<(ze=Ae)-Z;15>ze&&!(0>=(De-=ve[ze]));)++ze,De<<=1;Le+=nt=1<<(De=ze-Z),J[Q+(ze=lt&Ie)].g=De+Z,J[Q+ze].value=Re-Q-ze}ie.g=Ae-Z,ie.value=Ee[be++],M(J,Re+(lt>>Z),xe,nt,ie),lt=C(lt,Ae)}}return et!=2*we[15]-1?0:Le}(f,x,k,F,W,K)}function T(){this.value=this.g=0}function q(){this.value=this.g=0}function U(){this.G=a(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(yn,q)}function re(f,x,k,F){t(f!=null),t(x!=null),t(2147483648>F),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=x,f.pa=k,f.Jd=x,f.Yc=k+F,f.Zc=4<=F?k+F-4+1:k,ne(f)}function z(f,x){for(var k=0;0<x--;)k|=fe(f,128)<<x;return k}function G(f,x){var k=z(f,x);return ue(f)?-k:k}function B(f,x,k,F){var W,K=0;for(t(f!=null),t(x!=null),t(4294967288>F),f.Sb=F,f.Ra=0,f.u=0,f.h=0,4<F&&(F=4),W=0;W<F;++W)K+=x[k+W]<<8*W;f.Ra=K,f.bb=F,f.oa=x,f.pa=k}function Y(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Zl-8>>>0,++f.bb,f.u-=8;R(f)&&(f.h=1,f.u=0)}function se(f,x){if(t(0<=x),!f.h&&x<=Ql){var k=L(f)&Jl[x];return f.u+=x,Y(f),k}return f.h=1,f.u=0}function me(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function S(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function L(f){return f.Ra>>>(f.u&Zl-1)>>>0}function R(f){return t(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Zl}function O(f,x){f.u=x,f.h=R(f)}function V(f){f.u>=Ru&&(t(f.u>=Ru),Y(f))}function ne(f){t(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(t(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function ue(f){return z(f,1)}function fe(f,x){var k=f.Ca;0>f.b&&ne(f);var F=f.b,W=k*x>>>8,K=(f.I>>>F>W)+0;for(K?(k-=W,f.I-=W+1<<F>>>0):k=W+1,F=k,W=0;256<=F;)W+=8,F>>=8;return F=7^W+ss[F],f.b-=F,f.Ca=(k<<F)-1,K}function ye(f,x,k){f[x+0]=k>>24&255,f[x+1]=k>>16&255,f[x+2]=k>>8&255,f[x+3]=k>>0&255}function pe(f,x){return f[x+0]<<0|f[x+1]<<8}function _e(f,x){return pe(f,x)|f[x+2]<<16}function Ue(f,x){return pe(f,x)|pe(f,x+2)<<16}function Ve(f,x){var k=1<<x;return t(f!=null),t(0<x),f.X=i(k),f.X==null?0:(f.Mb=32-x,f.Xa=x,1)}function Se(f,x){t(f!=null),t(x!=null),t(f.Xa==x.Xa),n(x.X,0,f.X,0,1<<x.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function Me(f,x,k,F){t(k!=null),t(F!=null);var W=k[0],K=F[0];return W==0&&(W=(f*K+x/2)/x),K==0&&(K=(x*W+f/2)/f),0>=W||0>=K?0:(k[0]=W,F[0]=K,1)}function rt(f,x){return f+(1<<x)-1>>>x}function He(f,x){return((4278255360&f)+(4278255360&x)>>>0&4278255360)+((16711935&f)+(16711935&x)>>>0&16711935)>>>0}function Ke(f,x){P[x]=function(k,F,W,K,J,Q,Z){var ie;for(ie=0;ie<J;++ie){var xe=P[f](Q[Z+ie-1],W,K+ie);Q[Z+ie]=He(k[F+ie],xe)}}}function Ze(){this.ud=this.hd=this.jd=0}function tt(f,x){return((4278124286&(f^x))>>>1)+(f&x)>>>0}function dt(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function ft(f,x){return dt(f+(f-x+.5>>1))}function bt(f,x,k){return Math.abs(x-k)-Math.abs(f-k)}function Et(f,x,k,F,W,K,J){for(F=K[J-1],k=0;k<W;++k)K[J+k]=F=He(f[x+k],F)}function Ft(f,x,k,F,W){var K;for(K=0;K<k;++K){var J=f[x+K],Q=J>>8&255,Z=16711935&(Z=(Z=16711935&J)+((Q<<16)+Q));F[W+K]=(4278255360&J)+Z>>>0}}function Dt(f,x){x.jd=f>>0&255,x.hd=f>>8&255,x.ud=f>>16&255}function xt(f,x,k,F,W,K){var J;for(J=0;J<F;++J){var Q=x[k+J],Z=Q>>>8,ie=Q,xe=255&(xe=(xe=Q>>>16)+((f.jd<<24>>24)*(Z<<24>>24)>>>5));ie=255&(ie=(ie=ie+((f.hd<<24>>24)*(Z<<24>>24)>>>5))+((f.ud<<24>>24)*(xe<<24>>24)>>>5)),W[K+J]=(4278255360&Q)+(xe<<16)+ie}}function Ct(f,x,k,F,W){P[x]=function(K,J,Q,Z,ie,xe,Ee,Ae,be){for(Z=Ee;Z<Ae;++Z)for(Ee=0;Ee<be;++Ee)ie[xe++]=W(Q[F(K[J++])])},P[f]=function(K,J,Q,Z,ie,xe,Ee){var Ae=8>>K.b,be=K.Ea,Re=K.K[0],Le=K.w;if(8>Ae)for(K=(1<<K.b)-1,Le=(1<<Ae)-1;J<Q;++J){var ve,we=0;for(ve=0;ve<be;++ve)ve&K||(we=F(Z[ie++])),xe[Ee++]=W(Re[we&Le]),we>>=Ae}else P["VP8LMapColor"+k](Z,ie,Re,Le,xe,Ee,J,Q,be)}}function st(f,x,k,F,W){for(k=x+k;x<k;){var K=f[x++];F[W++]=K>>16&255,F[W++]=K>>8&255,F[W++]=K>>0&255}}function rn(f,x,k,F,W){for(k=x+k;x<k;){var K=f[x++];F[W++]=K>>16&255,F[W++]=K>>8&255,F[W++]=K>>0&255,F[W++]=K>>24&255}}function Mt(f,x,k,F,W){for(k=x+k;x<k;){var K=(J=f[x++])>>16&240|J>>12&15,J=J>>0&240|J>>28&15;F[W++]=K,F[W++]=J}}function ts(f,x,k,F,W){for(k=x+k;x<k;){var K=(J=f[x++])>>16&248|J>>13&7,J=J>>5&224|J>>3&31;F[W++]=K,F[W++]=J}}function Yt(f,x,k,F,W){for(k=x+k;x<k;){var K=f[x++];F[W++]=K>>0&255,F[W++]=K>>8&255,F[W++]=K>>16&255}}function dr(f,x,k,F,W,K){if(K==0)for(k=x+k;x<k;)ye(F,((K=f[x++])[0]>>24|K[1]>>8&65280|K[2]<<8&16711680|K[3]<<24)>>>0),W+=32;else n(F,W,f,x,k)}function Us(f,x){P[x][0]=P[f+"0"],P[x][1]=P[f+"1"],P[x][2]=P[f+"2"],P[x][3]=P[f+"3"],P[x][4]=P[f+"4"],P[x][5]=P[f+"5"],P[x][6]=P[f+"6"],P[x][7]=P[f+"7"],P[x][8]=P[f+"8"],P[x][9]=P[f+"9"],P[x][10]=P[f+"10"],P[x][11]=P[f+"11"],P[x][12]=P[f+"12"],P[x][13]=P[f+"13"],P[x][14]=P[f+"0"],P[x][15]=P[f+"0"]}function Ut(f){return f==hp||f==mp||f==oh||f==pp}function Oi(){this.eb=[],this.size=this.A=this.fb=0}function xr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ys(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Oi,this.f.kb=new xr,this.sd=null}function ai(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function lr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _t(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function Ht(f,x){var k=f.T,F=x.ba.f.RGBA,W=F.eb,K=F.fb+f.ka*F.A,J=Ys[x.ba.S],Q=f.y,Z=f.O,ie=f.f,xe=f.N,Ee=f.ea,Ae=f.W,be=x.cc,Re=x.dc,Le=x.Mc,ve=x.Nc,we=f.ka,De=f.ka+f.T,ze=f.U,Ie=ze+1>>1;for(we==0?J(Q,Z,null,null,ie,xe,Ee,Ae,ie,xe,Ee,Ae,W,K,null,null,ze):(J(x.ec,x.fc,Q,Z,be,Re,Le,ve,ie,xe,Ee,Ae,W,K-F.A,W,K,ze),++k);we+2<De;we+=2)be=ie,Re=xe,Le=Ee,ve=Ae,xe+=f.Rc,Ae+=f.Rc,K+=2*F.A,J(Q,(Z+=2*f.fa)-f.fa,Q,Z,be,Re,Le,ve,ie,xe,Ee,Ae,W,K-F.A,W,K,ze);return Z+=f.fa,f.j+De<f.o?(n(x.ec,x.fc,Q,Z,ze),n(x.cc,x.dc,ie,xe,Ie),n(x.Mc,x.Nc,Ee,Ae,Ie),k--):1&De||J(Q,Z,null,null,ie,xe,Ee,Ae,ie,xe,Ee,Ae,W,K+F.A,null,null,ze),k}function ra(f,x,k){var F=f.F,W=[f.J];if(F!=null){var K=f.U,J=x.ba.S,Q=J==ah||J==oh;x=x.ba.f.RGBA;var Z=[0],ie=f.ka;Z[0]=f.T,f.Kb&&(ie==0?--Z[0]:(--ie,W[0]-=f.width),f.j+f.ka+f.T==f.o&&(Z[0]=f.o-f.j-ie));var xe=x.eb;ie=x.fb+ie*x.A,f=hr(F,W[0],f.width,K,Z,xe,ie+(Q?0:3),x.A),t(k==Z),f&&Ut(J)&&Vs(xe,ie,Q,K,Z,x.A)}return 0}function nn(f){var x=f.ma,k=x.ba.S,F=11>k,W=k==sh||k==ih||k==ah||k==fp||k==12||Ut(k);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!Du(x.Oa,f,W?11:12))return 0;if(W&&Ut(k)&&$e(),f.da)alert("todo:use_scaling");else{if(F){if(x.Ib=_t,f.Kb){if(k=f.U+1>>1,x.memory=i(f.U+2*k),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+f.U,x.Mc=x.cc,x.Nc=x.dc+k,x.Ib=Ht,$e()}}else alert("todo:EmitYUV");W&&(x.Jb=ra,F&&Ne())}if(F&&!B2){for(f=0;256>f;++f)RN[f]=89858*(f-128)+ch>>lh,UN[f]=-22014*(f-128)+ch,BN[f]=-45773*(f-128),MN[f]=113618*(f-128)+ch>>lh;for(f=$u;f<vp;++f)x=76283*(f-16)+ch>>lh,zN[f-$u]=_s(x,255),WN[f-$u]=_s(x+8>>4,15);B2=1}return 1}function zs(f){var x=f.ma,k=f.U,F=f.T;return t(!(1&f.ka)),0>=k||0>=F?0:(k=x.Ib(f,x),x.Jb!=null&&x.Jb(f,x,k),x.Dc+=k,1)}function Ws(f){f.ma.memory=null}function pt(f,x,k,F){return se(f,8)!=47?0:(x[0]=se(f,14)+1,k[0]=se(f,14)+1,F[0]=se(f,1),se(f,3)!=0?0:!f.h)}function ws(f,x){if(4>f)return f+1;var k=f-2>>1;return(2+(1&f)<<k)+se(x,k)+1}function rs(f,x){return 120<x?x-120:1<=(k=((k=NN[x-1])>>4)*f+(8-(15&k)))?k:1;var k}function Cn(f,x,k){var F=L(k),W=f[x+=255&F].g-8;return 0<W&&(O(k,k.u+8),F=L(k),x+=f[x].value,x+=F&(1<<W)-1),O(k,k.u+f[x].g),f[x].value}function Ir(f,x,k){return k.g+=f.g,k.value+=f.value<<x>>>0,t(8>=k.g),f.g}function Tr(f,x,k){var F=f.xc;return t((x=F==0?0:f.vc[f.md*(k>>F)+(x>>F)])<f.Wb),f.Ya[x]}function X(f,x,k,F){var W=f.ab,K=f.c*x,J=f.C;x=J+x;var Q=k,Z=F;for(F=f.Ta,k=f.Ua;0<W--;){var ie=f.gc[W],xe=J,Ee=x,Ae=Q,be=Z,Re=(Z=F,Q=k,ie.Ea);switch(t(xe<Ee),t(Ee<=ie.nc),ie.hc){case 2:Jf(Ae,be,(Ee-xe)*Re,Z,Q);break;case 0:var Le=xe,ve=Ee,we=Z,De=Q,ze=(nt=ie).Ea;Le==0&&(up(Ae,be,null,null,1,we,De),Et(Ae,be+1,0,0,ze-1,we,De+1),be+=ze,De+=ze,++Le);for(var Ie=1<<nt.b,lt=Ie-1,et=rt(ze,nt.b),gt=nt.K,nt=nt.w+(Le>>nt.b)*et;Le<ve;){var Vt=gt,Xt=nt,zt=1;for(Mu(Ae,be,we,De-ze,1,we,De);zt<ze;){var It=(zt&~lt)+Ie;It>ze&&(It=ze),(0,Ia[Vt[Xt++]>>8&15])(Ae,be+ +zt,we,De+zt-ze,It-zt,we,De+zt),zt=It}be+=ze,De+=ze,++Le&lt||(nt+=et)}Ee!=ie.nc&&n(Z,Q-Re,Z,Q+(Ee-xe-1)*Re,Re);break;case 1:for(Re=Ae,ve=be,ze=(Ae=ie.Ea)-(De=Ae&~(we=(be=1<<ie.b)-1)),Le=rt(Ae,ie.b),Ie=ie.K,ie=ie.w+(xe>>ie.b)*Le;xe<Ee;){for(lt=Ie,et=ie,gt=new Ze,nt=ve+De,Vt=ve+Ae;ve<nt;)Dt(lt[et++],gt),Go(gt,Re,ve,be,Z,Q),ve+=be,Q+=be;ve<Vt&&(Dt(lt[et++],gt),Go(gt,Re,ve,ze,Z,Q),ve+=ze,Q+=ze),++xe&we||(ie+=Le)}break;case 3:if(Ae==Z&&be==Q&&0<ie.b){for(ve=Z,Ae=Re=Q+(Ee-xe)*Re-(De=(Ee-xe)*rt(ie.Ea,ie.b)),be=Z,we=Q,Le=[],De=(ze=De)-1;0<=De;--De)Le[De]=be[we+De];for(De=ze-1;0<=De;--De)ve[Ae+De]=Le[De];Hs(ie,xe,Ee,Z,Re,Z,Q)}else Hs(ie,xe,Ee,Ae,be,Z,Q)}Q=F,Z=k}Z!=k&&n(F,k,Q,Z,K)}function oe(f,x){var k=f.V,F=f.Ba+f.c*f.C,W=x-f.C;if(t(x<=f.l.o),t(16>=W),0<W){var K=f.l,J=f.Ta,Q=f.Ua,Z=K.width;if(X(f,W,k,F),W=Q=[Q],t((k=f.C)<(F=x)),t(K.v<K.va),F>K.o&&(F=K.o),k<K.j){var ie=K.j-k;k=K.j,W[0]+=ie*Z}if(k>=F?k=0:(W[0]+=4*K.v,K.ka=k-K.j,K.U=K.va-K.v,K.T=F-k,k=1),k){if(Q=Q[0],11>(k=f.ca).S){var xe=k.f.RGBA,Ee=(F=k.S,W=K.U,K=K.T,ie=xe.eb,xe.A),Ae=K;for(xe=xe.fb+f.Ma*xe.A;0<Ae--;){var be=J,Re=Q,Le=W,ve=ie,we=xe;switch(F){case nh:is(be,Re,Le,ve,we);break;case sh:$n(be,Re,Le,ve,we);break;case hp:$n(be,Re,Le,ve,we),Vs(ve,we,0,Le,1,0);break;case C2:oa(be,Re,Le,ve,we);break;case ih:dr(be,Re,Le,ve,we,1);break;case mp:dr(be,Re,Le,ve,we,1),Vs(ve,we,0,Le,1,0);break;case ah:dr(be,Re,Le,ve,we,0);break;case oh:dr(be,Re,Le,ve,we,0),Vs(ve,we,1,Le,1,0);break;case fp:Ra(be,Re,Le,ve,we);break;case pp:Ra(be,Re,Le,ve,we),fr(ve,we,Le,1,0);break;case P2:aa(be,Re,Le,ve,we);break;default:t(0)}Q+=Z,xe+=Ee}f.Ma+=K}else alert("todo:EmitRescaledRowsYUVA");t(f.Ma<=k.height)}}f.C=x,t(f.C<=f.i)}function ee(f){var x;if(0<f.ua)return 0;for(x=0;x<f.Wb;++x){var k=f.Ya[x].G,F=f.Ya[x].H;if(0<k[1][F[1]+0].g||0<k[2][F[2]+0].g||0<k[3][F[3]+0].g)return 0}return 1}function te(f,x,k,F,W,K){if(f.Z!=0){var J=f.qd,Q=f.rd;for(t(za[f.Z]!=null);x<k;++x)za[f.Z](J,Q,F,W,F,W,K),J=F,Q=W,W+=K;f.qd=J,f.rd=Q}}function ae(f,x){var k=f.l.ma,F=k.Z==0||k.Z==1?f.l.j:f.C;if(F=f.C<F?F:f.C,t(x<=f.l.o),x>F){var W=f.l.width,K=k.ca,J=k.tb+W*F,Q=f.V,Z=f.Ba+f.c*F,ie=f.gc;t(f.ab==1),t(ie[0].hc==3),Qf(ie[0],F,x,Q,Z,K,J),te(k,F,x,K,J,W)}f.C=f.Ma=x}function ce(f,x,k,F,W,K,J){var Q=f.$/F,Z=f.$%F,ie=f.m,xe=f.s,Ee=k+f.$,Ae=Ee;W=k+F*W;var be=k+F*K,Re=280+xe.ua,Le=f.Pb?Q:16777216,ve=0<xe.ua?xe.Wa:null,we=xe.wc,De=Ee<be?Tr(xe,Z,Q):null;t(f.C<K),t(be<=W);var ze=!1;e:for(;;){for(;ze||Ee<be;){var Ie=0;if(Q>=Le){var lt=Ee-k;t((Le=f).Pb),Le.wd=Le.m,Le.xd=lt,0<Le.s.ua&&Se(Le.s.Wa,Le.s.vb),Le=Q+kN}if(Z&we||(De=Tr(xe,Z,Q)),t(De!=null),De.Qb&&(x[Ee]=De.qb,ze=!0),!ze)if(V(ie),De.jc){Ie=ie,lt=x;var et=Ee,gt=De.pd[L(Ie)&yn-1];t(De.jc),256>gt.g?(O(Ie,Ie.u+gt.g),lt[et]=gt.value,Ie=0):(O(Ie,Ie.u+gt.g-256),t(256<=gt.value),Ie=gt.value),Ie==0&&(ze=!0)}else Ie=Cn(De.G[0],De.H[0],ie);if(ie.h)break;if(ze||256>Ie){if(!ze)if(De.nd)x[Ee]=(De.qb|Ie<<8)>>>0;else{if(V(ie),ze=Cn(De.G[1],De.H[1],ie),V(ie),lt=Cn(De.G[2],De.H[2],ie),et=Cn(De.G[3],De.H[3],ie),ie.h)break;x[Ee]=(et<<24|ze<<16|Ie<<8|lt)>>>0}if(ze=!1,++Ee,++Z>=F&&(Z=0,++Q,J!=null&&Q<=K&&!(Q%16)&&J(f,Q),ve!=null))for(;Ae<Ee;)Ie=x[Ae++],ve.X[(506832829*Ie&4294967295)>>>ve.Mb]=Ie}else if(280>Ie){if(Ie=ws(Ie-256,ie),lt=Cn(De.G[4],De.H[4],ie),V(ie),lt=rs(F,lt=ws(lt,ie)),ie.h)break;if(Ee-k<lt||W-Ee<Ie)break e;for(et=0;et<Ie;++et)x[Ee+et]=x[Ee+et-lt];for(Ee+=Ie,Z+=Ie;Z>=F;)Z-=F,++Q,J!=null&&Q<=K&&!(Q%16)&&J(f,Q);if(t(Ee<=W),Z&we&&(De=Tr(xe,Z,Q)),ve!=null)for(;Ae<Ee;)Ie=x[Ae++],ve.X[(506832829*Ie&4294967295)>>>ve.Mb]=Ie}else{if(!(Ie<Re))break e;for(ze=Ie-280,t(ve!=null);Ae<Ee;)Ie=x[Ae++],ve.X[(506832829*Ie&4294967295)>>>ve.Mb]=Ie;Ie=Ee,t(!(ze>>>(lt=ve).Xa)),x[Ie]=lt.X[ze],ze=!0}ze||t(ie.h==R(ie))}if(f.Pb&&ie.h&&Ee<W)t(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&Se(f.s.vb,f.s.Wa);else{if(ie.h)break e;J!=null&&J(f,Q>K?K:Q),f.a=0,f.$=Ee-k}return 1}return f.a=3,0}function je(f){t(f!=null),f.vc=null,f.yc=null,f.Ya=null;var x=f.Wa;x!=null&&(x.X=null),f.vb=null,t(f!=null)}function Pe(){var f=new cp;return f==null?null:(f.a=0,f.xb=O2,Us("Predictor","VP8LPredictors"),Us("Predictor","VP8LPredictors_C"),Us("PredictorAdd","VP8LPredictorsAdd"),Us("PredictorAdd","VP8LPredictorsAdd_C"),Jf=Ft,Go=xt,is=st,$n=rn,Ra=Mt,aa=ts,oa=Yt,P.VP8LMapColor32b=ec,P.VP8LMapColor8b=Zf,f)}function ke(f,x,k,F,W){var K=1,J=[f],Q=[x],Z=F.m,ie=F.s,xe=null,Ee=0;e:for(;;){if(k)for(;K&&se(Z,1);){var Ae=J,be=Q,Re=F,Le=1,ve=Re.m,we=Re.gc[Re.ab],De=se(ve,2);if(Re.Oc&1<<De)K=0;else{switch(Re.Oc|=1<<De,we.hc=De,we.Ea=Ae[0],we.nc=be[0],we.K=[null],++Re.ab,t(4>=Re.ab),De){case 0:case 1:we.b=se(ve,3)+2,Le=ke(rt(we.Ea,we.b),rt(we.nc,we.b),0,Re,we.K),we.K=we.K[0];break;case 3:var ze,Ie=se(ve,8)+1,lt=16<Ie?0:4<Ie?1:2<Ie?2:3;if(Ae[0]=rt(we.Ea,lt),we.b=lt,ze=Le=ke(Ie,1,0,Re,we.K)){var et,gt=Ie,nt=we,Vt=1<<(8>>nt.b),Xt=i(Vt);if(Xt==null)ze=0;else{var zt=nt.K[0],It=nt.w;for(Xt[0]=nt.K[0][0],et=1;et<1*gt;++et)Xt[et]=He(zt[It+et],Xt[et-1]);for(;et<4*Vt;++et)Xt[et]=0;nt.K[0]=null,nt.K[0]=Xt,ze=1}}Le=ze;break;case 2:break;default:t(0)}K=Le}}if(J=J[0],Q=Q[0],K&&se(Z,1)&&!(K=1<=(Ee=se(Z,4))&&11>=Ee)){F.a=3;break e}var cr;if(cr=K)t:{var ar,At,Gr,as=F,Yr=J,os=Q,Jt=Ee,Ss=k,ks=as.m,dn=as.s,wn=[null],Vn=1,Ks=0,Ui=SN[Jt];r:for(;;){if(Ss&&se(ks,1)){var fn=se(ks,3)+2,da=rt(Yr,fn),Qo=rt(os,fn),ic=da*Qo;if(!ke(da,Qo,0,as,wn))break r;for(wn=wn[0],dn.xc=fn,ar=0;ar<ic;++ar){var Wa=wn[ar]>>8&65535;wn[ar]=Wa,Wa>=Vn&&(Vn=Wa+1)}}if(ks.h)break r;for(At=0;5>At;++At){var Pr=L2[At];!At&&0<Jt&&(Pr+=1<<Jt),Ks<Pr&&(Ks=Pr)}var yp=a(Vn*Ui,T),W2=Vn,H2=a(W2,U);if(H2==null)var dh=null;else t(65536>=W2),dh=H2;var qu=i(Ks);if(dh==null||qu==null||yp==null){as.a=1;break r}var fh=yp;for(ar=Gr=0;ar<Vn;++ar){var hi=dh[ar],ac=hi.G,oc=hi.H,$2=0,hh=1,q2=0;for(At=0;5>At;++At){Pr=L2[At],ac[At]=fh,oc[At]=Gr,!At&&0<Jt&&(Pr+=1<<Jt);s:{var mh,wp=Pr,ph=as,Vu=qu,qN=fh,VN=Gr,bp=0,Ha=ph.m,GN=se(Ha,1);if(s(Vu,0,0,wp),GN){var YN=se(Ha,1)+1,KN=se(Ha,1),V2=se(Ha,KN==0?1:8);Vu[V2]=1,YN==2&&(Vu[V2=se(Ha,8)]=1);var gh=1}else{var G2=i(19),Y2=se(Ha,4)+4;if(19<Y2){ph.a=3;var xh=0;break s}for(mh=0;mh<Y2;++mh)G2[_N[mh]]=se(Ha,3);var _p=void 0,Gu=void 0,K2=ph,XN=G2,vh=wp,X2=Vu,Np=0,$a=K2.m,J2=8,Q2=a(128,T);n:for(;j(Q2,0,7,XN,19);){if(se($a,1)){var JN=2+2*se($a,3);if((_p=2+se($a,JN))>vh)break n}else _p=vh;for(Gu=0;Gu<vh&&_p--;){V($a);var Z2=Q2[0+(127&L($a))];O($a,$a.u+Z2.g);var lc=Z2.value;if(16>lc)X2[Gu++]=lc,lc!=0&&(J2=lc);else{var QN=lc==16,ev=lc-16,ZN=wN[ev],tv=se($a,yN[ev])+ZN;if(Gu+tv>vh)break n;for(var eS=QN?J2:0;0<tv--;)X2[Gu++]=eS}}Np=1;break n}Np||(K2.a=3),gh=Np}(gh=gh&&!Ha.h)&&(bp=j(qN,VN,8,Vu,wp)),gh&&bp!=0?xh=bp:(ph.a=3,xh=0)}if(xh==0)break r;if(hh&&bN[At]==1&&(hh=fh[Gr].g==0),$2+=fh[Gr].g,Gr+=xh,3>=At){var Yu,Sp=qu[0];for(Yu=1;Yu<Pr;++Yu)qu[Yu]>Sp&&(Sp=qu[Yu]);q2+=Sp}}if(hi.nd=hh,hi.Qb=0,hh&&(hi.qb=(ac[3][oc[3]+0].value<<24|ac[1][oc[1]+0].value<<16|ac[2][oc[2]+0].value)>>>0,$2==0&&256>ac[0][oc[0]+0].value&&(hi.Qb=1,hi.qb+=ac[0][oc[0]+0].value<<8)),hi.jc=!hi.Qb&&6>q2,hi.jc){var yh,fa=hi;for(yh=0;yh<yn;++yh){var qa=yh,Va=fa.pd[qa],wh=fa.G[0][fa.H[0]+qa];256<=wh.value?(Va.g=wh.g+256,Va.value=wh.value):(Va.g=0,Va.value=0,qa>>=Ir(wh,8,Va),qa>>=Ir(fa.G[1][fa.H[1]+qa],16,Va),qa>>=Ir(fa.G[2][fa.H[2]+qa],0,Va),Ir(fa.G[3][fa.H[3]+qa],24,Va))}}}dn.vc=wn,dn.Wb=Vn,dn.Ya=dh,dn.yc=yp,cr=1;break t}cr=0}if(!(K=cr)){F.a=3;break e}if(0<Ee){if(ie.ua=1<<Ee,!Ve(ie.Wa,Ee)){F.a=1,K=0;break e}}else ie.ua=0;var kp=F,rv=J,tS=Q,jp=kp.s,Ep=jp.xc;if(kp.c=rv,kp.i=tS,jp.md=rt(rv,Ep),jp.wc=Ep==0?-1:(1<<Ep)-1,k){F.xb=LN;break e}if((xe=i(J*Q))==null){F.a=1,K=0;break e}K=(K=ce(F,xe,0,J,Q,Q,null))&&!Z.h;break e}return K?(W!=null?W[0]=xe:(t(xe==null),t(k)),F.$=0,k||je(ie)):je(ie),K}function Te(f,x){var k=f.c*f.i,F=k+x+16*x;return t(f.c<=x),f.V=i(F),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+k+x,1)}function Ce(f,x){var k=f.C,F=x-k,W=f.V,K=f.Ba+f.c*k;for(t(x<=f.l.o);0<F;){var J=16<F?16:F,Q=f.l.ma,Z=f.l.width,ie=Z*J,xe=Q.ca,Ee=Q.tb+Z*k,Ae=f.Ta,be=f.Ua;X(f,J,W,K),Br(Ae,be,xe,Ee,ie),te(Q,k,k+J,xe,Ee,Z),F-=J,W+=J*f.c,k+=J}t(k==x),f.C=f.Ma=x}function qe(){this.ub=this.yd=this.td=this.Rb=0}function Xe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function at(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Ye(){this.Yb=function(){var f=[];return function x(k,F,W){for(var K=W[F],J=0;J<K&&(k.push(W.length>F+1?[]:0),!(W.length<F+1));J++)x(k[J],F+1,W)}(f,0,[3,11]),f}()}function it(){this.jb=i(3),this.Wc=l([4,8],Ye),this.Xc=l([4,17],Ye)}function wt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Kt(){this.ld=this.La=this.dd=this.tc=0}function ir(){this.Na=this.la=0}function qr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function oi(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function na(){this.uc=this.M=this.Nb=0,this.wa=Array(new Kt),this.Y=0,this.ya=Array(new oi),this.aa=0,this.l=new Ii}function Di(){this.y=i(16),this.f=i(8),this.ea=i(8)}function li(){this.cb=this.a=0,this.sc="",this.m=new me,this.Od=new qe,this.Kc=new Xe,this.ed=new wt,this.Qa=new at,this.Ic=this.$c=this.Aa=0,this.D=new na,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,me),this.ia=0,this.pb=a(4,qr),this.Pa=new it,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Di),this.Hd=0,this.rb=Array(new ir),this.sb=0,this.wa=Array(new Kt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new oi),this.L=this.aa=0,this.gd=l([4,2],Kt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ii(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function bs(){var f=new li;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,Hu||(Hu=If)),f}function Rr(f,x,k){return f.a==0&&(f.a=x,f.sc=k,f.cb=0),0}function Of(f,x,k){return 3<=k&&f[x+0]==157&&f[x+1]==1&&f[x+2]==42}function Df(f,x){if(f==null)return 0;if(f.a=0,f.sc="OK",x==null)return Rr(f,2,"null VP8Io passed to VP8GetHeaders()");var k=x.data,F=x.w,W=x.ha;if(4>W)return Rr(f,7,"Truncated header.");var K=k[F+0]|k[F+1]<<8|k[F+2]<<16,J=f.Od;if(J.Rb=!(1&K),J.td=K>>1&7,J.yd=K>>4&1,J.ub=K>>5,3<J.td)return Rr(f,3,"Incorrect keyframe parameters.");if(!J.yd)return Rr(f,4,"Frame not displayable.");F+=3,W-=3;var Q=f.Kc;if(J.Rb){if(7>W)return Rr(f,7,"cannot parse picture header");if(!Of(k,F,W))return Rr(f,3,"Bad code word");Q.c=16383&(k[F+4]<<8|k[F+3]),Q.Td=k[F+4]>>6,Q.i=16383&(k[F+6]<<8|k[F+5]),Q.Ud=k[F+6]>>6,F+=7,W-=7,f.za=Q.c+15>>4,f.Ub=Q.i+15>>4,x.width=Q.c,x.height=Q.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,s((K=f.Pa).jb,0,255,K.jb.length),t((K=f.Qa)!=null),K.Cb=0,K.Bb=0,K.Fb=1,s(K.Zb,0,0,K.Zb.length),s(K.Lb,0,0,K.Lb)}if(J.ub>W)return Rr(f,7,"bad partition length");re(K=f.m,k,F,J.ub),F+=J.ub,W-=J.ub,J.Rb&&(Q.Ld=ue(K),Q.Kd=ue(K)),Q=f.Qa;var Z,ie=f.Pa;if(t(K!=null),t(Q!=null),Q.Cb=ue(K),Q.Cb){if(Q.Bb=ue(K),ue(K)){for(Q.Fb=ue(K),Z=0;4>Z;++Z)Q.Zb[Z]=ue(K)?G(K,7):0;for(Z=0;4>Z;++Z)Q.Lb[Z]=ue(K)?G(K,6):0}if(Q.Bb)for(Z=0;3>Z;++Z)ie.jb[Z]=ue(K)?z(K,8):255}else Q.Bb=0;if(K.Ka)return Rr(f,3,"cannot parse segment header");if((Q=f.ed).zd=ue(K),Q.Tb=z(K,6),Q.wb=z(K,3),Q.Pc=ue(K),Q.Pc&&ue(K)){for(ie=0;4>ie;++ie)ue(K)&&(Q.vd[ie]=G(K,6));for(ie=0;4>ie;++ie)ue(K)&&(Q.od[ie]=G(K,6))}if(f.L=Q.Tb==0?0:Q.zd?1:2,K.Ka)return Rr(f,3,"cannot parse filter header");var xe=W;if(W=Z=F,F=Z+xe,Q=xe,f.Xb=(1<<z(f.m,2))-1,xe<3*(ie=f.Xb))k=7;else{for(Z+=3*ie,Q-=3*ie,xe=0;xe<ie;++xe){var Ee=k[W+0]|k[W+1]<<8|k[W+2]<<16;Ee>Q&&(Ee=Q),re(f.Jc[+xe],k,Z,Ee),Z+=Ee,Q-=Ee,W+=3}re(f.Jc[+ie],k,Z,Q),k=Z<F?0:5}if(k!=0)return Rr(f,k,"cannot parse partitions");for(k=z(Z=f.m,7),W=ue(Z)?G(Z,4):0,F=ue(Z)?G(Z,4):0,Q=ue(Z)?G(Z,4):0,ie=ue(Z)?G(Z,4):0,Z=ue(Z)?G(Z,4):0,xe=f.Qa,Ee=0;4>Ee;++Ee){if(xe.Cb){var Ae=xe.Zb[Ee];xe.Fb||(Ae+=k)}else{if(0<Ee){f.pb[Ee]=f.pb[0];continue}Ae=k}var be=f.pb[Ee];be.Sc[0]=gp[_s(Ae+W,127)],be.Sc[1]=xp[_s(Ae+0,127)],be.Eb[0]=2*gp[_s(Ae+F,127)],be.Eb[1]=101581*xp[_s(Ae+Q,127)]>>16,8>be.Eb[1]&&(be.Eb[1]=8),be.Qc[0]=gp[_s(Ae+ie,117)],be.Qc[1]=xp[_s(Ae+Z,127)],be.lc=Ae+Z}if(!J.Rb)return Rr(f,4,"Not a key frame.");for(ue(K),J=f.Pa,k=0;4>k;++k){for(W=0;8>W;++W)for(F=0;3>F;++F)for(Q=0;11>Q;++Q)ie=fe(K,CN[k][W][F][Q])?z(K,8):AN[k][W][F][Q],J.Wc[k][W].Yb[F][Q]=ie;for(W=0;17>W;++W)J.Xc[k][W]=J.Wc[k][PN[W]]}return f.kc=ue(K),f.kc&&(f.Bd=z(K,8)),f.cb=1}function If(f,x,k,F,W,K,J){var Q=x[W].Yb[k];for(k=0;16>W;++W){if(!fe(f,Q[k+0]))return W;for(;!fe(f,Q[k+1]);)if(Q=x[++W].Yb[0],k=0,W==16)return 16;var Z=x[W+1].Yb;if(fe(f,Q[k+2])){var ie=f,xe=0;if(fe(ie,(Ae=Q)[(Ee=k)+3]))if(fe(ie,Ae[Ee+6])){for(Q=0,Ee=2*(xe=fe(ie,Ae[Ee+8]))+(Ae=fe(ie,Ae[Ee+9+xe])),xe=0,Ae=jN[Ee];Ae[Q];++Q)xe+=xe+fe(ie,Ae[Q]);xe+=3+(8<<Ee)}else fe(ie,Ae[Ee+7])?(xe=7+2*fe(ie,165),xe+=fe(ie,145)):xe=5+fe(ie,159);else xe=fe(ie,Ae[Ee+4])?3+fe(ie,Ae[Ee+5]):2;Q=Z[2]}else xe=1,Q=Z[1];Z=J+EN[W],0>(ie=f).b&&ne(ie);var Ee,Ae=ie.b,be=(Ee=ie.Ca>>1)-(ie.I>>Ae)>>31;--ie.b,ie.Ca+=be,ie.Ca|=1,ie.I-=(Ee+1&be)<<Ae,K[Z]=((xe^be)-be)*F[(0<W)+0]}return 16}function wu(f){var x=f.rb[f.sb-1];x.la=0,x.Na=0,s(f.zc,0,0,f.zc.length),f.ja=0}function Vm(f,x){if(f==null)return 0;if(x==null)return Rr(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!Df(f,x))return 0;if(t(f.cb),x.ac==null||x.ac(x)){x.ob&&(f.L=0);var k=uh[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=x.v-k>>4,f.zb=x.j-k>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=x.o+15+k>>4,f.Hb=x.va+15+k>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var F=f.ed;for(k=0;4>k;++k){var W;if(f.Qa.Cb){var K=f.Qa.Lb[k];f.Qa.Fb||(K+=F.Tb)}else K=F.Tb;for(W=0;1>=W;++W){var J=f.gd[k][W],Q=K;if(F.Pc&&(Q+=F.vd[0],W&&(Q+=F.od[0])),0<(Q=0>Q?0:63<Q?63:Q)){var Z=Q;0<F.wb&&(Z=4<F.wb?Z>>2:Z>>1)>9-F.wb&&(Z=9-F.wb),1>Z&&(Z=1),J.dd=Z,J.tc=2*Q+Z,J.ld=40<=Q?2:15<=Q?1:0}else J.tc=0;J.La=W}}}k=0}else Rr(f,6,"Frame setup failed"),k=f.a;if(k=k==0){if(k){f.$c=0,0<f.Aa||(f.Ic=$N);e:{k=f.Ic,F=4*(Z=f.za);var ie=32*Z,xe=Z+1,Ee=0<f.L?Z*(0<f.Aa?2:1):0,Ae=(f.Aa==2?2:1)*Z;if((J=F+832+(W=3*(16*k+uh[f.L])/2*ie)+(K=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=J)k=0;else{if(J>f.Vb){if(f.Vb=0,f.Ec=i(J),f.Fc=0,f.Ec==null){k=Rr(f,1,"no memory during frame initialization.");break e}f.Vb=J}J=f.Ec,Q=f.Fc,f.Ac=J,f.Bc=Q,Q+=F,f.Gd=a(ie,Di),f.Hd=0,f.rb=a(xe+1,ir),f.sb=1,f.wa=Ee?a(Ee,Kt):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=Z),t(!0),f.oc=J,f.pc=Q,Q+=832,f.ya=a(Ae,oi),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=Z),f.R=16*Z,f.B=8*Z,Z=(ie=uh[f.L])*f.R,ie=ie/2*f.B,f.sa=J,f.ta=Q+Z,f.qa=f.sa,f.ra=f.ta+16*k*f.R+ie,f.Ha=f.qa,f.Ia=f.ra+8*k*f.B+ie,f.$c=0,Q+=W,f.mb=K?J:null,f.nb=K?Q:null,t(Q+K<=f.Fc+f.Vb),wu(f),s(f.Ac,f.Bc,0,F),k=1}}if(k){if(x.ka=0,x.y=f.sa,x.O=f.ta,x.f=f.qa,x.N=f.ra,x.ea=f.Ha,x.Vd=f.Ia,x.fa=f.R,x.Rc=f.B,x.F=null,x.J=0,!th){for(k=-255;255>=k;++k)sn[255+k]=0>k?-k:k;for(k=-1020;1020>=k;++k)ca[1020+k]=-128>k?-128:127<k?127:k;for(k=-112;112>=k;++k)Wu[112+k]=-16>k?-16:15<k?15:k;for(k=-255;510>=k;++k)sc[255+k]=0>k?0:255<k?255:k;th=1}tc=Km,la=Gm,Bu=Mf,qn=Ym,$s=Bf,Mr=Rf,rc=ju,eh=qo,Uu=lp,Yo=Eu,Ko=op,Ma=Vl,Xo=Au,nc=Yf,Jo=Gf,Ba=Mi,zu=ia,qs=ap,fi[0]=Ri,fi[1]=Xm,fi[2]=ep,fi[3]=tp,fi[4]=Wf,fi[5]=$l,fi[6]=Hf,fi[7]=Nu,fi[8]=np,fi[9]=rp,Ua[0]=Uf,Ua[1]=Qm,Ua[2]=sa,Ua[3]=Wl,Ua[4]=Pn,Ua[5]=Zm,Ua[6]=zf,ua[0]=Fa,ua[1]=Jm,ua[2]=sp,ua[3]=Su,ua[4]=$o,ua[5]=ip,ua[6]=ku,k=1}else k=0}k&&(k=function(be,Re){for(be.M=0;be.M<be.Va;++be.M){var Le,ve=be.Jc[be.M&be.Xb],we=be.m,De=be;for(Le=0;Le<De.za;++Le){var ze=we,Ie=De,lt=Ie.Ac,et=Ie.Bc+4*Le,gt=Ie.zc,nt=Ie.ya[Ie.aa+Le];if(Ie.Qa.Bb?nt.$b=fe(ze,Ie.Pa.jb[0])?2+fe(ze,Ie.Pa.jb[2]):fe(ze,Ie.Pa.jb[1]):nt.$b=0,Ie.kc&&(nt.Ad=fe(ze,Ie.Bd)),nt.Za=!fe(ze,145)+0,nt.Za){var Vt=nt.Ob,Xt=0;for(Ie=0;4>Ie;++Ie){var zt,It=gt[0+Ie];for(zt=0;4>zt;++zt){It=TN[lt[et+zt]][It];for(var cr=F2[fe(ze,It[0])];0<cr;)cr=F2[2*cr+fe(ze,It[cr])];It=-cr,lt[et+zt]=It}n(Vt,Xt,lt,et,4),Xt+=4,gt[0+Ie]=It}}else It=fe(ze,156)?fe(ze,128)?1:3:fe(ze,163)?2:0,nt.Ob[0]=It,s(lt,et,It,4),s(gt,0,It,4);nt.Dd=fe(ze,142)?fe(ze,114)?fe(ze,183)?1:3:2:0}if(De.m.Ka)return Rr(be,7,"Premature end-of-partition0 encountered.");for(;be.ja<be.za;++be.ja){if(De=ve,ze=(we=be).rb[we.sb-1],lt=we.rb[we.sb+we.ja],Le=we.ya[we.aa+we.ja],et=we.kc?Le.Ad:0)ze.la=lt.la=0,Le.Za||(ze.Na=lt.Na=0),Le.Hc=0,Le.Gc=0,Le.ia=0;else{var ar,At;if(ze=lt,lt=De,et=we.Pa.Xc,gt=we.ya[we.aa+we.ja],nt=we.pb[gt.$b],Ie=gt.ad,Vt=0,Xt=we.rb[we.sb-1],It=zt=0,s(Ie,Vt,0,384),gt.Za)var Gr=0,as=et[3];else{cr=i(16);var Yr=ze.Na+Xt.Na;if(Yr=Hu(lt,et[1],Yr,nt.Eb,0,cr,0),ze.Na=Xt.Na=(0<Yr)+0,1<Yr)tc(cr,0,Ie,Vt);else{var os=cr[0]+3>>3;for(cr=0;256>cr;cr+=16)Ie[Vt+cr]=os}Gr=1,as=et[0]}var Jt=15&ze.la,Ss=15&Xt.la;for(cr=0;4>cr;++cr){var ks=1&Ss;for(os=At=0;4>os;++os)Jt=Jt>>1|(ks=(Yr=Hu(lt,as,Yr=ks+(1&Jt),nt.Sc,Gr,Ie,Vt))>Gr)<<7,At=At<<2|(3<Yr?3:1<Yr?2:Ie[Vt+0]!=0),Vt+=16;Jt>>=4,Ss=Ss>>1|ks<<7,zt=(zt<<8|At)>>>0}for(as=Jt,Gr=Ss>>4,ar=0;4>ar;ar+=2){for(At=0,Jt=ze.la>>4+ar,Ss=Xt.la>>4+ar,cr=0;2>cr;++cr){for(ks=1&Ss,os=0;2>os;++os)Yr=ks+(1&Jt),Jt=Jt>>1|(ks=0<(Yr=Hu(lt,et[2],Yr,nt.Qc,0,Ie,Vt)))<<3,At=At<<2|(3<Yr?3:1<Yr?2:Ie[Vt+0]!=0),Vt+=16;Jt>>=2,Ss=Ss>>1|ks<<5}It|=At<<4*ar,as|=Jt<<4<<ar,Gr|=(240&Ss)<<ar}ze.la=as,Xt.la=Gr,gt.Hc=zt,gt.Gc=It,gt.ia=43690&It?0:nt.ia,et=!(zt|It)}if(0<we.L&&(we.wa[we.Y+we.ja]=we.gd[Le.$b][Le.Za],we.wa[we.Y+we.ja].La|=!et),De.Ka)return Rr(be,7,"Premature end-of-file encountered.")}if(wu(be),we=Re,De=1,Le=(ve=be).D,ze=0<ve.L&&ve.M>=ve.zb&&ve.M<=ve.Va,ve.Aa==0)e:{if(Le.M=ve.M,Le.uc=ze,Ou(ve,Le),De=1,Le=(At=ve.D).Nb,ze=(It=uh[ve.L])*ve.R,lt=It/2*ve.B,cr=16*Le*ve.R,os=8*Le*ve.B,et=ve.sa,gt=ve.ta-ze+cr,nt=ve.qa,Ie=ve.ra-lt+os,Vt=ve.Ha,Xt=ve.Ia-lt+os,Ss=(Jt=At.M)==0,zt=Jt>=ve.Va-1,ve.Aa==2&&Ou(ve,At),At.uc)for(ks=(Yr=ve).D.M,t(Yr.D.uc),At=Yr.yb;At<Yr.Hb;++At){Gr=At,as=ks;var dn=(wn=(Pr=Yr).D).Nb;ar=Pr.R;var wn=wn.wa[wn.Y+Gr],Vn=Pr.sa,Ks=Pr.ta+16*dn*ar+16*Gr,Ui=wn.dd,fn=wn.tc;if(fn!=0)if(t(3<=fn),Pr.L==1)0<Gr&&Ba(Vn,Ks,ar,fn+4),wn.La&&qs(Vn,Ks,ar,fn),0<as&&Jo(Vn,Ks,ar,fn+4),wn.La&&zu(Vn,Ks,ar,fn);else{var da=Pr.B,Qo=Pr.qa,ic=Pr.ra+8*dn*da+8*Gr,Wa=Pr.Ha,Pr=Pr.Ia+8*dn*da+8*Gr;dn=wn.ld,0<Gr&&(eh(Vn,Ks,ar,fn+4,Ui,dn),Yo(Qo,ic,Wa,Pr,da,fn+4,Ui,dn)),wn.La&&(Ma(Vn,Ks,ar,fn,Ui,dn),nc(Qo,ic,Wa,Pr,da,fn,Ui,dn)),0<as&&(rc(Vn,Ks,ar,fn+4,Ui,dn),Uu(Qo,ic,Wa,Pr,da,fn+4,Ui,dn)),wn.La&&(Ko(Vn,Ks,ar,fn,Ui,dn),Xo(Qo,ic,Wa,Pr,da,fn,Ui,dn))}}if(ve.ia&&alert("todo:DitherRow"),we.put!=null){if(At=16*Jt,Jt=16*(Jt+1),Ss?(we.y=ve.sa,we.O=ve.ta+cr,we.f=ve.qa,we.N=ve.ra+os,we.ea=ve.Ha,we.W=ve.Ia+os):(At-=It,we.y=et,we.O=gt,we.f=nt,we.N=Ie,we.ea=Vt,we.W=Xt),zt||(Jt-=It),Jt>we.o&&(Jt=we.o),we.F=null,we.J=null,ve.Fa!=null&&0<ve.Fa.length&&At<Jt&&(we.J=Lu(ve,we,At,Jt-At),we.F=ve.mb,we.F==null&&we.F.length==0)){De=Rr(ve,3,"Could not decode alpha data.");break e}At<we.j&&(It=we.j-At,At=we.j,t(!(1&It)),we.O+=ve.R*It,we.N+=ve.B*(It>>1),we.W+=ve.B*(It>>1),we.F!=null&&(we.J+=we.width*It)),At<Jt&&(we.O+=we.v,we.N+=we.v>>1,we.W+=we.v>>1,we.F!=null&&(we.J+=we.v),we.ka=At-we.j,we.U=we.va-we.v,we.T=Jt-At,De=we.put(we))}Le+1!=ve.Ic||zt||(n(ve.sa,ve.ta-ze,et,gt+16*ve.R,ze),n(ve.qa,ve.ra-lt,nt,Ie+8*ve.B,lt),n(ve.Ha,ve.Ia-lt,Vt,Xt+8*ve.B,lt))}if(!De)return Rr(be,6,"Output aborted.")}return 1}(f,x)),x.bc!=null&&x.bc(x),k&=1}return k?(f.cb=0,k):0}function ci(f,x,k,F,W){W=f[x+k+32*F]+(W>>3),f[x+k+32*F]=-256&W?0>W?0:255:W}function zl(f,x,k,F,W,K){ci(f,x,0,k,F+W),ci(f,x,1,k,F+K),ci(f,x,2,k,F-K),ci(f,x,3,k,F-W)}function ns(f){return(20091*f>>16)+f}function bu(f,x,k,F){var W,K=0,J=i(16);for(W=0;4>W;++W){var Q=f[x+0]+f[x+8],Z=f[x+0]-f[x+8],ie=(35468*f[x+4]>>16)-ns(f[x+12]),xe=ns(f[x+4])+(35468*f[x+12]>>16);J[K+0]=Q+xe,J[K+1]=Z+ie,J[K+2]=Z-ie,J[K+3]=Q-xe,K+=4,x++}for(W=K=0;4>W;++W)Q=(f=J[K+0]+4)+J[K+8],Z=f-J[K+8],ie=(35468*J[K+4]>>16)-ns(J[K+12]),ci(k,F,0,0,Q+(xe=ns(J[K+4])+(35468*J[K+12]>>16))),ci(k,F,1,0,Z+ie),ci(k,F,2,0,Z-ie),ci(k,F,3,0,Q-xe),K++,F+=32}function Rf(f,x,k,F){var W=f[x+0]+4,K=35468*f[x+4]>>16,J=ns(f[x+4]),Q=35468*f[x+1]>>16;zl(k,F,0,W+J,f=ns(f[x+1]),Q),zl(k,F,1,W+K,f,Q),zl(k,F,2,W-K,f,Q),zl(k,F,3,W-J,f,Q)}function Gm(f,x,k,F,W){bu(f,x,k,F),W&&bu(f,x+16,k,F+4)}function Mf(f,x,k,F){la(f,x+0,k,F,1),la(f,x+32,k,F+128,1)}function Ym(f,x,k,F){var W;for(f=f[x+0]+4,W=0;4>W;++W)for(x=0;4>x;++x)ci(k,F,x,W,f)}function Bf(f,x,k,F){f[x+0]&&qn(f,x+0,k,F),f[x+16]&&qn(f,x+16,k,F+4),f[x+32]&&qn(f,x+32,k,F+128),f[x+48]&&qn(f,x+48,k,F+128+4)}function Km(f,x,k,F){var W,K=i(16);for(W=0;4>W;++W){var J=f[x+0+W]+f[x+12+W],Q=f[x+4+W]+f[x+8+W],Z=f[x+4+W]-f[x+8+W],ie=f[x+0+W]-f[x+12+W];K[0+W]=J+Q,K[8+W]=J-Q,K[4+W]=ie+Z,K[12+W]=ie-Z}for(W=0;4>W;++W)J=(f=K[0+4*W]+3)+K[3+4*W],Q=K[1+4*W]+K[2+4*W],Z=K[1+4*W]-K[2+4*W],ie=f-K[3+4*W],k[F+0]=J+Q>>3,k[F+16]=ie+Z>>3,k[F+32]=J-Q>>3,k[F+48]=ie-Z>>3,F+=64}function _u(f,x,k){var F,W=x-32,K=Ns,J=255-f[W-1];for(F=0;F<k;++F){var Q,Z=K,ie=J+f[x-1];for(Q=0;Q<k;++Q)f[x+Q]=Z[ie+f[W+Q]];x+=32}}function Xm(f,x){_u(f,x,4)}function Jm(f,x){_u(f,x,8)}function Qm(f,x){_u(f,x,16)}function sa(f,x){var k;for(k=0;16>k;++k)n(f,x+32*k,f,x-32,16)}function Wl(f,x){var k;for(k=16;0<k;--k)s(f,x,f[x-1],16),x+=32}function Hl(f,x,k){var F;for(F=0;16>F;++F)s(x,k+32*F,f,16)}function Uf(f,x){var k,F=16;for(k=0;16>k;++k)F+=f[x-1+32*k]+f[x+k-32];Hl(F>>5,f,x)}function Pn(f,x){var k,F=8;for(k=0;16>k;++k)F+=f[x-1+32*k];Hl(F>>4,f,x)}function Zm(f,x){var k,F=8;for(k=0;16>k;++k)F+=f[x+k-32];Hl(F>>4,f,x)}function zf(f,x){Hl(128,f,x)}function Nt(f,x,k){return f+2*x+k+2>>2}function ep(f,x){var k,F=x-32;for(F=new Uint8Array([Nt(f[F-1],f[F+0],f[F+1]),Nt(f[F+0],f[F+1],f[F+2]),Nt(f[F+1],f[F+2],f[F+3]),Nt(f[F+2],f[F+3],f[F+4])]),k=0;4>k;++k)n(f,x+32*k,F,0,F.length)}function tp(f,x){var k=f[x-1],F=f[x-1+32],W=f[x-1+64],K=f[x-1+96];ye(f,x+0,16843009*Nt(f[x-1-32],k,F)),ye(f,x+32,16843009*Nt(k,F,W)),ye(f,x+64,16843009*Nt(F,W,K)),ye(f,x+96,16843009*Nt(W,K,K))}function Ri(f,x){var k,F=4;for(k=0;4>k;++k)F+=f[x+k-32]+f[x-1+32*k];for(F>>=3,k=0;4>k;++k)s(f,x+32*k,F,4)}function Wf(f,x){var k=f[x-1+0],F=f[x-1+32],W=f[x-1+64],K=f[x-1-32],J=f[x+0-32],Q=f[x+1-32],Z=f[x+2-32],ie=f[x+3-32];f[x+0+96]=Nt(F,W,f[x-1+96]),f[x+1+96]=f[x+0+64]=Nt(k,F,W),f[x+2+96]=f[x+1+64]=f[x+0+32]=Nt(K,k,F),f[x+3+96]=f[x+2+64]=f[x+1+32]=f[x+0+0]=Nt(J,K,k),f[x+3+64]=f[x+2+32]=f[x+1+0]=Nt(Q,J,K),f[x+3+32]=f[x+2+0]=Nt(Z,Q,J),f[x+3+0]=Nt(ie,Z,Q)}function Hf(f,x){var k=f[x+1-32],F=f[x+2-32],W=f[x+3-32],K=f[x+4-32],J=f[x+5-32],Q=f[x+6-32],Z=f[x+7-32];f[x+0+0]=Nt(f[x+0-32],k,F),f[x+1+0]=f[x+0+32]=Nt(k,F,W),f[x+2+0]=f[x+1+32]=f[x+0+64]=Nt(F,W,K),f[x+3+0]=f[x+2+32]=f[x+1+64]=f[x+0+96]=Nt(W,K,J),f[x+3+32]=f[x+2+64]=f[x+1+96]=Nt(K,J,Q),f[x+3+64]=f[x+2+96]=Nt(J,Q,Z),f[x+3+96]=Nt(Q,Z,Z)}function $l(f,x){var k=f[x-1+0],F=f[x-1+32],W=f[x-1+64],K=f[x-1-32],J=f[x+0-32],Q=f[x+1-32],Z=f[x+2-32],ie=f[x+3-32];f[x+0+0]=f[x+1+64]=K+J+1>>1,f[x+1+0]=f[x+2+64]=J+Q+1>>1,f[x+2+0]=f[x+3+64]=Q+Z+1>>1,f[x+3+0]=Z+ie+1>>1,f[x+0+96]=Nt(W,F,k),f[x+0+64]=Nt(F,k,K),f[x+0+32]=f[x+1+96]=Nt(k,K,J),f[x+1+32]=f[x+2+96]=Nt(K,J,Q),f[x+2+32]=f[x+3+96]=Nt(J,Q,Z),f[x+3+32]=Nt(Q,Z,ie)}function Nu(f,x){var k=f[x+0-32],F=f[x+1-32],W=f[x+2-32],K=f[x+3-32],J=f[x+4-32],Q=f[x+5-32],Z=f[x+6-32],ie=f[x+7-32];f[x+0+0]=k+F+1>>1,f[x+1+0]=f[x+0+64]=F+W+1>>1,f[x+2+0]=f[x+1+64]=W+K+1>>1,f[x+3+0]=f[x+2+64]=K+J+1>>1,f[x+0+32]=Nt(k,F,W),f[x+1+32]=f[x+0+96]=Nt(F,W,K),f[x+2+32]=f[x+1+96]=Nt(W,K,J),f[x+3+32]=f[x+2+96]=Nt(K,J,Q),f[x+3+64]=Nt(J,Q,Z),f[x+3+96]=Nt(Q,Z,ie)}function rp(f,x){var k=f[x-1+0],F=f[x-1+32],W=f[x-1+64],K=f[x-1+96];f[x+0+0]=k+F+1>>1,f[x+2+0]=f[x+0+32]=F+W+1>>1,f[x+2+32]=f[x+0+64]=W+K+1>>1,f[x+1+0]=Nt(k,F,W),f[x+3+0]=f[x+1+32]=Nt(F,W,K),f[x+3+32]=f[x+1+64]=Nt(W,K,K),f[x+3+64]=f[x+2+64]=f[x+0+96]=f[x+1+96]=f[x+2+96]=f[x+3+96]=K}function np(f,x){var k=f[x-1+0],F=f[x-1+32],W=f[x-1+64],K=f[x-1+96],J=f[x-1-32],Q=f[x+0-32],Z=f[x+1-32],ie=f[x+2-32];f[x+0+0]=f[x+2+32]=k+J+1>>1,f[x+0+32]=f[x+2+64]=F+k+1>>1,f[x+0+64]=f[x+2+96]=W+F+1>>1,f[x+0+96]=K+W+1>>1,f[x+3+0]=Nt(Q,Z,ie),f[x+2+0]=Nt(J,Q,Z),f[x+1+0]=f[x+3+32]=Nt(k,J,Q),f[x+1+32]=f[x+3+64]=Nt(F,k,J),f[x+1+64]=f[x+3+96]=Nt(W,F,k),f[x+1+96]=Nt(K,W,F)}function sp(f,x){var k;for(k=0;8>k;++k)n(f,x+32*k,f,x-32,8)}function Su(f,x){var k;for(k=0;8>k;++k)s(f,x,f[x-1],8),x+=32}function Ho(f,x,k){var F;for(F=0;8>F;++F)s(x,k+32*F,f,8)}function Fa(f,x){var k,F=8;for(k=0;8>k;++k)F+=f[x+k-32]+f[x-1+32*k];Ho(F>>4,f,x)}function ip(f,x){var k,F=4;for(k=0;8>k;++k)F+=f[x+k-32];Ho(F>>3,f,x)}function $o(f,x){var k,F=4;for(k=0;8>k;++k)F+=f[x-1+32*k];Ho(F>>3,f,x)}function ku(f,x){Ho(128,f,x)}function ql(f,x,k){var F=f[x-k],W=f[x+0],K=3*(W-F)+dp[1020+f[x-2*k]-f[x+k]],J=rh[112+(K+4>>3)];f[x-k]=Ns[255+F+rh[112+(K+3>>3)]],f[x+0]=Ns[255+W-J]}function $f(f,x,k,F){var W=f[x+0],K=f[x+k];return Gs[255+f[x-2*k]-f[x-k]]>F||Gs[255+K-W]>F}function qf(f,x,k,F){return 4*Gs[255+f[x-k]-f[x+0]]+Gs[255+f[x-2*k]-f[x+k]]<=F}function Vf(f,x,k,F,W){var K=f[x-3*k],J=f[x-2*k],Q=f[x-k],Z=f[x+0],ie=f[x+k],xe=f[x+2*k],Ee=f[x+3*k];return 4*Gs[255+Q-Z]+Gs[255+J-ie]>F?0:Gs[255+f[x-4*k]-K]<=W&&Gs[255+K-J]<=W&&Gs[255+J-Q]<=W&&Gs[255+Ee-xe]<=W&&Gs[255+xe-ie]<=W&&Gs[255+ie-Z]<=W}function Gf(f,x,k,F){var W=2*F+1;for(F=0;16>F;++F)qf(f,x+F,k,W)&&ql(f,x+F,k)}function Mi(f,x,k,F){var W=2*F+1;for(F=0;16>F;++F)qf(f,x+F*k,1,W)&&ql(f,x+F*k,1)}function ia(f,x,k,F){var W;for(W=3;0<W;--W)Gf(f,x+=4*k,k,F)}function ap(f,x,k,F){var W;for(W=3;0<W;--W)Mi(f,x+=4,k,F)}function Oa(f,x,k,F,W,K,J,Q){for(K=2*K+1;0<W--;){if(Vf(f,x,k,K,J))if($f(f,x,k,Q))ql(f,x,k);else{var Z=f,ie=x,xe=k,Ee=Z[ie-2*xe],Ae=Z[ie-xe],be=Z[ie+0],Re=Z[ie+xe],Le=Z[ie+2*xe],ve=27*(De=dp[1020+3*(be-Ae)+dp[1020+Ee-Re]])+63>>7,we=18*De+63>>7,De=9*De+63>>7;Z[ie-3*xe]=Ns[255+Z[ie-3*xe]+De],Z[ie-2*xe]=Ns[255+Ee+we],Z[ie-xe]=Ns[255+Ae+ve],Z[ie+0]=Ns[255+be-ve],Z[ie+xe]=Ns[255+Re-we],Z[ie+2*xe]=Ns[255+Le-De]}x+=F}}function ui(f,x,k,F,W,K,J,Q){for(K=2*K+1;0<W--;){if(Vf(f,x,k,K,J))if($f(f,x,k,Q))ql(f,x,k);else{var Z=f,ie=x,xe=k,Ee=Z[ie-xe],Ae=Z[ie+0],be=Z[ie+xe],Re=rh[112+((Le=3*(Ae-Ee))+4>>3)],Le=rh[112+(Le+3>>3)],ve=Re+1>>1;Z[ie-2*xe]=Ns[255+Z[ie-2*xe]+ve],Z[ie-xe]=Ns[255+Ee+Le],Z[ie+0]=Ns[255+Ae-Re],Z[ie+xe]=Ns[255+be-ve]}x+=F}}function ju(f,x,k,F,W,K){Oa(f,x,k,1,16,F,W,K)}function qo(f,x,k,F,W,K){Oa(f,x,1,k,16,F,W,K)}function op(f,x,k,F,W,K){var J;for(J=3;0<J;--J)ui(f,x+=4*k,k,1,16,F,W,K)}function Vl(f,x,k,F,W,K){var J;for(J=3;0<J;--J)ui(f,x+=4,1,k,16,F,W,K)}function lp(f,x,k,F,W,K,J,Q){Oa(f,x,W,1,8,K,J,Q),Oa(k,F,W,1,8,K,J,Q)}function Eu(f,x,k,F,W,K,J,Q){Oa(f,x,1,W,8,K,J,Q),Oa(k,F,1,W,8,K,J,Q)}function Au(f,x,k,F,W,K,J,Q){ui(f,x+4*W,W,1,8,K,J,Q),ui(k,F+4*W,W,1,8,K,J,Q)}function Yf(f,x,k,F,W,K,J,Q){ui(f,x+4,1,W,8,K,J,Q),ui(k,F+4,1,W,8,K,J,Q)}function Gl(){this.ba=new ys,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new lr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Tu(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Cu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Kf(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new U,this.yc=new T}function cp(){this.xb=this.a=0,this.l=new Ii,this.ca=new ys,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new S,this.Pb=0,this.wd=new S,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Kf,this.ab=0,this.gc=a(4,Cu),this.Oc=0}function Yl(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ii,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Vo(f,x,k,F,W,K,J){for(f=f==null?0:f[x+0],x=0;x<J;++x)W[K+x]=f+k[F+x]&255,f=W[K+x]}function Pu(f,x,k,F,W,K,J){var Q;if(f==null)Vo(null,null,k,F,W,K,J);else for(Q=0;Q<J;++Q)W[K+Q]=f[x+Q]+k[F+Q]&255}function Da(f,x,k,F,W,K,J){if(f==null)Vo(null,null,k,F,W,K,J);else{var Q,Z=f[x+0],ie=Z,xe=Z;for(Q=0;Q<J;++Q)ie=xe+(Z=f[x+Q])-ie,xe=k[F+Q]+(-256&ie?0>ie?0:255:ie)&255,ie=Z,W[K+Q]=xe}}function Lu(f,x,k,F){var W=x.width,K=x.o;if(t(f!=null&&x!=null),0>k||0>=F||k+F>K)return null;if(!f.Cc){if(f.ga==null){var J;if(f.ga=new Yl,(J=f.ga==null)||(J=x.width*x.o,t(f.Gb.length==0),f.Gb=i(J),f.Uc=0,f.Gb==null?J=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,J=1),J=!J),!J){J=f.ga;var Q=f.Fa,Z=f.P,ie=f.qc,xe=f.mb,Ee=f.nb,Ae=Z+1,be=ie-1,Re=J.l;if(t(Q!=null&&xe!=null&&x!=null),za[0]=null,za[1]=Vo,za[2]=Pu,za[3]=Da,J.ca=xe,J.tb=Ee,J.c=x.width,J.i=x.height,t(0<J.c&&0<J.i),1>=ie)x=0;else if(J.$a=Q[Z+0]>>0&3,J.Z=Q[Z+0]>>2&3,J.Lc=Q[Z+0]>>4&3,Z=Q[Z+0]>>6&3,0>J.$a||1<J.$a||4<=J.Z||1<J.Lc||Z)x=0;else if(Re.put=zs,Re.ac=nn,Re.bc=Ws,Re.ma=J,Re.width=x.width,Re.height=x.height,Re.Da=x.Da,Re.v=x.v,Re.va=x.va,Re.j=x.j,Re.o=x.o,J.$a)e:{t(J.$a==1),x=Pe();t:for(;;){if(x==null){x=0;break e}if(t(J!=null),J.mc=x,x.c=J.c,x.i=J.i,x.l=J.l,x.l.ma=J,x.l.width=J.c,x.l.height=J.i,x.a=0,B(x.m,Q,Ae,be),!ke(J.c,J.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&ee(x.s)?(J.ic=1,Q=x.c*x.i,x.Ta=null,x.Ua=0,x.V=i(Q),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(J.ic=0,x=Te(x,J.c)),!x))break t;x=1;break e}J.mc=null,x=0}else x=be>=J.c*J.i;J=!x}if(J)return null;f.ga.Lc!=1?f.Ga=0:F=K-k}t(f.ga!=null),t(k+F<=K);e:{if(x=(Q=f.ga).c,K=Q.l.o,Q.$a==0){if(Ae=f.rc,be=f.Vc,Re=f.Fa,Z=f.P+1+k*x,ie=f.mb,xe=f.nb+k*x,t(Z<=f.P+f.qc),Q.Z!=0)for(t(za[Q.Z]!=null),J=0;J<F;++J)za[Q.Z](Ae,be,Re,Z,ie,xe,x),Ae=ie,be=xe,xe+=x,Z+=x;else for(J=0;J<F;++J)n(ie,xe,Re,Z,x),Ae=ie,be=xe,xe+=x,Z+=x;f.rc=Ae,f.Vc=be}else{if(t(Q.mc!=null),x=k+F,t((J=Q.mc)!=null),t(x<=J.i),J.C>=x)x=1;else if(Q.ic||Ne(),Q.ic){Q=J.V,Ae=J.Ba,be=J.c;var Le=J.i,ve=(Re=1,Z=J.$/be,ie=J.$%be,xe=J.m,Ee=J.s,J.$),we=be*Le,De=be*x,ze=Ee.wc,Ie=ve<De?Tr(Ee,ie,Z):null;t(ve<=we),t(x<=Le),t(ee(Ee));t:for(;;){for(;!xe.h&&ve<De;){if(ie&ze||(Ie=Tr(Ee,ie,Z)),t(Ie!=null),V(xe),256>(Le=Cn(Ie.G[0],Ie.H[0],xe)))Q[Ae+ve]=Le,++ve,++ie>=be&&(ie=0,++Z<=x&&!(Z%16)&&ae(J,Z));else{if(!(280>Le)){Re=0;break t}Le=ws(Le-256,xe);var lt,et=Cn(Ie.G[4],Ie.H[4],xe);if(V(xe),!(ve>=(et=rs(be,et=ws(et,xe)))&&we-ve>=Le)){Re=0;break t}for(lt=0;lt<Le;++lt)Q[Ae+ve+lt]=Q[Ae+ve+lt-et];for(ve+=Le,ie+=Le;ie>=be;)ie-=be,++Z<=x&&!(Z%16)&&ae(J,Z);ve<De&&ie&ze&&(Ie=Tr(Ee,ie,Z))}t(xe.h==R(xe))}ae(J,Z>x?x:Z);break t}!Re||xe.h&&ve<we?(Re=0,J.a=xe.h?5:3):J.$=ve,x=Re}else x=ce(J,J.V,J.Ba,J.c,J.i,x,Ce);if(!x){F=0;break e}}k+F>=K&&(f.Cc=1),F=1}if(!F)return null;if(f.Cc&&((F=f.ga)!=null&&(F.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+k*W}function N(f,x,k,F,W,K){for(;0<W--;){var J,Q=f,Z=x+(k?1:0),ie=f,xe=x+(k?0:3);for(J=0;J<F;++J){var Ee=ie[xe+4*J];Ee!=255&&(Ee*=32897,Q[Z+4*J+0]=Q[Z+4*J+0]*Ee>>23,Q[Z+4*J+1]=Q[Z+4*J+1]*Ee>>23,Q[Z+4*J+2]=Q[Z+4*J+2]*Ee>>23)}x+=K}}function H(f,x,k,F,W){for(;0<F--;){var K;for(K=0;K<k;++K){var J=f[x+2*K+0],Q=15&(ie=f[x+2*K+1]),Z=4369*Q,ie=(240&ie|ie>>4)*Z>>16;f[x+2*K+0]=(240&J|J>>4)*Z>>16&240|(15&J|J<<4)*Z>>16>>4&15,f[x+2*K+1]=240&ie|Q}x+=W}}function de(f,x,k,F,W,K,J,Q){var Z,ie,xe=255;for(ie=0;ie<W;++ie){for(Z=0;Z<F;++Z){var Ee=f[x+Z];K[J+4*Z]=Ee,xe&=Ee}x+=k,J+=Q}return xe!=255}function ge(f,x,k,F,W){var K;for(K=0;K<W;++K)k[F+K]=f[x+K]>>8}function Ne(){Vs=N,fr=H,hr=de,Br=ge}function Fe(f,x,k){P[f]=function(F,W,K,J,Q,Z,ie,xe,Ee,Ae,be,Re,Le,ve,we,De,ze){var Ie,lt=ze-1>>1,et=Q[Z+0]|ie[xe+0]<<16,gt=Ee[Ae+0]|be[Re+0]<<16;t(F!=null);var nt=3*et+gt+131074>>2;for(x(F[W+0],255&nt,nt>>16,Le,ve),K!=null&&(nt=3*gt+et+131074>>2,x(K[J+0],255&nt,nt>>16,we,De)),Ie=1;Ie<=lt;++Ie){var Vt=Q[Z+Ie]|ie[xe+Ie]<<16,Xt=Ee[Ae+Ie]|be[Re+Ie]<<16,zt=et+Vt+gt+Xt+524296,It=zt+2*(Vt+gt)>>3;nt=It+et>>1,et=(zt=zt+2*(et+Xt)>>3)+Vt>>1,x(F[W+2*Ie-1],255&nt,nt>>16,Le,ve+(2*Ie-1)*k),x(F[W+2*Ie-0],255&et,et>>16,Le,ve+(2*Ie-0)*k),K!=null&&(nt=zt+gt>>1,et=It+Xt>>1,x(K[J+2*Ie-1],255&nt,nt>>16,we,De+(2*Ie-1)*k),x(K[J+2*Ie+0],255&et,et>>16,we,De+(2*Ie+0)*k)),et=Vt,gt=Xt}1&ze||(nt=3*et+gt+131074>>2,x(F[W+ze-1],255&nt,nt>>16,Le,ve+(ze-1)*k),K!=null&&(nt=3*gt+et+131074>>2,x(K[J+ze-1],255&nt,nt>>16,we,De+(ze-1)*k)))}}function $e(){Ys[nh]=FN,Ys[sh]=D2,Ys[C2]=ON,Ys[ih]=I2,Ys[ah]=R2,Ys[fp]=M2,Ys[P2]=DN,Ys[hp]=D2,Ys[mp]=I2,Ys[oh]=R2,Ys[pp]=M2}function ot(f){return f&-16384?0>f?0:255:f>>IN}function ht(f,x){return ot((19077*f>>8)+(26149*x>>8)-14234)}function jt(f,x,k){return ot((19077*f>>8)-(6419*x>>8)-(13320*k>>8)+8708)}function St(f,x){return ot((19077*f>>8)+(33050*x>>8)-17685)}function Bt(f,x,k,F,W){F[W+0]=ht(f,k),F[W+1]=jt(f,x,k),F[W+2]=St(f,x)}function Sr(f,x,k,F,W){F[W+0]=St(f,x),F[W+1]=jt(f,x,k),F[W+2]=ht(f,k)}function Cr(f,x,k,F,W){var K=jt(f,x,k);x=K<<3&224|St(f,x)>>3,F[W+0]=248&ht(f,k)|K>>5,F[W+1]=x}function Vr(f,x,k,F,W){var K=240&St(f,x)|15;F[W+0]=240&ht(f,k)|jt(f,x,k)>>4,F[W+1]=K}function Ln(f,x,k,F,W){F[W+0]=255,Bt(f,x,k,F,W+1)}function un(f,x,k,F,W){Sr(f,x,k,F,W),F[W+3]=255}function di(f,x,k,F,W){Bt(f,x,k,F,W),F[W+3]=255}function _s(f,x){return 0>f?0:f>x?x:f}function Bi(f,x,k){P[f]=function(F,W,K,J,Q,Z,ie,xe,Ee){for(var Ae=xe+(-2&Ee)*k;xe!=Ae;)x(F[W+0],K[J+0],Q[Z+0],ie,xe),x(F[W+1],K[J+0],Q[Z+0],ie,xe+k),W+=2,++J,++Z,xe+=2*k;1&Ee&&x(F[W+0],K[J+0],Q[Z+0],ie,xe)}}function Xf(f,x,k){return k==0?f==0?x==0?6:5:x==0?4:0:k}function Fu(f,x,k,F,W){switch(f>>>30){case 3:la(x,k,F,W,0);break;case 2:Mr(x,k,F,W);break;case 1:qn(x,k,F,W)}}function Ou(f,x){var k,F,W=x.M,K=x.Nb,J=f.oc,Q=f.pc+40,Z=f.oc,ie=f.pc+584,xe=f.oc,Ee=f.pc+600;for(k=0;16>k;++k)J[Q+32*k-1]=129;for(k=0;8>k;++k)Z[ie+32*k-1]=129,xe[Ee+32*k-1]=129;for(0<W?J[Q-1-32]=Z[ie-1-32]=xe[Ee-1-32]=129:(s(J,Q-32-1,127,21),s(Z,ie-32-1,127,9),s(xe,Ee-32-1,127,9)),F=0;F<f.za;++F){var Ae=x.ya[x.aa+F];if(0<F){for(k=-1;16>k;++k)n(J,Q+32*k-4,J,Q+32*k+12,4);for(k=-1;8>k;++k)n(Z,ie+32*k-4,Z,ie+32*k+4,4),n(xe,Ee+32*k-4,xe,Ee+32*k+4,4)}var be=f.Gd,Re=f.Hd+F,Le=Ae.ad,ve=Ae.Hc;if(0<W&&(n(J,Q-32,be[Re].y,0,16),n(Z,ie-32,be[Re].f,0,8),n(xe,Ee-32,be[Re].ea,0,8)),Ae.Za){var we=J,De=Q-32+16;for(0<W&&(F>=f.za-1?s(we,De,be[Re].y[15],4):n(we,De,be[Re+1].y,0,4)),k=0;4>k;k++)we[De+128+k]=we[De+256+k]=we[De+384+k]=we[De+0+k];for(k=0;16>k;++k,ve<<=2)we=J,De=Q+U2[k],fi[Ae.Ob[k]](we,De),Fu(ve,Le,16*+k,we,De)}else if(we=Xf(F,W,Ae.Ob[0]),Ua[we](J,Q),ve!=0)for(k=0;16>k;++k,ve<<=2)Fu(ve,Le,16*+k,J,Q+U2[k]);for(k=Ae.Gc,we=Xf(F,W,Ae.Dd),ua[we](Z,ie),ua[we](xe,Ee),ve=Le,we=Z,De=ie,255&(Ae=k>>0)&&(170&Ae?Bu(ve,256,we,De):$s(ve,256,we,De)),Ae=xe,ve=Ee,255&(k>>=8)&&(170&k?Bu(Le,320,Ae,ve):$s(Le,320,Ae,ve)),W<f.Ub-1&&(n(be[Re].y,0,J,Q+480,16),n(be[Re].f,0,Z,ie+224,8),n(be[Re].ea,0,xe,Ee+224,8)),k=8*K*f.B,be=f.sa,Re=f.ta+16*F+16*K*f.R,Le=f.qa,Ae=f.ra+8*F+k,ve=f.Ha,we=f.Ia+8*F+k,k=0;16>k;++k)n(be,Re+k*f.R,J,Q+32*k,16);for(k=0;8>k;++k)n(Le,Ae+k*f.B,Z,ie+32*k,8),n(ve,we+k*f.B,xe,Ee+32*k,8)}}function Kl(f,x,k,F,W,K,J,Q,Z){var ie=[0],xe=[0],Ee=0,Ae=Z!=null?Z.kd:0,be=Z??new Tu;if(f==null||12>k)return 7;be.data=f,be.w=x,be.ha=k,x=[x],k=[k],be.gb=[be.gb];e:{var Re=x,Le=k,ve=be.gb;if(t(f!=null),t(Le!=null),t(ve!=null),ve[0]=0,12<=Le[0]&&!r(f,Re[0],"RIFF")){if(r(f,Re[0]+8,"WEBP")){ve=3;break e}var we=Ue(f,Re[0]+4);if(12>we||4294967286<we){ve=3;break e}if(Ae&&we>Le[0]-8){ve=7;break e}ve[0]=we,Re[0]+=12,Le[0]-=12}ve=0}if(ve!=0)return ve;for(we=0<be.gb[0],k=k[0];;){e:{var De=f;Le=x,ve=k;var ze=ie,Ie=xe,lt=Re=[0];if((nt=Ee=[Ee])[0]=0,8>ve[0])ve=7;else{if(!r(De,Le[0],"VP8X")){if(Ue(De,Le[0]+4)!=10){ve=3;break e}if(18>ve[0]){ve=7;break e}var et=Ue(De,Le[0]+8),gt=1+_e(De,Le[0]+12);if(2147483648<=gt*(De=1+_e(De,Le[0]+15))){ve=3;break e}lt!=null&&(lt[0]=et),ze!=null&&(ze[0]=gt),Ie!=null&&(Ie[0]=De),Le[0]+=18,ve[0]-=18,nt[0]=1}ve=0}}if(Ee=Ee[0],Re=Re[0],ve!=0)return ve;if(Le=!!(2&Re),!we&&Ee)return 3;if(K!=null&&(K[0]=!!(16&Re)),J!=null&&(J[0]=Le),Q!=null&&(Q[0]=0),J=ie[0],Re=xe[0],Ee&&Le&&Z==null){ve=0;break}if(4>k){ve=7;break}if(we&&Ee||!we&&!Ee&&!r(f,x[0],"ALPH")){k=[k],be.na=[be.na],be.P=[be.P],be.Sa=[be.Sa];e:{et=f,ve=x,we=k;var nt=be.gb;ze=be.na,Ie=be.P,lt=be.Sa,gt=22,t(et!=null),t(we!=null),De=ve[0];var Vt=we[0];for(t(ze!=null),t(lt!=null),ze[0]=null,Ie[0]=null,lt[0]=0;;){if(ve[0]=De,we[0]=Vt,8>Vt){ve=7;break e}var Xt=Ue(et,De+4);if(4294967286<Xt){ve=3;break e}var zt=8+Xt+1&-2;if(gt+=zt,0<nt&&gt>nt){ve=3;break e}if(!r(et,De,"VP8 ")||!r(et,De,"VP8L")){ve=0;break e}if(Vt[0]<zt){ve=7;break e}r(et,De,"ALPH")||(ze[0]=et,Ie[0]=De+8,lt[0]=Xt),De+=zt,Vt-=zt}}if(k=k[0],be.na=be.na[0],be.P=be.P[0],be.Sa=be.Sa[0],ve!=0)break}k=[k],be.Ja=[be.Ja],be.xa=[be.xa];e:if(nt=f,ve=x,we=k,ze=be.gb[0],Ie=be.Ja,lt=be.xa,et=ve[0],De=!r(nt,et,"VP8 "),gt=!r(nt,et,"VP8L"),t(nt!=null),t(we!=null),t(Ie!=null),t(lt!=null),8>we[0])ve=7;else{if(De||gt){if(nt=Ue(nt,et+4),12<=ze&&nt>ze-12){ve=3;break e}if(Ae&&nt>we[0]-8){ve=7;break e}Ie[0]=nt,ve[0]+=8,we[0]-=8,lt[0]=gt}else lt[0]=5<=we[0]&&nt[et+0]==47&&!(nt[et+4]>>5),Ie[0]=we[0];ve=0}if(k=k[0],be.Ja=be.Ja[0],be.xa=be.xa[0],x=x[0],ve!=0)break;if(4294967286<be.Ja)return 3;if(Q==null||Le||(Q[0]=be.xa?2:1),J=[J],Re=[Re],be.xa){if(5>k){ve=7;break}Q=J,Ae=Re,Le=K,f==null||5>k?f=0:5<=k&&f[x+0]==47&&!(f[x+4]>>5)?(we=[0],nt=[0],ze=[0],B(Ie=new S,f,x,k),pt(Ie,we,nt,ze)?(Q!=null&&(Q[0]=we[0]),Ae!=null&&(Ae[0]=nt[0]),Le!=null&&(Le[0]=ze[0]),f=1):f=0):f=0}else{if(10>k){ve=7;break}Q=Re,f==null||10>k||!Of(f,x+3,k-3)?f=0:(Ae=f[x+0]|f[x+1]<<8|f[x+2]<<16,Le=16383&(f[x+7]<<8|f[x+6]),f=16383&(f[x+9]<<8|f[x+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=be.Ja||!Le||!f?f=0:(J&&(J[0]=Le),Q&&(Q[0]=f),f=1))}if(!f||(J=J[0],Re=Re[0],Ee&&(ie[0]!=J||xe[0]!=Re)))return 3;Z!=null&&(Z[0]=be,Z.offset=x-Z.w,t(4294967286>x-Z.w),t(Z.offset==Z.ha-k));break}return ve==0||ve==7&&Ee&&Z==null?(K!=null&&(K[0]|=be.na!=null&&0<be.na.length),F!=null&&(F[0]=J),W!=null&&(W[0]=Re),0):ve}function Du(f,x,k){var F=x.width,W=x.height,K=0,J=0,Q=F,Z=W;if(x.Da=f!=null&&0<f.Da,x.Da&&(Q=f.cd,Z=f.bd,K=f.v,J=f.j,11>k||(K&=-2,J&=-2),0>K||0>J||0>=Q||0>=Z||K+Q>F||J+Z>W))return 0;if(x.v=K,x.j=J,x.va=K+Q,x.o=J+Z,x.U=Q,x.T=Z,x.da=f!=null&&0<f.da,x.da){if(!Me(Q,Z,k=[f.ib],K=[f.hb]))return 0;x.ib=k[0],x.hb=K[0]}return x.ob=f!=null&&f.ob,x.Kb=f==null||!f.Sd,x.da&&(x.ob=x.ib<3*F/4&&x.hb<3*W/4,x.Kb=0),1}function Iu(f){if(f==null)return 2;if(11>f.S){var x=f.f.RGBA;x.fb+=(f.height-1)*x.A,x.A=-x.A}else x=f.f.kb,f=f.height,x.O+=(f-1)*x.fa,x.fa=-x.fa,x.N+=(f-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(f-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(f-1)*x.lb,x.lb=-x.lb);return 0}function Xl(f,x,k,F){if(F==null||0>=f||0>=x)return 2;if(k!=null){if(k.Da){var W=k.cd,K=k.bd,J=-2&k.v,Q=-2&k.j;if(0>J||0>Q||0>=W||0>=K||J+W>f||Q+K>x)return 2;f=W,x=K}if(k.da){if(!Me(f,x,W=[k.ib],K=[k.hb]))return 2;f=W[0],x=K[0]}}F.width=f,F.height=x;e:{var Z=F.width,ie=F.height;if(f=F.S,0>=Z||0>=ie||!(f>=nh&&13>f))f=2;else{if(0>=F.Rd&&F.sd==null){J=K=W=x=0;var xe=(Q=Z*z2[f])*ie;if(11>f||(K=(ie+1)/2*(x=(Z+1)/2),f==12&&(J=(W=Z)*ie)),(ie=i(xe+2*K+J))==null){f=1;break e}F.sd=ie,11>f?((Z=F.f.RGBA).eb=ie,Z.fb=0,Z.A=Q,Z.size=xe):((Z=F.f.kb).y=ie,Z.O=0,Z.fa=Q,Z.Fd=xe,Z.f=ie,Z.N=0+xe,Z.Ab=x,Z.Cd=K,Z.ea=ie,Z.W=0+xe+K,Z.Db=x,Z.Ed=K,f==12&&(Z.F=ie,Z.J=0+xe+2*K),Z.Tc=J,Z.lb=W)}if(x=1,W=F.S,K=F.width,J=F.height,W>=nh&&13>W)if(11>W)f=F.f.RGBA,x&=(Q=Math.abs(f.A))*(J-1)+K<=f.size,x&=Q>=K*z2[W],x&=f.eb!=null;else{f=F.f.kb,Q=(K+1)/2,xe=(J+1)/2,Z=Math.abs(f.fa),ie=Math.abs(f.Ab);var Ee=Math.abs(f.Db),Ae=Math.abs(f.lb),be=Ae*(J-1)+K;x&=Z*(J-1)+K<=f.Fd,x&=ie*(xe-1)+Q<=f.Cd,x=(x&=Ee*(xe-1)+Q<=f.Ed)&Z>=K&ie>=Q&Ee>=Q,x&=f.y!=null,x&=f.f!=null,x&=f.ea!=null,W==12&&(x&=Ae>=K,x&=be<=f.Tc,x&=f.F!=null)}else x=0;f=x?0:2}}return f!=0||k!=null&&k.fd&&(f=Iu(F)),f}var yn=64,Jl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ql=24,Zl=32,Ru=8,ss=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ke("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(f){return f},P.Predictor2=function(f,x,k){return x[k+0]},P.Predictor3=function(f,x,k){return x[k+1]},P.Predictor4=function(f,x,k){return x[k-1]},P.Predictor5=function(f,x,k){return tt(tt(f,x[k+1]),x[k+0])},P.Predictor6=function(f,x,k){return tt(f,x[k-1])},P.Predictor7=function(f,x,k){return tt(f,x[k+0])},P.Predictor8=function(f,x,k){return tt(x[k-1],x[k+0])},P.Predictor9=function(f,x,k){return tt(x[k+0],x[k+1])},P.Predictor10=function(f,x,k){return tt(tt(f,x[k-1]),tt(x[k+0],x[k+1]))},P.Predictor11=function(f,x,k){var F=x[k+0];return 0>=bt(F>>24&255,f>>24&255,(x=x[k-1])>>24&255)+bt(F>>16&255,f>>16&255,x>>16&255)+bt(F>>8&255,f>>8&255,x>>8&255)+bt(255&F,255&f,255&x)?F:f},P.Predictor12=function(f,x,k){var F=x[k+0];return(dt((f>>24&255)+(F>>24&255)-((x=x[k-1])>>24&255))<<24|dt((f>>16&255)+(F>>16&255)-(x>>16&255))<<16|dt((f>>8&255)+(F>>8&255)-(x>>8&255))<<8|dt((255&f)+(255&F)-(255&x)))>>>0},P.Predictor13=function(f,x,k){var F=x[k-1];return(ft((f=tt(f,x[k+0]))>>24&255,F>>24&255)<<24|ft(f>>16&255,F>>16&255)<<16|ft(f>>8&255,F>>8&255)<<8|ft(f>>0&255,F>>0&255))>>>0};var up=P.PredictorAdd0;P.PredictorAdd1=Et,Ke("Predictor2","PredictorAdd2"),Ke("Predictor3","PredictorAdd3"),Ke("Predictor4","PredictorAdd4"),Ke("Predictor5","PredictorAdd5"),Ke("Predictor6","PredictorAdd6"),Ke("Predictor7","PredictorAdd7"),Ke("Predictor8","PredictorAdd8"),Ke("Predictor9","PredictorAdd9"),Ke("Predictor10","PredictorAdd10"),Ke("Predictor11","PredictorAdd11"),Ke("Predictor12","PredictorAdd12"),Ke("Predictor13","PredictorAdd13");var Mu=P.PredictorAdd2;Ct("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),Ct("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var Jf,Hs=P.ColorIndexInverseTransform,ec=P.MapARGB,Qf=P.VP8LColorIndexInverseTransformAlpha,Zf=P.MapAlpha,Ia=P.VP8LPredictorsAdd=[];Ia.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var Go,is,$n,Ra,aa,oa,tc,la,Mr,Bu,qn,$s,rc,eh,Uu,Yo,Ko,Ma,Xo,nc,Jo,Ba,zu,qs,Vs,fr,hr,Br,sn=i(511),ca=i(2041),Wu=i(225),sc=i(767),th=0,dp=ca,rh=Wu,Ns=sc,Gs=sn,nh=0,sh=1,C2=2,ih=3,ah=4,fp=5,P2=6,hp=7,mp=8,oh=9,pp=10,yN=[2,3,7],wN=[3,3,11],L2=[280,256,256,256,40],bN=[0,1,1,1,0],_N=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],NN=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],SN=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],kN=8,gp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],xp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Hu=null,jN=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],EN=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],F2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],AN=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],TN=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],CN=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],PN=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ua=[],fi=[],ua=[],LN=1,O2=2,za=[],Ys=[];Fe("UpsampleRgbLinePair",Bt,3),Fe("UpsampleBgrLinePair",Sr,3),Fe("UpsampleRgbaLinePair",di,4),Fe("UpsampleBgraLinePair",un,4),Fe("UpsampleArgbLinePair",Ln,4),Fe("UpsampleRgba4444LinePair",Vr,2),Fe("UpsampleRgb565LinePair",Cr,2);var FN=P.UpsampleRgbLinePair,ON=P.UpsampleBgrLinePair,D2=P.UpsampleRgbaLinePair,I2=P.UpsampleBgraLinePair,R2=P.UpsampleArgbLinePair,M2=P.UpsampleRgba4444LinePair,DN=P.UpsampleRgb565LinePair,lh=16,ch=1<<lh-1,$u=-227,vp=482,IN=6,B2=0,RN=i(256),MN=i(256),BN=i(256),UN=i(256),zN=i(vp-$u),WN=i(vp-$u);Bi("YuvToRgbRow",Bt,3),Bi("YuvToBgrRow",Sr,3),Bi("YuvToRgbaRow",di,4),Bi("YuvToBgraRow",un,4),Bi("YuvToArgbRow",Ln,4),Bi("YuvToRgba4444Row",Vr,2),Bi("YuvToRgb565Row",Cr,2);var U2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],uh=[0,2,8],HN=[8,7,6,4,4,2,2,2,1,1,1,1],$N=1;this.WebPDecodeRGBA=function(f,x,k,F,W){var K=sh,J=new Gl,Q=new ys;J.ba=Q,Q.S=K,Q.width=[Q.width],Q.height=[Q.height];var Z=Q.width,ie=Q.height,xe=new ai;if(xe==null||f==null)var Ee=2;else t(xe!=null),Ee=Kl(f,x,k,xe.width,xe.height,xe.Pd,xe.Qd,xe.format,null);if(Ee!=0?Z=0:(Z!=null&&(Z[0]=xe.width[0]),ie!=null&&(ie[0]=xe.height[0]),Z=1),Z){Q.width=Q.width[0],Q.height=Q.height[0],F!=null&&(F[0]=Q.width),W!=null&&(W[0]=Q.height);e:{if(F=new Ii,(W=new Tu).data=f,W.w=x,W.ha=k,W.kd=1,x=[0],t(W!=null),((f=Kl(W.data,W.w,W.ha,null,null,null,x,null,W))==0||f==7)&&x[0]&&(f=4),(x=f)==0){if(t(J!=null),F.data=W.data,F.w=W.w+W.offset,F.ha=W.ha-W.offset,F.put=zs,F.ac=nn,F.bc=Ws,F.ma=J,W.xa){if((f=Pe())==null){J=1;break e}if(function(Ae,be){var Re=[0],Le=[0],ve=[0];t:for(;;){if(Ae==null)return 0;if(be==null)return Ae.a=2,0;if(Ae.l=be,Ae.a=0,B(Ae.m,be.data,be.w,be.ha),!pt(Ae.m,Re,Le,ve)){Ae.a=3;break t}if(Ae.xb=O2,be.width=Re[0],be.height=Le[0],!ke(Re[0],Le[0],1,Ae,null))break t;return 1}return t(Ae.a!=0),0}(f,F)){if(F=(x=Xl(F.width,F.height,J.Oa,J.ba))==0){t:{F=f;r:for(;;){if(F==null){F=0;break t}if(t(F.s.yc!=null),t(F.s.Ya!=null),t(0<F.s.Wb),t((k=F.l)!=null),t((W=k.ma)!=null),F.xb!=0){if(F.ca=W.ba,F.tb=W.tb,t(F.ca!=null),!Du(W.Oa,k,ih)){F.a=2;break r}if(!Te(F,k.width)||k.da)break r;if((k.da||Ut(F.ca.S))&&Ne(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&Ne()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!Ve(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!ce(F,F.V,F.Ba,F.c,F.i,k.o,oe))break r;W.Dc=F.Ma,F=1;break t}t(F.a!=0),F=0}F=!F}F&&(x=f.a)}else x=f.a}else{if((f=new bs)==null){J=1;break e}if(f.Fa=W.na,f.P=W.P,f.qc=W.Sa,Df(f,F)){if((x=Xl(F.width,F.height,J.Oa,J.ba))==0){if(f.Aa=0,k=J.Oa,t((W=f)!=null),k!=null){if(0<(Z=0>(Z=k.Md)?0:100<Z?255:255*Z/100)){for(ie=xe=0;4>ie;++ie)12>(Ee=W.pb[ie]).lc&&(Ee.ia=Z*HN[0>Ee.lc?0:Ee.lc]>>3),xe|=Ee.ia;xe&&(alert("todo:VP8InitRandom"),W.ia=1)}W.Ga=k.Id,100<W.Ga?W.Ga=100:0>W.Ga&&(W.Ga=0)}Vm(f,F)||(x=f.a)}}else x=f.a}x==0&&J.Oa!=null&&J.Oa.fd&&(x=Iu(J.ba))}J=x}K=J!=0?null:11>K?Q.f.RGBA.eb:Q.f.kb.y}else K=null;return K};var z2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(P,C){for(var M="",j=0;j<4;j++)M+=String.fromCharCode(P[C++]);return M}function d(P,C){return(P[C+0]<<0|P[C+1]<<8|P[C+2]<<16)>>>0}function m(P,C){return(P[C+0]<<0|P[C+1]<<8|P[C+2]<<16|P[C+3]<<24)>>>0}new c;var p=[0],h=[0],y=[],g=new c,w=e,v=function(P,C){var M={},j=0,T=!1,q=0,U=0;if(M.frames=[],!function(L,R,O,V){for(var ne=0;ne<V;ne++)if(L[R+ne]!=O.charCodeAt(ne))return!0;return!1}(P,C,"RIFF",4)){var re,z;for(m(P,C+=4),C+=8;C<P.length;){var G=u(P,C),B=m(P,C+=4);C+=4;var Y=B+(1&B);switch(G){case"VP8 ":case"VP8L":M.frames[j]===void 0&&(M.frames[j]={}),(S=M.frames[j]).src_off=T?U:C-8,S.src_size=q+B+8,j++,T&&(T=!1,q=0,U=0);break;case"VP8X":(S=M.header={}).feature_flags=P[C];var se=C+4;S.canvas_width=1+d(P,se),se+=3,S.canvas_height=1+d(P,se),se+=3;break;case"ALPH":T=!0,q=Y+8,U=C-8;break;case"ANIM":(S=M.header).bgcolor=m(P,C),se=C+4,S.loop_count=(re=P)[(z=se)+0]<<0|re[z+1]<<8,se+=2;break;case"ANMF":var me,S;(S=M.frames[j]={}).offset_x=2*d(P,C),C+=3,S.offset_y=2*d(P,C),C+=3,S.width=1+d(P,C),C+=3,S.height=1+d(P,C),C+=3,S.duration=d(P,C),C+=3,me=P[C++],S.dispose=1&me,S.blend=me>>1&1}G!="ANMF"&&(C+=Y)}return M}}(w,0);v.response=w,v.rgbaoutput=!0,v.dataurl=!1;var b=v.header?v.header:null,_=v.frames?v.frames:null;if(b){b.loop_counter=b.loop_count,p=[b.canvas_height],h=[b.canvas_width];for(var E=0;E<_.length&&_[E].blend!=0;E++);}var D=_[0],I=g.WebPDecodeRGBA(w,D.src_off,D.src_size,h,p);D.rgba=I,D.imgwidth=h[0],D.imgheight=p[0];for(var A=0;A<h[0]*p[0]*4;A++)y[A]=I[A];return this.width=h,this.height=p,this.data=y,this}(function(e){var t=function(){return typeof Ug=="function"},r=function(p,h,y,g){var w=4,v=a;switch(g){case e.image_compression.FAST:w=1,v=i;break;case e.image_compression.MEDIUM:w=6,v=l;break;case e.image_compression.SLOW:w=9,v=c}p=n(p,h,y,v);var b=Ug(p,{level:w});return e.__addimage__.arrayBufferToBinaryString(b)},n=function(p,h,y,g){for(var w,v,b,_=p.length/h,E=new Uint8Array(p.length+_),D=d(),I=0;I<_;I+=1){if(b=I*h,w=p.subarray(b,b+h),g)E.set(g(w,y,v),b+I);else{for(var A,P=D.length,C=[];A<P;A+=1)C[A]=D[A](w,y,v);var M=m(C.concat());E.set(C[M],b+I)}v=w}return E},s=function(p){var h=Array.apply([],p);return h.unshift(0),h},i=function(p,h){var y,g=[],w=p.length;g[0]=1;for(var v=0;v<w;v+=1)y=p[v-h]||0,g[v+1]=p[v]-y+256&255;return g},a=function(p,h,y){var g,w=[],v=p.length;w[0]=2;for(var b=0;b<v;b+=1)g=y&&y[b]||0,w[b+1]=p[b]-g+256&255;return w},l=function(p,h,y){var g,w,v=[],b=p.length;v[0]=3;for(var _=0;_<b;_+=1)g=p[_-h]||0,w=y&&y[_]||0,v[_+1]=p[_]+256-(g+w>>>1)&255;return v},c=function(p,h,y){var g,w,v,b,_=[],E=p.length;_[0]=4;for(var D=0;D<E;D+=1)g=p[D-h]||0,w=y&&y[D]||0,v=y&&y[D-h]||0,b=u(g,w,v),_[D+1]=p[D]-b+256&255;return _},u=function(p,h,y){if(p===h&&h===y)return p;var g=Math.abs(h-y),w=Math.abs(p-y),v=Math.abs(p+h-y-y);return g<=w&&g<=v?p:w<=v?h:y},d=function(){return[s,i,a,l,c]},m=function(p){var h=p.map(function(y){return y.reduce(function(g,w){return g+Math.abs(w)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(p,h,y,g){var w,v,b,_,E,D,I,A,P,C,M,j,T,q,U,re=this.decode.FLATE_DECODE,z="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(b=new VC(p)).imgData,v=b.bits,w=b.colorSpace,E=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){P=(A=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,M=new Uint8Array(P*b.colors),C=new Uint8Array(P);var G,B=b.pixelBitlength-b.bits;for(q=0,U=0;q<P;q++){for(T=A[q],G=0;G<B;)M[U++]=T>>>G&255,G+=b.bits;C[q]=T>>>G&255}}if(b.bits===16){P=(A=new Uint32Array(b.decodePixels().buffer)).length,M=new Uint8Array(P*(32/b.pixelBitlength)*b.colors),C=new Uint8Array(P*(32/b.pixelBitlength)),j=b.colors>1,q=0,U=0;for(var Y=0;q<P;)T=A[q++],M[U++]=T>>>0&255,j&&(M[U++]=T>>>16&255,T=A[q++],M[U++]=T>>>0&255),C[Y++]=T>>>16&255;v=8}g!==e.image_compression.NONE&&t()?(p=r(M,b.width*b.colors,b.colors,g),I=r(C,b.width,1,g)):(p=M,I=C,re=void 0)}if(b.colorType===3&&(w=this.color_spaces.INDEXED,D=b.palette,b.transparency.indexed)){var se=b.transparency.indexed,me=0;for(q=0,P=se.length;q<P;++q)me+=se[q];if((me/=255)===P-1&&se.indexOf(0)!==-1)_=[se.indexOf(0)];else if(me!==P){for(A=b.decodePixels(),C=new Uint8Array(A.length),q=0,P=A.length;q<P;q++)C[q]=se[A[q]];I=r(C,b.width,1)}}var S=function(L){var R;switch(L){case e.image_compression.FAST:R=11;break;case e.image_compression.MEDIUM:R=13;break;case e.image_compression.SLOW:R=14;break;default:R=12}return R}(g);return re===this.decode.FLATE_DECODE&&(z="/Predictor "+S+" "),z+="/Colors "+E+" /BitsPerComponent "+v+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(I&&this.__addimage__.isArrayBuffer(I)||this.__addimage__.isArrayBufferView(I))&&(I=this.__addimage__.arrayBufferToBinaryString(I)),{alias:y,data:p,index:h,filter:re,decodeParameters:z,transparency:_,palette:D,sMask:I,predictor:S,width:b.width,height:b.height,bitsPerComponent:v,colorSpace:w}}}})(mt.API),function(e){e.processGIF89A=function(t,r,n,s){var i=new GC(t),a=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:a,height:l},d=new v1(100).encode(u,100);return e.processJPEG.call(this,d,r,n,s)},e.processGIF87A=e.processGIF89A}(mt.API),gi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},gi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){ur.log("bit decode error:"+r)}},gi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[a+4*l]=c.blue,this.data[a+4*l+1]=c.green,this.data[a+4*l+2]=c.red,this.data[a+4*l+3]=255}r!==0&&(this.pos+=4-r)}},gi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*s*4,l=i>>4,c=15&i,u=this.palette[l];if(this.data[a]=u.blue,this.data[a+1]=u.green,this.data[a+2]=u.red,this.data[a+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[a+4]=u.blue,this.data[a+4+1]=u.green,this.data[a+4+2]=u.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},gi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(s<this.palette.length){var a=this.palette[s];this.data[i]=a.red,this.data[i+1]=a.green,this.data[i+2]=a.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},gi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=a,this.data[d+3]=u}this.pos+=e}},gi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(a&t)/t*255|0,c=(a>>5&r)/r*255|0,u=(a>>11)/t*255|0,d=s*this.width*4+4*i;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},gi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*r;this.data[a]=i,this.data[a+1]=s,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},gi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=a}},gi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var i=new gi(t,!1),a=i.width,l=i.height,c={data:i.getData(),width:a,height:l},u=new v1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,s)}}(mt.API),u5.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var i=new u5(t),a=i.width,l=i.height,c={data:i.getData(),width:a,height:l},u=new v1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,s)}}(mt.API),mt.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,i=new Uint8Array(s/4*3),a=new Uint8Array(s/4),l=0,c=0,u=0;u<s;u+=4){var d=n[u],m=n[u+1],p=n[u+2],h=n[u+3];i[l++]=d,i[l++]=m,i[l++]=p,a[c++]=h}var y=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:y,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},mt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},gc=mt.API,Vh=gc.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,m=t.doKerning!==!1,p=0,h=e.length,y=0,g=l[0]||c,w=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?w.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+a*(1e3/i)||0)/1e3):(p=m&&tr(u[n])==="object"&&!isNaN(parseInt(u[n][y],10))?u[n][y]/d:0,w.push((l[n]||g)/c+p)),y=n;return w},a5=gc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return gc.processArabic&&(e=gc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:Vh.apply(this,arguments).reduce(function(i,a){return i+a},0)},o5=function(e,t,r,n){for(var s=[],i=0,a=e.length,l=0;i!==a&&l+t[i]<r;)l+=t[i],i++;s.push(e.slice(0,i));var c=i;for(l=0;i!==a;)l+t[i]>n&&(s.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&s.push(e.slice(c,i)),s},l5=function(e,t,r){r||(r={});var n,s,i,a,l,c,u,d=[],m=[d],p=r.textIndent||0,h=0,y=0,g=e.split(" "),w=Vh.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),b=[];g.map(function(E){(E=E.split(/\s*\n/)).length>1?b=b.concat(E.map(function(D,I){return(I&&D.length?`
`:"")+D})):b.push(E[0])}),g=b,c=a5.apply(this,[v,r])}for(i=0,a=g.length;i<a;i++){var _=0;if(n=g[i],c&&n[0]==`
`&&(n=n.substr(1),_=1),p+h+(y=(s=Vh.apply(this,[n,r])).reduce(function(E,D){return E+D},0))>t||_){if(y>t){for(l=o5.apply(this,[n,s,t-(p+h),t]),d.push(l.shift()),d=[l.pop()];l.length;)m.push([l.shift()]);y=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(E,D){return E+D},0)}else d=[n];m.push(d),p=y+c,h=w}else d.push(n),p+=h+y,h=w}return u=c?function(E,D){return(D?v:"")+E.join(" ")}:function(E){return E.join(" ")},m.map(u)},gc.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var m=this.internal.getFont(d.fontName,d.fontStyle);return m.metadata.Unicode?{widths:m.metadata.Unicode.widths||{0:1},kerning:m.metadata.Unicode.kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(l5.apply(this,[n[l],a,i]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},s=0;s<t.length;s++)r[t[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=t[s];var i=function(m){return"0x"+parseInt(m,10).toString(16)},a=e.__fontmetrics__.compress=function(m){var p,h,y,g,w=["{"];for(var v in m){if(p=m[v],isNaN(parseInt(v,10))?h="'"+v+"'":(v=parseInt(v,10),h=(h=i(v).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof p=="number")p<0?(y=i(p).slice(3),g="-"):(y=i(p).slice(2),g=""),y=g+y.slice(0,-1)+n[y.slice(-1)];else{if(tr(p)!=="object")throw new Error("Don't know what to do with value type "+tr(p)+".");y=a(p)}w.push(h+y)}return w.push("}"),w.join("")},l=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,h,y,g,w={},v=1,b=w,_=[],E="",D="",I=m.length-1,A=1;A<I;A+=1)(g=m[A])=="'"?p?(y=p.join(""),p=void 0):p=[]:p?p.push(g):g=="{"?(_.push([b,y]),b={},y=void 0):g=="}"?((h=_.pop())[0][h[1]]=b,y=void 0,b=h[0]):g=="-"?v=-1:y===void 0?r.hasOwnProperty(g)?(E+=r[g],y=parseInt(E,16)*v,v=1,E=""):E+=g:r.hasOwnProperty(g)?(D+=r[g],b[y]=parseInt(D,16)*v,v=1,y=void 0,D=""):D+=g;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var p=m.font,h=d.Unicode[p.postScriptName];h&&(p.metadata.Unicode={},p.metadata.Unicode.widths=h.widths,p.metadata.Unicode.kerning=h.kerning);var y=u.Unicode[p.postScriptName];y&&(p.metadata.Unicode.encoding=y,p.encoding=y.codePages[0])}])}(mt.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=r.charCodeAt(i);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(a,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Cd(l)),a.metadata=e.API.TTFFont.open(l),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(s,n)}}])}(mt),function(e){function t(){return(vt.canvg?Promise.resolve(vt.canvg):Ea(()=>import("./index.es-D1A5WpXI.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}mt.API.addSvgAsImage=function(r,n,s,i,a,l,c,u){if(isNaN(n)||isNaN(s))throw ur.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(a))throw ur.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=a;var m=d.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(y){return y.fromString(m,r,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(p)}).then(function(){h.addImage(d.toDataURL("image/jpeg",1),n,s,i,a,c,u)})}}(),mt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},mt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,i,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(a),c=[],u=0,d=0,m=0;function p(y,g){var w,v=!1;for(w=0;w<y.length;w+=1)y[w]===g&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(m=0;m<h;m+=1)r[l[m]].value=r[l[m]].defaultValue,r[l[m]].explicitSet=!1}if(tr(e)==="object"){for(s in e)if(i=e[s],p(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&p(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(d=0;d<i[u].length;d+=1)typeof i[u][d]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,g=[];for(y in r)r[y].explicitSet===!0&&(r[y].type==="name"?g.push("/"+y+" /"+r[y].value):g.push("/"+y+" "+r[y].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+a.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+i+a+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(mt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,a){for(var l,c=a.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],m=0,p=i.length;m<p;++m){if(l=a.metadata.characterToGlyph(i.charCodeAt(m)),a.metadata.glyIdsUsed.push(l),a.metadata.toUnicode[l]=i.charCodeAt(m),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(a.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(i){var a,l,c,u,d,m,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,p=(l=Object.keys(i).sort(function(h,y){return h-y})).length;m<p;m++)a=l[m],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[a]!==void 0&&i[a]!==null&&typeof i[a].toString=="function"&&(u=("0000"+i[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),c.push("<"+a+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(a){var l=a.font,c=a.out,u=a.newObject,d=a.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var m=l.metadata.Unicode.widths,p=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",y=0;y<p.length;y++)h+=String.fromCharCode(p[y]);var g=u();d({data:h,addLength1:!0,objectId:g}),c("endobj");var w=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+_c(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+_c(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+e.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+_c(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(a){var l=a.font,c=a.out,u=a.newObject,d=a.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var m=l.metadata.rawData,p="",h=0;h<m.length;h++)p+=String.fromCharCode(m[h]);var y=u();d({data:p,addLength1:!0,objectId:y}),c("endobj");var g=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var w=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+y+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+_c(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+_c(l.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var a,l=i.text||"",c=i.x,u=i.y,d=i.options||{},m=i.mutex||{},p=m.pdfEscape,h=m.activeFontKey,y=m.fonts,g=h,w="",v=0,b="",_=y[g].encoding;if(y[g].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:m};for(b=l,g=h,Array.isArray(l)&&(b=l[0]),v=0;v<b.length;v+=1)y[g].metadata.hasOwnProperty("cmap")&&(a=y[g].metadata.cmap.unicode.codeMap[b[v].charCodeAt(0)]),a||b[v].charCodeAt(0)<256&&y[g].metadata.hasOwnProperty("Unicode")?w+=b[v]:w+="";var E="";return parseInt(g.slice(1))<14||_==="WinAnsiEncoding"?E=p(w,g).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(E=r(w,y[g])),m.isHex=!0,{text:E,x:c,y:u,options:d,mutex:m}};t.events.push(["postProcessText",function(i){var a=i.text||"",l=[],c={text:a,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(a)){var u=0;for(u=0;u<a.length;u+=1)Array.isArray(a[u])&&a[u].length===3?l.push([s(Object.assign({},c,{text:a[u][0]})).text,a[u][1],a[u][2]]):l.push(s(Object.assign({},c,{text:a[u]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:a})).text}])}(mt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(mt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,i,a,l,c,u,d,m=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,_=0;this.__bidiEngine__={};var E=function(j){var T=j.charCodeAt(),q=T>>8,U=g[q];return U!==void 0?m[256*U+(255&T)]:q===252||q===253?"AL":v.test(q)?"L":q===8?"R":"N"},D=function(j){for(var T,q=0;q<j.length;q++){if((T=E(j.charAt(q)))==="L")return!1;if(T==="R")return!0}return!1},I=function(j,T,q,U){var re,z,G,B,Y=T[U];switch(Y){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(Y="AN");break;case"AL":b=!0,Y="R";break;case"WS":Y="N";break;case"CS":U<1||U+1>=T.length||(re=q[U-1])!=="EN"&&re!=="AN"||(z=T[U+1])!=="EN"&&z!=="AN"?Y="N":b&&(z="AN"),Y=z===re?z:"N";break;case"ES":Y=(re=U>0?q[U-1]:"B")==="EN"&&U+1<T.length&&T[U+1]==="EN"?"EN":"N";break;case"ET":if(U>0&&q[U-1]==="EN"){Y="EN";break}if(b){Y="N";break}for(G=U+1,B=T.length;G<B&&T[G]==="ET";)G++;Y=G<B&&T[G]==="EN"?"EN":"N";break;case"NSM":if(a&&!l){for(B=T.length,G=U+1;G<B&&T[G]==="NSM";)G++;if(G<B){var se=j[U],me=se>=1425&&se<=2303||se===64286;if(re=T[G],me&&(re==="R"||re==="AL")){Y="R";break}}}Y=U<1||(re=T[U-1])==="B"?"N":q[U-1];break;case"B":b=!1,s=!0,Y=_;break;case"S":i=!0,Y="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":Y="N"}return Y},A=function(j,T,q){var U=j.split("");return q&&P(U,q,{hiLevel:_}),U.reverse(),T&&T.reverse(),U.join("")},P=function(j,T,q){var U,re,z,G,B,Y=-1,se=j.length,me=0,S=[],L=_?h:p,R=[];for(b=!1,s=!1,i=!1,re=0;re<se;re++)R[re]=E(j[re]);for(z=0;z<se;z++){if(B=me,S[z]=I(j,R,S,z),U=240&(me=L[B][y[S[z]]]),me&=15,T[z]=G=L[me][5],U>0)if(U===16){for(re=Y;re<z;re++)T[re]=1;Y=-1}else Y=-1;if(L[me][6])Y===-1&&(Y=z);else if(Y>-1){for(re=Y;re<z;re++)T[re]=G;Y=-1}R[z]==="B"&&(T[z]=0),q.hiLevel|=G}i&&function(O,V,ne){for(var ue=0;ue<ne;ue++)if(O[ue]==="S"){V[ue]=_;for(var fe=ue-1;fe>=0&&O[fe]==="WS";fe--)V[fe]=_}}(R,T,se)},C=function(j,T,q,U,re){if(!(re.hiLevel<j)){if(j===1&&_===1&&!s)return T.reverse(),void(q&&q.reverse());for(var z,G,B,Y,se=T.length,me=0;me<se;){if(U[me]>=j){for(B=me+1;B<se&&U[B]>=j;)B++;for(Y=me,G=B-1;Y<G;Y++,G--)z=T[Y],T[Y]=T[G],T[G]=z,q&&(z=q[Y],q[Y]=q[G],q[G]=z);me=B}me++}}},M=function(j,T,q){var U=j.split(""),re={hiLevel:_};return q||(q=[]),P(U,q,re),function(z,G,B){if(B.hiLevel!==0&&d)for(var Y,se=0;se<z.length;se++)G[se]===1&&(Y=w.indexOf(z[se]))>=0&&(z[se]=w[Y+1])}(U,q,re),C(2,U,T,q,re),C(1,U,T,q,re),U.join("")};return this.__bidiEngine__.doBidiReorder=function(j,T,q){if(function(re,z){if(z)for(var G=0;G<re.length;G++)z[G]=G;l===void 0&&(l=D(re)),u===void 0&&(u=D(re))}(j,T),a||!c||u)if(a&&c&&l^u)_=l?1:0,j=A(j,T,q);else if(!a&&c&&u)_=l?1:0,j=M(j,T,q),j=A(j,T);else if(!a||l||c||u){if(a&&!c&&l^u)j=A(j,T),l?(_=0,j=M(j,T,q)):(_=1,j=M(j,T,q),j=A(j,T));else if(a&&l&&!c&&u)_=1,j=M(j,T,q),j=A(j,T);else if(!a&&!c&&l^u){var U=d;l?(_=1,j=M(j,T,q),_=0,d=!1,j=M(j,T,q),d=U):(_=0,j=M(j,T,q),j=A(j,T),_=1,d=!1,j=M(j,T,q),d=U,j=A(j,T))}}else _=0,j=M(j,T,q);else _=l?1:0,j=M(j,T,q);return j},this.__bidiEngine__.setOptions=function(j){j&&(a=j.isInputVisual,c=j.isOutputVisual,l=j.isInputRtl,u=j.isOutputRtl,d=j.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text,i=(n.x,n.y,n.options||{}),a=(n.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(a=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?a.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):a.push([r.doBidiReorder(s[l])]);n.text=a}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(mt),mt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Lo(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new l7(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new YC(this.contents),this.head=new XC(this),this.name=new t7(this),this.cmap=new I_(this),this.toUnicode={},this.hhea=new JC(this),this.maxp=new r7(this),this.hmtx=new n7(this),this.post=new ZC(this),this.os2=new QC(this),this.loca=new o7(this),this.glyf=new s7(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,l,c,u;for(u=[],a=0,l=(c=this.bbox).length;a<l;a++)t=c[a],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,i,a,l;for(a=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=t.charCodeAt(i),a+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return a*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Fi,Lo=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,i,a,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),a=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^a)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*i+65536*a+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,i;for(i=[],n=0,s=t.length;n<s;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),YC=function(){var e;function t(r){var n,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,i,a,l,c,u,d,m,p,h,y,g;for(g in h=Object.keys(r).length,c=Math.log(2),m=16*Math.floor(Math.log(h)/c),a=Math.floor(m/c),d=16*h-m,(s=new Lo).writeInt(this.scalarType),s.writeShort(h),s.writeShort(m),s.writeShort(a),s.writeShort(d),i=16*h,u=s.pos+i,l=null,y=[],r)for(p=r[g],s.writeString(g),s.writeInt(e(p)),s.writeInt(u),s.writeInt(p.length),y=y.concat(p),g==="head"&&(l=u),u+=p.length;u%4;)y.push(0),u++;return s.write(y),n=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(n),s.data},e=function(r){var n,s,i,a;for(r=R_.call(r);r.length%4;)r.push(0);for(i=new Lo(r),s=0,n=0,a=r.length;n<a;n=n+=4)s+=i.readUInt32();return 4294967295&s},t}(),KC={}.hasOwnProperty,ta=function(e,t){for(var r in t)KC.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Fi=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var XC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new Lo).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),d5=function(){function e(t,r){var n,s,i,a,l,c,u,d,m,p,h,y,g,w,v,b,_;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),m=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,i=function(){var E,D;for(D=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)D.push(t.readUInt16());return D}(),t.pos+=2,g=function(){var E,D;for(D=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)D.push(t.readUInt16());return D}(),u=function(){var E,D;for(D=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)D.push(t.readUInt16());return D}(),d=function(){var E,D;for(D=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)D.push(t.readUInt16());return D}(),s=(this.length-t.pos+this.offset)/2,l=function(){var E,D;for(D=[],c=E=0;0<=s?E<s:E>s;c=0<=s?++E:--E)D.push(t.readUInt16());return D}(),c=v=0,_=i.length;v<_;c=++v)for(w=i[c],n=b=y=g[c];y<=w?b<=w:b>=w;n=y<=w?++b:--b)d[c]===0?a=n+u[c]:(a=l[d[c]/2+(n-y)-(p-c)]||0)!==0&&(a+=u[c]),this.codeMap[n]=65535&a}t.pos=m}return e.encode=function(t,r){var n,s,i,a,l,c,u,d,m,p,h,y,g,w,v,b,_,E,D,I,A,P,C,M,j,T,q,U,re,z,G,B,Y,se,me,S,L,R,O,V,ne,ue,fe,ye,pe,_e;switch(U=new Lo,a=Object.keys(t).sort(function(Ue,Ve){return Ue-Ve}),r){case"macroman":for(g=0,w=function(){var Ue=[];for(y=0;y<256;++y)Ue.push(0);return Ue}(),b={0:0},i={},re=0,Y=a.length;re<Y;re++)b[fe=t[s=a[re]]]==null&&(b[fe]=++g),i[s]={old:t[s],new:b[t[s]]},w[s]=b[t[s]];return U.writeUInt16(1),U.writeUInt16(0),U.writeUInt32(12),U.writeUInt16(0),U.writeUInt16(262),U.writeUInt16(0),U.write(w),{charMap:i,subtable:U.data,maxGlyphID:g+1};case"unicode":for(T=[],m=[],_=0,b={},n={},v=u=null,z=0,se=a.length;z<se;z++)b[D=t[s=a[z]]]==null&&(b[D]=++_),n[s]={old:D,new:b[D]},l=b[D]-s,v!=null&&l===u||(v&&m.push(v),T.push(s),u=l),v=s;for(v&&m.push(v),m.push(65535),T.push(65535),M=2*(C=T.length),P=2*Math.pow(Math.log(C)/Math.LN2,2),p=Math.log(P/2)/Math.LN2,A=2*C-P,c=[],I=[],h=[],y=G=0,me=T.length;G<me;y=++G){if(j=T[y],d=m[y],j===65535){c.push(0),I.push(0);break}if(j-(q=n[j].new)>=32768)for(c.push(0),I.push(2*(h.length+C-y)),s=B=j;j<=d?B<=d:B>=d;s=j<=d?++B:--B)h.push(n[s].new);else c.push(q-j),I.push(0)}for(U.writeUInt16(3),U.writeUInt16(1),U.writeUInt32(12),U.writeUInt16(4),U.writeUInt16(16+8*C+2*h.length),U.writeUInt16(0),U.writeUInt16(M),U.writeUInt16(P),U.writeUInt16(p),U.writeUInt16(A),ne=0,S=m.length;ne<S;ne++)s=m[ne],U.writeUInt16(s);for(U.writeUInt16(0),ue=0,L=T.length;ue<L;ue++)s=T[ue],U.writeUInt16(s);for(ye=0,R=c.length;ye<R;ye++)l=c[ye],U.writeUInt16(l);for(pe=0,O=I.length;pe<O;pe++)E=I[pe],U.writeUInt16(E);for(_e=0,V=h.length;_e<V;_e++)g=h[_e],U.writeUInt16(g);return{charMap:n,subtable:U.data,maxGlyphID:_+1}}},e}(),I_=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,s,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)n=new d5(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var s,i;return n==null&&(n="macroman"),s=d5.encode(r,n),(i=new Lo).writeUInt16(0),i.writeUInt16(1),s.table=i.data.concat(s.subtable),s},t}(),JC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),QC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(r.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(r.readInt());return s}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(r.readInt());return s}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),ZC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="post",t.prototype.parse=function(r){var n,s,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var a;for(s=r.readUInt16(),this.glyphNameIndex=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var l,c,u;for(u=[],a=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;a=0<=c?++l:--l)u.push(r.readUInt32());return u}).call(this)}},t}(),e7=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},t7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="name",t.prototype.parse=function(r){var n,s,i,a,l,c,u,d,m,p,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),s=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},a=m=0,p=s.length;m<p;a=++m)i=s[a],r.pos=i.offset,d=r.readString(i.length),l=new e7(d,i),u[h=i.nameID]==null&&(u[h]=[]),u[i.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t}(),r7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),n7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,s,i,a,l,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,m;for(m=[],n=d=0;0<=i?d<i:d>i;n=0<=i?++d:--d)m.push(r.readInt16());return m}(),this.widths=(function(){var d,m,p,h;for(h=[],d=0,m=(p=this.metrics).length;d<m;d++)a=p[d],h.push(a.advance);return h}).call(this),s=this.widths[this.widths.length-1],u=[],n=l=0;0<=i?l<i:l>i;n=0<=i?++l:--l)u.push(this.widths.push(s));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),R_=[].slice,s7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,s,i,a,l,c,u,d,m,p;return r in this.cache?this.cache[r]:(a=this.file.loca,n=this.file.contents,s=a.indexOf(r),(i=a.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+s,l=(c=new Lo(n.read(i))).readShort(),d=c.readShort(),p=c.readShort(),u=c.readShort(),m=c.readShort(),this.cache[r]=l===-1?new a7(c,d,p,u,m):new i7(c,l,d,p,u,m),this.cache[r]))},t.prototype.encode=function(r,n,s){var i,a,l,c,u;for(l=[],a=[],c=0,u=n.length;c<u;c++)i=r[n[c]],a.push(l.length),i&&(l=l.concat(i.encode(s)));return a.push(l.length),{table:l,offsets:a}},t}(),i7=function(){function e(t,r,n,s,i,a){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=a,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),a7=function(){function e(t,r,n,s,i){var a,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;l=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&l;)a.pos+=1&l?4:2,128&l?a.pos+=8:64&l?a.pos+=4:8&l&&(a.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Lo(R_.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),o7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Fi),t.prototype.tag="loca",t.prototype.parse=function(r){var n,s;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,a;for(a=[],s=0,i=this.length;s<i;s+=2)a.push(2*r.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],s=0,i=this.length;s<i;s+=4)a.push(r.readUInt32());return a}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var s=new Uint32Array(this.offsets.length),i=0,a=0,l=0;l<s.length;++l)if(s[l]=i,a<n.length&&n[a]==l){++a,s[l]=i;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(i+=u)}for(var d=new Array(4*s.length),m=0;m<s.length;++m)d[4*m+3]=255&s[m],d[4*m+2]=(65280&s[m])>>8,d[4*m+1]=(16711680&s[m])>>16,d[4*m]=(4278190080&s[m])>>24;return d},t}(),l7=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,i;for(r in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,i,a,l,c;for(s={},a=0,l=t.length;a<l;a++)s[i=t[a]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(n=s[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],s[i]=n;return s},e.prototype.encode=function(t,r){var n,s,i,a,l,c,u,d,m,p,h,y,g,w,v;for(s in n=I_.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),h={0:0},v=n.charMap)h[(c=v[s]).old]=c.new;for(y in p=n.maxGlyphID,a)y in h||(h[y]=p++);return d=function(b){var _,E;for(_ in E={},b)E[b[_]]=_;return E}(h),m=Object.keys(d).sort(function(b,_){return b-_}),g=function(){var b,_,E;for(E=[],b=0,_=m.length;b<_;b++)l=m[b],E.push(d[l]);return E}(),i=this.font.glyf.encode(a,g,h),u=this.font.loca.encode(i.offsets,g),w={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},e}();mt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,i,a;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)a=r[s],i.push("/"+s+" "+t.convert(a));return i.push(">>"),i.join(`
`)}return""+r},t}();const c7=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:UC,AcroFormAppearance:ut,AcroFormButton:ln,AcroFormCheckBox:Fd,AcroFormChoiceField:gl,AcroFormComboBox:vl,AcroFormEditBox:Pd,AcroFormListBox:xl,AcroFormPasswordField:Od,AcroFormPushButton:Ld,AcroFormRadioButton:yl,AcroFormTextField:ko,GState:df,ShadingPattern:ao,TilingPattern:dl,default:mt,jsPDF:mt},Symbol.toStringTag,{value:"Module"}));var M_={exports:{}};const u7=rw(c7);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(n,s){e.exports=s(function(){try{return u7}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Xn<"u"?Xn:typeof window<"u"?window:typeof self<"u"?self:Xn,function(r){return function(){var n={172:function(l,c){var u=this&&this.__extends||function(){var p=function(h,y){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,w){g.__proto__=w}||function(g,w){for(var v in w)Object.prototype.hasOwnProperty.call(w,v)&&(g[v]=w[v])},p(h,y)};return function(h,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");p(h,y);function g(){this.constructor=h}h.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.CellHookData=c.HookData=void 0;var d=function(){function p(h,y,g){this.table=y,this.pageNumber=y.pageNumber,this.pageCount=this.pageNumber,this.settings=y.settings,this.cursor=g,this.doc=h.getDocument()}return p}();c.HookData=d;var m=function(p){u(h,p);function h(y,g,w,v,b,_){var E=p.call(this,y,g,_)||this;return E.cell=w,E.row=v,E.column=b,E.section=v.section,E}return h}(d);c.CellHookData=m},340:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0});var d=u(4),m=u(136),p=u(744),h=u(776),y=u(664),g=u(972);function w(v){v.API.autoTable=function(){for(var b=[],_=0;_<arguments.length;_++)b[_]=arguments[_];var E;b.length===1?E=b[0]:(console.error("Use of deprecated autoTable initiation"),E=b[2]||{},E.columns=b[0],E.body=b[1]);var D=(0,h.parseInput)(this,E),I=(0,g.createTable)(this,D);return(0,y.drawTable)(this,I),this},v.API.lastAutoTable=!1,v.API.previousAutoTable=!1,v.API.autoTable.previous=!1,v.API.autoTableText=function(b,_,E,D){(0,m.default)(b,_,E,D,this)},v.API.autoTableSetDefaults=function(b){return p.DocHandler.setDefaults(b,this),this},v.autoTableSetDefaults=function(b,_){p.DocHandler.setDefaults(b,_)},v.API.autoTableHtmlToJson=function(b,_){var E;if(_===void 0&&(_=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var D=new p.DocHandler(this),I=(0,d.parseHtml)(D,b,window,_,!1),A=I.head,P=I.body,C=((E=A[0])===null||E===void 0?void 0:E.map(function(M){return M.content}))||[];return{columns:C,rows:P,data:P}},v.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var b=this.lastAutoTable;return b&&b.finalY?b.finalY:0},v.API.autoTableAddPageContent=function(b){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),v.API.autoTable.globalDefaults||(v.API.autoTable.globalDefaults={}),v.API.autoTable.globalDefaults.addPageContent=b,this},v.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}c.default=w},136:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function u(d,m,p,h,y){h=h||{};var g=1.15,w=y.internal.scaleFactor,v=y.internal.getFontSize()/w,b=y.getLineHeightFactor?y.getLineHeightFactor():g,_=v*b,E=/\r\n|\r|\n/g,D="",I=1;if((h.valign==="middle"||h.valign==="bottom"||h.halign==="center"||h.halign==="right")&&(D=typeof d=="string"?d.split(E):d,I=D.length||1),p+=v*(2-g),h.valign==="middle"?p-=I/2*_:h.valign==="bottom"&&(p-=I*_),h.halign==="center"||h.halign==="right"){var A=v;if(h.halign==="center"&&(A*=.5),D&&I>=1){for(var P=0;P<D.length;P++)y.text(D[P],m-y.getStringUnitWidth(D[P])*A,p),p+=_;return y}m-=y.getStringUnitWidth(d)*A}return h.halign==="justify"?y.text(d,m,p,{maxWidth:h.maxWidth||100,align:"justify"}):y.text(d,m,p),y}c.default=u},420:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.getPageAvailableWidth=c.parseSpacing=c.getFillStyle=c.addTableBorder=c.getStringWidth=void 0;function u(y,g,w){w.applyStyles(g,!0);var v=Array.isArray(y)?y:[y],b=v.map(function(_){return w.getTextWidth(_)}).reduce(function(_,E){return Math.max(_,E)},0);return b}c.getStringWidth=u;function d(y,g,w,v){var b=g.settings.tableLineWidth,_=g.settings.tableLineColor;y.applyStyles({lineWidth:b,lineColor:_});var E=m(b,!1);E&&y.rect(w.x,w.y,g.getWidth(y.pageSize().width),v.y-w.y,E)}c.addTableBorder=d;function m(y,g){var w=y>0,v=g||g===0;return w&&v?"DF":w?"S":v?"F":null}c.getFillStyle=m;function p(y,g){var w,v,b,_;if(y=y||g,Array.isArray(y)){if(y.length>=4)return{top:y[0],right:y[1],bottom:y[2],left:y[3]};if(y.length===3)return{top:y[0],right:y[1],bottom:y[2],left:y[1]};if(y.length===2)return{top:y[0],right:y[1],bottom:y[0],left:y[1]};y.length===1?y=y[0]:y=g}return typeof y=="object"?(typeof y.vertical=="number"&&(y.top=y.vertical,y.bottom=y.vertical),typeof y.horizontal=="number"&&(y.right=y.horizontal,y.left=y.horizontal),{left:(w=y.left)!==null&&w!==void 0?w:g,top:(v=y.top)!==null&&v!==void 0?v:g,right:(b=y.right)!==null&&b!==void 0?b:g,bottom:(_=y.bottom)!==null&&_!==void 0?_:g}):(typeof y!="number"&&(y=g),{top:y,right:y,bottom:y,left:y})}c.parseSpacing=p;function h(y,g){var w=p(g.settings.margin,0);return y.pageSize().width-(w.left+w.right)}c.getPageAvailableWidth=h},796:function(l,c){var u=this&&this.__extends||function(){var h=function(y,g){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,v){w.__proto__=v}||function(w,v){for(var b in v)Object.prototype.hasOwnProperty.call(v,b)&&(w[b]=v[b])},h(y,g)};return function(y,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");h(y,g);function w(){this.constructor=y}y.prototype=g===null?Object.create(g):(w.prototype=g.prototype,new w)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.getTheme=c.defaultStyles=c.HtmlRowInput=void 0;var d=function(h){u(y,h);function y(g){var w=h.call(this)||this;return w._element=g,w}return y}(Array);c.HtmlRowInput=d;function m(h){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/h,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}c.defaultStyles=m;function p(h){var y={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return y[h]}c.getTheme=p},903:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.parseCss=void 0;var d=u(420);function m(w,v,b,_,E){var D={},I=1.3333333333333333,A=h(v,function(Y){return E.getComputedStyle(Y).backgroundColor});A!=null&&(D.fillColor=A);var P=h(v,function(Y){return E.getComputedStyle(Y).color});P!=null&&(D.textColor=P);var C=g(_,b);C&&(D.cellPadding=C);var M="borderTopColor",j=I*b,T=_.borderTopWidth;if(_.borderBottomWidth===T&&_.borderRightWidth===T&&_.borderLeftWidth===T){var q=(parseFloat(T)||0)/j;q&&(D.lineWidth=q)}else D.lineWidth={top:(parseFloat(_.borderTopWidth)||0)/j,right:(parseFloat(_.borderRightWidth)||0)/j,bottom:(parseFloat(_.borderBottomWidth)||0)/j,left:(parseFloat(_.borderLeftWidth)||0)/j},D.lineWidth.top||(D.lineWidth.right?M="borderRightColor":D.lineWidth.bottom?M="borderBottomColor":D.lineWidth.left&&(M="borderLeftColor"));var U=h(v,function(Y){return E.getComputedStyle(Y)[M]});U!=null&&(D.lineColor=U);var re=["left","right","center","justify"];re.indexOf(_.textAlign)!==-1&&(D.halign=_.textAlign),re=["middle","bottom","top"],re.indexOf(_.verticalAlign)!==-1&&(D.valign=_.verticalAlign);var z=parseInt(_.fontSize||"");isNaN(z)||(D.fontSize=z/I);var G=p(_);G&&(D.fontStyle=G);var B=(_.fontFamily||"").toLowerCase();return w.indexOf(B)!==-1&&(D.font=B),D}c.parseCss=m;function p(w){var v="";return(w.fontWeight==="bold"||w.fontWeight==="bolder"||parseInt(w.fontWeight)>=700)&&(v="bold"),(w.fontStyle==="italic"||w.fontStyle==="oblique")&&(v+="italic"),v}function h(w,v){var b=y(w,v);if(!b)return null;var _=b.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!_||!Array.isArray(_))return null;var E=[parseInt(_[1]),parseInt(_[2]),parseInt(_[3])],D=parseInt(_[4]);return D===0||isNaN(E[0])||isNaN(E[1])||isNaN(E[2])?null:E}function y(w,v){var b=v(w);return b==="rgba(0, 0, 0, 0)"||b==="transparent"||b==="initial"||b==="inherit"?w.parentElement==null?null:y(w.parentElement,v):b}function g(w,v){var b=[w.paddingTop,w.paddingRight,w.paddingBottom,w.paddingLeft],_=96/(72/v),E=(parseInt(w.lineHeight)-parseInt(w.fontSize))/v/2,D=b.map(function(A){return parseInt(A||"0")/_}),I=(0,d.parseSpacing)(D,0);return E>I.top&&(I.top=E),E>I.bottom&&(I.bottom=E),I}},744:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.DocHandler=void 0;var u={},d=function(){function m(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return m.setDefaults=function(p,h){h===void 0&&(h=null),h?h.__autoTableDocumentDefaults=p:u=p},m.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},m.prototype.applyStyles=function(p,h){var y,g,w;h===void 0&&(h=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var v=this.jsPDFDocument.internal.getFont(),b=v.fontStyle,_=v.fontName;if(p.font&&(_=p.font),p.fontStyle){b=p.fontStyle;var E=this.getFontList()[_];E&&E.indexOf(b)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(E[0]),b=E[0])}if(this.jsPDFDocument.setFont(_,b),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!h){var D=m.unifyColor(p.fillColor);D&&(y=this.jsPDFDocument).setFillColor.apply(y,D),D=m.unifyColor(p.textColor),D&&(g=this.jsPDFDocument).setTextColor.apply(g,D),D=m.unifyColor(p.lineColor),D&&(w=this.jsPDFDocument).setDrawColor.apply(w,D),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},m.prototype.splitTextToSize=function(p,h,y){return this.jsPDFDocument.splitTextToSize(p,h,y)},m.prototype.rect=function(p,h,y,g,w){return this.jsPDFDocument.rect(p,h,y,g,w)},m.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},m.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},m.prototype.getDocument=function(){return this.jsPDFDocument},m.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},m.prototype.addPage=function(){return this.jsPDFDocument.addPage()},m.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},m.prototype.getGlobalOptions=function(){return u||{}},m.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},m.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},m.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},m.prototype.getLineHeightFactor=function(){var p=this.jsPDFDocument;return p.getLineHeightFactor?p.getLineHeightFactor():1.15},m.prototype.getLineHeight=function(p){return p/this.scaleFactor()*this.getLineHeightFactor()},m.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},m}();c.DocHandler=d},4:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.parseHtml=void 0;var d=u(903),m=u(796);function p(g,w,v,b,_){var E,D;b===void 0&&(b=!1),_===void 0&&(_=!1);var I;typeof w=="string"?I=v.document.querySelector(w):I=w;var A=Object.keys(g.getFontList()),P=g.scaleFactor(),C=[],M=[],j=[];if(!I)return console.error("Html table could not be found with input: ",w),{head:C,body:M,foot:j};for(var T=0;T<I.rows.length;T++){var q=I.rows[T],U=(D=(E=q==null?void 0:q.parentElement)===null||E===void 0?void 0:E.tagName)===null||D===void 0?void 0:D.toLowerCase(),re=h(A,P,v,q,b,_);re&&(U==="thead"?C.push(re):U==="tfoot"?j.push(re):M.push(re))}return{head:C,body:M,foot:j}}c.parseHtml=p;function h(g,w,v,b,_,E){for(var D=new m.HtmlRowInput(b),I=0;I<b.cells.length;I++){var A=b.cells[I],P=v.getComputedStyle(A);if(_||P.display!=="none"){var C=void 0;E&&(C=(0,d.parseCss)(g,A,w,P,v)),D.push({rowSpan:A.rowSpan,colSpan:A.colSpan,styles:C,_element:A,content:y(A)})}}var M=v.getComputedStyle(b);if(D.length>0&&(_||M.display!=="none"))return D}function y(g){var w=g.cloneNode(!0);return w.innerHTML=w.innerHTML.replace(/\n/g,"").replace(/ +/g," "),w.innerHTML=w.innerHTML.split(/<br.*?>/).map(function(v){return v.trim()}).join(`
`),w.innerText||w.textContent||""}},776:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.parseInput=void 0;var d=u(4),m=u(356),p=u(420),h=u(744),y=u(792);function g(I,A){var P=new h.DocHandler(I),C=P.getDocumentOptions(),M=P.getGlobalOptions();(0,y.default)(P,M,C,A);var j=(0,m.assign)({},M,C,A),T;typeof window<"u"&&(T=window);var q=w(M,C,A),U=v(M,C,A),re=b(P,j),z=E(P,j,T);return{id:A.tableId,content:z,hooks:U,styles:q,settings:re}}c.parseInput=g;function w(I,A,P){for(var C={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},M=function(U){if(U==="columnStyles"){var re=I[U],z=A[U],G=P[U];C.columnStyles=(0,m.assign)({},re,z,G)}else{var B=[I,A,P],Y=B.map(function(se){return se[U]||{}});C[U]=(0,m.assign)({},Y[0],Y[1],Y[2])}},j=0,T=Object.keys(C);j<T.length;j++){var q=T[j];M(q)}return C}function v(I,A,P){for(var C=[I,A,P],M={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},j=0,T=C;j<T.length;j++){var q=T[j];q.didParseCell&&M.didParseCell.push(q.didParseCell),q.willDrawCell&&M.willDrawCell.push(q.willDrawCell),q.didDrawCell&&M.didDrawCell.push(q.didDrawCell),q.willDrawPage&&M.willDrawPage.push(q.willDrawPage),q.didDrawPage&&M.didDrawPage.push(q.didDrawPage)}return M}function b(I,A){var P,C,M,j,T,q,U,re,z,G,B,Y,se=(0,p.parseSpacing)(A.margin,40/I.scaleFactor()),me=(P=_(I,A.startY))!==null&&P!==void 0?P:se.top,S;A.showFoot===!0?S="everyPage":A.showFoot===!1?S="never":S=(C=A.showFoot)!==null&&C!==void 0?C:"everyPage";var L;A.showHead===!0?L="everyPage":A.showHead===!1?L="never":L=(M=A.showHead)!==null&&M!==void 0?M:"everyPage";var R=(j=A.useCss)!==null&&j!==void 0?j:!1,O=A.theme||(R?"plain":"striped"),V=!!A.horizontalPageBreak,ne=(T=A.horizontalPageBreakRepeat)!==null&&T!==void 0?T:null;return{includeHiddenHtml:(q=A.includeHiddenHtml)!==null&&q!==void 0?q:!1,useCss:R,theme:O,startY:me,margin:se,pageBreak:(U=A.pageBreak)!==null&&U!==void 0?U:"auto",rowPageBreak:(re=A.rowPageBreak)!==null&&re!==void 0?re:"auto",tableWidth:(z=A.tableWidth)!==null&&z!==void 0?z:"auto",showHead:L,showFoot:S,tableLineWidth:(G=A.tableLineWidth)!==null&&G!==void 0?G:0,tableLineColor:(B=A.tableLineColor)!==null&&B!==void 0?B:200,horizontalPageBreak:V,horizontalPageBreakRepeat:ne,horizontalPageBreakBehaviour:(Y=A.horizontalPageBreakBehaviour)!==null&&Y!==void 0?Y:"afterAllRows"}}function _(I,A){var P=I.getLastAutoTable(),C=I.scaleFactor(),M=I.pageNumber(),j=!1;if(P&&P.startPageNumber){var T=P.startPageNumber+P.pageNumber-1;j=T===M}return typeof A=="number"?A:(A==null||A===!1)&&j&&(P==null?void 0:P.finalY)!=null?P.finalY+20/C:null}function E(I,A,P){var C=A.head||[],M=A.body||[],j=A.foot||[];if(A.html){var T=A.includeHiddenHtml;if(P){var q=(0,d.parseHtml)(I,A.html,P,T,A.useCss)||{};C=q.head||C,M=q.body||C,j=q.foot||C}else console.error("Cannot parse html in non browser environment")}var U=A.columns||D(C,M,j);return{columns:U,head:C,body:M,foot:j}}function D(I,A,P){var C=I[0]||A[0]||P[0]||[],M=[];return Object.keys(C).filter(function(j){return j!=="_element"}).forEach(function(j){var T=1,q;Array.isArray(C)?q=C[parseInt(j)]:q=C[j],typeof q=="object"&&!Array.isArray(q)&&(T=(q==null?void 0:q.colSpan)||1);for(var U=0;U<T;U++){var re=void 0;Array.isArray(C)?re=M.length:re=j+(U>0?"_".concat(U):"");var z={dataKey:re};M.push(z)}}),M}},792:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function u(m,p,h,y){for(var g=function(_){_&&typeof _!="object"&&console.error("The options parameter should be of type object, is: "+typeof _),typeof _.extendWidth<"u"&&(_.tableWidth=_.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof _.margins<"u"&&(typeof _.margin>"u"&&(_.margin=_.margins),console.error("Use of deprecated option: margins, use margin instead.")),_.startY&&typeof _.startY!="number"&&(console.error("Invalid value for startY option",_.startY),delete _.startY),!_.didDrawPage&&(_.afterPageContent||_.beforePageContent||_.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),_.didDrawPage=function(j){m.applyStyles(m.userStyles),_.beforePageContent&&_.beforePageContent(j),m.applyStyles(m.userStyles),_.afterPageContent&&_.afterPageContent(j),m.applyStyles(m.userStyles),_.afterPageAdd&&j.pageNumber>1&&j.afterPageAdd(j),m.applyStyles(m.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(j){_[j]&&console.error('The "'.concat(j,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(j){var T=j[0],q=j[1];_[q]&&(console.error("Use of deprecated option ".concat(q,". Use ").concat(T," instead")),_[T]=_[q])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(j){var T=typeof j=="string"?j:j[0],q=typeof j=="string"?j:j[1];typeof _[T]<"u"&&(typeof _.styles[q]>"u"&&(_.styles[q]=_[T]),console.error("Use of deprecated option: "+T+", use the style "+q+" instead."))});for(var E=0,D=["styles","bodyStyles","headStyles","footStyles"];E<D.length;E++){var I=D[E];d(_[I]||{})}for(var A=_.columnStyles||{},P=0,C=Object.keys(A);P<C.length;P++){var M=C[P];d(A[M]||{})}},w=0,v=[p,h,y];w<v.length;w++){var b=v[w];g(b)}}c.default=u;function d(m){m.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),m.minCellHeight||(m.minCellHeight=m.rowHeight)):m.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),m.cellWidth||(m.cellWidth=m.columnWidth))}},260:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.Column=c.Cell=c.Row=c.Table=void 0;var d=u(796),m=u(172),p=u(420),h=function(){function v(b,_){this.pageNumber=1,this.pageCount=1,this.id=b.id,this.settings=b.settings,this.styles=b.styles,this.hooks=b.hooks,this.columns=_.columns,this.head=_.head,this.body=_.body,this.foot=_.foot}return v.prototype.getHeadHeight=function(b){return this.head.reduce(function(_,E){return _+E.getMaxCellHeight(b)},0)},v.prototype.getFootHeight=function(b){return this.foot.reduce(function(_,E){return _+E.getMaxCellHeight(b)},0)},v.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},v.prototype.callCellHooks=function(b,_,E,D,I,A){for(var P=0,C=_;P<C.length;P++){var M=C[P],j=new m.CellHookData(b,this,E,D,I,A),T=M(j)===!1;if(E.text=Array.isArray(E.text)?E.text:[E.text],T)return!1}return!0},v.prototype.callEndPageHooks=function(b,_){b.applyStyles(b.userStyles);for(var E=0,D=this.hooks.didDrawPage;E<D.length;E++){var I=D[E];I(new m.HookData(b,this,_))}},v.prototype.callWillDrawPageHooks=function(b,_){for(var E=0,D=this.hooks.willDrawPage;E<D.length;E++){var I=D[E];I(new m.HookData(b,this,_))}},v.prototype.getWidth=function(b){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var _=this.columns.reduce(function(D,I){return D+I.wrappedWidth},0);return _}else{var E=this.settings.margin;return b-E.left-E.right}},v}();c.Table=h;var y=function(){function v(b,_,E,D,I){I===void 0&&(I=!1),this.height=0,this.raw=b,b instanceof d.HtmlRowInput&&(this.raw=b._element,this.element=b._element),this.index=_,this.section=E,this.cells=D,this.spansMultiplePages=I}return v.prototype.getMaxCellHeight=function(b){var _=this;return b.reduce(function(E,D){var I;return Math.max(E,((I=_.cells[D.index])===null||I===void 0?void 0:I.height)||0)},0)},v.prototype.hasRowSpan=function(b){var _=this;return b.filter(function(E){var D=_.cells[E.index];return D?D.rowSpan>1:!1}).length>0},v.prototype.canEntireRowFit=function(b,_){return this.getMaxCellHeight(_)<=b},v.prototype.getMinimumRowHeight=function(b,_){var E=this;return b.reduce(function(D,I){var A=E.cells[I.index];if(!A)return 0;var P=_.getLineHeight(A.styles.fontSize),C=A.padding("vertical"),M=C+P;return M>D?M:D},0)},v}();c.Row=y;var g=function(){function v(b,_,E){var D,I;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=_,this.section=E,this.raw=b;var A=b;b!=null&&typeof b=="object"&&!Array.isArray(b)?(this.rowSpan=b.rowSpan||1,this.colSpan=b.colSpan||1,A=(I=(D=b.content)!==null&&D!==void 0?D:b.title)!==null&&I!==void 0?I:b,b._element&&(this.raw=b._element)):(this.rowSpan=1,this.colSpan=1);var P=A!=null?""+A:"",C=/\r\n|\r|\n/g;this.text=P.split(C)}return v.prototype.getTextPos=function(){var b;if(this.styles.valign==="top")b=this.y+this.padding("top");else if(this.styles.valign==="bottom")b=this.y+this.height-this.padding("bottom");else{var _=this.height-this.padding("vertical");b=this.y+_/2+this.padding("top")}var E;if(this.styles.halign==="right")E=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var D=this.width-this.padding("horizontal");E=this.x+D/2+this.padding("left")}else E=this.x+this.padding("left");return{x:E,y:b}},v.prototype.getContentHeight=function(b,_){_===void 0&&(_=1.15);var E=Array.isArray(this.text)?this.text.length:1,D=this.styles.fontSize/b*_,I=E*D+this.padding("vertical");return Math.max(I,this.styles.minCellHeight)},v.prototype.padding=function(b){var _=(0,p.parseSpacing)(this.styles.cellPadding,0);return b==="vertical"?_.top+_.bottom:b==="horizontal"?_.left+_.right:_[b]},v}();c.Cell=g;var w=function(){function v(b,_,E){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=b,this.raw=_,this.index=E}return v.prototype.getMaxCustomCellWidth=function(b){for(var _=0,E=0,D=b.allRows();E<D.length;E++){var I=D[E],A=I.cells[this.index];A&&typeof A.styles.cellWidth=="number"&&(_=Math.max(_,A.styles.cellWidth))}return _},v}();c.Column=w},356:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.assign=void 0;function u(d,m,p,h,y){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var g=Object(d),w=1;w<arguments.length;w++){var v=arguments[w];if(v!=null)for(var b in v)Object.prototype.hasOwnProperty.call(v,b)&&(g[b]=v[b])}return g}c.assign=u},972:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.createTable=void 0;var d=u(744),m=u(260),p=u(324),h=u(796),y=u(356);function g(I,A){var P=new d.DocHandler(I),C=w(A,P.scaleFactor()),M=new m.Table(A,C);return(0,p.calculateWidths)(P,M),P.applyStyles(P.userStyles),M}c.createTable=g;function w(I,A){var P=I.content,C=E(P.columns);if(P.head.length===0){var M=b(C,"head");M&&P.head.push(M)}if(P.foot.length===0){var M=b(C,"foot");M&&P.foot.push(M)}var j=I.settings.theme,T=I.styles;return{columns:C,head:v("head",P.head,C,T,j,A),body:v("body",P.body,C,T,j,A),foot:v("foot",P.foot,C,T,j,A)}}function v(I,A,P,C,M,j){var T={},q=A.map(function(U,re){for(var z=0,G={},B=0,Y=0,se=0,me=P;se<me.length;se++){var S=me[se];if(T[S.index]==null||T[S.index].left===0)if(Y===0){var L=void 0;Array.isArray(U)?L=U[S.index-B-z]:L=U[S.dataKey];var R={};typeof L=="object"&&!Array.isArray(L)&&(R=(L==null?void 0:L.styles)||{});var O=D(I,S,re,M,C,j,R),V=new m.Cell(L,O,I);G[S.dataKey]=V,G[S.index]=V,Y=V.colSpan-1,T[S.index]={left:V.rowSpan-1,times:Y}}else Y--,B++;else T[S.index].left--,Y=T[S.index].times,z++}return new m.Row(U,re,I,G)});return q}function b(I,A){var P={};return I.forEach(function(C){if(C.raw!=null){var M=_(A,C.raw);M!=null&&(P[C.dataKey]=M)}}),Object.keys(P).length>0?P:null}function _(I,A){if(I==="head"){if(typeof A=="object")return A.header||A.title||null;if(typeof A=="string"||typeof A=="number")return A}else if(I==="foot"&&typeof A=="object")return A.footer;return null}function E(I){return I.map(function(A,P){var C,M,j;return typeof A=="object"?j=(M=(C=A.dataKey)!==null&&C!==void 0?C:A.key)!==null&&M!==void 0?M:P:j=P,new m.Column(j,A,P)})}function D(I,A,P,C,M,j,T){var q=(0,h.getTheme)(C),U;I==="head"?U=M.headStyles:I==="body"?U=M.bodyStyles:I==="foot"&&(U=M.footStyles);var re=(0,y.assign)({},q.table,q[I],M.styles,U),z=M.columnStyles[A.dataKey]||M.columnStyles[A.index]||{},G=I==="body"?z:{},B=I==="body"&&P%2===0?(0,y.assign)({},q.alternateRow,M.alternateRowStyles):{},Y=(0,h.defaultStyles)(j),se=(0,y.assign)({},Y,re,B,G);return(0,y.assign)(se,T)}},664:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.addPage=c.drawTable=void 0;var d=u(420),m=u(260),p=u(744),h=u(356),y=u(136),g=u(224);function w(z,G){var B=G.settings,Y=B.startY,se=B.margin,me={x:se.left,y:Y},S=G.getHeadHeight(G.columns)+G.getFootHeight(G.columns),L=Y+se.bottom+S;if(B.pageBreak==="avoid"){var R=G.body,O=R.reduce(function(ue,fe){return ue+fe.height},0);L+=O}var V=new p.DocHandler(z);(B.pageBreak==="always"||B.startY!=null&&L>V.pageSize().height)&&(re(V),me.y=se.top),G.callWillDrawPageHooks(V,me);var ne=(0,h.assign)({},me);G.startPageNumber=V.pageNumber(),B.horizontalPageBreak?v(V,G,ne,me):(V.applyStyles(V.userStyles),(B.showHead==="firstPage"||B.showHead==="everyPage")&&G.head.forEach(function(ue){return M(V,G,ue,me,G.columns)}),V.applyStyles(V.userStyles),G.body.forEach(function(ue,fe){var ye=fe===G.body.length-1;C(V,G,ue,ye,ne,me,G.columns)}),V.applyStyles(V.userStyles),(B.showFoot==="lastPage"||B.showFoot==="everyPage")&&G.foot.forEach(function(ue){return M(V,G,ue,me,G.columns)})),(0,d.addTableBorder)(V,G,ne,me),G.callEndPageHooks(V,me),G.finalY=me.y,z.lastAutoTable=G,z.previousAutoTable=G,z.autoTable&&(z.autoTable.previous=G),V.applyStyles(V.userStyles)}c.drawTable=w;function v(z,G,B,Y){var se=(0,g.calculateAllColumnsCanFitInPage)(z,G),me=G.settings;if(me.horizontalPageBreakBehaviour==="afterAllRows")se.forEach(function(O,V){z.applyStyles(z.userStyles),V>0?U(z,G,B,Y,O.columns,!0):b(z,G,Y,O.columns),_(z,G,B,Y,O.columns),D(z,G,Y,O.columns)});else for(var S=-1,L=se[0],R=function(){var O=S;if(L){z.applyStyles(z.userStyles);var V=L.columns;S>=0?U(z,G,B,Y,V,!0):b(z,G,Y,V),O=E(z,G,S+1,Y,V),D(z,G,Y,V)}var ne=O-S;se.slice(1).forEach(function(ue){z.applyStyles(z.userStyles),U(z,G,B,Y,ue.columns,!0),E(z,G,S+1,Y,ue.columns,ne),D(z,G,Y,ue.columns)}),S=O};S<G.body.length-1;)R()}function b(z,G,B,Y){var se=G.settings;z.applyStyles(z.userStyles),(se.showHead==="firstPage"||se.showHead==="everyPage")&&G.head.forEach(function(me){return M(z,G,me,B,Y)})}function _(z,G,B,Y,se){z.applyStyles(z.userStyles),G.body.forEach(function(me,S){var L=S===G.body.length-1;C(z,G,me,L,B,Y,se)})}function E(z,G,B,Y,se,me){z.applyStyles(z.userStyles),me=me??G.body.length;var S=Math.min(B+me,G.body.length),L=-1;return G.body.slice(B,S).forEach(function(R,O){var V=B+O===G.body.length-1,ne=q(z,G,V,Y);R.canEntireRowFit(ne,se)&&(M(z,G,R,Y,se),L=B+O)}),L}function D(z,G,B,Y){var se=G.settings;z.applyStyles(z.userStyles),(se.showFoot==="lastPage"||se.showFoot==="everyPage")&&G.foot.forEach(function(me){return M(z,G,me,B,Y)})}function I(z,G,B){var Y=B.getLineHeight(z.styles.fontSize),se=z.padding("vertical"),me=Math.floor((G-se)/Y);return Math.max(0,me)}function A(z,G,B,Y){var se={};z.spansMultiplePages=!0,z.height=0;for(var me=0,S=0,L=B.columns;S<L.length;S++){var R=L[S],O=z.cells[R.index];if(O){Array.isArray(O.text)||(O.text=[O.text]);var V=new m.Cell(O.raw,O.styles,O.section);V=(0,h.assign)(V,O),V.text=[];var ne=I(O,G,Y);O.text.length>ne&&(V.text=O.text.splice(ne,O.text.length));var ue=Y.scaleFactor(),fe=Y.getLineHeightFactor();O.contentHeight=O.getContentHeight(ue,fe),O.contentHeight>=G&&(O.contentHeight=G,V.styles.minCellHeight-=G),O.contentHeight>z.height&&(z.height=O.contentHeight),V.contentHeight=V.getContentHeight(ue,fe),V.contentHeight>me&&(me=V.contentHeight),se[R.index]=V}}var ye=new m.Row(z.raw,-1,z.section,se,!0);ye.height=me;for(var pe=0,_e=B.columns;pe<_e.length;pe++){var R=_e[pe],V=ye.cells[R.index];V&&(V.height=ye.height);var O=z.cells[R.index];O&&(O.height=z.height)}return ye}function P(z,G,B,Y){var se=z.pageSize().height,me=Y.settings.margin,S=me.top+me.bottom,L=se-S;G.section==="body"&&(L-=Y.getHeadHeight(Y.columns)+Y.getFootHeight(Y.columns));var R=G.getMinimumRowHeight(Y.columns,z),O=R<B;if(R>L)return console.error("Will not be able to print row ".concat(G.index," correctly since it's minimum height is larger than page height")),!0;if(!O)return!1;var V=G.hasRowSpan(Y.columns),ne=G.getMaxCellHeight(Y.columns)>L;return ne?(V&&console.error("The content of row ".concat(G.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(V||Y.settings.rowPageBreak==="avoid")}function C(z,G,B,Y,se,me,S){var L=q(z,G,Y,me);if(B.canEntireRowFit(L,S))M(z,G,B,me,S);else if(P(z,B,L,G)){var R=A(B,L,G,z);M(z,G,B,me,S),U(z,G,se,me,S),C(z,G,R,Y,se,me,S)}else U(z,G,se,me,S),C(z,G,B,Y,se,me,S)}function M(z,G,B,Y,se){Y.x=G.settings.margin.left;for(var me=0,S=se;me<S.length;me++){var L=S[me],R=B.cells[L.index];if(!R){Y.x+=L.width;continue}z.applyStyles(R.styles),R.x=Y.x,R.y=Y.y;var O=G.callCellHooks(z,G.hooks.willDrawCell,R,B,L,Y);if(O===!1){Y.x+=L.width;continue}j(z,R,Y);var V=R.getTextPos();(0,y.default)(R.text,V.x,V.y,{halign:R.styles.halign,valign:R.styles.valign,maxWidth:Math.ceil(R.width-R.padding("left")-R.padding("right"))},z.getDocument()),G.callCellHooks(z,G.hooks.didDrawCell,R,B,L,Y),Y.x+=L.width}Y.y+=B.height}function j(z,G,B){var Y=G.styles;if(z.getDocument().setFillColor(z.getDocument().getFillColor()),typeof Y.lineWidth=="number"){var se=(0,d.getFillStyle)(Y.lineWidth,Y.fillColor);se&&z.rect(G.x,B.y,G.width,G.height,se)}else typeof Y.lineWidth=="object"&&(Y.fillColor&&z.rect(G.x,B.y,G.width,G.height,"F"),T(z,G,B,Y.lineWidth))}function T(z,G,B,Y){var se,me,S,L;Y.top&&(se=B.x,me=B.y,S=B.x+G.width,L=B.y,Y.right&&(S+=.5*Y.right),Y.left&&(se-=.5*Y.left),R(Y.top,se,me,S,L)),Y.bottom&&(se=B.x,me=B.y+G.height,S=B.x+G.width,L=B.y+G.height,Y.right&&(S+=.5*Y.right),Y.left&&(se-=.5*Y.left),R(Y.bottom,se,me,S,L)),Y.left&&(se=B.x,me=B.y,S=B.x,L=B.y+G.height,Y.top&&(me-=.5*Y.top),Y.bottom&&(L+=.5*Y.bottom),R(Y.left,se,me,S,L)),Y.right&&(se=B.x+G.width,me=B.y,S=B.x+G.width,L=B.y+G.height,Y.top&&(me-=.5*Y.top),Y.bottom&&(L+=.5*Y.bottom),R(Y.right,se,me,S,L));function R(O,V,ne,ue,fe){z.getDocument().setLineWidth(O),z.getDocument().line(V,ne,ue,fe,"S")}}function q(z,G,B,Y){var se=G.settings.margin.bottom,me=G.settings.showFoot;return(me==="everyPage"||me==="lastPage"&&B)&&(se+=G.getFootHeight(G.columns)),z.pageSize().height-Y.y-se}function U(z,G,B,Y,se,me){se===void 0&&(se=[]),me===void 0&&(me=!1),z.applyStyles(z.userStyles),G.settings.showFoot==="everyPage"&&!me&&G.foot.forEach(function(L){return M(z,G,L,Y,se)}),G.callEndPageHooks(z,Y);var S=G.settings.margin;(0,d.addTableBorder)(z,G,B,Y),re(z),G.pageNumber++,G.pageCount++,Y.x=S.left,Y.y=S.top,B.y=S.top,G.callWillDrawPageHooks(z,Y),G.settings.showHead==="everyPage"&&(G.head.forEach(function(L){return M(z,G,L,Y,se)}),z.applyStyles(z.userStyles))}c.addPage=U;function re(z){var G=z.pageNumber();z.setPage(G+1);var B=z.pageNumber();return B===G?(z.addPage(),!0):!1}},224:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.calculateAllColumnsCanFitInPage=void 0;var d=u(420);function m(h,y,g){var w;g===void 0&&(g={});var v=(0,d.getPageAvailableWidth)(h,y),b=new Map,_=[],E=[],D=[];y.settings.horizontalPageBreakRepeat,Array.isArray(y.settings.horizontalPageBreakRepeat)?D=y.settings.horizontalPageBreakRepeat:(typeof y.settings.horizontalPageBreakRepeat=="string"||typeof y.settings.horizontalPageBreakRepeat=="number")&&(D=[y.settings.horizontalPageBreakRepeat]),D.forEach(function(C){var M=y.columns.find(function(j){return j.dataKey===C||j.index===C});M&&!b.has(M.index)&&(b.set(M.index,!0),_.push(M.index),E.push(y.columns[M.index]),v-=M.wrappedWidth)});for(var I=!0,A=(w=g==null?void 0:g.start)!==null&&w!==void 0?w:0;A<y.columns.length;){if(b.has(A)){A++;continue}var P=y.columns[A].wrappedWidth;if(I||v>=P)I=!1,_.push(A),E.push(y.columns[A]),v-=P;else break;A++}return{colIndexes:_,columns:E,lastIndex:A-1}}function p(h,y){for(var g=[],w=0;w<y.columns.length;w++){var v=m(h,y,{start:w});v.columns.length&&(g.push(v),w=v.lastIndex)}return g}c.calculateAllColumnsCanFitInPage=p},324:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.ellipsize=c.resizeColumns=c.calculateWidths=void 0;var d=u(420);function m(_,E){p(_,E);var D=[],I=0;E.columns.forEach(function(P){var C=P.getMaxCustomCellWidth(E);C?P.width=C:(P.width=P.wrappedWidth,D.push(P)),I+=P.width});var A=E.getWidth(_.pageSize().width)-I;A&&(A=h(D,A,function(P){return Math.max(P.minReadableWidth,P.minWidth)})),A&&(A=h(D,A,function(P){return P.minWidth})),A=Math.abs(A),!E.settings.horizontalPageBreak&&A>.1/_.scaleFactor()&&(A=A<1?A:Math.round(A),console.warn("Of the table content, ".concat(A," units width could not fit page"))),g(E),w(E,_),y(E)}c.calculateWidths=m;function p(_,E){var D=_.scaleFactor(),I=E.settings.horizontalPageBreak,A=(0,d.getPageAvailableWidth)(_,E);E.allRows().forEach(function(P){for(var C=0,M=E.columns;C<M.length;C++){var j=M[C],T=P.cells[j.index];if(T){var q=E.hooks.didParseCell;E.callCellHooks(_,q,T,P,j,null);var U=T.padding("horizontal");T.contentWidth=(0,d.getStringWidth)(T.text,T.styles,_)+U;var re=(0,d.getStringWidth)(T.text.join(" ").split(/[^\S\u00A0]+/),T.styles,_);if(T.minReadableWidth=re+T.padding("horizontal"),typeof T.styles.cellWidth=="number")T.minWidth=T.styles.cellWidth,T.wrappedWidth=T.styles.cellWidth;else if(T.styles.cellWidth==="wrap"||I===!0)T.contentWidth>A?(T.minWidth=A,T.wrappedWidth=A):(T.minWidth=T.contentWidth,T.wrappedWidth=T.contentWidth);else{var z=10/D;T.minWidth=T.styles.minCellWidth||z,T.wrappedWidth=T.contentWidth,T.minWidth>T.wrappedWidth&&(T.wrappedWidth=T.minWidth)}}}}),E.allRows().forEach(function(P){for(var C=0,M=E.columns;C<M.length;C++){var j=M[C],T=P.cells[j.index];if(T&&T.colSpan===1)j.wrappedWidth=Math.max(j.wrappedWidth,T.wrappedWidth),j.minWidth=Math.max(j.minWidth,T.minWidth),j.minReadableWidth=Math.max(j.minReadableWidth,T.minReadableWidth);else{var q=E.styles.columnStyles[j.dataKey]||E.styles.columnStyles[j.index]||{},U=q.cellWidth||q.minCellWidth;U&&typeof U=="number"&&(j.minWidth=U,j.wrappedWidth=U)}T&&(T.colSpan>1&&!j.minWidth&&(j.minWidth=T.minWidth),T.colSpan>1&&!j.wrappedWidth&&(j.wrappedWidth=T.minWidth))}})}function h(_,E,D){for(var I=E,A=_.reduce(function(z,G){return z+G.wrappedWidth},0),P=0;P<_.length;P++){var C=_[P],M=C.wrappedWidth/A,j=I*M,T=C.width+j,q=D(C),U=T<q?q:T;E-=U-C.width,C.width=U}if(E=Math.round(E*1e10)/1e10,E){var re=_.filter(function(z){return E<0?z.width>D(z):!0});re.length&&(E=h(re,E,D))}return E}c.resizeColumns=h;function y(_){for(var E={},D=1,I=_.allRows(),A=0;A<I.length;A++)for(var P=I[A],C=0,M=_.columns;C<M.length;C++){var j=M[C],T=E[j.index];if(D>1)D--,delete P.cells[j.index];else if(T)T.cell.height+=P.height,D=T.cell.colSpan,delete P.cells[j.index],T.left--,T.left<=1&&delete E[j.index];else{var q=P.cells[j.index];if(!q)continue;if(q.height=P.height,q.rowSpan>1){var U=I.length-A,re=q.rowSpan>U?U:q.rowSpan;E[j.index]={cell:q,left:re,row:P}}}}}function g(_){for(var E=_.allRows(),D=0;D<E.length;D++)for(var I=E[D],A=null,P=0,C=0,M=0;M<_.columns.length;M++){var j=_.columns[M];if(C-=1,C>1&&_.columns[M+1])P+=j.width,delete I.cells[j.index];else if(A){var T=A;delete I.cells[j.index],A=null,T.width=j.width+P}else{var T=I.cells[j.index];if(!T)continue;if(C=T.colSpan,P=0,T.colSpan>1){A=T,P+=j.width;continue}T.width=j.width+P}}}function w(_,E){for(var D={count:0,height:0},I=0,A=_.allRows();I<A.length;I++){for(var P=A[I],C=0,M=_.columns;C<M.length;C++){var j=M[C],T=P.cells[j.index];if(T){E.applyStyles(T.styles,!0);var q=T.width-T.padding("horizontal");if(T.styles.overflow==="linebreak")T.text=E.splitTextToSize(T.text,q+1/E.scaleFactor(),{fontSize:T.styles.fontSize});else if(T.styles.overflow==="ellipsize")T.text=v(T.text,q,T.styles,E,"...");else if(T.styles.overflow==="hidden")T.text=v(T.text,q,T.styles,E,"");else if(typeof T.styles.overflow=="function"){var U=T.styles.overflow(T.text,q);typeof U=="string"?T.text=[U]:T.text=U}T.contentHeight=T.getContentHeight(E.scaleFactor(),E.getLineHeightFactor());var re=T.contentHeight/T.rowSpan;T.rowSpan>1&&D.count*D.height<re*T.rowSpan?D={height:re,count:T.rowSpan}:D&&D.count>0&&D.height>re&&(re=D.height),re>P.height&&(P.height=re)}}D.count--}}function v(_,E,D,I,A){return _.map(function(P){return b(P,E,D,I,A)})}c.ellipsize=v;function b(_,E,D,I,A){var P=1e4*I.scaleFactor();if(E=Math.ceil(E*P)/P,E>=(0,d.getStringWidth)(_,D,I))return _;for(;E<(0,d.getStringWidth)(_+A,D,I)&&!(_.length<=1);)_=_.substring(0,_.length-1);return _.trim()+A}},964:function(l){if(typeof r>"u"){var c=new Error("Cannot find module 'undefined'");throw c.code="MODULE_NOT_FOUND",c}l.exports=r}},s={};function i(l){var c=s[l];if(c!==void 0)return c.exports;var u=s[l]={exports:{}};return n[l].call(u.exports,u,u.exports,i),u.exports}var a={};return function(){var l=a;Object.defineProperty(l,"__esModule",{value:!0}),l.Cell=l.Column=l.Row=l.Table=l.CellHookData=l.__drawTable=l.__createTable=l.applyPlugin=void 0;var c=i(340),u=i(776),d=i(664),m=i(972),p=i(260);Object.defineProperty(l,"Table",{enumerable:!0,get:function(){return p.Table}});var h=i(172);Object.defineProperty(l,"CellHookData",{enumerable:!0,get:function(){return h.CellHookData}});var y=i(260);Object.defineProperty(l,"Cell",{enumerable:!0,get:function(){return y.Cell}}),Object.defineProperty(l,"Column",{enumerable:!0,get:function(){return y.Column}}),Object.defineProperty(l,"Row",{enumerable:!0,get:function(){return y.Row}});function g(E){(0,c.default)(E)}l.applyPlugin=g;function w(E,D){var I=(0,u.parseInput)(E,D),A=(0,m.createTable)(E,I);(0,d.drawTable)(E,A)}function v(E,D){var I=(0,u.parseInput)(E,D);return(0,m.createTable)(E,I)}l.__createTable=v;function b(E,D){(0,d.drawTable)(E,D)}l.__drawTable=b;try{var _=i(964);_.jsPDF&&(_=_.jsPDF),g(_)}catch{}l.default=w}(),a}()})})(M_);var d7=M_.exports;const gd=Qg(d7);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var q0={};q0.version="0.18.5";var B_=1252,f7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],U_=function(e){f7.indexOf(e)!=-1&&(B_=e)};function h7(){U_(1252)}var ff=function(e){U_(e)};function m7(){ff(1200),h7()}var Gh=function(t){return String.fromCharCode(t)},f5=function(t){return String.fromCharCode(t)},h5,fo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hf(e){for(var t="",r=0,n=0,s=0,i=0,a=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),a=(r&3)<<4|n>>4,s=e.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=fo.charAt(i)+fo.charAt(a)+fo.charAt(l)+fo.charAt(c);return t}function Ta(e){var t="",r=0,n=0,s=0,i=0,a=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=fo.indexOf(e.charAt(u++)),a=fo.indexOf(e.charAt(u++)),r=i<<2|a>>4,t+=String.fromCharCode(r),l=fo.indexOf(e.charAt(u++)),n=(a&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=fo.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),La=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Al(e){return Gt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function m5(e){return Gt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ki=function(t){return Gt?La(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Mm(e){if(typeof ArrayBuffer>"u")return ki(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Af(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function p7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Sn=Gt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:La(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function g7(e){for(var t=[],r=0,n=e.length+250,s=Al(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|l>>6&15|(a&3)<<4,s[r++]=128|l&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Al(65535),n=65530)}return t.push(s.slice(0,r)),Sn(t)}var Dd=/\u0000/g,Yh=/[\u0001-\u0006]/g;function Vc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ji(e,t){var r=""+e;return r.length>=t?r:Or("0",t-r.length)+r}function c2(e,t){var r=""+e;return r.length>=t?r:Or(" ",t-r.length)+r}function V0(e,t){var r=""+e;return r.length>=t?r:r+Or(" ",t-r.length)}function x7(e,t){var r=""+Math.round(e);return r.length>=t?r:Or("0",t-r.length)+r}function v7(e,t){var r=""+e;return r.length>=t?r:Or("0",t-r.length)+r}var p5=Math.pow(2,32);function xc(e,t){if(e>p5||e<-p5)return x7(e,t);var r=Math.round(e);return v7(r,t)}function G0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var g5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],y1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function y7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Dr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},x5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},w7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Y0(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,a=1,l=0,c=1,u=0,d=0,m=Math.floor(s);u<t&&(m=Math.floor(s),l=m*a+i,d=m*u+c,!(s-m<5e-8));)s=1/(s-m),i=a,a=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=i):(d=u,l=a)),!r)return[0,n*l,d];var p=Math.floor(n*l/d);return[p,n*l-p*d,d]}function Kh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,a=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=E7(c,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var z_=new Date(1899,11,31,0,0,0),b7=z_.getTime(),_7=new Date(1900,2,1,0,0,0);function W_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=_7&&(r+=24*60*60*1e3),(r-(b7+(e.getTimezoneOffset()-z_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function u2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function N7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function S7(e){var t=e<0?12:11,r=u2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function k7(e){var t=u2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function j7(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=S7(e):t===10?r=e.toFixed(10).substr(0,12):r=k7(e),u2(N7(r.toUpperCase()))}function Gg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):j7(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fo(14,W_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function E7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function A7(e,t,r,n){var s="",i=0,a=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return y1[r.m-1][1];case 5:return y1[r.m-1][0];default:return y1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return g5[r.q][0];default:return g5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ji(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),t==="s"?i===0?"0":""+i/a:(s=ji(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?ji(c,u):"";return d}function ho(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var H_=/%/g;function T7(e,t,r){var n=t.replace(H_,""),s=t.length-n.length;return wa(e,n,r*Math.pow(10,2*s))+Or("%",s)}function C7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function $_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+$_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var q_=/# (\?+)( ?)\/( ?)(\d+)/;function P7(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),a=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(a===0?Or(" ",e[1].length+1+e[4].length):c2(a,e[1].length)+e[2]+"/"+e[3]+ji(l,e[4].length))}function L7(e,t,r){return r+(t===0?"":""+t)+Or(" ",e[1].length+2+e[4].length)}var V_=/^#*0*\.([0#]+)/,G_=/\).*[0#]/,Y_=/\(###\) ###\\?-####/;function Yn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function v5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function y5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function F7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function O7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Xs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(G_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xs("n",n,r):"("+Xs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return C7(e,t,r);if(t.indexOf("%")!==-1)return T7(e,t,r);if(t.indexOf("E")!==-1)return $_(t,r);if(t.charCodeAt(0)===36)return"$"+Xs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+xc(c,t.length);if(t.match(/^[#?]+$/))return s=xc(r,0),s==="0"&&(s=""),s.length>t.length?s:Yn(t.substr(0,t.length-s.length))+s;if(i=t.match(q_))return P7(i,c,u);if(t.match(/^#+0+$/))return u+xc(c,t.length-t.indexOf("0"));if(i=t.match(V_))return s=v5(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Yn(i[1])).replace(/\.$/,"."+Yn(i[1])).replace(/\.(\d*)$/,function(y,g){return"."+g+Or("0",Yn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+v5(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ho(xc(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xs(e,t,-r):ho(""+(Math.floor(r)+F7(r,i[1].length)))+"."+ji(y5(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Xs(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Vc(Xs(e,t.replace(/[\\-]/g,""),r)),a=0,Vc(Vc(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<s.length?s.charAt(a++):y==="0"?"0":""}));if(t.match(Y_))return s=Xs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=Y0(c,Math.pow(10,a)-1,!1),s=""+u,d=wa("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=V0(l[2],a),d.length<i[4].length&&(d=Yn(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=Y0(c,Math.pow(10,a)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?c2(l[1],a)+i[2]+"/"+i[3]+V0(l[2],a):Or(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=xc(r,0),t.length<=s.length?s:Yn(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var m=t.indexOf(".")-a,p=t.length-s.length-m;return Yn(t.substr(0,m)+s+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return a=y5(r,i[1].length),r<0?"-"+Xs(e,t,-r):ho(O7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ji(0,3-y.length):"")+y})+"."+ji(a,i[1].length);switch(t){case"###,##0.00":return Xs(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ho(xc(c,0));return h!=="0"?u+h:"";case"###,###.00":return Xs(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Xs(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function D7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function I7(e,t,r){var n=t.replace(H_,""),s=t.length-n.length;return wa(e,n,r*Math.pow(10,2*s))+Or("%",s)}function K_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $i(e,t,r){if(e.charCodeAt(0)===40&&!t.match(G_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$i("n",n,r):"("+$i("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return D7(e,t,r);if(t.indexOf("%")!==-1)return I7(e,t,r);if(t.indexOf("E")!==-1)return K_(t,r);if(t.charCodeAt(0)===36)return"$"+$i(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ji(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Yn(t.substr(0,t.length-s.length))+s;if(i=t.match(q_))return L7(i,c,u);if(t.match(/^#+0+$/))return u+ji(c,t.length-t.indexOf("0"));if(i=t.match(V_))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Yn(i[1])).replace(/\.$/,"."+Yn(i[1])),s=s.replace(/\.(\d*)$/,function(y,g){return"."+g+Or("0",Yn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ho(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$i(e,t,-r):ho(""+r)+"."+Or("0",i[1].length);if(i=t.match(/^#,#*,#0/))return $i(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Vc($i(e,t.replace(/[\\-]/g,""),r)),a=0,Vc(Vc(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<s.length?s.charAt(a++):y==="0"?"0":""}));if(t.match(Y_))return s=$i(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=Y0(c,Math.pow(10,a)-1,!1),s=""+u,d=wa("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=V0(l[2],a),d.length<i[4].length&&(d=Yn(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=Y0(c,Math.pow(10,a)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?c2(l[1],a)+i[2]+"/"+i[3]+V0(l[2],a):Or(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Yn(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var m=t.indexOf(".")-a,p=t.length-s.length-m;return Yn(t.substr(0,m)+s+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$i(e,t,-r):ho(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ji(0,3-y.length):"")+y})+"."+ji(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ho(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return $i(e,t.slice(0,t.lastIndexOf(".")),r)+Yn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wa(e,t,r){return(r|0)===r?$i(e,t,r):Xs(e,t,r)}function R7(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var X_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function J_(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":G0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(X_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function M7(e,t,r,n){for(var s=[],i="",a=0,l="",c="t",u,d,m,p="H";a<e.length;)switch(l=e.charAt(a)){case"G":if(!G0(e,a))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(m=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(m);s[s.length]={t:"t",v:i},++a;break;case"\\":var h=e.charAt(++a),y=h==="("||h===")"?h:"t";s[s.length]={t:y,v:h},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(u==null&&(u=Kh(t,r,e.charAt(a+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(a,2)},c=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Kh(t,r),u==null))return"";for(i=l;++a<e.length&&e.charAt(a).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Kh(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",a+=5,p="h"):e.substr(a,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",a+=5,p="h"):(g.t="t",++a),u==null&&g.t==="T")return"";s[s.length]=g,c=l;break;case"[":for(i=l;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(X_)){if(u==null&&(u=Kh(t,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",J_(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++a<e.length&&(l=e.charAt(a))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++a<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(a))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++a)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++a;break}var w=0,v=0,b;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=p,c="h",w<1&&(w=1);break;case"s":(b=s[a].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[a].v.match(/[Hh]/)&&(w=1),w<2&&s[a].v.match(/[Mm]/)&&(w=2),w<3&&s[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",E;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=A7(s[a].t.charCodeAt(0),s[a].v,u,v),s[a].t="t";break;case"n":case"?":for(E=a+1;s[E]!=null&&((l=s[E].t)==="?"||l==="D"||(l===" "||l==="t")&&s[E+1]!=null&&(s[E+1].t==="?"||s[E+1].t==="t"&&s[E+1].v==="/")||s[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[E].v==="/"||s[E].v===" "&&s[E+1]!=null&&s[E+1].t=="?"));)s[a].v+=s[E].v,s[E]={v:"",t:";"},++E;_+=s[a].v,a=E-1;break;case"G":s[a].t="t",s[a].v=Gg(t,r);break}var D="",I,A;if(_.length>0){_.charCodeAt(0)==40?(I=t<0&&_.charCodeAt(0)===45?-t:t,A=wa("n",_,I)):(I=t<0&&n>1?-t:t,A=wa("n",_,I),I<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),E=A.length-1;var P=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){P=a;break}var C=s.length;if(P===s.length&&A.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(E>=s[a].v.length-1?(E-=s[a].v.length,s[a].v=A.substr(E+1,s[a].v.length)):E<0?s[a].v="":(s[a].v=A.substr(0,E+1),E=-1),s[a].t="t",C=a);E>=0&&C<s.length&&(s[C].v=A.substr(0,E+1)+s[C].v)}else if(P!==s.length&&A.indexOf("E")===-1){for(E=A.indexOf(".")-1,a=P;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(d=s[a].v.indexOf(".")>-1&&a===P?s[a].v.indexOf(".")-1:s[a].v.length-1,D=s[a].v.substr(d+1);d>=0;--d)E>=0&&(s[a].v.charAt(d)==="0"||s[a].v.charAt(d)==="#")&&(D=A.charAt(E--)+D);s[a].v=D,s[a].t="t",C=a}for(E>=0&&C<s.length&&(s[C].v=A.substr(0,E+1)+s[C].v),E=A.indexOf(".")+1,a=P;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==P)){for(d=s[a].v.indexOf(".")>-1&&a===P?s[a].v.indexOf(".")+1:0,D=s[a].v.substr(0,d);d<s[a].v.length;++d)E<A.length&&(D+=A.charAt(E++));s[a].v=D,s[a].t="t",C=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(I=n>1&&t<0&&a>0&&s[a-1].v==="-"?-t:t,s[a].v=wa(s[a].t,s[a].v,I),s[a].t="t");var M="";for(a=0;a!==s.length;++a)s[a]!=null&&(M+=s[a].v);return M}var w5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function b5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function B7(e,t){var r=R7(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(w5),l=r[1].match(w5);return b5(t,a)?[n,r[0]]:b5(t,l)?[n,r[1]]:[n,r[a!=null&&l!=null?2:1]]}return[n,i]}function Fo(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Dr)[e],n==null&&(n=r.table&&r.table[x5[e]]||Dr[x5[e]]),n==null&&(n=w7[e]||"General");break}if(G0(n,0))return Gg(t,r);t instanceof Date&&(t=W_(t,r.date1904));var s=B7(n,t);if(G0(s[1]))return Gg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return M7(s[1],t,r,s[0])}function Q_(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Dr[r]==null){t<0&&(t=r);continue}if(Dr[r]==e){t=r;break}}t<0&&(t=391)}return Dr[t]=e,t}function Bm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Q_(e[t],t)}function Um(){Dr=y7()}var Z_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function U7(e){var t=typeof e=="number"?Dr[e]:e;return t=t.replace(Z_,"(\\d+)"),new RegExp("^"+t+"$")}function z7(e,t,r){var n=-1,s=-1,i=-1,a=-1,l=-1,c=-1;(t.match(Z_)||[]).forEach(function(m,p){var h=parseInt(r[p+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":a=h;break;case"s":c=h;break;case"m":a>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&i==-1?d:u+"T"+d}var W7=function(){var e={};e.version="1.2.0";function t(){for(var A=0,P=new Array(256),C=0;C!=256;++C)A=C,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,P[C]=A;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(A){var P=0,C=0,M=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)j[M]=A[M];for(M=0;M!=256;++M)for(C=A[M],P=256+M;P<4096;P+=256)C=j[P]=C>>>8^A[C&255];var T=[];for(M=1;M!=16;++M)T[M-1]=typeof Int32Array<"u"?j.subarray(M*256,M*256+256):j.slice(M*256,M*256+256);return T}var s=n(r),i=s[0],a=s[1],l=s[2],c=s[3],u=s[4],d=s[5],m=s[6],p=s[7],h=s[8],y=s[9],g=s[10],w=s[11],v=s[12],b=s[13],_=s[14];function E(A,P){for(var C=P^-1,M=0,j=A.length;M<j;)C=C>>>8^r[(C^A.charCodeAt(M++))&255];return~C}function D(A,P){for(var C=P^-1,M=A.length-15,j=0;j<M;)C=_[A[j++]^C&255]^b[A[j++]^C>>8&255]^v[A[j++]^C>>16&255]^w[A[j++]^C>>>24]^g[A[j++]]^y[A[j++]]^h[A[j++]]^p[A[j++]]^m[A[j++]]^d[A[j++]]^u[A[j++]]^c[A[j++]]^l[A[j++]]^a[A[j++]]^i[A[j++]]^r[A[j++]];for(M+=15;j<M;)C=C>>>8^r[(C^A[j++])&255];return~C}function I(A,P){for(var C=P^-1,M=0,j=A.length,T=0,q=0;M<j;)T=A.charCodeAt(M++),T<128?C=C>>>8^r[(C^T)&255]:T<2048?(C=C>>>8^r[(C^(192|T>>6&31))&255],C=C>>>8^r[(C^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,q=A.charCodeAt(M++)&1023,C=C>>>8^r[(C^(240|T>>8&7))&255],C=C>>>8^r[(C^(128|T>>2&63))&255],C=C>>>8^r[(C^(128|q>>6&15|(T&3)<<4))&255],C=C>>>8^r[(C^(128|q&63))&255]):(C=C>>>8^r[(C^(224|T>>12&15))&255],C=C>>>8^r[(C^(128|T>>6&63))&255],C=C>>>8^r[(C^(128|T&63))&255]);return~C}return e.table=r,e.bstr=E,e.buf=D,e.str=I,e}(),or=function(){var t={};t.version="1.2.1";function r(X,oe){for(var ee=X.split("/"),te=oe.split("/"),ae=0,ce=0,je=Math.min(ee.length,te.length);ae<je;++ae){if(ce=ee[ae].length-te[ae].length)return ce;if(ee[ae]!=te[ae])return ee[ae]<te[ae]?-1:1}return ee.length-te.length}function n(X){if(X.charAt(X.length-1)=="/")return X.slice(0,-1).indexOf("/")===-1?X:n(X.slice(0,-1));var oe=X.lastIndexOf("/");return oe===-1?X:X.slice(0,oe+1)}function s(X){if(X.charAt(X.length-1)=="/")return s(X.slice(0,-1));var oe=X.lastIndexOf("/");return oe===-1?X:X.slice(oe+1)}function i(X,oe){typeof oe=="string"&&(oe=new Date(oe));var ee=oe.getHours();ee=ee<<6|oe.getMinutes(),ee=ee<<5|oe.getSeconds()>>>1,X.write_shift(2,ee);var te=oe.getFullYear()-1980;te=te<<4|oe.getMonth()+1,te=te<<5|oe.getDate(),X.write_shift(2,te)}function a(X){var oe=X.read_shift(2)&65535,ee=X.read_shift(2)&65535,te=new Date,ae=ee&31;ee>>>=5;var ce=ee&15;ee>>>=4,te.setMilliseconds(0),te.setFullYear(ee+1980),te.setMonth(ce-1),te.setDate(ae);var je=oe&31;oe>>>=5;var Pe=oe&63;return oe>>>=6,te.setHours(oe),te.setMinutes(Pe),te.setSeconds(je<<1),te}function l(X){Ts(X,0);for(var oe={},ee=0;X.l<=X.length-4;){var te=X.read_shift(2),ae=X.read_shift(2),ce=X.l+ae,je={};switch(te){case 21589:ee=X.read_shift(1),ee&1&&(je.mtime=X.read_shift(4)),ae>5&&(ee&2&&(je.atime=X.read_shift(4)),ee&4&&(je.ctime=X.read_shift(4))),je.mtime&&(je.mt=new Date(je.mtime*1e3));break}X.l=ce,oe[te]=je}return oe}var c;function u(){return c||(c={})}function d(X,oe){if(X[0]==80&&X[1]==75)return xr(X,oe);if((X[0]|32)==109&&(X[1]|32)==105)return Ws(X,oe);if(X.length<512)throw new Error("CFB file size "+X.length+" < 512");var ee=3,te=512,ae=0,ce=0,je=0,Pe=0,ke=0,Te=[],Ce=X.slice(0,512);Ts(Ce,0);var qe=m(Ce);switch(ee=qe[0],ee){case 3:te=512;break;case 4:te=4096;break;case 0:if(qe[1]==0)return xr(X,oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}te!==512&&(Ce=X.slice(0,te),Ts(Ce,28));var Xe=X.slice(0,te);p(Ce,ee);var at=Ce.read_shift(4,"i");if(ee===3&&at!==0)throw new Error("# Directory Sectors: Expected 0 saw "+at);Ce.l+=4,je=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),Pe=Ce.read_shift(4,"i"),ae=Ce.read_shift(4,"i"),ke=Ce.read_shift(4,"i"),ce=Ce.read_shift(4,"i");for(var Ye=-1,it=0;it<109&&(Ye=Ce.read_shift(4,"i"),!(Ye<0));++it)Te[it]=Ye;var wt=h(X,te);w(ke,ce,wt,te,Te);var Kt=b(wt,je,Te,te);Kt[je].name="!Directory",ae>0&&Pe!==q&&(Kt[Pe].name="!MiniFAT"),Kt[Te[0]].name="!FAT",Kt.fat_addrs=Te,Kt.ssz=te;var ir={},qr=[],oi=[],na=[];_(je,Kt,wt,qr,ae,ir,oi,Pe),y(oi,na,qr),qr.shift();var Di={FileIndex:oi,FullPaths:na};return oe&&oe.raw&&(Di.raw={header:Xe,sectors:wt}),Di}function m(X){if(X[X.l]==80&&X[X.l+1]==75)return[0,0];X.chk(U,"Header Signature: "),X.l+=16;var oe=X.read_shift(2,"u");return[X.read_shift(2,"u"),oe]}function p(X,oe){var ee=9;switch(X.l+=2,ee=X.read_shift(2)){case 9:if(oe!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(oe!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}X.chk("0600","Mini Sector Shift: "),X.chk("000000000000","Reserved: ")}function h(X,oe){for(var ee=Math.ceil(X.length/oe)-1,te=[],ae=1;ae<ee;++ae)te[ae-1]=X.slice(ae*oe,(ae+1)*oe);return te[ee-1]=X.slice(ee*oe),te}function y(X,oe,ee){for(var te=0,ae=0,ce=0,je=0,Pe=0,ke=ee.length,Te=[],Ce=[];te<ke;++te)Te[te]=Ce[te]=te,oe[te]=ee[te];for(;Pe<Ce.length;++Pe)te=Ce[Pe],ae=X[te].L,ce=X[te].R,je=X[te].C,Te[te]===te&&(ae!==-1&&Te[ae]!==ae&&(Te[te]=Te[ae]),ce!==-1&&Te[ce]!==ce&&(Te[te]=Te[ce])),je!==-1&&(Te[je]=te),ae!==-1&&te!=Te[te]&&(Te[ae]=Te[te],Ce.lastIndexOf(ae)<Pe&&Ce.push(ae)),ce!==-1&&te!=Te[te]&&(Te[ce]=Te[te],Ce.lastIndexOf(ce)<Pe&&Ce.push(ce));for(te=1;te<ke;++te)Te[te]===te&&(ce!==-1&&Te[ce]!==ce?Te[te]=Te[ce]:ae!==-1&&Te[ae]!==ae&&(Te[te]=Te[ae]));for(te=1;te<ke;++te)if(X[te].type!==0){if(Pe=te,Pe!=Te[Pe])do Pe=Te[Pe],oe[te]=oe[Pe]+"/"+oe[te];while(Pe!==0&&Te[Pe]!==-1&&Pe!=Te[Pe]);Te[te]=-1}for(oe[0]+="/",te=1;te<ke;++te)X[te].type!==2&&(oe[te]+="/")}function g(X,oe,ee){for(var te=X.start,ae=X.size,ce=[],je=te;ee&&ae>0&&je>=0;)ce.push(oe.slice(je*T,je*T+T)),ae-=T,je=ol(ee,je*4);return ce.length===0?Oe(0):Sn(ce).slice(0,X.size)}function w(X,oe,ee,te,ae){var ce=q;if(X===q){if(oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(X!==-1){var je=ee[X],Pe=(te>>>2)-1;if(!je)return;for(var ke=0;ke<Pe&&(ce=ol(je,ke*4))!==q;++ke)ae.push(ce);w(ol(je,te-4),oe-1,ee,te,ae)}}function v(X,oe,ee,te,ae){var ce=[],je=[];ae||(ae=[]);var Pe=te-1,ke=0,Te=0;for(ke=oe;ke>=0;){ae[ke]=!0,ce[ce.length]=ke,je.push(X[ke]);var Ce=ee[Math.floor(ke*4/te)];if(Te=ke*4&Pe,te<4+Te)throw new Error("FAT boundary crossed: "+ke+" 4 "+te);if(!X[Ce])break;ke=ol(X[Ce],Te)}return{nodes:ce,data:T5([je])}}function b(X,oe,ee,te){var ae=X.length,ce=[],je=[],Pe=[],ke=[],Te=te-1,Ce=0,qe=0,Xe=0,at=0;for(Ce=0;Ce<ae;++Ce)if(Pe=[],Xe=Ce+oe,Xe>=ae&&(Xe-=ae),!je[Xe]){ke=[];var Ye=[];for(qe=Xe;qe>=0;){Ye[qe]=!0,je[qe]=!0,Pe[Pe.length]=qe,ke.push(X[qe]);var it=ee[Math.floor(qe*4/te)];if(at=qe*4&Te,te<4+at)throw new Error("FAT boundary crossed: "+qe+" 4 "+te);if(!X[it]||(qe=ol(X[it],at),Ye[qe]))break}ce[Xe]={nodes:Pe,data:T5([ke])}}return ce}function _(X,oe,ee,te,ae,ce,je,Pe){for(var ke=0,Te=te.length?2:0,Ce=oe[X].data,qe=0,Xe=0,at;qe<Ce.length;qe+=128){var Ye=Ce.slice(qe,qe+128);Ts(Ye,64),Xe=Ye.read_shift(2),at=p2(Ye,0,Xe-Te),te.push(at);var it={name:at,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},wt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);wt!==0&&(it.ct=E(Ye,Ye.l-8));var Kt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);Kt!==0&&(it.mt=E(Ye,Ye.l-8)),it.start=Ye.read_shift(4,"i"),it.size=Ye.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=q,it.name=""),it.type===5?(ke=it.start,ae>0&&ke!==q&&(oe[ke].name="!StreamData")):it.size>=4096?(it.storage="fat",oe[it.start]===void 0&&(oe[it.start]=v(ee,it.start,oe.fat_addrs,oe.ssz)),oe[it.start].name=it.name,it.content=oe[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:ke!==q&&it.start!==q&&oe[ke]&&(it.content=g(it,oe[ke].data,(oe[Pe]||{}).data))),it.content&&Ts(it.content,0),ce[at]=it,je.push(it)}}function E(X,oe){return new Date((Ps(X,oe+4)/1e7*Math.pow(2,32)+Ps(X,oe)/1e7-11644473600)*1e3)}function D(X,oe){return u(),d(c.readFileSync(X),oe)}function I(X,oe){var ee=oe&&oe.type;switch(ee||Gt&&Buffer.isBuffer(X)&&(ee="buffer"),ee||"base64"){case"file":return D(X,oe);case"base64":return d(ki(Ta(X)),oe);case"binary":return d(ki(X),oe)}return d(X,oe)}function A(X,oe){var ee=oe||{},te=ee.root||"Root Entry";if(X.FullPaths||(X.FullPaths=[]),X.FileIndex||(X.FileIndex=[]),X.FullPaths.length!==X.FileIndex.length)throw new Error("inconsistent CFB structure");X.FullPaths.length===0&&(X.FullPaths[0]=te+"/",X.FileIndex[0]={name:te,type:5}),ee.CLSID&&(X.FileIndex[0].clsid=ee.CLSID),P(X)}function P(X){var oe="Sh33tJ5";if(!or.find(X,"/"+oe)){var ee=Oe(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,X.FileIndex.push({name:oe,type:2,content:ee,size:4,L:69,R:69,C:69}),X.FullPaths.push(X.FullPaths[0]+oe),C(X)}}function C(X,oe){A(X);for(var ee=!1,te=!1,ae=X.FullPaths.length-1;ae>=0;--ae){var ce=X.FileIndex[ae];switch(ce.type){case 0:te?ee=!0:(X.FileIndex.pop(),X.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ce.R*ce.L*ce.C)&&(ee=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!oe)){var je=new Date(1987,1,19),Pe=0,ke=Object.create?Object.create(null):{},Te=[];for(ae=0;ae<X.FullPaths.length;++ae)ke[X.FullPaths[ae]]=!0,X.FileIndex[ae].type!==0&&Te.push([X.FullPaths[ae],X.FileIndex[ae]]);for(ae=0;ae<Te.length;++ae){var Ce=n(Te[ae][0]);te=ke[Ce],te||(Te.push([Ce,{name:s(Ce).replace("/",""),type:1,clsid:z,ct:je,mt:je,content:null}]),ke[Ce]=!0)}for(Te.sort(function(at,Ye){return r(at[0],Ye[0])}),X.FullPaths=[],X.FileIndex=[],ae=0;ae<Te.length;++ae)X.FullPaths[ae]=Te[ae][0],X.FileIndex[ae]=Te[ae][1];for(ae=0;ae<Te.length;++ae){var qe=X.FileIndex[ae],Xe=X.FullPaths[ae];if(qe.name=s(Xe).replace("/",""),qe.L=qe.R=qe.C=-(qe.color=1),qe.size=qe.content?qe.content.length:0,qe.start=0,qe.clsid=qe.clsid||z,ae===0)qe.C=Te.length>1?1:-1,qe.size=0,qe.type=5;else if(Xe.slice(-1)=="/"){for(Pe=ae+1;Pe<Te.length&&n(X.FullPaths[Pe])!=Xe;++Pe);for(qe.C=Pe>=Te.length?-1:Pe,Pe=ae+1;Pe<Te.length&&n(X.FullPaths[Pe])!=n(Xe);++Pe);qe.R=Pe>=Te.length?-1:Pe,qe.type=1}else n(X.FullPaths[ae+1]||"")==n(Xe)&&(qe.R=ae+1),qe.type=2}}}function M(X,oe){var ee=oe||{};if(ee.fileType=="mad")return pt(X,ee);switch(C(X),ee.fileType){case"zip":return ai(X,ee)}var te=function(at){for(var Ye=0,it=0,wt=0;wt<at.FileIndex.length;++wt){var Kt=at.FileIndex[wt];if(Kt.content){var ir=Kt.content.length;ir>0&&(ir<4096?Ye+=ir+63>>6:it+=ir+511>>9)}}for(var qr=at.FullPaths.length+3>>2,oi=Ye+7>>3,na=Ye+127>>7,Di=oi+it+qr+na,li=Di+127>>7,Ii=li<=109?0:Math.ceil((li-109)/127);Di+li+Ii+127>>7>li;)Ii=++li<=109?0:Math.ceil((li-109)/127);var bs=[1,Ii,li,na,qr,it,Ye,0];return at.FileIndex[0].size=Ye<<6,bs[7]=(at.FileIndex[0].start=bs[0]+bs[1]+bs[2]+bs[3]+bs[4]+bs[5])+(bs[6]+7>>3),bs}(X),ae=Oe(te[7]<<9),ce=0,je=0;{for(ce=0;ce<8;++ce)ae.write_shift(1,re[ce]);for(ce=0;ce<8;++ce)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),ce=0;ce<3;++ce)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,te[2]),ae.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:q),ae.write_shift(4,te[3]),ae.write_shift(-4,te[1]?te[0]-1:q),ae.write_shift(4,te[1]),ce=0;ce<109;++ce)ae.write_shift(-4,ce<te[2]?te[1]+ce:-1)}if(te[1])for(je=0;je<te[1];++je){for(;ce<236+je*127;++ce)ae.write_shift(-4,ce<te[2]?te[1]+ce:-1);ae.write_shift(-4,je===te[1]-1?q:je+1)}var Pe=function(at){for(je+=at;ce<je-1;++ce)ae.write_shift(-4,ce+1);at&&(++ce,ae.write_shift(-4,q))};for(je=ce=0,je+=te[1];ce<je;++ce)ae.write_shift(-4,G.DIFSECT);for(je+=te[2];ce<je;++ce)ae.write_shift(-4,G.FATSECT);Pe(te[3]),Pe(te[4]);for(var ke=0,Te=0,Ce=X.FileIndex[0];ke<X.FileIndex.length;++ke)Ce=X.FileIndex[ke],Ce.content&&(Te=Ce.content.length,!(Te<4096)&&(Ce.start=je,Pe(Te+511>>9)));for(Pe(te[6]+7>>3);ae.l&511;)ae.write_shift(-4,G.ENDOFCHAIN);for(je=ce=0,ke=0;ke<X.FileIndex.length;++ke)Ce=X.FileIndex[ke],Ce.content&&(Te=Ce.content.length,!(!Te||Te>=4096)&&(Ce.start=je,Pe(Te+63>>6)));for(;ae.l&511;)ae.write_shift(-4,G.ENDOFCHAIN);for(ce=0;ce<te[4]<<2;++ce){var qe=X.FullPaths[ce];if(!qe||qe.length===0){for(ke=0;ke<17;++ke)ae.write_shift(4,0);for(ke=0;ke<3;++ke)ae.write_shift(4,-1);for(ke=0;ke<12;++ke)ae.write_shift(4,0);continue}Ce=X.FileIndex[ce],ce===0&&(Ce.start=Ce.size?Ce.start-1:q);var Xe=ce===0&&ee.root||Ce.name;if(Te=2*(Xe.length+1),ae.write_shift(64,Xe,"utf16le"),ae.write_shift(2,Te),ae.write_shift(1,Ce.type),ae.write_shift(1,Ce.color),ae.write_shift(-4,Ce.L),ae.write_shift(-4,Ce.R),ae.write_shift(-4,Ce.C),Ce.clsid)ae.write_shift(16,Ce.clsid,"hex");else for(ke=0;ke<4;++ke)ae.write_shift(4,0);ae.write_shift(4,Ce.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Ce.start),ae.write_shift(4,Ce.size),ae.write_shift(4,0)}for(ce=1;ce<X.FileIndex.length;++ce)if(Ce=X.FileIndex[ce],Ce.size>=4096)if(ae.l=Ce.start+1<<9,Gt&&Buffer.isBuffer(Ce.content))Ce.content.copy(ae,ae.l,0,Ce.size),ae.l+=Ce.size+511&-512;else{for(ke=0;ke<Ce.size;++ke)ae.write_shift(1,Ce.content[ke]);for(;ke&511;++ke)ae.write_shift(1,0)}for(ce=1;ce<X.FileIndex.length;++ce)if(Ce=X.FileIndex[ce],Ce.size>0&&Ce.size<4096)if(Gt&&Buffer.isBuffer(Ce.content))Ce.content.copy(ae,ae.l,0,Ce.size),ae.l+=Ce.size+63&-64;else{for(ke=0;ke<Ce.size;++ke)ae.write_shift(1,Ce.content[ke]);for(;ke&63;++ke)ae.write_shift(1,0)}if(Gt)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function j(X,oe){var ee=X.FullPaths.map(function(ke){return ke.toUpperCase()}),te=ee.map(function(ke){var Te=ke.split("/");return Te[Te.length-(ke.slice(-1)=="/"?2:1)]}),ae=!1;oe.charCodeAt(0)===47?(ae=!0,oe=ee[0].slice(0,-1)+oe):ae=oe.indexOf("/")!==-1;var ce=oe.toUpperCase(),je=ae===!0?ee.indexOf(ce):te.indexOf(ce);if(je!==-1)return X.FileIndex[je];var Pe=!ce.match(Yh);for(ce=ce.replace(Dd,""),Pe&&(ce=ce.replace(Yh,"!")),je=0;je<ee.length;++je)if((Pe?ee[je].replace(Yh,"!"):ee[je]).replace(Dd,"")==ce||(Pe?te[je].replace(Yh,"!"):te[je]).replace(Dd,"")==ce)return X.FileIndex[je];return null}var T=64,q=-2,U="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function B(X,oe,ee){u();var te=M(X,ee);c.writeFileSync(oe,te)}function Y(X){for(var oe=new Array(X.length),ee=0;ee<X.length;++ee)oe[ee]=String.fromCharCode(X[ee]);return oe.join("")}function se(X,oe){var ee=M(X,oe);switch(oe&&oe.type||"buffer"){case"file":return u(),c.writeFileSync(oe.filename,ee),ee;case"binary":return typeof ee=="string"?ee:Y(ee);case"base64":return hf(typeof ee=="string"?ee:Y(ee));case"buffer":if(Gt)return Buffer.isBuffer(ee)?ee:La(ee);case"array":return typeof ee=="string"?ki(ee):ee}return ee}var me;function S(X){try{var oe=X.InflateRaw,ee=new oe;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)me=X;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function L(X,oe){if(!me)return Ut(X,oe);var ee=me.InflateRaw,te=new ee,ae=te._processChunk(X.slice(X.l),te._finishFlushFlag);return X.l+=te.bytesRead,ae}function R(X){return me?me.deflateRawSync(X):Ct(X)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(X){var oe=(X<<1|X<<11)&139536|(X<<5|X<<15)&558144;return(oe>>16|oe>>8|oe)&255}for(var fe=typeof Uint8Array<"u",ye=fe?new Uint8Array(256):[],pe=0;pe<256;++pe)ye[pe]=ue(pe);function _e(X,oe){var ee=ye[X&255];return oe<=8?ee>>>8-oe:(ee=ee<<8|ye[X>>8&255],oe<=16?ee>>>16-oe:(ee=ee<<8|ye[X>>16&255],ee>>>24-oe))}function Ue(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=6?0:X[te+1]<<8))>>>ee&3}function Ve(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=5?0:X[te+1]<<8))>>>ee&7}function Se(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=4?0:X[te+1]<<8))>>>ee&15}function le(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=3?0:X[te+1]<<8))>>>ee&31}function Me(X,oe){var ee=oe&7,te=oe>>>3;return(X[te]|(ee<=1?0:X[te+1]<<8))>>>ee&127}function rt(X,oe,ee){var te=oe&7,ae=oe>>>3,ce=(1<<ee)-1,je=X[ae]>>>te;return ee<8-te||(je|=X[ae+1]<<8-te,ee<16-te)||(je|=X[ae+2]<<16-te,ee<24-te)||(je|=X[ae+3]<<24-te),je&ce}function He(X,oe,ee){var te=oe&7,ae=oe>>>3;return te<=5?X[ae]|=(ee&7)<<te:(X[ae]|=ee<<te&255,X[ae+1]=(ee&7)>>8-te),oe+3}function Ke(X,oe,ee){var te=oe&7,ae=oe>>>3;return ee=(ee&1)<<te,X[ae]|=ee,oe+1}function Ze(X,oe,ee){var te=oe&7,ae=oe>>>3;return ee<<=te,X[ae]|=ee&255,ee>>>=8,X[ae+1]=ee,oe+8}function tt(X,oe,ee){var te=oe&7,ae=oe>>>3;return ee<<=te,X[ae]|=ee&255,ee>>>=8,X[ae+1]=ee&255,X[ae+2]=ee>>>8,oe+16}function dt(X,oe){var ee=X.length,te=2*ee>oe?2*ee:oe+5,ae=0;if(ee>=oe)return X;if(Gt){var ce=m5(te);if(X.copy)X.copy(ce);else for(;ae<X.length;++ae)ce[ae]=X[ae];return ce}else if(fe){var je=new Uint8Array(te);if(je.set)je.set(X);else for(;ae<ee;++ae)je[ae]=X[ae];return je}return X.length=te,X}function ft(X){for(var oe=new Array(X),ee=0;ee<X;++ee)oe[ee]=0;return oe}function bt(X,oe,ee){var te=1,ae=0,ce=0,je=0,Pe=0,ke=X.length,Te=fe?new Uint16Array(32):ft(32);for(ce=0;ce<32;++ce)Te[ce]=0;for(ce=ke;ce<ee;++ce)X[ce]=0;ke=X.length;var Ce=fe?new Uint16Array(ke):ft(ke);for(ce=0;ce<ke;++ce)Te[ae=X[ce]]++,te<ae&&(te=ae),Ce[ce]=0;for(Te[0]=0,ce=1;ce<=te;++ce)Te[ce+16]=Pe=Pe+Te[ce-1]<<1;for(ce=0;ce<ke;++ce)Pe=X[ce],Pe!=0&&(Ce[ce]=Te[Pe+16]++);var qe=0;for(ce=0;ce<ke;++ce)if(qe=X[ce],qe!=0)for(Pe=_e(Ce[ce],te)>>te-qe,je=(1<<te+4-qe)-1;je>=0;--je)oe[Pe|je<<qe]=qe&15|ce<<4;return te}var Et=fe?new Uint16Array(512):ft(512),Ft=fe?new Uint16Array(32):ft(32);if(!fe){for(var Dt=0;Dt<512;++Dt)Et[Dt]=0;for(Dt=0;Dt<32;++Dt)Ft[Dt]=0}(function(){for(var X=[],oe=0;oe<32;oe++)X.push(5);bt(X,Ft,32);var ee=[];for(oe=0;oe<=143;oe++)ee.push(8);for(;oe<=255;oe++)ee.push(9);for(;oe<=279;oe++)ee.push(7);for(;oe<=287;oe++)ee.push(8);bt(ee,Et,288)})();var xt=function(){for(var oe=fe?new Uint8Array(32768):[],ee=0,te=0;ee<ne.length-1;++ee)for(;te<ne[ee+1];++te)oe[te]=ee;for(;te<32768;++te)oe[te]=29;var ae=fe?new Uint8Array(259):[];for(ee=0,te=0;ee<V.length-1;++ee)for(;te<V[ee+1];++te)ae[te]=ee;function ce(Pe,ke){for(var Te=0;Te<Pe.length;){var Ce=Math.min(65535,Pe.length-Te),qe=Te+Ce==Pe.length;for(ke.write_shift(1,+qe),ke.write_shift(2,Ce),ke.write_shift(2,~Ce&65535);Ce-- >0;)ke[ke.l++]=Pe[Te++]}return ke.l}function je(Pe,ke){for(var Te=0,Ce=0,qe=fe?new Uint16Array(32768):[];Ce<Pe.length;){var Xe=Math.min(65535,Pe.length-Ce);if(Xe<10){for(Te=He(ke,Te,+(Ce+Xe==Pe.length)),Te&7&&(Te+=8-(Te&7)),ke.l=Te/8|0,ke.write_shift(2,Xe),ke.write_shift(2,~Xe&65535);Xe-- >0;)ke[ke.l++]=Pe[Ce++];Te=ke.l*8;continue}Te=He(ke,Te,+(Ce+Xe==Pe.length)+2);for(var at=0;Xe-- >0;){var Ye=Pe[Ce];at=(at<<5^Ye)&32767;var it=-1,wt=0;if((it=qe[at])&&(it|=Ce&-32768,it>Ce&&(it-=32768),it<Ce))for(;Pe[it+wt]==Pe[Ce+wt]&&wt<250;)++wt;if(wt>2){Ye=ae[wt],Ye<=22?Te=Ze(ke,Te,ye[Ye+1]>>1)-1:(Ze(ke,Te,3),Te+=5,Ze(ke,Te,ye[Ye-23]>>5),Te+=3);var Kt=Ye<8?0:Ye-4>>2;Kt>0&&(tt(ke,Te,wt-V[Ye]),Te+=Kt),Ye=oe[Ce-it],Te=Ze(ke,Te,ye[Ye]>>3),Te-=3;var ir=Ye<4?0:Ye-2>>1;ir>0&&(tt(ke,Te,Ce-it-ne[Ye]),Te+=ir);for(var qr=0;qr<wt;++qr)qe[at]=Ce&32767,at=(at<<5^Pe[Ce])&32767,++Ce;Xe-=wt-1}else Ye<=143?Ye=Ye+48:Te=Ke(ke,Te,1),Te=Ze(ke,Te,ye[Ye]),qe[at]=Ce&32767,++Ce}Te=Ze(ke,Te,0)-1}return ke.l=(Te+7)/8|0,ke.l}return function(ke,Te){return ke.length<8?ce(ke,Te):je(ke,Te)}}();function Ct(X){var oe=Oe(50+Math.floor(X.length*1.1)),ee=xt(X,oe);return oe.slice(0,ee)}var st=fe?new Uint16Array(32768):ft(32768),rn=fe?new Uint16Array(32768):ft(32768),Mt=fe?new Uint16Array(128):ft(128),ts=1,Yt=1;function dr(X,oe){var ee=le(X,oe)+257;oe+=5;var te=le(X,oe)+1;oe+=5;var ae=Se(X,oe)+4;oe+=4;for(var ce=0,je=fe?new Uint8Array(19):ft(19),Pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,Te=fe?new Uint8Array(8):ft(8),Ce=fe?new Uint8Array(8):ft(8),qe=je.length,Xe=0;Xe<ae;++Xe)je[O[Xe]]=ce=Ve(X,oe),ke<ce&&(ke=ce),Te[ce]++,oe+=3;var at=0;for(Te[0]=0,Xe=1;Xe<=ke;++Xe)Ce[Xe]=at=at+Te[Xe-1]<<1;for(Xe=0;Xe<qe;++Xe)(at=je[Xe])!=0&&(Pe[Xe]=Ce[at]++);var Ye=0;for(Xe=0;Xe<qe;++Xe)if(Ye=je[Xe],Ye!=0){at=ye[Pe[Xe]]>>8-Ye;for(var it=(1<<7-Ye)-1;it>=0;--it)Mt[at|it<<Ye]=Ye&7|Xe<<3}var wt=[];for(ke=1;wt.length<ee+te;)switch(at=Mt[Me(X,oe)],oe+=at&7,at>>>=3){case 16:for(ce=3+Ue(X,oe),oe+=2,at=wt[wt.length-1];ce-- >0;)wt.push(at);break;case 17:for(ce=3+Ve(X,oe),oe+=3;ce-- >0;)wt.push(0);break;case 18:for(ce=11+Me(X,oe),oe+=7;ce-- >0;)wt.push(0);break;default:wt.push(at),ke<at&&(ke=at);break}var Kt=wt.slice(0,ee),ir=wt.slice(ee);for(Xe=ee;Xe<286;++Xe)Kt[Xe]=0;for(Xe=te;Xe<30;++Xe)ir[Xe]=0;return ts=bt(Kt,st,286),Yt=bt(ir,rn,30),oe}function Us(X,oe){if(X[0]==3&&!(X[1]&3))return[Al(oe),2];for(var ee=0,te=0,ae=m5(oe||1<<18),ce=0,je=ae.length>>>0,Pe=0,ke=0;!(te&1);){if(te=Ve(X,ee),ee+=3,te>>>1)te>>1==1?(Pe=9,ke=5):(ee=dr(X,ee),Pe=ts,ke=Yt);else{ee&7&&(ee+=8-(ee&7));var Te=X[ee>>>3]|X[(ee>>>3)+1]<<8;if(ee+=32,Te>0)for(!oe&&je<ce+Te&&(ae=dt(ae,ce+Te),je=ae.length);Te-- >0;)ae[ce++]=X[ee>>>3],ee+=8;continue}for(;;){!oe&&je<ce+32767&&(ae=dt(ae,ce+32767),je=ae.length);var Ce=rt(X,ee,Pe),qe=te>>>1==1?Et[Ce]:st[Ce];if(ee+=qe&15,qe>>>=4,!(qe>>>8&255))ae[ce++]=qe;else{if(qe==256)break;qe-=257;var Xe=qe<8?0:qe-4>>2;Xe>5&&(Xe=0);var at=ce+V[qe];Xe>0&&(at+=rt(X,ee,Xe),ee+=Xe),Ce=rt(X,ee,ke),qe=te>>>1==1?Ft[Ce]:rn[Ce],ee+=qe&15,qe>>>=4;var Ye=qe<4?0:qe-2>>1,it=ne[qe];for(Ye>0&&(it+=rt(X,ee,Ye),ee+=Ye),!oe&&je<at&&(ae=dt(ae,at+100),je=ae.length);ce<at;)ae[ce]=ae[ce-it],++ce}}}return oe?[ae,ee+7>>>3]:[ae.slice(0,ce),ee+7>>>3]}function Ut(X,oe){var ee=X.slice(X.l||0),te=Us(ee,oe);return X.l+=te[1],te[0]}function Oi(X,oe){if(X)typeof console<"u"&&console.error(oe);else throw new Error(oe)}function xr(X,oe){var ee=X;Ts(ee,0);var te=[],ae=[],ce={FileIndex:te,FullPaths:ae};A(ce,{root:oe.root});for(var je=ee.length-4;(ee[je]!=80||ee[je+1]!=75||ee[je+2]!=5||ee[je+3]!=6)&&je>=0;)--je;ee.l=je+4,ee.l+=4;var Pe=ee.read_shift(2);ee.l+=6;var ke=ee.read_shift(4);for(ee.l=ke,je=0;je<Pe;++je){ee.l+=20;var Te=ee.read_shift(4),Ce=ee.read_shift(4),qe=ee.read_shift(2),Xe=ee.read_shift(2),at=ee.read_shift(2);ee.l+=8;var Ye=ee.read_shift(4),it=l(ee.slice(ee.l+qe,ee.l+qe+Xe));ee.l+=qe+Xe+at;var wt=ee.l;ee.l=Ye+4,ys(ee,Te,Ce,ce,it),ee.l=wt}return ce}function ys(X,oe,ee,te,ae){X.l+=2;var ce=X.read_shift(2),je=X.read_shift(2),Pe=a(X);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var ke=X.read_shift(4),Te=X.read_shift(4),Ce=X.read_shift(4),qe=X.read_shift(2),Xe=X.read_shift(2),at="",Ye=0;Ye<qe;++Ye)at+=String.fromCharCode(X[X.l++]);if(Xe){var it=l(X.slice(X.l,X.l+Xe));(it[21589]||{}).mt&&(Pe=it[21589].mt),((ae||{})[21589]||{}).mt&&(Pe=ae[21589].mt)}X.l+=Xe;var wt=X.slice(X.l,X.l+Te);switch(je){case 8:wt=L(X,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+je)}var Kt=!1;ce&8&&(ke=X.read_shift(4),ke==134695760&&(ke=X.read_shift(4),Kt=!0),Te=X.read_shift(4),Ce=X.read_shift(4)),Te!=oe&&Oi(Kt,"Bad compressed size: "+oe+" != "+Te),Ce!=ee&&Oi(Kt,"Bad uncompressed size: "+ee+" != "+Ce),rs(te,at,wt,{unsafe:!0,mt:Pe})}function ai(X,oe){var ee=oe||{},te=[],ae=[],ce=Oe(1),je=ee.compression?8:0,Pe=0,ke=0,Te=0,Ce=0,qe=0,Xe=X.FullPaths[0],at=Xe,Ye=X.FileIndex[0],it=[],wt=0;for(ke=1;ke<X.FullPaths.length;++ke)if(at=X.FullPaths[ke].slice(Xe.length),Ye=X.FileIndex[ke],!(!Ye.size||!Ye.content||at=="Sh33tJ5")){var Kt=Ce,ir=Oe(at.length);for(Te=0;Te<at.length;++Te)ir.write_shift(1,at.charCodeAt(Te)&127);ir=ir.slice(0,ir.l),it[qe]=W7.buf(Ye.content,0);var qr=Ye.content;je==8&&(qr=R(qr)),ce=Oe(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,Pe),ce.write_shift(2,je),Ye.mt?i(ce,Ye.mt):ce.write_shift(4,0),ce.write_shift(-4,it[qe]),ce.write_shift(4,qr.length),ce.write_shift(4,Ye.content.length),ce.write_shift(2,ir.length),ce.write_shift(2,0),Ce+=ce.length,te.push(ce),Ce+=ir.length,te.push(ir),Ce+=qr.length,te.push(qr),ce=Oe(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,Pe),ce.write_shift(2,je),ce.write_shift(4,0),ce.write_shift(-4,it[qe]),ce.write_shift(4,qr.length),ce.write_shift(4,Ye.content.length),ce.write_shift(2,ir.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,Kt),wt+=ce.l,ae.push(ce),wt+=ir.length,ae.push(ir),++qe}return ce=Oe(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,qe),ce.write_shift(2,qe),ce.write_shift(4,wt),ce.write_shift(4,Ce),ce.write_shift(2,0),Sn([Sn(te),Sn(ae),ce])}var lr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _t(X,oe){if(X.ctype)return X.ctype;var ee=X.name||"",te=ee.match(/\.([^\.]+)$/);return te&&lr[te[1]]||oe&&(te=(ee=oe).match(/[\.\\]([^\.\\])+$/),te&&lr[te[1]])?lr[te[1]]:"application/octet-stream"}function Ht(X){for(var oe=hf(X),ee=[],te=0;te<oe.length;te+=76)ee.push(oe.slice(te,te+76));return ee.join(`\r
`)+`\r
`}function ra(X){var oe=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Ce=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});oe=oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),oe.charAt(0)==`
`&&(oe="=0D"+oe.slice(1)),oe=oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],te=oe.split(`\r
`),ae=0;ae<te.length;++ae){var ce=te[ae];if(ce.length==0){ee.push("");continue}for(var je=0;je<ce.length;){var Pe=76,ke=ce.slice(je,je+Pe);ke.charAt(Pe-1)=="="?Pe--:ke.charAt(Pe-2)=="="?Pe-=2:ke.charAt(Pe-3)=="="&&(Pe-=3),ke=ce.slice(je,je+Pe),je+=Pe,je<ce.length&&(ke+="="),ee.push(ke)}}return ee.join(`\r
`)}function nn(X){for(var oe=[],ee=0;ee<X.length;++ee){for(var te=X[ee];ee<=X.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+X[++ee];oe.push(te)}for(var ae=0;ae<oe.length;++ae)oe[ae]=oe[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return ki(oe.join(`\r
`))}function zs(X,oe,ee){for(var te="",ae="",ce="",je,Pe=0;Pe<10;++Pe){var ke=oe[Pe];if(!ke||ke.match(/^\s*$/))break;var Te=ke.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":te=Te[2].trim();break;case"content-type":ce=Te[2].trim();break;case"content-transfer-encoding":ae=Te[2].trim();break}}switch(++Pe,ae.toLowerCase()){case"base64":je=ki(Ta(oe.slice(Pe).join("")));break;case"quoted-printable":je=nn(oe.slice(Pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Ce=rs(X,te.slice(ee.length),je,{unsafe:!0});ce&&(Ce.ctype=ce)}function Ws(X,oe){if(Y(X.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=oe&&oe.root||"",te=(Gt&&Buffer.isBuffer(X)?X.toString("binary"):Y(X)).split(`\r
`),ae=0,ce="";for(ae=0;ae<te.length;++ae)if(ce=te[ae],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),ee||(ee=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),ce.slice(0,ee.length)!=ee););var je=(te[1]||"").match(/boundary="(.*?)"/);if(!je)throw new Error("MAD cannot find boundary");var Pe="--"+(je[1]||""),ke=[],Te=[],Ce={FileIndex:ke,FullPaths:Te};A(Ce);var qe,Xe=0;for(ae=0;ae<te.length;++ae){var at=te[ae];at!==Pe&&at!==Pe+"--"||(Xe++&&zs(Ce,te.slice(qe,ae),ee),qe=ae)}return Ce}function pt(X,oe){var ee=oe||{},te=ee.boundary||"SheetJS";te="------="+te;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ce=X.FullPaths[0],je=ce,Pe=X.FileIndex[0],ke=1;ke<X.FullPaths.length;++ke)if(je=X.FullPaths[ke].slice(ce.length),Pe=X.FileIndex[ke],!(!Pe.size||!Pe.content||je=="Sh33tJ5")){je=je.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wt){return"_x"+wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wt){return"_u"+wt.charCodeAt(0).toString(16)+"_"});for(var Te=Pe.content,Ce=Gt&&Buffer.isBuffer(Te)?Te.toString("binary"):Y(Te),qe=0,Xe=Math.min(1024,Ce.length),at=0,Ye=0;Ye<=Xe;++Ye)(at=Ce.charCodeAt(Ye))>=32&&at<128&&++qe;var it=qe>=Xe*4/5;ae.push(te),ae.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+je),ae.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),ae.push("Content-Type: "+_t(Pe,je)),ae.push(""),ae.push(it?ra(Ce):Ht(Ce))}return ae.push(te+`--\r
`),ae.join(`\r
`)}function ws(X){var oe={};return A(oe,X),oe}function rs(X,oe,ee,te){var ae=te&&te.unsafe;ae||A(X);var ce=!ae&&or.find(X,oe);if(!ce){var je=X.FullPaths[0];oe.slice(0,je.length)==je?je=oe:(je.slice(-1)!="/"&&(je+="/"),je=(je+oe).replace("//","/")),ce={name:s(oe),type:2},X.FileIndex.push(ce),X.FullPaths.push(je),ae||or.utils.cfb_gc(X)}return ce.content=ee,ce.size=ee?ee.length:0,te&&(te.CLSID&&(ce.clsid=te.CLSID),te.mt&&(ce.mt=te.mt),te.ct&&(ce.ct=te.ct)),ce}function Cn(X,oe){A(X);var ee=or.find(X,oe);if(ee){for(var te=0;te<X.FileIndex.length;++te)if(X.FileIndex[te]==ee)return X.FileIndex.splice(te,1),X.FullPaths.splice(te,1),!0}return!1}function Ir(X,oe,ee){A(X);var te=or.find(X,oe);if(te){for(var ae=0;ae<X.FileIndex.length;++ae)if(X.FileIndex[ae]==te)return X.FileIndex[ae].name=s(ee),X.FullPaths[ae]=ee,!0}return!1}function Tr(X){C(X,!0)}return t.find=j,t.read=I,t.parse=d,t.write=se,t.writeFile=B,t.utils={cfb_new:ws,cfb_add:rs,cfb_del:Cn,cfb_mov:Ir,cfb_gc:Tr,ReadShift:Rd,CheckField:x3,prep_blob:Ts,bconcat:Sn,use_zlib:S,_deflateRaw:Ct,_inflateRaw:Ut,consts:G},t}();function H7(e){return typeof e=="string"?Mm(e):Array.isArray(e)?p7(e):e}function Tf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Mm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?pf(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([H7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Af(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Tn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function _5(e,t){for(var r=[],n=Tn(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function d2(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function zm(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function $7(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var K0=new Date(1899,11,30,0,0,0);function gs(e,t){var r=e.getTime(),n=K0.getTime()+(e.getTimezoneOffset()-K0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var e3=new Date,q7=K0.getTime()+(e3.getTimezoneOffset()-K0.getTimezoneOffset())*6e4,N5=e3.getTimezoneOffset();function t3(e){var t=new Date;return t.setTime(e*24*60*60*1e3+q7),t.getTimezoneOffset()!==N5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-N5)*6e4),t}var S5=new Date("2017-02-19T19:06:09.000Z"),r3=isNaN(S5.getFullYear())?new Date("2/19/17"):S5,V7=r3.getFullYear()==2017;function Qn(e,t){var r=new Date(e);if(V7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(r3.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Wm(e,t){if(Gt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function xs(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=xs(e[r]));return t}function Or(e,t){for(var r="";r.length<t;)r+=e;return r}function ba(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var G7=["january","february","march","april","may","june","july","august","september","october","november","december"];function mf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&G7.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Pt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Gt?n=La(r):n=g7(r),or.utils.cfb_add(e,t,n)}or.utils.cfb_add(e,t,r)}else e.file(t,r)}function f2(){return or.utils.cfb_new()}var tn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Y7={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},h2=d2(Y7),m2=/[&<>'"]/g,K7=/[\u0000-\u0008\u000b-\u001f]/g;function rr(e){var t=e+"";return t.replace(m2,function(r){return h2[r]}).replace(K7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function k5(e){return rr(e).replace(/ /g,"_x0020_")}var n3=/[\u0000-\u001f]/g;function X7(e){var t=e+"";return t.replace(m2,function(r){return h2[r]}).replace(/\n/g,"<br/>").replace(n3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function J7(e){var t=e+"";return t.replace(m2,function(r){return h2[r]}).replace(n3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Q7(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Z7(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function w1(e){for(var t="",r=0,n=0,s=0,i=0,a=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function j5(e){var t=Al(2*e.length),r,n,s=1,i=0,a=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[i++]=a&255,t[i++]=a>>>8,a=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function E5(e){return La(e,"binary").toString("utf8")}var Xh="foo bar baz",Id=Gt&&(E5(Xh)==w1(Xh)&&E5||j5(Xh)==w1(Xh)&&j5)||w1,pf=Gt?function(e){return La(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},eP=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),s3=/(^\s|\s$|\n)/;function kn(e,t){return"<"+e+(t.match(s3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function gf(e){return Tn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Je(e,t,r){return"<"+e+(r!=null?gf(r):"")+(t!=null?(t.match(s3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Yg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function tP(e,t){switch(typeof e){case"string":var r=Je("vt:lpwstr",rr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Je((e|0)==e?"vt:i4":"vt:r8",rr(String(e)));case"boolean":return Je("vt:bool",e?"true":"false")}if(e instanceof Date)return Je("vt:filetime",Yg(e));throw new Error("Unable to serialize "+e)}var pn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Cs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function rP(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function nP(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,a=n?-t:t;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var A5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},T5=Gt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:La(t)})):A5(e)}:A5,C5=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(xd(e,s)));return n.join("").replace(Dd,"")},p2=Gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Dd,""):C5(e,t,r)}:C5,P5=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},i3=Gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):P5(e,t,r)}:P5,L5=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Nc(e,s)));return n.join("")},Cf=Gt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):L5(t,r,n)}:L5,a3=function(e,t){var r=Ps(e,t);return r>0?Cf(e,t+4,t+4+r-1):""},o3=a3,l3=function(e,t){var r=Ps(e,t);return r>0?Cf(e,t+4,t+4+r-1):""},c3=l3,u3=function(e,t){var r=2*Ps(e,t);return r>0?Cf(e,t+4,t+4+r-1):""},d3=u3,f3=function(t,r){var n=Ps(t,r);return n>0?p2(t,r+4,r+4+n):""},h3=f3,m3=function(e,t){var r=Ps(e,t);return r>0?Cf(e,t+4,t+4+r):""},p3=m3,g3=function(e,t){return rP(e,t)},X0=g3,g2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Gt&&(o3=function(t,r){if(!Buffer.isBuffer(t))return a3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},c3=function(t,r){if(!Buffer.isBuffer(t))return l3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},d3=function(t,r){if(!Buffer.isBuffer(t))return u3(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},h3=function(t,r){if(!Buffer.isBuffer(t))return f3(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},p3=function(t,r){if(!Buffer.isBuffer(t))return m3(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},X0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):g3(t,r)},g2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Nc=function(e,t){return e[t]},xd=function(e,t){return e[t+1]*256+e[t]},sP=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ps=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ol=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},iP=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Rd(e,t){var r="",n,s,i=[],a,l,c,u;switch(t){case"dbcs":if(u=this.l,Gt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(xd(this,u)),u+=2;e*=2;break;case"utf8":r=Cf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=p2(this,this.l,this.l+e);break;case"wstr":return Rd.call(this,e,"dbcs");case"lpstr-ansi":r=o3(this,this.l),e=4+Ps(this,this.l);break;case"lpstr-cp":r=c3(this,this.l),e=4+Ps(this,this.l);break;case"lpwstr":r=d3(this,this.l),e=4+2*Ps(this,this.l);break;case"lpp4":e=4+Ps(this,this.l),r=h3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ps(this,this.l),r=p3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Nc(this,this.l+e++))!==0;)i.push(Gh(a));r=i.join("");break;case"_wstr":for(e=0,r="";(a=xd(this,this.l+e))!==0;)i.push(Gh(a)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Nc(this,u),this.l=u+1,l=Rd.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Gh(xd(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Nc(this,u),this.l=u+1,l=Rd.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Gh(Nc(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Nc(this,this.l),this.l++,n;case 2:return n=(t==="i"?sP:xd)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ol:iP)(this,this.l),this.l+=4,n):(s=Ps(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=X0(this,this.l):s=X0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=i3(this,this.l,e);break}}return this.l+=e,r}var aP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},oP=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},lP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function cP(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)lP(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,aP(this,t,this.l);break;case 8:if(n=8,r==="f"){nP(this,t,this.l);break}case 16:break;case-4:n=4,oP(this,t,this.l);break}return this.l+=n,this}function x3(e,t){var r=i3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ts(e,t){e.l=t,e.read_shift=Rd,e.chk=x3,e.write_shift=cP}function Zi(e,t){e.l+=t}function Oe(e){var t=Al(e);return Ts(t,0),t}function ps(){var e=[],t=Gt?256:2048,r=function(u){var d=Oe(u);return Ts(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},a=function(){return s(),Sn(e)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:a,_bufs:e}}function Be(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=rI[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=e.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&g2(r)&&e.push(r)}}function Md(e,t,r){var n=xs(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function F5(e,t,r){var n=xs(e);return n.s=Md(n.s,t.s,r),n.e=Md(n.e,t.s,r),n}function Bd(e,t){if(e.cRel&&e.c<0)for(e=xs(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=xs(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=sr(e);return!e.cRel&&e.cRel!=null&&(r=fP(r)),!e.rRel&&e.rRel!=null&&(r=uP(r)),r}function b1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+zn(e.s.c)+":"+(e.e.cRel?"":"$")+zn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+En(e.s.r)+":"+(e.e.rRel?"":"$")+En(e.e.r):Bd(e.s,t.biff)+":"+Bd(e.e,t.biff)}function x2(e){return parseInt(dP(e),10)-1}function En(e){return""+(e+1)}function uP(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dP(e){return e.replace(/\$(\d+)$/,"$1")}function v2(e){for(var t=hP(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function zn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fP(e){return e.replace(/^([A-Z])/,"$$$1")}function hP(e){return e.replace(/^\$([A-Z])/,"$1")}function mP(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function sr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Rs(e){var t=e.indexOf(":");return t==-1?{s:gn(e),e:gn(e)}:{s:gn(e.slice(0,t)),e:gn(e.slice(t+1))}}function Zr(e,t){return typeof t>"u"||typeof t=="number"?Zr(e.s,e.e):(typeof e!="string"&&(e=sr(e)),typeof t!="string"&&(t=sr(t)),e==t?e:e+":"+t)}function _r(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function O5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fo(e.z,r?gs(t):t)}catch{}try{return e.w=Fo((e.XF||{}).numFmtId||(r?14:0),r?gs(t):t)}catch{return""+t}}function Ca(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Pf[e.v]||e.v:t==null?O5(e,e.v):O5(e,t))}function Il(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function v3(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),a=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?gn(n.origin):n.origin;a=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=_r(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(u.e.r=a=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[m].length;++p)if(!(typeof t[m][p]>"u")){var h={v:t[m][p]},y=a+m,g=l+p;if(u.s.r>y&&(u.s.r=y),u.s.c>g&&(u.s.c=g),u.e.r<y&&(u.e.r=y),u.e.c<g&&(u.e.c=g),t[m][p]&&typeof t[m][p]=="object"&&!Array.isArray(t[m][p])&&!(t[m][p]instanceof Date))h=t[m][p];else if(Array.isArray(h.v)&&(h.f=t[m][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Dr[14],n.cellDates?(h.t="d",h.w=Fo(h.z,gs(h.v))):(h.t="n",h.v=gs(h.v),h.w=Fo(h.z,h.v))):h.t="s";if(s)i[y]||(i[y]=[]),i[y][g]&&i[y][g].z&&(h.z=i[y][g].z),i[y][g]=h;else{var w=sr({c:g,r:y});i[w]&&i[w].z&&(h.z=i[w].z),i[w]=h}}}return u.s.c<1e7&&(i["!ref"]=Zr(u)),i}function xu(e,t){return v3(null,e,t)}function pP(e){return e.read_shift(4,"i")}function Ti(e,t){return t||(t=Oe(4)),t.write_shift(4,e),t}function Wn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function xn(e,t){var r=!1;return t==null&&(r=!0,t=Oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function gP(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function xP(e,t){return t||(t=Oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function y2(e,t){var r=e.l,n=e.read_shift(1),s=Wn(e),i=[],a={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(gP(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function vP(e,t){var r=!1;return t==null&&(r=!0,t=Oe(15+4*e.t.length)),t.write_shift(1,0),xn(e.t,t),r?t.slice(0,t.l):t}var yP=y2;function wP(e,t){var r=!1;return t==null&&(r=!0,t=Oe(23+4*e.t.length)),t.write_shift(1,1),xn(e.t,t),t.write_shift(4,1),xP({},t),r?t.slice(0,t.l):t}function ii(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Rl(e,t){return t==null&&(t=Oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ml(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Bl(e,t){return t==null&&(t=Oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var bP=Wn,y3=xn;function w2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function J0(e,t){var r=!1;return t==null&&(r=!0,t=Oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _P=Wn,Kg=w2,b2=J0;function w3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?X0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ol(t,0)>>2;return r?s/100:s}function b3(e,t){t==null&&(t=Oe(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function _3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function NP(e,t){return t||(t=Oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ul=_3,vu=NP;function yu(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Tl(e,t){return(t||Oe(8)).write_shift(8,e,"f")}function SP(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=FP[s];u&&(t.rgb=q5(u));break;case 2:t.rgb=q5([a,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Q0(e,t){if(t||(t=Oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function kP(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function jP(e,t){t||(t=Oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var N3=2,Es=3,Jh=11,Z0=19,Qh=64,EP=65,AP=71,TP=4108,CP=4126,Nn=80,D5={1:{n:"CodePage",t:N3},2:{n:"Category",t:Nn},3:{n:"PresentationFormat",t:Nn},4:{n:"ByteCount",t:Es},5:{n:"LineCount",t:Es},6:{n:"ParagraphCount",t:Es},7:{n:"SlideCount",t:Es},8:{n:"NoteCount",t:Es},9:{n:"HiddenCount",t:Es},10:{n:"MultimediaClipCount",t:Es},11:{n:"ScaleCrop",t:Jh},12:{n:"HeadingPairs",t:TP},13:{n:"TitlesOfParts",t:CP},14:{n:"Manager",t:Nn},15:{n:"Company",t:Nn},16:{n:"LinksUpToDate",t:Jh},17:{n:"CharacterCount",t:Es},19:{n:"SharedDoc",t:Jh},22:{n:"HyperlinksChanged",t:Jh},23:{n:"AppVersion",t:Es,p:"version"},24:{n:"DigSig",t:EP},26:{n:"ContentType",t:Nn},27:{n:"ContentStatus",t:Nn},28:{n:"Language",t:Nn},29:{n:"Version",t:Nn},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}},I5={1:{n:"CodePage",t:N3},2:{n:"Title",t:Nn},3:{n:"Subject",t:Nn},4:{n:"Author",t:Nn},5:{n:"Keywords",t:Nn},6:{n:"Comments",t:Nn},7:{n:"Template",t:Nn},8:{n:"LastAuthor",t:Nn},9:{n:"RevNumber",t:Nn},10:{n:"EditTime",t:Qh},11:{n:"LastPrinted",t:Qh},12:{n:"CreatedDate",t:Qh},13:{n:"ModifiedDate",t:Qh},14:{n:"PageCount",t:Es},15:{n:"WordCount",t:Es},16:{n:"CharCount",t:Es},17:{n:"Thumbnail",t:AP},18:{n:"Application",t:Nn},19:{n:"DocSecurity",t:Es},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}};function PP(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var LP=PP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),FP=xs(LP),Pf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},OP={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function S3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function k3(e,t){var r=$7(OP),n=[],s;n[n.length]=tn,n[n.length]=Je("Types",null,{xmlns:pn.CT,"xmlns:xsd":pn.xsd,"xmlns:xsi":pn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Je("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Je("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Zh[c][t.bookType]||Zh[c].xlsx}))},a=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Zh[c][t.bookType]||Zh[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),a("sheets"),a("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),a("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function j3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Gc(e){var t=[tn,Je("Relationships",null,{xmlns:pn.RELS})];return Tn(e["!id"]).forEach(function(r){t[t.length]=Je("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function er(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[$t.HLINK,$t.XPATH,$t.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function DP(e){var t=[tn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function R5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function IP(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function RP(e){var t=[tn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(R5(e[r][0],e[r][1])),t.push(IP("",e[r][0]));return t.push(R5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function E3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+q0.version+"</meta:generator></office:meta></office:document-meta>"}var wl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function _1(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=rr(t),n[n.length]=r?Je(e,t,r):kn(e,t))}function A3(e,t){var r=t||{},n=[tn,Je("cp:coreProperties",null,{"xmlns:cp":pn.CORE_PROPS,"xmlns:dc":pn.dc,"xmlns:dcterms":pn.dcterms,"xmlns:dcmitype":pn.dcmitype,"xmlns:xsi":pn.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&_1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Yg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&_1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Yg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=wl.length;++i){var a=wl[i],l=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&_1(a[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Yc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],T3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function C3(e){var t=[],r=Je;return e||(e={}),e.Application="SheetJS",t[t.length]=tn,t[t.length]=Je("Properties",null,{xmlns:pn.EXT_PROPS,"xmlns:vt":pn.vt}),Yc.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=rr(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+rr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function P3(e){var t=[tn,Je("Properties",null,{xmlns:pn.CUST_PROPS,"xmlns:vt":pn.vt})];if(!e)return t.join("");var r=1;return Tn(e).forEach(function(s){++r,t[t.length]=Je("property",tP(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rr(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var M5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function MP(e,t){var r=[];return Tn(M5).map(function(n){for(var s=0;s<wl.length;++s)if(wl[s][1]==n)return wl[s];for(s=0;s<Yc.length;++s)if(Yc[s][1]==n)return Yc[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(kn(M5[n[1]]||n[1],s))}}),Je("DocumentProperties",r.join(""),{xmlns:Cs.o})}function BP(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Tn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var a=0;a<wl.length;++a)if(i==wl[a][1])return;for(a=0;a<Yc.length;++a)if(i==Yc[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Je(k5(i),l,{"dt:dt":c}))}}),t&&Tn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var a=t[i],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),s.push(Je(k5(i),a,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Cs.o+'">'+s.join("")+"</"+n+">"}function UP(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=Oe(8);return a.write_shift(4,n),a.write_shift(4,s),a}function B5(e,t){var r=Oe(4),n=Oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Oe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=UP(t);break;case 31:case 80:for(n=Oe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Sn([r,n])}var L3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zP(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function U5(e,t,r){var n=Oe(8),s=[],i=[],a=8,l=0,c=Oe(8),u=Oe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),s.push(u),a+=8+c.length,!t){u=Oe(8),u.write_shift(4,0),s.unshift(u);var d=[Oe(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(c=Oe(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Sn(d),i.unshift(c),a+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(L3.indexOf(e[l][0])>-1||T3.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],h=0;if(t){h=+t[e[l][0]];var y=r[h];if(y.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}c=B5(y.t,p)}else{var w=zP(p);w==-1&&(w=31,p=String(p)),c=B5(w,p)}i.push(c),u=Oe(8),u.write_shift(4,t?h:2+l),s.push(u),a+=8+c.length}var v=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,v),v+=i[l].length;return n.write_shift(4,a),n.write_shift(4,i.length),Sn([n].concat(s).concat(i))}function z5(e,t,r,n,s,i){var a=Oe(s?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,or.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,s?68:48);var c=U5(e,r,n);if(l.push(c),s){var u=U5(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+c.length),l.push(u)}return Sn(l)}function WP(e,t){t||(t=Oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function HP(e,t){return e.read_shift(t)===1}function Kn(e,t){return t||(t=Oe(2)),t.write_shift(2,+!!e),t}function F3(e){return e.read_shift(2,"u")}function Js(e,t){return t||(t=Oe(2)),t.write_shift(2,e),t}function O3(e,t,r){return r||(r=Oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function D3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?e.read_shift(n,s):"";return a}function $P(e){var t=e.t||"",r=Oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Oe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Sn(s)}function qP(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function VP(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):qP(e,n,r)}function GP(e,t,r){if(r.biff>5)return VP(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function I3(e,t,r){return r||(r=Oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function W5(e,t){t||(t=Oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function YP(e){var t=Oe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(i==28)n=n.slice(1),W5(n,t);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&W5(s>-1?n.slice(s+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Cl(e,t,r,n){return n||(n=Oe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function KP(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[s,i,a]}function XP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function R3(e,t){return t||(t=Oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function _2(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Oe(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function JP(e,t){var r=!t||t.biff==8,n=Oe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function QP(e,t){var r=!t||t.biff>=8?2:1,n=Oe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function ZP(e,t){var r=Oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=$P(e[s]);var i=Sn([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function eL(){var e=Oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function tL(e){var t=Oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function rL(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=Oe(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function nL(e,t,r,n){var s=Oe(10);return Cl(e,t,n,s),s.write_shift(4,r),s}function sL(e,t,r,n,s){var i=!s||s.biff==8,a=Oe(8+ +i+(1+i)*r.length);return Cl(e,t,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function iL(e,t,r,n){var s=r&&r.biff==5;n||(n=Oe(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function aL(e,t){var r=t.biff==8||!t.biff?4:2,n=Oe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function H5(e,t,r,n){var s=r&&r.biff==5;n||(n=Oe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function oL(e){var t=Oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function lL(e,t,r,n,s,i){var a=Oe(8);return Cl(e,t,n,a),O3(r,i,a),a}function cL(e,t,r,n){var s=Oe(14);return Cl(e,t,n,s),Tl(r,s),s}function uL(e,t,r){if(r.biff<8)return dL(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(KP(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function dL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=D3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function fL(e){var t=Oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)R3(e[r],t);return t}function hL(e){var t=Oe(24),r=gn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Sn([t,YP(e[1])])}function mL(e){var t=e[1].Tooltip,r=Oe(10+2*(t.length+1));r.write_shift(2,2048);var n=gn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function pL(e){return e||(e=Oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function gL(e,t,r){if(!r.cellStyles)return Zi(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:i,w:a,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function xL(e,t){var r=Oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function vL(e){for(var t=Oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function yL(e,t,r){var n=Oe(15);return Ff(n,e,t),n.write_shift(8,r,"f"),n}function wL(e,t,r){var n=Oe(9);return Ff(n,e,t),n.write_shift(2,r),n}var bL=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=d2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Al(1);switch(c.type){case"base64":d=ki(Ta(l));break;case"binary":d=ki(l);break;case"buffer":case"array":d=l;break}Ts(d,0);var m=d.read_shift(1),p=!!(m&136),h=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var g=0,w=521;m==2&&(g=d.read_shift(2)),d.l+=3,m!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),m!=2&&(w=d.read_shift(2));var v=d.read_shift(2),b=c.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var _=[],E={},D=Math.min(d.length,m==2?521:w-10-(h?264:0)),I=y?32:11;d.l<D&&d[d.l]!=13;)switch(E={},E.name=h5.utils.decode(b,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,E.type=String.fromCharCode(d.read_shift(1)),m!=2&&!y&&(E.offset=d.read_shift(4)),E.len=d.read_shift(1),m==2&&(E.offset=d.read_shift(2)),E.dec=d.read_shift(1),E.name.length&&_.push(E),m!=2&&(d.l+=y?13:14),E.type){case"B":(!h||E.len!=8)&&c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var A=0,P=0;for(u[0]=[],P=0;P!=_.length;++P)u[0][P]=_[P].name;for(;g-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++A]=[],P=0,P=0;P!=_.length;++P){var C=d.slice(d.l,d.l+_[P].len);d.l+=_[P].len,Ts(C,0);var M=h5.utils.decode(b,C);switch(_[P].type){case"C":M.trim().length&&(u[A][P]=M.replace(/\s+$/,""));break;case"D":M.length===8?u[A][P]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):u[A][P]=M;break;case"F":u[A][P]=parseFloat(M.trim());break;case"+":case"I":u[A][P]=y?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":u[A][P]=!0;break;case"N":case"F":u[A][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[A][P]="##MEMO##"+(y?parseInt(M.trim(),10):C.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(u[A][P]=+M||0);break;case"@":u[A][P]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":u[A][P]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":u[A][P]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][P]=-C.read_shift(-8,"f");break;case"B":if(h&&_[P].len==8){u[A][P]=C.read_shift(8,"f");break}case"G":case"P":C.l+=_[P].len;break;case"0":if(_[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[P].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=xu(r(l,u),u);return d["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,d}function s(l,c){try{return Il(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,c){var u=c||{};if(+u.codepage>=0&&ff(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ps(),m=sm(l,{header:1,raw:!0,cellDates:!0}),p=m[0],h=m.slice(1),y=l["!cols"]||[],g=0,w=0,v=0,b=1;for(g=0;g<p.length;++g){if(((y[g]||{}).DBF||{}).name){p[g]=y[g].DBF.name,++v;continue}if(p[g]!=null){if(++v,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(w=0;w<1024;++w)if(p.indexOf(p[g]+"_"+w)==-1){p[g]+="_"+w;break}}}}var _=_r(l["!ref"]),E=[],D=[],I=[];for(g=0;g<=_.e.c-_.s.c;++g){var A="",P="",C=0,M=[];for(w=0;w<h.length;++w)h[w][g]!=null&&M.push(h[w][g]);if(M.length==0||p[g]==null){E[g]="?";continue}for(w=0;w<M.length;++w){switch(typeof M[w]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=M[w]instanceof Date?"D":"C";break;default:P="C"}C=Math.max(C,String(M[w]).length),A=A&&A!=P?"C":P}C>250&&(C=250),P=((y[g]||{}).DBF||{}).type,P=="C"&&y[g].DBF.len>C&&(C=y[g].DBF.len),A=="B"&&P=="N"&&(A="N",I[g]=y[g].DBF.dec,C=y[g].DBF.len),D[g]=A=="C"||P=="N"?C:i[A]||0,b+=D[g],E[g]=A}var j=d.next(32);for(j.write_shift(4,318902576),j.write_shift(4,h.length),j.write_shift(2,296+32*v),j.write_shift(2,b),g=0;g<4;++g)j.write_shift(4,0);for(j.write_shift(4,0|(+t[B_]||3)<<8),g=0,w=0;g<p.length;++g)if(p[g]!=null){var T=d.next(32),q=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,q,"sbcs"),T.write_shift(1,E[g]=="?"?"C":E[g],"sbcs"),T.write_shift(4,w),T.write_shift(1,D[g]||i[E[g]]||0),T.write_shift(1,I[g]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),w+=D[g]||i[E[g]]||0}var U=d.next(264);for(U.write_shift(4,13),g=0;g<65;++g)U.write_shift(4,0);for(g=0;g<h.length;++g){var re=d.next(b);for(re.write_shift(1,0),w=0;w<p.length;++w)if(p[w]!=null)switch(E[w]){case"L":re.write_shift(1,h[g][w]==null?63:h[g][w]?84:70);break;case"B":re.write_shift(8,h[g][w]||0,"f");break;case"N":var z="0";for(typeof h[g][w]=="number"&&(z=h[g][w].toFixed(I[w]||0)),v=0;v<D[w]-z.length;++v)re.write_shift(1,32);re.write_shift(1,z,"sbcs");break;case"D":h[g][w]?(re.write_shift(4,("0000"+h[g][w].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(h[g][w].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+h[g][w].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var G=String(h[g][w]!=null?h[g][w]:"").slice(0,D[w]);for(re.write_shift(1,G,"sbcs"),v=0;v<D[w]-G.length;++v)re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),_L=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var y=e[h];return typeof y=="number"?f5(y):y},n=function(p,h,y){var g=h.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return g==59?p:f5(g)};e["|"]=254;function s(p,h){switch(h.type){case"base64":return i(Ta(p),h);case"binary":return i(p,h);case"buffer":return i(Gt&&Buffer.isBuffer(p)?p.toString("binary"):Af(p),h);case"array":return i(Wm(p),h)}throw new Error("Unrecognized type "+h.type)}function i(p,h){var y=p.split(/[\n\r]+/),g=-1,w=-1,v=0,b=0,_=[],E=[],D=null,I={},A=[],P=[],C=[],M=0,j;for(+h.codepage>=0&&ff(+h.codepage);v!==y.length;++v){M=0;var T=y[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=T.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),U=q[0],re;if(T.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&E.push(T.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,G=!1,B=!1,Y=!1,se=-1,me=-1;for(b=1;b<q.length;++b)switch(q[b].charAt(0)){case"A":break;case"X":w=parseInt(q[b].slice(1))-1,G=!0;break;case"Y":for(g=parseInt(q[b].slice(1))-1,G||(w=0),j=_.length;j<=g;++j)_[j]=[];break;case"K":re=q[b].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(ba(re))?isNaN(mf(re).getDate())||(re=Qn(re)):(re=ba(re),D!==null&&J_(D)&&(re=t3(re))),z=!0;break;case"E":Y=!0;var S=wF(q[b].slice(1),{r:g,c:w});_[g][w]=[_[g][w],S];break;case"S":B=!0,_[g][w]=[_[g][w],"S5S"];break;case"G":break;case"R":se=parseInt(q[b].slice(1))-1;break;case"C":me=parseInt(q[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(z&&(_[g][w]&&_[g][w].length==2?_[g][w][0]=re:_[g][w]=re,D=null),B){if(Y)throw new Error("SYLK shared formula cannot have own formula");var L=se>-1&&_[se][me];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");_[g][w][1]=bF(L[1],{r:g-se,c:w-me})}break;case"F":var R=0;for(b=1;b<q.length;++b)switch(q[b].charAt(0)){case"X":w=parseInt(q[b].slice(1))-1,++R;break;case"Y":for(g=parseInt(q[b].slice(1))-1,j=_.length;j<=g;++j)_[j]=[];break;case"M":M=parseInt(q[b].slice(1))/20;break;case"F":break;case"G":break;case"P":D=E[parseInt(q[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=q[b].slice(1).split(" "),j=parseInt(C[0],10);j<=parseInt(C[1],10);++j)M=parseInt(C[2],10),P[j-1]=M===0?{hidden:!0}:{wch:M},N2(P[j-1]);break;case"C":w=parseInt(q[b].slice(1))-1,P[w]||(P[w]={});break;case"R":g=parseInt(q[b].slice(1))-1,A[g]||(A[g]={}),M>0?(A[g].hpt=M,A[g].hpx=W3(M)):M===0&&(A[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}R<1&&(D=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return A.length>0&&(I["!rows"]=A),P.length>0&&(I["!cols"]=P),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,I]}function a(p,h){var y=s(p,h),g=y[0],w=y[1],v=xu(g,h);return Tn(w).forEach(function(b){v[b]=w[b]}),v}function l(p,h){return Il(a(p,h),h)}function c(p,h,y,g){var w="C;Y"+(y+1)+";X"+(g+1)+";K";switch(p.t){case"n":w+=p.v||0,p.f&&!p.F&&(w+=";E"+k2(p.f,{r:y,c:g}));break;case"b":w+=p.v?"TRUE":"FALSE";break;case"e":w+=p.w||p.v;break;case"d":w+='"'+(p.w||p.v)+'"';break;case"s":w+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(p,h){h.forEach(function(y,g){var w="F;W"+(g+1)+" "+(g+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=em(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=tm(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&p.push(w)})}function d(p,h){h.forEach(function(y,g){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*rm(y.hpx)+";"),w.length>2&&p.push(w+"R"+(g+1))})}function m(p,h){var y=["ID;PWXL;N;E"],g=[],w=_r(p["!ref"]),v,b=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&u(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var E=w.s.r;E<=w.e.r;++E)for(var D=w.s.c;D<=w.e.c;++D){var I=sr({r:E,c:D});v=b?(p[E]||[])[D]:p[I],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,p,E,D))}return y.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:l,to_sheet:a,from_sheet:m}}(),NL=function(){function e(i,a){switch(a.type){case"base64":return t(Ta(i),a);case"binary":return t(i,a);case"buffer":return t(Gt&&Buffer.isBuffer(i)?i.toString("binary"):Af(i),a);case"array":return t(Wm(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){for(var l=i.split(`
`),c=-1,u=-1,d=0,m=[];d!==l.length;++d){if(l[d].trim()==="BOT"){m[++c]=[],u=0;continue}if(!(c<0)){var p=l[d].trim().split(","),h=p[0],y=p[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+h){case-1:if(g==="BOT"){m[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?m[c][u]=!0:g==="FALSE"?m[c][u]=!1:isNaN(ba(y))?isNaN(mf(y).getDate())?m[c][u]=y:m[c][u]=Qn(y):m[c][u]=ba(y),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),m[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(m=m.slice(0,a.sheetRows)),m}function r(i,a){return xu(e(i,a),a)}function n(i,a){return Il(r(i,a),a)}var s=function(){var i=function(c,u,d,m,p){c.push(u),c.push(d+","+m),c.push('"'+p.replace(/"/g,'""')+'"')},a=function(c,u,d,m){c.push(u+","+d),c.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var u=[],d=_r(c["!ref"]),m,p=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){a(u,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var g=sr({r:h,c:y});if(m=p?(c[h]||[])[y]:c[g],!m){a(u,1,0,"");continue}switch(m.t){case"n":var w=m.w;!w&&m.v!=null&&(w=m.v),w==null?m.f&&!m.F?a(u,1,0,"="+m.f):a(u,1,0,""):a(u,0,w,"V");break;case"b":a(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Fo(m.z||Dr[14],gs(Qn(m.v)))),a(u,0,m.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var v=`\r
`,b=u.join(v);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),M3=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,p){for(var h=m.split(`
`),y=-1,g=-1,w=0,v=[];w!==h.length;++w){var b=h[w].trim().split(":");if(b[0]==="cell"){var _=gn(b[1]);if(v.length<=_.r)for(y=v.length;y<=_.r;++y)v[y]||(v[y]=[]);switch(y=_.r,g=_.c,b[2]){case"t":v[y][g]=e(b[3]);break;case"v":v[y][g]=+b[3];break;case"vtf":var E=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[y][g]=!!+b[4];break;default:v[y][g]=+b[4];break}b[2]=="vtf"&&(v[y][g]=[v[y][g],E])}}}return p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}function n(m,p){return xu(r(m,p),p)}function s(m,p){return Il(n(m,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var p=[],h=[],y,g="",w=Rs(m["!ref"]),v=Array.isArray(m),b=w.s.r;b<=w.e.r;++b)for(var _=w.s.c;_<=w.e.c;++_)if(g=sr({r:b,c:_}),y=v?(m[b]||[])[_]:m[g],!(!y||y.v==null||y.t==="z")){switch(h=["cell",g,"t"],y.t){case"s":case"str":h.push(t(y.v));break;case"n":y.f?(h[2]="vtf",h[3]="n",h[4]=y.v,h[5]=t(y.f)):(h[2]="v",h[3]=y.v);break;case"b":h[2]="vt"+(y.f?"f":"c"),h[3]="nl",h[4]=y.v?"1":"0",h[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var E=gs(Qn(y.v));h[2]="vtc",h[3]="nd",h[4]=""+E,h[5]=y.w||Fo(y.z||Dr[14],E);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(m){return[i,a,l,a,u(m),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),SL=function(){function e(d,m,p,h,y){y.raw?m[p][h]=d:d===""||(d==="TRUE"?m[p][h]=!0:d==="FALSE"?m[p][h]=!1:isNaN(ba(d))?isNaN(mf(d).getDate())?m[p][h]=d:m[p][h]=Qn(d):m[p][h]=ba(d))}function t(d,m){var p=m||{},h=[];if(!d||d.length===0)return h;for(var y=d.split(/[\r\n]/),g=y.length-1;g>=0&&y[g].length===0;)--g;for(var w=10,v=0,b=0;b<=g;++b)v=y[b].indexOf(" "),v==-1?v=y[b].length:v++,w=Math.max(w,v);for(b=0;b<=g;++b){h[b]=[];var _=0;for(e(y[b].slice(0,w).trim(),h,b,_,p),_=1;_<=(y[b].length-w)/10+1;++_)e(y[b].slice(w+(_-1)*10,w+_*10).trim(),h,b,_,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var m={},p=!1,h=0,y=0;h<d.length;++h)(y=d.charCodeAt(h))==34?p=!p:!p&&y in r&&(m[y]=(m[y]||0)+1);y=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&y.push([m[h],h]);if(!y.length){m=n;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&y.push([m[h],h])}return y.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[y.pop()[1]]||44}function i(d,m){var p=m||{},h="",y=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=s(d.slice(0,1024)):p&&p.FS?h=p.FS:h=s(d.slice(0,1024));var w=0,v=0,b=0,_=0,E=0,D=h.charCodeAt(0),I=!1,A=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var C=p.dateNF!=null?U7(p.dateNF):null;function M(){var j=d.slice(_,E),T={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)T.t="z";else if(p.raw)T.t="s",T.v=j;else if(j.trim().length===0)T.t="s",T.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(T.t="s",T.v=j.slice(2,-1).replace(/""/g,'"')):_F(j)?(T.t="n",T.f=j.slice(1)):(T.t="s",T.v=j);else if(j=="TRUE")T.t="b",T.v=!0;else if(j=="FALSE")T.t="b",T.v=!1;else if(!isNaN(b=ba(j)))T.t="n",p.cellText!==!1&&(T.w=j),T.v=b;else if(!isNaN(mf(j).getDate())||C&&j.match(C)){T.z=p.dateNF||Dr[14];var q=0;C&&j.match(C)&&(j=z7(j,p.dateNF,j.match(C)||[]),q=1),p.cellDates?(T.t="d",T.v=Qn(j,q)):(T.t="n",T.v=gs(Qn(j,q))),p.cellText!==!1&&(T.w=Fo(T.z,T.v instanceof Date?gs(T.v):T.v)),p.cellNF||delete T.z}else T.t="s",T.v=j;if(T.t=="z"||(p.dense?(y[w]||(y[w]=[]),y[w][v]=T):y[sr({c:v,r:w})]=T),_=E+1,P=d.charCodeAt(_),g.e.c<v&&(g.e.c=v),g.e.r<w&&(g.e.r=w),A==D)++v;else if(v=0,++w,p.sheetRows&&p.sheetRows<=w)return!0}e:for(;E<d.length;++E)switch(A=d.charCodeAt(E)){case 34:P===34&&(I=!I);break;case D:case 10:case 13:if(!I&&M())break e;break}return E-_>0&&M(),y["!ref"]=Zr(g),y}function a(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,m):xu(t(d,m),m)}function l(d,m){var p="",h=m.type=="string"?[0,0,0,0]:II(d,m);switch(m.type){case"base64":p=Ta(d);break;case"binary":p=d;break;case"buffer":m.codepage==65001?p=d.toString("utf8"):(m.codepage,p=Gt&&Buffer.isBuffer(d)?d.toString("binary"):Af(d));break;case"array":p=Wm(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=Id(p.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?p=Id(p):m.type=="binary",p.slice(0,19)=="socialcalc:version:"?M3.to_sheet(m.type=="string"?p:Id(p),m):a(p,m)}function c(d,m){return Il(l(d,m),m)}function u(d){for(var m=[],p=_r(d["!ref"]),h,y=Array.isArray(d),g=p.s.r;g<=p.e.r;++g){for(var w=[],v=p.s.c;v<=p.e.c;++v){var b=sr({r:g,c:v});if(h=y?(d[g]||[])[v]:d[b],!h||h.v==null){w.push("          ");continue}for(var _=(h.w||(Ca(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(v===0?" ":""))}m.push(w.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}(),$5=function(){function e(S,L,R){if(S){Ts(S,S.l||0);for(var O=R.Enum||se;S.l<S.length;){var V=S.read_shift(2),ne=O[V]||O[65535],ue=S.read_shift(2),fe=S.l+ue,ye=ne.f&&ne.f(S,ue,R);if(S.l=fe,L(ye,ne,V))return}}}function t(S,L){switch(L.type){case"base64":return r(ki(Ta(S)),L);case"binary":return r(ki(S),L);case"buffer":case"array":return r(S,L)}throw"Unsupported type "+L.type}function r(S,L){if(!S)return S;var R=L||{},O=R.dense?[]:{},V="Sheet1",ne="",ue=0,fe={},ye=[],pe=[],_e={s:{r:0,c:0},e:{r:0,c:0}},Ue=R.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)R.Enum=se,e(S,function(Me,rt,He){switch(He){case 0:R.vers=Me,Me>=4096&&(R.qpro=!0);break;case 6:_e=Me;break;case 204:Me&&(ne=Me);break;case 222:ne=Me;break;case 15:case 51:R.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:He==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=R.dateNF||Dr[14],R.cellDates&&(Me[1].t="d",Me[1].v=t3(Me[1].v))),R.qpro&&Me[3]>ue&&(O["!ref"]=Zr(_e),fe[V]=O,ye.push(V),O=R.dense?[]:{},_e={s:{r:0,c:0},e:{r:0,c:0}},ue=Me[3],V=ne||"Sheet"+(ue+1),ne="");var Ke=R.dense?(O[Me[0].r]||[])[Me[0].c]:O[sr(Me[0])];if(Ke){Ke.t=Me[1].t,Ke.v=Me[1].v,Me[1].z!=null&&(Ke.z=Me[1].z),Me[1].f!=null&&(Ke.f=Me[1].f);break}R.dense?(O[Me[0].r]||(O[Me[0].r]=[]),O[Me[0].r][Me[0].c]=Me[1]):O[sr(Me[0])]=Me[1];break}},R);else if(S[2]==26||S[2]==14)R.Enum=me,S[2]==14&&(R.qpro=!0,S.l=0),e(S,function(Me,rt,He){switch(He){case 204:V=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>ue&&(O["!ref"]=Zr(_e),fe[V]=O,ye.push(V),O=R.dense?[]:{},_e={s:{r:0,c:0},e:{r:0,c:0}},ue=Me[3],V="Sheet"+(ue+1)),Ue>0&&Me[0].r>=Ue)break;R.dense?(O[Me[0].r]||(O[Me[0].r]=[]),O[Me[0].r][Me[0].c]=Me[1]):O[sr(Me[0])]=Me[1],_e.e.c<Me[0].c&&(_e.e.c=Me[0].c),_e.e.r<Me[0].r&&(_e.e.r=Me[0].r);break;case 27:Me[14e3]&&(pe[Me[14e3][0]]=Me[14e3][1]);break;case 1537:pe[Me[0]]=Me[1],Me[0]==ue&&(V=Me[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(O["!ref"]=Zr(_e),fe[ne||V]=O,ye.push(ne||V),!pe.length)return{SheetNames:ye,Sheets:fe};for(var Ve={},Se=[],le=0;le<pe.length;++le)fe[ye[le]]?(Se.push(pe[le]||ye[le]),Ve[pe[le]]=fe[pe[le]]||fe[ye[le]]):(Se.push(pe[le]),Ve[pe[le]]={"!ref":"A1"});return{SheetNames:Se,Sheets:Ve}}function n(S,L){var R=L||{};if(+R.codepage>=0&&ff(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var O=ps(),V=_r(S["!ref"]),ne=Array.isArray(S),ue=[];Qe(O,0,i(1030)),Qe(O,6,c(V));for(var fe=Math.min(V.e.r,8191),ye=V.s.r;ye<=fe;++ye)for(var pe=En(ye),_e=V.s.c;_e<=V.e.c;++_e){ye===V.s.r&&(ue[_e]=zn(_e));var Ue=ue[_e]+pe,Ve=ne?(S[ye]||[])[_e]:S[Ue];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?Qe(O,13,h(ye,_e,Ve.v)):Qe(O,14,g(ye,_e,Ve.v));else{var Se=Ca(Ve);Qe(O,15,m(ye,_e,Se.slice(0,239)))}}return Qe(O,1),O.end()}function s(S,L){var R=L||{};if(+R.codepage>=0&&ff(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var O=ps();Qe(O,0,a(S));for(var V=0,ne=0;V<S.SheetNames.length;++V)(S.Sheets[S.SheetNames[V]]||{})["!ref"]&&Qe(O,27,Y(S.SheetNames[V],ne++));var ue=0;for(V=0;V<S.SheetNames.length;++V){var fe=S.Sheets[S.SheetNames[V]];if(!(!fe||!fe["!ref"])){for(var ye=_r(fe["!ref"]),pe=Array.isArray(fe),_e=[],Ue=Math.min(ye.e.r,8191),Ve=ye.s.r;Ve<=Ue;++Ve)for(var Se=En(Ve),le=ye.s.c;le<=ye.e.c;++le){Ve===ye.s.r&&(_e[le]=zn(le));var Me=_e[le]+Se,rt=pe?(fe[Ve]||[])[le]:fe[Me];if(!(!rt||rt.t=="z"))if(rt.t=="n")Qe(O,23,M(Ve,le,ue,rt.v));else{var He=Ca(rt);Qe(O,22,A(Ve,le,ue,He.slice(0,239)))}}++ue}}return Qe(O,1),O.end()}function i(S){var L=Oe(2);return L.write_shift(2,S),L}function a(S){var L=Oe(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var R=0,O=0,V=0,ne=0;ne<S.SheetNames.length;++ne){var ue=S.SheetNames[ne],fe=S.Sheets[ue];if(!(!fe||!fe["!ref"])){++V;var ye=Rs(fe["!ref"]);R<ye.e.r&&(R=ye.e.r),O<ye.e.c&&(O=ye.e.c)}}return R>8191&&(R=8191),L.write_shift(2,R),L.write_shift(1,V),L.write_shift(1,O),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function l(S,L,R){var O={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&R.qpro?(O.s.c=S.read_shift(1),S.l++,O.s.r=S.read_shift(2),O.e.c=S.read_shift(1),S.l++,O.e.r=S.read_shift(2),O):(O.s.c=S.read_shift(2),O.s.r=S.read_shift(2),L==12&&R.qpro&&(S.l+=2),O.e.c=S.read_shift(2),O.e.r=S.read_shift(2),L==12&&R.qpro&&(S.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(S){var L=Oe(8);return L.write_shift(2,S.s.c),L.write_shift(2,S.s.r),L.write_shift(2,S.e.c),L.write_shift(2,S.e.r),L}function u(S,L,R){var O=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(O[0].c=S.read_shift(1),O[3]=S.read_shift(1),O[0].r=S.read_shift(2),S.l+=2):(O[2]=S.read_shift(1),O[0].c=S.read_shift(2),O[0].r=S.read_shift(2)),O}function d(S,L,R){var O=S.l+L,V=u(S,L,R);if(V[1].t="s",R.vers==20768){S.l++;var ne=S.read_shift(1);return V[1].v=S.read_shift(ne,"utf8"),V}return R.qpro&&S.l++,V[1].v=S.read_shift(O-S.l,"cstr"),V}function m(S,L,R){var O=Oe(7+R.length);O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,S),O.write_shift(1,39);for(var V=0;V<O.length;++V){var ne=R.charCodeAt(V);O.write_shift(1,ne>=128?95:ne)}return O.write_shift(1,0),O}function p(S,L,R){var O=u(S,L,R);return O[1].v=S.read_shift(2,"i"),O}function h(S,L,R){var O=Oe(7);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,S),O.write_shift(2,R,"i"),O}function y(S,L,R){var O=u(S,L,R);return O[1].v=S.read_shift(8,"f"),O}function g(S,L,R){var O=Oe(13);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,S),O.write_shift(8,R,"f"),O}function w(S,L,R){var O=S.l+L,V=u(S,L,R);if(V[1].v=S.read_shift(8,"f"),R.qpro)S.l=O;else{var ne=S.read_shift(2);E(S.slice(S.l,S.l+ne),V),S.l+=ne}return V}function v(S,L,R){var O=L&32768;return L&=-32769,L=(O?S:0)+(L>=8192?L-16384:L),(O?"":"$")+(R?zn(L):En(L))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(S,L){Ts(S,0);for(var R=[],O=0,V="",ne="",ue="",fe="";S.l<S.length;){var ye=S[S.l++];switch(ye){case 0:R.push(S.read_shift(8,"f"));break;case 1:ne=v(L[0].c,S.read_shift(2),!0),V=v(L[0].r,S.read_shift(2),!1),R.push(ne+V);break;case 2:{var pe=v(L[0].c,S.read_shift(2),!0),_e=v(L[0].r,S.read_shift(2),!1);ne=v(L[0].c,S.read_shift(2),!0),V=v(L[0].r,S.read_shift(2),!1),R.push(pe+_e+":"+ne+V)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(S.read_shift(2));break;case 6:{for(var Ue="";ye=S[S.l++];)Ue+=String.fromCharCode(ye);R.push('"'+Ue.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:fe=R.pop(),ue=R.pop(),R.push(["AND","OR"][ye-20]+"("+ue+","+fe+")");break;default:if(ye<32&&_[ye])fe=R.pop(),ue=R.pop(),R.push(ue+_[ye]+fe);else if(b[ye]){if(O=b[ye][1],O==69&&(O=S[S.l++]),O>R.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+R.join("|")+"|");return}var Ve=R.slice(-O);R.length-=O,R.push(b[ye][0]+"("+Ve.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}R.length==1?L[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function D(S){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=S.read_shift(2),L[3]=S[S.l++],L[0].c=S[S.l++],L}function I(S,L){var R=D(S);return R[1].t="s",R[1].v=S.read_shift(L-4,"cstr"),R}function A(S,L,R,O){var V=Oe(6+O.length);V.write_shift(2,S),V.write_shift(1,R),V.write_shift(1,L),V.write_shift(1,39);for(var ne=0;ne<O.length;++ne){var ue=O.charCodeAt(ne);V.write_shift(1,ue>=128?95:ue)}return V.write_shift(1,0),V}function P(S,L){var R=D(S);R[1].v=S.read_shift(2);var O=R[1].v>>1;if(R[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return R[1].v=O,R}function C(S,L){var R=D(S),O=S.read_shift(4),V=S.read_shift(4),ne=S.read_shift(2);if(ne==65535)return O===0&&V===3221225472?(R[1].t="e",R[1].v=15):O===0&&V===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var ue=ne&32768;return ne=(ne&32767)-16446,R[1].v=(1-ue*2)*(V*Math.pow(2,ne+32)+O*Math.pow(2,ne)),R}function M(S,L,R,O){var V=Oe(14);if(V.write_shift(2,S),V.write_shift(1,R),V.write_shift(1,L),O==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var ne=0,ue=0,fe=0,ye=0;return O<0&&(ne=1,O=-O),ue=Math.log2(O)|0,O/=Math.pow(2,ue-31),ye=O>>>0,ye&2147483648||(O/=2,++ue,ye=O>>>0),O-=ye,ye|=2147483648,ye>>>=0,O*=Math.pow(2,32),fe=O>>>0,V.write_shift(4,fe),V.write_shift(4,ye),ue+=16383+(ne?32768:0),V.write_shift(2,ue),V}function j(S,L){var R=C(S);return S.l+=L-14,R}function T(S,L){var R=D(S),O=S.read_shift(4);return R[1].v=O>>6,R}function q(S,L){var R=D(S),O=S.read_shift(8,"f");return R[1].v=O,R}function U(S,L){var R=q(S);return S.l+=L-10,R}function re(S,L){return S[S.l+L-1]==0?S.read_shift(L,"cstr"):""}function z(S,L){var R=S[S.l++];R>L-1&&(R=L-1);for(var O="";O.length<R;)O+=String.fromCharCode(S[S.l++]);return O}function G(S,L,R){if(!(!R.qpro||L<21)){var O=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var V=S.read_shift(L-21,"cstr");return[O,V]}}function B(S,L){for(var R={},O=S.l+L;S.l<O;){var V=S.read_shift(2);if(V==14e3){for(R[V]=[0,""],R[V][0]=S.read_shift(2);S[S.l];)R[V][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return R}function Y(S,L){var R=Oe(5+S.length);R.write_shift(2,14e3),R.write_shift(2,L);for(var O=0;O<S.length;++O){var V=S.charCodeAt(O);R[R.l++]=V>127?95:V}return R[R.l++]=0,R}var se={0:{n:"BOF",f:F3},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:B},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:G},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),kL=/^\s|\s$|[\t\n\r]/;function B3(e,t){if(!t.bookSST)return"";var r=[tn];r[r.length]=Je("sst",null,{xmlns:gu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(kL)&&(i+=' xml:space="preserve"'),i+=">"+rr(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function jL(e){return[e.read_shift(4),e.read_shift(4)]}function EL(e,t){return t||(t=Oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var AL=vP;function TL(e){var t=ps();Be(t,159,EL(e));for(var r=0;r<e.length;++r)Be(t,19,AL(e[r]));return Be(t,160),t.end()}function CL(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function U3(e){var t=0,r,n=CL(e),s=n.length+1,i,a,l,c,u;for(r=Al(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^a;return t^52811}var PL=function(){function e(s,i){switch(i.type){case"base64":return t(Ta(s),i);case"binary":return t(s,i);case"buffer":return t(Gt&&Buffer.isBuffer(s)?s.toString("binary"):Af(s),i);case"array":return t(Wm(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var a=i||{},l=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,m){Array.isArray(l)&&(l[m]=[]);for(var p=/\\\w+\b/g,h=0,y,g=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var w=d.slice(h,p.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var v={v:w,t:"s"};Array.isArray(l)?l[m][g]=v:l[sr({r:m,c:g})]=v}break}h=p.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=Zr(u),l}function r(s,i){return Il(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=_r(s["!ref"]),l,c=Array.isArray(s),u=a.s.r;u<=a.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var m=sr({r:u,c:d});l=c?(s[u]||[])[d]:s[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Ca(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function q5(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var LL=6,_a=LL;function em(e){return Math.floor((e+Math.round(128/_a)/256)*_a)}function tm(e){return Math.floor((e-5)/_a*100+.5)/100}function Xg(e){return Math.round((e*_a+5)/_a*256)/256}function N2(e){e.width?(e.wpx=em(e.width),e.wch=tm(e.wpx),e.MDW=_a):e.wpx?(e.wch=tm(e.wpx),e.width=Xg(e.wch),e.MDW=_a):typeof e.wch=="number"&&(e.width=Xg(e.wch),e.wpx=em(e.width),e.MDW=_a),e.customWidth&&delete e.customWidth}var FL=96,z3=FL;function rm(e){return e*96/z3}function W3(e){return e*z3/96}function OL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Je("numFmt",null,{numFmtId:n,formatCode:rr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Je("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function DL(e){var t=[];return t[t.length]=Je("cellXfs",null),e.forEach(function(r){t[t.length]=Je("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Je("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function H3(e,t){var r=[tn,Je("styleSheet",null,{xmlns:gu[0],"xmlns:vt":pn.vt})],n;return e.SSF&&(n=OL(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=DL(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function IL(e,t){var r=e.read_shift(2),n=Wn(e);return[r,n]}function RL(e,t,r){r||(r=Oe(6+4*t.length)),r.write_shift(2,e),xn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function ML(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=kP(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=SP(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wn(e),n}function BL(e,t){t||(t=Oe(25+4*32)),t.write_shift(2,e.sz*20),jP(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Q0(e.color,t);var n=0;return n=2,t.write_shift(1,n),xn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var UL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],N1,zL=Zi;function V5(e,t){t||(t=Oe(4*3+8*7+16*1)),N1||(N1=d2(UL));var r=N1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Q0({auto:1},t),Q0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function WL(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function $3(e,t,r){r||(r=Oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ld(e,t){return t||(t=Oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var HL=Zi;function $L(e,t){return t||(t=Oe(51)),t.write_shift(1,0),ld(null,t),ld(null,t),ld(null,t),ld(null,t),ld(null,t),t.length>t.l?t.slice(0,t.l):t}function qL(e,t){return t||(t=Oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),J0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function VL(e,t,r){var n=Oe(2052);return n.write_shift(4,e),J0(t,n),J0(r,n),n.length>n.l?n.slice(0,n.l):n}function GL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Be(e,615,Ti(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Be(e,44,RL(s,t[s]))}),Be(e,616))}}function YL(e){var t=1;Be(e,611,Ti(t)),Be(e,43,BL({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(e,612)}function KL(e){var t=2;Be(e,603,Ti(t)),Be(e,45,V5({patternType:"none"})),Be(e,45,V5({patternType:"gray125"})),Be(e,604)}function XL(e){var t=1;Be(e,613,Ti(t)),Be(e,46,$L()),Be(e,614)}function JL(e){var t=1;Be(e,626,Ti(t)),Be(e,47,$3({numFmtId:0},65535)),Be(e,627)}function QL(e,t){Be(e,617,Ti(t.length)),t.forEach(function(r){Be(e,47,$3(r,0))}),Be(e,618)}function ZL(e){var t=1;Be(e,619,Ti(t)),Be(e,48,qL({xfId:0,name:"Normal"})),Be(e,620)}function eF(e){var t=0;Be(e,505,Ti(t)),Be(e,506)}function tF(e){var t=0;Be(e,508,VL(t,"TableStyleMedium9","PivotStyleMedium4")),Be(e,509)}function rF(e,t){var r=ps();return Be(r,278),GL(r,e.SSF),YL(r),KL(r),XL(r),JL(r),QL(r,t.cellXfs),ZL(r),eF(r),tF(r),Be(r,279),r.end()}function q3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[tn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function nF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wn(e)}}function sF(e){var t=Oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),xn(e.name,t),t.slice(0,t.l)}function iF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function aF(e){var t=Oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function oF(e,t){var r=Oe(8+2*t.length);return r.write_shift(4,e),xn(t,r),r.slice(0,r.l)}function lF(e){return e.l+=4,e.read_shift(4)!=0}function cF(e,t){var r=Oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function uF(){var e=ps();return Be(e,332),Be(e,334,Ti(1)),Be(e,335,sF({name:"XLDAPR",version:12e4,flags:3496657072})),Be(e,336),Be(e,339,oF(1,"XLDAPR")),Be(e,52),Be(e,35,Ti(514)),Be(e,4096,Ti(0)),Be(e,4097,Js(1)),Be(e,36),Be(e,53),Be(e,340),Be(e,337,cF(1)),Be(e,51,aF([[1,0]])),Be(e,338),Be(e,333),e.end()}function V3(){var e=[tn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function dF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=sr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Rc=1024;function G3(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Je("xml",null,{"xmlns:v":Cs.v,"xmlns:o":Cs.o,"xmlns:x":Cs.x,"xmlns:mv":Cs.mv}).replace(/\/>/,">"),Je("o:shapelayout",Je("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Je("v:shapetype",[Je("v:stroke",null,{joinstyle:"miter"}),Je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Rc<e*1e3;)Rc+=1e3;return t.forEach(function(i){var a=gn(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Je("v:fill",c,l),d={on:"t",obscured:"t"};++Rc,s=s.concat(["<v:shape"+gf({id:"_x0000_s"+Rc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Je("v:shadow",null,d),Je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),kn("x:AutoFill","False"),kn("x:Row",String(a.r)),kn("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Y3(e){var t=[tn,Je("comments",null,{xmlns:gu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=rr(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(rr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(kn("t",rr(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)a+=`Reply:
    `+i[l]+`
`;t.push(kn("t",rr(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function fF(e,t,r){var n=[tn,Je("ThreadedComments",null,{xmlns:pn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(Je("threadedComment",kn("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function hF(e){var t=[tn,Je("personList",null,{xmlns:pn.TCMNT,"xmlns:x":gu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function mF(e){var t={};t.iauthor=e.read_shift(4);var r=Ul(e);return t.rfx=r.s,t.ref=sr(r.s),e.l+=16,t}function pF(e,t){return t==null&&(t=Oe(36)),t.write_shift(4,e[1].iauthor),vu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var gF=Wn;function xF(e){return xn(e.slice(0,54))}function vF(e){var t=ps(),r=[];return Be(t,628),Be(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Be(t,632,xF(s.a)))})}),Be(t,631),Be(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:gn(n[0]),e:gn(n[0])};Be(t,635,pF([i,s])),s.t&&s.t.length>0&&Be(t,637,wP(s)),Be(t,636),delete s.iauthor})}),Be(t,634),Be(t,629),t.end()}function yF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&or.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var K3=["xlsb","xlsm","xlam","biff8","xla"],wF=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,a){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,s+(l?"":"$")+zn(d)+(c?"":"$")+En(u)}return function(s,i){return t=i,s.replace(e,r)}}(),S2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,k2=function(){return function(t,r){return t.replace(S2,function(n,s,i,a,l,c){var u=v2(a)-(i?0:r.c),d=x2(c)-(l?0:r.r),m=d==0?"":l?d+1:"["+d+"]",p=u==0?"":i?u+1:"["+u+"]";return s+"R"+m+"C"+p})}}();function bF(e,t){return e.replace(S2,function(r,n,s,i,a,l){return n+(s=="$"?s+i:zn(v2(i)+t.c))+(a=="$"?a+l:En(x2(l)+t.r))})}function _F(e){return e.length!=1}function Kr(e){e.l+=1}function Oo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function X3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return J3(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),a=Oo(e),l=Oo(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function J3(e){var t=Oo(e),r=Oo(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function NF(e,t,r){if(r.biff<8)return J3(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Oo(e),a=Oo(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Q3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SF(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Oo(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function SF(e){var t=Oo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function jF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EF(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:l}}function EF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function AF(e,t,r){var n=(e[e.l++]&96)>>5,s=X3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function TF(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=X3(e,i,r);return[n,s,a]}function CF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function PF(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function LF(e,t,r){var n=(e[e.l++]&96)>>5,s=NF(e,t-1,r);return[n,s]}function FF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function G5(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function OF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function DF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function IF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function RF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function MF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Z3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function BF(e){return e.read_shift(2),Z3(e)}function UF(e){return e.read_shift(2),Z3(e)}function zF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Q3(e,0,r);return[n,s]}function WF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=jF(e,0,r);return[n,s]}function HF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Q3(e,0,r);return[n,s,i]}function $F(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[$O[s],rN[s],n]}function qF(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:VF(e);return[s,(i[0]===0?rN:HO)[i[1]]]}function VF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function GF(e,t,r){e.l+=r&&r.biff==2?3:4}function YF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function KF(e){return e.l++,Pf[e.read_shift(1)]}function XF(e){return e.l++,e.read_shift(2)}function JF(e){return e.l++,e.read_shift(1)!==0}function QF(e){return e.l++,yu(e)}function ZF(e,t,r){return e.l++,D3(e,t-1,r)}function eO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=HP(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Pf[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=yu(e);break;case 2:r[1]=GP(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function tO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Ul:XP)(e));return s}function rO(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var l=0;l!=s;++l)a[i][l]=eO(e,r.biff);return a}function nO(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function sO(e,t,r){if(r.biff==5)return iO(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function iO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function aO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function oO(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function lO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function cO(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var uO=Zi,dO=Zi,fO=Zi;function Lf(e,t,r){return e.l+=2,[kF(e)]}function j2(e){return e.l+=6,[]}var hO=Lf,mO=j2,pO=j2,gO=Lf;function eN(e){return e.l+=2,[F3(e),e.read_shift(2)&1]}var xO=Lf,vO=eN,yO=j2,wO=Lf,bO=Lf,_O=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),a=_O[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:s,C:i}}function SO(e){return e.l+=2,[e.read_shift(4)]}function kO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function jO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function EO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TO(e){return e.l+=4,[0,0]}var Y5={1:{n:"PtgExp",f:YF},2:{n:"PtgTbl",f:fO},3:{n:"PtgAdd",f:Kr},4:{n:"PtgSub",f:Kr},5:{n:"PtgMul",f:Kr},6:{n:"PtgDiv",f:Kr},7:{n:"PtgPower",f:Kr},8:{n:"PtgConcat",f:Kr},9:{n:"PtgLt",f:Kr},10:{n:"PtgLe",f:Kr},11:{n:"PtgEq",f:Kr},12:{n:"PtgGe",f:Kr},13:{n:"PtgGt",f:Kr},14:{n:"PtgNe",f:Kr},15:{n:"PtgIsect",f:Kr},16:{n:"PtgUnion",f:Kr},17:{n:"PtgRange",f:Kr},18:{n:"PtgUplus",f:Kr},19:{n:"PtgUminus",f:Kr},20:{n:"PtgPercent",f:Kr},21:{n:"PtgParen",f:Kr},22:{n:"PtgMissArg",f:Kr},23:{n:"PtgStr",f:ZF},26:{n:"PtgSheet",f:kO},27:{n:"PtgEndSheet",f:jO},28:{n:"PtgErr",f:KF},29:{n:"PtgBool",f:JF},30:{n:"PtgInt",f:XF},31:{n:"PtgNum",f:QF},32:{n:"PtgArray",f:FF},33:{n:"PtgFunc",f:$F},34:{n:"PtgFuncVar",f:qF},35:{n:"PtgName",f:nO},36:{n:"PtgRef",f:zF},37:{n:"PtgArea",f:AF},38:{n:"PtgMemArea",f:aO},39:{n:"PtgMemErr",f:uO},40:{n:"PtgMemNoMem",f:dO},41:{n:"PtgMemFunc",f:oO},42:{n:"PtgRefErr",f:lO},43:{n:"PtgAreaErr",f:CF},44:{n:"PtgRefN",f:WF},45:{n:"PtgAreaN",f:LF},46:{n:"PtgMemAreaN",f:EO},47:{n:"PtgMemNoMemN",f:AO},57:{n:"PtgNameX",f:sO},58:{n:"PtgRef3d",f:HF},59:{n:"PtgArea3d",f:TF},60:{n:"PtgRefErr3d",f:cO},61:{n:"PtgAreaErr3d",f:PF},255:{}},CO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},PO={1:{n:"PtgElfLel",f:eN},2:{n:"PtgElfRw",f:wO},3:{n:"PtgElfCol",f:hO},6:{n:"PtgElfRwV",f:bO},7:{n:"PtgElfColV",f:gO},10:{n:"PtgElfRadical",f:xO},11:{n:"PtgElfRadicalS",f:yO},13:{n:"PtgElfColS",f:mO},15:{n:"PtgElfColSV",f:pO},16:{n:"PtgElfRadicalLel",f:vO},25:{n:"PtgList",f:NO},29:{n:"PtgSxName",f:SO},255:{}},LO={0:{n:"PtgAttrNoop",f:TO},1:{n:"PtgAttrSemi",f:MF},2:{n:"PtgAttrIf",f:IF},4:{n:"PtgAttrChoose",f:OF},8:{n:"PtgAttrGoto",f:DF},16:{n:"PtgAttrSum",f:GF},32:{n:"PtgAttrBaxcel",f:G5},33:{n:"PtgAttrBaxcel",f:G5},64:{n:"PtgAttrSpace",f:BF},65:{n:"PtgAttrSpaceSemi",f:UF},128:{n:"PtgAttrIfError",f:RF},255:{}};function FO(e,t,r,n){if(n.biff<8)return Zi(e,t);for(var s=e.l+t,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=rO(e,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=tO(e,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=s-e.l,t!==0&&i.push(Zi(e,t)),i}function OO(e,t,r){for(var n=e.l+t,s,i,a=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Y5[i]||Y5[CO[i]],(i===24||i===25)&&(s=(i===24?PO:LO)[e[e.l+1]]),!s||!s.f?Zi(e,t):a.push([s.n,s.f(e,t,r)]);return a}function DO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var IO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function RO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function tN(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function K5(e,t,r){var n=tN(e,t,r);return n=="#REF"?n:RO(n,r)}function au(e,t,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},l=[],c,u,d,m=0,p=0,h,y="";if(!e[0]||!e[0][0])return"";for(var g=-1,w="",v=0,b=e[0].length;v<b;++v){var _=e[0][v];switch(_[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:w=Or(" ",e[0][g][1][1]);break;case 1:w=Or("\r",e[0][g][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+w,g=-1}l.push(u+IO[_[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Md(_[1][1],a,s),l.push(Bd(d,i));break;case"PtgRefN":d=r?Md(_[1][1],r,s):_[1][1],l.push(Bd(d,i));break;case"PtgRef3d":m=_[1][1],d=Md(_[1][2],a,s),y=K5(n,m,s),l.push(y+"!"+Bd(d,i));break;case"PtgFunc":case"PtgFuncVar":var E=_[1][0],D=_[1][1];E||(E=0),E&=127;var I=E==0?[]:l.slice(-E);l.length-=E,D==="User"&&(D=I.shift()),l.push(D+"("+I.join(",")+")");break;case"PtgBool":l.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(_[1]);break;case"PtgNum":l.push(String(_[1]));break;case"PtgStr":l.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(_[1]);break;case"PtgAreaN":h=F5(_[1][1],r?{s:r}:a,s),l.push(b1(h,s));break;case"PtgArea":h=F5(_[1][1],a,s),l.push(b1(h,s));break;case"PtgArea3d":m=_[1][1],h=_[1][2],y=K5(n,m,s),l.push(y+"!"+b1(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var A=(n.names||[])[p-1]||(n[0]||[])[p],P=A?A.Name:"SH33TJSNAME"+String(p);P&&P.slice(0,6)=="_xlfn."&&!s.xlfn&&(P=P.slice(6)),l.push(P);break;case"PtgNameX":var C=_[1][1];p=_[1][2];var M;if(s.biff<=5)C<0&&(C=-C),n[C]&&(M=n[C][p]);else{var j="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][p]&&n[C][p].itab>0&&(j=n.SheetNames[n[C][p].itab-1]+"!"):j=n.SheetNames[p-1]+"!"),n[C]&&n[C][p])j+=n[C][p].Name;else if(n[0]&&n[0][p])j+=n[0][p].Name;else{var T=(tN(n,C,s)||"").split(";;");T[p-1]?j=T[p-1]:j+="SH33TJSERRX"}l.push(j);break}M||(M={Name:"SH33TJSERRY"}),l.push(M.Name);break;case"PtgParen":var q="(",U=")";if(g>=0){switch(w="",e[0][g][1][0]){case 2:q=Or(" ",e[0][g][1][1])+q;break;case 3:q=Or("\r",e[0][g][1][1])+q;break;case 4:U=Or(" ",e[0][g][1][1])+U;break;case 5:U=Or("\r",e[0][g][1][1])+U;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(q+l.pop()+U);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[sr(d)]){var z=n.sharedf[sr(d)];l.push(au(z,a,re,n,s))}else{var G=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(au(u[1],a,re,n,s)),G=!0;break}G||l.push(_[1])}break;case"PtgArray":l.push("{"+DO(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var B=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&B.indexOf(e[0][v][0])==-1){_=e[0][g];var Y=!0;switch(_[1][0]){case 4:Y=!1;case 0:w=Or(" ",_[1][1]);break;case 5:Y=!1;case 1:w=Or("\r",_[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}l.push((Y?w:"")+l.pop()+(Y?"":w)),g=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function MO(e){if(e==null){var t=Oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Tl(e);return Tl(0)}function BO(e,t,r,n,s){var i=Cl(t,r,s),a=MO(e.v),l=Oe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=Oe(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var m=Sn([i,a,l,u]);return m}function Hm(e,t,r){var n=e.read_shift(4),s=OO(e,n,r),i=e.read_shift(4),a=i>0?FO(e,i,s,r):null;return[s,a]}var UO=Hm,$m=Hm,zO=Hm,WO=Hm,HO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$O={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function qO(e){var t="of:="+e.replace(S2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function VO(e){return e.replace(/\./,"!")}var Ud=typeof Map<"u";function E2(e,t,r){var n=0,s=e.length;if(r){if(Ud?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Ud?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Ud?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function qm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(_a=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=tm(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Xg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function nN(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Wo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Q_(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function GO(e,t,r){if(e&&e["!ref"]){var n=_r(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function YO(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Zr(e[r])+'"/>';return t+"</mergeCells>"}function KO(e,t,r,n,s){var i=!1,a={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,a.codeName=pf(rr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Je("outlinePr",null,u)}!i&&!l||(s[s.length]=Je("sheetPr",l,a))}var XO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],JO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function QO(e){var t={sheet:1};return XO.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),JO.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=U3(e.password).toString(16).toUpperCase()),Je("sheetProtection",null,t)}function ZO(e){return nN(e),Je("pageMargins",null,e)}function eD(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Je("col",null,qm(s,n)));return r[r.length]="</cols>",r.join("")}function tD(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Zr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=Rs(s);a.s.r==a.e.r&&(a.e.r=Rs(t["!ref"]).e.r,s=Zr(a));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Je("autoFilter",null,{ref:s})}function rD(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Je("sheetViews",Je("sheetView",null,s),{})}function nD(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Pf[e.v];break;case"d":n&&n.cellDates?s=Qn(e.v,-1).toISOString():(e=xs(e),e.t="n",s=""+(e.v=gs(Qn(e.v)))),typeof e.z>"u"&&(e.z=Dr[14]);break;default:s=e.v;break}var l=kn("v",rr(s)),c={r:t},u=Wo(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=kn("v",""+E2(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=a),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Je("f",rr(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Je("c",l,c)}function sD(e,t,r,n){var s=[],i=[],a=_r(e["!ref"]),l="",c,u="",d=[],m=0,p=0,h=e["!rows"],y=Array.isArray(e),g={r:u},w,v=-1;for(p=a.s.c;p<=a.e.c;++p)d[p]=zn(p);for(m=a.s.r;m<=a.e.r;++m){for(i=[],u=En(m),p=a.s.c;p<=a.e.c;++p){c=d[p]+u;var b=y?(e[m]||[])[p]:e[c];b!==void 0&&(l=nD(b,c,e,t))!=null&&i.push(l)}(i.length>0||h&&h[m])&&(g={r:u},h&&h[m]&&(w=h[m],w.hidden&&(g.hidden=1),v=-1,w.hpx?v=rm(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(g.ht=v,g.customHeight=1),w.level&&(g.outlineLevel=w.level)),s[s.length]=Je("row",i.join(""),g))}if(h)for(;m<h.length;++m)h&&h[m]&&(g={r:m+1},w=h[m],w.hidden&&(g.hidden=1),v=-1,w.hpx?v=rm(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(g.ht=v,g.customHeight=1),w.level&&(g.outlineLevel=w.level),s[s.length]=Je("row","",g));return s.join("")}function sN(e,t,r,n){var s=[tn,Je("worksheet",null,{xmlns:gu[0],"xmlns:r":pn.r})],i=r.SheetNames[e],a=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=_r(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Zr(d)}n||(n={}),c["!comments"]=[];var m=[];KO(c,r,e,t,s),s[s.length]=Je("dimension",null,{ref:u}),s[s.length]=rD(c,t,e,r),t.sheetFormat&&(s[s.length]=Je("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=eD(c,c["!cols"])),s[a=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=sD(c,t),l.length>0&&(s[s.length]=l)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),c["!protect"]&&(s[s.length]=QO(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=tD(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=YO(c["!merges"]));var p=-1,h,y=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(y=er(n,-1,rr(g[1].Target).replace(/#.*$/,""),$t.HLINK),h["r:id"]="rId"+y),(p=g[1].Target.indexOf("#"))>-1&&(h.location=rr(g[1].Target.slice(p+1))),g[1].Tooltip&&(h.tooltip=rr(g[1].Tooltip)),s[s.length]=Je("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=ZO(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=kn("ignoredErrors",Je("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(y=er(n,-1,"../drawings/drawing"+(e+1)+".xml",$t.DRAW),s[s.length]=Je("drawing",null,{"r:id":"rId"+y}),c["!drawing"]=m),c["!comments"].length>0&&(y=er(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",$t.VML),s[s.length]=Je("legacyDrawing",null,{"r:id":"rId"+y}),c["!legacy"]=y),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function iD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function aD(e,t,r){var n=Oe(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=rm(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,p=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[sr(u)];y&&(m<0&&(m=h),p=h)}m<0||(++l,n.write_shift(4,m),n.write_shift(4,p))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function oD(e,t,r,n){var s=aD(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Be(e,0,s)}var lD=Ul,cD=vu;function uD(){}function dD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=bP(e),r}function fD(e,t,r){r==null&&(r=Oe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Q0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),y3(e,r),r.slice(0,r.l)}function hD(e){var t=ii(e);return[t]}function mD(e,t,r){return r==null&&(r=Oe(8)),Rl(t,r)}function pD(e){var t=Ml(e);return[t]}function gD(e,t,r){return r==null&&(r=Oe(4)),Bl(t,r)}function xD(e){var t=ii(e),r=e.read_shift(1);return[t,r,"b"]}function vD(e,t,r){return r==null&&(r=Oe(9)),Rl(t,r),r.write_shift(1,e.v?1:0),r}function yD(e){var t=Ml(e),r=e.read_shift(1);return[t,r,"b"]}function wD(e,t,r){return r==null&&(r=Oe(5)),Bl(t,r),r.write_shift(1,e.v?1:0),r}function bD(e){var t=ii(e),r=e.read_shift(1);return[t,r,"e"]}function _D(e,t,r){return r==null&&(r=Oe(9)),Rl(t,r),r.write_shift(1,e.v),r}function ND(e){var t=Ml(e),r=e.read_shift(1);return[t,r,"e"]}function SD(e,t,r){return r==null&&(r=Oe(8)),Bl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function kD(e){var t=ii(e),r=e.read_shift(4);return[t,r,"s"]}function jD(e,t,r){return r==null&&(r=Oe(12)),Rl(t,r),r.write_shift(4,t.v),r}function ED(e){var t=Ml(e),r=e.read_shift(4);return[t,r,"s"]}function AD(e,t,r){return r==null&&(r=Oe(8)),Bl(t,r),r.write_shift(4,t.v),r}function TD(e){var t=ii(e),r=yu(e);return[t,r,"n"]}function CD(e,t,r){return r==null&&(r=Oe(16)),Rl(t,r),Tl(e.v,r),r}function PD(e){var t=Ml(e),r=yu(e);return[t,r,"n"]}function LD(e,t,r){return r==null&&(r=Oe(12)),Bl(t,r),Tl(e.v,r),r}function FD(e){var t=ii(e),r=w3(e);return[t,r,"n"]}function OD(e,t,r){return r==null&&(r=Oe(12)),Rl(t,r),b3(e.v,r),r}function DD(e){var t=Ml(e),r=w3(e);return[t,r,"n"]}function ID(e,t,r){return r==null&&(r=Oe(8)),Bl(t,r),b3(e.v,r),r}function RD(e){var t=ii(e),r=y2(e);return[t,r,"is"]}function MD(e){var t=ii(e),r=Wn(e);return[t,r,"str"]}function BD(e,t,r){return r==null&&(r=Oe(12+4*e.v.length)),Rl(t,r),xn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function UD(e){var t=Ml(e),r=Wn(e);return[t,r,"str"]}function zD(e,t,r){return r==null&&(r=Oe(8+4*e.v.length)),Bl(t,r),xn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WD(e,t,r){var n=e.l+t,s=ii(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=$m(e,n-e.l,r);a[3]=au(l,null,s,r.supbooks,r)}else e.l=n;return a}function HD(e,t,r){var n=e.l+t,s=ii(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=$m(e,n-e.l,r);a[3]=au(l,null,s,r.supbooks,r)}else e.l=n;return a}function $D(e,t,r){var n=e.l+t,s=ii(e);s.r=r["!row"];var i=yu(e),a=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=$m(e,n-e.l,r);a[3]=au(l,null,s,r.supbooks,r)}else e.l=n;return a}function qD(e,t,r){var n=e.l+t,s=ii(e);s.r=r["!row"];var i=Wn(e),a=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=$m(e,n-e.l,r);a[3]=au(l,null,s,r.supbooks,r)}else e.l=n;return a}var VD=Ul,GD=vu;function YD(e,t){return t==null&&(t=Oe(4)),t.write_shift(4,e),t}function KD(e,t){var r=e.l+t,n=Ul(e),s=w2(e),i=Wn(e),a=Wn(e),l=Wn(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:l};return a&&(c.Tooltip=a),c}function XD(e,t){var r=Oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));vu({s:gn(e[0]),e:gn(e[0])},r),b2("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return xn(s||"",r),xn(e[1].Tooltip||"",r),xn("",r),r.slice(0,r.l)}function JD(){}function QD(e,t,r){var n=e.l+t,s=_3(e),i=e.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var l=UO(e,n-e.l,r);a[1]=l}else e.l=n;return a}function ZD(e,t,r){var n=e.l+t,s=Ul(e),i=[s];if(r.cellFormula){var a=WO(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}function e9(e,t,r){r==null&&(r=Oe(18));var n=qm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var iN=["left","right","top","bottom","header","footer"];function t9(e){var t={};return iN.forEach(function(r){t[r]=yu(e)}),t}function r9(e,t){return t==null&&(t=Oe(6*8)),nN(e),iN.forEach(function(r){Tl(e[r],t)}),t}function n9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function s9(e,t,r){r==null&&(r=Oe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function i9(e){var t=Oe(24);return t.write_shift(4,4),t.write_shift(4,1),vu(e,t),t}function a9(e,t){return t==null&&(t=Oe(16*4+2)),t.write_shift(2,e.password?U3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function o9(){}function l9(){}function c9(e,t,r,n,s,i,a){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=xs(t),t.z=t.z||Dr[14],t.v=gs(Qn(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Wo(s.cellXfs,t,s),t.l&&i["!links"].push([sr(c),t.l]),t.c&&i["!comments"].push([sr(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=E2(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,a?Be(e,18,AD(t,c)):Be(e,7,jD(t,c))):(c.t="str",a?Be(e,17,zD(t,c)):Be(e,6,BD(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Be(e,13,ID(t,c)):Be(e,2,OD(t,c)):a?Be(e,16,LD(t,c)):Be(e,5,CD(t,c)),!0;case"b":return c.t="b",a?Be(e,15,wD(t,c)):Be(e,4,vD(t,c)),!0;case"e":return c.t="e",a?Be(e,14,SD(t,c)):Be(e,3,_D(t,c)),!0}return a?Be(e,12,gD(t,c)):Be(e,1,mD(t,c)),!0}function u9(e,t,r,n){var s=_r(t["!ref"]||"A1"),i,a="",l=[];Be(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){a=En(d),oD(e,t,s,d);var m=!1;if(d<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){d===s.s.r&&(l[p]=zn(p)),i=l[p]+a;var h=c?(t[d]||[])[p]:t[i];if(!h){m=!1;continue}m=c9(e,h,d,p,n,t,m)}}Be(e,146)}function d9(e,t){!t||!t["!merges"]||(Be(e,177,YD(t["!merges"].length)),t["!merges"].forEach(function(r){Be(e,176,GD(r))}),Be(e,178))}function f9(e,t){!t||!t["!cols"]||(Be(e,390),t["!cols"].forEach(function(r,n){r&&Be(e,60,e9(n,r))}),Be(e,391))}function h9(e,t){!t||!t["!ref"]||(Be(e,648),Be(e,649,i9(_r(t["!ref"]))),Be(e,650))}function m9(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=er(r,-1,n[1].Target.replace(/#.*$/,""),$t.HLINK);Be(e,494,XD(n,s))}}),delete t["!links"]}function p9(e,t,r,n){if(t["!comments"].length>0){var s=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$t.VML);Be(e,551,b2("rId"+s)),t["!legacy"]=s}}function g9(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:Zr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,l=Rs(i);l.s.r==l.e.r&&(l.e.r=Rs(t["!ref"]).e.r,i=Zr(l));for(var c=0;c<a.length;++c){var u=a[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Be(e,161,vu(_r(i))),Be(e,162)}}function x9(e,t,r){Be(e,133),Be(e,137,s9(t,r)),Be(e,138),Be(e,134)}function v9(e,t){t["!protect"]&&Be(e,535,a9(t["!protect"]))}function y9(e,t,r,n){var s=ps(),i=r.SheetNames[e],a=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=_r(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Be(s,129),(r.vbaraw||a["!outline"])&&Be(s,147,fD(l,a["!outline"])),Be(s,148,cD(c)),x9(s,a,r.Workbook),f9(s,a),u9(s,a,e,t),v9(s,a),g9(s,a,r,e),d9(s,a),m9(s,a,n),a["!margins"]&&Be(s,476,r9(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&h9(s,a),p9(s,a,e,n),Be(s,130),s.end()}function w9(e,t){e.l+=10;var r=Wn(e);return{name:r}}var b9=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function _9(e){return!e.Workbook||!e.Workbook.WBProps?"false":Z7(e.Workbook.WBProps.date1904)?"true":"false"}var N9="][*?/\\".split("");function aN(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return N9.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function S9(e,t,r){e.forEach(function(n,s){aN(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[s]&&t[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function k9(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];S9(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)GO(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function oN(e){var t=[tn];t[t.length]=Je("workbook",null,{xmlns:gu[0],"xmlns:r":pn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(b9.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Je("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var a={name:rr(e.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Je("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Je("definedName",rr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function j9(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Kg(e),r.name=Wn(e),r}function E9(e,t){return t||(t=Oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),b2(e.strRelID,t),xn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function A9(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Wn(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function T9(e,t){t||(t=Oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),y3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function C9(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=_P(e),a=zO(e,0,r),l=w2(e);e.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function P9(e,t){Be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Be(e,156,E9(s))}Be(e,144)}function L9(e,t){t||(t=Oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return xn("SheetJS",t),xn(q0.version,t),xn(q0.version,t),xn("7262",t),t.length>t.l?t.slice(0,t.l):t}function F9(e,t){t||(t=Oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function O9(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(Be(e,135),Be(e,158,F9(s)),Be(e,136))}}function D9(e,t){var r=ps();return Be(r,131),Be(r,128,L9()),Be(r,153,T9(e.Workbook&&e.Workbook.WBProps||null)),O9(r,e),P9(r,e),Be(r,132),r.end()}function I9(e,t,r){return(t.slice(-4)===".bin"?D9:oN)(e)}function R9(e,t,r,n,s){return(t.slice(-4)===".bin"?y9:sN)(e,r,n,s)}function M9(e,t,r){return(t.slice(-4)===".bin"?rF:H3)(e,r)}function B9(e,t,r){return(t.slice(-4)===".bin"?TL:B3)(e,r)}function U9(e,t,r){return(t.slice(-4)===".bin"?vF:Y3)(e)}function z9(e){return(e.slice(-4)===".bin"?uF:V3)()}function W9(e,t){var r=[];return e.Props&&r.push(MP(e.Props,t)),e.Custprops&&r.push(BP(e.Props,e.Custprops)),r.join("")}function H9(){return""}function $9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(Je("NumberFormat",null,{"ss:Format":rr(Dr[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(Je("Style",i.join(""),a))}),Je("Styles",r.join(""))}function lN(e){return Je("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+k2(e.Ref,{r:0,c:0})})}function q9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(lN(s)))}return Je("Names",r.join(""))}function V9(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var l=s[a];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(lN(l)))}return i.join("")}function G9(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Je("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Je("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Je("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Je("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(kn("ProtectContents","True")),e["!protect"].objects&&s.push(kn("ProtectObjects","True")),e["!protect"].scenarios&&s.push(kn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(kn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(kn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":Je("WorksheetOptions",s.join(""),{xmlns:Cs.x})}function Y9(e){return e.map(function(t){var r=Q7(t.t||""),n=Je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Je("Comment",n,{"ss:Author":t.a})}).join("")}function K9(e,t,r,n,s,i,a){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+rr(k2(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var c=gn(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=rr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=rr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=a.c||u[d].s.r!=a.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var m="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",p=String(e.v);break;case"b":m="Boolean",p=e.v?"1":"0";break;case"e":m="Error",p=Pf[e.v];break;case"d":m="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Dr[14]);break;case"s":m="String",p=J7(e.v||"");break}var h=Wo(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=a.c+1;var y=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+m+'">'+y+"</Data>";return(e.c||[]).length>0&&(g+=Y9(e.c)),Je("Cell",g,l)}function X9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=W3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function J9(e,t,r,n){if(!e["!ref"])return"";var s=_r(e["!ref"]),i=e["!merges"]||[],a=0,l=[];e["!cols"]&&e["!cols"].forEach(function(w,v){N2(w);var b=!!w.width,_=qm(v,w),E={"ss:Index":v+1};b&&(E["ss:Width"]=em(_.width)),w.hidden&&(E["ss:Hidden"]="1"),l.push(Je("Column",null,E))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[X9(u,(e["!rows"]||[])[u])],m=s.s.c;m<=s.e.c;++m){var p=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>m)&&!(i[a].s.r>u)&&!(i[a].e.c<m)&&!(i[a].e.r<u)){(i[a].s.c!=m||i[a].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:m},y=sr(h),g=c?(e[u]||[])[m]:e[y];d.push(K9(g,y,e,t,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Q9(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],a=i?V9(i,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?J9(i,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(G9(i,t,e,r)),n.join("")}function Z9(e,t){t||(t={}),e.SSF||(e.SSF=xs(Dr)),e.SSF&&(Um(),Bm(e.SSF),t.revssf=zm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Wo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(W9(e,t)),r.push(H9()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Je("Worksheet",Q9(n,t,e),{"ss:Name":rr(e.SheetNames[n])}));return r[2]=$9(e,t),r[3]=q9(e),tn+Je("Workbook",r.join(""),{xmlns:Cs.ss,"xmlns:o":Cs.o,"xmlns:x":Cs.x,"xmlns:ss":Cs.ss,"xmlns:dt":Cs.dt,"xmlns:html":Cs.html})}var S1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function eI(e,t){var r=[],n=[],s=[],i=0,a,l=_5(D5,"n"),c=_5(I5,"n");if(e.Props)for(a=Tn(e.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(l,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],e.Props[a[i]]]);if(e.Custprops)for(a=Tn(e.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(l,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],e.Custprops[a[i]]]);var u=[];for(i=0;i<s.length;++i)L3.indexOf(s[i][0])>-1||T3.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);n.length&&or.utils.cfb_add(t,"/SummaryInformation",z5(n,S1.SI,c,I5)),(r.length||u.length)&&or.utils.cfb_add(t,"/DocumentSummaryInformation",z5(r,S1.DSI,l,D5,u.length?u:null,S1.UDI))}function tI(e,t){var r=t||{},n=or.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return or.utils.cfb_add(n,s,cN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&eI(e,n),r.biff==8&&e.vbaraw&&yF(n,or.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var rI={0:{f:iD},1:{f:hD},2:{f:FD},3:{f:bD},4:{f:xD},5:{f:TD},6:{f:MD},7:{f:kD},8:{f:qD},9:{f:$D},10:{f:WD},11:{f:HD},12:{f:pD},13:{f:DD},14:{f:ND},15:{f:yD},16:{f:PD},17:{f:UD},18:{f:ED},19:{f:y2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:C9},40:{},42:{},43:{f:ML},44:{f:IL},45:{f:zL},46:{f:HL},47:{f:WL},48:{},49:{f:pP},50:{},51:{f:iF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gL},62:{f:RD},63:{f:dF},64:{f:o9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:n9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dD},148:{f:lD,p:16},151:{f:JD},152:{},153:{f:A9},154:{},155:{},156:{f:j9},157:{},158:{},159:{T:1,f:jL},160:{T:-1},161:{T:1,f:Ul},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:nF},336:{T:-1},337:{f:lF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:uL},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QD},427:{f:ZD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:t9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:gF},633:{T:1},634:{T:-1},635:{T:1,f:mF},636:{T:-1},637:{f:yP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:w9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:l9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Qe(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&g2(r)&&e.push(r)}}function nI(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Qe(e,t,r,s);var i=t;if(!isNaN(i)){for(var a=r.parts||[],l=0,c=0,u=0;u+(a[l]||8224)<=8224;)u+=a[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(a[l]||8224)<=8224;)u+=a[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Ff(e,t,r){return e||(e=Oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function sI(e,t,r,n){var s=Oe(9);return Ff(s,e,t),O3(r,n||"b",s),s}function iI(e,t,r){var n=Oe(8+2*r.length);return Ff(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function aI(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?gs(Qn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Qe(e,2,wL(r,n,s)):Qe(e,3,yL(r,n,s));return;case"b":case"e":Qe(e,5,sI(r,n,t.v,t.t));return;case"s":case"str":Qe(e,4,iI(r,n,(t.v||"").slice(0,255)));return}Qe(e,1,Ff(null,r,n))}function oI(e,t,r,n){var s=Array.isArray(t),i=_r(t["!ref"]||"A1"),a,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=Zr(i)}for(var u=i.s.r;u<=i.e.r;++u){l=En(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=zn(d)),a=c[d]+l;var m=s?(t[u]||[])[d]:t[a];m&&aI(e,m,u,d)}}}function lI(e,t){for(var r=t||{},n=ps(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Qe(n,r.biff==4?1033:r.biff==3?521:9,_2(e,16,r)),oI(n,e.Sheets[e.SheetNames[s]],s,r),Qe(n,10),n.end()}function cI(e,t,r){Qe(e,49,rL({sz:12,name:"Arial"},r))}function uI(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Qe(e,1054,iL(s,t[s],r))})}function dI(e,t){var r=Oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Qe(e,2151,r),r=Oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),R3(_r(t["!ref"]||"A1"),r),r.write_shift(4,4),Qe(e,2152,r)}function fI(e,t){for(var r=0;r<16;++r)Qe(e,224,H5({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Qe(e,224,H5(n,0,t))})}function hI(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Qe(e,440,hL(n)),n[1].Tooltip&&Qe(e,2048,mL(n))}delete t["!links"]}function mI(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Qe(e,125,xL(qm(s,n),s))})}}function pI(e,t,r,n,s){var i=16+Wo(s.cellXfs,t,s);if(t.v==null&&!t.bf){Qe(e,513,Cl(r,n,i));return}if(t.bf)Qe(e,6,BO(t,r,n,s,i));else switch(t.t){case"d":case"n":var a=t.t=="d"?gs(Qn(t.v)):t.v;Qe(e,515,cL(r,n,a,i));break;case"b":case"e":Qe(e,517,lL(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=E2(s.Strings,t.v,s.revStrings);Qe(e,253,nL(r,n,l,i))}else Qe(e,516,sL(r,n,(t.v||"").slice(0,255),i,s));break;default:Qe(e,513,Cl(r,n,i))}}function gI(e,t,r){var n=ps(),s=r.SheetNames[e],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},l=(a.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,m="",p=[],h=_r(i["!ref"]||"A1"),y=u?65536:16384;if(h.e.c>255||h.e.r>=y){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,y-1)}Qe(n,2057,_2(r,16,t)),Qe(n,13,Js(1)),Qe(n,12,Js(100)),Qe(n,15,Kn(!0)),Qe(n,17,Kn(!1)),Qe(n,16,Tl(.001)),Qe(n,95,Kn(!0)),Qe(n,42,Kn(!1)),Qe(n,43,Kn(!1)),Qe(n,130,Js(1)),Qe(n,128,oL()),Qe(n,131,Kn(!1)),Qe(n,132,Kn(!1)),u&&mI(n,i["!cols"]),Qe(n,512,aL(h,t)),u&&(i["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){m=En(g);for(var w=h.s.c;w<=h.e.c;++w){g===h.s.r&&(p[w]=zn(w)),d=p[w]+m;var v=c?(i[g]||[])[w]:i[d];v&&(pI(n,v,g,w,t),u&&v.l&&i["!links"].push([d,v.l]))}}var b=l.CodeName||l.name||s;return u&&Qe(n,574,tL((a.Views||[])[0])),u&&(i["!merges"]||[]).length&&Qe(n,229,fL(i["!merges"])),u&&hI(n,i),Qe(n,442,I3(b)),u&&dI(n,i),Qe(n,10),n.end()}function xI(e,t,r){var n=ps(),s=(e||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Qe(n,2057,_2(e,5,r)),r.bookType=="xla"&&Qe(n,135),Qe(n,225,l?Js(1200):null),Qe(n,193,WP(2)),c&&Qe(n,191),c&&Qe(n,192),Qe(n,226),Qe(n,92,JP("SheetJS",r)),Qe(n,66,Js(l?1200:1252)),l&&Qe(n,353,Js(0)),l&&Qe(n,448),Qe(n,317,vL(e.SheetNames.length)),l&&e.vbaraw&&Qe(n,211),l&&e.vbaraw){var u=a.CodeName||"ThisWorkbook";Qe(n,442,I3(u))}Qe(n,156,Js(17)),Qe(n,25,Kn(!1)),Qe(n,18,Kn(!1)),Qe(n,19,Js(0)),l&&Qe(n,431,Kn(!1)),l&&Qe(n,444,Js(0)),Qe(n,61,eL()),Qe(n,64,Kn(!1)),Qe(n,141,Js(0)),Qe(n,34,Kn(_9(e)=="true")),Qe(n,14,Kn(!0)),l&&Qe(n,439,Kn(!1)),Qe(n,218,Js(0)),cI(n,e,r),uI(n,e.SSF,r),fI(n,r),l&&Qe(n,352,Kn(!1));var d=n.end(),m=ps();l&&Qe(m,140,pL()),l&&r.Strings&&nI(m,252,ZP(r.Strings)),Qe(m,10);var p=m.end(),h=ps(),y=0,g=0;for(g=0;g<e.SheetNames.length;++g)y+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var w=d.length+y+p.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};Qe(h,133,QP({pos:w,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),w+=t[g].length}var b=h.end();if(y!=b.length)throw new Error("BS8 "+y+" != "+b.length);var _=[];return d.length&&_.push(d),b.length&&_.push(b),p.length&&_.push(p),Sn(_)}function vI(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=xs(Dr)),e&&e.SSF&&(Um(),Bm(e.SSF),r.revssf=zm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,A2(r),r.cellXfs=[],Wo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=gI(s,r,e);return n.unshift(xI(e,n,r)),Sn(n)}function cN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Rs(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return vI(e,t);case 4:case 3:case 2:return lI(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function yI(e,t,r,n){for(var s=e["!merges"]||[],i=[],a=t.s.c;a<=t.e.c;++a){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>a)&&!(s[u].e.r<r||s[u].e.c<a)){if(s[u].s.r<r||s[u].s.c<a){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=sr({r,c:a}),m=n.dense?(e[r]||[])[a]:e[d],p=m&&m.v!=null&&(m.h||X7(m.w||(Ca(m),m.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+m.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+d,i.push(Je("td",p,h))}}var y="<tr>";return y+i.join("")+"</tr>"}var wI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bI="</body></html>";function _I(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function uN(e,t){var r=t||{},n=r.header!=null?r.header:wI,s=r.footer!=null?r.footer:bI,i=[n],a=Rs(e["!ref"]);r.dense=Array.isArray(e),i.push(_I(e,a,r));for(var l=a.s.r;l<=a.e.r;++l)i.push(yI(e,a,l,r));return i.push("</table>"+s),i.join("")}function dN(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?gn(n.origin):n.origin;s=a.r,i=a.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=Rs(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var m=[],p=0,h=e["!rows"]||(e["!rows"]=[]),y=0,g=0,w=0,v=0,b=0,_=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&g<c;++y){var E=l[y];if(X5(E)){if(n.display)continue;h[g]={hidden:!0}}var D=E.children;for(w=v=0;w<D.length;++w){var I=D[w];if(!(n.display&&X5(I))){var A=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):eP(I.innerHTML),P=I.getAttribute("data-z")||I.getAttribute("z");for(p=0;p<m.length;++p){var C=m[p];C.s.c==v+i&&C.s.r<g+s&&g+s<=C.e.r&&(v=C.e.c+1-i,p=-1)}_=+I.getAttribute("colspan")||1,((b=+I.getAttribute("rowspan")||1)>1||_>1)&&m.push({s:{r:g+s,c:v+i},e:{r:g+s+(b||1)-1,c:v+i+(_||1)-1}});var M={t:"s",v:A},j=I.getAttribute("data-t")||I.getAttribute("t")||"";A!=null&&(A.length==0?M.t=j||"z":n.raw||A.trim().length==0||j=="s"||(A==="TRUE"?M={t:"b",v:!0}:A==="FALSE"?M={t:"b",v:!1}:isNaN(ba(A))?isNaN(mf(A).getDate())||(M={t:"d",v:Qn(A)},n.cellDates||(M={t:"n",v:gs(M.v)}),M.z=n.dateNF||Dr[14]):M={t:"n",v:ba(A)})),M.z===void 0&&P!=null&&(M.z=P);var T="",q=I.getElementsByTagName("A");if(q&&q.length)for(var U=0;U<q.length&&!(q[U].hasAttribute("href")&&(T=q[U].getAttribute("href"),T.charAt(0)!="#"));++U);T&&T.charAt(0)!="#"&&(M.l={Target:T}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][v+i]=M):e[sr({c:v+i,r:g+s})]=M,u.e.c<v+i&&(u.e.c=v+i),v+=_}}++g}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,g-1+s),e["!ref"]=Zr(u),g>=c&&(e["!fullref"]=Zr((u.e.r=l.length-y+g-1+s,u))),e}function fN(e,t){var r=t||{},n=r.dense?[]:{};return dN(n,e,t)}function NI(e,t){return Il(fN(e,t),t)}function X5(e){var t="",r=SI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function SI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var kI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+gf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return tn+t}}(),J5=function(){var e=function(i){return rr(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,l){var c=[];c.push('      <table:table table:name="'+rr(a.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,m=Rs(i["!ref"]||"A1"),p=i["!merges"]||[],h=0,y=Array.isArray(i);if(i["!cols"])for(d=0;d<=m.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",w=i["!rows"]||[];for(u=0;u<m.s.r;++u)g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=m.e.r;++u){for(g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<m.s.c;++d)c.push(t);for(;d<=m.e.c;++d){var v=!1,b={},_="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>d)&&!(p[h].s.r>u)&&!(p[h].e.c<d)&&!(p[h].e.r<u)){(p[h].s.c!=d||p[h].s.r!=u)&&(v=!0),b["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,b["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(v){c.push(r);continue}var E=sr({r:u,c:d}),D=y?(i[u]||[])[d]:i[E];if(D&&D.f&&(b["table:formula"]=rr(qO(D.f)),D.F&&D.F.slice(0,E.length)==E)){var I=Rs(D.F);b["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,b["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!D){c.push(t);continue}switch(D.t){case"b":_=D.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=D.v?"true":"false";break;case"n":_=D.w||String(D.v||0),b["office:value-type"]="float",b["office:value"]=D.v||0;break;case"s":case"str":_=D.v==null?"":D.v,b["office:value-type"]="string";break;case"d":_=D.w||Qn(D.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Qn(D.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var A=e(_);if(D.l&&D.l.Target){var P=D.l.Target;P=P.charAt(0)=="#"?"#"+VO(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),A=Je("text:a",A,{"xlink:href":P.replace(/&/g,"&amp;")})}c.push("          "+Je("table:table-cell",Je("text:p",A,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var m=u["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;N2(m),m.ods=l;var p=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var m=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,l){var c=[tn],u=gf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=gf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(E3().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=a.SheetNames.length;++m)c.push(n(a.Sheets[a.SheetNames[m]],a,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function hN(e,t){if(t.bookType=="fods")return J5(e,t);var r=f2(),n="",s=[],i=[];return n="mimetype",Pt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Pt(r,n,J5(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Pt(r,n,kI(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Pt(r,n,tn+E3()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Pt(r,n,RP(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Pt(r,n,DP(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function jI(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ki(pf(e))}function EI(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Do(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function AI(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function xf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Qt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Kc(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function an(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=xf(e,r),i=s&7;s=Math.floor(s/8);var a=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:a=4,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=xf(e,r),l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:i};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function bn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Qt(n*8+s.type)),s.type==2&&t.push(Qt(s.data.length)),t.push(s.data))})}),Do(t)}function xi(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=xf(e,n),i=an(e.slice(n[0],n[0]+s));n[0]+=s;var a={id:Kc(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=an(l.data),u=Kc(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(a.merge=Kc(i[3][0].data)>>>0>0),r.push(a)}return r}function vc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Qt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Qt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:Qt(a.data.length)}],n[2].push({data:bn(a.meta),type:2})});var i=bn(n);t.push(Qt(i.length)),t.push(i),s.forEach(function(a){return t.push(a)})}),Do(t)}function TI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=xf(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var l=a-59;a=t[r[0]],l>1&&(a|=t[r[0]+1]<<8),l>2&&(a|=t[r[0]+2]<<16),l>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=l}s.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Do(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Do(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function vi(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(TI(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Do(t)}function yc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Qt(n),a=i.length;t.push(i),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return Do(t)}function k1(e,t){var r=new Uint8Array(32),n=nm(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,AI(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function j1(e,t){var r=new Uint8Array(32),n=nm(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function Ja(e){var t=an(e);return xf(t[1][0].data)}function CI(e,t,r){var n,s,i,a;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((a=(i=e[8])==null?void 0:i[0])==null?void 0:a.data)&&Kc(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=nm(e[7][0].data),d=0,m=[],p=nm(e[4][0].data),h=0,y=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),p.setUint16(g*2,h,!0);var w,v;switch(typeof t[g]){case"string":w=k1({t:"s",v:t[g]},r),v=j1({t:"s",v:t[g]},r);break;case"number":w=k1({t:"n",v:t[g]},r),v=j1({t:"n",v:t[g]},r);break;case"boolean":w=k1({t:"b",v:t[g]},r),v=j1({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}m.push(w),d+=w.length,y.push(v),h+=v.length,++c}for(e[2][0].data=Qt(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Do(m),e[3][0].data=Do(y),c}function PI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Rs(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Zr(n)));var i=sm(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(L){return L.forEach(function(R){typeof R=="string"&&a.push(R)})});var l={},c=[],u=or.read(t.numbers,{type:"base64"});u.FileIndex.map(function(L,R){return[L,u.FullPaths[R]]}).forEach(function(L){var R=L[0],O=L[1];if(R.type==2&&R.name.match(/\.iwa/)){var V=R.content,ne=vi(V),ue=xi(ne);ue.forEach(function(fe){c.push(fe.id),l[fe.id]={deps:[],location:O,type:Kc(fe.messages[0].meta[1][0].data)}})}}),c.sort(function(L,R){return L-R});var d=c.filter(function(L){return L>1}).map(function(L){return[L,Qt(L)]});u.FileIndex.map(function(L,R){return[L,u.FullPaths[R]]}).forEach(function(L){var R=L[0];if(L[1],!!R.name.match(/\.iwa/)){var O=xi(vi(R.content));O.forEach(function(V){V.messages.forEach(function(ne){d.forEach(function(ue){V.messages.some(function(fe){return Kc(fe.meta[1][0].data)!=11006&&EI(fe.data,ue[1])})&&l[ue[0]].deps.push(V.id)})})})}});for(var m=or.find(u,l[1].location),p=xi(vi(m.content)),h,y=0;y<p.length;++y){var g=p[y];g.id==1&&(h=g)}var w=Ja(an(h.messages[0].data)[1][0].data);for(m=or.find(u,l[w].location),p=xi(vi(m.content)),y=0;y<p.length;++y)g=p[y],g.id==w&&(h=g);for(w=Ja(an(h.messages[0].data)[2][0].data),m=or.find(u,l[w].location),p=xi(vi(m.content)),y=0;y<p.length;++y)g=p[y],g.id==w&&(h=g);for(w=Ja(an(h.messages[0].data)[2][0].data),m=or.find(u,l[w].location),p=xi(vi(m.content)),y=0;y<p.length;++y)g=p[y],g.id==w&&(h=g);var v=an(h.messages[0].data);{v[6][0].data=Qt(n.e.r+1),v[7][0].data=Qt(n.e.c+1);var b=Ja(v[46][0].data),_=or.find(u,l[b].location),E=xi(vi(_.content));{for(var D=0;D<E.length&&E[D].id!=b;++D);if(E[D].id!=b)throw"Bad ColumnRowUIDMapArchive";var I=an(E[D].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var A=0;A<=n.e.c;++A){var P=[];P[1]=P[2]=[{type:0,data:Qt(A+420690)}],I[1].push({type:2,data:bn(P)}),I[2].push({type:0,data:Qt(A)}),I[3].push({type:0,data:Qt(A)})}I[4]=[],I[5]=[],I[6]=[];for(var C=0;C<=n.e.r;++C)P=[],P[1]=P[2]=[{type:0,data:Qt(C+726270)}],I[4].push({type:2,data:bn(P)}),I[5].push({type:0,data:Qt(C)}),I[6].push({type:0,data:Qt(C)});E[D].messages[0].data=bn(I)}_.content=yc(vc(E)),_.size=_.content.length,delete v[46];var M=an(v[4][0].data);{M[7][0].data=Qt(n.e.r+1);var j=an(M[1][0].data),T=Ja(j[2][0].data);_=or.find(u,l[T].location),E=xi(vi(_.content));{if(E[0].id!=T)throw"Bad HeaderStorageBucket";var q=an(E[0].messages[0].data);for(C=0;C<i.length;++C){var U=an(q[2][0].data);U[1][0].data=Qt(C),U[4][0].data=Qt(i[C].length),q[2][C]={type:q[2][0].type,data:bn(U)}}E[0].messages[0].data=bn(q)}_.content=yc(vc(E)),_.size=_.content.length;var re=Ja(M[2][0].data);_=or.find(u,l[re].location),E=xi(vi(_.content));{if(E[0].id!=re)throw"Bad HeaderStorageBucket";for(q=an(E[0].messages[0].data),A=0;A<=n.e.c;++A)U=an(q[2][0].data),U[1][0].data=Qt(A),U[4][0].data=Qt(n.e.r+1),q[2][A]={type:q[2][0].type,data:bn(U)};E[0].messages[0].data=bn(q)}_.content=yc(vc(E)),_.size=_.content.length;var z=Ja(M[4][0].data);(function(){for(var L=or.find(u,l[z].location),R=xi(vi(L.content)),O,V=0;V<R.length;++V){var ne=R[V];ne.id==z&&(O=ne)}var ue=an(O.messages[0].data);{ue[3]=[];var fe=[];a.forEach(function(_e,Ue){fe[1]=[{type:0,data:Qt(Ue)}],fe[2]=[{type:0,data:Qt(1)}],fe[3]=[{type:2,data:jI(_e)}],ue[3].push({type:2,data:bn(fe)})})}O.messages[0].data=bn(ue);var ye=vc(R),pe=yc(ye);L.content=pe,L.size=L.content.length})();var G=an(M[3][0].data);{var B=G[1][0];delete G[2];var Y=an(B.data);{var se=Ja(Y[2][0].data);(function(){for(var L=or.find(u,l[se].location),R=xi(vi(L.content)),O,V=0;V<R.length;++V){var ne=R[V];ne.id==se&&(O=ne)}var ue=an(O.messages[0].data);{delete ue[6],delete G[7];var fe=new Uint8Array(ue[5][0].data);ue[5]=[];for(var ye=0,pe=0;pe<=n.e.r;++pe){var _e=an(fe);ye+=CI(_e,i[pe],a),_e[1][0].data=Qt(pe),ue[5].push({data:bn(_e),type:2})}ue[1]=[{type:0,data:Qt(n.e.c+1)}],ue[2]=[{type:0,data:Qt(n.e.r+1)}],ue[3]=[{type:0,data:Qt(ye)}],ue[4]=[{type:0,data:Qt(n.e.r+1)}]}O.messages[0].data=bn(ue);var Ue=vc(R),Ve=yc(Ue);L.content=Ve,L.size=L.content.length})()}B.data=bn(Y)}M[3][0].data=bn(G)}v[4][0].data=bn(M)}h.messages[0].data=bn(v);var me=vc(p),S=yc(me);return m.content=S,m.size=m.content.length,u}function LI(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function A2(e){LI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function FI(e,t){return t.bookType=="ods"?hN(e,t):t.bookType=="numbers"?PI(e,t):t.bookType=="xlsb"?OI(e,t):DI(e,t)}function OI(e,t){Rc=1024,e&&!e.SSF&&(e.SSF=xs(Dr)),e&&e.SSF&&(Um(),Bm(e.SSF),t.revssf=zm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ud?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=K3.indexOf(t.bookType)>-1,s=S3();A2(t=t||{});var i=f2(),a="",l=0;if(t.cellXfs=[],Wo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pt(i,a,A3(e.Props,t)),s.coreprops.push(a),er(t.rels,2,a,$t.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Pt(i,a,C3(e.Props)),s.extprops.push(a),er(t.rels,3,a,$t.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pt(i,a,P3(e.Custprops)),s.custprops.push(a),er(t.rels,4,a,$t.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],p=(m||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+l+"."+r,Pt(i,a,R9(l-1,a,t,e,d)),s.sheets.push(a),er(t.wbrels,-1,"worksheets/sheet"+l+"."+r,$t.WS[0])}if(m){var h=m["!comments"],y=!1,g="";h&&h.length>0&&(g="xl/comments"+l+"."+r,Pt(i,g,U9(h,g)),s.comments.push(g),er(d,-1,"../comments"+l+"."+r,$t.CMNT),y=!0),m["!legacy"]&&y&&Pt(i,"xl/drawings/vmlDrawing"+l+".vml",G3(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&Pt(i,j3(a),Gc(d))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pt(i,a,B9(t.Strings,a,t)),s.strs.push(a),er(t.wbrels,-1,"sharedStrings."+r,$t.SST)),a="xl/workbook."+r,Pt(i,a,I9(e,a)),s.workbooks.push(a),er(t.rels,1,a,$t.WB),a="xl/theme/theme1.xml",Pt(i,a,q3(e.Themes,t)),s.themes.push(a),er(t.wbrels,-1,"theme/theme1.xml",$t.THEME),a="xl/styles."+r,Pt(i,a,M9(e,a,t)),s.styles.push(a),er(t.wbrels,-1,"styles."+r,$t.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pt(i,a,e.vbaraw),s.vba.push(a),er(t.wbrels,-1,"vbaProject.bin",$t.VBA)),a="xl/metadata."+r,Pt(i,a,z9(a)),s.metadata.push(a),er(t.wbrels,-1,"metadata."+r,$t.XLMETA),Pt(i,"[Content_Types].xml",k3(s,t)),Pt(i,"_rels/.rels",Gc(t.rels)),Pt(i,"xl/_rels/workbook."+r+".rels",Gc(t.wbrels)),delete t.revssf,delete t.ssf,i}function DI(e,t){Rc=1024,e&&!e.SSF&&(e.SSF=xs(Dr)),e&&e.SSF&&(Um(),Bm(e.SSF),t.revssf=zm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ud?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=K3.indexOf(t.bookType)>-1,s=S3();A2(t=t||{});var i=f2(),a="",l=0;if(t.cellXfs=[],Wo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pt(i,a,A3(e.Props,t)),s.coreprops.push(a),er(t.rels,2,a,$t.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Pt(i,a,C3(e.Props)),s.extprops.push(a),er(t.rels,3,a,$t.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pt(i,a,P3(e.Custprops)),s.custprops.push(a),er(t.rels,4,a,$t.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+l+"."+r,Pt(i,a,sN(l-1,t,e,m)),s.sheets.push(a),er(t.wbrels,-1,"worksheets/sheet"+l+"."+r,$t.WS[0])}if(p){var y=p["!comments"],g=!1,w="";if(y&&y.length>0){var v=!1;y.forEach(function(b){b[1].forEach(function(_){_.T==!0&&(v=!0)})}),v&&(w="xl/threadedComments/threadedComment"+l+"."+r,Pt(i,w,fF(y,d,t)),s.threadedcomments.push(w),er(m,-1,"../threadedComments/threadedComment"+l+"."+r,$t.TCMNT)),w="xl/comments"+l+"."+r,Pt(i,w,Y3(y)),s.comments.push(w),er(m,-1,"../comments"+l+"."+r,$t.CMNT),g=!0}p["!legacy"]&&g&&Pt(i,"xl/drawings/vmlDrawing"+l+".vml",G3(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}m["!id"].rId1&&Pt(i,j3(a),Gc(m))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pt(i,a,B3(t.Strings,t)),s.strs.push(a),er(t.wbrels,-1,"sharedStrings."+r,$t.SST)),a="xl/workbook."+r,Pt(i,a,oN(e)),s.workbooks.push(a),er(t.rels,1,a,$t.WB),a="xl/theme/theme1.xml",Pt(i,a,q3(e.Themes,t)),s.themes.push(a),er(t.wbrels,-1,"theme/theme1.xml",$t.THEME),a="xl/styles."+r,Pt(i,a,H3(e,t)),s.styles.push(a),er(t.wbrels,-1,"styles."+r,$t.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pt(i,a,e.vbaraw),s.vba.push(a),er(t.wbrels,-1,"vbaProject.bin",$t.VBA)),a="xl/metadata."+r,Pt(i,a,V3()),s.metadata.push(a),er(t.wbrels,-1,"metadata."+r,$t.XLMETA),d.length>1&&(a="xl/persons/person.xml",Pt(i,a,hF(d)),s.people.push(a),er(t.wbrels,-1,"persons/person.xml",$t.PEOPLE)),Pt(i,"[Content_Types].xml",k3(s,t)),Pt(i,"_rels/.rels",Gc(t.rels)),Pt(i,"xl/_rels/workbook."+r+".rels",Gc(t.wbrels)),delete t.revssf,delete t.ssf,i}function II(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ta(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function mN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Tf(t.file,or.write(e,{type:Gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return or.write(e,t)}function RI(e,t){var r=xs(t||{}),n=FI(e,r);return MI(n,r)}function MI(e,t){var r={},n=Gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?or.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Mm(s))}return t.password&&typeof encrypt_agile<"u"?mN(encrypt_agile(s,t.password),t):t.type==="file"?Tf(t.file,s):t.type=="string"?Id(s):s}function BI(e,t){var r=t||{},n=tI(e,r);return mN(n,r)}function qi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return hf(pf(n));case"binary":return pf(n);case"string":return e;case"file":return Tf(t.file,n,"utf8");case"buffer":return Gt?La(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):qi(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function UI(e,t){switch(t.type){case"base64":return hf(e);case"binary":return e;case"string":return e;case"file":return Tf(t.file,e,"binary");case"buffer":return Gt?La(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function e0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?hf(r):t.type=="string"?Id(r):r;case"file":return Tf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function pN(e,t){m7(),k9(e);var r=xs(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pN(e,r);return r.type="array",Mm(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return qi(Z9(e,r),r);case"slk":case"sylk":return qi(_L.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return qi(uN(e.Sheets[e.SheetNames[s]],r),r);case"txt":return UI(gN(e.Sheets[e.SheetNames[s]],r),r);case"csv":return qi(T2(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return qi(NL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return e0(bL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return qi(SL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return qi(PL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return qi(M3.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return qi(hN(e,r),r);case"wk1":return e0($5.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return e0($5.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),e0(cN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),BI(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return RI(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function zI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function WI(e,t,r){var n={};return n.type="file",n.file=t,zI(n),pN(e,n)}function HI(e,t,r,n,s,i,a,l){var c=En(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||e[r])for(var h=t.s.c;h<=t.e.c;++h){var y=a?e[r][h]:e[n[h]+c];if(y===void 0||y.t===void 0){if(u===void 0)continue;i[h]!=null&&(p[i[h]]=u);continue}var g=y.v;switch(y.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[h]!=null){if(g==null)if(y.t=="e"&&g===null)p[i[h]]=null;else if(u!==void 0)p[i[h]]=u;else if(d&&g===null)p[i[h]]=null;else continue;else p[i[h]]=d&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?g:Ca(y,g,l);g!=null&&(m=!1)}}return{row:p,isempty:m}}function sm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=_r(d);break;case"number":c=_r(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var m=En(c.s.r),p=[],h=[],y=0,g=0,w=Array.isArray(e),v=c.s.r,b=0,_={};w&&!e[v]&&(e[v]=[]);var E=u.skipHidden&&e["!cols"]||[],D=u.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(E[b]||{}).hidden)switch(p[b]=zn(b),r=w?e[v][b]:e[p[b]+m],n){case 1:i[b]=b-c.s.c;break;case 2:i[b]=p[b];break;case 3:i[b]=u.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=a=Ca(r,null,u),g=_[a]||0,!g)_[a]=1;else{do l=a+"_"+g++;while(_[l]);_[a]=g,_[l]=1}i[b]=l}for(v=c.s.r+s;v<=c.e.r;++v)if(!(D[v]||{}).hidden){var I=HI(e,c,v,p,n,i,w,u);(I.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[y++]=I.row)}return h.length=y,h}var Q5=/"/g;function $I(e,t,r,n,s,i,a,l){for(var c=!0,u=[],d="",m=En(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=l.dense?(e[r]||[])[p]:e[n[p]+m];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:Ca(h,null,l));for(var y=0,g=0;y!==d.length;++y)if((g=d.charCodeAt(y))===s||g===i||g===34||l.forceQuotes){d='"'+d.replace(Q5,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(Q5,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(a)}function T2(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=_r(e["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",m=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],y=s.s.c;y<=s.e.c;++y)(p[y]||{}).hidden||(m[y]=zn(y));for(var g=0,w=s.s.r;w<=s.e.r;++w)(h[w]||{}).hidden||(d=$I(e,s,w,m,a,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?l:"")+d)));return delete n.dense,r.join("")}function gN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=T2(e,t);return r}function qI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=_r(e["!ref"]),i="",a=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)a[l]=zn(l);for(var d=s.s.r;d<=s.e.r;++d)for(i=En(d),l=s.s.c;l<=s.e.c;++l)if(t=a[l]+i,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function xN(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},a=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?gn(n.origin):n.origin;a=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:a+t.length-1+s}};if(i["!ref"]){var m=_r(i["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),a==-1&&(a=m.e.r+1,d.e.r=a+t.length-1+s)}else a==-1&&(a=0,d.e.r=t.length-1+s);var p=n.header||[],h=0;t.forEach(function(g,w){Tn(g).forEach(function(v){(h=p.indexOf(v))==-1&&(p[h=p.length]=v);var b=g[v],_="z",E="",D=sr({c:l+h,r:a+w+s});u=vf(i,D),b&&typeof b=="object"&&!(b instanceof Date)?i[D]=b:(typeof b=="number"?_="n":typeof b=="boolean"?_="b":typeof b=="string"?_="s":b instanceof Date?(_="d",n.cellDates||(_="n",b=gs(b)),E=n.dateNF||Dr[14]):b===null&&n.nullError&&(_="e",b=0),u?(u.t=_,u.v=b,delete u.w,delete u.R,E&&(u.z=E)):i[D]=u={t:_,v:b},E&&(u.z=E))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var y=En(a);if(s)for(h=0;h<p.length;++h)i[zn(h+l)+y]={t:"s",v:p[h]};return i["!ref"]=Zr(d),i}function VI(e,t){return xN(null,e,t)}function vf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=gn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vf(e,sr(t)):vf(e,sr({r:t,c:r||0}))}function GI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function YI(){return{SheetNames:[],Sheets:{}}}function KI(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=a+s)!=-1;++s);}if(aN(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function XI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=GI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function JI(e,t){return e.z=t,e}function vN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function QI(e,t,r){return vN(e,"#"+t,r)}function ZI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function eR(e,t,r,n){for(var s=typeof t!="string"?t:_r(t),i=typeof t=="string"?t:Zr(t),a=s.s.r;a<=s.e.r;++a)for(var l=s.s.c;l<=s.e.c;++l){var c=vf(e,a,l);c.t="n",c.F=i,delete c.v,a==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var E1={encode_col:zn,encode_row:En,encode_cell:sr,encode_range:Zr,decode_col:v2,decode_row:x2,split_cell:mP,decode_cell:gn,decode_range:Rs,format_cell:Ca,sheet_add_aoa:v3,sheet_add_json:xN,sheet_add_dom:dN,aoa_to_sheet:xu,json_to_sheet:VI,table_to_sheet:fN,table_to_book:NI,sheet_to_csv:T2,sheet_to_txt:gN,sheet_to_json:sm,sheet_to_html:uN,sheet_to_formulae:qI,sheet_to_row_object_array:sm,sheet_get_cell:vf,book_new:YI,book_append_sheet:KI,book_set_sheet_visibility:XI,cell_set_number_format:JI,cell_set_hyperlink:vN,cell_set_internal_link:QI,cell_add_comment:ZI,sheet_set_array_formula:eR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Z5=(e,t,r,n,s,i="GHS")=>{var w;const a=new mt;a.setFont("helvetica","normal"),a.setFontSize(9),a.setFillColor(17,24,39),a.rect(0,0,210,25,"F"),a.setTextColor(255),a.setFontSize(14),a.text(`Worker Report: ${e.name}`,14,18),a.setTextColor(0),a.setFontSize(8),a.text(`Period: ${Lt(n,"MMM dd, yyyy")} - ${Lt(s,"MMM dd, yyyy")}`,14,28);const l=((w=Ar[i])==null?void 0:w.symbol)||i,c=v=>`${l} ${v.toFixed(2)}`,u=t.filter(v=>v.status==="completed"),d=t.filter(v=>v.status==="pending");u.reduce((v,b)=>{var _;return v+(((_=b.deductions)==null?void 0:_.reduce((E,D)=>E+D.amount,0))||0)},0);const m=u.reduce((v,b)=>{var E;const _=((E=b.deductions)==null?void 0:E.reduce((D,I)=>D+I.amount,0))||0;return v+(b.amount-_)},0),p=t.reduce((v,b)=>v+b.amount,0);a.setFillColor(249,250,251),a.rect(10,35,190,35,"F"),a.setFont("helvetica","bold"),a.setFontSize(10),a.text("Summary",14,42),a.setFont("helvetica","normal"),a.setFontSize(8);const h=50;a.text(`Total Tasks: ${t.length}`,20,h),a.text(`Assigned Tasks: ${d.length}`,20,h+6),a.text(`Completed Tasks: ${u.length}`,20,h+12),a.text(`Weekly Project Total: ${c(p)}`,20,h+18),a.text(`Completed Earnings: ${c(m)}`,20,h+24);let y=80;t.forEach((v,b)=>{var I,A,P;const _=(I=r.find(C=>C.project_id===v.project_id))==null?void 0:I.project,E=((A=v.deductions)==null?void 0:A.reduce((C,M)=>C+M.amount,0))||0,D=v.amount-E;if(y>250&&(a.addPage(),y=20),gd(a,{startY:y,head:[[{content:`Task ${b+1}`,styles:{halign:"left",fillColor:[17,24,39],textColor:255,fontSize:8,fontStyle:"bold"}}]],theme:"plain",headStyles:{cellPadding:4},margin:{left:14}}),gd(a,{startY:a.lastAutoTable.finalY,body:[["Date",Lt(new Date(v.due_date),"MMM dd, yyyy")],["Project",(_==null?void 0:_.name)||"Unknown Project"],["Status",v.status.charAt(0).toUpperCase()+v.status.slice(1)],["Completed",v.completed_at?Lt(new Date(v.completed_at),"MMM dd, yyyy HH:mm"):"-"],["Amount",c(v.amount)],["Deductions",c(E)],["Net Amount",c(D)]],theme:"plain",styles:{fontSize:7,cellPadding:4,overflow:"linebreak",minCellWidth:80},columnStyles:{0:{fontStyle:"bold",fillColor:[249,250,251]}},margin:{left:14}}),v.description&&gd(a,{startY:a.lastAutoTable.finalY+1,head:[["Description"]],body:[[v.description]],theme:"plain",styles:{fontSize:7,cellPadding:4,overflow:"linebreak",cellWidth:"wrap"},headStyles:{fillColor:[253,224,71],textColor:[120,53,15],fontStyle:"bold"},margin:{left:14}}),(P=v.deductions)!=null&&P.length){const C=v.deductions.map(M=>[c(M.amount),M.reason]);gd(a,{startY:a.lastAutoTable.finalY+1,head:[["Deduction Amount","Deduction Reason"]],body:C,theme:"plain",styles:{fontSize:7,cellPadding:4,overflow:"linebreak"},headStyles:{fillColor:[252,165,165],textColor:[127,29,29],fontStyle:"bold"},margin:{left:14}})}y=a.lastAutoTable.finalY+8});const g=`
*Work Report for ${e.name}*
Period: ${Lt(n,"MMM dd, yyyy")} - ${Lt(s,"MMM dd, yyyy")}

*Summary*
 Total Tasks: ${t.length} 
 Assigned Tasks: ${d.length}
 Tasks Completed: ${u.length}
 Weekly Project Total: ${c(p)}
 Completed Earnings: ${c(m)}

Your detailed report has been attached as a PDF.

Thank you for your service!
`;return{pdf:a.save(`${e.name}_report_${Lt(n,"yyyy-MM-dd")}.pdf`),whatsappMessage:encodeURIComponent(g)}},tR=(e,t,r="GHS")=>{var d;const n=((d=Ar[r])==null?void 0:d.symbol)||r,s=E1.book_new(),i=e.map(m=>({Date:Lt(new Date(m.date),"MMM dd, yyyy"),"Total Tasks":m.totalTasks,"Total Amount":`${n} ${m.totalAmount.toFixed(2)}`,"Total Deductions":`${n} ${m.totalDeductions.toFixed(2)}`,"Net Amount":`${n} ${m.netAmount.toFixed(2)}`})),a=E1.json_to_sheet(i);E1.book_append_sheet(s,a,"Financial Report");const l=new mt;l.setFontSize(20),l.text("Financial Report",14,20),l.setFontSize(12),l.text(`Period: ${Lt(t.start,"MMM dd, yyyy")} - ${Lt(t.end,"MMM dd, yyyy")}`,14,30);const c=e.reduce((m,p)=>({tasks:m.tasks+p.totalTasks,amount:m.amount+p.totalAmount,deductions:m.deductions+p.totalDeductions,net:m.net+p.netAmount}),{tasks:0,amount:0,deductions:0,net:0});l.text("Summary:",14,40),l.text(`Total Tasks: ${c.tasks}`,20,48),l.text(`Total Amount: ${n} ${c.amount.toFixed(2)}`,20,56),l.text(`Total Deductions: ${n} ${c.deductions.toFixed(2)}`,20,64),l.text(`Net Amount: ${n} ${c.net.toFixed(2)}`,20,72);const u=e.map(m=>[Lt(new Date(m.date),"MMM dd, yyyy"),m.totalTasks.toString(),`${n} ${m.totalAmount.toFixed(2)}`,`${n} ${m.totalDeductions.toFixed(2)}`,`${n} ${m.netAmount.toFixed(2)}`]);return gd(l,{startY:80,head:[["Date","Tasks","Amount","Deductions","Net Amount"]],body:u,theme:"striped",styles:{fontSize:8},headStyles:{fillColor:[59,130,246]}}),{workbook:s,pdf:l}};function rR({worker:e,tasks:t,workerProjects:r,isEditing:n,setIsEditing:s,editedWorker:i,setEditedWorker:a,handleEditWorker:l,handleDeleteWorker:c}){var P;const[u,d]=he.useState(!1),m=he.useRef(null),{addToast:p}=en(),{organization:h}=qt(),y=new Date,g=Ds(y,{weekStartsOn:1}),w=So(y,{weekStartsOn:1}),v=t.filter(C=>C.status==="pending"),b=t.filter(C=>C.status==="completed"),_=async C=>{var j,T;const M=(j=C.target.files)==null?void 0:j[0];if(!(!M||!e))try{if(d(!0),!["image/jpeg","image/jpg","image/png"].includes(M.type))throw new Error("Please upload a JPG, JPEG, or PNG file");if(M.size>5*1024*1024)throw new Error("Image must be less than 5MB");const U=(T=M.name.split(".").pop())==null?void 0:T.toLowerCase();if(!U||!["jpg","jpeg","png"].includes(U))throw new Error("Invalid file extension");const re=`${Math.random().toString(36).substring(2)}.${U}`,z=`worker-${e.id}/${re}`,{error:G}=await We.storage.from("profiles").upload(z,M,{cacheControl:"3600",upsert:!0});if(G)throw G;const{data:{publicUrl:B}}=We.storage.from("profiles").getPublicUrl(z),{error:Y}=await We.from("workers").update({image:B}).eq("id",e.id);if(Y)throw Y;a(se=>se?{...se,image:B}:null),p({type:"success",title:"Image Uploaded",message:"Profile image has been updated successfully."})}catch(q){console.error("Error uploading image:",q),p({type:"error",title:"Upload Failed",message:q instanceof Error?q.message:"Failed to upload image"})}finally{d(!1),m.current&&(m.current.value="")}},E=()=>{e&&Z5(e,t,r,g,w,h.currency)},D=()=>{if(!(e!=null&&e.whatsapp))return;const{whatsappMessage:C}=Z5(e,t,r,g,w,h.currency);window.open(`https://wa.me/${e.whatsapp}?text=${C}`,"_blank")},I=b.reduce((C,M)=>{var T;const j=((T=M.deductions)==null?void 0:T.reduce((q,U)=>q+U.amount,0))||0;return C+(M.amount-j)},0),A=((P=Ar[h.currency])==null?void 0:P.symbol)||h.currency;return o.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"flex items-start justify-between",children:o.jsxs("div",{className:"flex items-center space-x-5",children:[o.jsxs("div",{className:"relative h-20 w-20 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:[e.image?o.jsx("img",{src:e.image,alt:e.name,className:"h-full w-full object-cover",onError:C=>{console.error("Image failed to load:",e.image),C.currentTarget.src="",C.currentTarget.onerror=null}}):o.jsx("span",{className:"text-3xl font-medium text-gray-600",children:e.name[0].toUpperCase()}),n&&o.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:[o.jsx("input",{type:"file",ref:m,onChange:_,accept:"image/jpeg,image/jpg,image/png",className:"hidden"}),o.jsx("button",{onClick:()=>{var C;return(C=m.current)==null?void 0:C.click()},disabled:u,className:"p-2 bg-white rounded-full hover:bg-gray-100",children:u?o.jsx(To,{className:"h-5 w-5 text-gray-600 animate-spin"}):o.jsx(cf,{className:"h-5 w-5 text-gray-600"})})]})]}),o.jsx("div",{children:n?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),o.jsx("input",{type:"text",value:(i==null?void 0:i.name)||"",onChange:C=>a(M=>M?{...M,name:C.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp"}),o.jsx("input",{type:"text",value:(i==null?void 0:i.whatsapp)||"",onChange:C=>a(M=>M?{...M,whatsapp:C.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter WhatsApp number"})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:l,disabled:u,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400",children:u?"Uploading...":"Save Changes"}),o.jsx("button",{onClick:()=>{s(!1),a(e)},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e.name}),e.whatsapp&&o.jsxs("div",{className:"mt-2 flex items-center text-gray-500",children:[o.jsx(n2,{className:"h-4 w-4 mr-2"}),o.jsx("span",{children:e.whatsapp})]}),o.jsxs("div",{className:"mt-4 flex flex-wrap gap-3",children:[o.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(Fm,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),o.jsxs("button",{onClick:E,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(Og,{className:"h-4 w-4 mr-2"}),"Download Report"]}),e.whatsapp&&o.jsxs("button",{onClick:D,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(i_,{className:"h-4 w-4 mr-2"}),"WhatsApp"]}),o.jsxs("button",{onClick:c,className:"inline-flex items-center px-3 py-1.5 border border-red-300 rounded-md text-sm font-medium text-red-700 bg-white hover:bg-red-50",children:[o.jsx(Pi,{className:"h-4 w-4 mr-2"}),"Delete Worker"]})]})]})})]})}),o.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-5 sm:grid-cols-3",children:[o.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Ol,{className:"h-6 w-6 text-yellow-600"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Assigned Tasks"}),o.jsx("p",{className:"mt-1 text-2xl font-semibold text-yellow-900",children:v.length})]})]})}),o.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Si,{className:"h-6 w-6 text-green-600"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-green-900",children:"Completed Tasks"}),o.jsx("p",{className:"mt-1 text-2xl font-semibold text-green-900",children:b.length})]})]})}),o.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Aa,{className:"h-6 w-6 text-yellow-600"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Completed Earnings"}),o.jsxs("p",{className:"mt-1 text-2xl font-semibold text-yellow-900",children:[A," ",I.toFixed(2)]})]})]})})]})]})})}const t0="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function nR({worker:e,workerProjects:t,setWorkerProjects:r,organization:n}){var E;const[s,i]=he.useState(!1),[a,l]=he.useState(null),[c,u]=he.useState(0),[d,m]=he.useState(""),[p,h]=he.useState({name:"",rate:0}),{confirm:y}=l_(),{addToast:g}=c_(),w=((E=Ar[n.currency])==null?void 0:E.symbol)||n.currency,v=async()=>{if(!(!n||!e||!p.name.trim()||!p.rate))try{const{data:D,error:I}=await We.from("projects").insert([{organization_id:n.id,name:p.name.trim(),base_price:p.rate}]).select().single();if(I)throw I;const{data:A,error:P}=await We.from("worker_project_rates").insert([{worker_id:e.id,project_id:D.id,rate:p.rate}]).select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).single();if(P)throw P;r(C=>[...C,A]),h({name:"",rate:0}),i(!1),g({type:"success",title:"Project Added",message:"The project has been added successfully."})}catch(D){console.error("Error adding project:",D),g({type:"error",title:"Error",message:"Failed to add project. Please try again."})}},b=async D=>{var I;try{const{error:A}=await We.from("projects").update({name:d}).eq("id",(I=t.find(C=>C.id===D))==null?void 0:I.project_id);if(A)throw A;const{error:P}=await We.from("worker_project_rates").update({rate:c}).eq("id",D);if(P)throw P;r(C=>C.map(M=>M.id===D?{...M,rate:c,project:{...M.project,name:d}}:M)),l(null),m(""),u(0),g({type:"success",title:"Rate Updated",message:"The project has been updated successfully."})}catch(A){console.error("Error updating project rate:",A),g({type:"error",title:"Error",message:"Failed to update project rate. Please try again."})}},_=async D=>{if(await y({title:"Delete Project",message:"Are you sure you want to delete this project? This action cannot be undone.",type:"warning",confirmText:"Delete",cancelText:"Cancel"}))try{const A=t.find(C=>C.id===D);if(!A)throw new Error("Project not found");const{error:P}=await We.from("projects").delete().eq("id",A.project_id);if(P)throw P;r(C=>C.filter(M=>M.id!==D)),g({type:"success",title:"Project Deleted",message:"Project deleted successfully"})}catch(A){console.error("Error deleting project:",A),g({type:"error",title:"Error",message:A instanceof Error?A.message:"Failed to delete project"})}};return o.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:o.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Projects and Rates"}),o.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Project"]})]}),s&&o.jsxs("div",{className:"mb-6 bg-gray-50 rounded-lg p-4",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add New Project"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Project Name"}),o.jsx("input",{type:"text",value:p.name,onChange:D=>h(I=>({...I,name:D.target.value})),className:t0,placeholder:"Enter project name"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Rate (",w,")"]}),o.jsx("input",{type:"number",value:p.rate||"",onChange:D=>h(I=>({...I,rate:parseFloat(D.target.value)||0})),className:t0,min:"0",step:"0.01",placeholder:"Enter project rate"})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),o.jsx("button",{onClick:v,disabled:!p.name.trim()||!p.rate,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Project"})]})]})]}),o.jsx("div",{className:"mt-4",children:t.length===0?o.jsx("p",{className:"text-center text-gray-500 py-4",children:"No projects assigned yet."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(D=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===D.id?o.jsx("input",{type:"text",value:d,onChange:I=>m(I.target.value),className:`${t0} w-full`,placeholder:"Enter project name"}):D.project.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===D.id?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"number",value:c||"",onChange:I=>u(parseFloat(I.target.value)||0),className:`${t0} w-24`,min:"0",step:"0.01"}),o.jsx("button",{onClick:()=>b(D.id),className:"text-green-600 hover:text-green-700",children:o.jsx(Si,{className:"h-5 w-5"})}),o.jsx("button",{onClick:()=>l(null),className:"text-red-600 hover:text-red-700",children:o.jsx(zo,{className:"h-5 w-5"})})]}):o.jsxs("span",{children:[w," ",D.rate.toFixed(2)]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a!==D.id&&o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[o.jsx("button",{onClick:()=>{l(D.id),u(D.rate),m(D.project.name)},className:"text-blue-600 hover:text-blue-700",children:o.jsx(Fm,{className:"h-5 w-5"})}),o.jsx("button",{onClick:()=>_(D.id),className:"text-red-600 hover:text-red-700",title:"Delete project",children:o.jsx(Pi,{className:"h-5 w-5"})})]})})]},D.id))})]})})})]})})}const ew="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function sR({task:e,tasks:t,setTasks:r,organization:n}){var m;const[s,i]=he.useState({amount:0,reason:""}),{confirm:a,addToast:l}=en(),c=((m=Ar[n.currency])==null?void 0:m.symbol)||n.currency,u=async()=>{if(!(!e.id||!s.amount||!s.reason))try{const{data:p,error:h}=await We.from("deductions").insert([{task_id:e.id,amount:s.amount,reason:s.reason.trim()}]).select().single();if(h)throw h;r(y=>y.map(g=>g.id===e.id?{...g,deductions:[...g.deductions||[],p]}:g)),i({amount:0,reason:""}),l({type:"success",title:"Deduction Added",message:"The deduction has been added successfully."})}catch(p){console.error("Error adding deduction:",p),l({type:"error",title:"Error",message:"Failed to add deduction. Please try again."})}},d=async p=>{if(await a({title:"Remove Deduction",message:"Are you sure you want to remove this deduction? This action cannot be undone.",type:"danger",confirmText:"Remove",cancelText:"Cancel"}))try{const{error:y}=await We.from("deductions").delete().eq("id",p);if(y)throw y;r(g=>g.map(w=>{var v;return w.id===e.id?{...w,deductions:(v=w.deductions)==null?void 0:v.filter(b=>b.id!==p)}:w})),l({type:"success",title:"Deduction Removed",message:"The deduction has been removed successfully."})}catch(y){console.error("Error removing deduction:",y),l({type:"error",title:"Error",message:"Failed to remove deduction. Please try again."})}};return o.jsxs("div",{className:"mt-4 border-t pt-4",children:[o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Deduction"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm text-gray-700",children:["Amount (",c,")"]}),o.jsx("input",{type:"number",value:s.amount||"",onChange:p=>i(h=>({...h,amount:parseFloat(p.target.value)||0})),className:ew,min:"0",step:"0.01"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Reason"}),o.jsx("input",{type:"text",value:s.reason,onChange:p=>i(h=>({...h,reason:p.target.value})),className:ew})]})]}),o.jsx("button",{onClick:u,disabled:!s.amount||!s.reason.trim(),className:"mt-4 w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Deduction"})]}),e.deductions&&e.deductions.length>0&&o.jsxs("div",{className:"mt-4 space-y-2",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Deductions"}),e.deductions.map(p=>o.jsxs("div",{className:"flex items-center justify-between bg-red-50 p-3 rounded",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm font-medium text-red-900",children:[c," ",p.amount.toFixed(2)]}),o.jsx("p",{className:"text-sm text-red-700",children:p.reason}),o.jsx("p",{className:"text-xs text-red-600",children:Lt(new Date(p.created_at),"MMM d, yyyy HH:mm")})]}),o.jsx("button",{onClick:()=>d(p.id),className:"p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-100",children:o.jsx(zo,{className:"h-5 w-5"})})]},p.id))]})]})}const A1={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},delayed:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"}},T1={pending:"Assigned",in_progress:"In Progress",delayed:"Delayed",completed:"Completed"},cd="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function iR({worker:e,tasks:t,setTasks:r,workerProjects:n,organization:s}){var D;const[i,a]=he.useState(!1),[l,c]=he.useState(null),[u,d]=he.useState(null),[m,p]=he.useState(""),[h,y]=he.useState({project_id:"",description:"",due_date:new Date().toISOString().split("T")[0],late_reason:""}),{confirm:g,addToast:w}=en(),v=((D=Ar[s.currency])==null?void 0:D.symbol)||s.currency,b=async(I,A,P)=>{try{const C={status:A};A==="completed"?C.completed_at=new Date().toISOString():A==="delayed"&&(C.delay_reason=P),C.status_changed_at=new Date().toISOString();const{error:M}=await We.from("tasks").update(C).eq("id",I);if(M)throw M;r(j=>j.map(T=>T.id===I?{...T,...C}:T)),d(null),p(""),w({type:"success",title:"Status Updated",message:`Task marked as ${T1[A]}`})}catch(C){console.error("Error updating task status:",C),w({type:"error",title:"Error",message:"Failed to update task status"})}},_=async()=>{var M;if(!s||!e||!h.project_id)return;const I=((M=n.find(j=>j.project_id===h.project_id))==null?void 0:M.rate)||0,A=new Date(h.due_date),P=El(new Date),C=pl(P,A);if(C&&!h.late_reason){w({type:"warning",title:"Late Entry",message:"Please provide a reason for adding a task for a past date."});return}try{const{data:j,error:T}=await We.from("tasks").insert([{organization_id:s.id,worker_id:e.id,project_id:h.project_id,description:h.description.trim()||null,due_date:h.due_date,amount:I,status:"pending",late_reason:C?h.late_reason:null}]).select(`
          *,
          deductions (*)
        `).single();if(T)throw T;r(q=>[j,...q]),y({project_id:"",description:"",due_date:new Date().toISOString().split("T")[0],late_reason:""}),a(!1),w({type:"success",title:"Task Added",message:"The task has been added successfully."})}catch(j){console.error("Error adding task:",j),w({type:"error",title:"Error",message:"Failed to add task. Please try again."})}},E=async I=>{if(await g({title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:P}=await We.from("tasks").delete().eq("id",I);if(P)throw P;r(C=>C.filter(M=>M.id!==I)),w({type:"success",title:"Task Deleted",message:"The task has been deleted successfully."})}catch(P){console.error("Error deleting task:",P),w({type:"error",title:"Error",message:"Failed to delete task. Please try again."})}};return o.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:o.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Tasks"}),o.jsxs("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Task"]})]}),i&&o.jsxs("div",{className:"mb-6 bg-gray-50 rounded-lg p-4",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"New Task"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Project"}),o.jsxs("select",{value:h.project_id,onChange:I=>y(A=>({...A,project_id:I.target.value})),className:cd,children:[o.jsx("option",{value:"",children:"Select a project"}),n.map(I=>o.jsxs("option",{value:I.project_id,children:[I.project.name," - ",v," ",I.rate.toFixed(2)]},I.project_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),o.jsx("input",{type:"text",value:h.description,onChange:I=>y(A=>({...A,description:I.target.value})),className:cd,placeholder:"Enter task description (optional)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),o.jsx("input",{type:"date",value:h.due_date,onChange:I=>y(A=>({...A,due_date:I.target.value})),className:cd,max:new Date().toISOString().split("T")[0]})]}),pl(El(new Date),new Date(h.due_date))&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Late Entry"}),o.jsx("textarea",{value:h.late_reason,onChange:I=>y(A=>({...A,late_reason:I.target.value})),className:`${cd} h-20`,placeholder:"Please provide a reason for adding this task after the date",required:!0})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),o.jsx("button",{onClick:_,disabled:!h.project_id,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Task"})]})]})]}),o.jsx("div",{className:"space-y-4",children:t.length===0?o.jsx("div",{className:"text-center text-gray-500 py-8",children:"No tasks found. Start by adding a new task."}):t.map(I=>{var M,j;const A=(M=n.find(T=>T.project_id===I.project_id))==null?void 0:M.project,P=((j=I.deductions)==null?void 0:j.reduce((T,q)=>T+q.amount,0))||0,C=I.amount-P;return o.jsx("div",{className:"bg-white border rounded-lg shadow-sm",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("span",{className:`mt-1 ${I.status==="completed"?"text-green-500":"text-yellow-500"}`,children:I.status==="completed"?o.jsx(Si,{className:"h-5 w-5"}):o.jsx(zo,{className:"h-5 w-5"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:o.jsx("h4",{className:"text-lg font-medium text-gray-900",children:A==null?void 0:A.name})}),I.description&&o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:I.description}),I.late_reason&&o.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["Late entry: ",I.late_reason]}),I.status==="delayed"&&I.delay_reason&&o.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Delay reason: ",I.delay_reason]}),o.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-gray-500",children:[o.jsxs("span",{children:["Created: ",Lt(new Date(I.created_at),"MMM d, yyyy HH:mm")]}),I.completed_at&&o.jsxs("span",{children:["Completed: ",Lt(new Date(I.completed_at),"MMM d, yyyy HH:mm")]})]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Amount: ",v," ",I.amount.toFixed(2)]}),P>0&&o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"text-sm font-medium text-red-600",children:["-",v," ",P.toFixed(2)]}),o.jsxs("p",{className:"text-sm font-medium text-green-600",children:["Net: ",v," ",C.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{d(u===I.id?null:I.id)},className:`px-3 py-1.5 text-xs font-medium rounded-full ${A1[I.status].bg} ${A1[I.status].text} ${A1[I.status].hover}`,children:T1[I.status]}),o.jsx("button",{onClick:()=>c(l===I.id?null:I.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:o.jsx(Dg,{className:"h-5 w-5"})}),o.jsx("button",{onClick:()=>E(I.id),className:"p-2 text-red-400 hover:text-red-600 rounded-full hover:bg-red-50",children:o.jsx(Pi,{className:"h-5 w-5"})})]})]})]}),u===I.id&&o.jsx("div",{className:"mt-4 border-t pt-4",children:o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Update Task Status"}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(T1).map(([T,q])=>T!==I.status&&(T!=="delayed"?o.jsx("button",{onClick:()=>b(I.id,T),className:"px-3 py-1.5 text-sm font-medium rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:q},T):null))}),I.status!=="delayed"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Delay Reason"}),o.jsx("textarea",{value:m,onChange:T=>p(T.target.value),className:`${cd} h-20`,placeholder:"Please provide a reason for the delay",required:!0}),o.jsx("button",{onClick:()=>b(I.id,"delayed",m),disabled:!m.trim(),className:"mt-4 w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Mark as Delayed"})]})]})]})}),l===I.id&&o.jsx(sR,{task:I,tasks:t,setTasks:r,organization:s})]})},I.id)})})]})})}function aR(){const[e,t]=he.useState(null),[r,n]=he.useState(!1),[s,i]=he.useState(null),[a,l]=he.useState([]),[c,u]=he.useState([]),[d,m]=he.useState(!0),[p,h]=he.useState(new Date),y=Ds(p,{weekStartsOn:1}),g=So(p,{weekStartsOn:1}),w=new Date,v=Om(p,{weekStartsOn:1}),b=i2(p),{id:_}=_m(),E=hu(),{organization:D}=qt(),{confirm:I,addToast:A}=en();he.useEffect(()=>{!D||!_||P()},[_,D,p]);const P=async()=>{try{const{data:T,error:q}=await We.from("workers").select("*, organization:organizations(id)").eq("id",_).single();if(q)throw q;t({...T,organization_id:T.organization.id}),i({...T,organization_id:T.organization.id});const{data:U,error:re}=await We.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).eq("worker_id",_);if(re)throw re;l(U||[]);const{data:z,error:G}=await We.from("tasks").select(`
          *,
          deductions (*)
        `).eq("worker_id",_).gte("created_at",y.toISOString()).lte("created_at",g.toISOString()).order("created_at",{ascending:!1});if(G)throw G;u(z||[])}catch(T){console.error("Error loading data:",T),A({type:"error",title:"Error",message:"Failed to load worker data. Please try again."})}finally{m(!1)}},C=async()=>{if(!(!e||!s||!D))try{const{error:T}=await We.from("workers").update({name:s.name,whatsapp:s.whatsapp,image:s.image}).eq("id",e.id).eq("organization_id",D.id);if(T)throw T;t(s),n(!1),A({type:"success",title:"Worker Updated",message:"Worker details have been updated successfully."})}catch(T){console.error("Error updating worker:",T),A({type:"error",title:"Error",message:"Failed to update worker. Please try again."})}},M=async()=>{if(!(!e||!await I({title:"Delete Worker",message:"Are you sure you want to delete this worker? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"})))try{if(e.image){const U=e.image.split("/").slice(-2).join("/");await We.storage.from("profiles").remove([U])}const{error:q}=await We.from("workers").delete().eq("id",e.id);if(q)throw q;A({type:"success",title:"Worker Deleted",message:"The worker has been deleted successfully."}),E("/dashboard/workers")}catch(q){console.error("Error deleting worker:",q),A({type:"error",title:"Error",message:"Failed to delete worker. Please try again."})}},j=T=>{h(q=>{const U=new Date(q);return T==="prev"?U.setDate(U.getDate()-7):U.setDate(U.getDate()+7),U})};return d?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading worker details..."})]})}):e?o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-white shadow rounded-lg",children:o.jsxs("div",{className:"p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>j("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:o.jsx(Pm,{className:"h-5 w-5 text-gray-600"})}),o.jsxs("div",{className:"text-sm",children:[o.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",v,", ",b]}),o.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[Lt(y,"MMM d")," - ",Lt(g,"MMM d")]})]}),o.jsx("button",{onClick:()=>j("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:pl(g,w),children:o.jsx(Lm,{className:"h-5 w-5 text-gray-600"})})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[c.length," tasks this week"]})]})}),o.jsx(rR,{worker:e,tasks:c,workerProjects:a,isEditing:r,setIsEditing:n,editedWorker:s,setEditedWorker:i,handleEditWorker:C,handleDeleteWorker:M}),o.jsx(nR,{worker:e,workerProjects:a,setWorkerProjects:l,organization:D}),o.jsx(iR,{worker:e,tasks:c,setTasks:u,workerProjects:a,organization:D})]}):o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600",children:"Worker not found."}),o.jsxs("button",{onClick:()=>E("/dashboard/workers"),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(jl,{className:"h-4 w-4 mr-2"}),"Back to Workers"]})]})})}function oR(){var l;const{organization:e}=qt(),[t,r]=he.useState({totalWorkers:0,pendingTasks:0,inProgressTasks:0,delayedTasks:0,completedTasks:0,totalPayouts:0}),[n,s]=he.useState(!0),i=((l=Ar[e.currency])==null?void 0:l.symbol)||e.currency;if(he.useEffect(()=>{(async()=>{if(e)try{const{count:u}=await We.from("workers").select("*",{count:"exact",head:!0}).eq("organization_id",e.id),{data:d}=await We.from("tasks").select("status, amount, deductions(*)").eq("organization_id",e.id),m=(d==null?void 0:d.filter(w=>w.status==="pending").length)||0,p=(d==null?void 0:d.filter(w=>w.status==="in_progress").length)||0,h=(d==null?void 0:d.filter(w=>w.status==="delayed").length)||0,y=(d==null?void 0:d.filter(w=>w.status==="completed").length)||0,g=(d==null?void 0:d.reduce((w,v)=>{var _;const b=((_=v.deductions)==null?void 0:_.reduce((E,D)=>E+(D.amount||0),0))||0;return w+(v.amount-b)},0))||0;r({totalWorkers:u||0,pendingTasks:m,inProgressTasks:p,delayedTasks:h,completedTasks:y,totalPayouts:g})}catch(u){console.error("Error loading stats:",u)}finally{s(!1)}})()},[e]),n)return o.jsx("div",{className:"animate-pulse",children:o.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((c,u)=>o.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:o.jsxs("div",{className:"p-5",children:[o.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-4"}),o.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"})]})},u))})});const a=[{name:"Total Workers",value:t.totalWorkers,icon:iu,color:"text-blue-600",bg:"bg-blue-100",link:"/dashboard/workers"},{name:"Assigned Tasks",value:t.pendingTasks,icon:Ic,color:"text-yellow-600",bg:"bg-yellow-100",link:"/dashboard/tasks/pending"},{name:"In Progress",value:t.inProgressTasks,icon:Ic,color:"text-blue-600",bg:"bg-blue-100",link:"/dashboard/tasks/in_progress"},{name:"Delayed Tasks",value:t.delayedTasks,icon:Ic,color:"text-red-600",bg:"bg-red-100",link:"/dashboard/tasks/delayed"},{name:"Completed Tasks",value:t.completedTasks,icon:WA,color:"text-green-600",bg:"bg-green-100",link:"/dashboard/tasks/completed"},{name:"Total Payouts",value:`${i} ${t.totalPayouts.toFixed(2)}`,icon:Aa,color:"text-purple-600",bg:"bg-purple-100",link:"/dashboard/finances"}];return o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:a.map(c=>o.jsx(gr,{to:c.link,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow",children:o.jsx("div",{className:"p-5",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:`flex-shrink-0 ${c.bg} rounded-md p-3`,children:o.jsx(c.icon,{className:`h-6 w-6 ${c.color}`,"aria-hidden":"true"})}),o.jsx("div",{className:"ml-5 w-0 flex-1",children:o.jsxs("dl",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:c.name}),o.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:c.value})]})})]})})},c.name))}),o.jsx("div",{className:"bg-white shadow rounded-lg",children:o.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[o.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Quick Actions"}),o.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[o.jsxs(gr,{to:"/dashboard/workers",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[o.jsx("div",{className:"flex-shrink-0 bg-blue-100 rounded-md p-3",children:o.jsx(iu,{className:"h-6 w-6 text-blue-600","aria-hidden":"true"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Manage Workers"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Add or edit worker details"})]})]}),o.jsxs(gr,{to:"/dashboard/tasks",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[o.jsx("div",{className:"flex-shrink-0 bg-yellow-100 rounded-md p-3",children:o.jsx(Ic,{className:"h-6 w-6 text-yellow-600","aria-hidden":"true"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Manage Tasks"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Create and track tasks"})]})]}),o.jsxs(gr,{to:"/dashboard/finances",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[o.jsx("div",{className:"flex-shrink-0 bg-purple-100 rounded-md p-3",children:o.jsx(Aa,{className:"h-6 w-6 text-purple-600","aria-hidden":"true"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Financial Reports"}),o.jsx("p",{className:"text-sm text-gray-500",children:"View and export financial data"})]})]})]})]})})]})}const r0={pending:"Pending",in_progress:"In Progress",completed:"Completed",delayed:"Delayed"},el={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},delayed:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"}};function ud({status:e}){var R;const{organization:t}=qt(),[r,n]=he.useState([]),[s,i]=he.useState([]),[a,l]=he.useState([]),[c,u]=he.useState(!0),[d,m]=he.useState(!1),[p,h]=he.useState(null),[y,g]=he.useState(null),[w,v]=he.useState(new Date),{weekStart:b,weekEnd:_,currentWeek:E,currentYear:D}=he.useMemo(()=>{const O=Ds(w,{weekStartsOn:1}),V=So(w,{weekStartsOn:1}),ne=Om(w,{weekStartsOn:1}),ue=i2(w);return{weekStart:O,weekEnd:V,currentWeek:ne,currentYear:ue}},[w]),I=new Date,[A,P]=he.useState(""),[C,M]=he.useState({worker_id:"",project_id:"",description:"",due_date:new Date().toISOString().split("T")[0],late_reason:""}),[j,T]=he.useState({amount:0,reason:""}),{confirm:q,addToast:U}=en(),re=t!=null&&t.currency?((R=Ar[t.currency])==null?void 0:R.symbol)||t.currency:"";he.useEffect(()=>{t!=null&&t.id&&z()},[t==null?void 0:t.id,b,_,e]),he.useEffect(()=>{!t||!C.worker_id||G(C.worker_id)},[t,C.worker_id]);const z=async()=>{if(!(t!=null&&t.id))return;const O=t.id;try{const{data:V,error:ne}=await We.from("workers").select("id, name").eq("organization_id",O);if(ne)throw ne;i(V||[]);let ue=We.from("tasks").select(`
          *,
          deductions (*),
          project:projects(
            id,
            name
          ),
          worker:workers(
            id,
            name
          )
        `).eq("organization_id",O).gte("created_at",b.toISOString()).lte("created_at",_.toISOString()).order("created_at",{ascending:!1});e&&(ue=ue.eq("status",e));const{data:fe,error:ye}=await ue;if(ye)throw ye;n(fe||[])}catch(V){console.error("Error loading data:",V)}finally{u(!1)}},G=async O=>{if(t!=null&&t.id)try{const{data:ne,error:ue}=await We.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects!inner(
            id,
            name
          )
        `).eq("worker_id",O).returns();if(ue)throw ue;l(ne||[])}catch(ne){console.error("Error loading worker projects:",ne)}},B=async()=>{var fe;if(!t||!C.worker_id||!C.project_id)return;const O=((fe=a.find(ye=>ye.project_id===C.project_id))==null?void 0:fe.rate)||0,V=new Date(C.due_date),ne=El(new Date),ue=pl(ne,V);if(ue&&!C.late_reason){alert("Please provide a reason for adding a task for a past date.");return}try{const{data:ye,error:pe}=await We.from("tasks").insert([{organization_id:t.id,worker_id:C.worker_id,project_id:C.project_id,description:C.description.trim()||null,due_date:C.due_date,amount:O,status:"pending",late_reason:ue?C.late_reason:null}]).select(`
          *,
          deductions (*)
        `).single();if(pe)throw pe;n(_e=>[ye,..._e]),M({worker_id:"",project_id:"",description:"",due_date:new Date().toISOString().split("T")[0],late_reason:""}),m(!1)}catch(ye){console.error("Error adding task:",ye)}},Y=async O=>{if(await q({title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:ne}=await We.from("tasks").delete().eq("id",O);if(ne)throw ne;n(ue=>ue.filter(fe=>fe.id!==O)),U({type:"success",title:"Task Deleted",message:"The task has been deleted successfully."})}catch(ne){console.error("Error deleting task:",ne),U({type:"error",title:"Error",message:"Failed to delete task. Please try again."})}},se=async(O,V,ne)=>{try{const ue={status:V};V==="completed"?ue.completed_at=new Date().toISOString():V==="delayed"&&(ue.delay_reason=ne),ue.status_changed_at=new Date().toISOString();const{error:fe}=await We.from("tasks").update(ue).eq("id",O);if(fe)throw fe;n(ye=>ye.map(pe=>pe.id===O?{...pe,...ue}:pe)),g(null),P(""),U({type:"success",title:"Status Updated",message:`Task marked as ${r0[V]}`})}catch(ue){console.error("Error updating task status:",ue),U({type:"error",title:"Error",message:"Failed to update task status"})}},me=async O=>{if(!(!O||!j.amount||!j.reason))try{const{data:V,error:ne}=await We.from("deductions").insert([{task_id:O,amount:j.amount,reason:j.reason.trim()}]).select().single();if(ne)throw ne;n(ue=>ue.map(fe=>fe.id===O?{...fe,deductions:[...fe.deductions||[],V]}:fe)),T({amount:0,reason:""}),h(null)}catch(V){console.error("Error adding deduction:",V)}},S=async(O,V)=>{try{const{error:ne}=await We.from("deductions").delete().eq("id",V);if(ne)throw ne;n(ue=>ue.map(fe=>{var ye;return fe.id===O?{...fe,deductions:(ye=fe.deductions)==null?void 0:ye.filter(pe=>pe.id!==V)}:fe}))}catch(ne){console.error("Error removing deduction:",ne)}},L=O=>{v(V=>{const ne=new Date(V);return O==="prev"?ne.setDate(ne.getDate()-7):ne.setDate(ne.getDate()+7),ne})};return c?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"flex gap-2 bg-white rounded-lg p-1 shadow-sm",children:[o.jsx(gr,{to:"/dashboard/tasks",className:`px-3 py-1.5 text-sm font-medium rounded-md ${e?"text-gray-500 hover:bg-gray-50":"bg-gray-100 text-gray-900"}`,children:"All Tasks"}),Object.entries(r0).map(([O,V])=>o.jsx(gr,{to:`/dashboard/tasks/${O}`,className:`px-3 py-1.5 text-sm font-medium rounded-md ${e===O?`${el[O].bg} ${el[O].text}`:"text-gray-500 hover:bg-gray-100"}`,children:V},O))]}),o.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]}),o.jsx("div",{className:"bg-white shadow rounded-lg",children:o.jsxs("div",{className:"p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>L("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:o.jsx(Pm,{className:"h-5 w-5 text-gray-600"})}),o.jsxs("div",{className:"text-sm",children:[o.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",E,", ",D]}),o.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[Lt(b,"MMM d")," - ",Lt(_,"MMM d")]})]}),o.jsx("button",{onClick:()=>L("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:pl(_,I),children:o.jsx(Lm,{className:"h-5 w-5 text-gray-600"})})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," tasks this week"]})]})}),d&&o.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border border-gray-100",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Task"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Worker *"}),o.jsxs("select",{value:C.worker_id,onChange:O=>M(V=>({...V,worker_id:O.target.value,project_id:""})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"Select a worker"}),s.map(O=>o.jsx("option",{value:O.id,children:O.name},O.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project *"}),o.jsxs("select",{value:C.project_id,onChange:O=>M(V=>({...V,project_id:O.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",disabled:!C.worker_id,children:[o.jsx("option",{value:"",children:"Select a project"}),a.map(O=>o.jsxs("option",{value:O.project_id,children:[O.project.name," - ",re," ",O.rate.toFixed(2)]},O.project_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),o.jsx("input",{type:"text",value:C.description,onChange:O=>M(V=>({...V,description:O.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter task description (optional)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date *"}),o.jsx("input",{type:"date",value:C.due_date,onChange:O=>M(V=>({...V,due_date:O.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",max:new Date().toISOString().split("T")[0]})]}),pl(El(new Date),new Date(C.due_date))&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Late Entry"}),o.jsx("textarea",{value:C.late_reason,onChange:O=>M(V=>({...V,late_reason:O.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm h-20",placeholder:"Please provide a reason for adding this task after the date",required:!0})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[o.jsx("button",{onClick:()=>m(!1),className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),o.jsxs("button",{onClick:B,disabled:!C.worker_id||!C.project_id,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]})]}),o.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:o.jsx("div",{className:"p-4 space-y-4",children:r.length===0?o.jsx("div",{className:"text-center text-gray-500 py-8",children:e?"No tasks found matching this status.":"No tasks found for this week."}):r.map(O=>{var ue,fe,ye;const V=((ue=O.deductions)==null?void 0:ue.reduce((pe,_e)=>pe+_e.amount,0))||0,ne=O.amount-V;return o.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[o.jsx("div",{className:"p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("span",{className:`mt-1 ${O.status==="completed"?"text-green-500":O.status==="delayed"?"text-red-500":"text-yellow-500"}`,children:O.status==="completed"?o.jsx(Si,{className:"h-5 w-5"}):O.status==="delayed"?o.jsx(zo,{className:"h-5 w-5"}):o.jsx(Dg,{className:"h-5 w-5"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[o.jsx("h4",{className:"text-lg font-medium text-gray-900",children:((fe=O.project)==null?void 0:fe.name)||"Unknown Project"}),o.jsxs("span",{className:"text-sm text-gray-500",children:[" Assigned to ",((ye=O.worker)==null?void 0:ye.name)||"Unknown Worker"]})]}),O.description&&o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:O.description}),O.late_reason&&o.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["Late entry: ",O.late_reason]}),O.status==="delayed"&&O.delay_reason&&o.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Delay reason: ",O.delay_reason]}),o.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-gray-500",children:[o.jsxs("span",{children:["Created: ",Lt(new Date(O.created_at),"MMM d, yyyy HH:mm")]}),O.completed_at&&o.jsxs("span",{children:["Completed: ",Lt(new Date(O.completed_at),"MMM d, yyyy HH:mm")]})]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Amount: ",re," ",O.amount.toFixed(2)]}),V>0&&o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"text-sm font-medium text-red-600",children:["-",re," ",V.toFixed(2)]}),o.jsxs("p",{className:"text-sm font-medium text-green-600",children:["Net: ",re," ",ne.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>g(y===O.id?null:O.id),className:`px-3 py-1.5 text-xs font-medium rounded-full ${el[O.status].bg} ${el[O.status].text} ${el[O.status].hover}`,children:r0[O.status]}),o.jsx("button",{onClick:()=>h(p===O.id?null:O.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:o.jsx(Dg,{className:"h-5 w-5"})}),o.jsx("button",{onClick:()=>Y(O.id),className:"p-2 text-red-400 hover:text-red-600 rounded-full hover:bg-red-50",children:o.jsx(Pi,{className:"h-5 w-5"})})]})]})]})}),y===O.id&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Update Status"}),o.jsxs("div",{className:"space-y-3",children:[Object.entries(r0).map(([pe,_e])=>o.jsx("button",{onClick:()=>{if(pe==="delayed"&&!A){U({type:"error",title:"Error",message:"Please provide a reason for the delay"});return}se(O.id,pe,pe==="delayed"?A:void 0)},className:`w-full px-3 py-2 text-sm font-medium rounded-md ${O.status===pe?`${el[pe].bg} ${el[pe].text}`:"bg-white text-gray-700 hover:bg-gray-100"}`,children:_e},pe)),y===O.id&&o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Delay Reason"}),o.jsx("textarea",{value:A,onChange:pe=>P(pe.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm h-20",placeholder:"Required if marking as delayed"})]})]})]}),p===O.id&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Deductions"}),O.deductions&&O.deductions.length>0&&o.jsx("div",{className:"mb-4 space-y-2",children:O.deductions.map(pe=>o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("div",{children:[o.jsxs("span",{className:"font-medium text-gray-900",children:[re," ",pe.amount.toFixed(2)]}),o.jsxs("span",{className:"text-gray-500 ml-2",children:["- ",pe.reason]})]}),o.jsx("button",{onClick:()=>S(O.id,pe.id),className:"text-red-400 hover:text-red-600",children:o.jsx(Pi,{className:"h-4 w-4"})})]},pe.id))}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),o.jsx("input",{type:"number",value:j.amount,onChange:pe=>T(_e=>({..._e,amount:parseFloat(pe.target.value)||0})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason"}),o.jsx("input",{type:"text",value:j.reason,onChange:pe=>T(_e=>({..._e,reason:pe.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsx("button",{onClick:()=>me(O.id),disabled:!j.amount||!j.reason.trim(),className:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Deduction"})]})]})]},O.id)})})})]})}const tw=[{value:15,label:"0-15 employees"},{value:30,label:"15-30 employees"},{value:50,label:"30-50 employees"},{value:100,label:"50-100 employees"},{value:200,label:"100-200 employees"},{value:201,label:"200+ employees"}],C1={GHS:{name:"Ghanaian Cedi",symbol:""},USD:{name:"US Dollar",symbol:"$"},EUR:{name:"Euro",symbol:""},GBP:{name:"British Pound",symbol:""},NGN:{name:"Nigerian Naira",symbol:""}};function lR(){var p,h,y;const{organization:e,signOut:t}=qt();hu();const[r,n]=he.useState(!1),[s,i]=he.useState({name:e.name,country:e.country||"",city:e.city||"",address:e.address||"",employee_count:e.employee_count||15,currency:e.currency||"GHS"}),[a,l]=he.useState(!1),{confirm:c,addToast:u}=en(),d=async()=>{if(!s.name.trim()){n(!1);return}l(!0);try{const{error:g}=await We.from("organizations").update({name:s.name.trim(),country:s.country,city:s.city,address:s.address,employee_count:s.employee_count,currency:s.currency}).eq("id",e.id);if(g)throw g;qt.setState({organization:{...e,...s}}),n(!1),u({type:"success",title:"Organization Updated",message:"Organization details have been updated successfully."})}catch(g){console.error("Error updating organization:",g),u({type:"error",title:"Error",message:"Failed to update organization name. Please try again."})}finally{l(!1)}},m=async()=>{if(await c({title:"Delete Organization",message:"Are you sure you want to delete your organization? This will permanently delete all workers, tasks, and associated data. This action cannot be undone.",type:"danger",confirmText:"Delete Organization",cancelText:"Cancel"}))try{const{error:w}=await We.from("organizations").delete().eq("id",e.id);if(w)throw w;await t(),window.location.href="/",u({type:"success",title:"Organization Deleted",message:"Your organization and all associated data have been permanently deleted."})}catch(w){console.error("Error deleting organization:",w),u({type:"error",title:"Error",message:"Failed to delete organization. Please try again."})}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white shadow rounded-lg divide-y",children:[o.jsxs("div",{className:"px-6 py-5",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Qi,{className:"h-6 w-6 text-gray-400"}),o.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Services"})]}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage the services your organization provides."})]}),o.jsx("div",{className:"px-6 py-5",children:o.jsx("div",{className:"space-y-4",children:o.jsxs(gr,{to:"/dashboard/settings/services",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(Qi,{className:"h-4 w-4 mr-2"}),"Manage Services"]})})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg divide-y",children:[o.jsxs("div",{className:"px-6 py-5",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ao,{className:"h-6 w-6 text-gray-400"}),o.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Organization Settings"})]}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your organization's basic information and settings."})]}),o.jsx("div",{className:"px-6 py-5",children:o.jsx("div",{className:"space-y-6",children:o.jsx("div",{children:r?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organization Name"}),o.jsx("div",{className:"mt-1",children:o.jsx("input",{type:"text",value:s.name,onChange:g=>i(w=>({...w,name:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter organization name"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),o.jsx("div",{className:"mt-1",children:o.jsx("input",{type:"text",value:s.country,onChange:g=>i(w=>({...w,country:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),o.jsx("div",{className:"mt-1",children:o.jsx("input",{type:"text",value:s.city,onChange:g=>i(w=>({...w,city:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),o.jsx("div",{className:"mt-1",children:o.jsx("textarea",{value:s.address,onChange:g=>i(w=>({...w,address:g.target.value})),rows:3,className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Employees"}),o.jsx("div",{className:"mt-1",children:o.jsx("select",{value:s.employee_count||"",onChange:g=>i(w=>({...w,employee_count:parseInt(g.target.value)})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:tw.map((g,w)=>o.jsx("option",{value:g.value,children:g.label},w))})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Currency"}),o.jsx("div",{className:"mt-1",children:o.jsx("select",{value:s.currency,onChange:g=>i(w=>({...w,currency:g.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:Object.entries(C1).map(([g,{name:w,symbol:v}])=>o.jsxs("option",{value:g,children:[g," (",v,") - ",w]},g))})})]}),o.jsx("button",{onClick:d,disabled:a||!s.name.trim(),className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:a?"Saving...":"Save"}),o.jsx("button",{onClick:()=>{n(!1),i({name:e.name,country:e.country,city:e.city,address:e.address,employee_count:e.employee_count,currency:e.currency})},className:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ao,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Organization Name"}),o.jsx("p",{className:"text-base text-gray-900",children:e.name})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(LA,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Country"}),o.jsx("p",{className:"text-base text-gray-900",children:e.country})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(EA,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"City"}),o.jsx("p",{className:"text-base text-gray-900",children:e.city})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(r2,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Address"}),o.jsx("p",{className:"text-base text-gray-900",children:e.address})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(iu,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Number of Employees"}),o.jsx("p",{className:"text-base text-gray-900",children:((p=tw.find(g=>g.value===e.employee_count))==null?void 0:p.label)||"Not set"})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(CA,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Currency"}),o.jsxs("p",{className:"text-base text-gray-900",children:[e.currency," (",(h=C1[e.currency])==null?void 0:h.symbol,") - ",(y=C1[e.currency])==null?void 0:y.name]})]})]})]}),o.jsx("button",{onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Edit Organization Details"})]})})})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg divide-y space-y-4",children:[o.jsxs("div",{className:"px-6 py-5",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(lf,{className:"h-6 w-6 text-red-500"}),o.jsx("h3",{className:"ml-3 text-lg font-medium text-red-600",children:"Danger Zone"})]}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Irreversible and destructive actions"})]}),o.jsx("div",{className:"px-6 py-5",children:o.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(lf,{className:"h-5 w-5 text-red-400"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Delete Organization"}),o.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[o.jsx("p",{children:"Once you delete your organization, there is no going back. Please be certain. This will delete:"}),o.jsxs("ul",{className:"list-disc list-inside mt-2",children:[o.jsx("li",{children:"All workers and their data"}),o.jsx("li",{children:"All tasks and financial records"}),o.jsx("li",{children:"All projects and rates"}),o.jsx("li",{children:"All uploaded files and images"})]})]}),o.jsx("div",{className:"mt-4",children:o.jsx("button",{type:"button",onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Organization"})})]})]})})}),o.jsx("div",{className:"px-6 py-5",children:o.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(HA,{className:"h-5 w-5 text-red-400"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Delete Account"}),o.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[o.jsx("p",{children:"Permanently delete your account and all associated data. This action cannot be undone. This will:"}),o.jsxs("ul",{className:"list-disc list-inside mt-2",children:[o.jsx("li",{children:"Delete your user account"}),o.jsx("li",{children:"Delete your organization"}),o.jsx("li",{children:"Remove all workers and their data"}),o.jsx("li",{children:"Remove all tasks and financial records"}),o.jsx("li",{children:"Delete all uploaded files"})]})]}),o.jsx("div",{className:"mt-4",children:o.jsx("button",{type:"button",onClick:async()=>{if(await c({title:"Delete Account",message:"Are you absolutely sure you want to delete your account? This action cannot be undone.",type:"danger",confirmText:"Delete Account",cancelText:"Cancel"}))try{await qt.getState().deleteAccount(),window.location.href="/"}catch(w){console.error("Error deleting account:",w)}},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Account Permanently"})})]})]})})})]})]})}function cR(){var q;const[e,t]=he.useState([]),[r,n]=he.useState(!0),[s,i]=he.useState(""),[a,l]=he.useState(null),[c,u]=he.useState(!1),[d,m]=he.useState({title:"",value:"",type:"text",file:null}),[p,h]=he.useState({name:"",phone:"",address:"",date_of_birth:"",customFields:[{title:"",value:"",type:"text",file:null}]}),[y,g]=he.useState(!1),{organization:w}=qt(),{confirm:v,addToast:b}=en(),_=w!=null&&w.currency?((q=Ar[w.currency])==null?void 0:q.symbol)||w.currency:"";he.useEffect(()=>{w&&E()},[w]);const E=async()=>{if(w!=null&&w.id)try{const{data:U,error:re}=await We.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*),
          orders:orders(outstanding_balance),
          sales_orders:sales_orders(outstanding_balance)
        `).eq("organization_id",w.id).order("name");if(re)throw re;const z=(U==null?void 0:U.map(G=>{var se,me;const B=((se=G.orders)==null?void 0:se.reduce((S,L)=>S+(L.outstanding_balance||0),0))||0,Y=((me=G.sales_orders)==null?void 0:me.reduce((S,L)=>S+(L.outstanding_balance||0),0))||0;return{...G,total_balance:B+Y}}))||[];t(z)}catch(U){console.error("Error loading clients:",U),b({type:"error",title:"Error",message:"Failed to load clients"})}finally{n(!1)}},D=async()=>{var U;if(!(!w||!p.name.trim())){g(!0);try{const{data:re,error:z}=await We.from("clients").insert([{organization_id:w.id,name:p.name.trim(),phone:p.phone.trim(),address:p.address.trim(),date_of_birth:p.date_of_birth||null}]).select().single();if(z)throw z;const G=p.customFields.filter(B=>B.title.trim()&&(B.type==="text"?B.value.trim():B.file));if(G.length>0)for(const B of G){let Y=B.value;if(B.type==="file"&&B.file){const me=(U=B.file.name.split(".").pop())==null?void 0:U.toLowerCase(),S=`${Math.random().toString(36).substring(2)}.${me}`,L=`${w.id}/clients/${re.id}/${S}`,{error:R}=await We.storage.from("profiles").upload(L,B.file,{cacheControl:"3600",upsert:!1});if(R)throw R;const{data:{publicUrl:O}}=We.storage.from("profiles").getPublicUrl(L);Y=O}const{error:se}=await We.from("client_custom_fields").insert({client_id:re.id,title:B.title.trim(),value:Y,type:B.type});if(se)throw se}await E(),h({name:"",phone:"",address:"",date_of_birth:"",customFields:[{title:"",value:"",type:"text",file:null}]}),u(!1),b({type:"success",title:"Client Added",message:"New client has been added successfully."})}catch(re){console.error("Error adding client:",re),b({type:"error",title:"Error",message:"Failed to add client"})}finally{g(!1)}}},I=async U=>{if(await v({title:"Delete Client",message:"Are you sure you want to delete this client? This will also delete all their custom information.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:z}=await We.from("clients").delete().eq("id",U);if(z)throw z;t(G=>G.filter(B=>B.id!==U)),b({type:"success",title:"Client Deleted",message:"Client has been deleted successfully."})}catch(z){console.error("Error deleting client:",z),b({type:"error",title:"Error",message:"Failed to delete client"})}},A=async(U,re,z,G="text")=>{try{const{data:B,error:Y}=await We.from("client_custom_fields").insert([{client_id:U,title:re.trim(),value:z.trim(),type:G}]).select().single();if(Y)throw Y;t(se=>se.map(me=>me.id===U?{...me,custom_fields:[...me.custom_fields||[],B]}:me)),b({type:"success",title:"Field Added",message:"Custom field has been added successfully."})}catch(B){console.error("Error adding custom field:",B),b({type:"error",title:"Error",message:"Failed to add custom field"})}},P=async(U,re)=>{try{const{error:z}=await We.from("client_custom_fields").delete().eq("id",re);if(z)throw z;t(G=>G.map(B=>{var Y;return B.id===U?{...B,custom_fields:(Y=B.custom_fields)==null?void 0:Y.filter(se=>se.id!==re)}:B})),b({type:"success",title:"Field Deleted",message:"Custom field has been deleted successfully."})}catch(z){console.error("Error deleting custom field:",z),b({type:"error",title:"Error",message:"Failed to delete custom field"})}},C=()=>{h(U=>({...U,customFields:[...U.customFields,{title:"",value:"",type:"text",file:null}]}))},M=U=>{h(re=>({...re,customFields:re.customFields.filter((z,G)=>G!==U)}))},j=(U,re)=>{h(z=>({...z,customFields:z.customFields.map((G,B)=>B===U?{...G,...re}:G)}))};if(r)return o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const T=e.filter(U=>{var re,z;return U.name.toLowerCase().includes(s.toLowerCase())||((re=U.phone)==null?void 0:re.toLowerCase().includes(s.toLowerCase()))||((z=U.address)==null?void 0:z.toLowerCase().includes(s.toLowerCase()))});return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Clients"}),o.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Client"]})]}),c&&o.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Client"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),o.jsx("input",{type:"text",value:p.name,onChange:U=>h(re=>({...re,name:U.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter client name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),o.jsx("input",{type:"tel",value:p.phone,onChange:U=>h(re=>({...re,phone:U.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter phone number"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),o.jsx("textarea",{value:p.address,onChange:U=>h(re=>({...re,address:U.target.value})),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),o.jsx("input",{type:"date",value:p.date_of_birth,onChange:U=>h(re=>({...re,date_of_birth:U.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Custom Information"}),o.jsxs("button",{type:"button",onClick:C,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:[o.jsx(Jr,{className:"h-4 w-4 mr-1"}),"Add Field"]})]}),p.customFields.map((U,re)=>o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsxs("div",{className:"flex-1 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),o.jsx("input",{type:"text",value:U.title,onChange:z=>j(re,{title:z.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),o.jsxs("select",{value:U.type,onChange:z=>j(re,{type:z.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"text",children:"Text"}),o.jsx("option",{value:"file",children:"File"})]})]}),U.type==="text"?o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),o.jsx("input",{type:"text",value:U.value||"",onChange:z=>j(re,{value:z.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),o.jsxs("div",{className:"mt-1 flex items-center",children:[o.jsx("input",{type:"file",onChange:z=>{var B;const G=(B=z.target.files)==null?void 0:B[0];G&&j(re,{file:G})},className:"hidden",id:`file-${re}`}),o.jsxs("label",{htmlFor:`file-${re}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(cf,{className:"h-4 w-4 mr-2"}),"Choose File"]}),U.file&&o.jsx("span",{className:"ml-3 text-sm text-gray-500",children:U.file.name})]})]})]}),o.jsx("button",{type:"button",onClick:()=>M(re),className:"mt-8 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:o.jsx(Pi,{className:"h-5 w-5"})})]},re))]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),o.jsx("button",{onClick:D,disabled:!p.name.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:y?o.jsxs(o.Fragment,{children:[o.jsx(To,{className:"animate-spin h-4 w-4 mr-2"}),"Adding..."]}):"Add Client"})]})]})]}),o.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[o.jsx(jf,{className:"h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:s,onChange:U=>i(U.target.value),placeholder:"Search clients...",className:"ml-2 flex-1 outline-none bg-transparent"})]})}),o.jsx("div",{className:"overflow-x-auto",children:T.length===0?o.jsx("div",{className:"text-center text-gray-500 py-8",children:s?"No clients found matching your search.":"No clients added yet."}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date of Birth"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Custom Information"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(U=>{var re;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a===U.id?o.jsx("input",{type:"text",value:U.name,onChange:z=>t(G=>G.map(B=>B.id===U.id?{...B,name:z.target.value}:B)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):o.jsx(gr,{to:`/clients/${U.id}`,className:"text-sm font-medium text-blue-600 hover:text-blue-800",children:U.name})}),o.jsx("td",{className:"px-6 py-4",children:a===U.id?o.jsxs("div",{className:"space-y-2",children:[o.jsx("input",{type:"tel",value:U.phone||"",onChange:z=>t(G=>G.map(B=>B.id===U.id?{...B,phone:z.target.value}:B)),placeholder:"Phone",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),o.jsx("textarea",{value:U.address||"",onChange:z=>t(G=>G.map(B=>B.id===U.id?{...B,address:z.target.value}:B)),placeholder:"Address",rows:2,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}):o.jsxs("div",{className:"text-sm text-gray-500",children:[U.phone&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(n2,{className:"h-4 w-4 mr-1"}),U.phone]}),U.address&&o.jsxs("div",{className:"flex items-center mt-1",children:[o.jsx(r2,{className:"h-4 w-4 mr-1"}),U.address]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a===U.id?o.jsx("input",{type:"date",value:U.date_of_birth||"",onChange:z=>t(G=>G.map(B=>B.id===U.id?{...B,date_of_birth:z.target.value}:B)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):U.date_of_birth?o.jsx("div",{className:"text-sm text-gray-500",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ol,{className:"h-4 w-4 mr-1"}),Lt(new Date(U.date_of_birth),"MMM d, yyyy")]})}):null}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"text-sm text-gray-900",children:[(re=U.custom_fields)==null?void 0:re.map((z,G)=>o.jsxs("div",{className:"flex items-center justify-between mb-2 bg-gray-50 p-2 rounded",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("span",{className:"font-medium",children:[z.title,": "]}),z.type==="file"?o.jsx("a",{href:z.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"View File"}):o.jsx("span",{children:z.value})]}),o.jsx("button",{onClick:()=>P(U.id,z.id),className:"ml-2 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:o.jsx(ti,{className:"h-4 w-4"})})]},z.id)),a===U.id&&o.jsxs("div",{className:"mt-4 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Custom Information"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),o.jsxs("select",{value:d.type,onChange:z=>m(G=>({...G,type:z.target.value,value:"",file:null})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"text",children:"Text"}),o.jsx("option",{value:"file",children:"File"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),o.jsx("input",{type:"text",value:d.title,onChange:z=>m(G=>({...G,title:z.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),d.type==="text"?o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),o.jsx("input",{type:"text",value:d.value||"",onChange:z=>m(G=>({...G,value:z.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),o.jsxs("div",{className:"mt-1 flex items-center",children:[o.jsx("input",{type:"file",onChange:z=>{var B;const G=(B=z.target.files)==null?void 0:B[0];G&&m(Y=>({...Y,file:G}))},className:"hidden",id:`custom-file-${U.id}`}),o.jsxs("label",{htmlFor:`custom-file-${U.id}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(cf,{className:"h-4 w-4 mr-2"}),"Choose File"]}),d.file&&o.jsx("span",{className:"ml-3 text-sm text-gray-500",children:d.file.name})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>m({title:"",value:"",type:"text",file:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Clear"}),o.jsx("button",{onClick:()=>{d.title&&(d.value||d.file)&&(A(U.id,d.title,d.value||"",d.type),m({title:"",value:"",type:"text",file:null}))},disabled:!d.title||!d.value&&!d.file,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Field"})]})]})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("span",{className:`text-sm font-medium ${U.total_balance>0?"text-red-600":"text-green-600"}`,children:[_," ",U.total_balance.toFixed(2)]}),o.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:"Total Outstanding"})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>I(U.id),className:"text-red-600 hover:text-red-900",children:o.jsx(Pi,{className:"h-4 w-4"})})})})]},U.id)})})]})})]})]})}function uR(){var m;const{organization:e}=qt(),[t,r]=he.useState(new Date),[n,s]=he.useState([]),[i,a]=he.useState(!0),l=((m=Ar[e.currency])==null?void 0:m.symbol)||e.currency;he.useEffect(()=>{if(!e)return;(async()=>{a(!0);try{const h=Ds(t,{weekStartsOn:1}),y=So(t,{weekStartsOn:1}),{data:g,error:w}=await We.from("tasks").select(`
            *,
            deductions (
              amount
            )
          `).eq("organization_id",e.id).gte("created_at",h.toISOString()).lte("created_at",y.toISOString());if(w)throw w;const v=(g||[]).reduce((_,E)=>{var A;const D=E.created_at.split("T")[0];_[D]||(_[D]={date:D,totalTasks:0,totalAmount:0,totalDeductions:0,netAmount:0});const I=((A=E.deductions)==null?void 0:A.reduce((P,C)=>P+(C.amount||0),0))||0;return _[D].totalTasks+=1,_[D].totalAmount+=E.amount,_[D].totalDeductions+=I,_[D].netAmount+=E.amount-I,_},{}),b=Object.values(v).sort((_,E)=>new Date(_.date).getTime()-new Date(E.date).getTime());s(b)}catch(h){console.error("Error loading financial data:",h)}finally{a(!1)}})()},[e,t]);const c=p=>{r(h=>p==="prev"?sC(h):h_(h,1))},u=p=>{const h=Ds(t,{weekStartsOn:1}),y=So(t,{weekStartsOn:1}),{workbook:g,pdf:w}=tR(n,{start:h,end:y},e.currency),v=`financial_report_${Lt(t,"yyyy-MM-dd")}`;p==="excel"?WI(g,`${v}.xlsx`):w.save(`${v}.pdf`)},d=n.reduce((p,h)=>({tasks:p.tasks+h.totalTasks,amount:p.amount+h.totalAmount,deductions:p.deductions+h.totalDeductions,net:p.net+h.netAmount}),{tasks:0,amount:0,deductions:0,net:0});return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Financial Dashboard"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{onClick:()=>u("excel"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(Og,{className:"h-4 w-4 mr-2"}),"Export to Excel"]}),o.jsxs("button",{onClick:()=>u("pdf"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700",children:[o.jsx(Og,{className:"h-4 w-4 mr-2"}),"Export to PDF"]})]})]}),o.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"flex items-center justify-between mb-6",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>c("prev"),className:"p-2 hover:bg-gray-100 rounded-full",children:o.jsx(Pm,{className:"h-5 w-5 text-gray-600"})}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ol,{className:"h-5 w-5 text-gray-600"}),o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[Lt(Ds(t,{weekStartsOn:1}),"MMM d, yyyy")," - "," ",Lt(So(t,{weekStartsOn:1}),"MMM d, yyyy")]})]}),o.jsx("button",{onClick:()=>c("next"),className:"p-2 hover:bg-gray-100 rounded-full",children:o.jsx(Lm,{className:"h-5 w-5 text-gray-600"})})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[o.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Tasks"}),o.jsx("p",{className:"mt-2 text-3xl font-bold text-blue-900",children:d.tasks})]}),o.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[o.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Amount"}),o.jsxs("p",{className:"mt-2 text-3xl font-bold text-green-900",children:[l," ",d.amount.toFixed(2)]})]}),o.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[o.jsx("p",{className:"text-sm font-medium text-red-600",children:"Total Deductions"}),o.jsxs("p",{className:"mt-2 text-3xl font-bold text-red-900",children:[l," ",d.deductions.toFixed(2)]})]}),o.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[o.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Net Amount"}),o.jsxs("p",{className:"mt-2 text-3xl font-bold text-purple-900",children:[l," ",d.net.toFixed(2)]})]})]}),i?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.length===0?o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-500",children:"No financial data available for this week."})}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tasks"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deductions"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Amount"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(p=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Lt(new Date(p.date),"MMM d, yyyy")}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.totalTasks}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[l," ",p.totalAmount.toFixed(2)]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:[l," ",p.totalDeductions.toFixed(2)]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:[l," ",p.netAmount.toFixed(2)]})]},p.date))})]})})]})})]})}function dR(){var b;const[e,t]=he.useState([]),[r,n]=he.useState(!0),[s,i]=he.useState(!1),[a,l]=he.useState(null),[c,u]=he.useState({name:"",cost:0}),{organization:d}=qt(),{confirm:m,addToast:p}=en(),h=((b=Ar[d.currency])==null?void 0:b.symbol)||d.currency;he.useEffect(()=>{d&&y()},[d]);const y=async()=>{try{const{data:_,error:E}=await We.from("services").select("*").eq("organization_id",d.id).order("name");if(E)throw E;t(_||[])}catch(_){console.error("Error loading services:",_),p({type:"error",title:"Error",message:"Failed to load services"})}finally{n(!1)}},g=async()=>{if(!(!d||!c.name.trim()||!c.cost))try{const{data:_,error:E}=await We.from("services").insert([{organization_id:d.id,name:c.name.trim(),cost:c.cost}]).select().single();if(E)throw E;t(D=>[...D,_]),u({name:"",cost:0}),i(!1),p({type:"success",title:"Service Added",message:"The service has been added successfully."})}catch(_){console.error("Error adding service:",_),p({type:"error",title:"Error",message:"Failed to add service. Please try again."})}},w=async _=>{const E=e.find(D=>D.id===_);if(E)try{const{error:D}=await We.from("services").update({name:E.name,cost:E.cost}).eq("id",_);if(D)throw D;l(null),p({type:"success",title:"Service Updated",message:"The service has been updated successfully."})}catch(D){console.error("Error updating service:",D),p({type:"error",title:"Error",message:"Failed to update service. Please try again."})}},v=async _=>{if(await m({title:"Delete Service",message:"Are you sure you want to delete this service? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:D}=await We.from("services").delete().eq("id",_);if(D)throw D;t(I=>I.filter(A=>A.id!==_)),p({type:"success",title:"Service Deleted",message:"The service has been deleted successfully."})}catch(D){console.error("Error deleting service:",D),p({type:"error",title:"Error",message:"Failed to delete service. Please try again."})}};return r?o.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Services"}),o.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Service"]})]}),s&&o.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Service"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Name *"}),o.jsx("input",{type:"text",value:c.name,onChange:_=>u(E=>({...E,name:_.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter service name"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Cost (",h,") *"]}),o.jsx("input",{type:"number",value:c.cost||"",onChange:_=>u(E=>({...E,cost:parseFloat(_.target.value)||0})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01",placeholder:"Enter service cost"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[o.jsx("button",{onClick:()=>i(!1),className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),o.jsxs("button",{onClick:g,disabled:!c.name.trim()||!c.cost,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Service"]})]})]})]}),o.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.length===0?o.jsx("div",{className:"text-center text-gray-500 py-8",children:"No services added yet. Start by adding a new service."}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Service Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(_=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===_.id?o.jsx("input",{type:"text",value:_.name,onChange:E=>t(D=>D.map(I=>I.id===_.id?{...I,name:E.target.value}:I)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):_.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===_.id?o.jsx("input",{type:"number",value:_.cost,onChange:E=>t(D=>D.map(I=>I.id===_.id?{...I,cost:parseFloat(E.target.value)||0}:I)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01"}):`${h} ${_.cost.toFixed(2)}`}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a===_.id?o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>w(_.id),className:"text-green-600 hover:text-green-900",children:"Save"}),o.jsx("button",{onClick:()=>{l(null),y()},className:"text-gray-600 hover:text-gray-900",children:"Cancel"})]}):o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>l(_.id),className:"text-blue-600 hover:text-blue-900",children:o.jsx(Fm,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>v(_.id),className:"text-red-600 hover:text-red-900",children:o.jsx(Pi,{className:"h-4 w-4"})})]})})]},_.id))})]})})]})}function fR({onClose:e,onSuccess:t}){const{organization:r}=qt(),{addToast:n}=en(),[s,i]=he.useState(!1),[a,l]=he.useState(!1),[c,u]=he.useState(""),[d,m]=he.useState([]),[p,h]=he.useState({name:"",category:"",description:"",unit_price:"",stock_quantity:"",reorder_point:""});he.useEffect(()=>{r&&y()},[r]);const y=async()=>{if(r!=null&&r.id)try{const{data:w,error:v}=await We.from("categories").select("name").order("name");if(v)throw v;m((w==null?void 0:w.map(b=>b.name))||[])}catch(w){console.error("Error loading categories:",w)}},g=async w=>{if(w.preventDefault(),!r)return;const v=parseFloat(p.unit_price),b=parseInt(p.stock_quantity),_=parseInt(p.reorder_point);if(isNaN(v)||v<0){n({type:"error",title:"Invalid Price",message:"Please enter a valid unit price"});return}if(isNaN(b)||b<0){n({type:"error",title:"Invalid Quantity",message:"Please enter a valid stock quantity"});return}if(isNaN(_)||_<0){n({type:"error",title:"Invalid Reorder Point",message:"Please enter a valid reorder point"});return}if(!p.category){n({type:"error",title:"Invalid Category",message:"Please select or enter a category"});return}i(!0);try{const{error:E}=await We.from("products").insert([{organization_id:r.id,name:p.name.trim(),category:p.category.trim(),description:p.description.trim()||null,unit_price:v,stock_quantity:b,reorder_point:_}]);if(E)throw E;n({type:"success",title:"Product Created",message:"Product has been created successfully"}),t(),e()}catch(E){console.error("Error creating product:",E),n({type:"error",title:"Error",message:"Failed to create product"})}finally{i(!1)}};return o.jsxs("form",{onSubmit:g,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Product"}),o.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-500",children:o.jsx(ti,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),o.jsx("input",{type:"text",required:!0,value:p.name,onChange:w=>h(v=>({...v,name:w.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category *"}),o.jsxs("select",{required:!0,value:p.category,onChange:w=>h(v=>({...v,category:w.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"Select a category"}),d.map(w=>o.jsx("option",{value:w,children:w},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),o.jsx("textarea",{value:p.description,onChange:w=>h(v=>({...v,description:w.target.value})),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Price *"}),o.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:p.unit_price,onChange:w=>h(v=>({...v,unit_price:w.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity *"}),o.jsx("input",{type:"number",required:!0,min:"0",step:"1",value:p.stock_quantity,onChange:w=>h(v=>({...v,stock_quantity:w.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reorder Point *"}),o.jsx("input",{type:"number",required:!0,min:"0",step:"1",value:p.reorder_point,onChange:w=>h(v=>({...v,reorder_point:w.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:s,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:s?o.jsxs(o.Fragment,{children:[o.jsx(To,{className:"animate-spin h-4 w-4 mr-2"}),"Creating..."]}):"Create Product"})]})]})}function hR({onClose:e,onSuccess:t}){const[r,n]=he.useState(""),{addToast:s}=en(),i=async a=>{a.preventDefault();try{const{error:l}=await We.from("categories").insert([{name:r}]);if(l)throw l;s({type:"success",title:"Category Created",message:"The category has been created successfully."}),t(),e()}catch(l){console.error("Error creating category:",l),s({type:"error",title:"Error",message:"Failed to create category"})}};return o.jsxs("form",{onSubmit:i,className:"p-6",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Create New Category"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category Name"}),o.jsx("input",{type:"text",value:r,onChange:a=>n(a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",required:!0})]}),o.jsxs("div",{className:"flex justify-end",children:[o.jsx("button",{type:"button",onClick:e,className:"mr-2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),o.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create"})]})]})}function mR(){var M;const[e,t]=he.useState([]),[r,n]=he.useState(!0),[s,i]=he.useState(""),[a,l]=he.useState("all"),[c,u]=he.useState(!1),[d,m]=he.useState(!1),[p,h]=he.useState(""),[y,g]=he.useState(!1),{organization:w}=qt(),{confirm:v,addToast:b}=en(),_=w!=null&&w.currency?((M=Ar[w.currency])==null?void 0:M.symbol)||w.currency:"",E=he.useMemo(()=>{const j=new Set;return e.forEach(T=>j.add(T.category)),Array.from(j).sort()},[e]),D=he.useMemo(()=>p?E.filter(j=>j.toLowerCase().includes(p.toLowerCase())):E,[E,p]);he.useEffect(()=>{w&&I()},[w]);const I=async()=>{if(w!=null&&w.id)try{const{data:j,error:T}=await We.from("products").select("*").eq("organization_id",w.id).order("name");if(T)throw T;t(j||[])}catch(j){console.error("Error loading products:",j),b({type:"error",title:"Error",message:"Failed to load products"})}finally{n(!1)}},A=async j=>{if(await v({title:"Delete Product",message:"Are you sure you want to delete this product? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:q}=await We.from("products").delete().eq("id",j);if(q)throw q;t(U=>U.filter(re=>re.id!==j)),b({type:"success",title:"Product Deleted",message:"Product has been deleted successfully."})}catch(q){console.error("Error deleting product:",q),b({type:"error",title:"Error",message:"Failed to delete product"})}},P=e.filter(j=>{var T;return(a==="all"||j.category===a)&&(j.name.toLowerCase().includes(s.toLowerCase())||((T=j.description)==null?void 0:T.toLowerCase().includes(s.toLowerCase())))}),C=async()=>{try{const{data:j,error:T}=await We.from("categories").select("*").order("name");if(T)throw T}catch(j){console.error("Error loading categories:",j),b({type:"error",title:"Error",message:"Failed to load categories"})}};return he.useEffect(()=>{C()},[]),r?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Products"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your inventory"})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Product"]}),o.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 transition-colors duration-200",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Category"]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx("input",{type:"text",value:s,onChange:j=>i(j.target.value),placeholder:"Search products...",className:"block w-full rounded-lg border border-gray-300 py-2 pl-10 pr-3 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"}),o.jsx(jf,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{type:"button",onClick:()=>m(!d),className:"inline-flex items-center justify-between w-full sm:w-48 rounded-lg border border-gray-300 py-2 pl-3 pr-3 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[o.jsx("span",{className:"truncate",children:a==="all"?"All Categories":a}),o.jsx(AA,{className:"h-4 w-4 text-gray-400"})]}),d&&o.jsxs("div",{className:"absolute z-10 mt-1 w-full sm:w-48 rounded-md bg-white shadow-lg",children:[o.jsx("div",{className:"p-2",children:o.jsx("input",{type:"text",value:p,onChange:j=>h(j.target.value),placeholder:"Search categories...",className:"block w-full rounded-md border border-gray-300 py-1.5 px-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"})}),o.jsxs("div",{className:"max-h-60 overflow-auto",children:[o.jsx("div",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",onClick:()=>{l("all"),m(!1),h("")},children:"All Categories"}),D.map(j=>o.jsx("div",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",onClick:()=>{l(j),m(!1),h("")},children:j},j))]})]})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:P.length===0?o.jsx("div",{className:"p-6 text-center text-gray-500",children:"No products found."}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:"Actions"})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(j=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center",children:o.jsx(Qi,{className:"h-6 w-6 text-gray-400"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.name}),j.description&&o.jsx("div",{className:"text-sm text-gray-500",children:j.description})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:j.category})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[_," ",j.unit_price.toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:`text-sm font-medium ${j.stock_quantity<=j.reorder_point?"text-red-600":"text-gray-900"}`,children:j.stock_quantity}),j.stock_quantity<=j.reorder_point&&o.jsx("span",{className:"text-xs text-red-500 ml-2",children:"Low stock"})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>{},className:"text-blue-600 hover:text-blue-900",children:o.jsx(Fm,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>A(j.id),className:"text-red-600 hover:text-red-900",children:o.jsx(Pi,{className:"h-4 w-4"})})]})})]},j.id))})]})}),c&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),o.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:o.jsx(fR,{onClose:()=>u(!1),onSuccess:I})})]})}),y&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>g(!1)}),o.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:o.jsx(hR,{onClose:()=>g(!1),onSuccess:C})})]})})]})}const Jg={unpaid:"Unpaid",partially_paid:"Partially Paid",paid:"Paid"},Mc={unpaid:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"},partially_paid:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},paid:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"}};function pR({onClose:e,onSuccess:t}){var ye;const[r,n]=he.useState(!1),[s,i]=he.useState([]),[a,l]=he.useState([]),[c,u]=he.useState(""),[d,m]=he.useState([]),[p,h]=he.useState({name:"",quantity:1,unit_price:0}),[y,g]=he.useState(""),{organization:w}=qt(),{addToast:v}=en(),b=w!=null&&w.currency?((ye=Ar[w.currency])==null?void 0:ye.symbol)||w.currency:"",[_,E]=he.useState(!0),[D,I]=he.useState(!0),[A,P]=he.useState(!1),[C,M]=he.useState(""),[j,T]=he.useState(""),[q,U]=he.useState(""),[re,z]=he.useState(!1),[G,B]=he.useState({name:"",phone:"",address:"",email:""}),[Y,se]=he.useState(!1);he.useEffect(()=>{w&&(me(),S())},[w]);const me=async()=>{if(w!=null&&w.id)try{const{data:pe,error:_e}=await We.from("clients").select("*").eq("organization_id",w.id).order("name");if(_e)throw _e;i(pe||[])}catch(pe){console.error("Error loading clients:",pe),v({type:"error",title:"Error",message:"Failed to load clients"})}finally{E(!1)}},S=async()=>{if(w!=null&&w.id)try{const{data:pe,error:_e}=await We.from("products").select("*").eq("organization_id",w.id).order("name");if(_e)throw _e;l(pe||[])}catch(pe){console.error("Error loading products:",pe),v({type:"error",title:"Error",message:"Failed to load products"})}finally{I(!1)}},L=pe=>{const _e=a.find(Ve=>Ve.id===pe);if(!_e)return;if(_e.stock_quantity<=0){v({type:"error",title:"Error",message:"This product is out of stock"});return}const Ue=d.find(Ve=>Ve.product_id===pe);if(Ue){if(Ue.quantity>=_e.stock_quantity){v({type:"error",title:"Error",message:"Not enough stock available"});return}m(Ve=>Ve.map(Se=>Se.product_id===pe?{...Se,quantity:Se.quantity+1,total_price:(Se.quantity+1)*Se.unit_price}:Se))}else m(Ve=>[...Ve,{product_id:_e.id,name:_e.name,quantity:1,unit_price:_e.unit_price,total_price:_e.unit_price,is_custom_item:!1,product:_e}])},R=()=>{!p.name.trim()||p.quantity<=0||p.unit_price<=0||(m(pe=>[...pe,{product_id:null,name:p.name.trim(),quantity:p.quantity,unit_price:p.unit_price,total_price:p.quantity*p.unit_price,is_custom_item:!0}]),h({name:"",quantity:1,unit_price:0}))},O=pe=>{m(_e=>_e.filter((Ue,Ve)=>Ve!==pe))},V=(pe,_e)=>{const Ue=d[pe];if(Ue){if(!Ue.is_custom_item&&Ue.product&&_e>Ue.product.stock_quantity){v({type:"error",title:"Error",message:"Not enough stock available"});return}if(_e<=0){O(pe);return}m(Ve=>Ve.map((Se,le)=>le===pe?{...Se,quantity:_e,total_price:_e*Se.unit_price}:Se))}},ne=()=>d.reduce((pe,_e)=>pe+_e.total_price,0),ue=async pe=>{if(pe.preventDefault(),!(!w||!c||d.length===0)){n(!0);try{const{data:_e,error:Ue}=await We.from("sales_orders").insert([{organization_id:w.id,client_id:c,total_amount:ne(),outstanding_balance:ne(),notes:y.trim()||null}]).select().single();if(Ue)throw Ue;const{error:Ve}=await We.from("sales_order_items").insert(d.map(Se=>({sales_order_id:_e.id,product_id:Se.product_id,name:Se.name,quantity:Se.quantity,unit_price:Se.unit_price,total_price:Se.total_price,is_custom_item:Se.is_custom_item})));if(Ve)throw Ve;for(const Se of d)if(!Se.is_custom_item&&Se.product_id&&Se.product){const{error:le}=await We.from("products").update({stock_quantity:Se.product.stock_quantity-Se.quantity}).eq("id",Se.product_id);if(le)throw le}if(A&&C&&j){const Se=parseFloat(C);if(isNaN(Se)||Se<=0)throw new Error("Invalid payment amount");if(Se>ne())throw new Error("Payment amount cannot exceed total amount");const{data:{user:le},error:Me}=await We.auth.getUser();if(Me)throw Me;if(!le)throw new Error("User not authenticated");const{error:rt}=await We.rpc("record_payment",{p_organization_id:w.id,p_order_id:_e.id,p_amount:Se,p_payment_method:j,p_payment_reference:q||null,p_recorded_by:le.id});if(rt)throw rt}v({type:"success",title:"Order Created",message:"Sales order has been created successfully."}),t(),e()}catch(_e){console.error("Error creating order:",_e),v({type:"error",title:"Error",message:_e instanceof Error?_e.message:"Failed to create order"})}finally{n(!1)}}},fe=async()=>{if(!(!(w!=null&&w.id)||!G.name.trim())){se(!0);try{const{data:pe,error:_e}=await We.from("clients").insert([{organization_id:w.id,name:G.name.trim(),phone:G.phone.trim(),address:G.address.trim(),email:G.email.trim()}]).select().single();if(_e)throw _e;i(Ue=>[...Ue,pe]),u(pe.id),z(!1),B({name:"",phone:"",address:"",email:""}),v({type:"success",title:"Client Created",message:"New client has been created successfully."})}catch(pe){console.error("Error creating client:",pe),v({type:"error",title:"Error",message:"Failed to create client"})}finally{se(!1)}}};return _||D?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.jsxs("form",{onSubmit:ue,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Sales Order"}),o.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-500",children:o.jsx(ti,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client *"}),o.jsxs("button",{type:"button",onClick:()=>z(!0),className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-900",children:[o.jsx(Jr,{className:"h-4 w-4 mr-1"}),"New Client"]})]}),o.jsxs("select",{required:!0,value:c,onChange:pe=>u(pe.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"Select a client"}),s.map(pe=>o.jsx("option",{value:pe.id,children:pe.name},pe.id))]})]}),re&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create New Client"}),o.jsx("button",{type:"button",onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-500",children:o.jsx(ti,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),o.jsx("input",{type:"text",value:G.name,onChange:pe=>B(_e=>({..._e,name:pe.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter client name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),o.jsx("input",{type:"email",value:G.email,onChange:pe=>B(_e=>({..._e,email:pe.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter email address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),o.jsx("input",{type:"tel",value:G.phone,onChange:pe=>B(_e=>({..._e,phone:pe.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter phone number"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),o.jsx("textarea",{value:G.address,onChange:pe=>B(_e=>({..._e,address:pe.target.value})),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter address"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>z(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),o.jsx("button",{type:"button",onClick:fe,disabled:!G.name.trim()||Y,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:Y?o.jsxs(o.Fragment,{children:[o.jsx(To,{className:"animate-spin h-4 w-4 mr-2"}),"Creating..."]}):"Create Client"})]})]})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Products"}),o.jsxs("select",{value:"",onChange:pe=>L(pe.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"Select a product"}),a.map(pe=>o.jsxs("option",{value:pe.id,disabled:pe.stock_quantity<=0,children:[pe.name," - ",b,pe.unit_price.toFixed(2)," (",pe.stock_quantity," in stock)"]},pe.id))]})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Custom Item Name"}),o.jsx("input",{type:"text",value:p.name,onChange:pe=>h(_e=>({..._e,name:pe.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter item name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),o.jsx("input",{type:"number",min:"1",value:p.quantity,onChange:pe=>h(_e=>({..._e,quantity:parseInt(pe.target.value)||1})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Price"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:p.unit_price,onChange:pe=>h(_e=>({..._e,unit_price:parseFloat(pe.target.value)||0})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"0.00"})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsxs("button",{type:"button",onClick:R,disabled:!p.name.trim()||p.quantity<=0||p.unit_price<=0,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Add Custom Item"]})})]}),o.jsx("div",{className:"border rounded-lg overflow-hidden",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[d.map((pe,_e)=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Qi,{className:"h-5 w-5 text-gray-400 mr-2"}),o.jsx("div",{className:"text-sm text-gray-900",children:pe.name})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>V(_e,pe.quantity-1),className:"p-1 rounded-full hover:bg-gray-100",children:o.jsx(a_,{className:"h-4 w-4 text-gray-500"})}),o.jsx("span",{className:"text-sm text-gray-900",children:pe.quantity}),o.jsx("button",{type:"button",onClick:()=>V(_e,pe.quantity+1),className:"p-1 rounded-full hover:bg-gray-100",disabled:!pe.is_custom_item&&pe.product&&pe.quantity>=pe.product.stock_quantity,children:o.jsx(Jr,{className:"h-4 w-4 text-gray-500"})})]})}),o.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[b," ",pe.unit_price.toFixed(2)]}),o.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[b," ",pe.total_price.toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 text-right",children:o.jsx("button",{type:"button",onClick:()=>O(_e),className:"text-red-600 hover:text-red-900",children:o.jsx(ti,{className:"h-4 w-4"})})})]},_e)),d.length>0&&o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("td",{colSpan:3,className:"px-6 py-4 text-sm font-medium text-gray-900 text-right",children:"Total Amount:"}),o.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:[b," ",ne().toFixed(2)]}),o.jsx("td",{})]})]})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),o.jsx("textarea",{value:y,onChange:pe=>g(pe.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Add any notes about this order"})]}),d.length>0&&o.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h4",{className:"text-sm font-medium text-gray-900 flex items-center",children:[o.jsx(W0,{className:"h-4 w-4 mr-2 text-gray-500"}),"Initial Payment"]}),o.jsx("button",{type:"button",onClick:()=>P(!A),className:"text-sm text-blue-600 hover:text-blue-900",children:A?"Cancel Payment":"Add Payment"})]}),A&&o.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Amount *"}),o.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("span",{className:"text-gray-500 sm:text-sm",children:b})}),o.jsx("input",{type:"number",step:"0.01",min:"0.01",max:ne(),value:C,onChange:pe=>M(pe.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"0.00",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method *"}),o.jsxs("select",{value:j,onChange:pe=>T(pe.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",required:!0,children:[o.jsx("option",{value:"",children:"Select a payment method"}),o.jsx("option",{value:"mobile_money",children:"Mobile Money"}),o.jsx("option",{value:"cash",children:"Cash"}),o.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),o.jsx("option",{value:"credit_card",children:"Credit Card"}),o.jsx("option",{value:"check",children:"Check"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Reference"}),o.jsx("input",{type:"text",value:q,onChange:pe=>U(pe.target.value),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"e.g., Check number, Transaction ID"})]})]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:r||!c||d.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:r?o.jsxs(o.Fragment,{children:[o.jsx(To,{className:"animate-spin h-4 w-4 mr-2"}),"Creating..."]}):"Create Sale"})]})]})}function gR(){var U,re;const[e,t]=he.useState([]),[r,n]=he.useState(!0),[s,i]=he.useState(""),[a,l]=he.useState("all"),[c,u]=he.useState(!1),[d,m]=he.useState(null),[p,h]=he.useState(!1),[y,g]=he.useState(""),[w,v]=he.useState(""),[b,_]=he.useState(""),[E,D]=he.useState(!1),{organization:I}=qt(),{confirm:A,addToast:P}=en(),C=I!=null&&I.currency?((U=Ar[I.currency])==null?void 0:U.symbol)||I.currency:"";he.useEffect(()=>{I&&M()},[I]);const M=async()=>{if(I!=null&&I.id)try{const{data:z,error:G}=await We.from("sales_orders").select(`
          *,
          client:clients(name),
          items:sales_order_items(
            id,
            product_id,
            name,
            quantity,
            unit_price,
            total_price,
            is_custom_item,
            product:products(*)
          ),
          payments:payments(
            id,
            amount,
            payment_method,
            transaction_reference,
            created_at,
            recorded_by
          )
        `).eq("organization_id",I.id).order("created_at",{ascending:!1});if(G)throw G;t(z||[])}catch(z){console.error("Error loading orders:",z),P({type:"error",title:"Error",message:"Failed to load orders"})}finally{n(!1)}},j=async z=>{if(await A({title:"Delete Order",message:"Are you sure you want to delete this order? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:B}=await We.from("sales_orders").delete().eq("id",z);if(B)throw B;t(Y=>Y.filter(se=>se.id!==z)),P({type:"success",title:"Order Deleted",message:"Order has been deleted successfully."})}catch(B){console.error("Error deleting order:",B),P({type:"error",title:"Error",message:"Failed to delete order"})}},T=async z=>{if(z.preventDefault(),!y||!w){P({type:"error",title:"Error",message:"Please fill in all required fields"});return}const G=parseFloat(y);if(isNaN(G)||G<=0){P({type:"error",title:"Error",message:"Please enter a valid payment amount"});return}if(!d||G>d.outstanding_balance){P({type:"error",title:"Error",message:"Payment amount cannot exceed outstanding balance"});return}D(!0);try{const{data:{user:B},error:Y}=await We.auth.getUser();if(Y)throw Y;if(!B)throw new Error("User not authenticated");console.log({p_organization_id:I==null?void 0:I.id,p_order_id:d.id,p_amount:G,p_payment_method:w,p_payment_reference:b||null,p_recorded_by:B.id});const{error:se}=await We.rpc("record_payment",{p_organization_id:I==null?void 0:I.id,p_order_id:d.id,p_amount:G,p_payment_method:w,p_payment_reference:b||null,p_recorded_by:B.id});if(se)throw se;P({type:"success",title:"Success",message:"Payment recorded successfully"}),g(""),v(""),_(""),h(!1),m(null),M()}catch(B){P({type:"error",title:"Error",message:B.message||"Failed to record payment"})}finally{D(!1)}},q=e.filter(z=>{var G,B;return(a==="all"||z.payment_status===a)&&(((G=z.order_number)==null?void 0:G.toLowerCase().includes(s.toLowerCase()))||((B=z.client)==null?void 0:B.name.toLowerCase().includes(s.toLowerCase())))});return r?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Sales Orders"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your sales orders and payments"})]}),o.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[o.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Create Sale"]})]}),c&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),o.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl",children:o.jsx(pR,{onClose:()=>u(!1),onSuccess:M})})]})}),p&&d&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>{h(!1),m(null)}}),o.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:o.jsxs("div",{className:"bg-white",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx(W0,{className:"h-5 w-5 mr-2 text-gray-500"}),"Record Payment"]}),o.jsxs("button",{onClick:()=>{h(!1),m(null)},className:"text-gray-400 hover:text-gray-500",children:[o.jsx("span",{className:"sr-only",children:"Close"}),o.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]})]}),o.jsxs("div",{className:"px-6 py-5",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Order Number"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:d.order_number})]}),o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Client"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:(re=d.client)==null?void 0:re.name})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Outstanding Balance"}),o.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[C," ",d.outstanding_balance.toFixed(2)]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount*"}),o.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),o.jsx("input",{type:"number",step:"0.01",min:"0.01",max:d.outstanding_balance,value:y,onChange:z=>g(z.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"0.00",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method*"}),o.jsxs("select",{value:w,onChange:z=>v(z.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",required:!0,children:[o.jsx("option",{value:"",children:"Select a payment method"}),o.jsx("option",{value:"mobile_money",children:"Mobile Money"}),o.jsx("option",{value:"cash",children:"Cash"}),o.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),o.jsx("option",{value:"credit_card",children:"Credit Card"}),o.jsx("option",{value:"check",children:"Check"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Reference"}),o.jsx("input",{type:"text",value:b,onChange:z=>_(z.target.value),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"e.g., Check number, Transaction ID"})]}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>{h(!1),m(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),o.jsx("button",{type:"button",onClick:T,disabled:E,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300",children:E?"Recording Payment...":"Record Payment"})]})]})]})]})})]})}),o.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b space-y-4",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx("button",{onClick:()=>l("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50"}`,children:"All Orders"}),Object.entries(Jg).map(([z,G])=>o.jsx("button",{onClick:()=>l(z),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a===z?`${Mc[z].bg} ${Mc[z].text}`:"text-gray-500 hover:bg-gray-50"}`,children:G},z))]}),o.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[o.jsx(jf,{className:"h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:s,onChange:z=>i(z.target.value),placeholder:"Search orders...",className:"ml-2 flex-1 outline-none bg-transparent"})]})]}),o.jsx("div",{className:"overflow-x-auto",children:q.length===0?o.jsx("div",{className:"text-center text-gray-500 py-8",children:s||a!=="all"?"No orders found matching your search.":"No orders created yet. Start by creating a new order."}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Number"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map(z=>{var G,B;return o.jsxs("tr",{children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx(gr,{to:`/dashboard/sales/${z.id}`,className:"text-sm font-medium text-blue-600 hover:text-blue-900",children:z.order_number}),o.jsx("div",{className:"text-xs text-gray-500",children:Lt(new Date(z.created_at),"MMM d, yyyy")})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(No,{className:"h-5 w-5 text-gray-400 mr-2"}),o.jsx("div",{className:"text-sm font-medium text-gray-900",children:(G=z.client)==null?void 0:G.name})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"flex flex-col space-y-1",children:(B=z.items)==null?void 0:B.map(Y=>o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(Qi,{className:"h-4 w-4 text-gray-400 mr-2"}),o.jsx("span",{className:"text-gray-900",children:Y.name}),o.jsxs("span",{className:"text-gray-500 ml-2",children:[" ",Y.quantity]})]},Y.id))})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[C," ",z.total_amount.toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("span",{className:`text-sm font-medium ${z.payment_status==="paid"?"text-green-600":z.payment_status==="partially_paid"?"text-orange-600":"text-red-600"}`,children:[C," ",z.outstanding_balance.toFixed(2)]}),o.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:z.payment_status==="partially_paid"?"Outstanding":"Paid"})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Mc[z.payment_status].bg} ${Mc[z.payment_status].text}`,children:Jg[z.payment_status]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsxs("div",{className:"flex justify-end space-x-2",children:[z.payment_status!=="paid"&&o.jsx("button",{onClick:()=>{m(z),h(!0)},className:"text-green-600 hover:text-green-900",children:o.jsx(W0,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>j(z.id),className:"text-red-600 hover:text-red-900",children:o.jsx(Pi,{className:"h-4 w-4"})})]})})]},z.id)})})]})})]})]})}function xR(){var d;const{id:e}=_m(),[t,r]=he.useState(null),[n,s]=he.useState(!0),{organization:i}=qt(),{addToast:a}=en(),l=i!=null&&i.currency?((d=Ar[i.currency])==null?void 0:d.symbol)||i.currency:Ar.USD.symbol;he.useEffect(()=>{e&&c()},[e]);const c=async()=>{try{const{data:m,error:p}=await We.from("sales_orders").select(`
          *,
          client:clients(name),
          items:sales_order_items(
            id,
            product_id,
            name,
            quantity,
            unit_price,
            total_price,
            is_custom_item,
            product:products(
              id,
              name,
              stock_quantity
            )
          ),
          payments:payments(
            id,
            amount,
            payment_method,
            transaction_reference,
            created_at,
            recorded_by
          )
        `).eq("id",e).single();if(p)throw p;r(m)}catch(m){console.error("Error loading order:",m),a({type:"error",title:"Error",message:"Failed to load order details"})}finally{s(!1)}},u=async m=>{if(window.confirm("Are you sure you want to delete this order? This action cannot be undone."))try{const{error:h}=await We.from("sales_orders").delete().eq("id",m);if(h)throw h;a({type:"success",title:"Order Deleted",message:"The order has been deleted successfully."}),window.location.href="/dashboard/sales"}catch(h){console.error("Error deleting order:",h),a({type:"error",title:"Error",message:"Failed to delete order. Please try again."})}};return n?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t?o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(gr,{to:"/dashboard/sales",className:"text-gray-500 hover:text-gray-700",children:o.jsx(jl,{className:"h-5 w-5"})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Order ",t.order_number]}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created on ",Lt(new Date(t.created_at),"MMM d, yyyy HH:mm")]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Items"})}),o.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[o.jsx("div",{className:"space-y-4",children:t.items.map(m=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Qi,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:m.name}),o.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",m.quantity,"  ",l," ",m.unit_price.toFixed(2)]})]})]}),o.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[l," ",m.total_price.toFixed(2)]})]},m.id))}),o.jsx("div",{className:"mt-6 pt-6 border-t",children:o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"font-medium text-gray-900",children:"Total Amount"}),o.jsxs("span",{className:"font-bold text-gray-900",children:[l," ",t.total_amount.toFixed(2)]})]})})]})]}),t.notes&&o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Notes"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("p",{className:"text-sm text-gray-500",children:t.notes})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx(Aa,{className:"h-5 w-5 mr-2 text-gray-500"}),"Payment Details"]}),t.payment_status!=="paid"&&o.jsx(g_,{orderId:t.id,outstandingBalance:t.outstanding_balance,onPaymentRecorded:c})]})}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[o.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Amount"}),o.jsxs("p",{className:"text-xl font-bold text-blue-900",children:[l," ",t.total_amount.toFixed(2)]})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[o.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Amount Paid"}),o.jsxs("p",{className:"text-xl font-bold text-green-900",children:[l," ",(t.total_amount-t.outstanding_balance).toFixed(2)]})]}),o.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[o.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Outstanding Balance"}),o.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[l," ",t.outstanding_balance.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-200",children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Payment Status"}),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                    ${Mc[t.payment_status].bg}
                    ${Mc[t.payment_status].text}`,children:Jg[t.payment_status]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Payment History"}),t.payments&&t.payments.length>0?o.jsx("div",{className:"border rounded-lg divide-y",children:t.payments.map(m=>o.jsxs("div",{className:"p-4 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[l," ",m.amount.toFixed(2)]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[m.payment_method,"  ",m.transaction_reference]})]}),o.jsx("div",{className:"text-right",children:o.jsx("p",{className:"text-xs text-gray-500",children:Lt(new Date(m.created_at),"MMM d, yyyy h:mm a")})})]},m.id))}):o.jsx("p",{className:"text-sm text-gray-500 italic",children:"No payments recorded yet"})]})]})})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Client"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(No,{className:"h-5 w-5 text-gray-400"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.client.name})]})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Danger Zone"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("button",{onClick:()=>u(t.id),className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Order"})})]})]})]})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("p",{className:"text-gray-500",children:"Order not found."}),o.jsxs(gr,{to:"/dashboard/sales",className:"mt-4 inline-flex items-center text-blue-600 hover:text-blue-800",children:[o.jsx(jl,{className:"h-4 w-4 mr-2"}),"Back to Sales Orders"]})]})}function vR(){const{user:e,organization:t}=qt(),r=hu(),n=fu();if(!(t&&t.country&&t.city&&t.address&&t.employee_count&&t.currency))return o.jsx(ml,{to:"/organization-setup"});if(!e||!t)return null;const i=async()=>{try{await qt.getState().signOut(),r("/signin")}catch(l){console.error("Error signing out:",l)}},a=[{name:"Overview",path:"/dashboard",icon:Ao},{name:"Workers",path:"/dashboard/workers",icon:iu},{name:"Clients",path:"/dashboard/clients",icon:o_},{name:"Orders",path:"/dashboard/orders",icon:s2},{name:"Tasks",path:"/dashboard/tasks",icon:Ic},{name:"Inventory",path:"/dashboard/inventory",icon:Qi},{name:"Sales",path:"/dashboard/sales",icon:Aa},{name:"Settings",path:"/dashboard/settings",icon:UA}];return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("header",{className:"bg-white shadow-sm",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex items-center justify-between h-16",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ao,{className:"h-8 w-8 text-blue-600"}),o.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:t.name})]}),o.jsxs("button",{onClick:i,className:"ml-4 inline-flex items-center px-3 py-1.5 text-sm text-gray-700 hover:text-gray-900",children:[o.jsx(RA,{className:"h-4 w-4 mr-1"}),"Sign out"]})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:o.jsx("nav",{className:"flex items-center justify-center space-x-1 bg-white shadow-sm rounded-lg p-1",children:a.map(l=>{const c=n.pathname===l.path;return o.jsxs(gr,{to:l.path,className:`px-4 py-2 text-sm font-medium rounded-md flex items-center ${c?"text-blue-700 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:[o.jsx(l.icon,{className:`h-5 w-5 mr-2 ${c?"text-blue-700":"text-gray-400"}`}),l.name]},l.name)})})}),o.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:o.jsxs(E4,{children:[o.jsx(yr,{index:!0,element:o.jsx(oR,{})}),o.jsx(yr,{path:"workers",element:o.jsx(uC,{})}),o.jsx(yr,{path:"workers/:id",element:o.jsx(aR,{})}),o.jsx(yr,{path:"clients",element:o.jsx(cR,{})}),o.jsx(yr,{path:"orders",element:o.jsx(cC,{})}),o.jsx(yr,{path:"orders/:id",element:o.jsx(oC,{})}),o.jsx(yr,{path:"tasks",element:o.jsx(ud,{status:void 0})}),o.jsx(yr,{path:"tasks/pending",element:o.jsx(ud,{status:"pending"})}),o.jsx(yr,{path:"tasks/in_progress",element:o.jsx(ud,{status:"in_progress"})}),o.jsx(yr,{path:"tasks/delayed",element:o.jsx(ud,{status:"delayed"})}),o.jsx(yr,{path:"tasks/completed",element:o.jsx(ud,{status:"completed"})}),o.jsx(yr,{path:"inventory",element:o.jsx(mR,{})}),o.jsx(yr,{path:"sales",element:o.jsx(gR,{})}),o.jsx(yr,{path:"sales/:id",element:o.jsx(xR,{})}),o.jsx(yr,{path:"finances",element:o.jsx(uR,{})}),o.jsx(yr,{path:"settings",element:o.jsx(lR,{})}),o.jsx(yr,{path:"settings/services",element:o.jsx(dR,{})})]})})]})}const yR=[{label:"0-15 employees",value:15},{label:"15-30 employees",value:30},{label:"30-50 employees",value:50},{label:"50-100 employees",value:100},{label:"100-200 employees",value:200},{label:"200+ employees",value:201}],wR=[{code:"GHS",name:"Ghanaian Cedi"},{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"NGN",name:"Nigerian Naira"}],bR=["Ghana","Nigeria","Kenya","South Africa","United States","United Kingdom","Canada"].sort();function _R(){const e=hu(),{organization:t}=qt(),[r,n]=he.useState(!1),[s,i]=he.useState({country:(t==null?void 0:t.country)||"",city:(t==null?void 0:t.city)||"",address:(t==null?void 0:t.address)||"",employee_count:(t==null?void 0:t.employee_count)||15,currency:(t==null?void 0:t.currency)||"GHS"}),a=async l=>{if(l.preventDefault(),!r){n(!0);try{const{error:c}=await We.from("organizations").update({country:s.country,city:s.city,address:s.address,employee_count:s.employee_count,currency:s.currency}).eq("id",t.id);if(c)throw c;qt.setState({organization:{...t,...s}}),e("/dashboard")}catch(c){console.error("Error updating organization:",c),alert("Failed to update organization. Please try again.")}finally{n(!1)}}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex flex-col justify-center py-12 px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"mx-auto h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:o.jsx(Ao,{className:"h-8 w-8 text-blue-600"})}),o.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Complete Your Organization Setup"}),o.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Please provide additional information about your organization"})]}),o.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:o.jsxs("form",{onSubmit:a,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),o.jsxs("select",{id:"country",value:s.country,onChange:l=>i(c=>({...c,country:l.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"Select a country"}),bR.map(l=>o.jsx("option",{value:l,children:l},l))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),o.jsx("input",{type:"text",id:"city",value:s.city,onChange:l=>i(c=>({...c,city:l.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),o.jsx("textarea",{id:"address",value:s.address,onChange:l=>i(c=>({...c,address:l.target.value})),required:!0,rows:3,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"employee_count",className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Employees"}),o.jsx("select",{id:"employee_count",value:s.employee_count,onChange:l=>i(c=>({...c,employee_count:parseInt(l.target.value)})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:yR.map(l=>o.jsx("option",{value:l.value,children:l.label},l.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Currency"}),o.jsx("select",{id:"currency",value:s.currency,onChange:l=>i(c=>({...c,currency:l.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:wR.map(l=>o.jsxs("option",{value:l.code,children:[l.code," - ",l.name]},l.code))})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:r?"Saving...":"Save Organization Details"})})]})})]})})}const NR=[{icon:BA,name:"Fashion & Tailoring",description:"Perfect for fashion houses, tailoring shops, and clothing manufacturers."},{icon:Qi,name:"Service-Based Businesses",description:"Ideal for businesses offering services like cleaning, repairs, or installations."},{icon:iu,name:"Contractors & Freelancers",description:"Great for managing contract workers, freelancers, and project-based teams."},{icon:s2,name:"Retail & Custom Orders",description:"Suitable for retail businesses handling custom orders and made-to-order products."}],SR=[{icon:iu,title:"Workforce Management",description:"Track workers, assign tasks, and manage project rates with WhatsApp integration."},{icon:o_,title:"Client Management",description:"Maintain client profiles with custom fields and track client-specific information."},{icon:Qi,title:"Service Catalog",description:"Define and price your services, create service packages, and track service delivery."},{icon:s2,title:"Order Management",description:"Process client orders, assign workers, and track order fulfillment end-to-end."},{icon:Ic,title:"Task & Project Tracking",description:"Monitor tasks, track progress, and manage project timelines efficiently."},{icon:PA,title:"Detailed Reports",description:"Export financial reports, worker performance, and order analytics in Excel/PDF."},{icon:Aa,title:"Financial Controls",description:"Track earnings, manage deductions, and monitor financial performance."},{icon:i_,title:"Communication",description:"Integrated WhatsApp messaging for seamless communication."},{icon:jA,title:"Business Analytics",description:"Get insights into your business performance, worker productivity, and client trends."},{icon:zA,title:"Secure & Reliable",description:"Enterprise-grade security with role-based access control and data protection."}],kR=[{title:"Save Time",description:"Streamline operations and reduce administrative overhead with automated workflows."},{title:"Grow Revenue",description:"Manage more clients, track orders efficiently, and increase business throughput."},{title:"Better Insights",description:"Make data-driven decisions with comprehensive business analytics and reporting."},{title:"Improve Client Satisfaction",description:"Deliver better service with organized client management and order tracking."}];function jR(){return o.jsxs("div",{className:"bg-white",children:[o.jsxs("div",{className:"relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-50 transform -skew-y-6 origin-top-left"}),o.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-24 sm:pb-32",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"flex justify-center mb-8",children:o.jsx("div",{className:"h-16 w-16 bg-blue-100 rounded-2xl flex items-center justify-center",children:o.jsx(Ao,{className:"h-10 w-10 text-blue-600"})})}),o.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-extrabold text-gray-900 tracking-tight leading-tight",children:["Sten360: ",o.jsx("span",{className:"text-blue-600",children:"Business Management"})," Platform"]}),o.jsx("p",{className:"mt-6 max-w-2xl mx-auto text-xl text-gray-500",children:"A Sten Business solution for managing your entire operation - from clients and orders to workers and finances - all in one integrated platform. Built for growing organizations that demand efficiency."}),o.jsxs("div",{className:"mt-10 flex justify-center gap-4",children:[o.jsxs(gr,{to:"/signup",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:["Get Started Free",o.jsx(l1,{className:"ml-2 h-5 w-5"})]}),o.jsx(gr,{to:"/signin",className:"inline-flex items-center px-6 py-3 border border-gray-300 text-base font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200",children:"Sign In"})]})]})})]}),o.jsx("div",{className:"py-24 bg-gradient-to-br from-gray-50 to-blue-50",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Industries We Serve"}),o.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Our platform is tailored for businesses that rely on skilled workers and custom orders"})]}),o.jsx("div",{className:"mt-20 grid grid-cols-1 gap-8 sm:grid-cols-2",children:NR.map((e,t)=>o.jsx("div",{className:"relative bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:"flex-shrink-0 rounded-lg inline-flex p-3 bg-blue-50 text-blue-600",children:o.jsx(e.icon,{className:"h-6 w-6","aria-hidden":"true"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),o.jsx("p",{className:"mt-2 text-base text-gray-500",children:e.description})]})]})},t))})]})}),o.jsx("div",{className:"py-24 bg-white",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Your All-in-One Business Solution"}),o.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Powerful features designed to help you manage and grow your business efficiently"})]}),o.jsx("div",{className:"mt-20 grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3",children:SR.map((e,t)=>o.jsxs("div",{className:"relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-blue-500 rounded-lg hover:shadow-lg transition-shadow duration-200",children:[o.jsx("div",{children:o.jsx("span",{className:"rounded-lg inline-flex p-3 bg-blue-50 text-blue-600 ring-4 ring-white",children:o.jsx(e.icon,{className:"h-6 w-6","aria-hidden":"true"})})}),o.jsxs("div",{className:"mt-8",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.title}),o.jsx("p",{className:"mt-2 text-base text-gray-500",children:e.description})]})]},t))})]})}),o.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 py-24",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Transform Your Business Operations"}),o.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Streamline operations, boost efficiency, and accelerate growth with our integrated platform"})]}),o.jsx("div",{className:"mt-20",children:o.jsx("dl",{className:"space-y-10 md:space-y-0 md:grid md:grid-cols-2 md:gap-x-8 md:gap-y-12",children:kR.map((e,t)=>o.jsxs("div",{className:"relative",children:[o.jsxs("dt",{children:[o.jsx("div",{className:"absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white",children:o.jsx(Si,{className:"h-6 w-6","aria-hidden":"true"})}),o.jsx("p",{className:"ml-16 text-lg leading-6 font-medium text-gray-900",children:e.title})]}),o.jsx("dd",{className:"mt-2 ml-16 text-base text-gray-500",children:e.description})]},t))})})]})}),o.jsx("div",{className:"py-24 bg-white",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 sm:p-12",children:o.jsxs("div",{className:"max-w-3xl mx-auto",children:[o.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-8 text-center",children:"How Kofi Ghana Kloding Scaled with Sten360"}),o.jsx("p",{className:"text-gray-600 mb-8",children:"Before switching to Sten360, Kofi Ghana Kloding struggled with disorganized client records, delayed orders, and inefficient workforce management. Manual processes made it difficult to track tailor assignments, manage finances, and keep up with growing customer demand."}),o.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-6",children:"With Sten360, Kofi Ghana Kloding transformed its operations:"}),o.jsxs("div",{className:"space-y-4 mb-8",children:[o.jsxs("div",{className:"flex items-start",children:[o.jsx(Si,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"Seamless Order & Client Management"}),o.jsx("p",{className:"text-gray-600",children:"Orders are tracked end-to-end, ensuring every client gets timely service."})]})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx(Si,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"Workforce Efficiency"}),o.jsx("p",{className:"text-gray-600",children:"Tailors receive assignments instantly, and their progress is monitored in real-time."})]})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx(Si,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"Smarter Financial Controls"}),o.jsx("p",{className:"text-gray-600",children:"Earnings, expenses, and worker payments are automatically tracked, reducing financial errors."})]})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx(Si,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"Stronger Customer Relationships"}),o.jsx("p",{className:"text-gray-600",children:"With detailed client profiles and history, Kofi delivers a more personalized experience."})]})]})]}),o.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Now, Kofi Ghana spends less time handling admin tasks and more time growing his brand."}),o.jsxs("div",{className:"text-center",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Ready to take your business to the next level?"}),o.jsxs(gr,{to:"/signup",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700",children:["Get Started with Sten360 Today!",o.jsx(l1,{className:"ml-2 h-5 w-5"})]})]})]})})})}),o.jsx("div",{className:"bg-white",children:o.jsx("div",{className:"max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"bg-blue-600 rounded-lg shadow-xl overflow-hidden",children:o.jsx("div",{className:"pt-10 pb-12 px-6 sm:pt-16 sm:px-16 lg:py-16 lg:pr-0 xl:py-20 xl:px-20",children:o.jsxs("div",{className:"lg:self-center",children:[o.jsxs("h2",{className:"text-3xl font-extrabold text-white sm:text-4xl",children:[o.jsx("span",{className:"block",children:"Ready to get started?"}),o.jsx("span",{className:"block",children:"Transform your business today."})]}),o.jsx("p",{className:"mt-4 text-lg leading-6 text-blue-200",children:"Sign up for free and experience the difference. No credit card required."}),o.jsxs(gr,{to:"/signup",className:"mt-8 inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-blue-600 bg-white hover:bg-blue-50 transition-colors duration-200",children:["Get Started Free",o.jsx(l1,{className:"ml-2 h-5 w-5"})]})]})})})})}),o.jsx("footer",{className:"bg-gray-50",children:o.jsx("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx(Ao,{className:"h-6 w-6 text-gray-400"}),o.jsx("span",{className:"ml-2 text-gray-500",children:" 2024 Sten Media Network. All rights reserved."})]}),o.jsx("p",{className:"text-sm text-gray-400",children:"Sten360 is a product of Sten Business, a subsidiary of Sten Media Network"})]})})})]})}function ER(){var b,_,E,D,I,A,P,C,M,j,T,q,U,re,z,G,B,Y,se,me;const{id:e}=_m(),[t,r]=he.useState(null),[n,s]=he.useState(!0),[i,a]=he.useState(!1),[l,c]=he.useState(!1),[u,d]=he.useState({title:"",value:"",type:"text",file:null}),{organization:m}=qt(),{addToast:p}=en(),h=m!=null&&m.currency?((b=Ar[m.currency])==null?void 0:b.symbol)||m.currency:"";he.useEffect(()=>{!e||!m||y()},[e,m]);const y=async()=>{var S,L;try{const{data:R,error:O}=await We.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*),
          orders:orders(
            id,
            order_number,
            total_amount,
            outstanding_balance,
            created_at,
            status
          ),
          sales_orders:sales_orders(
            id,
            order_number,
            total_amount,
            outstanding_balance,
            payment_status,
            notes,
            created_at
          )
        `).eq("id",e).eq("organization_id",m==null?void 0:m.id).single();if(O)throw O;const V=((S=R.orders)==null?void 0:S.reduce((ue,fe)=>ue+(fe.outstanding_balance||0),0))||0,ne=((L=R.sales_orders)==null?void 0:L.reduce((ue,fe)=>ue+(fe.outstanding_balance||0),0))||0;r({...R,total_balance:V+ne})}catch(R){console.error("Error loading client details:",R),p({type:"error",title:"Error",message:"Failed to load client details"})}finally{s(!1)}},g=async()=>{if(!(!t||!m)){c(!0);try{const{error:S}=await We.from("clients").update({name:t.name,phone:t.phone,address:t.address,date_of_birth:t.date_of_birth}).eq("id",t.id).eq("organization_id",m.id);if(S)throw S;a(!1),p({type:"success",title:"Success",message:"Client details updated successfully"})}catch(S){console.error("Error updating client:",S),p({type:"error",title:"Error",message:"Failed to update client details"})}finally{c(!1)}}},w=async()=>{var S;if(!(!t||!m)){c(!0);try{let L=u.value;if(u.type==="file"&&u.file){const O=(S=u.file.name.split(".").pop())==null?void 0:S.toLowerCase(),V=`${Math.random().toString(36).substring(2)}.${O}`,ne=`${m.id}/clients/${t.id}/${V}`,{error:ue}=await We.storage.from("profiles").upload(ne,u.file,{cacheControl:"3600",upsert:!1});if(ue)throw ue;const{data:{publicUrl:fe}}=We.storage.from("profiles").getPublicUrl(ne);L=fe}const{error:R}=await We.from("client_custom_fields").insert({client_id:t.id,title:u.title.trim(),value:L,type:u.type});if(R)throw R;d({title:"",value:"",type:"text",file:null}),y(),p({type:"success",title:"Success",message:"Custom field added successfully"})}catch(L){console.error("Error adding custom field:",L),p({type:"error",title:"Error",message:"Failed to add custom field"})}finally{c(!1)}}},v=async S=>{if(t)try{const{error:L}=await We.from("client_custom_fields").delete().eq("id",S);if(L)throw L;y(),p({type:"success",title:"Success",message:"Custom field deleted successfully"})}catch(L){console.error("Error deleting custom field:",L),p({type:"error",title:"Error",message:"Failed to delete custom field"})}};return n?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t?o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs(gr,{to:"/dashboard/clients",className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(jl,{className:"h-4 w-4 mr-2"}),"Back to Clients"]}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name}),o.jsxs("p",{className:"text-sm text-gray-500",children:["Client ID: ",t.id]})]})]}),o.jsx("div",{className:"flex items-center space-x-3",children:i?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),o.jsx("button",{onClick:g,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:l?o.jsxs(o.Fragment,{children:[o.jsx(To,{className:"animate-spin h-4 w-4 mr-2"}),"Saving..."]}):"Save Changes"})]}):o.jsx("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Edit Details"})})]})}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),i?o.jsx("input",{type:"text",value:t.name,onChange:S=>r(L=>L?{...L,name:S.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):o.jsx("div",{className:"mt-1 text-sm text-gray-900",children:t.name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),i?o.jsx("input",{type:"tel",value:t.phone||"",onChange:S=>r(L=>L?{...L,phone:S.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):o.jsxs("div",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[o.jsx(n2,{className:"h-4 w-4 mr-2 text-gray-400"}),t.phone||"Not provided"]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),i?o.jsx("textarea",{value:t.address||"",onChange:S=>r(L=>L?{...L,address:S.target.value}:null),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):o.jsxs("div",{className:"mt-1 text-sm text-gray-900 flex items-start",children:[o.jsx(r2,{className:"h-4 w-4 mr-2 mt-1 text-gray-400"}),t.address||"Not provided"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),i?o.jsx("input",{type:"date",value:t.date_of_birth||"",onChange:S=>r(L=>L?{...L,date_of_birth:S.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):o.jsxs("div",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[o.jsx(Ol,{className:"h-4 w-4 mr-2 text-gray-400"}),t.date_of_birth?Lt(new Date(t.date_of_birth),"MMM d, yyyy"):"Not provided"]})]})]})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Custom Information"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"space-y-4",children:[(_=t.custom_fields)==null?void 0:_.map(S=>o.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("span",{className:"font-medium",children:[S.title,": "]}),S.type==="file"?o.jsx("a",{href:S.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"View File"}):o.jsx("span",{children:S.value})]}),o.jsx("button",{onClick:()=>v(S.id),className:"ml-4 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:o.jsx(ti,{className:"h-4 w-4"})})]},S.id)),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Custom Information"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),o.jsxs("select",{value:u.type,onChange:S=>{const L=S.target.value;d(R=>({...R,type:L,value:"",file:null}))},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[o.jsx("option",{value:"text",children:"Text"}),o.jsx("option",{value:"file",children:"File"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),o.jsx("input",{type:"text",value:u.title,onChange:S=>d(L=>({...L,title:S.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),u.type==="text"?o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),o.jsx("input",{type:"text",value:u.value,onChange:S=>d(L=>({...L,value:S.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),o.jsxs("div",{className:"mt-1 flex items-center",children:[o.jsx("input",{type:"file",onChange:S=>{var R;const L=(R=S.target.files)==null?void 0:R[0];L&&d(O=>({...O,file:L}))},className:"hidden",id:"custom-file"}),o.jsxs("label",{htmlFor:"custom-file",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[o.jsx(cf,{className:"h-4 w-4 mr-2"}),"Choose File"]}),u.file&&o.jsx("span",{className:"ml-3 text-sm text-gray-500",children:u.file.name})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:w,disabled:l||!u.title||!u.value&&!u.file,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:l?o.jsxs(o.Fragment,{children:[o.jsx(To,{className:"animate-spin h-4 w-4 mr-2"}),"Adding..."]}):"Add Field"})})]})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Orders Summary"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Number of Orders"}),o.jsx("span",{className:"text-lg font-bold text-gray-900",children:((E=t.orders)==null?void 0:E.length)||0})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outstanding Balance"}),o.jsxs("span",{className:`text-lg font-bold ${(((D=t.orders)==null?void 0:D.reduce((S,L)=>S+(L.outstanding_balance||0),0))||0)>0?"text-red-600":"text-green-600"}`,children:[h," ",(((I=t.orders)==null?void 0:I.reduce((S,L)=>S+(L.outstanding_balance||0),0))||0).toFixed(2)]})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),o.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[h," ",(((A=t.orders)==null?void 0:A.reduce((S,L)=>S+L.total_amount,0))||0).toFixed(2)]})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Paid"}),o.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[h," ",(((P=t.orders)==null?void 0:P.reduce((S,L)=>S+(L.total_amount-L.outstanding_balance),0))||0).toFixed(2)]})]})})]})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sales Orders Summary"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Number of Sales Orders"}),o.jsx("span",{className:"text-lg font-bold text-gray-900",children:((C=t.sales_orders)==null?void 0:C.length)||0})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outstanding Balance"}),o.jsxs("span",{className:`text-lg font-bold ${(((M=t.sales_orders)==null?void 0:M.reduce((S,L)=>S+(L.outstanding_balance||0),0))||0)>0?"text-red-600":"text-green-600"}`,children:[h," ",(((j=t.sales_orders)==null?void 0:j.reduce((S,L)=>S+(L.outstanding_balance||0),0))||0).toFixed(2)]})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),o.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[h," ",(((T=t.sales_orders)==null?void 0:T.reduce((S,L)=>S+L.total_amount,0))||0).toFixed(2)]})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Paid"}),o.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[h," ",(((q=t.sales_orders)==null?void 0:q.reduce((S,L)=>S+(L.total_amount-L.outstanding_balance),0))||0).toFixed(2)]})]})})]})})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden border-2 border-blue-500",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200 bg-blue-50",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Total Summary"})}),o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Number of Orders"}),o.jsx("span",{className:"text-lg font-bold text-gray-900",children:(((U=t.orders)==null?void 0:U.length)||0)+(((re=t.sales_orders)==null?void 0:re.length)||0)})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Outstanding Balance"}),o.jsxs("span",{className:`text-lg font-bold ${t.total_balance>0?"text-red-600":"text-green-600"}`,children:[h," ",t.total_balance.toFixed(2)]})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),o.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[h," ",((((z=t.orders)==null?void 0:z.reduce((S,L)=>S+L.total_amount,0))||0)+(((G=t.sales_orders)==null?void 0:G.reduce((S,L)=>S+L.total_amount,0))||0)).toFixed(2)]})]})}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Paid"}),o.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[h," ",((((B=t.orders)==null?void 0:B.reduce((S,L)=>S+(L.total_amount-L.outstanding_balance),0))||0)+(((Y=t.sales_orders)==null?void 0:Y.reduce((S,L)=>S+(L.total_amount-L.outstanding_balance),0))||0)).toFixed(2)]})]})})]})})]})]}),o.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Orders History"})}),o.jsx("div",{className:"overflow-x-auto",children:t.orders&&t.orders.length>0||t.sales_orders&&t.sales_orders.length>0?o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Number"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),o.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[(se=t.orders)==null?void 0:se.map(S=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsx(gr,{to:`/dashboard/orders/${S.id}`,className:"text-blue-600 hover:text-blue-800",children:S.order_number})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Order"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Lt(new Date(S.created_at),"MMM d, yyyy")}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h," ",S.total_amount.toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("span",{className:`text-sm font-medium ${S.outstanding_balance>0?"text-red-600":"text-green-600"}`,children:[h," ",S.outstanding_balance.toFixed(2)]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${S.status==="completed"?"bg-green-100 text-green-800":S.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:S.status.charAt(0).toUpperCase()+S.status.slice(1)})})]},`order-${S.id}`)),(me=t.sales_orders)==null?void 0:me.map(S=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsx(gr,{to:`/dashboard/sales/${S.id}`,className:"text-blue-600 hover:text-blue-800",children:S.order_number})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Sales Order"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Lt(new Date(S.created_at),"MMM d, yyyy")}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h," ",S.total_amount.toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("span",{className:`text-sm font-medium ${S.outstanding_balance>0?"text-red-600":"text-green-600"}`,children:[h," ",S.outstanding_balance.toFixed(2)]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${S.payment_status==="paid"?"bg-green-100 text-green-800":S.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:S.payment_status.charAt(0).toUpperCase()+S.payment_status.slice(1)})})]},`sales-${S.id}`))]})]}):o.jsx("div",{className:"text-center text-gray-500 py-8",children:"No orders found for this client."})})]})]})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Client not found"}),o.jsxs(gr,{to:"/clients",className:"mt-4 inline-flex items-center text-blue-600 hover:text-blue-800",children:[o.jsx(jl,{className:"h-4 w-4 mr-1"}),"Back to Clients"]})]})}function AR(){const{user:e,error:t,initialized:r}=qt();return r?t?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50",children:o.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[o.jsxs("div",{className:"text-red-600 mb-2",children:["Error: ",t]}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})}):o.jsx(JA,{children:o.jsx(Tj,{children:o.jsxs(E4,{children:[o.jsx(yr,{path:"/",element:e?o.jsx(ml,{to:"/dashboard",replace:!0}):o.jsx(jR,{})}),o.jsxs(yr,{element:o.jsx($A,{}),children:[o.jsx(yr,{path:"/signin",element:o.jsx(VA,{})}),o.jsx(yr,{path:"/signup",element:o.jsx(GA,{})})]}),o.jsx(yr,{path:"/organization-setup",element:e?o.jsx(_R,{}):o.jsx(ml,{to:"/signin",replace:!0})}),o.jsx(yr,{path:"/dashboard/*",element:e?o.jsx(vR,{}):o.jsx(ml,{to:"/signin",replace:!0})}),o.jsx(yr,{path:"/clients/:id",element:o.jsx(ER,{})})]})})}):o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading application..."})]})})}g4(document.getElementById("root")).render(o.jsx(he.StrictMode,{children:o.jsx(AR,{})}));export{tr as _,Xn as c,Qg as g};
