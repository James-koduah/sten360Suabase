function nN(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Xn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ew(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var tw={exports:{}},ip={},rw={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gd=Symbol.for("react.element"),iN=Symbol.for("react.portal"),sN=Symbol.for("react.fragment"),aN=Symbol.for("react.strict_mode"),oN=Symbol.for("react.profiler"),lN=Symbol.for("react.provider"),cN=Symbol.for("react.context"),uN=Symbol.for("react.forward_ref"),fN=Symbol.for("react.suspense"),dN=Symbol.for("react.memo"),hN=Symbol.for("react.lazy"),Zx=Symbol.iterator;function pN(e){return e===null||typeof e!="object"?null:(e=Zx&&e[Zx]||e["@@iterator"],typeof e=="function"?e:null)}var nw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iw=Object.assign,sw={};function iu(e,t,r){this.props=e,this.context=t,this.refs=sw,this.updater=r||nw}iu.prototype.isReactComponent={};iu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};iu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function aw(){}aw.prototype=iu.prototype;function Jg(e,t,r){this.props=e,this.context=t,this.refs=sw,this.updater=r||nw}var Qg=Jg.prototype=new aw;Qg.constructor=Jg;iw(Qg,iu.prototype);Qg.isPureReactComponent=!0;var ev=Array.isArray,ow=Object.prototype.hasOwnProperty,Zg={current:null},lw={key:!0,ref:!0,__self:!0,__source:!0};function cw(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)ow.call(t,n)&&!lw.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:gd,type:e,key:s,ref:a,props:i,_owner:Zg.current}}function mN(e,t){return{$$typeof:gd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function e2(e){return typeof e=="object"&&e!==null&&e.$$typeof===gd}function gN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var tv=/\/+/g;function km(e,t){return typeof e=="object"&&e!==null&&e.key!=null?gN(""+e.key):t.toString(36)}function r0(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case gd:case iN:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+km(a,0):n,ev(i)?(r="",e!=null&&(r=e.replace(tv,"$&/")+"/"),r0(i,t,r,"",function(u){return u})):i!=null&&(e2(i)&&(i=mN(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(tv,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",ev(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+km(s,o);a+=r0(s,t,r,l,i)}else if(l=pN(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+km(s,o++),a+=r0(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function yh(e,t,r){if(e==null)return e;var n=[],i=0;return r0(e,n,"","",function(s){return t.call(r,s,i++)}),n}function xN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Zn={current:null},n0={transition:null},vN={ReactCurrentDispatcher:Zn,ReactCurrentBatchConfig:n0,ReactCurrentOwner:Zg};function uw(){throw Error("act(...) is not supported in production builds of React.")}Ft.Children={map:yh,forEach:function(e,t,r){yh(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return yh(e,function(){t++}),t},toArray:function(e){return yh(e,function(t){return t})||[]},only:function(e){if(!e2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ft.Component=iu;Ft.Fragment=sN;Ft.Profiler=oN;Ft.PureComponent=Jg;Ft.StrictMode=aN;Ft.Suspense=fN;Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vN;Ft.act=uw;Ft.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=iw({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Zg.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)ow.call(t,l)&&!lw.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:gd,type:e.type,key:i,ref:s,props:n,_owner:a}};Ft.createContext=function(e){return e={$$typeof:cN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:lN,_context:e},e.Consumer=e};Ft.createElement=cw;Ft.createFactory=function(e){var t=cw.bind(null,e);return t.type=e,t};Ft.createRef=function(){return{current:null}};Ft.forwardRef=function(e){return{$$typeof:uN,render:e}};Ft.isValidElement=e2;Ft.lazy=function(e){return{$$typeof:hN,_payload:{_status:-1,_result:e},_init:xN}};Ft.memo=function(e,t){return{$$typeof:dN,type:e,compare:t===void 0?null:t}};Ft.startTransition=function(e){var t=n0.transition;n0.transition={};try{e()}finally{n0.transition=t}};Ft.unstable_act=uw;Ft.useCallback=function(e,t){return Zn.current.useCallback(e,t)};Ft.useContext=function(e){return Zn.current.useContext(e)};Ft.useDebugValue=function(){};Ft.useDeferredValue=function(e){return Zn.current.useDeferredValue(e)};Ft.useEffect=function(e,t){return Zn.current.useEffect(e,t)};Ft.useId=function(){return Zn.current.useId()};Ft.useImperativeHandle=function(e,t,r){return Zn.current.useImperativeHandle(e,t,r)};Ft.useInsertionEffect=function(e,t){return Zn.current.useInsertionEffect(e,t)};Ft.useLayoutEffect=function(e,t){return Zn.current.useLayoutEffect(e,t)};Ft.useMemo=function(e,t){return Zn.current.useMemo(e,t)};Ft.useReducer=function(e,t,r){return Zn.current.useReducer(e,t,r)};Ft.useRef=function(e){return Zn.current.useRef(e)};Ft.useState=function(e){return Zn.current.useState(e)};Ft.useSyncExternalStore=function(e,t,r){return Zn.current.useSyncExternalStore(e,t,r)};Ft.useTransition=function(){return Zn.current.useTransition()};Ft.version="18.3.1";rw.exports=Ft;var pe=rw.exports;const fw=Xg(pe),yN=nN({__proto__:null,default:fw},[pe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wN=pe,bN=Symbol.for("react.element"),_N=Symbol.for("react.fragment"),SN=Object.prototype.hasOwnProperty,NN=wN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kN={key:!0,ref:!0,__self:!0,__source:!0};function dw(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)SN.call(t,n)&&!kN.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:bN,type:e,key:s,ref:a,props:i,_owner:NN.current}}ip.Fragment=_N;ip.jsx=dw;ip.jsxs=dw;tw.exports=ip;var c=tw.exports,hw={exports:{}},Mi={},pw={exports:{}},mw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(G,V){var Z=G.length;G.push(V);e:for(;0<Z;){var he=Z-1>>>1,k=G[he];if(0<i(k,V))G[he]=V,G[Z]=k,Z=he;else break e}}function r(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var V=G[0],Z=G.pop();if(Z!==V){G[0]=Z;e:for(var he=0,k=G.length,I=k>>>1;he<I;){var M=2*(he+1)-1,L=G[M],H=M+1,se=G[H];if(0>i(L,Z))H<k&&0>i(se,L)?(G[he]=se,G[H]=Z,he=H):(G[he]=L,G[M]=Z,he=M);else if(H<k&&0>i(se,Z))G[he]=se,G[H]=Z,he=H;else break e}}return V}function i(G,V){var Z=G.sortIndex-V.sortIndex;return Z!==0?Z:G.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,p=null,m=3,h=!1,v=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(G){for(var V=r(u);V!==null;){if(V.callback===null)n(u);else if(V.startTime<=G)n(u),V.sortIndex=V.expirationTime,t(l,V);else break;V=r(u)}}function E(G){if(x=!1,_(G),!v)if(r(l)!==null)v=!0,z(O);else{var V=r(u);V!==null&&B(E,V.startTime-G)}}function O(G,V){v=!1,x&&(x=!1,y(C),C=-1),h=!0;var Z=m;try{for(_(V),p=r(l);p!==null&&(!(p.expirationTime>V)||G&&!j());){var he=p.callback;if(typeof he=="function"){p.callback=null,m=p.priorityLevel;var k=he(p.expirationTime<=V);V=e.unstable_now(),typeof k=="function"?p.callback=k:p===r(l)&&n(l),_(V)}else n(l);p=r(l)}if(p!==null)var I=!0;else{var M=r(u);M!==null&&B(E,M.startTime-V),I=!1}return I}finally{p=null,m=Z,h=!1}}var D=!1,T=null,C=-1,P=5,R=-1;function j(){return!(e.unstable_now()-R<P)}function A(){if(T!==null){var G=e.unstable_now();R=G;var V=!0;try{V=T(!0,G)}finally{V?q():(D=!1,T=null)}}else D=!1}var q;if(typeof w=="function")q=function(){w(A)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,te=J.port2;J.port1.onmessage=A,q=function(){te.postMessage(null)}}else q=function(){b(A,0)};function z(G){T=G,D||(D=!0,q())}function B(G,V){C=b(function(){G(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,z(O))},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(G){switch(m){case 1:case 2:case 3:var V=3;break;default:V=m}var Z=m;m=V;try{return G()}finally{m=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,V){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var Z=m;m=G;try{return V()}finally{m=Z}},e.unstable_scheduleCallback=function(G,V,Z){var he=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?he+Z:he):Z=he,G){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=Z+k,G={id:f++,callback:V,priorityLevel:G,startTime:Z,expirationTime:k,sortIndex:-1},Z>he?(G.sortIndex=Z,t(u,G),r(l)===null&&G===r(u)&&(x?(y(C),C=-1):x=!0,B(E,Z-he))):(G.sortIndex=k,t(l,G),v||h||(v=!0,z(O))),G},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(G){var V=m;return function(){var Z=m;m=V;try{return G.apply(this,arguments)}finally{m=Z}}}})(mw);pw.exports=mw;var EN=pw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AN=pe,Ii=EN;function $e(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gw=new Set,Uf={};function jl(e,t){Gc(e,t),Gc(e+"Capture",t)}function Gc(e,t){for(Uf[e]=t,e=0;e<t.length;e++)gw.add(t[e])}var Sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),j1=Object.prototype.hasOwnProperty,TN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rv={},nv={};function jN(e){return j1.call(nv,e)?!0:j1.call(rv,e)?!1:TN.test(e)?nv[e]=!0:(rv[e]=!0,!1)}function CN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function PN(e,t,r,n){if(t===null||typeof t>"u"||CN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ei(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){An[e]=new ei(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];An[t]=new ei(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){An[e]=new ei(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){An[e]=new ei(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){An[e]=new ei(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){An[e]=new ei(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){An[e]=new ei(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){An[e]=new ei(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){An[e]=new ei(e,5,!1,e.toLowerCase(),null,!1,!1)});var t2=/[\-:]([a-z])/g;function r2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(t2,r2);An[t]=new ei(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(t2,r2);An[t]=new ei(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(t2,r2);An[t]=new ei(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){An[e]=new ei(e,1,!1,e.toLowerCase(),null,!1,!1)});An.xlinkHref=new ei("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){An[e]=new ei(e,1,!1,e.toLowerCase(),null,!0,!0)});function n2(e,t,r,n){var i=An.hasOwnProperty(t)?An[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(PN(t,r,i,n)&&(r=null),n||i===null?jN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ca=AN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wh=Symbol.for("react.element"),_c=Symbol.for("react.portal"),Sc=Symbol.for("react.fragment"),i2=Symbol.for("react.strict_mode"),C1=Symbol.for("react.profiler"),xw=Symbol.for("react.provider"),vw=Symbol.for("react.context"),s2=Symbol.for("react.forward_ref"),P1=Symbol.for("react.suspense"),L1=Symbol.for("react.suspense_list"),a2=Symbol.for("react.memo"),Za=Symbol.for("react.lazy"),yw=Symbol.for("react.offscreen"),iv=Symbol.iterator;function Gu(e){return e===null||typeof e!="object"?null:(e=iv&&e[iv]||e["@@iterator"],typeof e=="function"?e:null)}var Er=Object.assign,Em;function uf(e){if(Em===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Em=t&&t[1]||""}return`
`+Em+e}var Am=!1;function Tm(e,t){if(!e||Am)return"";Am=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{Am=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?uf(e):""}function LN(e){switch(e.tag){case 5:return uf(e.type);case 16:return uf("Lazy");case 13:return uf("Suspense");case 19:return uf("SuspenseList");case 0:case 2:case 15:return e=Tm(e.type,!1),e;case 11:return e=Tm(e.type.render,!1),e;case 1:return e=Tm(e.type,!0),e;default:return""}}function F1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Sc:return"Fragment";case _c:return"Portal";case C1:return"Profiler";case i2:return"StrictMode";case P1:return"Suspense";case L1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vw:return(e.displayName||"Context")+".Consumer";case xw:return(e._context.displayName||"Context")+".Provider";case s2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case a2:return t=e.displayName||null,t!==null?t:F1(e.type)||"Memo";case Za:t=e._payload,e=e._init;try{return F1(e(t))}catch{}}return null}function FN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F1(t);case 8:return t===i2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function No(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ww(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ON(e){var t=ww(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bh(e){e._valueTracker||(e._valueTracker=ON(e))}function bw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ww(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function p0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function O1(e,t){var r=t.checked;return Er({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function sv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=No(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _w(e,t){t=t.checked,t!=null&&n2(e,"checked",t,!1)}function D1(e,t){_w(e,t);var r=No(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?I1(e,t.type,r):t.hasOwnProperty("defaultValue")&&I1(e,t.type,No(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function av(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function I1(e,t,r){(t!=="number"||p0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ff=Array.isArray;function Ic(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+No(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function R1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error($e(91));return Er({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ov(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error($e(92));if(ff(r)){if(1<r.length)throw Error($e(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:No(r)}}function Sw(e,t){var r=No(t.value),n=No(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function lv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Nw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function M1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Nw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _h,kw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_h=_h||document.createElement("div"),_h.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_h.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function zf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var xf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},DN=["Webkit","ms","Moz","O"];Object.keys(xf).forEach(function(e){DN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xf[t]=xf[e]})});function Ew(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||xf.hasOwnProperty(e)&&xf[e]?(""+t).trim():t+"px"}function Aw(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Ew(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var IN=Er({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function B1(e,t){if(t){if(IN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error($e(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error($e(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error($e(61))}if(t.style!=null&&typeof t.style!="object")throw Error($e(62))}}function U1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var z1=null;function o2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var W1=null,Rc=null,Mc=null;function cv(e){if(e=yd(e)){if(typeof W1!="function")throw Error($e(280));var t=e.stateNode;t&&(t=cp(t),W1(e.stateNode,e.type,t))}}function Tw(e){Rc?Mc?Mc.push(e):Mc=[e]:Rc=e}function jw(){if(Rc){var e=Rc,t=Mc;if(Mc=Rc=null,cv(e),t)for(e=0;e<t.length;e++)cv(t[e])}}function Cw(e,t){return e(t)}function Pw(){}var jm=!1;function Lw(e,t,r){if(jm)return e(t,r);jm=!0;try{return Cw(e,t,r)}finally{jm=!1,(Rc!==null||Mc!==null)&&(Pw(),jw())}}function Wf(e,t){var r=e.stateNode;if(r===null)return null;var n=cp(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error($e(231,t,typeof r));return r}var H1=!1;if(Sa)try{var Yu={};Object.defineProperty(Yu,"passive",{get:function(){H1=!0}}),window.addEventListener("test",Yu,Yu),window.removeEventListener("test",Yu,Yu)}catch{H1=!1}function RN(e,t,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var vf=!1,m0=null,g0=!1,$1=null,MN={onError:function(e){vf=!0,m0=e}};function BN(e,t,r,n,i,s,a,o,l){vf=!1,m0=null,RN.apply(MN,arguments)}function UN(e,t,r,n,i,s,a,o,l){if(BN.apply(this,arguments),vf){if(vf){var u=m0;vf=!1,m0=null}else throw Error($e(198));g0||(g0=!0,$1=u)}}function Cl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Fw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function uv(e){if(Cl(e)!==e)throw Error($e(188))}function zN(e){var t=e.alternate;if(!t){if(t=Cl(e),t===null)throw Error($e(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return uv(i),e;if(s===n)return uv(i),t;s=s.sibling}throw Error($e(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error($e(189))}}if(r.alternate!==n)throw Error($e(190))}if(r.tag!==3)throw Error($e(188));return r.stateNode.current===r?e:t}function Ow(e){return e=zN(e),e!==null?Dw(e):null}function Dw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Dw(e);if(t!==null)return t;e=e.sibling}return null}var Iw=Ii.unstable_scheduleCallback,fv=Ii.unstable_cancelCallback,WN=Ii.unstable_shouldYield,HN=Ii.unstable_requestPaint,Mr=Ii.unstable_now,$N=Ii.unstable_getCurrentPriorityLevel,l2=Ii.unstable_ImmediatePriority,Rw=Ii.unstable_UserBlockingPriority,x0=Ii.unstable_NormalPriority,qN=Ii.unstable_LowPriority,Mw=Ii.unstable_IdlePriority,sp=null,Ks=null;function VN(e){if(Ks&&typeof Ks.onCommitFiberRoot=="function")try{Ks.onCommitFiberRoot(sp,e,void 0,(e.current.flags&128)===128)}catch{}}var As=Math.clz32?Math.clz32:KN,GN=Math.log,YN=Math.LN2;function KN(e){return e>>>=0,e===0?32:31-(GN(e)/YN|0)|0}var Sh=64,Nh=4194304;function df(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function v0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=df(o):(s&=a,s!==0&&(n=df(s)))}else a=r&~i,a!==0?n=df(a):s!==0&&(n=df(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-As(t),i=1<<r,n|=e[r],t&=~i;return n}function XN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JN(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-As(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=XN(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function q1(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Bw(){var e=Sh;return Sh<<=1,!(Sh&4194240)&&(Sh=64),e}function Cm(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-As(t),e[t]=r}function QN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-As(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function c2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-As(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var nr=0;function Uw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zw,u2,Ww,Hw,$w,V1=!1,kh=[],ho=null,po=null,mo=null,Hf=new Map,$f=new Map,ro=[],ZN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dv(e,t){switch(e){case"focusin":case"focusout":ho=null;break;case"dragenter":case"dragleave":po=null;break;case"mouseover":case"mouseout":mo=null;break;case"pointerover":case"pointerout":Hf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$f.delete(t.pointerId)}}function Ku(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=yd(t),t!==null&&u2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function e6(e,t,r,n,i){switch(t){case"focusin":return ho=Ku(ho,e,t,r,n,i),!0;case"dragenter":return po=Ku(po,e,t,r,n,i),!0;case"mouseover":return mo=Ku(mo,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Hf.set(s,Ku(Hf.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,$f.set(s,Ku($f.get(s)||null,e,t,r,n,i)),!0}return!1}function qw(e){var t=al(e.target);if(t!==null){var r=Cl(t);if(r!==null){if(t=r.tag,t===13){if(t=Fw(r),t!==null){e.blockedOn=t,$w(e.priority,function(){Ww(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function i0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=G1(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);z1=n,r.target.dispatchEvent(n),z1=null}else return t=yd(r),t!==null&&u2(t),e.blockedOn=r,!1;t.shift()}return!0}function hv(e,t,r){i0(e)&&r.delete(t)}function t6(){V1=!1,ho!==null&&i0(ho)&&(ho=null),po!==null&&i0(po)&&(po=null),mo!==null&&i0(mo)&&(mo=null),Hf.forEach(hv),$f.forEach(hv)}function Xu(e,t){e.blockedOn===t&&(e.blockedOn=null,V1||(V1=!0,Ii.unstable_scheduleCallback(Ii.unstable_NormalPriority,t6)))}function qf(e){function t(i){return Xu(i,e)}if(0<kh.length){Xu(kh[0],e);for(var r=1;r<kh.length;r++){var n=kh[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ho!==null&&Xu(ho,e),po!==null&&Xu(po,e),mo!==null&&Xu(mo,e),Hf.forEach(t),$f.forEach(t),r=0;r<ro.length;r++)n=ro[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ro.length&&(r=ro[0],r.blockedOn===null);)qw(r),r.blockedOn===null&&ro.shift()}var Bc=Ca.ReactCurrentBatchConfig,y0=!0;function r6(e,t,r,n){var i=nr,s=Bc.transition;Bc.transition=null;try{nr=1,f2(e,t,r,n)}finally{nr=i,Bc.transition=s}}function n6(e,t,r,n){var i=nr,s=Bc.transition;Bc.transition=null;try{nr=4,f2(e,t,r,n)}finally{nr=i,Bc.transition=s}}function f2(e,t,r,n){if(y0){var i=G1(e,t,r,n);if(i===null)Um(e,t,n,w0,r),dv(e,n);else if(e6(i,e,t,r,n))n.stopPropagation();else if(dv(e,n),t&4&&-1<ZN.indexOf(e)){for(;i!==null;){var s=yd(i);if(s!==null&&zw(s),s=G1(e,t,r,n),s===null&&Um(e,t,n,w0,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Um(e,t,n,null,r)}}var w0=null;function G1(e,t,r,n){if(w0=null,e=o2(n),e=al(e),e!==null)if(t=Cl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Fw(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return w0=e,null}function Vw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($N()){case l2:return 1;case Rw:return 4;case x0:case qN:return 16;case Mw:return 536870912;default:return 16}default:return 16}}var ao=null,d2=null,s0=null;function Gw(){if(s0)return s0;var e,t=d2,r=t.length,n,i="value"in ao?ao.value:ao.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return s0=i.slice(e,1<n?1-n:void 0)}function a0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Eh(){return!0}function pv(){return!1}function Bi(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Eh:pv,this.isPropagationStopped=pv,this}return Er(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Eh)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Eh)},persist:function(){},isPersistent:Eh}),t}var su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},h2=Bi(su),vd=Er({},su,{view:0,detail:0}),i6=Bi(vd),Pm,Lm,Ju,ap=Er({},vd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ju&&(Ju&&e.type==="mousemove"?(Pm=e.screenX-Ju.screenX,Lm=e.screenY-Ju.screenY):Lm=Pm=0,Ju=e),Pm)},movementY:function(e){return"movementY"in e?e.movementY:Lm}}),mv=Bi(ap),s6=Er({},ap,{dataTransfer:0}),a6=Bi(s6),o6=Er({},vd,{relatedTarget:0}),Fm=Bi(o6),l6=Er({},su,{animationName:0,elapsedTime:0,pseudoElement:0}),c6=Bi(l6),u6=Er({},su,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),f6=Bi(u6),d6=Er({},su,{data:0}),gv=Bi(d6),h6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},p6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function g6(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=m6[e])?!!t[e]:!1}function p2(){return g6}var x6=Er({},vd,{key:function(e){if(e.key){var t=h6[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=a0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?p6[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p2,charCode:function(e){return e.type==="keypress"?a0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?a0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),v6=Bi(x6),y6=Er({},ap,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xv=Bi(y6),w6=Er({},vd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p2}),b6=Bi(w6),_6=Er({},su,{propertyName:0,elapsedTime:0,pseudoElement:0}),S6=Bi(_6),N6=Er({},ap,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),k6=Bi(N6),E6=[9,13,27,32],m2=Sa&&"CompositionEvent"in window,yf=null;Sa&&"documentMode"in document&&(yf=document.documentMode);var A6=Sa&&"TextEvent"in window&&!yf,Yw=Sa&&(!m2||yf&&8<yf&&11>=yf),vv=" ",yv=!1;function Kw(e,t){switch(e){case"keyup":return E6.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Nc=!1;function T6(e,t){switch(e){case"compositionend":return Xw(t);case"keypress":return t.which!==32?null:(yv=!0,vv);case"textInput":return e=t.data,e===vv&&yv?null:e;default:return null}}function j6(e,t){if(Nc)return e==="compositionend"||!m2&&Kw(e,t)?(e=Gw(),s0=d2=ao=null,Nc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Yw&&t.locale!=="ko"?null:t.data;default:return null}}var C6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!C6[e.type]:t==="textarea"}function Jw(e,t,r,n){Tw(n),t=b0(t,"onChange"),0<t.length&&(r=new h2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var wf=null,Vf=null;function P6(e){l4(e,0)}function op(e){var t=Ac(e);if(bw(t))return e}function L6(e,t){if(e==="change")return t}var Qw=!1;if(Sa){var Om;if(Sa){var Dm="oninput"in document;if(!Dm){var bv=document.createElement("div");bv.setAttribute("oninput","return;"),Dm=typeof bv.oninput=="function"}Om=Dm}else Om=!1;Qw=Om&&(!document.documentMode||9<document.documentMode)}function _v(){wf&&(wf.detachEvent("onpropertychange",Zw),Vf=wf=null)}function Zw(e){if(e.propertyName==="value"&&op(Vf)){var t=[];Jw(t,Vf,e,o2(e)),Lw(P6,t)}}function F6(e,t,r){e==="focusin"?(_v(),wf=t,Vf=r,wf.attachEvent("onpropertychange",Zw)):e==="focusout"&&_v()}function O6(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return op(Vf)}function D6(e,t){if(e==="click")return op(t)}function I6(e,t){if(e==="input"||e==="change")return op(t)}function R6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Cs=typeof Object.is=="function"?Object.is:R6;function Gf(e,t){if(Cs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!j1.call(t,i)||!Cs(e[i],t[i]))return!1}return!0}function Sv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Nv(e,t){var r=Sv(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Sv(r)}}function e4(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e4(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t4(){for(var e=window,t=p0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=p0(e.document)}return t}function g2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function M6(e){var t=t4(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&e4(r.ownerDocument.documentElement,r)){if(n!==null&&g2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=Nv(r,s);var a=Nv(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var B6=Sa&&"documentMode"in document&&11>=document.documentMode,kc=null,Y1=null,bf=null,K1=!1;function kv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;K1||kc==null||kc!==p0(n)||(n=kc,"selectionStart"in n&&g2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),bf&&Gf(bf,n)||(bf=n,n=b0(Y1,"onSelect"),0<n.length&&(t=new h2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=kc)))}function Ah(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ec={animationend:Ah("Animation","AnimationEnd"),animationiteration:Ah("Animation","AnimationIteration"),animationstart:Ah("Animation","AnimationStart"),transitionend:Ah("Transition","TransitionEnd")},Im={},r4={};Sa&&(r4=document.createElement("div").style,"AnimationEvent"in window||(delete Ec.animationend.animation,delete Ec.animationiteration.animation,delete Ec.animationstart.animation),"TransitionEvent"in window||delete Ec.transitionend.transition);function lp(e){if(Im[e])return Im[e];if(!Ec[e])return e;var t=Ec[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in r4)return Im[e]=t[r];return e}var n4=lp("animationend"),i4=lp("animationiteration"),s4=lp("animationstart"),a4=lp("transitionend"),o4=new Map,Ev="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oo(e,t){o4.set(e,t),jl(t,[e])}for(var Rm=0;Rm<Ev.length;Rm++){var Mm=Ev[Rm],U6=Mm.toLowerCase(),z6=Mm[0].toUpperCase()+Mm.slice(1);Oo(U6,"on"+z6)}Oo(n4,"onAnimationEnd");Oo(i4,"onAnimationIteration");Oo(s4,"onAnimationStart");Oo("dblclick","onDoubleClick");Oo("focusin","onFocus");Oo("focusout","onBlur");Oo(a4,"onTransitionEnd");Gc("onMouseEnter",["mouseout","mouseover"]);Gc("onMouseLeave",["mouseout","mouseover"]);Gc("onPointerEnter",["pointerout","pointerover"]);Gc("onPointerLeave",["pointerout","pointerover"]);jl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jl("onBeforeInput",["compositionend","keypress","textInput","paste"]);jl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),W6=new Set("cancel close invalid load scroll toggle".split(" ").concat(hf));function Av(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,UN(n,t,void 0,e),e.currentTarget=null}function l4(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Av(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Av(i,o,u),s=l}}}if(g0)throw e=$1,g0=!1,$1=null,e}function xr(e,t){var r=t[eg];r===void 0&&(r=t[eg]=new Set);var n=e+"__bubble";r.has(n)||(c4(t,e,2,!1),r.add(n))}function Bm(e,t,r){var n=0;t&&(n|=4),c4(r,e,n,t)}var Th="_reactListening"+Math.random().toString(36).slice(2);function Yf(e){if(!e[Th]){e[Th]=!0,gw.forEach(function(r){r!=="selectionchange"&&(W6.has(r)||Bm(r,!1,e),Bm(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Th]||(t[Th]=!0,Bm("selectionchange",!1,t))}}function c4(e,t,r,n){switch(Vw(t)){case 1:var i=r6;break;case 4:i=n6;break;default:i=f2}r=i.bind(null,t,r,e),i=void 0,!H1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Um(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=al(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Lw(function(){var u=s,f=o2(r),p=[];e:{var m=o4.get(e);if(m!==void 0){var h=h2,v=e;switch(e){case"keypress":if(a0(r)===0)break e;case"keydown":case"keyup":h=v6;break;case"focusin":v="focus",h=Fm;break;case"focusout":v="blur",h=Fm;break;case"beforeblur":case"afterblur":h=Fm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=mv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=a6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=b6;break;case n4:case i4:case s4:h=c6;break;case a4:h=S6;break;case"scroll":h=i6;break;case"wheel":h=k6;break;case"copy":case"cut":case"paste":h=f6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=xv}var x=(t&4)!==0,b=!x&&e==="scroll",y=x?m!==null?m+"Capture":null:m;x=[];for(var w=u,_;w!==null;){_=w;var E=_.stateNode;if(_.tag===5&&E!==null&&(_=E,y!==null&&(E=Wf(w,y),E!=null&&x.push(Kf(w,E,_)))),b)break;w=w.return}0<x.length&&(m=new h(m,v,null,r,f),p.push({event:m,listeners:x}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&r!==z1&&(v=r.relatedTarget||r.fromElement)&&(al(v)||v[Na]))break e;if((h||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=u,v=v?al(v):null,v!==null&&(b=Cl(v),v!==b||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=u),h!==v)){if(x=mv,E="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(x=xv,E="onPointerLeave",y="onPointerEnter",w="pointer"),b=h==null?m:Ac(h),_=v==null?m:Ac(v),m=new x(E,w+"leave",h,r,f),m.target=b,m.relatedTarget=_,E=null,al(f)===u&&(x=new x(y,w+"enter",v,r,f),x.target=_,x.relatedTarget=b,E=x),b=E,h&&v)t:{for(x=h,y=v,w=0,_=x;_;_=oc(_))w++;for(_=0,E=y;E;E=oc(E))_++;for(;0<w-_;)x=oc(x),w--;for(;0<_-w;)y=oc(y),_--;for(;w--;){if(x===y||y!==null&&x===y.alternate)break t;x=oc(x),y=oc(y)}x=null}else x=null;h!==null&&Tv(p,m,h,x,!1),v!==null&&b!==null&&Tv(p,b,v,x,!0)}}e:{if(m=u?Ac(u):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var O=L6;else if(wv(m))if(Qw)O=I6;else{O=O6;var D=F6}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=D6);if(O&&(O=O(e,u))){Jw(p,O,r,f);break e}D&&D(e,m,u),e==="focusout"&&(D=m._wrapperState)&&D.controlled&&m.type==="number"&&I1(m,"number",m.value)}switch(D=u?Ac(u):window,e){case"focusin":(wv(D)||D.contentEditable==="true")&&(kc=D,Y1=u,bf=null);break;case"focusout":bf=Y1=kc=null;break;case"mousedown":K1=!0;break;case"contextmenu":case"mouseup":case"dragend":K1=!1,kv(p,r,f);break;case"selectionchange":if(B6)break;case"keydown":case"keyup":kv(p,r,f)}var T;if(m2)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Nc?Kw(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(Yw&&r.locale!=="ko"&&(Nc||C!=="onCompositionStart"?C==="onCompositionEnd"&&Nc&&(T=Gw()):(ao=f,d2="value"in ao?ao.value:ao.textContent,Nc=!0)),D=b0(u,C),0<D.length&&(C=new gv(C,e,null,r,f),p.push({event:C,listeners:D}),T?C.data=T:(T=Xw(r),T!==null&&(C.data=T)))),(T=A6?T6(e,r):j6(e,r))&&(u=b0(u,"onBeforeInput"),0<u.length&&(f=new gv("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=T))}l4(p,t)})}function Kf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function b0(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Wf(e,r),s!=null&&n.unshift(Kf(e,s,i)),s=Wf(e,t),s!=null&&n.push(Kf(e,s,i))),e=e.return}return n}function oc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Tv(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=Wf(r,s),l!=null&&a.unshift(Kf(r,l,o))):i||(l=Wf(r,s),l!=null&&a.push(Kf(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var H6=/\r\n?/g,$6=/\u0000|\uFFFD/g;function jv(e){return(typeof e=="string"?e:""+e).replace(H6,`
`).replace($6,"")}function jh(e,t,r){if(t=jv(t),jv(e)!==t&&r)throw Error($e(425))}function _0(){}var X1=null,J1=null;function Q1(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Z1=typeof setTimeout=="function"?setTimeout:void 0,q6=typeof clearTimeout=="function"?clearTimeout:void 0,Cv=typeof Promise=="function"?Promise:void 0,V6=typeof queueMicrotask=="function"?queueMicrotask:typeof Cv<"u"?function(e){return Cv.resolve(null).then(e).catch(G6)}:Z1;function G6(e){setTimeout(function(){throw e})}function zm(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),qf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);qf(t)}function go(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Pv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var au=Math.random().toString(36).slice(2),Vs="__reactFiber$"+au,Xf="__reactProps$"+au,Na="__reactContainer$"+au,eg="__reactEvents$"+au,Y6="__reactListeners$"+au,K6="__reactHandles$"+au;function al(e){var t=e[Vs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Na]||r[Vs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Pv(e);e!==null;){if(r=e[Vs])return r;e=Pv(e)}return t}e=r,r=e.parentNode}return null}function yd(e){return e=e[Vs]||e[Na],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ac(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error($e(33))}function cp(e){return e[Xf]||null}var tg=[],Tc=-1;function Do(e){return{current:e}}function yr(e){0>Tc||(e.current=tg[Tc],tg[Tc]=null,Tc--)}function mr(e,t){Tc++,tg[Tc]=e.current,e.current=t}var ko={},Hn=Do(ko),di=Do(!1),wl=ko;function Yc(e,t){var r=e.type.contextTypes;if(!r)return ko;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function hi(e){return e=e.childContextTypes,e!=null}function S0(){yr(di),yr(Hn)}function Lv(e,t,r){if(Hn.current!==ko)throw Error($e(168));mr(Hn,t),mr(di,r)}function u4(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error($e(108,FN(e)||"Unknown",i));return Er({},r,n)}function N0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ko,wl=Hn.current,mr(Hn,e),mr(di,di.current),!0}function Fv(e,t,r){var n=e.stateNode;if(!n)throw Error($e(169));r?(e=u4(e,t,wl),n.__reactInternalMemoizedMergedChildContext=e,yr(di),yr(Hn),mr(Hn,e)):yr(di),mr(di,r)}var ga=null,up=!1,Wm=!1;function f4(e){ga===null?ga=[e]:ga.push(e)}function X6(e){up=!0,f4(e)}function Io(){if(!Wm&&ga!==null){Wm=!0;var e=0,t=nr;try{var r=ga;for(nr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ga=null,up=!1}catch(i){throw ga!==null&&(ga=ga.slice(e+1)),Iw(l2,Io),i}finally{nr=t,Wm=!1}}return null}var jc=[],Cc=0,k0=null,E0=0,Qi=[],Zi=0,bl=null,xa=1,va="";function Zo(e,t){jc[Cc++]=E0,jc[Cc++]=k0,k0=e,E0=t}function d4(e,t,r){Qi[Zi++]=xa,Qi[Zi++]=va,Qi[Zi++]=bl,bl=e;var n=xa;e=va;var i=32-As(n)-1;n&=~(1<<i),r+=1;var s=32-As(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,xa=1<<32-As(t)+i|r<<i|n,va=s+e}else xa=1<<s|r<<i|n,va=e}function x2(e){e.return!==null&&(Zo(e,1),d4(e,1,0))}function v2(e){for(;e===k0;)k0=jc[--Cc],jc[Cc]=null,E0=jc[--Cc],jc[Cc]=null;for(;e===bl;)bl=Qi[--Zi],Qi[Zi]=null,va=Qi[--Zi],Qi[Zi]=null,xa=Qi[--Zi],Qi[Zi]=null}var Oi=null,Li=null,br=!1,Ss=null;function h4(e,t){var r=es(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Ov(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Oi=e,Li=go(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Oi=e,Li=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=bl!==null?{id:xa,overflow:va}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=es(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Oi=e,Li=null,!0):!1;default:return!1}}function rg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ng(e){if(br){var t=Li;if(t){var r=t;if(!Ov(e,t)){if(rg(e))throw Error($e(418));t=go(r.nextSibling);var n=Oi;t&&Ov(e,t)?h4(n,r):(e.flags=e.flags&-4097|2,br=!1,Oi=e)}}else{if(rg(e))throw Error($e(418));e.flags=e.flags&-4097|2,br=!1,Oi=e}}}function Dv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Oi=e}function Ch(e){if(e!==Oi)return!1;if(!br)return Dv(e),br=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Q1(e.type,e.memoizedProps)),t&&(t=Li)){if(rg(e))throw p4(),Error($e(418));for(;t;)h4(e,t),t=go(t.nextSibling)}if(Dv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error($e(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Li=go(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Li=null}}else Li=Oi?go(e.stateNode.nextSibling):null;return!0}function p4(){for(var e=Li;e;)e=go(e.nextSibling)}function Kc(){Li=Oi=null,br=!1}function y2(e){Ss===null?Ss=[e]:Ss.push(e)}var J6=Ca.ReactCurrentBatchConfig;function Qu(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error($e(309));var n=r.stateNode}if(!n)throw Error($e(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error($e(284));if(!r._owner)throw Error($e(290,e))}return e}function Ph(e,t){throw e=Object.prototype.toString.call(t),Error($e(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Iv(e){var t=e._init;return t(e._payload)}function m4(e){function t(y,w){if(e){var _=y.deletions;_===null?(y.deletions=[w],y.flags|=16):_.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=wo(y,w),y.index=0,y.sibling=null,y}function s(y,w,_){return y.index=_,e?(_=y.alternate,_!==null?(_=_.index,_<w?(y.flags|=2,w):_):(y.flags|=2,w)):(y.flags|=1048576,w)}function a(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,_,E){return w===null||w.tag!==6?(w=Km(_,y.mode,E),w.return=y,w):(w=i(w,_),w.return=y,w)}function l(y,w,_,E){var O=_.type;return O===Sc?f(y,w,_.props.children,E,_.key):w!==null&&(w.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Za&&Iv(O)===w.type)?(E=i(w,_.props),E.ref=Qu(y,w,_),E.return=y,E):(E=h0(_.type,_.key,_.props,null,y.mode,E),E.ref=Qu(y,w,_),E.return=y,E)}function u(y,w,_,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==_.containerInfo||w.stateNode.implementation!==_.implementation?(w=Xm(_,y.mode,E),w.return=y,w):(w=i(w,_.children||[]),w.return=y,w)}function f(y,w,_,E,O){return w===null||w.tag!==7?(w=fl(_,y.mode,E,O),w.return=y,w):(w=i(w,_),w.return=y,w)}function p(y,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Km(""+w,y.mode,_),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case wh:return _=h0(w.type,w.key,w.props,null,y.mode,_),_.ref=Qu(y,null,w),_.return=y,_;case _c:return w=Xm(w,y.mode,_),w.return=y,w;case Za:var E=w._init;return p(y,E(w._payload),_)}if(ff(w)||Gu(w))return w=fl(w,y.mode,_,null),w.return=y,w;Ph(y,w)}return null}function m(y,w,_,E){var O=w!==null?w.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return O!==null?null:o(y,w,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case wh:return _.key===O?l(y,w,_,E):null;case _c:return _.key===O?u(y,w,_,E):null;case Za:return O=_._init,m(y,w,O(_._payload),E)}if(ff(_)||Gu(_))return O!==null?null:f(y,w,_,E,null);Ph(y,_)}return null}function h(y,w,_,E,O){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(_)||null,o(w,y,""+E,O);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case wh:return y=y.get(E.key===null?_:E.key)||null,l(w,y,E,O);case _c:return y=y.get(E.key===null?_:E.key)||null,u(w,y,E,O);case Za:var D=E._init;return h(y,w,_,D(E._payload),O)}if(ff(E)||Gu(E))return y=y.get(_)||null,f(w,y,E,O,null);Ph(w,E)}return null}function v(y,w,_,E){for(var O=null,D=null,T=w,C=w=0,P=null;T!==null&&C<_.length;C++){T.index>C?(P=T,T=null):P=T.sibling;var R=m(y,T,_[C],E);if(R===null){T===null&&(T=P);break}e&&T&&R.alternate===null&&t(y,T),w=s(R,w,C),D===null?O=R:D.sibling=R,D=R,T=P}if(C===_.length)return r(y,T),br&&Zo(y,C),O;if(T===null){for(;C<_.length;C++)T=p(y,_[C],E),T!==null&&(w=s(T,w,C),D===null?O=T:D.sibling=T,D=T);return br&&Zo(y,C),O}for(T=n(y,T);C<_.length;C++)P=h(T,y,C,_[C],E),P!==null&&(e&&P.alternate!==null&&T.delete(P.key===null?C:P.key),w=s(P,w,C),D===null?O=P:D.sibling=P,D=P);return e&&T.forEach(function(j){return t(y,j)}),br&&Zo(y,C),O}function x(y,w,_,E){var O=Gu(_);if(typeof O!="function")throw Error($e(150));if(_=O.call(_),_==null)throw Error($e(151));for(var D=O=null,T=w,C=w=0,P=null,R=_.next();T!==null&&!R.done;C++,R=_.next()){T.index>C?(P=T,T=null):P=T.sibling;var j=m(y,T,R.value,E);if(j===null){T===null&&(T=P);break}e&&T&&j.alternate===null&&t(y,T),w=s(j,w,C),D===null?O=j:D.sibling=j,D=j,T=P}if(R.done)return r(y,T),br&&Zo(y,C),O;if(T===null){for(;!R.done;C++,R=_.next())R=p(y,R.value,E),R!==null&&(w=s(R,w,C),D===null?O=R:D.sibling=R,D=R);return br&&Zo(y,C),O}for(T=n(y,T);!R.done;C++,R=_.next())R=h(T,y,C,R.value,E),R!==null&&(e&&R.alternate!==null&&T.delete(R.key===null?C:R.key),w=s(R,w,C),D===null?O=R:D.sibling=R,D=R);return e&&T.forEach(function(A){return t(y,A)}),br&&Zo(y,C),O}function b(y,w,_,E){if(typeof _=="object"&&_!==null&&_.type===Sc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case wh:e:{for(var O=_.key,D=w;D!==null;){if(D.key===O){if(O=_.type,O===Sc){if(D.tag===7){r(y,D.sibling),w=i(D,_.props.children),w.return=y,y=w;break e}}else if(D.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Za&&Iv(O)===D.type){r(y,D.sibling),w=i(D,_.props),w.ref=Qu(y,D,_),w.return=y,y=w;break e}r(y,D);break}else t(y,D);D=D.sibling}_.type===Sc?(w=fl(_.props.children,y.mode,E,_.key),w.return=y,y=w):(E=h0(_.type,_.key,_.props,null,y.mode,E),E.ref=Qu(y,w,_),E.return=y,y=E)}return a(y);case _c:e:{for(D=_.key;w!==null;){if(w.key===D)if(w.tag===4&&w.stateNode.containerInfo===_.containerInfo&&w.stateNode.implementation===_.implementation){r(y,w.sibling),w=i(w,_.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=Xm(_,y.mode,E),w.return=y,y=w}return a(y);case Za:return D=_._init,b(y,w,D(_._payload),E)}if(ff(_))return v(y,w,_,E);if(Gu(_))return x(y,w,_,E);Ph(y,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,w!==null&&w.tag===6?(r(y,w.sibling),w=i(w,_),w.return=y,y=w):(r(y,w),w=Km(_,y.mode,E),w.return=y,y=w),a(y)):r(y,w)}return b}var Xc=m4(!0),g4=m4(!1),A0=Do(null),T0=null,Pc=null,w2=null;function b2(){w2=Pc=T0=null}function _2(e){var t=A0.current;yr(A0),e._currentValue=t}function ig(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Uc(e,t){T0=e,w2=Pc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(fi=!0),e.firstContext=null)}function rs(e){var t=e._currentValue;if(w2!==e)if(e={context:e,memoizedValue:t,next:null},Pc===null){if(T0===null)throw Error($e(308));Pc=e,T0.dependencies={lanes:0,firstContext:e}}else Pc=Pc.next=e;return t}var ol=null;function S2(e){ol===null?ol=[e]:ol.push(e)}function x4(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,S2(t)):(r.next=i.next,i.next=r),t.interleaved=r,ka(e,n)}function ka(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var eo=!1;function N2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function v4(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ya(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xo(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Wt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ka(e,r)}return i=n.interleaved,i===null?(t.next=t,S2(n)):(t.next=i.next,i.next=t),n.interleaved=t,ka(e,r)}function o0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c2(e,r)}}function Rv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function j0(e,t,r,n){var i=e.updateQueue;eo=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;a=0,f=u=l=null,o=s;do{var m=o.lane,h=o.eventTime;if((n&m)===m){f!==null&&(f=f.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,x=o;switch(m=t,h=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){p=v.call(h,p,m);break e}p=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,m=typeof v=="function"?v.call(h,p,m):v,m==null)break e;p=Er({},p,m);break e;case 2:eo=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[o]:m.push(o))}else h={eventTime:h,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=h,l=p):f=f.next=h,a|=m;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Sl|=a,e.lanes=a,e.memoizedState=p}}function Mv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error($e(191,i));i.call(n)}}}var wd={},Xs=Do(wd),Jf=Do(wd),Qf=Do(wd);function ll(e){if(e===wd)throw Error($e(174));return e}function k2(e,t){switch(mr(Qf,t),mr(Jf,e),mr(Xs,wd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:M1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=M1(t,e)}yr(Xs),mr(Xs,t)}function Jc(){yr(Xs),yr(Jf),yr(Qf)}function y4(e){ll(Qf.current);var t=ll(Xs.current),r=M1(t,e.type);t!==r&&(mr(Jf,e),mr(Xs,r))}function E2(e){Jf.current===e&&(yr(Xs),yr(Jf))}var Nr=Do(0);function C0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Hm=[];function A2(){for(var e=0;e<Hm.length;e++)Hm[e]._workInProgressVersionPrimary=null;Hm.length=0}var l0=Ca.ReactCurrentDispatcher,$m=Ca.ReactCurrentBatchConfig,_l=0,kr=null,nn=null,dn=null,P0=!1,_f=!1,Zf=0,Q6=0;function Fn(){throw Error($e(321))}function T2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Cs(e[r],t[r]))return!1;return!0}function j2(e,t,r,n,i,s){if(_l=s,kr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,l0.current=e===null||e.memoizedState===null?rk:nk,e=r(n,i),_f){s=0;do{if(_f=!1,Zf=0,25<=s)throw Error($e(301));s+=1,dn=nn=null,t.updateQueue=null,l0.current=ik,e=r(n,i)}while(_f)}if(l0.current=L0,t=nn!==null&&nn.next!==null,_l=0,dn=nn=kr=null,P0=!1,t)throw Error($e(300));return e}function C2(){var e=Zf!==0;return Zf=0,e}function qs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?kr.memoizedState=dn=e:dn=dn.next=e,dn}function ns(){if(nn===null){var e=kr.alternate;e=e!==null?e.memoizedState:null}else e=nn.next;var t=dn===null?kr.memoizedState:dn.next;if(t!==null)dn=t,nn=e;else{if(e===null)throw Error($e(310));nn=e,e={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},dn===null?kr.memoizedState=dn=e:dn=dn.next=e}return dn}function ed(e,t){return typeof t=="function"?t(e):t}function qm(e){var t=ns(),r=t.queue;if(r===null)throw Error($e(311));r.lastRenderedReducer=e;var n=nn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((_l&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=p,a=n):l=l.next=p,kr.lanes|=f,Sl|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,Cs(n,t.memoizedState)||(fi=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,kr.lanes|=s,Sl|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vm(e){var t=ns(),r=t.queue;if(r===null)throw Error($e(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Cs(s,t.memoizedState)||(fi=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function w4(){}function b4(e,t){var r=kr,n=ns(),i=t(),s=!Cs(n.memoizedState,i);if(s&&(n.memoizedState=i,fi=!0),n=n.queue,P2(N4.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||dn!==null&&dn.memoizedState.tag&1){if(r.flags|=2048,td(9,S4.bind(null,r,n,i,t),void 0,null),xn===null)throw Error($e(349));_l&30||_4(r,t,i)}return i}function _4(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=kr.updateQueue,t===null?(t={lastEffect:null,stores:null},kr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function S4(e,t,r,n){t.value=r,t.getSnapshot=n,k4(t)&&E4(e)}function N4(e,t,r){return r(function(){k4(t)&&E4(e)})}function k4(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Cs(e,r)}catch{return!0}}function E4(e){var t=ka(e,1);t!==null&&Ts(t,e,1,-1)}function Bv(e){var t=qs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ed,lastRenderedState:e},t.queue=e,e=e.dispatch=tk.bind(null,kr,e),[t.memoizedState,e]}function td(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=kr.updateQueue,t===null?(t={lastEffect:null,stores:null},kr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function A4(){return ns().memoizedState}function c0(e,t,r,n){var i=qs();kr.flags|=e,i.memoizedState=td(1|t,r,void 0,n===void 0?null:n)}function fp(e,t,r,n){var i=ns();n=n===void 0?null:n;var s=void 0;if(nn!==null){var a=nn.memoizedState;if(s=a.destroy,n!==null&&T2(n,a.deps)){i.memoizedState=td(t,r,s,n);return}}kr.flags|=e,i.memoizedState=td(1|t,r,s,n)}function Uv(e,t){return c0(8390656,8,e,t)}function P2(e,t){return fp(2048,8,e,t)}function T4(e,t){return fp(4,2,e,t)}function j4(e,t){return fp(4,4,e,t)}function C4(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function P4(e,t,r){return r=r!=null?r.concat([e]):null,fp(4,4,C4.bind(null,t,e),r)}function L2(){}function L4(e,t){var r=ns();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function F4(e,t){var r=ns();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function O4(e,t,r){return _l&21?(Cs(r,t)||(r=Bw(),kr.lanes|=r,Sl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,fi=!0),e.memoizedState=r)}function Z6(e,t){var r=nr;nr=r!==0&&4>r?r:4,e(!0);var n=$m.transition;$m.transition={};try{e(!1),t()}finally{nr=r,$m.transition=n}}function D4(){return ns().memoizedState}function ek(e,t,r){var n=yo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},I4(e))R4(t,r);else if(r=x4(e,t,r,n),r!==null){var i=Jn();Ts(r,e,n,i),M4(r,t,n)}}function tk(e,t,r){var n=yo(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(I4(e))R4(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Cs(o,a)){var l=t.interleaved;l===null?(i.next=i,S2(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=x4(e,t,i,n),r!==null&&(i=Jn(),Ts(r,e,n,i),M4(r,t,n))}}function I4(e){var t=e.alternate;return e===kr||t!==null&&t===kr}function R4(e,t){_f=P0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function M4(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c2(e,r)}}var L0={readContext:rs,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useInsertionEffect:Fn,useLayoutEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useMutableSource:Fn,useSyncExternalStore:Fn,useId:Fn,unstable_isNewReconciler:!1},rk={readContext:rs,useCallback:function(e,t){return qs().memoizedState=[e,t===void 0?null:t],e},useContext:rs,useEffect:Uv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,c0(4194308,4,C4.bind(null,t,e),r)},useLayoutEffect:function(e,t){return c0(4194308,4,e,t)},useInsertionEffect:function(e,t){return c0(4,2,e,t)},useMemo:function(e,t){var r=qs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=qs();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ek.bind(null,kr,e),[n.memoizedState,e]},useRef:function(e){var t=qs();return e={current:e},t.memoizedState=e},useState:Bv,useDebugValue:L2,useDeferredValue:function(e){return qs().memoizedState=e},useTransition:function(){var e=Bv(!1),t=e[0];return e=Z6.bind(null,e[1]),qs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=kr,i=qs();if(br){if(r===void 0)throw Error($e(407));r=r()}else{if(r=t(),xn===null)throw Error($e(349));_l&30||_4(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Uv(N4.bind(null,n,s,e),[e]),n.flags|=2048,td(9,S4.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=qs(),t=xn.identifierPrefix;if(br){var r=va,n=xa;r=(n&~(1<<32-As(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Zf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Q6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},nk={readContext:rs,useCallback:L4,useContext:rs,useEffect:P2,useImperativeHandle:P4,useInsertionEffect:T4,useLayoutEffect:j4,useMemo:F4,useReducer:qm,useRef:A4,useState:function(){return qm(ed)},useDebugValue:L2,useDeferredValue:function(e){var t=ns();return O4(t,nn.memoizedState,e)},useTransition:function(){var e=qm(ed)[0],t=ns().memoizedState;return[e,t]},useMutableSource:w4,useSyncExternalStore:b4,useId:D4,unstable_isNewReconciler:!1},ik={readContext:rs,useCallback:L4,useContext:rs,useEffect:P2,useImperativeHandle:P4,useInsertionEffect:T4,useLayoutEffect:j4,useMemo:F4,useReducer:Vm,useRef:A4,useState:function(){return Vm(ed)},useDebugValue:L2,useDeferredValue:function(e){var t=ns();return nn===null?t.memoizedState=e:O4(t,nn.memoizedState,e)},useTransition:function(){var e=Vm(ed)[0],t=ns().memoizedState;return[e,t]},useMutableSource:w4,useSyncExternalStore:b4,useId:D4,unstable_isNewReconciler:!1};function ys(e,t){if(e&&e.defaultProps){t=Er({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function sg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Er({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var dp={isMounted:function(e){return(e=e._reactInternals)?Cl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jn(),i=yo(e),s=ya(n,i);s.payload=t,r!=null&&(s.callback=r),t=xo(e,s,i),t!==null&&(Ts(t,e,i,n),o0(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jn(),i=yo(e),s=ya(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=xo(e,s,i),t!==null&&(Ts(t,e,i,n),o0(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jn(),n=yo(e),i=ya(r,n);i.tag=2,t!=null&&(i.callback=t),t=xo(e,i,n),t!==null&&(Ts(t,e,n,r),o0(t,e,n))}};function zv(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Gf(r,n)||!Gf(i,s):!0}function B4(e,t,r){var n=!1,i=ko,s=t.contextType;return typeof s=="object"&&s!==null?s=rs(s):(i=hi(t)?wl:Hn.current,n=t.contextTypes,s=(n=n!=null)?Yc(e,i):ko),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=dp,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Wv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&dp.enqueueReplaceState(t,t.state,null)}function ag(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},N2(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=rs(s):(s=hi(t)?wl:Hn.current,i.context=Yc(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(sg(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&dp.enqueueReplaceState(i,i.state,null),j0(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Qc(e,t){try{var r="",n=t;do r+=LN(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Gm(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function og(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sk=typeof WeakMap=="function"?WeakMap:Map;function U4(e,t,r){r=ya(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){O0||(O0=!0,xg=n),og(e,t)},r}function z4(e,t,r){r=ya(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){og(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){og(e,t),typeof n!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Hv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sk;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=yk.bind(null,e,t,r),t.then(e,e))}function $v(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function qv(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ya(-1,1),t.tag=2,xo(r,t,1))),r.lanes|=1),e)}var ak=Ca.ReactCurrentOwner,fi=!1;function Gn(e,t,r,n){t.child=e===null?g4(t,null,r,n):Xc(t,e.child,r,n)}function Vv(e,t,r,n,i){r=r.render;var s=t.ref;return Uc(t,i),n=j2(e,t,r,n,s,i),r=C2(),e!==null&&!fi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ea(e,t,i)):(br&&r&&x2(t),t.flags|=1,Gn(e,t,n,i),t.child)}function Gv(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!U2(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,W4(e,t,s,n,i)):(e=h0(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Gf,r(a,n)&&e.ref===t.ref)return Ea(e,t,i)}return t.flags|=1,e=wo(s,n),e.ref=t.ref,e.return=t,t.child=e}function W4(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Gf(s,n)&&e.ref===t.ref)if(fi=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(fi=!0);else return t.lanes=e.lanes,Ea(e,t,i)}return lg(e,t,r,n,i)}function H4(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mr(Fc,Ti),Ti|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mr(Fc,Ti),Ti|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,mr(Fc,Ti),Ti|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,mr(Fc,Ti),Ti|=n;return Gn(e,t,i,r),t.child}function $4(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function lg(e,t,r,n,i){var s=hi(r)?wl:Hn.current;return s=Yc(t,s),Uc(t,i),r=j2(e,t,r,n,s,i),n=C2(),e!==null&&!fi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ea(e,t,i)):(br&&n&&x2(t),t.flags|=1,Gn(e,t,r,i),t.child)}function Yv(e,t,r,n,i){if(hi(r)){var s=!0;N0(t)}else s=!1;if(Uc(t,i),t.stateNode===null)u0(e,t),B4(t,r,n),ag(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=rs(u):(u=hi(r)?wl:Hn.current,u=Yc(t,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&Wv(t,a,n,u),eo=!1;var m=t.memoizedState;a.state=m,j0(t,n,a,i),l=t.memoizedState,o!==n||m!==l||di.current||eo?(typeof f=="function"&&(sg(t,r,f,n),l=t.memoizedState),(o=eo||zv(t,r,o,n,m,l,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,v4(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ys(t.type,o),a.props=u,p=t.pendingProps,m=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=rs(l):(l=hi(r)?wl:Hn.current,l=Yc(t,l));var h=r.getDerivedStateFromProps;(f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||m!==l)&&Wv(t,a,n,l),eo=!1,m=t.memoizedState,a.state=m,j0(t,n,a,i);var v=t.memoizedState;o!==p||m!==v||di.current||eo?(typeof h=="function"&&(sg(t,r,h,n),v=t.memoizedState),(u=eo||zv(t,r,u,n,m,v,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),a.props=n,a.state=v,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return cg(e,t,r,n,s,i)}function cg(e,t,r,n,i,s){$4(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&Fv(t,r,!1),Ea(e,t,s);n=t.stateNode,ak.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Xc(t,e.child,null,s),t.child=Xc(t,null,o,s)):Gn(e,t,o,s),t.memoizedState=n.state,i&&Fv(t,r,!0),t.child}function q4(e){var t=e.stateNode;t.pendingContext?Lv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lv(e,t.context,!1),k2(e,t.containerInfo)}function Kv(e,t,r,n,i){return Kc(),y2(i),t.flags|=256,Gn(e,t,r,n),t.child}var ug={dehydrated:null,treeContext:null,retryLane:0};function fg(e){return{baseLanes:e,cachePool:null,transitions:null}}function V4(e,t,r){var n=t.pendingProps,i=Nr.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),mr(Nr,i&1),e===null)return ng(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=mp(a,n,0,null),e=fl(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=fg(r),t.memoizedState=ug,e):F2(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return ok(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=wo(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=wo(o,s):(s=fl(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?fg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=ug,n}return s=e.child,e=s.sibling,n=wo(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function F2(e,t){return t=mp({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Lh(e,t,r,n){return n!==null&&y2(n),Xc(t,e.child,null,r),e=F2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ok(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Gm(Error($e(422))),Lh(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=mp({mode:"visible",children:n.children},i,0,null),s=fl(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Xc(t,e.child,null,a),t.child.memoizedState=fg(a),t.memoizedState=ug,s);if(!(t.mode&1))return Lh(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error($e(419)),n=Gm(s,n,void 0),Lh(e,t,a,n)}if(o=(a&e.childLanes)!==0,fi||o){if(n=xn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ka(e,i),Ts(n,e,i,-1))}return B2(),n=Gm(Error($e(421))),Lh(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=wk.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Li=go(i.nextSibling),Oi=t,br=!0,Ss=null,e!==null&&(Qi[Zi++]=xa,Qi[Zi++]=va,Qi[Zi++]=bl,xa=e.id,va=e.overflow,bl=t),t=F2(t,n.children),t.flags|=4096,t)}function Xv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ig(e.return,t,r)}function Ym(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function G4(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Gn(e,t,n.children,r),n=Nr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xv(e,r,t);else if(e.tag===19)Xv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(mr(Nr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&C0(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Ym(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&C0(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Ym(t,!0,r,null,s);break;case"together":Ym(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function u0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ea(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error($e(153));if(t.child!==null){for(e=t.child,r=wo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=wo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function lk(e,t,r){switch(t.tag){case 3:q4(t),Kc();break;case 5:y4(t);break;case 1:hi(t.type)&&N0(t);break;case 4:k2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;mr(A0,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(mr(Nr,Nr.current&1),t.flags|=128,null):r&t.child.childLanes?V4(e,t,r):(mr(Nr,Nr.current&1),e=Ea(e,t,r),e!==null?e.sibling:null);mr(Nr,Nr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return G4(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),mr(Nr,Nr.current),n)break;return null;case 22:case 23:return t.lanes=0,H4(e,t,r)}return Ea(e,t,r)}var Y4,dg,K4,X4;Y4=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};dg=function(){};K4=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ll(Xs.current);var s=null;switch(r){case"input":i=O1(e,i),n=O1(e,n),s=[];break;case"select":i=Er({},i,{value:void 0}),n=Er({},n,{value:void 0}),s=[];break;case"textarea":i=R1(e,i),n=R1(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=_0)}B1(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Uf.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Uf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&xr("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};X4=function(e,t,r,n){r!==n&&(t.flags|=4)};function Zu(e,t){if(!br)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function On(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ck(e,t,r){var n=t.pendingProps;switch(v2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(t),null;case 1:return hi(t.type)&&S0(),On(t),null;case 3:return n=t.stateNode,Jc(),yr(di),yr(Hn),A2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ch(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ss!==null&&(wg(Ss),Ss=null))),dg(e,t),On(t),null;case 5:E2(t);var i=ll(Qf.current);if(r=t.type,e!==null&&t.stateNode!=null)K4(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error($e(166));return On(t),null}if(e=ll(Xs.current),Ch(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Vs]=t,n[Xf]=s,e=(t.mode&1)!==0,r){case"dialog":xr("cancel",n),xr("close",n);break;case"iframe":case"object":case"embed":xr("load",n);break;case"video":case"audio":for(i=0;i<hf.length;i++)xr(hf[i],n);break;case"source":xr("error",n);break;case"img":case"image":case"link":xr("error",n),xr("load",n);break;case"details":xr("toggle",n);break;case"input":sv(n,s),xr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},xr("invalid",n);break;case"textarea":ov(n,s),xr("invalid",n)}B1(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&jh(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&jh(n.textContent,o,e),i=["children",""+o]):Uf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&xr("scroll",n)}switch(r){case"input":bh(n),av(n,s,!0);break;case"textarea":bh(n),lv(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=_0)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Nw(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Vs]=t,e[Xf]=n,Y4(e,t,!1,!1),t.stateNode=e;e:{switch(a=U1(r,n),r){case"dialog":xr("cancel",e),xr("close",e),i=n;break;case"iframe":case"object":case"embed":xr("load",e),i=n;break;case"video":case"audio":for(i=0;i<hf.length;i++)xr(hf[i],e);i=n;break;case"source":xr("error",e),i=n;break;case"img":case"image":case"link":xr("error",e),xr("load",e),i=n;break;case"details":xr("toggle",e),i=n;break;case"input":sv(e,n),i=O1(e,n),xr("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Er({},n,{value:void 0}),xr("invalid",e);break;case"textarea":ov(e,n),i=R1(e,n),xr("invalid",e);break;default:i=n}B1(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Aw(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&kw(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&zf(e,l):typeof l=="number"&&zf(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Uf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&xr("scroll",e):l!=null&&n2(e,s,l,a))}switch(r){case"input":bh(e),av(e,n,!1);break;case"textarea":bh(e),lv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+No(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Ic(e,!!n.multiple,s,!1):n.defaultValue!=null&&Ic(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=_0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return On(t),null;case 6:if(e&&t.stateNode!=null)X4(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error($e(166));if(r=ll(Qf.current),ll(Xs.current),Ch(t)){if(n=t.stateNode,r=t.memoizedProps,n[Vs]=t,(s=n.nodeValue!==r)&&(e=Oi,e!==null))switch(e.tag){case 3:jh(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jh(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Vs]=t,t.stateNode=n}return On(t),null;case 13:if(yr(Nr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(br&&Li!==null&&t.mode&1&&!(t.flags&128))p4(),Kc(),t.flags|=98560,s=!1;else if(s=Ch(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error($e(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error($e(317));s[Vs]=t}else Kc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;On(t),s=!1}else Ss!==null&&(wg(Ss),Ss=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Nr.current&1?an===0&&(an=3):B2())),t.updateQueue!==null&&(t.flags|=4),On(t),null);case 4:return Jc(),dg(e,t),e===null&&Yf(t.stateNode.containerInfo),On(t),null;case 10:return _2(t.type._context),On(t),null;case 17:return hi(t.type)&&S0(),On(t),null;case 19:if(yr(Nr),s=t.memoizedState,s===null)return On(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Zu(s,!1);else{if(an!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=C0(e),a!==null){for(t.flags|=128,Zu(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mr(Nr,Nr.current&1|2),t.child}e=e.sibling}s.tail!==null&&Mr()>Zc&&(t.flags|=128,n=!0,Zu(s,!1),t.lanes=4194304)}else{if(!n)if(e=C0(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Zu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!br)return On(t),null}else 2*Mr()-s.renderingStartTime>Zc&&r!==1073741824&&(t.flags|=128,n=!0,Zu(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Mr(),t.sibling=null,r=Nr.current,mr(Nr,n?r&1|2:r&1),t):(On(t),null);case 22:case 23:return M2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ti&1073741824&&(On(t),t.subtreeFlags&6&&(t.flags|=8192)):On(t),null;case 24:return null;case 25:return null}throw Error($e(156,t.tag))}function uk(e,t){switch(v2(t),t.tag){case 1:return hi(t.type)&&S0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Jc(),yr(di),yr(Hn),A2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return E2(t),null;case 13:if(yr(Nr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error($e(340));Kc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yr(Nr),null;case 4:return Jc(),null;case 10:return _2(t.type._context),null;case 22:case 23:return M2(),null;case 24:return null;default:return null}}var Fh=!1,Bn=!1,fk=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Lc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Pr(e,t,n)}else r.current=null}function hg(e,t,r){try{r()}catch(n){Pr(e,t,n)}}var Jv=!1;function dk(e,t){if(X1=y0,e=t4(),g2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,p=e,m=null;t:for(;;){for(var h;p!==r||i!==0&&p.nodeType!==3||(o=a+i),p!==s||n!==0&&p.nodeType!==3||(l=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(h=p.firstChild)!==null;)m=p,p=h;for(;;){if(p===e)break t;if(m===r&&++u===i&&(o=a),m===s&&++f===n&&(l=a),(h=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(J1={focusedElem:e,selectionRange:r},y0=!1,ct=t;ct!==null;)if(t=ct,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ct=e;else for(;ct!==null;){t=ct;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,b=v.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:ys(t.type,x),b);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($e(163))}}catch(E){Pr(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,ct=e;break}ct=t.return}return v=Jv,Jv=!1,v}function Sf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&hg(t,r,s)}i=i.next}while(i!==n)}}function hp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function pg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function J4(e){var t=e.alternate;t!==null&&(e.alternate=null,J4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vs],delete t[Xf],delete t[eg],delete t[Y6],delete t[K6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Q4(e){return e.tag===5||e.tag===3||e.tag===4}function Qv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Q4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function mg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=_0));else if(n!==4&&(e=e.child,e!==null))for(mg(e,t,r),e=e.sibling;e!==null;)mg(e,t,r),e=e.sibling}function gg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(gg(e,t,r),e=e.sibling;e!==null;)gg(e,t,r),e=e.sibling}var bn=null,bs=!1;function Va(e,t,r){for(r=r.child;r!==null;)Z4(e,t,r),r=r.sibling}function Z4(e,t,r){if(Ks&&typeof Ks.onCommitFiberUnmount=="function")try{Ks.onCommitFiberUnmount(sp,r)}catch{}switch(r.tag){case 5:Bn||Lc(r,t);case 6:var n=bn,i=bs;bn=null,Va(e,t,r),bn=n,bs=i,bn!==null&&(bs?(e=bn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):bn.removeChild(r.stateNode));break;case 18:bn!==null&&(bs?(e=bn,r=r.stateNode,e.nodeType===8?zm(e.parentNode,r):e.nodeType===1&&zm(e,r),qf(e)):zm(bn,r.stateNode));break;case 4:n=bn,i=bs,bn=r.stateNode.containerInfo,bs=!0,Va(e,t,r),bn=n,bs=i;break;case 0:case 11:case 14:case 15:if(!Bn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&hg(r,t,a),i=i.next}while(i!==n)}Va(e,t,r);break;case 1:if(!Bn&&(Lc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Pr(r,t,o)}Va(e,t,r);break;case 21:Va(e,t,r);break;case 22:r.mode&1?(Bn=(n=Bn)||r.memoizedState!==null,Va(e,t,r),Bn=n):Va(e,t,r);break;default:Va(e,t,r)}}function Zv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new fk),t.forEach(function(n){var i=bk.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ps(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:bn=o.stateNode,bs=!1;break e;case 3:bn=o.stateNode.containerInfo,bs=!0;break e;case 4:bn=o.stateNode.containerInfo,bs=!0;break e}o=o.return}if(bn===null)throw Error($e(160));Z4(s,a,i),bn=null,bs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Pr(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)eb(t,e),t=t.sibling}function eb(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ps(t,e),Us(e),n&4){try{Sf(3,e,e.return),hp(3,e)}catch(x){Pr(e,e.return,x)}try{Sf(5,e,e.return)}catch(x){Pr(e,e.return,x)}}break;case 1:ps(t,e),Us(e),n&512&&r!==null&&Lc(r,r.return);break;case 5:if(ps(t,e),Us(e),n&512&&r!==null&&Lc(r,r.return),e.flags&32){var i=e.stateNode;try{zf(i,"")}catch(x){Pr(e,e.return,x)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&_w(i,s),U1(o,a);var u=U1(o,s);for(a=0;a<l.length;a+=2){var f=l[a],p=l[a+1];f==="style"?Aw(i,p):f==="dangerouslySetInnerHTML"?kw(i,p):f==="children"?zf(i,p):n2(i,f,p,u)}switch(o){case"input":D1(i,s);break;case"textarea":Sw(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Ic(i,!!s.multiple,h,!1):m!==!!s.multiple&&(s.defaultValue!=null?Ic(i,!!s.multiple,s.defaultValue,!0):Ic(i,!!s.multiple,s.multiple?[]:"",!1))}i[Xf]=s}catch(x){Pr(e,e.return,x)}}break;case 6:if(ps(t,e),Us(e),n&4){if(e.stateNode===null)throw Error($e(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(x){Pr(e,e.return,x)}}break;case 3:if(ps(t,e),Us(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qf(t.containerInfo)}catch(x){Pr(e,e.return,x)}break;case 4:ps(t,e),Us(e);break;case 13:ps(t,e),Us(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(I2=Mr())),n&4&&Zv(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Bn=(u=Bn)||f,ps(t,e),Bn=u):ps(t,e),Us(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(ct=e,f=e.child;f!==null;){for(p=ct=f;ct!==null;){switch(m=ct,h=m.child,m.tag){case 0:case 11:case 14:case 15:Sf(4,m,m.return);break;case 1:Lc(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){Pr(n,r,x)}}break;case 5:Lc(m,m.return);break;case 22:if(m.memoizedState!==null){ty(p);continue}}h!==null?(h.return=m,ct=h):ty(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,l=p.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Ew("display",a))}catch(x){Pr(e,e.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){Pr(e,e.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ps(t,e),Us(e),n&4&&Zv(e);break;case 21:break;default:ps(t,e),Us(e)}}function Us(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Q4(r)){var n=r;break e}r=r.return}throw Error($e(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(zf(i,""),n.flags&=-33);var s=Qv(e);gg(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Qv(e);mg(e,o,a);break;default:throw Error($e(161))}}catch(l){Pr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function hk(e,t,r){ct=e,tb(e)}function tb(e,t,r){for(var n=(e.mode&1)!==0;ct!==null;){var i=ct,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Fh;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Bn;o=Fh;var u=Bn;if(Fh=a,(Bn=l)&&!u)for(ct=i;ct!==null;)a=ct,l=a.child,a.tag===22&&a.memoizedState!==null?ry(i):l!==null?(l.return=a,ct=l):ry(i);for(;s!==null;)ct=s,tb(s),s=s.sibling;ct=i,Fh=o,Bn=u}ey(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ct=s):ey(e)}}function ey(e){for(;ct!==null;){var t=ct;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Bn||hp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Bn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ys(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Mv(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Mv(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&qf(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($e(163))}Bn||t.flags&512&&pg(t)}catch(m){Pr(t,t.return,m)}}if(t===e){ct=null;break}if(r=t.sibling,r!==null){r.return=t.return,ct=r;break}ct=t.return}}function ty(e){for(;ct!==null;){var t=ct;if(t===e){ct=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ct=r;break}ct=t.return}}function ry(e){for(;ct!==null;){var t=ct;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{hp(4,t)}catch(l){Pr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Pr(t,i,l)}}var s=t.return;try{pg(t)}catch(l){Pr(t,s,l)}break;case 5:var a=t.return;try{pg(t)}catch(l){Pr(t,a,l)}}}catch(l){Pr(t,t.return,l)}if(t===e){ct=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ct=o;break}ct=t.return}}var pk=Math.ceil,F0=Ca.ReactCurrentDispatcher,O2=Ca.ReactCurrentOwner,ts=Ca.ReactCurrentBatchConfig,Wt=0,xn=null,Yr=null,kn=0,Ti=0,Fc=Do(0),an=0,rd=null,Sl=0,pp=0,D2=0,Nf=null,ci=null,I2=0,Zc=1/0,pa=null,O0=!1,xg=null,vo=null,Oh=!1,oo=null,D0=0,kf=0,vg=null,f0=-1,d0=0;function Jn(){return Wt&6?Mr():f0!==-1?f0:f0=Mr()}function yo(e){return e.mode&1?Wt&2&&kn!==0?kn&-kn:J6.transition!==null?(d0===0&&(d0=Bw()),d0):(e=nr,e!==0||(e=window.event,e=e===void 0?16:Vw(e.type)),e):1}function Ts(e,t,r,n){if(50<kf)throw kf=0,vg=null,Error($e(185));xd(e,r,n),(!(Wt&2)||e!==xn)&&(e===xn&&(!(Wt&2)&&(pp|=r),an===4&&no(e,kn)),pi(e,n),r===1&&Wt===0&&!(t.mode&1)&&(Zc=Mr()+500,up&&Io()))}function pi(e,t){var r=e.callbackNode;JN(e,t);var n=v0(e,e===xn?kn:0);if(n===0)r!==null&&fv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&fv(r),t===1)e.tag===0?X6(ny.bind(null,e)):f4(ny.bind(null,e)),V6(function(){!(Wt&6)&&Io()}),r=null;else{switch(Uw(n)){case 1:r=l2;break;case 4:r=Rw;break;case 16:r=x0;break;case 536870912:r=Mw;break;default:r=x0}r=cb(r,rb.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function rb(e,t){if(f0=-1,d0=0,Wt&6)throw Error($e(327));var r=e.callbackNode;if(zc()&&e.callbackNode!==r)return null;var n=v0(e,e===xn?kn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=I0(e,n);else{t=n;var i=Wt;Wt|=2;var s=ib();(xn!==e||kn!==t)&&(pa=null,Zc=Mr()+500,ul(e,t));do try{xk();break}catch(o){nb(e,o)}while(!0);b2(),F0.current=s,Wt=i,Yr!==null?t=0:(xn=null,kn=0,t=an)}if(t!==0){if(t===2&&(i=q1(e),i!==0&&(n=i,t=yg(e,i))),t===1)throw r=rd,ul(e,0),no(e,n),pi(e,Mr()),r;if(t===6)no(e,n);else{if(i=e.current.alternate,!(n&30)&&!mk(i)&&(t=I0(e,n),t===2&&(s=q1(e),s!==0&&(n=s,t=yg(e,s))),t===1))throw r=rd,ul(e,0),no(e,n),pi(e,Mr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error($e(345));case 2:el(e,ci,pa);break;case 3:if(no(e,n),(n&130023424)===n&&(t=I2+500-Mr(),10<t)){if(v0(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Jn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Z1(el.bind(null,e,ci,pa),t);break}el(e,ci,pa);break;case 4:if(no(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-As(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Mr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*pk(n/1960))-n,10<n){e.timeoutHandle=Z1(el.bind(null,e,ci,pa),n);break}el(e,ci,pa);break;case 5:el(e,ci,pa);break;default:throw Error($e(329))}}}return pi(e,Mr()),e.callbackNode===r?rb.bind(null,e):null}function yg(e,t){var r=Nf;return e.current.memoizedState.isDehydrated&&(ul(e,t).flags|=256),e=I0(e,t),e!==2&&(t=ci,ci=r,t!==null&&wg(t)),e}function wg(e){ci===null?ci=e:ci.push.apply(ci,e)}function mk(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Cs(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function no(e,t){for(t&=~D2,t&=~pp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-As(t),n=1<<r;e[r]=-1,t&=~n}}function ny(e){if(Wt&6)throw Error($e(327));zc();var t=v0(e,0);if(!(t&1))return pi(e,Mr()),null;var r=I0(e,t);if(e.tag!==0&&r===2){var n=q1(e);n!==0&&(t=n,r=yg(e,n))}if(r===1)throw r=rd,ul(e,0),no(e,t),pi(e,Mr()),r;if(r===6)throw Error($e(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,el(e,ci,pa),pi(e,Mr()),null}function R2(e,t){var r=Wt;Wt|=1;try{return e(t)}finally{Wt=r,Wt===0&&(Zc=Mr()+500,up&&Io())}}function Nl(e){oo!==null&&oo.tag===0&&!(Wt&6)&&zc();var t=Wt;Wt|=1;var r=ts.transition,n=nr;try{if(ts.transition=null,nr=1,e)return e()}finally{nr=n,ts.transition=r,Wt=t,!(Wt&6)&&Io()}}function M2(){Ti=Fc.current,yr(Fc)}function ul(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,q6(r)),Yr!==null)for(r=Yr.return;r!==null;){var n=r;switch(v2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&S0();break;case 3:Jc(),yr(di),yr(Hn),A2();break;case 5:E2(n);break;case 4:Jc();break;case 13:yr(Nr);break;case 19:yr(Nr);break;case 10:_2(n.type._context);break;case 22:case 23:M2()}r=r.return}if(xn=e,Yr=e=wo(e.current,null),kn=Ti=t,an=0,rd=null,D2=pp=Sl=0,ci=Nf=null,ol!==null){for(t=0;t<ol.length;t++)if(r=ol[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ol=null}return e}function nb(e,t){do{var r=Yr;try{if(b2(),l0.current=L0,P0){for(var n=kr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}P0=!1}if(_l=0,dn=nn=kr=null,_f=!1,Zf=0,O2.current=null,r===null||r.return===null){an=1,rd=t,Yr=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=kn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=$v(a);if(h!==null){h.flags&=-257,qv(h,a,o,s,t),h.mode&1&&Hv(s,u,t),t=h,l=u;var v=t.updateQueue;if(v===null){var x=new Set;x.add(l),t.updateQueue=x}else v.add(l);break e}else{if(!(t&1)){Hv(s,u,t),B2();break e}l=Error($e(426))}}else if(br&&o.mode&1){var b=$v(a);if(b!==null){!(b.flags&65536)&&(b.flags|=256),qv(b,a,o,s,t),y2(Qc(l,o));break e}}s=l=Qc(l,o),an!==4&&(an=2),Nf===null?Nf=[s]:Nf.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=U4(s,l,t);Rv(s,y);break e;case 1:o=l;var w=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(vo===null||!vo.has(_)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=z4(s,o,t);Rv(s,E);break e}}s=s.return}while(s!==null)}ab(r)}catch(O){t=O,Yr===r&&r!==null&&(Yr=r=r.return);continue}break}while(!0)}function ib(){var e=F0.current;return F0.current=L0,e===null?L0:e}function B2(){(an===0||an===3||an===2)&&(an=4),xn===null||!(Sl&268435455)&&!(pp&268435455)||no(xn,kn)}function I0(e,t){var r=Wt;Wt|=2;var n=ib();(xn!==e||kn!==t)&&(pa=null,ul(e,t));do try{gk();break}catch(i){nb(e,i)}while(!0);if(b2(),Wt=r,F0.current=n,Yr!==null)throw Error($e(261));return xn=null,kn=0,an}function gk(){for(;Yr!==null;)sb(Yr)}function xk(){for(;Yr!==null&&!WN();)sb(Yr)}function sb(e){var t=lb(e.alternate,e,Ti);e.memoizedProps=e.pendingProps,t===null?ab(e):Yr=t,O2.current=null}function ab(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=uk(r,t),r!==null){r.flags&=32767,Yr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{an=6,Yr=null;return}}else if(r=ck(r,t,Ti),r!==null){Yr=r;return}if(t=t.sibling,t!==null){Yr=t;return}Yr=t=e}while(t!==null);an===0&&(an=5)}function el(e,t,r){var n=nr,i=ts.transition;try{ts.transition=null,nr=1,vk(e,t,r,n)}finally{ts.transition=i,nr=n}return null}function vk(e,t,r,n){do zc();while(oo!==null);if(Wt&6)throw Error($e(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error($e(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(QN(e,s),e===xn&&(Yr=xn=null,kn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Oh||(Oh=!0,cb(x0,function(){return zc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ts.transition,ts.transition=null;var a=nr;nr=1;var o=Wt;Wt|=4,O2.current=null,dk(e,r),eb(r,e),M6(J1),y0=!!X1,J1=X1=null,e.current=r,hk(r),HN(),Wt=o,nr=a,ts.transition=s}else e.current=r;if(Oh&&(Oh=!1,oo=e,D0=i),s=e.pendingLanes,s===0&&(vo=null),VN(r.stateNode),pi(e,Mr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(O0)throw O0=!1,e=xg,xg=null,e;return D0&1&&e.tag!==0&&zc(),s=e.pendingLanes,s&1?e===vg?kf++:(kf=0,vg=e):kf=0,Io(),null}function zc(){if(oo!==null){var e=Uw(D0),t=ts.transition,r=nr;try{if(ts.transition=null,nr=16>e?16:e,oo===null)var n=!1;else{if(e=oo,oo=null,D0=0,Wt&6)throw Error($e(331));var i=Wt;for(Wt|=4,ct=e.current;ct!==null;){var s=ct,a=s.child;if(ct.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ct=u;ct!==null;){var f=ct;switch(f.tag){case 0:case 11:case 15:Sf(8,f,s)}var p=f.child;if(p!==null)p.return=f,ct=p;else for(;ct!==null;){f=ct;var m=f.sibling,h=f.return;if(J4(f),f===u){ct=null;break}if(m!==null){m.return=h,ct=m;break}ct=h}}}var v=s.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var b=x.sibling;x.sibling=null,x=b}while(x!==null)}}ct=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ct=a;else e:for(;ct!==null;){if(s=ct,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Sf(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,ct=y;break e}ct=s.return}}var w=e.current;for(ct=w;ct!==null;){a=ct;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,ct=_;else e:for(a=w;ct!==null;){if(o=ct,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:hp(9,o)}}catch(O){Pr(o,o.return,O)}if(o===a){ct=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,ct=E;break e}ct=o.return}}if(Wt=i,Io(),Ks&&typeof Ks.onPostCommitFiberRoot=="function")try{Ks.onPostCommitFiberRoot(sp,e)}catch{}n=!0}return n}finally{nr=r,ts.transition=t}}return!1}function iy(e,t,r){t=Qc(r,t),t=U4(e,t,1),e=xo(e,t,1),t=Jn(),e!==null&&(xd(e,1,t),pi(e,t))}function Pr(e,t,r){if(e.tag===3)iy(e,e,r);else for(;t!==null;){if(t.tag===3){iy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(vo===null||!vo.has(n))){e=Qc(r,e),e=z4(t,e,1),t=xo(t,e,1),e=Jn(),t!==null&&(xd(t,1,e),pi(t,e));break}}t=t.return}}function yk(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jn(),e.pingedLanes|=e.suspendedLanes&r,xn===e&&(kn&r)===r&&(an===4||an===3&&(kn&130023424)===kn&&500>Mr()-I2?ul(e,0):D2|=r),pi(e,t)}function ob(e,t){t===0&&(e.mode&1?(t=Nh,Nh<<=1,!(Nh&130023424)&&(Nh=4194304)):t=1);var r=Jn();e=ka(e,t),e!==null&&(xd(e,t,r),pi(e,r))}function wk(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ob(e,r)}function bk(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error($e(314))}n!==null&&n.delete(t),ob(e,r)}var lb;lb=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||di.current)fi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return fi=!1,lk(e,t,r);fi=!!(e.flags&131072)}else fi=!1,br&&t.flags&1048576&&d4(t,E0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;u0(e,t),e=t.pendingProps;var i=Yc(t,Hn.current);Uc(t,r),i=j2(null,t,n,e,i,r);var s=C2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,hi(n)?(s=!0,N0(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,N2(t),i.updater=dp,t.stateNode=i,i._reactInternals=t,ag(t,n,e,r),t=cg(null,t,n,!0,s,r)):(t.tag=0,br&&s&&x2(t),Gn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(u0(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Sk(n),e=ys(n,e),i){case 0:t=lg(null,t,n,e,r);break e;case 1:t=Yv(null,t,n,e,r);break e;case 11:t=Vv(null,t,n,e,r);break e;case 14:t=Gv(null,t,n,ys(n.type,e),r);break e}throw Error($e(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),lg(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),Yv(e,t,n,i,r);case 3:e:{if(q4(t),e===null)throw Error($e(387));n=t.pendingProps,s=t.memoizedState,i=s.element,v4(e,t),j0(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Qc(Error($e(423)),t),t=Kv(e,t,n,r,i);break e}else if(n!==i){i=Qc(Error($e(424)),t),t=Kv(e,t,n,r,i);break e}else for(Li=go(t.stateNode.containerInfo.firstChild),Oi=t,br=!0,Ss=null,r=g4(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Kc(),n===i){t=Ea(e,t,r);break e}Gn(e,t,n,r)}t=t.child}return t;case 5:return y4(t),e===null&&ng(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Q1(n,i)?a=null:s!==null&&Q1(n,s)&&(t.flags|=32),$4(e,t),Gn(e,t,a,r),t.child;case 6:return e===null&&ng(t),null;case 13:return V4(e,t,r);case 4:return k2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Xc(t,null,n,r):Gn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),Vv(e,t,n,i,r);case 7:return Gn(e,t,t.pendingProps,r),t.child;case 8:return Gn(e,t,t.pendingProps.children,r),t.child;case 12:return Gn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,mr(A0,n._currentValue),n._currentValue=a,s!==null)if(Cs(s.value,a)){if(s.children===i.children&&!di.current){t=Ea(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ya(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),ig(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error($e(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),ig(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Gn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Uc(t,r),i=rs(i),n=n(i),t.flags|=1,Gn(e,t,n,r),t.child;case 14:return n=t.type,i=ys(n,t.pendingProps),i=ys(n.type,i),Gv(e,t,n,i,r);case 15:return W4(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ys(n,i),u0(e,t),t.tag=1,hi(n)?(e=!0,N0(t)):e=!1,Uc(t,r),B4(t,n,i),ag(t,n,i,r),cg(null,t,n,!0,e,r);case 19:return G4(e,t,r);case 22:return H4(e,t,r)}throw Error($e(156,t.tag))};function cb(e,t){return Iw(e,t)}function _k(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function es(e,t,r,n){return new _k(e,t,r,n)}function U2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Sk(e){if(typeof e=="function")return U2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===s2)return 11;if(e===a2)return 14}return 2}function wo(e,t){var r=e.alternate;return r===null?(r=es(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function h0(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")U2(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Sc:return fl(r.children,i,s,t);case i2:a=8,i|=8;break;case C1:return e=es(12,r,t,i|2),e.elementType=C1,e.lanes=s,e;case P1:return e=es(13,r,t,i),e.elementType=P1,e.lanes=s,e;case L1:return e=es(19,r,t,i),e.elementType=L1,e.lanes=s,e;case yw:return mp(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case xw:a=10;break e;case vw:a=9;break e;case s2:a=11;break e;case a2:a=14;break e;case Za:a=16,n=null;break e}throw Error($e(130,e==null?e:typeof e,""))}return t=es(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function fl(e,t,r,n){return e=es(7,e,n,t),e.lanes=r,e}function mp(e,t,r,n){return e=es(22,e,n,t),e.elementType=yw,e.lanes=r,e.stateNode={isHidden:!1},e}function Km(e,t,r){return e=es(6,e,null,t),e.lanes=r,e}function Xm(e,t,r){return t=es(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nk(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cm(0),this.expirationTimes=Cm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cm(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function z2(e,t,r,n,i,s,a,o,l){return e=new Nk(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=es(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},N2(s),e}function kk(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_c,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function ub(e){if(!e)return ko;e=e._reactInternals;e:{if(Cl(e)!==e||e.tag!==1)throw Error($e(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(hi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error($e(171))}if(e.tag===1){var r=e.type;if(hi(r))return u4(e,r,t)}return t}function fb(e,t,r,n,i,s,a,o,l){return e=z2(r,n,!0,e,i,s,a,o,l),e.context=ub(null),r=e.current,n=Jn(),i=yo(r),s=ya(n,i),s.callback=t??null,xo(r,s,i),e.current.lanes=i,xd(e,i,n),pi(e,n),e}function gp(e,t,r,n){var i=t.current,s=Jn(),a=yo(i);return r=ub(r),t.context===null?t.context=r:t.pendingContext=r,t=ya(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=xo(i,t,a),e!==null&&(Ts(e,i,a,s),o0(e,i,a)),a}function R0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function W2(e,t){sy(e,t),(e=e.alternate)&&sy(e,t)}function Ek(){return null}var db=typeof reportError=="function"?reportError:function(e){console.error(e)};function H2(e){this._internalRoot=e}xp.prototype.render=H2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error($e(409));gp(e,t,null,null)};xp.prototype.unmount=H2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nl(function(){gp(null,e,null,null)}),t[Na]=null}};function xp(e){this._internalRoot=e}xp.prototype.unstable_scheduleHydration=function(e){if(e){var t=Hw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ro.length&&t!==0&&t<ro[r].priority;r++);ro.splice(r,0,e),r===0&&qw(e)}};function $2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function vp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ay(){}function Ak(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=R0(a);s.call(u)}}var a=fb(t,n,e,0,null,!1,!1,"",ay);return e._reactRootContainer=a,e[Na]=a.current,Yf(e.nodeType===8?e.parentNode:e),Nl(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=R0(l);o.call(u)}}var l=z2(e,0,!1,null,null,!1,!1,"",ay);return e._reactRootContainer=l,e[Na]=l.current,Yf(e.nodeType===8?e.parentNode:e),Nl(function(){gp(t,l,r,n)}),l}function yp(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=R0(a);o.call(l)}}gp(t,a,e,i)}else a=Ak(r,t,e,i,n);return R0(a)}zw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=df(t.pendingLanes);r!==0&&(c2(t,r|1),pi(t,Mr()),!(Wt&6)&&(Zc=Mr()+500,Io()))}break;case 13:Nl(function(){var n=ka(e,1);if(n!==null){var i=Jn();Ts(n,e,1,i)}}),W2(e,1)}};u2=function(e){if(e.tag===13){var t=ka(e,134217728);if(t!==null){var r=Jn();Ts(t,e,134217728,r)}W2(e,134217728)}};Ww=function(e){if(e.tag===13){var t=yo(e),r=ka(e,t);if(r!==null){var n=Jn();Ts(r,e,t,n)}W2(e,t)}};Hw=function(){return nr};$w=function(e,t){var r=nr;try{return nr=e,t()}finally{nr=r}};W1=function(e,t,r){switch(t){case"input":if(D1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=cp(n);if(!i)throw Error($e(90));bw(n),D1(n,i)}}}break;case"textarea":Sw(e,r);break;case"select":t=r.value,t!=null&&Ic(e,!!r.multiple,t,!1)}};Cw=R2;Pw=Nl;var Tk={usingClientEntryPoint:!1,Events:[yd,Ac,cp,Tw,jw,R2]},ef={findFiberByHostInstance:al,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jk={bundleType:ef.bundleType,version:ef.version,rendererPackageName:ef.rendererPackageName,rendererConfig:ef.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ca.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ow(e),e===null?null:e.stateNode},findFiberByHostInstance:ef.findFiberByHostInstance||Ek,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dh.isDisabled&&Dh.supportsFiber)try{sp=Dh.inject(jk),Ks=Dh}catch{}}Mi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tk;Mi.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$2(t))throw Error($e(200));return kk(e,t,null,r)};Mi.createRoot=function(e,t){if(!$2(e))throw Error($e(299));var r=!1,n="",i=db;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=z2(e,1,!1,null,null,r,!1,n,i),e[Na]=t.current,Yf(e.nodeType===8?e.parentNode:e),new H2(t)};Mi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error($e(188)):(e=Object.keys(e).join(","),Error($e(268,e)));return e=Ow(t),e=e===null?null:e.stateNode,e};Mi.flushSync=function(e){return Nl(e)};Mi.hydrate=function(e,t,r){if(!vp(t))throw Error($e(200));return yp(null,e,t,!0,r)};Mi.hydrateRoot=function(e,t,r){if(!$2(e))throw Error($e(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=db;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=fb(t,null,e,1,r??null,i,!1,s,a),e[Na]=t.current,Yf(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new xp(t)};Mi.render=function(e,t,r){if(!vp(t))throw Error($e(200));return yp(null,e,t,!1,r)};Mi.unmountComponentAtNode=function(e){if(!vp(e))throw Error($e(40));return e._reactRootContainer?(Nl(function(){yp(null,null,e,!1,function(){e._reactRootContainer=null,e[Na]=null})}),!0):!1};Mi.unstable_batchedUpdates=R2;Mi.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!vp(r))throw Error($e(200));if(e==null||e._reactInternals===void 0)throw Error($e(38));return yp(e,t,r,!1,n)};Mi.version="18.3.1-next-f1338f8080-20240426";function hb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hb)}catch(e){console.error(e)}}hb(),hw.exports=Mi;var Ck=hw.exports,pb,oy=Ck;pb=oy.createRoot,oy.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nd(){return nd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nd.apply(this,arguments)}var lo;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(lo||(lo={}));const ly="popstate";function Pk(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:a,hash:o}=n.location;return bg("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:M0(i)}return Fk(t,r,null,e)}function Wr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function mb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Lk(){return Math.random().toString(36).substr(2,8)}function cy(e,t){return{usr:e.state,key:e.key,idx:t}}function bg(e,t,r,n){return r===void 0&&(r=null),nd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ou(t):t,{state:r,key:t&&t.key||n||Lk()})}function M0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ou(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Fk(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=lo.Pop,l=null,u=f();u==null&&(u=0,a.replaceState(nd({},a.state,{idx:u}),""));function f(){return(a.state||{idx:null}).idx}function p(){o=lo.Pop;let b=f(),y=b==null?null:b-u;u=b,l&&l({action:o,location:x.location,delta:y})}function m(b,y){o=lo.Push;let w=bg(x.location,b,y);u=f()+1;let _=cy(w,u),E=x.createHref(w);try{a.pushState(_,"",E)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(E)}s&&l&&l({action:o,location:x.location,delta:1})}function h(b,y){o=lo.Replace;let w=bg(x.location,b,y);u=f();let _=cy(w,u),E=x.createHref(w);a.replaceState(_,"",E),s&&l&&l({action:o,location:x.location,delta:0})}function v(b){let y=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof b=="string"?b:M0(b);return w=w.replace(/ $/,"%20"),Wr(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let x={get action(){return o},get location(){return e(i,a)},listen(b){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(ly,p),l=b,()=>{i.removeEventListener(ly,p),l=null}},createHref(b){return t(i,b)},createURL:v,encodeLocation(b){let y=v(b);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:m,replace:h,go(b){return a.go(b)}};return x}var uy;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(uy||(uy={}));function Ok(e,t,r){return r===void 0&&(r="/"),Dk(e,t,r)}function Dk(e,t,r,n){let i=typeof t=="string"?ou(t):t,s=q2(i.pathname||"/",r);if(s==null)return null;let a=gb(e);Ik(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=Yk(s);o=qk(a[l],u)}return o}function gb(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Wr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=bo([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(Wr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),gb(s.children,t,f,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:Hk(u,s.index),routesMeta:f})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of xb(s.path))i(s,a,l)}),t}function xb(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=xb(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Ik(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:$k(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Rk=/^:[\w-]+$/,Mk=3,Bk=2,Uk=1,zk=10,Wk=-2,fy=e=>e==="*";function Hk(e,t){let r=e.split("/"),n=r.length;return r.some(fy)&&(n+=Wk),t&&(n+=Bk),r.filter(i=>!fy(i)).reduce((i,s)=>i+(Rk.test(s)?Mk:s===""?Uk:zk),n)}function $k(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function qk(e,t,r){let{routesMeta:n}=e,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",p=Vk({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),m=l.route;if(!p)return null;Object.assign(i,p.params),a.push({params:i,pathname:bo([s,p.pathname]),pathnameBase:Qk(bo([s,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(s=bo([s,p.pathnameBase]))}return a}function Vk(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Gk(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,f,p)=>{let{paramName:m,isOptional:h}=f;if(m==="*"){let x=o[p]||"";a=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const v=o[p];return h&&!v?u[m]=void 0:u[m]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:e}}function Gk(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),mb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function Yk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return mb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function q2(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Kk(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?ou(e):e;return{pathname:r?r.startsWith("/")?r:Xk(r,t):t,search:Zk(n),hash:eE(i)}}function Xk(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Jm(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Jk(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function V2(e,t){let r=Jk(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function G2(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=ou(e):(i=nd({},e),Wr(!i.pathname||!i.pathname.includes("?"),Jm("?","pathname","search",i)),Wr(!i.pathname||!i.pathname.includes("#"),Jm("#","pathname","hash",i)),Wr(!i.search||!i.search.includes("#"),Jm("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let p=t.length-1;if(!n&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}o=p>=0?t[p]:"/"}let l=Kk(i,o),u=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}const bo=e=>e.join("/").replace(/\/\/+/g,"/"),Qk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Zk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const vb=["post","put","patch","delete"];new Set(vb);const rE=["get",...vb];new Set(rE);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function id(){return id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},id.apply(this,arguments)}const Y2=pe.createContext(null),nE=pe.createContext(null),Ro=pe.createContext(null),wp=pe.createContext(null),ea=pe.createContext({outlet:null,matches:[],isDataRoute:!1}),yb=pe.createContext(null);function iE(e,t){let{relative:r}=t===void 0?{}:t;lu()||Wr(!1);let{basename:n,navigator:i}=pe.useContext(Ro),{hash:s,pathname:a,search:o}=_b(e,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:bo([n,a])),i.createHref({pathname:l,search:o,hash:s})}function lu(){return pe.useContext(wp)!=null}function cu(){return lu()||Wr(!1),pe.useContext(wp).location}function wb(e){pe.useContext(Ro).static||pe.useLayoutEffect(e)}function uu(){let{isDataRoute:e}=pe.useContext(ea);return e?yE():sE()}function sE(){lu()||Wr(!1);let e=pe.useContext(Y2),{basename:t,future:r,navigator:n}=pe.useContext(Ro),{matches:i}=pe.useContext(ea),{pathname:s}=cu(),a=JSON.stringify(V2(i,r.v7_relativeSplatPath)),o=pe.useRef(!1);return wb(()=>{o.current=!0}),pe.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let p=G2(u,JSON.parse(a),s,f.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:bo([t,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[t,n,a,s,e])}const aE=pe.createContext(null);function oE(e){let t=pe.useContext(ea).outlet;return t&&pe.createElement(aE.Provider,{value:e},t)}function bb(){let{matches:e}=pe.useContext(ea),t=e[e.length-1];return t?t.params:{}}function _b(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=pe.useContext(Ro),{matches:i}=pe.useContext(ea),{pathname:s}=cu(),a=JSON.stringify(V2(i,n.v7_relativeSplatPath));return pe.useMemo(()=>G2(e,JSON.parse(a),s,r==="path"),[e,a,s,r])}function lE(e,t){return cE(e,t)}function cE(e,t,r,n){lu()||Wr(!1);let{navigator:i,static:s}=pe.useContext(Ro),{matches:a}=pe.useContext(ea),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let f=cu(),p;if(t){var m;let y=typeof t=="string"?ou(t):t;u==="/"||(m=y.pathname)!=null&&m.startsWith(u)||Wr(!1),p=y}else p=f;let h=p.pathname||"/",v=h;if(u!=="/"){let y=u.replace(/^\//,"").split("/");v="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let x=Ok(e,{pathname:v}),b=pE(x&&x.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:bo([u,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:bo([u,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,r,n);return t&&b?pe.createElement(wp.Provider,{value:{location:id({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:lo.Pop}},b):b}function uE(){let e=vE(),t=tE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return pe.createElement(pe.Fragment,null,pe.createElement("h2",null,"Unexpected Application Error!"),pe.createElement("h3",{style:{fontStyle:"italic"}},t),r?pe.createElement("pre",{style:i},r):null,null)}const fE=pe.createElement(uE,null);class dE extends pe.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?pe.createElement(ea.Provider,{value:this.props.routeContext},pe.createElement(yb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hE(e){let{routeContext:t,match:r,children:n}=e,i=pe.useContext(Y2);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),pe.createElement(ea.Provider,{value:t},n)}function pE(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=(i=r)==null?void 0:i.errors;if(o!=null){let f=a.findIndex(p=>p.route.id&&(o==null?void 0:o[p.route.id])!==void 0);f>=0||Wr(!1),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=f),p.route.id){let{loaderData:m,errors:h}=r,v=p.route.loader&&m[p.route.id]===void 0&&(!h||h[p.route.id]===void 0);if(p.route.lazy||v){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((f,p,m)=>{let h,v=!1,x=null,b=null;r&&(h=o&&p.route.id?o[p.route.id]:void 0,x=p.route.errorElement||fE,l&&(u<0&&m===0?(wE("route-fallback"),v=!0,b=null):u===m&&(v=!0,b=p.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,m+1)),w=()=>{let _;return h?_=x:v?_=b:p.route.Component?_=pe.createElement(p.route.Component,null):p.route.element?_=p.route.element:_=f,pe.createElement(hE,{match:p,routeContext:{outlet:f,matches:y,isDataRoute:r!=null},children:_})};return r&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?pe.createElement(dE,{location:r.location,revalidation:r.revalidation,component:x,error:h,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var Sb=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Sb||{}),Nb=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Nb||{});function mE(e){let t=pe.useContext(Y2);return t||Wr(!1),t}function gE(e){let t=pe.useContext(nE);return t||Wr(!1),t}function xE(e){let t=pe.useContext(ea);return t||Wr(!1),t}function kb(e){let t=xE(),r=t.matches[t.matches.length-1];return r.route.id||Wr(!1),r.route.id}function vE(){var e;let t=pe.useContext(yb),r=gE(),n=kb();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function yE(){let{router:e}=mE(Sb.UseNavigateStable),t=kb(Nb.UseNavigateStable),r=pe.useRef(!1);return wb(()=>{r.current=!0}),pe.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,id({fromRouteId:t},s)))},[e,t])}const dy={};function wE(e,t,r){dy[e]||(dy[e]=!0)}function bE(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function dl(e){let{to:t,replace:r,state:n,relative:i}=e;lu()||Wr(!1);let{future:s,static:a}=pe.useContext(Ro),{matches:o}=pe.useContext(ea),{pathname:l}=cu(),u=uu(),f=G2(t,V2(o,s.v7_relativeSplatPath),l,i==="path"),p=JSON.stringify(f);return pe.useEffect(()=>u(JSON.parse(p),{replace:r,state:n,relative:i}),[u,p,i,r,n]),null}function _E(e){return oE(e.context)}function Sr(e){Wr(!1)}function SE(e){let{basename:t="/",children:r=null,location:n,navigationType:i=lo.Pop,navigator:s,static:a=!1,future:o}=e;lu()&&Wr(!1);let l=t.replace(/^\/*/,"/"),u=pe.useMemo(()=>({basename:l,navigator:s,static:a,future:id({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=ou(n));let{pathname:f="/",search:p="",hash:m="",state:h=null,key:v="default"}=n,x=pe.useMemo(()=>{let b=q2(f,l);return b==null?null:{location:{pathname:b,search:p,hash:m,state:h,key:v},navigationType:i}},[l,f,p,m,h,v,i]);return x==null?null:pe.createElement(Ro.Provider,{value:u},pe.createElement(wp.Provider,{children:r,value:x}))}function Eb(e){let{children:t,location:r}=e;return lE(_g(t),r)}new Promise(()=>{});function _g(e,t){t===void 0&&(t=[]);let r=[];return pe.Children.forEach(e,(n,i)=>{if(!pe.isValidElement(n))return;let s=[...t,i];if(n.type===pe.Fragment){r.push.apply(r,_g(n.props.children,s));return}n.type!==Sr&&Wr(!1),!n.props.index||!n.props.children||Wr(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=_g(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sg(){return Sg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sg.apply(this,arguments)}function NE(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function kE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function EE(e,t){return e.button===0&&(!t||t==="_self")&&!kE(e)}const AE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],TE="6";try{window.__reactRouterVersion=TE}catch{}const jE="startTransition",hy=yN[jE];function CE(e){let{basename:t,children:r,future:n,window:i}=e,s=pe.useRef();s.current==null&&(s.current=Pk({window:i,v5Compat:!0}));let a=s.current,[o,l]=pe.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},f=pe.useCallback(p=>{u&&hy?hy(()=>l(p)):l(p)},[l,u]);return pe.useLayoutEffect(()=>a.listen(f),[a,f]),pe.useEffect(()=>bE(n),[n]),pe.createElement(SE,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}const PE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,on=pe.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:f,viewTransition:p}=t,m=NE(t,AE),{basename:h}=pe.useContext(Ro),v,x=!1;if(typeof u=="string"&&LE.test(u)&&(v=u,PE))try{let _=new URL(window.location.href),E=u.startsWith("//")?new URL(_.protocol+u):new URL(u),O=q2(E.pathname,h);E.origin===_.origin&&O!=null?u=O+E.search+E.hash:x=!0}catch{}let b=iE(u,{relative:i}),y=FE(u,{replace:a,state:o,target:l,preventScrollReset:f,relative:i,viewTransition:p});function w(_){n&&n(_),_.defaultPrevented||y(_)}return pe.createElement("a",Sg({},m,{href:v||b,onClick:x||s?n:w,ref:r,target:l}))});var py;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(py||(py={}));var my;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(my||(my={}));function FE(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=t===void 0?{}:t,l=uu(),u=cu(),f=_b(e,{relative:a});return pe.useCallback(p=>{if(EE(p,r)){p.preventDefault();let m=n!==void 0?n:M0(u)===M0(f);l(e,{replace:m,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[u,l,f,n,i,r,e,s,a,o])}const OE={},gy=e=>{let t;const r=new Set,n=(f,p)=>{const m=typeof f=="function"?f(t):f;if(!Object.is(m,t)){const h=t;t=p??(typeof m!="object"||m===null)?m:Object.assign({},t,m),r.forEach(v=>v(t,h))}},i=()=>t,l={setState:n,getState:i,getInitialState:()=>u,subscribe:f=>(r.add(f),()=>r.delete(f)),destroy:()=>{(OE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,i,l);return l},DE=e=>e?gy(e):gy;var Ab={exports:{}},Tb={},jb={exports:{}},Cb={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eu=pe;function IE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var RE=typeof Object.is=="function"?Object.is:IE,ME=eu.useState,BE=eu.useEffect,UE=eu.useLayoutEffect,zE=eu.useDebugValue;function WE(e,t){var r=t(),n=ME({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return UE(function(){i.value=r,i.getSnapshot=t,Qm(i)&&s({inst:i})},[e,r,t]),BE(function(){return Qm(i)&&s({inst:i}),e(function(){Qm(i)&&s({inst:i})})},[e]),zE(r),r}function Qm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!RE(e,r)}catch{return!0}}function HE(e,t){return t()}var $E=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?HE:WE;Cb.useSyncExternalStore=eu.useSyncExternalStore!==void 0?eu.useSyncExternalStore:$E;jb.exports=Cb;var qE=jb.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bp=pe,VE=qE;function GE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var YE=typeof Object.is=="function"?Object.is:GE,KE=VE.useSyncExternalStore,XE=bp.useRef,JE=bp.useEffect,QE=bp.useMemo,ZE=bp.useDebugValue;Tb.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=XE(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=QE(function(){function l(h){if(!u){if(u=!0,f=h,h=n(h),i!==void 0&&a.hasValue){var v=a.value;if(i(v,h))return p=v}return p=h}if(v=p,YE(f,h))return v;var x=n(h);return i!==void 0&&i(v,x)?(f=h,v):(f=h,p=x)}var u=!1,f,p,m=r===void 0?null:r;return[function(){return l(t())},m===null?void 0:function(){return l(m())}]},[t,r,n,i]);var o=KE(e,s[0],s[1]);return JE(function(){a.hasValue=!0,a.value=o},[o]),ZE(o),o};Ab.exports=Tb;var e8=Ab.exports;const t8=Xg(e8),Pb={},{useDebugValue:r8}=fw,{useSyncExternalStoreWithSelector:n8}=t8;let xy=!1;const i8=e=>e;function s8(e,t=i8,r){(Pb?"production":void 0)!=="production"&&r&&!xy&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),xy=!0);const n=n8(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return r8(n),n}const vy=e=>{(Pb?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?DE(e):e,r=(n,i)=>s8(t,n,i);return Object.assign(r,t),r},a8=e=>e?vy(e):vy,o8="modulepreload",l8=function(e){return"/"+e},yy={},Aa=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=l8(l),l in yy)return;yy[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":o8,u||(p.as="script"),p.crossOrigin="",p.href=l,o&&p.setAttribute("nonce",o),document.head.appendChild(p),u)return new Promise((m,h)=>{p.addEventListener("load",m),p.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},c8=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Aa(async()=>{const{default:n}=await Promise.resolve().then(()=>fu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class K2 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class u8 extends K2{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class f8 extends K2{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class d8 extends K2{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ng;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Ng||(Ng={}));var h8=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};class p8{constructor(t,{headers:r={},customFetch:n,region:i=Ng.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=c8(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return h8(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:u}).catch(v=>{throw new u8(v)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new f8(f);if(!f.ok)throw new d8(f);let m=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),h;return m==="application/json"?h=yield f.json():m==="application/octet-stream"?h=yield f.blob():m==="text/event-stream"?h=f:m==="multipart/form-data"?h=yield f.formData():h=yield f.text(),{data:h,error:null}}catch(i){return{data:null,error:i}}})}}var ui={},X2={},_p={},bd={},Sp={},Np={},m8=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},tu=m8();const g8=tu.fetch,Lb=tu.fetch.bind(tu),Fb=tu.Headers,x8=tu.Request,v8=tu.Response,fu=Object.freeze(Object.defineProperty({__proto__:null,Headers:Fb,Request:x8,Response:v8,default:Lb,fetch:g8},Symbol.toStringTag,{value:"Module"})),y8=ew(fu);var kp={};Object.defineProperty(kp,"__esModule",{value:!0});let w8=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};kp.default=w8;var Ob=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Np,"__esModule",{value:!0});const b8=Ob(y8),_8=Ob(kp);let S8=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=b8.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let u=null,f=null,p=null,m=s.status,h=s.statusText;if(s.ok){if(this.method!=="HEAD"){const y=await s.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=y:f=JSON.parse(y))}const x=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");x&&b&&b.length>1&&(p=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,p=null,m=406,h="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const x=await s.text();try{u=JSON.parse(x),Array.isArray(u)&&s.status===404&&(f=[],u=null,m=200,h="OK")}catch{s.status===404&&x===""?(m=204,h="No Content"):u={message:x}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,m=200,h="OK"),u&&this.shouldThrowOnError)throw new _8.default(u)}return{error:u,data:f,count:p,status:m,statusText:h}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};Np.default=S8;var N8=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sp,"__esModule",{value:!0});const k8=N8(Np);let E8=class extends k8.default{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Sp.default=E8;var A8=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bd,"__esModule",{value:!0});const T8=A8(Sp);let j8=class extends T8.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};bd.default=j8;var C8=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_p,"__esModule",{value:!0});const tf=C8(bd);let P8=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let s=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new tf.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const a=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new tf.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(l.length>0){const u=[...new Set(l)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new tf.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new tf.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new tf.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};_p.default=P8;var Ep={},Ap={};Object.defineProperty(Ap,"__esModule",{value:!0});Ap.version=void 0;Ap.version="0.0.0-automated";Object.defineProperty(Ep,"__esModule",{value:!0});Ep.DEFAULT_HEADERS=void 0;const L8=Ap;Ep.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${L8.version}`};var Db=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(X2,"__esModule",{value:!0});const F8=Db(_p),O8=Db(bd),D8=Ep;let I8=class Ib{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},D8.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new F8.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ib(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${t}`);let l;n||i?(a=n?"HEAD":"GET",Object.entries(r).filter(([f,p])=>p!==void 0).map(([f,p])=>[f,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([f,p])=>{o.searchParams.append(f,p)})):(a="POST",l=r);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new O8.default({method:a,url:o,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};X2.default=I8;var du=Xn&&Xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ui,"__esModule",{value:!0});ui.PostgrestError=ui.PostgrestBuilder=ui.PostgrestTransformBuilder=ui.PostgrestFilterBuilder=ui.PostgrestQueryBuilder=ui.PostgrestClient=void 0;const Rb=du(X2);ui.PostgrestClient=Rb.default;const Mb=du(_p);ui.PostgrestQueryBuilder=Mb.default;const Bb=du(bd);ui.PostgrestFilterBuilder=Bb.default;const Ub=du(Sp);ui.PostgrestTransformBuilder=Ub.default;const zb=du(Np);ui.PostgrestBuilder=zb.default;const Wb=du(kp);ui.PostgrestError=Wb.default;var R8=ui.default={PostgrestClient:Rb.default,PostgrestQueryBuilder:Mb.default,PostgrestFilterBuilder:Bb.default,PostgrestTransformBuilder:Ub.default,PostgrestBuilder:zb.default,PostgrestError:Wb.default};const{PostgrestClient:M8,PostgrestQueryBuilder:LR,PostgrestFilterBuilder:FR,PostgrestTransformBuilder:OR,PostgrestBuilder:DR,PostgrestError:IR}=R8,B8="2.11.2",U8={"X-Client-Info":`realtime-js/${B8}`},z8="1.0.0",Hb=1e4,W8=1e3;var Wc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Wc||(Wc={}));var Ei;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ei||(Ei={}));var _s;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_s||(_s={}));var kg;(function(e){e.websocket="websocket"})(kg||(kg={}));var il;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(il||(il={}));class H8{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+i));a=a+i;const l=n.decode(t.slice(a,a+s));a=a+s;const u=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class $b{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var pr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(pr||(pr={}));const wy=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,a)=>(s[a]=$8(a,e,t,i),s),{})},$8=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?qb(s,a):Eg(a)},qb=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Y8(t,r)}switch(e){case pr.bool:return q8(t);case pr.float4:case pr.float8:case pr.int2:case pr.int4:case pr.int8:case pr.numeric:case pr.oid:return V8(t);case pr.json:case pr.jsonb:return G8(t);case pr.timestamp:return K8(t);case pr.abstime:case pr.date:case pr.daterange:case pr.int4range:case pr.int8range:case pr.money:case pr.reltime:case pr.text:case pr.time:case pr.timestamptz:case pr.timetz:case pr.tsrange:case pr.tstzrange:return Eg(t);default:return Eg(t)}},Eg=e=>e,q8=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},V8=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},G8=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Y8=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>qb(t,o))}return e},K8=e=>typeof e=="string"?e.replace(" ","T"):e,Vb=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Zm{constructor(t,r,n={},i=Hb){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var by;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(by||(by={}));class Ef{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ef.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=Ef.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ef.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(u,f)=>{a[u]||(l[u]=f)}),this.map(a,(u,f)=>{const p=s[u];if(p){const m=f.map(b=>b.presence_ref),h=p.map(b=>b.presence_ref),v=f.filter(b=>h.indexOf(b.presence_ref)<0),x=p.filter(b=>m.indexOf(b.presence_ref)<0);v.length>0&&(o[u]=v),x.length>0&&(l[u]=x)}else o[u]=f}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var u;const f=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(l),f.length>0){const p=t[o].map(h=>h.presence_ref),m=f.filter(h=>p.indexOf(h.presence_ref)<0);t[o].unshift(...m)}n(o,f,l)}),this.map(a,(o,l)=>{let u=t[o];if(!u)return;const f=l.map(p=>p.presence_ref);u=u.filter(p=>f.indexOf(p.presence_ref)<0),t[o]=u,i(o,u,l),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _y;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(_y||(_y={}));var Sy;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Sy||(Sy={}));var ma;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ma||(ma={}));class J2{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ei.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Zm(this,_s.join,this.params,this.timeout),this.rejoinTimer=new $b(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ei.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ei.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ei.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ei.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_s.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Ef(this),this.broadcastEndpointURL=Vb(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(f=>t==null?void 0:t(ma.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(ma.CLOSED));const l={},u={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket.setAuth(),f===void 0){t==null||t(ma.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,h=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,v=[];for(let x=0;x<h;x++){const b=m[x],{filter:{event:y,schema:w,table:_,filter:E}}=b,O=f&&f[x];if(O&&O.event===y&&O.schema===w&&O.table===_&&O.filter===E)v.push(Object.assign(Object.assign({},b),{id:O.id}));else{this.unsubscribe(),t==null||t(ma.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(ma.SUBSCRIBED);return}}).receive("error",f=>{t==null||t(ma.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ma.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ei.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_s.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new Zm(this,_s.leave,{},t);i.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Zm(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:u,join:f}=_s;if(n&&[o,l,u,f].indexOf(a)>=0&&n!==this._joinRef())return;let m=this._onMessage(a,r,n);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(h=>{var v,x,b;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((b=(x=h.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===a}).map(h=>h.callback(m,n)):(s=this.bindings[a])===null||s===void 0||s.filter(h=>{var v,x,b,y,w,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in h){const E=h.id,O=(v=h.filter)===null||v===void 0?void 0:v.event;return E&&((x=r.ids)===null||x===void 0?void 0:x.includes(E))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const E=(w=(y=h==null?void 0:h.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return E==="*"||E===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===a}).map(h=>{if(typeof m=="object"&&"ids"in m){const v=m.data,{schema:x,table:b,commit_timestamp:y,type:w,errors:_}=v;m=Object.assign(Object.assign({},{schema:x,table:b,commit_timestamp:y,eventType:w,new:{},old:{},errors:_}),this._getPayloadRecords(v))}h.callback(m,n)})}_isClosed(){return this.state===Ei.closed}_isJoined(){return this.state===Ei.joined}_isJoining(){return this.state===Ei.joining}_isLeaving(){return this.state===Ei.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&J2.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_s.close,{},t)}_onError(t){this._on(_s.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ei.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=wy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=wy(t.columns,t.old_record)),r}}const X8=()=>{},J8=typeof WebSocket<"u",Q8=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Z8{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=U8,this.params={},this.timeout=Hb,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=X8,this.conn=null,this.sendBuffer=[],this.serializer=new H8,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>Aa(async()=>{const{default:l}=await Promise.resolve().then(()=>fu);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${kg.websocket}`,this.httpEndpoint=Vb(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,a)=>a(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new $b(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(J8){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new eA(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Aa(async()=>{const{default:t}=await import("./browser-D9Egvc4X.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:z8}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Wc.connecting:return il.Connecting;case Wc.open:return il.Open;case Wc.closing:return il.Closing;default:return il.Closed}}isConnected(){return this.connectionState()===il.Open}channel(t,r={config:{}}){const n=new J2(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(i=>{r&&i.updateJoinPayload({access_token:r}),i.joinedOnce&&i._isJoined()&&i._push(_s.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(W8,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:s,ref:a}=r;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(_s.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Q8],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class eA{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Wc.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Q2 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function fn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class tA extends Q2{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ag extends Q2{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var rA=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const Gb=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Aa(async()=>{const{default:n}=await Promise.resolve().then(()=>fu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},nA=()=>rA(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Aa(()=>Promise.resolve().then(()=>fu),void 0)).Response:Response}),Tg=e=>{if(Array.isArray(e))return e.map(r=>Tg(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Tg(n)}),t};var Pl=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const e1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),iA=(e,t,r)=>Pl(void 0,void 0,void 0,function*(){const n=yield nA();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{t(new tA(e1(i),e.status||500))}).catch(i=>{t(new Ag(e1(i),i))}):t(new Ag(e1(e),e))}),sA=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function _d(e,t,r,n,i,s){return Pl(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,sA(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>iA(l,o,n))})})}function B0(e,t,r,n){return Pl(this,void 0,void 0,function*(){return _d(e,"GET",t,r,n)})}function to(e,t,r,n,i){return Pl(this,void 0,void 0,function*(){return _d(e,"POST",t,n,i,r)})}function aA(e,t,r,n,i){return Pl(this,void 0,void 0,function*(){return _d(e,"PUT",t,n,i,r)})}function oA(e,t,r,n){return Pl(this,void 0,void 0,function*(){return _d(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Yb(e,t,r,n,i){return Pl(this,void 0,void 0,function*(){return _d(e,"DELETE",t,n,i,r)})}var li=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const lA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ny={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cA{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Gb(i)}uploadOrUpdate(t,r,n,i){return li(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Ny),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const u=this._removeEmptyFolders(r),f=this._getFinalPath(u),p=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),m=yield p.json();return p.ok?{data:{path:u,id:m.Id,fullPath:m.Key},error:null}:{data:null,error:m}}catch(s){if(fn(s))return{data:null,error:s};throw s}})}upload(t,r,n){return li(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return li(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const u=Object.assign({upsert:Ny.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const p=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:f}),m=yield p.json();return p.ok?{data:{path:s,fullPath:m.Key},error:null}:{data:null,error:m}}catch(l){if(fn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return li(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield to(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new Q2("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}update(t,r,n){return li(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return li(this,void 0,void 0,function*(){try{return{data:yield to(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}copy(t,r,n){return li(this,void 0,void 0,function*(){try{return{data:{path:(yield to(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return li(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield to(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return li(this,void 0,void 0,function*(){try{const i=yield to(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}download(t,r){return li(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield B0(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(fn(o))return{data:null,error:o};throw o}})}info(t){return li(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield B0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Tg(n),error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}exists(t){return li(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield oA(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(fn(n)&&n instanceof Ag){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return li(this,void 0,void 0,function*(){try{return{data:yield Yb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}list(t,r,n){return li(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},lA),r),{prefix:t||""});return{data:yield to(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(fn(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const uA="2.7.1",fA={"X-Client-Info":`storage-js/${uA}`};var lc=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};class dA{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},fA),r),this.fetch=Gb(n)}listBuckets(){return lc(this,void 0,void 0,function*(){try{return{data:yield B0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(fn(t))return{data:null,error:t};throw t}})}getBucket(t){return lc(this,void 0,void 0,function*(){try{return{data:yield B0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return lc(this,void 0,void 0,function*(){try{return{data:yield to(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return lc(this,void 0,void 0,function*(){try{return{data:yield aA(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return lc(this,void 0,void 0,function*(){try{return{data:yield to(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return lc(this,void 0,void 0,function*(){try{return{data:yield Yb(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(fn(r))return{data:null,error:r};throw r}})}}class hA extends dA{constructor(t,r={},n){super(t,r,n)}from(t){return new cA(this.url,this.headers,t,this.fetch)}}const pA="2.49.2";let pf="";typeof Deno<"u"?pf="deno":typeof document<"u"?pf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?pf="react-native":pf="node";const mA={"X-Client-Info":`supabase-js-${pf}/${pA}`},gA={headers:mA},xA={schema:"public"},vA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yA={};var wA=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};const bA=e=>{let t;return e?t=e:typeof fetch>"u"?t=Lb:t=fetch,(...r)=>t(...r)},_A=()=>typeof Headers>"u"?Fb:Headers,SA=(e,t,r)=>{const n=bA(r),i=_A();return(s,a)=>wA(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:u}))})};var NA=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};function kA(e){return e.replace(/\/$/,"")}function EA(e,t){const{db:r,auth:n,realtime:i,global:s}=e,{db:a,auth:o,realtime:l,global:u}=t,f={db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},u),s),accessToken:()=>NA(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const Kb="2.69.0",vc=30*1e3,jg=3,t1=jg*vc,AA="http://localhost:9999",TA="supabase.auth.token",jA={"X-Client-Info":`gotrue-js/${Kb}`},Cg="X-Supabase-Api-Version",Xb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},CA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,PA=6e5;class Z2 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function jt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class LA extends Z2{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function FA(e){return jt(e)&&e.name==="AuthApiError"}class Jb extends Z2{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Mo extends Z2{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Ja extends Mo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function OA(e){return jt(e)&&e.name==="AuthSessionMissingError"}class r1 extends Mo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ih extends Mo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Rh extends Mo{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function DA(e){return jt(e)&&e.name==="AuthImplicitGrantRedirectError"}class ky extends Mo{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pg extends Mo{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function n1(e){return jt(e)&&e.name==="AuthRetryableFetchError"}class Ey extends Mo{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Af extends Mo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const U0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ay=` 	
\r=`.split(""),IA=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ay.length;t+=1)e[Ay[t].charCodeAt(0)]=-2;for(let t=0;t<U0.length;t+=1)e[U0[t].charCodeAt(0)]=t;return e})();function Ty(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(U0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(U0[n]),t.queuedBits-=6}}function Qb(e,t,r){const n=IA[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function RA(e){const t=[],r=i=>{t.push(i)},n={queue:0,queuedBits:0};return Zb(e,i=>{Ty(i,n,r)}),Ty(null,n,r),t.join("")}function jy(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{BA(a,n,r)};for(let a=0;a<e.length;a+=1)Qb(e.charCodeAt(a),i,s);return t.join("")}function MA(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Zb(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}MA(n,t)}}function BA(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function UA(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Qb(e.charCodeAt(i),r,n);return new Uint8Array(t)}function zA(e){const t=[];return Zb(e,r=>t.push(r)),new Uint8Array(t)}function WA(e){return Math.round(Date.now()/1e3)+e}function HA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const zs=()=>typeof window<"u"&&typeof document<"u",Jo={tested:!1,writable:!1},Tf=()=>{if(!zs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Jo.tested)return Jo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Jo.tested=!0,Jo.writable=!0}catch{Jo.tested=!0,Jo.writable=!1}return Jo.writable};function $A(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const e_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Aa(async()=>{const{default:n}=await Promise.resolve().then(()=>fu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},qA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",t_=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Mh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Bh=async(e,t)=>{await e.removeItem(t)};class Tp{constructor(){this.promise=new Tp.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Tp.promiseConstructor=Promise;function i1(e){const t=e.split(".");if(t.length!==3)throw new Af("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!CA.test(t[n]))throw new Af("JWT not in base64url format");return{header:JSON.parse(jy(t[0])),payload:JSON.parse(jy(t[1])),signature:UA(t[2]),raw:{header:t[0],payload:t[1]}}}async function VA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function GA(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function YA(e){return("0"+e.toString(16)).substr(-2)}function KA(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,YA).join("")}async function XA(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function JA(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await XA(e);return RA(r)}async function cc(e,t,r=!1){const n=KA();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await t_(e,`${t}-code-verifier`,i);const s=await JA(n);return[s,n===s?"plain":"s256"]}const QA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ZA(e){const t=e.headers.get(Cg);if(!t||!t.match(QA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function eT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function tT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var rT=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const tl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),nT=[502,503,504];async function Cy(e){var t;if(!qA(e))throw new Pg(tl(e),0);if(nT.includes(e.status))throw new Pg(tl(e),e.status);let r;try{r=await e.json()}catch(s){throw new Jb(tl(s),s)}let n;const i=ZA(e);if(i&&i.getTime()>=Xb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ey(tl(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ja}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Ey(tl(r),e.status,r.weak_password.reasons);throw new LA(tl(r),e.status||500,n)}const iT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function It(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Cg]||(s[Cg]=Xb["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await sT(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function sT(e,t,r,n,i,s){const a=iT(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new Pg(tl(l),0)}if(o.ok||await Cy(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Cy(l)}}function Qa(e){var t;let r=null;cT(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=WA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Py(e){const t=Qa(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function io(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function aT(e){return{data:e,error:null}}function oT(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=rT(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function lT(e){return e}function cT(e){return e.access_token&&e.refresh_token&&e.expires_in}var uT=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class fT{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=e_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await It(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(jt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await It(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:io})}catch(n){if(jt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=uT(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await It(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:oT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(jt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await It(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:io})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},f=await It(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:lT});if(f.error)throw f.error;const p=await f.json(),m=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,h=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const x=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(v.split(";")[1].split("=")[1]);u[`${b}Page`]=x}),u.total=parseInt(m)),{data:Object.assign(Object.assign({},p),u),error:null}}catch(u){if(jt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){try{return await It(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:io})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await It(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:io})}catch(n){if(jt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await It(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:io})}catch(n){if(jt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await It(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await It(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(jt(r))return{data:null,error:r};throw r}}}const dT={getItem:e=>Tf()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Tf()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Tf()&&globalThis.localStorage.removeItem(e)}};function Ly(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function hT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const uc={debug:!!(globalThis&&Tf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class r_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class pT extends r_{}async function mT(e,t,r){uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),uc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new pT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(uc.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}hT();const gT={url:AA,storageKey:TA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:jA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Fy(e,t,r){return await r()}class sd{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=sd.nextInstanceID,sd.nextInstanceID+=1,this.instanceID>0&&zs()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},gT),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new fT({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=e_(i.fetch),this.lock=i.lock||Fy,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:zs()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=mT:this.lock=Fy,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Tf()?this.storage=dT:(this.memoryStorage={},this.storage=Ly(this.memoryStorage)):(this.memoryStorage={},this.storage=Ly(this.memoryStorage)),zs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Kb}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=$A(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),zs()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),DA(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return jt(r)?{error:r}:{error:new Jb("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Qa}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(jt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:f,password:p,options:m}=t;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await cc(this.storage,this.storageKey)),s=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:f,password:p,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:h,code_challenge_method:v},xform:Qa})}else if("phone"in t){const{phone:f,password:p,options:m}=t;s=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:p,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},channel:(i=m==null?void 0:m.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Qa})}else throw new Ih("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(jt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Py})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Py})}else throw new Ih("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new r1}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(jt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await Mh(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await It(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Qa});if(await Bh(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new r1}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(jt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Qa}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new r1}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(r){if(jt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await cc(this.storage,this.storageKey));const{error:p}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in t){const{phone:o,options:l}=t,{data:u,error:f}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f}}throw new Ih("You must provide either an email or phone number.")}catch(o){if(jt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await It(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Qa});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(jt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await cc(this.storage,this.storageKey)),await It(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:aT})}catch(s){if(jt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ja;const{error:i}=await It(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(jt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await It(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await It(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Ih("You must provide either an email or phone number and a type")}catch(r){if(jt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Mh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<t1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,u,f)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,f))})}return{data:{session:t},error:null}}const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:io}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ja}:await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:io})})}catch(r){if(jt(r))return OA(r)&&(await this._removeSession(),await Bh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Ja;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await cc(this.storage,this.storageKey));const{data:u,error:f}=await It(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:io});if(f)throw f;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(jt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ja;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=i1(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(jt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ja;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(jt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!zs())throw new Rh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Rh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ky("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Rh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ky("No code detected.");const{data:w,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=t;if(!s||!o||!a||!u)throw new Rh("No session defined in URL");const f=Math.round(Date.now()/1e3),p=parseInt(o);let m=f+p;l&&(m=parseInt(l));const h=m-f;h*1e3<=vc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${p}s`);const v=m-p;f-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,m,f):f-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,m,f);const{data:x,error:b}=await this._getUser(s);if(b)throw b;const y={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:p,expires_at:m,refresh_token:a,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(jt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Mh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(FA(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Bh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=HA(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await cc(this.storage,this.storageKey,!0));try{return await It(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(jt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(jt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,u,f;const{data:p,error:m}=s;if(m)throw m;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await It(this.fetch,"GET",h,{headers:this.headers,jwt:(f=(u=p.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return zs()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(jt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await It(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await GA(async i=>(i>0&&await VA(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await It(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Qa})),(i,s)=>{const a=200*Math.pow(2,i);return s&&n1(s)&&Date.now()+a-n<vc})}catch(n){if(this._debug(r,"error",n),jt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),zs()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Mh(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<t1;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${t1}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),n1(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ja;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Tp;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Ja;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),jt(s)){const a={session:null,error:s};return n1(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await t_(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Bh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&zs()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),vc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/vc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${vc}ms, refresh threshold is ${jg} ticks`),i<=jg&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof r_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zs()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await cc(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await It(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:u}=await It(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await It(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(jt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await It(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(jt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=i1(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(p=>p.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const f=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+PA>Date.now()))return n;const{data:i,error:s}=await It(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new Af("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(a=>a.kid===t),!n)throw new Af("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=i1(n);if(eT(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:s,header:i,signature:a},error:null}}const u=tT(i.alg),f=await this.fetchJwk(i.kid,r),p=await crypto.subtle.importKey("jwk",f,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,a,zA(`${o}.${l}`)))throw new Af("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(jt(n))return{data:null,error:n};throw n}}}sd.nextInstanceID=0;const xT=sd;class vT extends xT{constructor(t){super(t)}}var yT=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?s(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})};class wT{constructor(t,r,n){var i,s,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=kA(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:xA,realtime:yA,auth:Object.assign(Object.assign({},vA),{storageKey:l}),global:gA},f=EA(n??{},u);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=SA(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new M8(`${o}/rest/v1`,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new p8(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new hA(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return yT(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:o,debug:l},u,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vT({url:this.authUrl,headers:Object.assign(Object.assign({},p),u),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:a,lock:o,debug:l,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Z8(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const bT=(e,t,r)=>new wT(e,t,r),_T="https://egtgfkxlkdgjtnicyfxr.supabase.co",ST="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVndGdma3hsa2RnanRuaWN5ZnhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI1OTA0MzMsImV4cCI6MjA1ODE2NjQzM30.JTai6zEgGVb99zNGAoeK8wvdg3waV0hnrSCCZtyPlR0",Ge=bT(_T,ST,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),fc=async()=>{try{await Ge.auth.signOut({scope:"global"}),localStorage.clear(),sessionStorage.clear(),await new Promise(e=>setTimeout(e,100))}catch(e){throw console.error("Error killing sessions:",e),e}},Kt=a8(e=>({user:null,organization:null,error:null,initialized:!1,refreshSession:async()=>{try{const{data:t,error:r}=await Ge.auth.getSession(),n=t.session;if(r)throw r;if(n!=null&&n.user){const{data:i,error:s}=await Ge.from("users_organizations").select("organizations:organization_id(*)").eq("user_id",n.user.id).maybeSingle();if(s)throw s;if(i!=null&&i.organizations){const l=i.organizations;e({user:n.user,organization:l,error:null,initialized:!0});return}const{data:a,error:o}=await Ge.from("organizations").select().eq("owner_id",n.user.id).maybeSingle();if(o)throw o;e({user:n.user,organization:a,error:null,initialized:!0})}else e({user:null,organization:null,error:null,initialized:!0})}catch(t){console.error("Error refreshing session:",t),await fc(),e({user:null,organization:null,error:t instanceof Error?t.message:"Session expired. Please sign in again.",initialized:!0})}},signIn:async(t,r)=>{e({error:null});try{await fc();const{data:n,error:i}=await Ge.auth.signInWithPassword({email:t.trim().toLowerCase(),password:r});if(i)throw i.message==="Invalid login credentials"?new Error("Invalid email or password"):i;if(!n.user)throw new Error("No user returned from sign in");const{data:s,error:a}=await Ge.from("users_organizations").select("organizations:organization_id(*)").eq("user_id",n.user.id).maybeSingle();if(a)throw a;if(s!=null&&s.organizations){const u=s.organizations;e({user:n.user,organization:u,error:null,initialized:!0});return}const{data:o,error:l}=await Ge.from("organizations").select().eq("owner_id",n.user.id).maybeSingle();if(l)throw l;e({user:n.user,organization:o,error:null,initialized:!0})}catch(n){throw console.error("Sign in error:",n),e({user:null,organization:null,error:n instanceof Error?n.message:"Failed to sign in",initialized:!0}),n}},signUp:async(t,r,n)=>{e({error:null});try{await fc();const{data:i,error:s}=await Ge.auth.signUp({email:t.trim().toLowerCase(),password:r});if(s)throw s;if(!i.user)throw new Error("No user returned from sign up");const{data:a,error:o}=await Ge.from("organizations").insert([{name:n.trim(),owner_id:i.user.id}]).select().single();if(o)throw o;const{error:l}=await Ge.from("users_organizations").insert([{user_id:i.user.id,organization_id:a.id,role:"owner"}]);if(l)throw l;e({user:i.user,organization:a,error:null,initialized:!0})}catch(i){throw console.error("Sign up error:",i),e({user:null,organization:null,error:i instanceof Error?i.message:"Failed to sign up",initialized:!0}),i}},deleteAccount:async()=>{try{const{error:t}=await Ge.rpc("delete_user_account");if(t)throw t;await fc(),e({user:null,organization:null,error:null,initialized:!0})}catch(t){throw console.error("Delete account error:",t),e({error:t instanceof Error?t.message:"Failed to delete account",initialized:!0}),t}},signOut:async()=>{try{const{error:t}=await Ge.auth.signOut();e({user:null,organization:null,error:null,initialized:!0}),t&&await fc()}catch(t){throw console.error("Sign out error:",t),e({error:t instanceof Error?t.message:"Failed to sign out",initialized:!0}),t}},killAllSessions:fc})),NT=async()=>{try{await Kt.getState().refreshSession(),console.log("initAuth")}catch(e){console.error("Auth initialization error:",e)}};NT();Ge.auth.onAuthStateChange(async(e,t)=>{if(e==="SIGNED_OUT"){Kt.setState({user:null,organization:null,error:null,initialized:!0});return}});setInterval(async()=>{const e=Kt.getState();e.user&&await e.refreshSession()},10*60*1e3);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),yt=(e,t)=>{const r=pe.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>pe.createElement("svg",{ref:f,...kT,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${ET(e)}`,o].join(" "),...u},[...t.map(([p,m])=>pe.createElement(p,m)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ad=yt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=yt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=yt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AT=yt("BarChart4",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=yt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=yt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=yt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=yt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=yt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=yt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=yt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=yt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CT=yt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n_=yt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=yt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=yt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PT=yt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LT=yt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FT=yt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=yt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DT=yt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=yt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IT=yt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=yt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MT=yt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=yt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=yt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=yt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=yt("MinusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=yt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=yt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=yt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=yt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=yt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=yt("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=yt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=yt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=yt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=yt("SquareUserRound",[["path",{d:"M18 21a6 6 0 0 0-12 0",key:"kaz2du"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=yt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=yt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $T=yt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=yt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=yt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=yt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=yt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function qT(){const{user:e}=Kt();return e?c.jsx(dl,{to:"/dashboard",replace:!0}):c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[c.jsx("div",{className:"flex justify-center",children:c.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:c.jsx(Eo,{className:"h-8 w-8 text-blue-600"})})}),c.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sten360"}),c.jsxs("div",{className:"mt-2 text-center",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Complete Business Management Platform"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"A Sten Business Solution"})]})]}),c.jsx(_E,{})]})}function VT(e){return e&&e.country&&e.city&&e.address&&e.employee_count&&e.currency}function GT(){const[e,t]=pe.useState(""),[r,n]=pe.useState(""),[i,s]=pe.useState(!1),[a,o]=pe.useState(null),{signIn:l,user:u,organization:f}=Kt();if(u)return VT(f)?c.jsx(dl,{to:"/dashboard",replace:!0}):c.jsx(dl,{to:"/organization-setup",replace:!0});const p=async m=>{if(m.preventDefault(),!i){o(null),s(!0);try{await l(e,r)}catch(h){console.error("Sign in error:",h),o(h instanceof Error?h.message:"An error occurred during sign in"),s(!1)}}};return c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsxs("div",{className:"bg-white py-8 px-4 shadow-xl sm:rounded-lg sm:px-10",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md mb-8",children:[c.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:c.jsx(RT,{className:"h-6 w-6 text-blue-600"})}),c.jsx("h2",{className:"mt-6 text-center text-2xl font-bold tracking-tight text-gray-900",children:"Sign in to your account"})]}),a&&c.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-400 p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsx("p",{className:"text-sm text-red-700",children:a})})]})}),c.jsxs("form",{onSubmit:p,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(BT,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:m=>t(m.target.value),disabled:i,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your email"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(IT,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"password",type:"password",required:!0,value:r,onChange:m=>n(m.target.value),disabled:i,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your password"})]})]}),c.jsx("div",{children:c.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed transition-colors duration-200",children:i?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]}),c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Don't have an account?"})})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx(on,{to:"/signup",className:"font-medium text-blue-600 hover:text-blue-500 transition-colors duration-200",children:"Sign up for free"})})]})]})})}function YT(){const[e,t]=pe.useState(""),[r,n]=pe.useState(""),[i,s]=pe.useState(""),[a,o]=pe.useState(null),l=Kt(f=>f.signUp),u=async f=>{f.preventDefault();try{await l(e,r,i)}catch(p){o(p instanceof Error?p.message:"An error occurred")}};return c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[c.jsx("h2",{className:"text-2xl font-bold mb-8 text-center",children:"Create your account"}),a&&c.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:a}),c.jsxs("form",{onSubmit:u,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"organization",className:"block text-sm font-medium text-gray-700",children:"Organization name"}),c.jsx("input",{id:"organization",type:"text",required:!0,value:i,onChange:f=>s(f.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),c.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:f=>t(f.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),c.jsx("input",{id:"password",type:"password",required:!0,value:r,onChange:f=>n(f.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsx("div",{children:c.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign up"})})]}),c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Already have an account?"})})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx(on,{to:"/signin",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in instead"})})]})]})})}function c_(){const[e,t]=pe.useState({isOpen:!1,title:"",message:"",type:"info",confirmText:"Confirm",cancelText:"Cancel",resolve:null});return{confirm:s=>new Promise(a=>{t({...s,isOpen:!0,resolve:a})}),dialog:e,handleConfirm:()=>{e.resolve&&e.resolve(!0),t(s=>({...s,isOpen:!1}))},handleCancel:()=>{e.resolve&&e.resolve(!1),t(s=>({...s,isOpen:!1}))}}}function u_(){const[e,t]=pe.useState([]),r=pe.useCallback(i=>{const s=Math.random().toString(36).substr(2,9);t(a=>[...a,{...i,id:s}])},[]),n=pe.useCallback(i=>{t(s=>s.filter(a=>a.id!==i))},[]);return{toasts:e,addToast:r,removeToast:n}}function KT({isOpen:e,title:t,message:r,type:n="info",confirmText:i="Confirm",cancelText:s="Cancel",onConfirm:a,onCancel:o}){if(!e)return null;const l={danger:c.jsx(Bo,{className:"h-6 w-6 text-red-600"}),warning:c.jsx(ad,{className:"h-6 w-6 text-yellow-600"}),info:c.jsx(OT,{className:"h-6 w-6 text-blue-600"})},u={danger:{button:"bg-red-600 hover:bg-red-700 focus:ring-red-500",icon:"bg-red-100"},warning:{button:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500",icon:"bg-yellow-100"},info:{button:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",icon:"bg-blue-100"}};return c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 transition-opacity"}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:[c.jsxs("div",{className:"sm:flex sm:items-start",children:[c.jsx("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full ${u[n].icon} sm:mx-0 sm:h-10 sm:w-10`,children:l[n]}),c.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[c.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:t}),c.jsx("div",{className:"mt-2",children:c.jsx("p",{className:"text-sm text-gray-500",children:r})})]})]}),c.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse gap-3",children:[c.jsx("button",{type:"button",className:`inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm sm:w-auto ${u[n].button} focus:outline-none focus:ring-2 focus:ring-offset-2`,onClick:a,children:i}),c.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:o,children:s})]})]})})]})}function XT({id:e,type:t,title:r,message:n,duration:i=5e3,onClose:s}){pe.useEffect(()=>{if(i>0){const l=setTimeout(()=>{s(e)},i);return()=>clearTimeout(l)}},[i,e,s]);const a={success:c.jsx(Ns,{className:"h-6 w-6 text-green-400"}),error:c.jsx(Bo,{className:"h-6 w-6 text-red-400"}),warning:c.jsx(ad,{className:"h-6 w-6 text-yellow-400"}),info:c.jsx(DT,{className:"h-6 w-6 text-blue-400"})},o={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200"};return c.jsx("div",{className:`pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg border shadow-lg ${o[t]}`,children:c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"flex-shrink-0",children:a[t]}),c.jsxs("div",{className:"ml-3 w-0 flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:r}),n&&c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n})]}),c.jsx("div",{className:"ml-4 flex flex-shrink-0",children:c.jsxs("button",{type:"button",className:"inline-flex rounded-md text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>s(e),children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx(Gs,{className:"h-5 w-5"})]})})]})})})}function JT({toasts:e,onClose:t}){return c.jsx("div",{"aria-live":"assertive",className:"pointer-events-none fixed inset-0 z-50 flex flex-col items-end gap-2 px-4 py-6 sm:p-6",children:c.jsx("div",{className:"flex w-full flex-col items-end space-y-4",children:e.map(r=>c.jsx(XT,{...r,onClose:t},r.id))})})}const f_=pe.createContext(null);function QT({children:e}){const{confirm:t,dialog:r,handleConfirm:n,handleCancel:i}=c_(),{toasts:s,addToast:a,removeToast:o}=u_();return c.jsxs(f_.Provider,{value:{confirm:t,addToast:a},children:[e,c.jsx(KT,{isOpen:r.isOpen,title:r.title,message:r.message,type:r.type,confirmText:r.confirmText,cancelText:r.cancelText,onConfirm:n,onCancel:i}),c.jsx(JT,{toasts:s,onClose:o})]})}function jn(){const e=pe.useContext(f_);if(!e)throw new Error("useUI must be used within a UIProvider");return e}const Jr={GHS:{name:"Ghanaian Cedi",symbol:""},USD:{name:"US Dollar",symbol:"$"},EUR:{name:"Euro",symbol:""},GBP:{name:"British Pound",symbol:""},NGN:{name:"Nigerian Naira",symbol:""}},Uh={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},delayed:{bg:"bg-orange-100",text:"text-orange-800",hover:"hover:bg-orange-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},cancelled:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"}},Oy={pending:"Pending",in_progress:"In Progress",delayed:"Delayed",completed:"Completed",cancelled:"Cancelled"};function Kr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function To(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function ZT(e,t){const r=Kr(e);return isNaN(t)?To(e,NaN):(t&&r.setDate(r.getDate()+t),r)}const d_=6048e5,ej=864e5;let tj={};function kd(){return tj}function Di(e,t){var o,l,u,f;const r=kd(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,i=Kr(e),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function W0(e){return Di(e,{weekStartsOn:1})}function h_(e){const t=Kr(e),r=t.getFullYear(),n=To(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=W0(n),s=To(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const a=W0(s);return t.getTime()>=i.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function kl(e){const t=Kr(e);return t.setHours(0,0,0,0),t}function Dy(e){const t=Kr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function rj(e,t){const r=kl(e),n=kl(t),i=+r-Dy(r),s=+n-Dy(n);return Math.round((i-s)/ej)}function nj(e){const t=h_(e),r=To(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),W0(r)}function p_(e,t){const r=t*7;return ZT(e,r)}function ij(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function sj(e){if(!ij(e)&&typeof e!="number")return!1;const t=Kr(e);return!isNaN(Number(t))}function aj(e){const t=Kr(e);return t.setHours(23,59,59,999),t}function oj(e){const t=Kr(e),r=To(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function _o(e,t){var o,l,u,f;const r=kd(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,i=Kr(e),s=i.getDay(),a=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}const lj={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cj=(e,t,r)=>{let n;const i=lj[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function a1(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const uj={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fj={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dj={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hj={date:a1({formats:uj,defaultWidth:"full"}),time:a1({formats:fj,defaultWidth:"full"}),dateTime:a1({formats:dj,defaultWidth:"full"})},pj={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},mj=(e,t,r,n)=>pj[e];function rf(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;i=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[a]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const gj={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xj={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vj={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},yj={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wj={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},bj={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_j=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Sj={ordinalNumber:_j,era:rf({values:gj,defaultWidth:"wide"}),quarter:rf({values:xj,defaultWidth:"wide",argumentCallback:e=>e-1}),month:rf({values:vj,defaultWidth:"wide"}),day:rf({values:yj,defaultWidth:"wide"}),dayPeriod:rf({values:wj,defaultWidth:"wide",formattingValues:bj,defaultFormattingWidth:"wide"})};function nf(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const a=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?kj(o,p=>p.test(a)):Nj(o,p=>p.test(a));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const f=t.slice(a.length);return{value:u,rest:f}}}function Nj(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function kj(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Ej(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;const o=t.slice(i.length);return{value:a,rest:o}}}const Aj=/^(\d+)(th|st|nd|rd)?/i,Tj=/\d+/i,jj={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Cj={any:[/^b/i,/^(a|c)/i]},Pj={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Lj={any:[/1/i,/2/i,/3/i,/4/i]},Fj={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Oj={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Dj={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ij={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Rj={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Mj={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Bj={ordinalNumber:Ej({matchPattern:Aj,parsePattern:Tj,valueCallback:e=>parseInt(e,10)}),era:nf({matchPatterns:jj,defaultMatchWidth:"wide",parsePatterns:Cj,defaultParseWidth:"any"}),quarter:nf({matchPatterns:Pj,defaultMatchWidth:"wide",parsePatterns:Lj,defaultParseWidth:"any",valueCallback:e=>e+1}),month:nf({matchPatterns:Fj,defaultMatchWidth:"wide",parsePatterns:Oj,defaultParseWidth:"any"}),day:nf({matchPatterns:Dj,defaultMatchWidth:"wide",parsePatterns:Ij,defaultParseWidth:"any"}),dayPeriod:nf({matchPatterns:Rj,defaultMatchWidth:"any",parsePatterns:Mj,defaultParseWidth:"any"})},Uj={code:"en-US",formatDistance:cj,formatLong:hj,formatRelative:mj,localize:Sj,match:Bj,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zj(e){const t=Kr(e);return rj(t,oj(t))+1}function Wj(e){const t=Kr(e),r=+W0(t)-+nj(t);return Math.round(r/d_)+1}function m_(e,t){var f,p,m,h;const r=Kr(e),n=r.getFullYear(),i=kd(),s=(t==null?void 0:t.firstWeekContainsDate)??((p=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??i.firstWeekContainsDate??((h=(m=i.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,a=To(e,0);a.setFullYear(n+1,0,s),a.setHours(0,0,0,0);const o=Di(a,t),l=To(e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const u=Di(l,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function Hj(e,t){var o,l,u,f;const r=kd(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,i=m_(e,t),s=To(e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),Di(s,t)}function Pp(e,t){const r=Kr(e),n=+Di(r,t)-+Hj(r,t);return Math.round(n/d_)+1}function Zt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Ga={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Zt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Zt(r+1,2)},d(e,t){return Zt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Zt(e.getHours()%12||12,t.length)},H(e,t){return Zt(e.getHours(),t.length)},m(e,t){return Zt(e.getMinutes(),t.length)},s(e,t){return Zt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Zt(i,t.length)}},dc={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Iy={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Ga.y(e,t)},Y:function(e,t,r,n){const i=m_(e,n),s=i>0?i:1-i;if(t==="YY"){const a=s%100;return Zt(a,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Zt(s,t.length)},R:function(e,t){const r=h_(e);return Zt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Zt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Zt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Zt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Ga.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Zt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=Pp(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):Zt(i,t.length)},I:function(e,t,r){const n=Wj(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Zt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ga.d(e,t)},D:function(e,t,r){const n=zj(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Zt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Zt(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Zt(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return Zt(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=dc.noon:n===0?i=dc.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=dc.evening:n>=12?i=dc.afternoon:n>=4?i=dc.morning:i=dc.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Ga.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ga.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Zt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Zt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ga.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ga.s(e,t)},S:function(e,t){return Ga.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return My(n);case"XXXX":case"XX":return rl(n);case"XXXXX":case"XXX":default:return rl(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return My(n);case"xxxx":case"xx":return rl(n);case"xxxxx":case"xxx":default:return rl(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ry(n,":");case"OOOO":default:return"GMT"+rl(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ry(n,":");case"zzzz":default:return"GMT"+rl(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Zt(n,t.length)},T:function(e,t,r){const n=e.getTime();return Zt(n,t.length)}};function Ry(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+Zt(s,2)}function My(e,t){return e%60===0?(e>0?"-":"+")+Zt(Math.abs(e)/60,2):rl(e,t)}function rl(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Zt(Math.trunc(n/60),2),s=Zt(n%60,2);return r+i+t+s}const By=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},g_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},$j=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return By(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",By(n,t)).replace("{{time}}",g_(i,t))},qj={p:g_,P:$j},Vj=/^D+$/,Gj=/^Y+$/,Yj=["D","DD","YY","YYYY"];function Kj(e){return Vj.test(e)}function Xj(e){return Gj.test(e)}function Jj(e,t,r){const n=Qj(e,t,r);if(console.warn(n),Yj.includes(e))throw new RangeError(n)}function Qj(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Zj=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,eC=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tC=/^'([^]*?)'?$/,rC=/''/g,nC=/[a-zA-Z]/;function zt(e,t,r){var f,p,m,h;const n=kd(),i=n.locale??Uj,s=n.firstWeekContainsDate??((p=(f=n.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,a=n.weekStartsOn??((h=(m=n.locale)==null?void 0:m.options)==null?void 0:h.weekStartsOn)??0,o=Kr(e);if(!sj(o))throw new RangeError("Invalid time value");let l=t.match(eC).map(v=>{const x=v[0];if(x==="p"||x==="P"){const b=qj[x];return b(v,i.formatLong)}return v}).join("").match(Zj).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const x=v[0];if(x==="'")return{isToken:!1,value:iC(v)};if(Iy[x])return{isToken:!0,value:v};if(x.match(nC))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:v}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const u={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return l.map(v=>{if(!v.isToken)return v.value;const x=v.value;(Xj(x)||Kj(x))&&Jj(x,t,String(e));const b=Iy[x[0]];return b(o,x,i.localize,u)}).join("")}function iC(e){const t=e.match(tC);return t?t[1].replace(rC,"'"):e}function tx(e){return Kr(e).getFullYear()}function pl(e,t){const r=Kr(e),n=Kr(t);return r.getTime()>n.getTime()}function Uy(e,t){const r=+Kr(e),[n,i]=[+Kr(t.start),+Kr(t.end)].sort((s,a)=>s-a);return r>=n&&r<=i}function sC(e,t){return p_(e,-1)}const x_=({orderId:e,outstandingBalance:t,onPaymentRecorded:r})=>{const{addToast:n}=jn(),{organization:i}=Kt(),[s,a]=pe.useState(!1),[o,l]=pe.useState(""),[u,f]=pe.useState(""),[p,m]=pe.useState(""),[h,v]=pe.useState(!1),x=async b=>{var w;if(b.preventDefault(),!o||!u){n({type:"error",title:"Error",message:"Please fill in all required fields"});return}const y=parseFloat(o);if(isNaN(y)||y<=0){n({type:"error",title:"Error",message:"Please enter a valid payment amount"});return}if(y>t){n({type:"error",title:"Error",message:"Payment amount cannot exceed outstanding balance"});return}v(!0);try{const{error:_}=await Ge.rpc("record_payment",{p_organization_id:i==null?void 0:i.id,p_order_id:e,p_amount:y,p_payment_method:u,p_payment_reference:p||null,p_recorded_by:(w=(await Ge.auth.getUser()).data.user)==null?void 0:w.id});if(_)throw _;n({type:"success",title:"Success",message:"Payment recorded successfully"}),l(""),f(""),m(""),a(!1),r()}catch(_){n({type:"error",title:"Error",message:_.message||"Failed to record payment"})}finally{v(!1)}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>a(!0),className:"ml-2 inline-flex items-center px-3 py-1.5 border border-blue-600 text-blue-600 hover:bg-blue-50 rounded-md text-sm font-medium transition-colors",children:[c.jsx(Ao,{className:"h-4 w-4 mr-1"}),"Record Payment"]}),s&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),c.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[c.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Record Payment"}),c.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-500",children:c.jsx(Gs,{className:"h-5 w-5"})})]}),c.jsxs("form",{onSubmit:x,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount*"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),c.jsx("input",{type:"number",step:"0.01",min:"0.01",max:t,value:o,onChange:b=>l(b.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"0.00",required:!0})]}),c.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Outstanding Balance: $",t.toFixed(2)]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method*"}),c.jsxs("select",{value:u,onChange:b=>f(b.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",required:!0,children:[c.jsx("option",{value:"",children:"Select a payment method"}),c.jsx("option",{value:"cash",children:"Cash"}),c.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),c.jsx("option",{value:"credit_card",children:"Credit Card"}),c.jsx("option",{value:"check",children:"Check"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Reference"}),c.jsx("input",{type:"text",value:p,onChange:b=>m(b.target.value),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"e.g., Check number, Transaction ID"})]}),c.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300",children:h?"Recording Payment...":"Record Payment"})]})]})]})]})})]})},aC={pending:"bg-yellow-100 text-yellow-800 border-yellow-200",in_progress:"bg-blue-100 text-blue-800 border-blue-200",completed:"bg-green-100 text-green-800 border-green-200",cancelled:"bg-red-100 text-red-800 border-red-200"},zy={pending:"Pending",in_progress:"In Progress",completed:"Completed",cancelled:"Cancelled"},oC={pending:ad,in_progress:jT,completed:Ns,cancelled:Bo};function lC(){var p,m;const{id:e}=bb(),[t,r]=pe.useState(null),[n,i]=pe.useState(!0),{organization:s}=Kt(),{addToast:a}=jn(),o=s!=null&&s.currency?((p=Jr[s.currency])==null?void 0:p.symbol)||s.currency:Jr.USD.symbol;pe.useEffect(()=>{e&&l()},[e]);const l=async()=>{try{const{data:h,error:v}=await Ge.from("orders").select(`
          *,
          client:clients(name),
          workers:order_workers(
            id,
            worker_id,
            worker:workers(name),
            project:projects(name)
          ),
          items:order_items(
            id,
            product_id,
            quantity,
            unit_price,
            total_price,
            product:products(
              name,
              unit_price
            )
          ),
          payments:payments(
            id,
            amount,
            payment_method,
            payment_reference,
            created_at
          )
        `).eq("id",e).single();if(v)throw v;r(h)}catch(h){console.error("Error loading order:",h),a({type:"error",title:"Error",message:"Failed to load order details"})}finally{i(!1)}},u=async h=>{if(t)try{const{error:v}=await Ge.from("orders").update({status:h}).eq("id",t.id);if(v)throw v;r(x=>x?{...x,status:h}:null),a({type:"success",title:"Status Updated",message:`Order status updated to ${zy[h]}`})}catch(v){console.error("Error updating status:",v),a({type:"error",title:"Error",message:"Failed to update order status"})}};if(n)return c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!t)return c.jsxs("div",{className:"text-center py-12",children:[c.jsx("p",{className:"text-gray-500",children:"Order not found."}),c.jsxs(on,{to:"/dashboard/orders",className:"mt-4 inline-flex items-center text-blue-600 hover:text-blue-800",children:[c.jsx(Lg,{className:"h-4 w-4 mr-2"}),"Back to Orders"]})]});const f=oC[t.status];return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx(on,{to:"/dashboard/orders",className:"text-gray-500 hover:text-gray-700",children:c.jsx(Lg,{className:"h-5 w-5"})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Order ",t.order_number]}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created on ",zt(new Date(t.created_at),"MMM d, yyyy HH:mm")]})]})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:`px-4 py-2 rounded-full border ${aC[t.status]} flex items-center space-x-2`,children:[c.jsx(f,{className:"h-4 w-4"}),c.jsx("span",{className:"text-sm font-medium",children:zy[t.status]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{value:t.status,onChange:h=>u(h.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg py-2 pl-3 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"pending",children:"Mark as Pending"}),c.jsx("option",{value:"in_progress",children:"Mark as In Progress"}),c.jsx("option",{value:"completed",children:"Mark as Completed"}),c.jsx("option",{value:"cancelled",children:"Mark as Cancelled"})]}),c.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500",children:c.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Products"})}),c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsx("div",{className:"space-y-4",children:t.items.map(h=>c.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Qs,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:h.product.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",h.quantity]})]})]}),c.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[o," ",h.total_price.toFixed(2)]})]},h.id))}),c.jsx("div",{className:"mt-6 pt-6 border-t",children:c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Total Amount"}),c.jsxs("span",{className:"font-bold text-gray-900",children:[o," ",t.total_amount.toFixed(2)]})]})})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[c.jsx(Ao,{className:"h-5 w-5 mr-2 text-gray-500"}),"Payment Details"]}),t.payment_status!=="paid"&&c.jsx(x_,{orderId:t.id,outstandingBalance:t.outstanding_balance,onPaymentRecorded:l})]})}),c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Amount"}),c.jsxs("p",{className:"text-xl font-bold text-blue-900",children:[o," ",t==null?void 0:t.total_amount.toFixed(2)]})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[c.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Amount Paid"}),c.jsxs("p",{className:"text-xl font-bold text-green-900",children:[o," ",((t==null?void 0:t.total_amount)-((t==null?void 0:t.outstanding_balance)||0)).toFixed(2)]})]}),c.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[c.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Outstanding Balance"}),c.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[o," ",((t==null?void 0:t.outstanding_balance)||0).toFixed(2)]})]})]}),c.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-200",children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Payment Status"}),c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                    ${(t==null?void 0:t.payment_status)==="paid"?"bg-green-100 text-green-800":(t==null?void 0:t.payment_status)==="partially_paid"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:(t==null?void 0:t.payment_status)==="paid"?"Paid":(t==null?void 0:t.payment_status)==="partially_paid"?"Partially Paid":"Unpaid"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Payment History"}),t!=null&&t.payments&&t.payments.length>0?c.jsx("div",{className:"border rounded-lg divide-y",children:t.payments.map(h=>c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[o," ",h.amount.toFixed(2)]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[h.payment_method,"  ",h.payment_reference]})]}),c.jsx("div",{className:"text-right",children:c.jsx("p",{className:"text-xs text-gray-500",children:zt(new Date(h.created_at),"MMM d, yyyy h:mm a")})})]},h.id))}):c.jsx("p",{className:"text-sm text-gray-500 italic",children:"No payments recorded yet"})]})]})})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Client"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.client.name})]})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Assigned Workers"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsx("div",{className:"space-y-4",children:(m=t.workers)!=null&&m.length?t.workers.map(h=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:h.worker.name}),c.jsx("p",{className:"text-sm text-gray-500",children:h.project.name})]})]},h.id)):c.jsx("p",{className:"text-sm text-gray-500",children:"No workers assigned"})})})]}),t.due_date&&c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Due Date"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(hu,{className:"h-5 w-5 text-gray-400"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:zt(new Date(t.due_date),"MMM d, yyyy")})]})})]}),t.description&&c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx("div",{className:"px-4 py-5 sm:px-6 border-b",children:c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Description"})}),c.jsx("div",{className:"px-4 py-5 sm:p-6",children:c.jsx("p",{className:"text-sm text-gray-500",children:t.description})})]})]})]})]})}function cC({onClose:e,onSuccess:t}){var V;const[r,n]=pe.useState([]),[i,s]=pe.useState([]),[a,o]=pe.useState([]),[l,u]=pe.useState({}),[f,p]=pe.useState(null),[m,h]=pe.useState([]),[v,x]=pe.useState([]),[b,y]=pe.useState([]),[w,_]=pe.useState(""),[E,O]=pe.useState(!1),[D,T]=pe.useState({description:"",due_date:"",initial_payment:0,payment_method:""}),[C,P]=pe.useState({client:!1,products:!1,workers:!1}),{organization:R}=Kt(),{addToast:j}=jn(),A=R!=null&&R.currency?((V=Jr[R.currency])==null?void 0:V.symbol)||R.currency:Jr.USD.symbol;pe.useEffect(()=>{R!=null&&R.id&&q()},[R]),pe.useEffect(()=>{P({client:!!f,products:v.length>0,workers:b.some(Z=>Z.worker_id&&Z.project_id)})},[f,v,b]);const q=async()=>{if(R!=null&&R.id)try{const{data:Z,error:he}=await Ge.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*)
        `).eq("organization_id",R.id);if(he)throw he;n(Z||[]);const{data:k,error:I}=await Ge.from("workers").select("id, name").eq("organization_id",R.id);if(I)throw I;s(k||[]);const{data:M,error:L}=await Ge.from("products").select("*").eq("organization_id",R.id);if(L)throw L;o(M||[])}catch(Z){console.error("Error loading data:",Z),j({type:"error",title:"Error",message:"Failed to load required data"})}},J=async Z=>{try{const{data:he,error:k}=await Ge.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).eq("worker_id",Z);if(k)throw k;u(I=>({...I,[Z]:he||[]}))}catch(he){console.error("Error loading worker projects:",he),j({type:"error",title:"Error",message:"Failed to load worker projects"})}},te=async Z=>{var k;if(Z.preventDefault(),!f||v.length===0||!b.some(I=>I.worker_id&&I.project_id)){j({type:"error",title:"Validation Error",message:"Please select a client, at least one product, and assign at least one worker with a project."});return}if(!(R!=null&&R.id)){j({type:"error",title:"Error",message:"Organization information is missing."});return}const he=v.reduce((I,{product:M,quantity:L})=>I+M.unit_price*L,0);if(D.initial_payment>he){j({type:"error",title:"Validation Error",message:"Initial payment cannot be greater than the total amount."});return}O(!0);try{const I=await Ge.auth.getUser();if(!((k=I.data.user)!=null&&k.id))throw new Error("User not authenticated");const{data:M,error:L}=await Ge.rpc("create_order_with_products",{p_organization_id:R.id,p_client_id:f.id,p_description:D.description.trim()||null,p_due_date:D.due_date||null,p_total_amount:he,p_workers:b.filter(H=>H.worker_id&&H.project_id).map(H=>({worker_id:H.worker_id,project_id:H.project_id})),p_products:v.map(({product:H,quantity:se})=>({product_id:H.id,quantity:se,unit_price:H.unit_price,total_price:H.unit_price*se})),p_custom_fields:m});if(L)throw L;if(!M)throw new Error("Failed to create order");if(D.initial_payment>0&&D.payment_method){const{error:H}=await Ge.rpc("record_payment",{p_organization_id:R.id,p_order_id:M.id,p_amount:D.initial_payment,p_payment_method:D.payment_method,p_payment_reference:`Initial payment for order ${M.order_number}`,p_recorded_by:I.data.user.id});if(H)throw H}j({type:"success",title:"Order Created",message:"The order has been created successfully."}),t(),e()}catch(I){console.error("Error creating order:",I),j({type:"error",title:"Error",message:I instanceof Error?I.message:"Failed to create order. Please try again."})}finally{O(!1)}},z=r.filter(Z=>Z.name.toLowerCase().includes(w.toLowerCase())),B=(Z,he,k)=>{x(I=>{const M=I.find(L=>L.product.id===Z.id);return he==="add"&&!M?[...I,{product:Z,quantity:1}]:he==="remove"?I.filter(L=>L.product.id!==Z.id):he==="update"&&k!==void 0?I.map(L=>L.product.id===Z.id?{...L,quantity:Math.max(1,k)}:L):I})},G=v.reduce((Z,{product:he,quantity:k})=>Z+he.unit_price*k,0);return c.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-auto overflow-y-auto max-h-[90vh] border border-gray-100",children:c.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-8 py-6 border-b",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Order"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Fill in the order details below"})]}),c.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-400 hover:text-gray-500 hover:bg-white rounded-full transition-colors duration-200",children:c.jsx(Gs,{className:"h-5 w-5"})})]}),c.jsxs("form",{onSubmit:te,className:"space-y-8",children:[c.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[c.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"1"}),"General Order Info"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800",children:"Select Client *"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsxs("div",{className:"relative",children:[c.jsx(hl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:w,onChange:Z=>_(Z.target.value),placeholder:"Search clients by name...",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400"})]}),w&&c.jsx("div",{className:"absolute z-10 mt-2 w-full bg-white shadow-xl rounded-lg border border-gray-200 max-h-60 overflow-auto divide-y divide-gray-100",children:z.map(Z=>c.jsxs("button",{type:"button",onClick:()=>{var he;p(Z),_(""),h(((he=Z.custom_fields)==null?void 0:he.map(k=>k.id))||[])},className:"w-full text-left px-4 py-3 hover:bg-blue-50 transition-colors duration-150 flex items-center space-x-3",children:[c.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:c.jsx(hl,{className:"h-4 w-4 text-blue-600"})}),c.jsx("div",{children:Z.name})]},Z.id))})]}),f&&!w&&c.jsxs("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg flex items-center justify-between animate-fadeIn shadow-sm",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center",children:c.jsx(hl,{className:"h-5 w-5 text-blue-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("span",{className:"text-sm font-semibold text-blue-900",children:f.name}),c.jsx("p",{className:"text-xs text-blue-600 mt-0.5",children:"Selected Client"})]})]}),c.jsx("button",{type:"button",onClick:()=>p(null),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-full transition-colors duration-200",children:c.jsx(Gs,{className:"h-4 w-4"})})]}),(f==null?void 0:f.custom_fields)&&f.custom_fields.length>0&&c.jsxs("div",{className:"mt-6 animate-fadeIn",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Fields"}),c.jsx("div",{className:"space-y-2",children:f.custom_fields.map(Z=>c.jsxs("label",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",checked:m.includes(Z.id),onChange:he=>{he.target.checked?h(k=>[...k,Z.id]):h(k=>k.filter(I=>I!==Z.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsx("span",{className:"text-sm text-gray-900",children:Z.title})]},Z.id))})]}),c.jsxs("div",{className:"mt-6 space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800",children:"Assign Workers"}),c.jsxs("button",{type:"button",onClick:()=>y([...b,{worker_id:"",project_id:""}]),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Worker"]})]}),b.map((Z,he)=>{var k;return c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("select",{value:Z.worker_id||"",onChange:I=>{const M=I.target.value;M&&J(M);const L=[...b];L[he]={...L[he],worker_id:M,project_id:""},y(L)},className:"block w-full px-3 py-2 border border-gray-300 rounded-md",children:[c.jsx("option",{value:"",children:"Select Worker"}),i.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})}),c.jsx("div",{className:"flex-1",children:c.jsxs("select",{value:Z.project_id||"",onChange:I=>{const M=[...b];M[he].project_id=I.target.value,y(M)},disabled:!Z.worker_id,className:"block w-full px-3 py-2 border border-gray-300 rounded-md",children:[c.jsx("option",{value:"",children:"Select Project"}),Z.worker_id&&((k=l[Z.worker_id])==null?void 0:k.map(I=>c.jsx("option",{value:I.project_id,children:I.project.name},I.project_id)))]})}),c.jsx("button",{type:"button",onClick:()=>{const I=b.filter((M,L)=>L!==he);y(I)},className:"p-2 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:c.jsx(Gs,{className:"h-5 w-5"})})]},he)})]}),c.jsxs("div",{className:"mt-6",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Description"}),c.jsxs("div",{className:"relative",children:[c.jsx(LT,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),c.jsx("textarea",{value:D.description,onChange:Z=>T(he=>({...he,description:Z.target.value})),rows:3,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400 resize-none",placeholder:"Enter order description"})]})]}),c.jsxs("div",{className:"mt-6",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Due Date"}),c.jsxs("div",{className:"relative",children:[c.jsx(hu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"date",value:D.due_date,onChange:Z=>T(he=>({...he,due_date:Z.target.value})),min:zt(new Date,"yyyy-MM-dd"),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400"})]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[c.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"2"}),"Products"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:a.map(Z=>{const he=v.find(k=>k.product.id===Z.id);return c.jsx("div",{className:`p-4 rounded-lg border ${he?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:Z.name}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[A," ",Z.unit_price.toFixed(2)]})]}),he?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{type:"button",onClick:()=>B(Z,"update",he.quantity-1),className:"p-1 text-gray-400 hover:text-gray-600",children:c.jsx(a_,{className:"h-4 w-4"})}),c.jsx("span",{className:"text-gray-900 min-w-[2rem] text-center",children:he.quantity}),c.jsx("button",{type:"button",onClick:()=>B(Z,"update",he.quantity+1),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:c.jsx(pn,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",onClick:()=>B(Z,"remove"),className:"p-1 text-red-400 hover:text-red-600",children:c.jsx(Gs,{className:"h-4 w-4"})})]}):c.jsx("button",{type:"button",onClick:()=>B(Z,"add"),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-full transition-all duration-200",children:c.jsx(pn,{className:"h-4 w-4"})})]})},Z.id)})}),v.length>0&&c.jsx("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg shadow-sm",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),c.jsxs("span",{className:"text-xl font-bold text-blue-600",children:[A," ",G.toFixed(2)]})]})})]})]}),c.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[c.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 mr-3 font-bold",children:"3"}),"Payment Details"]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Order Amount"}),c.jsxs("span",{className:"text-xl font-bold text-blue-600",children:[A," ",G.toFixed(2)]})]})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Initial Payment (Optional)"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ao,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"number",min:"0",max:G,step:"0.01",value:D.initial_payment,onChange:Z=>T(he=>({...he,initial_payment:parseFloat(Z.target.value)||0})),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400",placeholder:"Enter initial payment amount"})]})]}),D.initial_payment>0&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Payment Method *"}),c.jsxs("div",{className:"relative",children:[c.jsx(n_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsxs("select",{value:D.payment_method,onChange:Z=>T(he=>({...he,payment_method:Z.target.value})),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white transition-all duration-200 hover:border-blue-400",required:D.initial_payment>0,children:[c.jsx("option",{value:"",children:"Select Payment Method"}),c.jsx("option",{value:"mobile_money",children:"Mobile Money"}),c.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),c.jsx("option",{value:"cash",children:"Cash"}),c.jsx("option",{value:"other",children:"Other"})]})]})]}),D.initial_payment>0&&c.jsx("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-100 rounded-lg",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outstanding Balance"}),c.jsxs("span",{className:"text-xl font-bold text-green-600",children:[A," ",(G-D.initial_payment).toFixed(2)]})]})})]})]}),c.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:e,className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:E||!f,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:E?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Order..."]}):c.jsxs(c.Fragment,{children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Create Order"]})})]}),c.jsxs("div",{className:"mt-4 space-y-2",children:[c.jsx("div",{className:`text-sm ${C.client?"text-green-600":"text-gray-500"}`,children:C.client?" Client selected":"Client not selected"}),c.jsx("div",{className:`text-sm ${C.products?"text-green-600":"text-gray-500"}`,children:C.products?" Products selected":"No products selected"}),c.jsx("div",{className:`text-sm ${C.workers?"text-green-600":"text-gray-500"}`,children:C.workers?" Workers assigned":"No workers assigned"})]})]})]})})}function uC(){var P;const[e,t]=pe.useState([]),[r,n]=pe.useState(!0),[i,s]=pe.useState(""),[a,o]=pe.useState("all"),[l,u]=pe.useState(!1),[f,p]=pe.useState(new Date),m=Di(f,{weekStartsOn:1}),h=_o(f,{weekStartsOn:1}),v=new Date,x=Pp(f,{weekStartsOn:1}),b=tx(f),{organization:y}=Kt(),{confirm:w,addToast:_}=jn(),E=y!=null&&y.currency?((P=Jr[y.currency])==null?void 0:P.symbol)||y.currency:"";pe.useEffect(()=>{y&&O()},[y,f]);const O=async()=>{if(y!=null&&y.id)try{const{data:R,error:j}=await Ge.from("orders").select(`
          *,
          client:clients(name),
          workers:order_workers(
            id,
            worker_id,
            worker:workers(name),
            project_id,
            project:projects(name),
            status
          ),
          items:order_items(
            id,
            product_id,
            quantity,
            unit_price,
            total_price,
            product:products(
              name,
              unit_price
            )
          ),
          outstanding_balance,
          payment_status
        `).eq("organization_id",y.id).gte("created_at",m.toISOString()).lte("created_at",h.toISOString()).order("created_at",{ascending:!1});if(j)throw j;t(R||[])}catch(R){console.error("Error loading orders:",R),_({type:"error",title:"Error",message:"Failed to load orders"})}finally{n(!1)}},D=async R=>{if(await w({title:"Delete Order",message:"Are you sure you want to delete this order? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:A}=await Ge.from("orders").delete().eq("id",R);if(A)throw A;t(q=>q.filter(J=>J.id!==R)),_({type:"success",title:"Order Deleted",message:"The order has been deleted successfully."})}catch(A){console.error("Error deleting order:",A),_({type:"error",title:"Error",message:"Failed to delete order. Please try again."})}},T=R=>{p(j=>{const A=new Date(j);return R==="prev"?A.setDate(A.getDate()-7):A.setDate(A.getDate()+7),A})},C=e.filter(R=>R.client.name.toLowerCase().includes(i.toLowerCase())&&(a==="all"||R.status===a));return r?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage and track your customer orders"})]}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Create Order"]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>T("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:c.jsx(jp,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"text-sm",children:[c.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",x,", ",b]}),c.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[zt(m,"MMM d")," - ",zt(h,"MMM d")]})]}),c.jsx("button",{onClick:()=>T("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:pl(h,v),children:c.jsx(Cp,{className:"h-5 w-5 text-gray-600"})})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[e.length," orders this week"]})]})}),l&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl",children:c.jsx(cC,{onClose:()=>u(!1),onSuccess:O})})]})}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50"}`,children:"All Orders"}),Object.entries(Oy).map(([R,j])=>c.jsx("button",{onClick:()=>o(R),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a===R?`${Uh[R].bg} ${Uh[R].text}`:"text-gray-500 hover:bg-gray-50"}`,children:j},R))]}),c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Nd,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:R=>s(R.target.value),placeholder:"Search orders...",className:"ml-2 flex-1 outline-none bg-transparent"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:C.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No orders found. Start by creating a new order."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Workers"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Products"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(R=>{var j;return c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm font-medium text-gray-900",children:c.jsx(on,{to:`/dashboard/orders/${R.id}`,className:"text-blue-600 hover:text-blue-800",children:R.order_number})})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400 mr-2"}),c.jsx("div",{className:"text-sm font-medium text-gray-900",children:R.client.name})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm text-gray-900",children:(j=R.workers)!=null&&j.length?R.workers.map(A=>A.worker.name).join(", "):"Unassigned"})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"flex flex-col space-y-1",children:R.items.map(A=>c.jsxs("div",{className:"flex items-center text-sm",children:[c.jsx(Qs,{className:"h-4 w-4 text-gray-400 mr-2"}),c.jsx("span",{className:"text-gray-900",children:A.product.name}),c.jsxs("span",{className:"text-gray-500 ml-2",children:[" ",A.quantity]})]},A.id))})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[c.jsx(hu,{className:"h-4 w-4 text-gray-400 mr-2"}),R.due_date?zt(new Date(R.due_date),"MMM d, yyyy"):"No due date"]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Uh[R.status].bg} ${Uh[R.status].text}`,children:Oy[R.status]})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[E," ",R.total_amount.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("span",{className:`text-sm font-medium ${R.payment_status==="paid"?"text-green-600":R.payment_status==="partially_paid"?"text-orange-600":"text-red-600"}`,children:[E," ",R.outstanding_balance.toFixed(2)]}),c.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:R.payment_status==="paid"?"Paid":R.payment_status==="partially_paid"?"Partially Paid":"Unpaid"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(on,{to:`/dashboard/orders/${R.id}`,className:"text-blue-600 hover:text-blue-900",children:c.jsx(Ll,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>D(R.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},R.id)})})]})})]})]})}function fC(){var C;const[e,t]=pe.useState([]),[r,n]=pe.useState(!0),[i,s]=pe.useState(""),[a,o]=pe.useState(!1),[l,u]=pe.useState({name:"",whatsapp:"",image:""}),[f,p]=pe.useState(!1),m=pe.useRef(null),[h,v]=pe.useState(null),{organization:x}=Kt(),{confirm:b,addToast:y}=jn(),w=((C=Jr[x.currency])==null?void 0:C.symbol)||x.currency,_=P=>{var j;const R=(j=P.target.files)==null?void 0:j[0];if(R){if(!["image/jpeg","image/jpg","image/png"].includes(R.type)){alert("Please upload a JPG, JPEG, or PNG file");return}if(R.size>5*1024*1024){alert("Image must be less than 5MB");return}v(R)}},E=async()=>{if(x)try{n(!0);const{data:P,error:R}=await Ge.from("workers").select("*").eq("organization_id",x.id).order("name");if(R)throw R;const j=new Date,A=Di(j,{weekStartsOn:1}),q=_o(j,{weekStartsOn:1}),J=kl(j),te=aj(j),{data:z,error:B}=await Ge.from("tasks").select(`
          *,
          deductions (
            amount
          )
        `).eq("organization_id",x.id);if(B)throw B;const G=(P==null?void 0:P.map(V=>{const Z=(z==null?void 0:z.filter(se=>se.worker_id===V.id))||[],he=Z.filter(se=>Uy(new Date(se.date),{start:A,end:q})),k=he.filter(se=>se.status==="completed"),I=he.filter(se=>se.status==="pending"),M=k.reduce((se,fe)=>{var ve;const de=((ve=fe.deductions)==null?void 0:ve.reduce((Ee,Oe)=>Ee+(Oe.amount||0),0))||0;return se+(fe.amount-de)},0),L=he.reduce((se,fe)=>{var ve;const de=((ve=fe.deductions)==null?void 0:ve.reduce((Ee,Oe)=>Ee+(Oe.amount||0),0))||0;return se+(fe.amount-de)},0),H={completedEarnings:M,weeklyProjectTotal:L,assignedTasks:I.length,completedTasks:k.length,allTimeTasks:Z.length,weeklyTasks:he.length,dailyTasks:Z.filter(se=>Uy(new Date(se.date),{start:J,end:te})).length};return{...V,stats:H}}))||[];t(G)}catch(P){console.error("Error loading workers:",P)}finally{n(!1)}};pe.useEffect(()=>{E()},[x]);const O=async()=>{var P;if(!(!x||!l.name.trim()))try{p(!0);let R=null;if(h){const q=(P=h.name.split(".").pop())==null?void 0:P.toLowerCase();if(!q||!["jpg","jpeg","png"].includes(q))throw new Error("Invalid file extension");const J=`${Math.random().toString(36).substring(2)}.${q}`,te=`${x.id}/${J}`,{error:z,data:B}=await Ge.storage.from("profiles").upload(te,h,{contentType:h.type,cacheControl:"3600",upsert:!1});if(z)throw z;const{data:{publicUrl:G}}=Ge.storage.from("profiles").getPublicUrl(te);R=G}const{data:j,error:A}=await Ge.from("workers").insert([{organization_id:x.id,name:l.name.trim(),whatsapp:l.whatsapp.trim()||null,image:R}]).select().single();if(A)throw A;t(q=>[...q,{...j,stats:{completedEarnings:0,weeklyProjectTotal:0,assignedTasks:0,completedTasks:0,allTimeTasks:0,weeklyTasks:0,dailyTasks:0}}]),u({name:"",whatsapp:"",image:""}),v(null),m.current&&(m.current.value=""),o(!1)}catch(R){console.error("Error adding worker:",R),alert(R instanceof Error?R.message:"Failed to add worker")}finally{p(!1)}},D=async P=>{if(await b({title:"Delete Worker",message:"Are you sure you want to delete this worker? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const j=e.find(q=>q.id===P);if(j!=null&&j.image){const q=j.image.split("/").slice(-2).join("/");await Ge.storage.from("profiles").remove([q])}const{error:A}=await Ge.from("workers").delete().eq("id",P);if(A)throw A;t(q=>q.filter(J=>J.id!==P)),y({type:"success",title:"Worker Deleted",message:"The worker has been deleted successfully."})}catch(j){console.error("Error deleting worker:",j),y({type:"error",title:"Error",message:"Failed to delete worker. Please try again."})}},T=e.filter(P=>P.name.toLowerCase().includes(i.toLowerCase()));return r?c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading workers..."})]})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Workers"}),c.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Worker"]})]}),a&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Worker"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),c.jsx("input",{type:"text",value:l.name,onChange:P=>u(R=>({...R,name:P.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",placeholder:"Enter worker name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp Number"}),c.jsx("input",{type:"text",value:l.whatsapp,onChange:P=>u(R=>({...R,whatsapp:P.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",placeholder:"Enter WhatsApp number"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Profile Image"}),c.jsx("input",{type:"file",ref:m,onChange:_,accept:"image/*",className:"hidden"}),c.jsx("div",{className:"mt-1 flex items-center space-x-4",children:h?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:h.name}),c.jsx("button",{onClick:()=>{v(null),m.current&&(m.current.value="")},className:"text-red-600 hover:text-red-700",children:c.jsx(Bo,{className:"h-5 w-5"})})]}):c.jsxs("button",{onClick:()=>{var P;return(P=m.current)==null?void 0:P.click()},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(z0,{className:"h-4 w-4 mr-2"}),"Choose Image"]})})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>{o(!1),v(null),m.current&&(m.current.value="")},className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:O,disabled:!l.name.trim()||f,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center",children:f?c.jsxs(c.Fragment,{children:[c.jsx(Sd,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):"Add Worker"})]})]})]}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsx("div",{className:"p-4 border-b",children:c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Nd,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:P=>s(P.target.value),placeholder:"Search workers...",className:"ml-2 flex-1 outline-none bg-transparent"})]})}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-4",children:T.length===0?c.jsx("div",{className:"col-span-full text-center text-gray-500 py-4",children:i?"No workers found matching your search.":"No workers added yet."}):T.map(P=>{var R,j,A,q,J,te,z;return c.jsxs("div",{className:"relative",children:[c.jsx(on,{to:`/dashboard/workers/${P.id}`,className:"block bg-white border rounded-lg shadow-sm hover:shadow-md transition-shadow",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:P.image?c.jsx("img",{src:P.image,alt:P.name,className:"h-full w-full object-cover"}):c.jsx("span",{className:"text-2xl font-medium text-gray-600",children:P.name[0].toUpperCase()})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:P.name}),P.whatsapp&&c.jsxs("p",{className:"text-sm text-gray-500",children:["WhatsApp: ",P.whatsapp]})]})]}),c.jsxs("div",{className:"mt-6 space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Completed Earnings: ",w," ",(R=P.stats)==null?void 0:R.completedEarnings.toFixed(2)]}),c.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:["Weekly Project Total: ",w," ",(j=P.stats)==null?void 0:j.weeklyProjectTotal.toFixed(2)]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-sm text-yellow-600 font-medium",children:["Tasks Assigned: ",(A=P.stats)==null?void 0:A.assignedTasks]}),c.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Tasks Completed: ",(q=P.stats)==null?void 0:q.completedTasks]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"All-time"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(J=P.stats)==null?void 0:J.allTimeTasks})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"This week"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(te=P.stats)==null?void 0:te.weeklyTasks})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Today"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(z=P.stats)==null?void 0:z.dailyTasks})]})]})]})]})}),c.jsx("button",{onClick:()=>D(P.id),className:"absolute top-4 right-4 p-2 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50 z-10",children:c.jsx(is,{className:"h-5 w-5"})})]},P.id)})})]})]})}function tr(e){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tr(e)}var Un=Uint8Array,Fi=Uint16Array,rx=Int32Array,Lp=new Un([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Fp=new Un([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Dg=new Un([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),v_=function(e,t){for(var r=new Fi(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new rx(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},y_=v_(Lp,2),w_=y_.b,Ig=y_.r;w_[28]=258,Ig[258]=28;var b_=v_(Fp,0),dC=b_.b,Wy=b_.r,Rg=new Fi(32768);for(var vr=0;vr<32768;++vr){var Ya=(vr&43690)>>1|(vr&21845)<<1;Ya=(Ya&52428)>>2|(Ya&13107)<<2,Ya=(Ya&61680)>>4|(Ya&3855)<<4,Rg[vr]=((Ya&65280)>>8|(Ya&255)<<8)>>1}var Js=function(e,t,r){for(var n=e.length,i=0,s=new Fi(t);i<n;++i)e[i]&&++s[e[i]-1];var a=new Fi(t);for(i=1;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(r){o=new Fi(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],f=t-e[i],p=a[e[i]-1]++<<f,m=p|(1<<f)-1;p<=m;++p)o[Rg[p]>>l]=u}else for(o=new Fi(n),i=0;i<n;++i)e[i]&&(o[i]=Rg[a[e[i]-1]++]>>15-e[i]);return o},jo=new Un(288);for(var vr=0;vr<144;++vr)jo[vr]=8;for(var vr=144;vr<256;++vr)jo[vr]=9;for(var vr=256;vr<280;++vr)jo[vr]=7;for(var vr=280;vr<288;++vr)jo[vr]=8;var od=new Un(32);for(var vr=0;vr<32;++vr)od[vr]=5;var hC=Js(jo,9,0),pC=Js(jo,9,1),mC=Js(od,5,0),gC=Js(od,5,1),o1=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ms=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},l1=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},nx=function(e){return(e+7)/8|0},__=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Un(e.subarray(t,r))},xC=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ws=function(e,t,r){var n=new Error(t||xC[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,ws),!r)throw n;return n},vC=function(e,t,r,n){var i=e.length,s=0;if(!i||t.f&&!t.l)return r||new Un(0);var a=!r,o=a||t.i!=2,l=t.i;a&&(r=new Un(i*3));var u=function(Ee){var Oe=r.length;if(Ee>Oe){var qe=new Un(Math.max(Oe*2,Ee));qe.set(r),r=qe}},f=t.f||0,p=t.p||0,m=t.b||0,h=t.l,v=t.d,x=t.m,b=t.n,y=i*8;do{if(!h){f=ms(e,p,1);var w=ms(e,p+1,3);if(p+=3,w)if(w==1)h=pC,v=gC,x=9,b=5;else if(w==2){var D=ms(e,p,31)+257,T=ms(e,p+10,15)+4,C=D+ms(e,p+5,31)+1;p+=14;for(var P=new Un(C),R=new Un(19),j=0;j<T;++j)R[Dg[j]]=ms(e,p+j*3,7);p+=T*3;for(var A=o1(R),q=(1<<A)-1,J=Js(R,A,1),j=0;j<C;){var te=J[ms(e,p,q)];p+=te&15;var _=te>>4;if(_<16)P[j++]=_;else{var z=0,B=0;for(_==16?(B=3+ms(e,p,3),p+=2,z=P[j-1]):_==17?(B=3+ms(e,p,7),p+=3):_==18&&(B=11+ms(e,p,127),p+=7);B--;)P[j++]=z}}var G=P.subarray(0,D),V=P.subarray(D);x=o1(G),b=o1(V),h=Js(G,x,1),v=Js(V,b,1)}else ws(1);else{var _=nx(p)+4,E=e[_-4]|e[_-3]<<8,O=_+E;if(O>i){l&&ws(0);break}o&&u(m+E),r.set(e.subarray(_,O),m),t.b=m+=E,t.p=p=O*8,t.f=f;continue}if(p>y){l&&ws(0);break}}o&&u(m+131072);for(var Z=(1<<x)-1,he=(1<<b)-1,k=p;;k=p){var z=h[l1(e,p)&Z],I=z>>4;if(p+=z&15,p>y){l&&ws(0);break}if(z||ws(2),I<256)r[m++]=I;else if(I==256){k=p,h=null;break}else{var M=I-254;if(I>264){var j=I-257,L=Lp[j];M=ms(e,p,(1<<L)-1)+w_[j],p+=L}var H=v[l1(e,p)&he],se=H>>4;H||ws(3),p+=H&15;var V=dC[se];if(se>3){var L=Fp[se];V+=l1(e,p)&(1<<L)-1,p+=L}if(p>y){l&&ws(0);break}o&&u(m+131072);var fe=m+M;if(m<V){var de=s-V,ve=Math.min(V,fe);for(de+m<0&&ws(3);m<ve;++m)r[m]=n[de+m]}for(;m<fe;++m)r[m]=r[m-V]}}t.l=h,t.p=k,t.b=m,t.f=f,h&&(f=1,t.m=x,t.d=v,t.n=b)}while(!f);return m!=r.length&&a?__(r,0,m):r.subarray(0,m)},ha=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},sf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},c1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:N_,l:0};if(i==1){var a=new Un(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(O,D){return O.f-D.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],u=0,f=1,p=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};f!=i-1;)o=r[r[u].f<r[p].f?u++:p++],l=r[u!=f&&r[u].f<r[p].f?u++:p++],r[f++]={s:-1,f:o.f+l.f,l:o,r:l};for(var m=s[0].s,n=1;n<i;++n)s[n].s>m&&(m=s[n].s);var h=new Fi(m+1),v=Mg(r[f-1],h,0);if(v>t){var n=0,x=0,b=v-t,y=1<<b;for(s.sort(function(D,T){return h[T.s]-h[D.s]||D.f-T.f});n<i;++n){var w=s[n].s;if(h[w]>t)x+=y-(1<<v-h[w]),h[w]=t;else break}for(x>>=b;x>0;){var _=s[n].s;h[_]<t?x-=1<<t-h[_]++-1:++n}for(;n>=0&&x;--n){var E=s[n].s;h[E]==t&&(--h[E],++x)}v=t}return{t:new Un(h),l:v}},Mg=function(e,t,r){return e.s==-1?Math.max(Mg(e.l,t,r+1),Mg(e.r,t,r+1)):t[e.s]=r},Hy=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Fi(++t),n=0,i=e[0],s=1,a=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[o]}return{c:r.subarray(0,n),n:t}},af=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},S_=function(e,t,r){var n=r.length,i=nx(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},$y=function(e,t,r,n,i,s,a,o,l,u,f){ha(t,f++,r),++i[256];for(var p=c1(i,15),m=p.t,h=p.l,v=c1(s,15),x=v.t,b=v.l,y=Hy(m),w=y.c,_=y.n,E=Hy(x),O=E.c,D=E.n,T=new Fi(19),C=0;C<w.length;++C)++T[w[C]&31];for(var C=0;C<O.length;++C)++T[O[C]&31];for(var P=c1(T,7),R=P.t,j=P.l,A=19;A>4&&!R[Dg[A-1]];--A);var q=u+5<<3,J=af(i,jo)+af(s,od)+a,te=af(i,m)+af(s,x)+a+14+3*A+af(T,R)+2*T[16]+3*T[17]+7*T[18];if(l>=0&&q<=J&&q<=te)return S_(t,f,e.subarray(l,l+u));var z,B,G,V;if(ha(t,f,1+(te<J)),f+=2,te<J){z=Js(m,h,0),B=m,G=Js(x,b,0),V=x;var Z=Js(R,j,0);ha(t,f,_-257),ha(t,f+5,D-1),ha(t,f+10,A-4),f+=14;for(var C=0;C<A;++C)ha(t,f+3*C,R[Dg[C]]);f+=3*A;for(var he=[w,O],k=0;k<2;++k)for(var I=he[k],C=0;C<I.length;++C){var M=I[C]&31;ha(t,f,Z[M]),f+=R[M],M>15&&(ha(t,f,I[C]>>5&127),f+=I[C]>>12)}}else z=hC,B=jo,G=mC,V=od;for(var C=0;C<o;++C){var L=n[C];if(L>255){var M=L>>18&31;sf(t,f,z[M+257]),f+=B[M+257],M>7&&(ha(t,f,L>>23&31),f+=Lp[M]);var H=L&31;sf(t,f,G[H]),f+=V[H],H>3&&(sf(t,f,L>>5&8191),f+=Fp[H])}else sf(t,f,z[L]),f+=B[L]}return sf(t,f,z[256]),f+B[256]},yC=new rx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),N_=new Un(0),wC=function(e,t,r,n,i,s){var a=s.z||e.length,o=new Un(n+a+5*(1+Math.ceil(a/7e3))+i),l=o.subarray(n,o.length-i),u=s.l,f=(s.r||0)&7;if(t){f&&(l[0]=s.r>>3);for(var p=yC[t-1],m=p>>13,h=p&8191,v=(1<<r)-1,x=s.p||new Fi(32768),b=s.h||new Fi(v+1),y=Math.ceil(r/3),w=2*y,_=function(Qe){return(e[Qe]^e[Qe+1]<<y^e[Qe+2]<<w)&v},E=new rx(25e3),O=new Fi(288),D=new Fi(32),T=0,C=0,P=s.i||0,R=0,j=s.w||0,A=0;P+2<a;++P){var q=_(P),J=P&32767,te=b[q];if(x[J]=te,b[q]=J,j<=P){var z=a-P;if((T>7e3||R>24576)&&(z>423||!u)){f=$y(e,l,0,E,O,D,C,R,A,P-A,f),R=T=C=0,A=P;for(var B=0;B<286;++B)O[B]=0;for(var B=0;B<30;++B)D[B]=0}var G=2,V=0,Z=h,he=J-te&32767;if(z>2&&q==_(P-he))for(var k=Math.min(m,z)-1,I=Math.min(32767,P),M=Math.min(258,z);he<=I&&--Z&&J!=te;){if(e[P+G]==e[P+G-he]){for(var L=0;L<M&&e[P+L]==e[P+L-he];++L);if(L>G){if(G=L,V=he,L>k)break;for(var H=Math.min(he,L-2),se=0,B=0;B<H;++B){var fe=P-he+B&32767,de=x[fe],ve=fe-de&32767;ve>se&&(se=ve,te=fe)}}}J=te,te=x[J],he+=J-te&32767}if(V){E[R++]=268435456|Ig[G]<<18|Wy[V];var Ee=Ig[G]&31,Oe=Wy[V]&31;C+=Lp[Ee]+Fp[Oe],++O[257+Ee],++D[Oe],j=P+G,++T}else E[R++]=e[P],++O[e[P]]}}for(P=Math.max(P,j);P<a;++P)E[R++]=e[P],++O[e[P]];f=$y(e,l,u,E,O,D,C,R,A,P-A,f),u||(s.r=f&7|l[f/8|0]<<3,f-=7,s.h=b,s.p=x,s.i=P,s.w=j)}else{for(var P=s.w||0;P<a+u;P+=65535){var qe=P+65535;qe>=a&&(l[f/8|0]=u,qe=a),f=S_(l,f+1,e.subarray(P,qe))}s.i=a}return __(o,0,n+nx(f)+i)},k_=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=n+=r[a];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},bC=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new Un(s.length+e.length);a.set(s),a.set(e,s.length),e=a,i.w=s.length}return wC(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},E_=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},_C=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=k_();i.p(t.dictionary),E_(e,2,i.d())}},SC=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ws(6,"invalid zlib data"),(e[1]>>5&1)==1&&ws(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Bg(e,t){t||(t={});var r=k_();r.p(e);var n=bC(e,t,t.dictionary?6:2,4);return _C(n,t),E_(n,n.length-4,r.d()),n}function NC(e,t){return vC(e.subarray(SC(e),-4),{i:2},t,t)}var kC=typeof TextDecoder<"u"&&new TextDecoder,EC=0;try{kC.decode(N_,{stream:!0}),EC=1}catch{}var vt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function u1(){vt.console&&typeof vt.console.log=="function"&&vt.console.log.apply(vt.console,arguments)}var ur={log:u1,warn:function(e){vt.console&&(typeof vt.console.warn=="function"?vt.console.warn.apply(vt.console,arguments):u1.call(null,arguments))},error:function(e){vt.console&&(typeof vt.console.error=="function"?vt.console.error.apply(vt.console,arguments):u1(e))}};function f1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){nl(n.response,t,r)},n.onerror=function(){ur.error("could not download file")},n.send()}function qy(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function zh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var jf,Ug,nl=vt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==vt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=vt.URL||vt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?qy(i.href)?f1(e,t,r):zh(i,i.target="_blank"):zh(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){zh(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(qy(e))f1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){zh(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:tr(s)!=="object"&&(ur.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return f1(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(vt.HTMLElement)||vt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=a?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var l=vt.URL||vt.webkitURL,u=l.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function A_(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,a=i.exec(e);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),"#"+o+l+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function d1(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=Dn(r,n,i,s,t[0],7,-680876936),s=Dn(s,r,n,i,t[1],12,-389564586),i=Dn(i,s,r,n,t[2],17,606105819),n=Dn(n,i,s,r,t[3],22,-1044525330),r=Dn(r,n,i,s,t[4],7,-176418897),s=Dn(s,r,n,i,t[5],12,1200080426),i=Dn(i,s,r,n,t[6],17,-1473231341),n=Dn(n,i,s,r,t[7],22,-45705983),r=Dn(r,n,i,s,t[8],7,1770035416),s=Dn(s,r,n,i,t[9],12,-1958414417),i=Dn(i,s,r,n,t[10],17,-42063),n=Dn(n,i,s,r,t[11],22,-1990404162),r=Dn(r,n,i,s,t[12],7,1804603682),s=Dn(s,r,n,i,t[13],12,-40341101),i=Dn(i,s,r,n,t[14],17,-1502002290),r=In(r,n=Dn(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=In(s,r,n,i,t[6],9,-1069501632),i=In(i,s,r,n,t[11],14,643717713),n=In(n,i,s,r,t[0],20,-373897302),r=In(r,n,i,s,t[5],5,-701558691),s=In(s,r,n,i,t[10],9,38016083),i=In(i,s,r,n,t[15],14,-660478335),n=In(n,i,s,r,t[4],20,-405537848),r=In(r,n,i,s,t[9],5,568446438),s=In(s,r,n,i,t[14],9,-1019803690),i=In(i,s,r,n,t[3],14,-187363961),n=In(n,i,s,r,t[8],20,1163531501),r=In(r,n,i,s,t[13],5,-1444681467),s=In(s,r,n,i,t[2],9,-51403784),i=In(i,s,r,n,t[7],14,1735328473),r=Rn(r,n=In(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=Rn(s,r,n,i,t[8],11,-2022574463),i=Rn(i,s,r,n,t[11],16,1839030562),n=Rn(n,i,s,r,t[14],23,-35309556),r=Rn(r,n,i,s,t[1],4,-1530992060),s=Rn(s,r,n,i,t[4],11,1272893353),i=Rn(i,s,r,n,t[7],16,-155497632),n=Rn(n,i,s,r,t[10],23,-1094730640),r=Rn(r,n,i,s,t[13],4,681279174),s=Rn(s,r,n,i,t[0],11,-358537222),i=Rn(i,s,r,n,t[3],16,-722521979),n=Rn(n,i,s,r,t[6],23,76029189),r=Rn(r,n,i,s,t[9],4,-640364487),s=Rn(s,r,n,i,t[12],11,-421815835),i=Rn(i,s,r,n,t[15],16,530742520),r=Mn(r,n=Rn(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Mn(s,r,n,i,t[7],10,1126891415),i=Mn(i,s,r,n,t[14],15,-1416354905),n=Mn(n,i,s,r,t[5],21,-57434055),r=Mn(r,n,i,s,t[12],6,1700485571),s=Mn(s,r,n,i,t[3],10,-1894986606),i=Mn(i,s,r,n,t[10],15,-1051523),n=Mn(n,i,s,r,t[1],21,-2054922799),r=Mn(r,n,i,s,t[8],6,1873313359),s=Mn(s,r,n,i,t[15],10,-30611744),i=Mn(i,s,r,n,t[6],15,-1560198380),n=Mn(n,i,s,r,t[13],21,1309151649),r=Mn(r,n,i,s,t[4],6,-145523070),s=Mn(s,r,n,i,t[11],10,-1120210379),i=Mn(i,s,r,n,t[2],15,718787259),n=Mn(n,i,s,r,t[9],21,-343485551),e[0]=co(r,e[0]),e[1]=co(n,e[1]),e[2]=co(i,e[2]),e[3]=co(s,e[3])}function Op(e,t,r,n,i,s){return t=co(co(t,e),co(n,s)),co(t<<i|t>>>32-i,r)}function Dn(e,t,r,n,i,s,a){return Op(t&r|~t&n,e,t,i,s,a)}function In(e,t,r,n,i,s,a){return Op(t&n|r&~n,e,t,i,s,a)}function Rn(e,t,r,n,i,s,a){return Op(t^r^n,e,t,i,s,a)}function Mn(e,t,r,n,i,s,a){return Op(r^(t|~n),e,t,i,s,a)}function T_(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)d1(n,AC(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(d1(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,d1(n,i),n}function AC(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}jf=vt.atob.bind(vt),Ug=vt.btoa.bind(vt);var Vy="0123456789abcdef".split("");function TC(e){for(var t="",r=0;r<4;r++)t+=Vy[e>>8*r+4&15]+Vy[e>>8*r&15];return t}function jC(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function zg(e){return T_(e).map(jC).join("")}var CC=function(e){for(var t=0;t<e.length;t++)e[t]=TC(e[t]);return e.join("")}(T_("hello"))!="5d41402abc4b2a76b9719d911017c592";function co(e,t){if(CC){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Wg(e,t){var r,n,i,s;if(e!==r){for(var a=(i=e,s=1+(256/e.length>>0),new Array(s+1).join(i)),o=[],l=0;l<256;l++)o[l]=l;var u=0;for(l=0;l<256;l++){var f=o[l];u=(u+f+a.charCodeAt(l))%256,o[l]=o[u],o[u]=f}r=e,n=o}else o=n;var p=t.length,m=0,h=0,v="";for(l=0;l<p;l++)h=(h+(f=o[m=(m+1)%256]))%256,o[m]=o[h],o[h]=f,a=o[(o[m]+o[h])%256],v+=String.fromCharCode(t.charCodeAt(l)^a);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Gy={print:4,modify:8,copy:16,"annot-forms":32};function yc(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(Gy.perm!==void 0)throw new Error("Invalid permission: "+o);i+=Gy[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),a=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=zg(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Wg(this.encryptionKey,this.padding)}function wc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=e[n]}return t}function Yy(e){if(tr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var a=t[r][s];try{a[0].apply(e,n)}catch(o){vt.console&&ur.error("jsPDF PubSub Error",o.message,o)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function ld(e){if(!(this instanceof ld))return new ld(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function j_(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function so(e,t,r,n,i){if(!(this instanceof so))return new so(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,j_.call(this,n,i)}function cl(e,t,r,n,i){if(!(this instanceof cl))return new cl(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,j_.call(this,n,i)}function pt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],a=[],o=1,l=16,u="S",f=null;tr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),u=e.defaultPathOperation||"S"),a=e.filters||(s===!0?["FlateEncode"]:a),n=n||"mm",r=(""+(r||"P")).toLowerCase();var p=e.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=Yy;var v="1.3",x=h.__private__.getPdfVersion=function(){return v};h.__private__.setPdfVersion=function(S){v=S};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return b};var y=h.__private__.getPageFormat=function(S){return b[S]};i=i||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},_=w.COMPAT;function E(){this.saveGraphicsState(),ue(new mt(nt,0,0,-nt,0,Oa()*nt).toString()+" cm"),this.setFontSize(this.getFontSize()/nt),u="n",_=w.ADVANCED}function O(){this.restoreGraphicsState(),u="S",_=w.COMPAT}var D=h.__private__.combineFontStyleAndFontWeight=function(S,W){if(S=="bold"&&W=="normal"||S=="bold"&&W==400||S=="normal"&&W=="italic"||S=="bold"&&W=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return W&&(S=W==400||W==="normal"?S==="italic"?"italic":"normal":W!=700&&W!=="bold"||S!=="normal"?(W==700?"bold":W)+""+S:"bold"),S};h.advancedAPI=function(S){var W=_===w.COMPAT;return W&&E.call(this),typeof S!="function"||(S(this),W&&O.call(this)),this},h.compatAPI=function(S){var W=_===w.ADVANCED;return W&&O.call(this),typeof S!="function"||(S(this),W&&E.call(this)),this},h.isAdvancedAPI=function(){return _===w.ADVANCED};var T,C=function(S){if(_!==w.ADVANCED)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},P=h.roundToPrecision=h.__private__.roundToPrecision=function(S,W){var ce=t||W;if(isNaN(S)||isNaN(ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(ce).replace(/0+$/,"")};T=h.hpf=h.__private__.hpf=typeof l=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return P(S,l)}:l==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return P(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return P(S,16)};var R=h.f2=h.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return P(S,2)},j=h.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return P(S,3)},A=h.scale=h.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return _===w.COMPAT?S*nt:_===w.ADVANCED?S:void 0},q=function(S){return _===w.COMPAT?Oa()-S:_===w.ADVANCED?S:void 0},J=function(S){return A(q(S))};h.__private__.setPrecision=h.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var te,z="00000000000000000000000000000000",B=h.__private__.getFileId=function(){return z},G=h.__private__.setFileId=function(S){return z=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Pn=new yc(f.userPermissions,f.userPassword,f.ownerPassword,z)),z};h.setFileId=function(S){return G(S),this},h.getFileId=function(){return B()};var V=h.__private__.convertDateToPDFDate=function(S){var W=S.getTimezoneOffset(),ce=W<0?"+":"-",me=Math.floor(Math.abs(W/60)),be=Math.abs(W%60),Le=[ce,M(me),"'",M(be),"'"].join("");return["D:",S.getFullYear(),M(S.getMonth()+1),M(S.getDate()),M(S.getHours()),M(S.getMinutes()),M(S.getSeconds()),Le].join("")},Z=h.__private__.convertPDFDateToDate=function(S){var W=parseInt(S.substr(2,4),10),ce=parseInt(S.substr(6,2),10)-1,me=parseInt(S.substr(8,2),10),be=parseInt(S.substr(10,2),10),Le=parseInt(S.substr(12,2),10),We=parseInt(S.substr(14,2),10);return new Date(W,ce,me,be,Le,We,0)},he=h.__private__.setCreationDate=function(S){var W;if(S===void 0&&(S=new Date),S instanceof Date)W=V(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");W=S}return te=W},k=h.__private__.getCreationDate=function(S){var W=te;return S==="jsDate"&&(W=Z(te)),W};h.setCreationDate=function(S){return he(S),this},h.getCreationDate=function(S){return k(S)};var I,M=h.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},L=h.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},H=0,se=[],fe=[],de=0,ve=[],Ee=[],Oe=!1,qe=fe,Qe=function(){H=0,de=0,fe=[],se=[],ve=[],re=Ar(),ne=Ar()};h.__private__.setCustomOutputDestination=function(S){Oe=!0,qe=S};var je=function(S){Oe||(qe=S)};h.__private__.resetCustomOutputDestination=function(){Oe=!1,qe=fe};var ue=h.__private__.out=function(S){return S=S.toString(),de+=S.length+1,qe.push(S),qe},Me=h.__private__.write=function(S){return ue(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},at=h.__private__.getArrayBuffer=function(S){for(var W=S.length,ce=new ArrayBuffer(W),me=new Uint8Array(ce);W--;)me[W]=S.charCodeAt(W);return ce},ze=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return ze};var Ye=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(S){return Ye=_===w.ADVANCED?S/nt:S,this};var Ze,tt=h.__private__.getFontSize=h.getFontSize=function(){return _===w.COMPAT?Ye:Ye*nt},ft=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(S){return ft=S,this},h.__private__.getR2L=h.getR2L=function(){return ft};var dt,bt=h.__private__.setZoomMode=function(S){var W=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))Ze=S;else if(isNaN(S)){if(W.indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');Ze=S}else Ze=parseInt(S,10)};h.__private__.getZoomMode=function(){return Ze};var At,Lt=h.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');dt=S};h.__private__.getPageMode=function(){return dt};var Ot=h.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');At=S};h.__private__.getLayoutMode=function(){return At},h.__private__.setDisplayMode=h.setDisplayMode=function(S,W,ce){return bt(S),Ot(W),Lt(ce),this};var xt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(S){if(Object.keys(xt).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt[S]},h.__private__.getDocumentProperties=function(){return xt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(S){for(var W in xt)xt.hasOwnProperty(W)&&S[W]&&(xt[W]=S[W]);return this},h.__private__.setDocumentProperty=function(S,W){if(Object.keys(xt).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt[S]=W};var Ct,nt,Zr,Rt,ti,Gt={},fr={},Ui=[],Bt={},Fs={},gr={},yi={},as=null,lr=0,_t=[],Ht=new Yy(h),ra=e.hotfixes||[],en={},zi={},Wi=[],mt=function S(W,ce,me,be,Le,We){if(!(this instanceof S))return new S(W,ce,me,be,Le,We);isNaN(W)&&(W=1),isNaN(ce)&&(ce=0),isNaN(me)&&(me=0),isNaN(be)&&(be=1),isNaN(Le)&&(Le=0),isNaN(We)&&(We=0),this._matrix=[W,ce,me,be,Le,We]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(S)},mt.prototype.multiply=function(S){var W=S.sx*this.sx+S.shy*this.shx,ce=S.sx*this.shy+S.shy*this.sy,me=S.shx*this.sx+S.sy*this.shx,be=S.shx*this.shy+S.sy*this.sy,Le=S.tx*this.sx+S.ty*this.shx+this.tx,We=S.tx*this.shy+S.ty*this.sy+this.ty;return new mt(W,ce,me,be,Le,We)},mt.prototype.decompose=function(){var S=this.sx,W=this.shy,ce=this.shx,me=this.sy,be=this.tx,Le=this.ty,We=Math.sqrt(S*S+W*W),ot=(S/=We)*ce+(W/=We)*me;ce-=S*ot,me-=W*ot;var ht=Math.sqrt(ce*ce+me*me);return ot/=ht,S*(me/=ht)<W*(ce/=ht)&&(S=-S,W=-W,ot=-ot,We=-We),{scale:new mt(We,0,0,ht,0,0),translate:new mt(1,0,0,1,be,Le),rotate:new mt(S,W,-W,S,0,0),skew:new mt(1,0,ot,1,0,0)}},mt.prototype.toString=function(S){return this.join(" ")},mt.prototype.inversed=function(){var S=this.sx,W=this.shy,ce=this.shx,me=this.sy,be=this.tx,Le=this.ty,We=1/(S*me-W*ce),ot=me*We,ht=-W*We,Et=-ce*We,Nt=S*We;return new mt(ot,ht,Et,Nt,-ot*be-Et*Le,-ht*be-Nt*Le)},mt.prototype.applyToPoint=function(S){var W=S.x*this.sx+S.y*this.shx+this.tx,ce=S.x*this.shy+S.y*this.sy+this.ty;return new ql(W,ce)},mt.prototype.applyToRectangle=function(S){var W=this.applyToPoint(S),ce=this.applyToPoint(new ql(S.x+S.w,S.y+S.h));return new Au(W.x,W.y,ce.x-W.x,ce.y-W.y)},mt.prototype.clone=function(){var S=this.sx,W=this.shy,ce=this.shx,me=this.sy,be=this.tx,Le=this.ty;return new mt(S,W,ce,me,be,Le)},h.Matrix=mt;var wi=h.matrixMult=function(S,W){return W.multiply(S)},ri=new mt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=ri;var Cn=function(S,W){if(!Fs[S]){var ce=(W instanceof so?"Sh":"P")+(Object.keys(Bt).length+1).toString(10);W.id=ce,Fs[S]=ce,Bt[ce]=W,Ht.publish("addPattern",W)}};h.ShadingPattern=so,h.TilingPattern=cl,h.addShadingPattern=function(S,W){return C("addShadingPattern()"),Cn(S,W),this},h.beginTilingPattern=function(S){C("beginTilingPattern()"),Gd(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},h.endTilingPattern=function(S,W){C("endTilingPattern()"),W.stream=Ee[I].join(`
`),Cn(S,W),Ht.publish("endTilingPattern",W),Wi.pop().restore()};var Or=h.__private__.newObject=function(){var S=Ar();return K(S,!0),S},Ar=h.__private__.newObjectDeferred=function(){return H++,se[H]=function(){return de},H},K=function(S,W){return W=typeof W=="boolean"&&W,se[S]=de,W&&ue(S+" 0 obj"),S},oe=h.__private__.newAdditionalObject=function(){var S={objId:Ar(),content:""};return ve.push(S),S},re=Ar(),ne=Ar(),ae=h.__private__.decodeColorString=function(S){var W=S.split(" ");if(W.length!==2||W[1]!=="g"&&W[1]!=="G")W.length===5&&(W[4]==="k"||W[4]==="K")&&(W=[(1-W[0])*(1-W[3]),(1-W[1])*(1-W[3]),(1-W[2])*(1-W[3]),"r"]);else{var ce=parseFloat(W[0]);W=[ce,ce,ce,"r"]}for(var me="#",be=0;be<3;be++)me+=("0"+Math.floor(255*parseFloat(W[be])).toString(16)).slice(-2);return me},le=h.__private__.encodeColorString=function(S){var W;typeof S=="string"&&(S={ch1:S});var ce=S.ch1,me=S.ch2,be=S.ch3,Le=S.ch4,We=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ce=="string"&&ce.charAt(0)!=="#"){var ot=new A_(ce);if(ot.ok)ce=ot.toHex();else if(!/^\d*\.?\d*$/.test(ce))throw new Error('Invalid color "'+ce+'" passed to jsPDF.encodeColorString.')}if(typeof ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ce)&&(ce="#"+ce[1]+ce[1]+ce[2]+ce[2]+ce[3]+ce[3]),typeof ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ce)){var ht=parseInt(ce.substr(1),16);ce=ht>>16&255,me=ht>>8&255,be=255&ht}if(me===void 0||Le===void 0&&ce===me&&me===be)if(typeof ce=="string")W=ce+" "+We[0];else switch(S.precision){case 2:W=R(ce/255)+" "+We[0];break;case 3:default:W=j(ce/255)+" "+We[0]}else if(Le===void 0||tr(Le)==="object"){if(Le&&!isNaN(Le.a)&&Le.a===0)return W=["1.","1.","1.",We[1]].join(" ");if(typeof ce=="string")W=[ce,me,be,We[1]].join(" ");else switch(S.precision){case 2:W=[R(ce/255),R(me/255),R(be/255),We[1]].join(" ");break;default:case 3:W=[j(ce/255),j(me/255),j(be/255),We[1]].join(" ")}}else if(typeof ce=="string")W=[ce,me,be,Le,We[2]].join(" ");else switch(S.precision){case 2:W=[R(ce),R(me),R(be),R(Le),We[2]].join(" ");break;case 3:default:W=[j(ce),j(me),j(be),j(Le),We[2]].join(" ")}return W},Se=h.__private__.getFilters=function(){return a},Ce=h.__private__.putStream=function(S){var W=(S=S||{}).data||"",ce=S.filters||Se(),me=S.alreadyAppliedFilters||[],be=S.addLength1||!1,Le=W.length,We=S.objectId,ot=function(Ln){return Ln};if(f!==null&&We===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(ot=Pn.encryptor(We,0));var ht={};ce===!0&&(ce=["FlateEncode"]);var Et=S.additionalKeyValues||[],Nt=(ht=pt.API.processDataByFilters!==void 0?pt.API.processDataByFilters(W,ce):{data:W,reverseChain:[]}).reverseChain+(Array.isArray(me)?me.join(" "):me.toString());if(ht.data.length!==0&&(Et.push({key:"Length",value:ht.data.length}),be===!0&&Et.push({key:"Length1",value:Le})),Nt.length!=0)if(Nt.split("/").length-1==1)Et.push({key:"Filter",value:Nt});else{Et.push({key:"Filter",value:"["+Nt+"]"});for(var Mt=0;Mt<Et.length;Mt+=1)if(Et[Mt].key==="DecodeParms"){for(var _r=[],Tr=0;Tr<ht.reverseChain.split("/").length-1;Tr+=1)_r.push("null");_r.push(Et[Mt].value),Et[Mt].value="["+_r.join(" ")+"]"}}ue("<<");for(var $r=0;$r<Et.length;$r++)ue("/"+Et[$r].key+" "+Et[$r].value);ue(">>"),ht.data.length!==0&&(ue("stream"),ue(ot(ht.data)),ue("endstream"))},_e=h.__private__.putPage=function(S){var W=S.number,ce=S.data,me=S.objId,be=S.contentsObjId;K(me,!0),ue("<</Type /Page"),ue("/Parent "+S.rootDictionaryObjId+" 0 R"),ue("/Resources "+S.resourceDictionaryObjId+" 0 R"),ue("/MediaBox ["+parseFloat(T(S.mediaBox.bottomLeftX))+" "+parseFloat(T(S.mediaBox.bottomLeftY))+" "+T(S.mediaBox.topRightX)+" "+T(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&ue("/CropBox ["+T(S.cropBox.bottomLeftX)+" "+T(S.cropBox.bottomLeftY)+" "+T(S.cropBox.topRightX)+" "+T(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&ue("/BleedBox ["+T(S.bleedBox.bottomLeftX)+" "+T(S.bleedBox.bottomLeftY)+" "+T(S.bleedBox.topRightX)+" "+T(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&ue("/TrimBox ["+T(S.trimBox.bottomLeftX)+" "+T(S.trimBox.bottomLeftY)+" "+T(S.trimBox.topRightX)+" "+T(S.trimBox.topRightY)+"]"),S.artBox!==null&&ue("/ArtBox ["+T(S.artBox.bottomLeftX)+" "+T(S.artBox.bottomLeftY)+" "+T(S.artBox.topRightX)+" "+T(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&ue("/UserUnit "+S.userUnit),Ht.publish("putPage",{objId:me,pageContext:_t[W],pageNumber:W,page:ce}),ue("/Contents "+be+" 0 R"),ue(">>"),ue("endobj");var Le=ce.join(`
`);return _===w.ADVANCED&&(Le+=`
Q`),K(be,!0),Ce({data:Le,filters:Se(),objectId:be}),ue("endobj"),me},Ae=h.__private__.putPages=function(){var S,W,ce=[];for(S=1;S<=lr;S++)_t[S].objId=Ar(),_t[S].contentsObjId=Ar();for(S=1;S<=lr;S++)ce.push(_e({number:S,data:Ee[S],objId:_t[S].objId,contentsObjId:_t[S].contentsObjId,mediaBox:_t[S].mediaBox,cropBox:_t[S].cropBox,bleedBox:_t[S].bleedBox,trimBox:_t[S].trimBox,artBox:_t[S].artBox,userUnit:_t[S].userUnit,rootDictionaryObjId:re,resourceDictionaryObjId:ne}));K(re,!0),ue("<</Type /Pages");var me="/Kids [";for(W=0;W<lr;W++)me+=ce[W]+" 0 R ";ue(me+"]"),ue("/Count "+lr),ue(">>"),ue("endobj"),Ht.publish("postPutPages")},Te=function(S){Ht.publish("putFont",{font:S,out:ue,newObject:Or,putStream:Ce}),S.isAlreadyPutted!==!0&&(S.objectNumber=Or(),ue("<<"),ue("/Type /Font"),ue("/BaseFont /"+wc(S.postScriptName)),ue("/Subtype /Type1"),typeof S.encoding=="string"&&ue("/Encoding /"+S.encoding),ue("/FirstChar 32"),ue("/LastChar 255"),ue(">>"),ue("endobj"))},He=function(){for(var S in Gt)Gt.hasOwnProperty(S)&&(p===!1||p===!0&&m.hasOwnProperty(S))&&Te(Gt[S])},Ke=function(S){S.objectNumber=Or();var W=[];W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Form"}),W.push({key:"BBox",value:"["+[T(S.x),T(S.y),T(S.x+S.width),T(S.y+S.height)].join(" ")+"]"}),W.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var ce=S.pages[1].join(`
`);Ce({data:ce,additionalKeyValues:W,objectId:S.objectNumber}),ue("endobj")},st=function(){for(var S in en)en.hasOwnProperty(S)&&Ke(en[S])},Ve=function(S,W){var ce,me=[],be=1/(W-1);for(ce=0;ce<1;ce+=be)me.push(ce);if(me.push(1),S[0].offset!=0){var Le={offset:0,color:S[0].color};S.unshift(Le)}if(S[S.length-1].offset!=1){var We={offset:1,color:S[S.length-1].color};S.push(We)}for(var ot="",ht=0,Et=0;Et<me.length;Et++){for(ce=me[Et];ce>S[ht+1].offset;)ht++;var Nt=S[ht].offset,Mt=(ce-Nt)/(S[ht+1].offset-Nt),_r=S[ht].color,Tr=S[ht+1].color;ot+=L(Math.round((1-Mt)*_r[0]+Mt*Tr[0]).toString(16))+L(Math.round((1-Mt)*_r[1]+Mt*Tr[1]).toString(16))+L(Math.round((1-Mt)*_r[2]+Mt*Tr[2]).toString(16))}return ot.trim()},it=function(S,W){W||(W=21);var ce=Or(),me=Ve(S.colors,W),be=[];be.push({key:"FunctionType",value:"0"}),be.push({key:"Domain",value:"[0.0 1.0]"}),be.push({key:"Size",value:"["+W+"]"}),be.push({key:"BitsPerSample",value:"8"}),be.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),be.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ce({data:me,additionalKeyValues:be,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ce}),ue("endobj"),S.objectNumber=Or(),ue("<< /ShadingType "+S.type),ue("/ColorSpace /DeviceRGB");var Le="/Coords ["+T(parseFloat(S.coords[0]))+" "+T(parseFloat(S.coords[1]))+" ";S.type===2?Le+=T(parseFloat(S.coords[2]))+" "+T(parseFloat(S.coords[3])):Le+=T(parseFloat(S.coords[2]))+" "+T(parseFloat(S.coords[3]))+" "+T(parseFloat(S.coords[4]))+" "+T(parseFloat(S.coords[5])),ue(Le+="]"),S.matrix&&ue("/Matrix ["+S.matrix.toString()+"]"),ue("/Function "+ce+" 0 R"),ue("/Extend [true true]"),ue(">>"),ue("endobj")},wt=function(S,W){var ce=Ar(),me=Or();W.push({resourcesOid:ce,objectOid:me}),S.objectNumber=me;var be=[];be.push({key:"Type",value:"/Pattern"}),be.push({key:"PatternType",value:"1"}),be.push({key:"PaintType",value:"1"}),be.push({key:"TilingType",value:"1"}),be.push({key:"BBox",value:"["+S.boundingBox.map(T).join(" ")+"]"}),be.push({key:"XStep",value:T(S.xStep)}),be.push({key:"YStep",value:T(S.yStep)}),be.push({key:"Resources",value:ce+" 0 R"}),S.matrix&&be.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),Ce({data:S.stream,additionalKeyValues:be,objectId:S.objectNumber}),ue("endobj")},Yt=function(S){var W;for(W in Bt)Bt.hasOwnProperty(W)&&(Bt[W]instanceof so?it(Bt[W]):Bt[W]instanceof cl&&wt(Bt[W],S))},sr=function(S){for(var W in S.objectNumber=Or(),ue("<<"),S)switch(W){case"opacity":ue("/ca "+R(S[W]));break;case"stroke-opacity":ue("/CA "+R(S[W]))}ue(">>"),ue("endobj")},Hr=function(){var S;for(S in gr)gr.hasOwnProperty(S)&&sr(gr[S])},os=function(){for(var S in ue("/XObject <<"),en)en.hasOwnProperty(S)&&en[S].objectNumber>=0&&ue("/"+S+" "+en[S].objectNumber+" 0 R");Ht.publish("putXobjectDict"),ue(">>")},na=function(){Pn.oid=Or(),ue("<<"),ue("/Filter /Standard"),ue("/V "+Pn.v),ue("/R "+Pn.r),ue("/U <"+Pn.toHexString(Pn.U)+">"),ue("/O <"+Pn.toHexString(Pn.O)+">"),ue("/P "+Pn.P),ue(">>"),ue("endobj")},Os=function(){for(var S in ue("/Font <<"),Gt)Gt.hasOwnProperty(S)&&(p===!1||p===!0&&m.hasOwnProperty(S))&&ue("/"+S+" "+Gt[S].objectNumber+" 0 R");ue(">>")},ls=function(){if(Object.keys(Bt).length>0){for(var S in ue("/Shading <<"),Bt)Bt.hasOwnProperty(S)&&Bt[S]instanceof so&&Bt[S].objectNumber>=0&&ue("/"+S+" "+Bt[S].objectNumber+" 0 R");Ht.publish("putShadingPatternDict"),ue(">>")}},Ds=function(S){if(Object.keys(Bt).length>0){for(var W in ue("/Pattern <<"),Bt)Bt.hasOwnProperty(W)&&Bt[W]instanceof h.TilingPattern&&Bt[W].objectNumber>=0&&Bt[W].objectNumber<S&&ue("/"+W+" "+Bt[W].objectNumber+" 0 R");Ht.publish("putTilingPatternDict"),ue(">>")}},bi=function(){if(Object.keys(gr).length>0){var S;for(S in ue("/ExtGState <<"),gr)gr.hasOwnProperty(S)&&gr[S].objectNumber>=0&&ue("/"+S+" "+gr[S].objectNumber+" 0 R");Ht.publish("putGStateDict"),ue(">>")}},Dr=function(S){K(S.resourcesOid,!0),ue("<<"),ue("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Os(),ls(),Ds(S.objectOid),bi(),os(),ue(">>"),ue("endobj")},Ld=function(){var S=[];He(),Hr(),st(),Yt(S),Ht.publish("putResources"),S.forEach(Dr),Dr({resourcesOid:ne,objectOid:Number.MAX_SAFE_INTEGER}),Ht.publish("postPutResources")},Fd=function(){Ht.publish("putAdditionalObjects");for(var S=0;S<ve.length;S++){var W=ve[S];K(W.objId,!0),ue(W.content),ue("endobj")}Ht.publish("postPutAdditionalObjects")},Od=function(S){fr[S.fontName]=fr[S.fontName]||{},fr[S.fontName][S.fontStyle]=S.id},vu=function(S,W,ce,me,be){var Le={id:"F"+(Object.keys(Gt).length+1).toString(10),postScriptName:S,fontName:W,fontStyle:ce,encoding:me,isStandardFont:be||!1,metadata:{}};return Ht.publish("addFont",{font:Le,instance:this}),Gt[Le.id]=Le,Od(Le),Le.id},Hp=function(S){for(var W=0,ce=ze.length;W<ce;W++){var me=vu.call(this,S[W][0],S[W][1],S[W][2],ze[W][3],!0);p===!1&&(m[me]=!0);var be=S[W][0].split("-");Od({id:me,fontName:be[0],fontStyle:be[1]||""})}Ht.publish("addFonts",{fonts:Gt,dictionary:fr})},cs=function(S){return S.foo=function(){try{return S.apply(this,arguments)}catch(me){var W=me.stack||"";~W.indexOf(" at ")&&(W=W.split(" at ")[1]);var ce="Error in function "+W.split(`
`)[0].split("<")[0]+": "+me.message;if(!vt.console)throw new Error(ce);vt.console.error(ce,me),vt.alert&&alert(ce)}},S.foo.bar=S,S.foo},Bl=function(S,W){var ce,me,be,Le,We,ot,ht,Et,Nt;if(be=(W=W||{}).sourceEncoding||"Unicode",We=W.outputEncoding,(W.autoencode||We)&&Gt[Ct].metadata&&Gt[Ct].metadata[be]&&Gt[Ct].metadata[be].encoding&&(Le=Gt[Ct].metadata[be].encoding,!We&&Gt[Ct].encoding&&(We=Gt[Ct].encoding),!We&&Le.codePages&&(We=Le.codePages[0]),typeof We=="string"&&(We=Le[We]),We)){for(ht=!1,ot=[],ce=0,me=S.length;ce<me;ce++)(Et=We[S.charCodeAt(ce)])?ot.push(String.fromCharCode(Et)):ot.push(S[ce]),ot[ce].charCodeAt(0)>>8&&(ht=!0);S=ot.join("")}for(ce=S.length;ht===void 0&&ce!==0;)S.charCodeAt(ce-1)>>8&&(ht=!0),ce--;if(!ht)return S;for(ot=W.noBOM?[]:[254,255],ce=0,me=S.length;ce<me;ce++){if((Nt=(Et=S.charCodeAt(ce))>>8)>>8)throw new Error("Character at position "+ce+" of string '"+S+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ot.push(Nt),ot.push(Et-(Nt<<8))}return String.fromCharCode.apply(void 0,ot)},ni=h.__private__.pdfEscape=h.pdfEscape=function(S,W){return Bl(S,W).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yu=h.__private__.beginPage=function(S){Ee[++lr]=[],_t[lr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},Id(lr),je(Ee[I])},Dd=function(S,W){var ce,me,be;switch(r=W||r,typeof S=="string"&&(ce=y(S.toLowerCase()),Array.isArray(ce)&&(me=ce[0],be=ce[1])),Array.isArray(S)&&(me=S[0]*nt,be=S[1]*nt),isNaN(me)&&(me=i[0],be=i[1]),(me>14400||be>14400)&&(ur.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),me=Math.min(14400,me),be=Math.min(14400,be)),i=[me,be],r.substr(0,1)){case"l":be>me&&(i=[be,me]);break;case"p":me>be&&(i=[be,me])}yu(i),Wd(Su),ue(us),ku!==0&&ue(ku+" J"),Eu!==0&&ue(Eu+" j"),Ht.publish("addPage",{pageNumber:lr})},$p=function(S){S>0&&S<=lr&&(Ee.splice(S,1),_t.splice(S,1),lr--,I>lr&&(I=lr),this.setPage(I))},Id=function(S){S>0&&S<=lr&&(I=S)},qp=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Ee.length-1},Rd=function(S,W,ce){var me,be=void 0;return ce=ce||{},S=S!==void 0?S:Gt[Ct].fontName,W=W!==void 0?W:Gt[Ct].fontStyle,me=S.toLowerCase(),fr[me]!==void 0&&fr[me][W]!==void 0?be=fr[me][W]:fr[S]!==void 0&&fr[S][W]!==void 0?be=fr[S][W]:ce.disableWarning===!1&&ur.warn("Unable to look up font label for font '"+S+"', '"+W+"'. Refer to getFontList() for available fonts."),be||ce.noFallback||(be=fr.times[W])==null&&(be=fr.times.normal),be},Vp=h.__private__.putInfo=function(){var S=Or(),W=function(me){return me};for(var ce in f!==null&&(W=Pn.encryptor(S,0)),ue("<<"),ue("/Producer ("+ni(W("jsPDF "+pt.version))+")"),xt)xt.hasOwnProperty(ce)&&xt[ce]&&ue("/"+ce.substr(0,1).toUpperCase()+ce.substr(1)+" ("+ni(W(xt[ce]))+")");ue("/CreationDate ("+ni(W(te))+")"),ue(">>"),ue("endobj")},wu=h.__private__.putCatalog=function(S){var W=(S=S||{}).rootDictionaryObjId||re;switch(Or(),ue("<<"),ue("/Type /Catalog"),ue("/Pages "+W+" 0 R"),Ze||(Ze="fullwidth"),Ze){case"fullwidth":ue("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ue("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ue("/OpenAction [3 0 R /Fit]");break;case"original":ue("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ce=""+Ze;ce.substr(ce.length-1)==="%"&&(Ze=parseInt(Ze)/100),typeof Ze=="number"&&ue("/OpenAction [3 0 R /XYZ null null "+R(Ze)+"]")}switch(At||(At="continuous"),At){case"continuous":ue("/PageLayout /OneColumn");break;case"single":ue("/PageLayout /SinglePage");break;case"two":case"twoleft":ue("/PageLayout /TwoColumnLeft");break;case"tworight":ue("/PageLayout /TwoColumnRight")}dt&&ue("/PageMode /"+dt),Ht.publish("putCatalog"),ue(">>"),ue("endobj")},Gp=h.__private__.putTrailer=function(){ue("trailer"),ue("<<"),ue("/Size "+(H+1)),ue("/Root "+H+" 0 R"),ue("/Info "+(H-1)+" 0 R"),f!==null&&ue("/Encrypt "+Pn.oid+" 0 R"),ue("/ID [ <"+z+"> <"+z+"> ]"),ue(">>")},Yp=h.__private__.putHeader=function(){ue("%PDF-"+v),ue("%")},Kp=h.__private__.putXRef=function(){var S="0000000000";ue("xref"),ue("0 "+(H+1)),ue("0000000000 65535 f ");for(var W=1;W<=H;W++)typeof se[W]=="function"?ue((S+se[W]()).slice(-10)+" 00000 n "):se[W]!==void 0?ue((S+se[W]).slice(-10)+" 00000 n "):ue("0000000000 00000 n ")},ia=h.__private__.buildDocument=function(){Qe(),je(fe),Ht.publish("buildDocument"),Yp(),Ae(),Fd(),Ld(),f!==null&&na(),Vp(),wu();var S=de;return Kp(),Gp(),ue("startxref"),ue(""+S),ue("%%EOF"),je(Ee[I]),fe.join(`
`)},Ul=h.__private__.getBlob=function(S){return new Blob([at(S)],{type:"application/pdf"})},zl=h.output=h.__private__.output=cs(function(S,W){switch(typeof(W=W||{})=="string"?W={filename:W}:W.filename=W.filename||"generated.pdf",S){case void 0:return ia();case"save":h.save(W.filename);break;case"arraybuffer":return at(ia());case"blob":return Ul(ia());case"bloburi":case"bloburl":if(vt.URL!==void 0&&typeof vt.URL.createObjectURL=="function")return vt.URL&&vt.URL.createObjectURL(Ul(ia()))||void 0;ur.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ce="",me=ia();try{ce=Ug(me)}catch{ce=Ug(unescape(encodeURIComponent(me)))}return"data:application/pdf;filename="+W.filename+";base64,"+ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(vt)==="[object Window]"){var be="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Le=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';W.pdfObjectUrl&&(be=W.pdfObjectUrl,Le="");var We='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+be+'"'+Le+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(W)+");<\/script></body></html>",ot=vt.open();return ot!==null&&ot.document.write(We),ot}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(vt)==="[object Window]"){var ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(W.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+W.filename+'" width="500px" height="400px" /></body></html>',Et=vt.open();if(Et!==null){Et.document.write(ht);var Nt=this;Et.document.documentElement.querySelector("#pdfViewer").onload=function(){Et.document.title=W.filename,Et.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Nt.output("bloburl"))}}return Et}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(vt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",W)+'"></iframe></body></html>',_r=vt.open();if(_r!==null&&(_r.document.write(Mt),_r.document.title=W.filename),_r||typeof safari>"u")return _r;break;case"datauri":case"dataurl":return vt.document.location.href=this.output("datauristring",W);default:return null}}),Md=function(S){return Array.isArray(ra)===!0&&ra.indexOf(S)>-1};switch(n){case"pt":nt=1;break;case"mm":nt=72/25.4;break;case"cm":nt=72/2.54;break;case"in":nt=72;break;case"px":nt=Md("px_scaling")==1?.75:96/72;break;case"pc":case"em":nt=12;break;case"ex":nt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);nt=n}var Pn=null;he(),G();var Xp=function(S){return f!==null?Pn.encryptor(S,0):function(W){return W}},Bd=h.__private__.getPageInfo=h.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_t[S].objId,pageNumber:S,pageContext:_t[S]}},St=h.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var W in _t)if(_t[W].objId===S)break;return Bd(W)},Jp=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:_t[I].objId,pageNumber:I,pageContext:_t[I]}};h.addPage=function(){return Dd.apply(this,arguments),this},h.setPage=function(){return Id.apply(this,arguments),je.call(this,Ee[I]),this},h.insertPage=function(S){return this.addPage(),this.movePage(I,S),this},h.movePage=function(S,W){var ce,me;if(S>W){ce=Ee[S],me=_t[S];for(var be=S;be>W;be--)Ee[be]=Ee[be-1],_t[be]=_t[be-1];Ee[W]=ce,_t[W]=me,this.setPage(W)}else if(S<W){ce=Ee[S],me=_t[S];for(var Le=S;Le<W;Le++)Ee[Le]=Ee[Le+1],_t[Le]=_t[Le+1];Ee[W]=ce,_t[W]=me,this.setPage(W)}return this},h.deletePage=function(){return $p.apply(this,arguments),this},h.__private__.text=h.text=function(S,W,ce,me,be){var Le,We,ot,ht,Et,Nt,Mt,_r,Tr,$r=(me=me||{}).scope||this;if(typeof S=="number"&&typeof W=="number"&&(typeof ce=="string"||Array.isArray(ce))){var Ln=ce;ce=W,W=S,S=Ln}if(arguments[3]instanceof mt?(C("The transform parameter of text() with a Matrix value"),Tr=be):(ot=arguments[4],ht=arguments[5],tr(Mt=arguments[3])==="object"&&Mt!==null||(typeof ot=="string"&&(ht=ot,ot=null),typeof Mt=="string"&&(ht=Mt,Mt=null),typeof Mt=="number"&&(ot=Mt,Mt=null),me={flags:Mt,angle:ot,align:ht})),isNaN(W)||isNaN(ce)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return $r;var ln="",fs=!1,_i=typeof me.lineHeightFactor=="number"?me.lineHeightFactor:Wo,Ms=$r.internal.scaleFactor;function Yd(dr){return dr=dr.split("	").join(Array(me.TabLen||9).join(" ")),ni(dr,Mt)}function Pu(dr){for(var hr,Rr=dr.concat(),tn=[],ca=Rr.length;ca--;)typeof(hr=Rr.shift())=="string"?tn.push(hr):Array.isArray(dr)&&(hr.length===1||hr[1]===void 0&&hr[2]===void 0)?tn.push(hr[0]):tn.push([hr[0],hr[1],hr[2]]);return tn}function Lu(dr,hr){var Rr;if(typeof dr=="string")Rr=hr(dr)[0];else if(Array.isArray(dr)){for(var tn,ca,Uu=dr.concat(),rc=[],Zd=Uu.length;Zd--;)typeof(tn=Uu.shift())=="string"?rc.push(hr(tn)[0]):Array.isArray(tn)&&typeof tn[0]=="string"&&(ca=hr(tn[0],tn[1],tn[2]),rc.push([ca[0],ca[1],ca[2]]));Rr=rc}return Rr}var Gl=!1,Fu=!0;if(typeof S=="string")Gl=!0;else if(Array.isArray(S)){var Ou=S.concat();We=[];for(var Yl,vn=Ou.length;vn--;)(typeof(Yl=Ou.shift())!="string"||Array.isArray(Yl)&&typeof Yl[0]!="string")&&(Fu=!1);Gl=Fu}if(Gl===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var Kl=Ye/$r.internal.scaleFactor,Xl=Kl*(_i-1);switch(me.baseline){case"bottom":ce-=Xl;break;case"top":ce+=Kl-Xl;break;case"hanging":ce+=Kl-2*Xl;break;case"middle":ce+=Kl/2-Xl}if((Nt=me.maxWidth||0)>0&&(typeof S=="string"?S=$r.splitTextToSize(S,Nt):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(dr,hr){return dr.concat($r.splitTextToSize(hr,Nt))},[]))),Le={text:S,x:W,y:ce,options:me,mutex:{pdfEscape:ni,activeFontKey:Ct,fonts:Gt,activeFontSize:Ye}},Ht.publish("preProcessText",Le),S=Le.text,ot=(me=Le.options).angle,!(Tr instanceof mt)&&ot&&typeof ot=="number"){ot*=Math.PI/180,me.rotationDirection===0&&(ot=-ot),_===w.ADVANCED&&(ot=-ot);var Jl=Math.cos(ot),Du=Math.sin(ot);Tr=new mt(Jl,Du,-Du,Jl,0,0)}else ot&&ot instanceof mt&&(Tr=ot);_!==w.ADVANCED||Tr||(Tr=ri),(Et=me.charSpace||$l)!==void 0&&(ln+=T(A(Et))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(_r=me.horizontalScale)!==void 0&&(ln+=T(100*_r)+` Tz
`),me.lang;var ii=-1,om=me.renderingMode!==void 0?me.renderingMode:me.stroke,Iu=$r.internal.getCurrentPageInfo().pageContext;switch(om){case 0:case!1:case"fill":ii=0;break;case 1:case!0:case"stroke":ii=1;break;case 2:case"fillThenStroke":ii=2;break;case 3:case"invisible":ii=3;break;case 4:case"fillAndAddForClipping":ii=4;break;case 5:case"strokeAndAddPathForClipping":ii=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ii=6;break;case 7:case"addToPathForClipping":ii=7}var Kd=Iu.usedRenderingMode!==void 0?Iu.usedRenderingMode:-1;ii!==-1?ln+=ii+` Tr
`:Kd!==-1&&(ln+=`0 Tr
`),ii!==-1&&(Iu.usedRenderingMode=ii),ht=me.align||"left";var Hi,Ql=Ye*_i,Xd=$r.internal.pageSize.getWidth(),Jd=Gt[Ct];Et=me.charSpace||$l,Nt=me.maxWidth||0,Mt=Object.assign({autoencode:!0,noBOM:!0},me.flags);var Da=[],qo=function(dr){return $r.getStringUnitWidth(dr,{font:Jd,charSpace:Et,fontSize:Ye,doKerning:!1})*Ye/Ms};if(Object.prototype.toString.call(S)==="[object Array]"){var si;We=Pu(S),ht!=="left"&&(Hi=We.map(qo));var $n,Ia=0;if(ht==="right"){W-=Hi[0],S=[],vn=We.length;for(var aa=0;aa<vn;aa++)aa===0?($n=Rs(W),si=sa(ce)):($n=A(Ia-Hi[aa]),si=-Ql),S.push([We[aa],$n,si]),Ia=Hi[aa]}else if(ht==="center"){W-=Hi[0]/2,S=[],vn=We.length;for(var oa=0;oa<vn;oa++)oa===0?($n=Rs(W),si=sa(ce)):($n=A((Ia-Hi[oa])/2),si=-Ql),S.push([We[oa],$n,si]),Ia=Hi[oa]}else if(ht==="left"){S=[],vn=We.length;for(var Zl=0;Zl<vn;Zl++)S.push(We[Zl])}else if(ht==="justify"&&Jd.encoding==="Identity-H"){S=[],vn=We.length,Nt=Nt!==0?Nt:Xd;for(var la=0,Ir=0;Ir<vn;Ir++)if(si=Ir===0?sa(ce):-Ql,$n=Ir===0?Rs(W):la,Ir<vn-1){var Ru=A((Nt-Hi[Ir])/(We[Ir].split(" ").length-1)),qn=We[Ir].split(" ");S.push([qn[0]+" ",$n,si]),la=0;for(var $i=1;$i<qn.length;$i++){var ec=(qo(qn[$i-1]+" "+qn[$i])-qo(qn[$i]))*Ms+Ru;$i==qn.length-1?S.push([qn[$i],ec,0]):S.push([qn[$i]+" ",ec,0]),la-=ec}}else S.push([We[Ir],$n,si]);S.push(["",la,0])}else{if(ht!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],vn=We.length,Nt=Nt!==0?Nt:Xd,Ir=0;Ir<vn;Ir++)si=Ir===0?sa(ce):-Ql,$n=Ir===0?Rs(W):0,Ir<vn-1?Da.push(T(A((Nt-Hi[Ir])/(We[Ir].split(" ").length-1)))):Da.push(0),S.push([We[Ir],$n,si])}}var Qd=typeof me.R2L=="boolean"?me.R2L:ft;Qd===!0&&(S=Lu(S,function(dr,hr,Rr){return[dr.split("").reverse().join(""),hr,Rr]})),Le={text:S,x:W,y:ce,options:me,mutex:{pdfEscape:ni,activeFontKey:Ct,fonts:Gt,activeFontSize:Ye}},Ht.publish("postProcessText",Le),S=Le.text,fs=Le.mutex.isHex||!1;var Mu=Gt[Ct].encoding;Mu!=="WinAnsiEncoding"&&Mu!=="StandardEncoding"||(S=Lu(S,function(dr,hr,Rr){return[Yd(dr),hr,Rr]})),We=Pu(S),S=[];for(var Vo,Go,Ra,Yo=0,tc=1,Ko=Array.isArray(We[0])?tc:Yo,Ma="",Bu=function(dr,hr,Rr){var tn="";return Rr instanceof mt?(Rr=typeof me.angle=="number"?wi(Rr,new mt(1,0,0,1,dr,hr)):wi(new mt(1,0,0,1,dr,hr),Rr),_===w.ADVANCED&&(Rr=wi(new mt(1,0,0,-1,0,0),Rr)),tn=Rr.join(" ")+` Tm
`):tn=T(dr)+" "+T(hr)+` Td
`,tn},qi=0;qi<We.length;qi++){switch(Ma="",Ko){case tc:Ra=(fs?"<":"(")+We[qi][0]+(fs?">":")"),Vo=parseFloat(We[qi][1]),Go=parseFloat(We[qi][2]);break;case Yo:Ra=(fs?"<":"(")+We[qi]+(fs?">":")"),Vo=Rs(W),Go=sa(ce)}Da!==void 0&&Da[qi]!==void 0&&(Ma=Da[qi]+` Tw
`),qi===0?S.push(Ma+Bu(Vo,Go,Tr)+Ra):Ko===Yo?S.push(Ma+Ra):Ko===tc&&S.push(Ma+Bu(Vo,Go,Tr)+Ra)}S=Ko===Yo?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var Vi=`BT
/`;return Vi+=Ct+" "+Ye+` Tf
`,Vi+=T(Ye*_i)+` TL
`,Vi+=Ho+`
`,Vi+=ln,Vi+=S,ue(Vi+="ET"),m[Ct]=!0,$r};var Qp=h.__private__.clip=h.clip=function(S){return ue(S==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Qp("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ue("n"),this};var Is=h.__private__.isValidStyle=function(S){var W=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(W=!0),W};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(S){return Is(S)&&(u=S),this};var Ud=h.__private__.getStyle=h.getStyle=function(S){var W=u;switch(S){case"D":case"S":W="S";break;case"F":W="f";break;case"FD":case"DF":W="B";break;case"f":case"f*":case"B":case"B*":W=S}return W},zd=h.close=function(){return ue("h"),this};h.stroke=function(){return ue("S"),this},h.fill=function(S){return Wl("f",S),this},h.fillEvenOdd=function(S){return Wl("f*",S),this},h.fillStroke=function(S){return Wl("B",S),this},h.fillStrokeEvenOdd=function(S){return Wl("B*",S),this};var Wl=function(S,W){tr(W)==="object"?em(W,S):ue(S)},bu=function(S){S===null||_===w.ADVANCED&&S===void 0||(S=Ud(S),ue(S))};function Zp(S,W,ce,me,be){var Le=new cl(W||this.boundingBox,ce||this.xStep,me||this.yStep,this.gState,be||this.matrix);Le.stream=this.stream;var We=S+"$$"+this.cloneIndex+++"$$";return Cn(We,Le),Le}var em=function(S,W){var ce=Fs[S.key],me=Bt[ce];if(me instanceof so)ue("q"),ue(tm(W)),me.gState&&h.setGState(me.gState),ue(S.matrix.toString()+" cm"),ue("/"+ce+" sh"),ue("Q");else if(me instanceof cl){var be=new mt(1,0,0,-1,0,Oa());S.matrix&&(be=be.multiply(S.matrix||ri),ce=Zp.call(me,S.key,S.boundingBox,S.xStep,S.yStep,be).id),ue("q"),ue("/Pattern cs"),ue("/"+ce+" scn"),me.gState&&h.setGState(me.gState),ue(W),ue("Q")}},tm=function(S){switch(S){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},_u=h.moveTo=function(S,W){return ue(T(A(S))+" "+T(J(W))+" m"),this},zo=h.lineTo=function(S,W){return ue(T(A(S))+" "+T(J(W))+" l"),this},La=h.curveTo=function(S,W,ce,me,be,Le){return ue([T(A(S)),T(J(W)),T(A(ce)),T(J(me)),T(A(be)),T(J(Le)),"c"].join(" ")),this};h.__private__.line=h.line=function(S,W,ce,me,be){if(isNaN(S)||isNaN(W)||isNaN(ce)||isNaN(me)||!Is(be))throw new Error("Invalid arguments passed to jsPDF.line");return _===w.COMPAT?this.lines([[ce-S,me-W]],S,W,[1,1],be||"S"):this.lines([[ce-S,me-W]],S,W,[1,1]).stroke()},h.__private__.lines=h.lines=function(S,W,ce,me,be,Le){var We,ot,ht,Et,Nt,Mt,_r,Tr,$r,Ln,ln,fs;if(typeof S=="number"&&(fs=ce,ce=W,W=S,S=fs),me=me||[1,1],Le=Le||!1,isNaN(W)||isNaN(ce)||!Array.isArray(S)||!Array.isArray(me)||!Is(be)||typeof Le!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(_u(W,ce),We=me[0],ot=me[1],Et=S.length,Ln=W,ln=ce,ht=0;ht<Et;ht++)(Nt=S[ht]).length===2?(Ln=Nt[0]*We+Ln,ln=Nt[1]*ot+ln,zo(Ln,ln)):(Mt=Nt[0]*We+Ln,_r=Nt[1]*ot+ln,Tr=Nt[2]*We+Ln,$r=Nt[3]*ot+ln,Ln=Nt[4]*We+Ln,ln=Nt[5]*ot+ln,La(Mt,_r,Tr,$r,Ln,ln));return Le&&zd(),bu(be),this},h.path=function(S){for(var W=0;W<S.length;W++){var ce=S[W],me=ce.c;switch(ce.op){case"m":_u(me[0],me[1]);break;case"l":zo(me[0],me[1]);break;case"c":La.apply(this,me);break;case"h":zd()}}return this},h.__private__.rect=h.rect=function(S,W,ce,me,be){if(isNaN(S)||isNaN(W)||isNaN(ce)||isNaN(me)||!Is(be))throw new Error("Invalid arguments passed to jsPDF.rect");return _===w.COMPAT&&(me=-me),ue([T(A(S)),T(J(W)),T(A(ce)),T(A(me)),"re"].join(" ")),bu(be),this},h.__private__.triangle=h.triangle=function(S,W,ce,me,be,Le,We){if(isNaN(S)||isNaN(W)||isNaN(ce)||isNaN(me)||isNaN(be)||isNaN(Le)||!Is(We))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ce-S,me-W],[be-ce,Le-me],[S-be,W-Le]],S,W,[1,1],We,!0),this},h.__private__.roundedRect=h.roundedRect=function(S,W,ce,me,be,Le,We){if(isNaN(S)||isNaN(W)||isNaN(ce)||isNaN(me)||isNaN(be)||isNaN(Le)||!Is(We))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ot=4/3*(Math.SQRT2-1);return be=Math.min(be,.5*ce),Le=Math.min(Le,.5*me),this.lines([[ce-2*be,0],[be*ot,0,be,Le-Le*ot,be,Le],[0,me-2*Le],[0,Le*ot,-be*ot,Le,-be,Le],[2*be-ce,0],[-be*ot,0,-be,-Le*ot,-be,-Le],[0,2*Le-me],[0,-Le*ot,be*ot,-Le,be,-Le]],S+be,W,[1,1],We,!0),this},h.__private__.ellipse=h.ellipse=function(S,W,ce,me,be){if(isNaN(S)||isNaN(W)||isNaN(ce)||isNaN(me)||!Is(be))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Le=4/3*(Math.SQRT2-1)*ce,We=4/3*(Math.SQRT2-1)*me;return _u(S+ce,W),La(S+ce,W-We,S+Le,W-me,S,W-me),La(S-Le,W-me,S-ce,W-We,S-ce,W),La(S-ce,W+We,S-Le,W+me,S,W+me),La(S+Le,W+me,S+ce,W+We,S+ce,W),bu(be),this},h.__private__.circle=h.circle=function(S,W,ce,me){if(isNaN(S)||isNaN(W)||isNaN(ce)||!Is(me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,W,ce,ce,me)},h.setFont=function(S,W,ce){return ce&&(W=D(W,ce)),Ct=Rd(S,W,{disableWarning:!1}),this};var rm=h.__private__.getFont=h.getFont=function(){return Gt[Rd.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var S,W,ce={};for(S in fr)if(fr.hasOwnProperty(S))for(W in ce[S]=[],fr[S])fr[S].hasOwnProperty(W)&&ce[S].push(W);return ce},h.addFont=function(S,W,ce,me,be){var Le=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Le.indexOf(arguments[3])!==-1?be=arguments[3]:arguments[3]&&Le.indexOf(arguments[3])==-1&&(ce=D(ce,me)),be=be||"Identity-H",vu.call(this,S,W,ce,be)};var Wo,Su=e.lineWidth||.200025,Hl=h.__private__.getLineWidth=h.getLineWidth=function(){return Su},Wd=h.__private__.setLineWidth=h.setLineWidth=function(S){return Su=S,ue(T(A(S))+" w"),this};h.__private__.setLineDash=pt.API.setLineDash=pt.API.setLineDashPattern=function(S,W){if(S=S||[],W=W||0,isNaN(W)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(ce){return T(A(ce))}).join(" "),W=T(A(W)),ue("["+S+"] "+W+" d"),this};var Hd=h.__private__.getLineHeight=h.getLineHeight=function(){return Ye*Wo};h.__private__.getLineHeight=h.getLineHeight=function(){return Ye*Wo};var $d=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(Wo=S),this},qd=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Wo};$d(e.lineHeight);var Rs=h.__private__.getHorizontalCoordinate=function(S){return A(S)},sa=h.__private__.getVerticalCoordinate=function(S){return _===w.ADVANCED?S:_t[I].mediaBox.topRightY-_t[I].mediaBox.bottomLeftY-A(S)},nm=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(S){return T(Rs(S))},Fa=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(S){return T(sa(S))},us=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ae(us)},h.__private__.setStrokeColor=h.setDrawColor=function(S,W,ce,me){return us=le({ch1:S,ch2:W,ch3:ce,ch4:me,pdfColorType:"draw",precision:2}),ue(us),this};var Nu=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ae(Nu)},h.__private__.setFillColor=h.setFillColor=function(S,W,ce,me){return Nu=le({ch1:S,ch2:W,ch3:ce,ch4:me,pdfColorType:"fill",precision:2}),ue(Nu),this};var Ho=e.textColor||"0 g",im=h.__private__.getTextColor=h.getTextColor=function(){return ae(Ho)};h.__private__.setTextColor=h.setTextColor=function(S,W,ce,me){return Ho=le({ch1:S,ch2:W,ch3:ce,ch4:me,pdfColorType:"text",precision:3}),this};var $l=e.charSpace,sm=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat($l||0)};h.__private__.setCharSpace=h.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return $l=S,this};var ku=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(S){var W=h.CapJoinStyles[S];if(W===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ku=W,ue(W+" J"),this};var Eu=0;h.__private__.setLineJoin=h.setLineJoin=function(S){var W=h.CapJoinStyles[S];if(W===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Eu=W,ue(W+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ue(T(A(S))+" M"),this},h.GState=ld,h.setGState=function(S){(S=typeof S=="string"?gr[yi[S]]:Vd(null,S)).equals(as)||(ue("/"+S.id+" gs"),as=S)};var Vd=function(S,W){if(!S||!yi[S]){var ce=!1;for(var me in gr)if(gr.hasOwnProperty(me)&&gr[me].equals(W)){ce=!0;break}if(ce)W=gr[me];else{var be="GS"+(Object.keys(gr).length+1).toString(10);gr[be]=W,W.id=be}return S&&(yi[S]=W.id),Ht.publish("addGState",W),W}};h.addGState=function(S,W){return Vd(S,W),this},h.saveGraphicsState=function(){return ue("q"),Ui.push({key:Ct,size:Ye,color:Ho}),this},h.restoreGraphicsState=function(){ue("Q");var S=Ui.pop();return Ct=S.key,Ye=S.size,Ho=S.color,as=null,this},h.setCurrentTransformationMatrix=function(S){return ue(S.toString()+" cm"),this},h.comment=function(S){return ue("#"+S),this};var ql=function(S,W){var ce=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ce},set:function(Le){isNaN(Le)||(ce=parseFloat(Le))}});var me=W||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return me},set:function(Le){isNaN(Le)||(me=parseFloat(Le))}});var be="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return be},set:function(Le){be=Le.toString()}}),this},Au=function(S,W,ce,me){ql.call(this,S,W),this.type="rect";var be=ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return be},set:function(We){isNaN(We)||(be=parseFloat(We))}});var Le=me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Le},set:function(We){isNaN(We)||(Le=parseFloat(We))}}),this},Tu=function(){this.page=lr,this.currentPage=I,this.pages=Ee.slice(0),this.pagesContext=_t.slice(0),this.x=Zr,this.y=Rt,this.matrix=ti,this.width=$o(I),this.height=Oa(I),this.outputDestination=qe,this.id="",this.objectNumber=-1};Tu.prototype.restore=function(){lr=this.page,I=this.currentPage,_t=this.pagesContext,Ee=this.pages,Zr=this.x,Rt=this.y,ti=this.matrix,ju(I,this.width),Cu(I,this.height),qe=this.outputDestination};var Gd=function(S,W,ce,me,be){Wi.push(new Tu),lr=I=0,Ee=[],Zr=S,Rt=W,ti=be,yu([ce,me])},am=function(S){if(zi[S])Wi.pop().restore();else{var W=new Tu,ce="Xo"+(Object.keys(en).length+1).toString(10);W.id=ce,zi[S]=ce,en[ce]=W,Ht.publish("addFormObject",W),Wi.pop().restore()}};for(var Vl in h.beginFormObject=function(S,W,ce,me,be){return Gd(S,W,ce,me,be),this},h.endFormObject=function(S){return am(S),this},h.doFormObject=function(S,W){var ce=en[zi[S]];return ue("q"),ue(W.toString()+" cm"),ue("/"+ce.id+" Do"),ue("Q"),this},h.getFormObject=function(S){var W=en[zi[S]];return{x:W.x,y:W.y,width:W.width,height:W.height,matrix:W.matrix}},h.save=function(S,W){return S=S||"generated.pdf",(W=W||{}).returnPromise=W.returnPromise||!1,W.returnPromise===!1?(nl(Ul(ia()),S),typeof nl.unload=="function"&&vt.setTimeout&&setTimeout(nl.unload,911),this):new Promise(function(ce,me){try{var be=nl(Ul(ia()),S);typeof nl.unload=="function"&&vt.setTimeout&&setTimeout(nl.unload,911),ce(be)}catch(Le){me(Le.message)}})},pt.API)pt.API.hasOwnProperty(Vl)&&(Vl==="events"&&pt.API.events.length?function(S,W){var ce,me,be;for(be=W.length-1;be!==-1;be--)ce=W[be][0],me=W[be][1],S.subscribe.apply(S,[ce].concat(typeof me=="function"?[me]:me))}(Ht,pt.API.events):h[Vl]=pt.API[Vl]);var $o=h.getPageWidth=function(S){return(_t[S=S||I].mediaBox.topRightX-_t[S].mediaBox.bottomLeftX)/nt},ju=h.setPageWidth=function(S,W){_t[S].mediaBox.topRightX=W*nt+_t[S].mediaBox.bottomLeftX},Oa=h.getPageHeight=function(S){return(_t[S=S||I].mediaBox.topRightY-_t[S].mediaBox.bottomLeftY)/nt},Cu=h.setPageHeight=function(S,W){_t[S].mediaBox.topRightY=W*nt+_t[S].mediaBox.bottomLeftY};return h.internal={pdfEscape:ni,getStyle:Ud,getFont:rm,getFontSize:tt,getCharSpace:sm,getTextColor:im,getLineHeight:Hd,getLineHeightFactor:qd,getLineWidth:Hl,write:Me,getHorizontalCoordinate:Rs,getVerticalCoordinate:sa,getCoordinateString:nm,getVerticalCoordinateString:Fa,collections:{},newObject:Or,newAdditionalObject:oe,newObjectDeferred:Ar,newObjectDeferredBegin:K,getFilters:Se,putStream:Ce,events:Ht,scaleFactor:nt,pageSize:{getWidth:function(){return $o(I)},setWidth:function(S){ju(I,S)},getHeight:function(){return Oa(I)},setHeight:function(S){Cu(I,S)}},encryptionOptions:f,encryption:Pn,getEncryptor:Xp,output:zl,getNumberOfPages:qp,pages:Ee,out:ue,f2:R,f3:j,getPageInfo:Bd,getPageInfoByObjId:St,getCurrentPageInfo:Jp,getPDFVersion:x,Point:ql,Rectangle:Au,Matrix:mt,hasHotfix:Md},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return $o(I)},set:function(S){ju(I,S)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Oa(I)},set:function(S){Cu(I,S)},enumerable:!0,configurable:!0}),Hp.call(h,ze),Ct="F1",Dd(i,r),Ht.publish("initialized"),h}yc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},yc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},yc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},yc.prototype.processOwnerPassword=function(e,t){return Wg(zg(t).substr(0,5),e)},yc.prototype.encryptor=function(e,t){var r=zg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Wg(r,n)}},ld.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||tr(e)!==tr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},pt.API={events:[]},pt.version="2.5.2";var Cr=pt.API,ix=1,Fl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},kt=function(e){return e.toFixed(2)},Ka=function(e){return e.toFixed(5)};Cr.__acroform__={};var vi=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Ky=function(e){return e*ix},Ws=function(e){var t=new P_,r=ut.internal.getHeight(e)||0,n=ut.internal.getWidth(e)||0;return t.BBox=[0,0,Number(kt(n)),Number(kt(r))],t},PC=Cr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},LC=Cr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},FC=Cr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Br=Cr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return FC(e,t-1)},Ur=Cr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return PC(e,t-1)},zr=Cr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return LC(e,t-1)},OC=Cr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],a=e[2],o=e[3],l={};return l.lowerLeft_X=r(i)||0,l.lowerLeft_Y=n(s+o)||0,l.upperRight_X=r(i+a)||0,l.upperRight_Y=n(s)||0,[Number(kt(l.lowerLeft_X)),Number(kt(l.lowerLeft_Y)),Number(kt(l.upperRight_X)),Number(kt(l.upperRight_Y))]},DC=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Hg(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+kt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Ws(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},Hg=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(j){return j.split(`
`)}):i.map(function(j){return[j]});var s=r,a=ut.internal.getHeight(e)||0;a=a<0?-a:a;var o=ut.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(j,A,q){if(j+1<i.length){var J=A+" "+i[j+1][0];return Wh(J,e,q).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var u,f,p=Wh("3",e,s).height,m=e.multiline?a-s:(a-p)/2,h=m+=2,v=0,x=0,b=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Wh(t,e,s=12).width+", FieldWidth:"+o+`
`;break}for(var y="",w=0,_=0;_<i.length;_++)if(i.hasOwnProperty(_)){var E=!1;if(i[_].length!==1&&b!==i[_].length-1){if((p+2)*(w+2)+2>a)continue e;y+=i[_][b],E=!0,x=_,_--}else{y=(y+=i[_][b]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var O=parseInt(_),D=l(O,y,s),T=_>=i.length-1;if(D&&!T){y+=" ",b=0;continue}if(D||T){if(T)x=O;else if(e.multiline&&(p+2)*(w+2)+2>a)continue e}else{if(!e.multiline||(p+2)*(w+2)+2>a)continue e;x=O}}for(var C="",P=v;P<=x;P++){var R=i[P];if(e.multiline){if(P===x){C+=R[b]+" ",b=(b+1)%R.length;continue}if(P===v){C+=R[R.length-1]+" ";continue}}C+=R[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,f=Wh(C,e,s).width,e.textAlign){case"right":u=o-f-2;break;case"center":u=(o-f)/2;break;case"left":default:u=2}t+=kt(u)+" "+kt(h)+` Td
`,t+="("+Fl(C)+`) Tj
`,t+=-kt(u)+` 0 Td
`,h=-(s+2),f=0,v=E?x:x+1,w++,y=""}break}return n.text=t,n.fontSize=s,n},Wh=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},IC={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},RC=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},MC=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,i=e[r];t.internal.newObjectDeferredBegin(i.objId,!0),tr(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[n]}},BC=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Ps.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(IC)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ix=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new L_,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&RC(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var a in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],l=[],u=o.Rect;if(o.Rect&&(o.Rect=OC(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ut.createDefaultAppearanceStream(o),tr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=DC(o);l.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var p="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var h=o.appearanceStreamContent[m];if(p+="/"+m+" ",p+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var a in h)if(h.hasOwnProperty(a)){var v=h[a];typeof v=="function"&&(v=v.call(i,o)),p+="/"+a+" "+v+" ",i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v)}}else typeof(v=h)=="function"&&(v=v.call(i,o)),p+="/"+a+" "+v,i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v);p+=">>"}l.push({key:"AP",value:`<<
`+p+">>"})}i.internal.putStream({additionalKeyValues:l,objectId:o.objId}),i.internal.out("endobj")}s&&MC(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},C_=Cr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(a){return a};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),tr(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+Fl(n(e[s].toString()))+")"):i+=e[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},h1=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Fl(n(e))+")"},Ys=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ys.prototype.toString=function(){return this.objId+" 0 R"},Ys.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ys.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:C_(i,this.objId,this.scope)}):i instanceof Ys?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var P_=function(){Ys.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};vi(P_,Ys);var L_=function(){Ys.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Fl(r(e))+")"}},set:function(r){e=r}})};vi(L_,Ys);var Ps=function e(){Ys.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Br(t,3)},set:function(y){y?this.F=Ur(t,3):this.F=zr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof H0)return;s="FieldObject"+e.FieldNum++}var y=function(w){return w};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+Fl(y(s))+")"},set:function(y){s=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(y){s=y}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(y){a=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/ix:u},set:function(y){u=y}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(y){f=y}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof H0||this instanceof So))return h1(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=y}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof sn?m:h1(m,this.objId,this.scope)},set:function(y){y=y.toString(),m=this instanceof sn?y:y.substr(0,1)==="("?hc(y.substr(1,y.length-2)):hc(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof sn?hc(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof sn?"/"+y:y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof sn?h:h1(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof sn?y:y.substr(0,1)==="("?hc(y.substr(1,y.length-2)):hc(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof sn?hc(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof sn?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(y){y=!!y,x=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(y){v=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,1)},set:function(y){y?this.Ff=Ur(this.Ff,1):this.Ff=zr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,2)},set:function(y){y?this.Ff=Ur(this.Ff,2):this.Ff=zr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,3)},set:function(y){y?this.Ff=Ur(this.Ff,3):this.Ff=zr(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');b=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(b){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};vi(Ps,Ys);var ml=function(){Ps.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return C_(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,a,o){o||(o=1);for(var l,u=[];l=a.exec(s);)u.push(l[o]);return u}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,18)},set:function(r){r?this.Ff=Ur(this.Ff,18):this.Ff=zr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ur(this.Ff,19):this.Ff=zr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,20)},set:function(r){r?(this.Ff=Ur(this.Ff,20),t.sort()):this.Ff=zr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,22)},set:function(r){r?this.Ff=Ur(this.Ff,22):this.Ff=zr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,23)},set:function(r){r?this.Ff=Ur(this.Ff,23):this.Ff=zr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,27)},set:function(r){r?this.Ff=Ur(this.Ff,27):this.Ff=zr(this.Ff,27)}}),this.hasAppearanceStream=!1};vi(ml,Ps);var gl=function(){ml.call(this),this.fontName="helvetica",this.combo=!1};vi(gl,ml);var xl=function(){gl.call(this),this.combo=!0};vi(xl,gl);var Cf=function(){xl.call(this),this.edit=!0};vi(Cf,xl);var sn=function(){Ps.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,15)},set:function(r){r?this.Ff=Ur(this.Ff,15):this.Ff=zr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,16)},set:function(r){r?this.Ff=Ur(this.Ff,16):this.Ff=zr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,17)},set:function(r){r?this.Ff=Ur(this.Ff,17):this.Ff=zr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,26)},set:function(r){r?this.Ff=Ur(this.Ff,26):this.Ff=zr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+Fl(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){tr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};vi(sn,Ps);var Pf=function(){sn.call(this),this.pushButton=!0};vi(Pf,sn);var vl=function(){sn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};vi(vl,sn);var H0=function(){var e,t;Ps.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),n)a.push("/"+s+" ("+Fl(i(n[s]))+")");return a.push(">>"),a.join(`
`)},set:function(i){tr(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ut.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};vi(H0,Ps),vl.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},vl.prototype.createOption=function(e){var t=new H0;return t.Parent=this,t.optionName=e,this.Kids.push(t),UC.call(this.scope,t),t};var Lf=function(){sn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ut.CheckBox.createAppearanceStream()};vi(Lf,sn);var So=function(){Ps.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,13)},set:function(t){t?this.Ff=Ur(this.Ff,13):this.Ff=zr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,21)},set:function(t){t?this.Ff=Ur(this.Ff,21):this.Ff=zr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,23)},set:function(t){t?this.Ff=Ur(this.Ff,23):this.Ff=zr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,24)},set:function(t){t?this.Ff=Ur(this.Ff,24):this.Ff=zr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,25)},set:function(t){t?this.Ff=Ur(this.Ff,25):this.Ff=zr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,26)},set:function(t){t?this.Ff=Ur(this.Ff,26):this.Ff=zr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};vi(So,Ps);var Ff=function(){So.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Br(this.Ff,14)},set:function(e){e?this.Ff=Ur(this.Ff,14):this.Ff=zr(this.Ff,14)}}),this.password=!0};vi(Ff,So);var ut={CheckBox:{createAppearanceStream:function(){return{N:{On:ut.CheckBox.YesNormal},D:{On:ut.CheckBox.YesPushDown,Off:ut.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ws(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=Hg(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+kt(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ws(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=ut.internal.getHeight(e),a=ut.internal.getWidth(e),o=Hg(e,e.caption);return i.push("1 g"),i.push("0 0 "+kt(a)+" "+kt(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+kt(a-1)+" "+kt(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+kt(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Ws(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Circle.YesNormal,t.D[e]=ut.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ws(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=ut.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ws(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*ut.internal.Bezier_C).toFixed(5)),a=Number((n*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ws(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ka(ut.internal.getWidth(e)/2)+" "+Ka(ut.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Cross.YesNormal,t.D[e]=ut.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ws(e);t.scope=e.scope;var r=[],n=ut.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+kt(ut.internal.getWidth(e)-2)+" "+kt(ut.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(kt(n.x1.x)+" "+kt(n.x1.y)+" m"),r.push(kt(n.x2.x)+" "+kt(n.x2.y)+" l"),r.push(kt(n.x4.x)+" "+kt(n.x4.y)+" m"),r.push(kt(n.x3.x)+" "+kt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ws(e);t.scope=e.scope;var r=ut.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+kt(ut.internal.getWidth(e)-2)+" "+kt(ut.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(kt(r.x1.x)+" "+kt(r.x1.y)+" m"),n.push(kt(r.x2.x)+" "+kt(r.x2.y)+" l"),n.push(kt(r.x4.x)+" "+kt(r.x4.y)+" m"),n.push(kt(r.x3.x)+" "+kt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ws(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kt(ut.internal.getWidth(e))+" "+kt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ut.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ut.internal.getWidth(e),r=ut.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ut.internal.getWidth=function(e){var t=0;return tr(e)==="object"&&(t=Ky(e.Rect[2])),t},ut.internal.getHeight=function(e){var t=0;return tr(e)==="object"&&(t=Ky(e.Rect[3])),t};var UC=Cr.addField=function(e){if(BC(this,e),!(e instanceof Ps))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Cr.AcroFormChoiceField=ml,Cr.AcroFormListBox=gl,Cr.AcroFormComboBox=xl,Cr.AcroFormEditBox=Cf,Cr.AcroFormButton=sn,Cr.AcroFormPushButton=Pf,Cr.AcroFormRadioButton=vl,Cr.AcroFormCheckBox=Lf,Cr.AcroFormTextField=So,Cr.AcroFormPasswordField=Ff,Cr.AcroFormAppearance=ut,Cr.AcroForm={ChoiceField:ml,ListBox:gl,ComboBox:xl,EditBox:Cf,Button:sn,PushButton:Pf,RadioButton:vl,CheckBox:Lf,TextField:So,PasswordField:Ff,Appearance:ut},pt.AcroForm={ChoiceField:ml,ListBox:gl,ComboBox:xl,EditBox:Cf,Button:sn,PushButton:Pf,RadioButton:vl,CheckBox:Lf,TextField:So,PasswordField:Ff,Appearance:ut};var zC=pt.AcroForm;function F_(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(j,A){var q,J,te,z,B,G=t;if((A=A||t)==="RGBA"||j.data!==void 0&&j.data instanceof Uint8ClampedArray&&"height"in j&&"width"in j)return"RGBA";if(D(j))for(B in r)for(te=r[B],q=0;q<te.length;q+=1){for(z=!0,J=0;J<te[q].length;J+=1)if(te[q][J]!==void 0&&te[q][J]!==j[J]){z=!1;break}if(z===!0){G=B;break}}else for(B in r)for(te=r[B],q=0;q<te.length;q+=1){for(z=!0,J=0;J<te[q].length;J+=1)if(te[q][J]!==void 0&&te[q][J]!==j.charCodeAt(J)){z=!1;break}if(z===!0){G=B;break}}return G===t&&A!==t&&(G=A),G},i=function j(A){for(var q=this.internal.write,J=this.internal.putStream,te=(0,this.internal.getFilters)();te.indexOf("FlateEncode")!==-1;)te.splice(te.indexOf("FlateEncode"),1);A.objectId=this.internal.newObject();var z=[];if(z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Image"}),z.push({key:"Width",value:A.width}),z.push({key:"Height",value:A.height}),A.colorSpace===b.INDEXED?z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(A.palette.length/3-1)+" "+("sMask"in A&&A.sMask!==void 0?A.objectId+2:A.objectId+1)+" 0 R]"}):(z.push({key:"ColorSpace",value:"/"+A.colorSpace}),A.colorSpace===b.DEVICE_CMYK&&z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),z.push({key:"BitsPerComponent",value:A.bitsPerComponent}),"decodeParameters"in A&&A.decodeParameters!==void 0&&z.push({key:"DecodeParms",value:"<<"+A.decodeParameters+">>"}),"transparency"in A&&Array.isArray(A.transparency)){for(var B="",G=0,V=A.transparency.length;G<V;G++)B+=A.transparency[G]+" "+A.transparency[G]+" ";z.push({key:"Mask",value:"["+B+"]"})}A.sMask!==void 0&&z.push({key:"SMask",value:A.objectId+1+" 0 R"});var Z=A.filter!==void 0?["/"+A.filter]:void 0;if(J({data:A.data,additionalKeyValues:z,alreadyAppliedFilters:Z,objectId:A.objectId}),q("endobj"),"sMask"in A&&A.sMask!==void 0){var he="/Predictor "+A.predictor+" /Colors 1 /BitsPerComponent "+A.bitsPerComponent+" /Columns "+A.width,k={width:A.width,height:A.height,colorSpace:"DeviceGray",bitsPerComponent:A.bitsPerComponent,decodeParameters:he,data:A.sMask};"filter"in A&&(k.filter=A.filter),j.call(this,k)}if(A.colorSpace===b.INDEXED){var I=this.internal.newObject();J({data:C(new Uint8Array(A.palette)),objectId:I}),q("endobj")}},s=function(){var j=this.internal.collections.addImage_images;for(var A in j)i.call(this,j[A])},a=function(){var j,A=this.internal.collections.addImage_images,q=this.internal.write;for(var J in A)q("/I"+(j=A[J]).index,j.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var j=this.internal.collections.addImage_images;return o.call(this),j},u=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(j){return typeof e["process"+j.toUpperCase()]=="function"},p=function(j){return tr(j)==="object"&&j.nodeType===1},m=function(j,A){if(j.nodeName==="IMG"&&j.hasAttribute("src")){var q=""+j.getAttribute("src");if(q.indexOf("data:image/")===0)return jf(unescape(q).split("base64,").pop());var J=e.loadFile(q,!0);if(J!==void 0)return J}if(j.nodeName==="CANVAS"){if(j.width===0||j.height===0)throw new Error("Given canvas must have data. Canvas width: "+j.width+", height: "+j.height);var te;switch(A){case"PNG":te="image/png";break;case"WEBP":te="image/webp";break;case"JPEG":case"JPG":default:te="image/jpeg"}return jf(j.toDataURL(te,1).split("base64,").pop())}},h=function(j){var A=this.internal.collections.addImage_images;if(A){for(var q in A)if(j===A[q].alias)return A[q]}},v=function(j,A,q){return j||A||(j=-96,A=-96),j<0&&(j=-1*q.width*72/j/this.internal.scaleFactor),A<0&&(A=-1*q.height*72/A/this.internal.scaleFactor),j===0&&(j=A*q.width/q.height),A===0&&(A=j*q.height/q.width),[j,A]},x=function(j,A,q,J,te,z){var B=v.call(this,q,J,te),G=this.internal.getCoordinateString,V=this.internal.getVerticalCoordinateString,Z=l.call(this);if(q=B[0],J=B[1],Z[te.index]=te,z){z*=Math.PI/180;var he=Math.cos(z),k=Math.sin(z),I=function(L){return L.toFixed(4)},M=[I(he),I(k),I(-1*k),I(he),0,0,"cm"]}this.internal.write("q"),z?(this.internal.write([1,"0","0",1,G(j),V(A+J),"cm"].join(" ")),this.internal.write(M.join(" ")),this.internal.write([G(q),"0","0",G(J),"0","0","cm"].join(" "))):this.internal.write([G(q),"0","0",G(J),G(j),V(A+J),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+te.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(j){var A,q,J=0;if(typeof j=="string")for(q=j.length,A=0;A<q;A++)J=(J<<5)-J+j.charCodeAt(A),J|=0;else if(D(j))for(q=j.byteLength/2,A=0;A<q;A++)J=(J<<5)-J+j[A],J|=0;return J},_=e.__addimage__.validateStringAsBase64=function(j){(j=j||"").toString().trim();var A=!0;return j.length===0&&(A=!1),j.length%4!=0&&(A=!1),/^[A-Za-z0-9+/]+$/.test(j.substr(0,j.length-2))===!1&&(A=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(j.substr(-2))===!1&&(A=!1),A},E=e.__addimage__.extractImageFromDataUrl=function(j){var A=(j=j||"").split("base64,"),q=null;if(A.length===2){var J=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(A[0]);Array.isArray(J)&&(q={mimeType:J[1],charset:J[2],data:A[1]})}return q},O=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(j){return O()&&j instanceof ArrayBuffer};var D=e.__addimage__.isArrayBufferView=function(j){return O()&&typeof Uint32Array<"u"&&(j instanceof Int8Array||j instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&j instanceof Uint8ClampedArray||j instanceof Int16Array||j instanceof Uint16Array||j instanceof Int32Array||j instanceof Uint32Array||j instanceof Float32Array||j instanceof Float64Array)},T=e.__addimage__.binaryStringToUint8Array=function(j){for(var A=j.length,q=new Uint8Array(A),J=0;J<A;J++)q[J]=j.charCodeAt(J);return q},C=e.__addimage__.arrayBufferToBinaryString=function(j){for(var A="",q=D(j)?j:new Uint8Array(j),J=0;J<q.length;J+=8192)A+=String.fromCharCode.apply(null,q.subarray(J,J+8192));return A};e.addImage=function(){var j,A,q,J,te,z,B,G,V;if(typeof arguments[1]=="number"?(A=t,q=arguments[1],J=arguments[2],te=arguments[3],z=arguments[4],B=arguments[5],G=arguments[6],V=arguments[7]):(A=arguments[1],q=arguments[2],J=arguments[3],te=arguments[4],z=arguments[5],B=arguments[6],G=arguments[7],V=arguments[8]),tr(j=arguments[0])==="object"&&!p(j)&&"imageData"in j){var Z=j;j=Z.imageData,A=Z.format||A||t,q=Z.x||q||0,J=Z.y||J||0,te=Z.w||Z.width||te,z=Z.h||Z.height||z,B=Z.alias||B,G=Z.compression||G,V=Z.rotation||Z.angle||V}var he=this.internal.getFilters();if(G===void 0&&he.indexOf("FlateEncode")!==-1&&(G="SLOW"),isNaN(q)||isNaN(J))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var k=P.call(this,j,A,B,G);return x.call(this,q,J,te,z,k,V),this};var P=function(j,A,q,J){var te,z,B;if(typeof j=="string"&&n(j)===t){j=unescape(j);var G=R(j,!1);(G!==""||(G=e.loadFile(j,!0))!==void 0)&&(j=G)}if(p(j)&&(j=m(j,A)),A=n(j,A),!f(A))throw new Error("addImage does not support files of type '"+A+"', please ensure that a plugin for '"+A+"' support is added.");if(((B=q)==null||B.length===0)&&(q=function(V){return typeof V=="string"||D(V)?w(V):D(V.data)?w(V.data):null}(j)),(te=h.call(this,q))||(O()&&(j instanceof Uint8Array||A==="RGBA"||(z=j,j=T(j))),te=this["process"+A.toUpperCase()](j,u.call(this),q,function(V){return V&&typeof V=="string"&&(V=V.toUpperCase()),V in e.image_compression?V:y.NONE}(J),z)),!te)throw new Error("An unknown error occurred whilst processing the image.");return te},R=e.__addimage__.convertBase64ToBinaryString=function(j,A){var q;A=typeof A!="boolean"||A;var J,te="";if(typeof j=="string"){J=(q=E(j))!==null?q.data:j;try{te=jf(J)}catch(z){if(A)throw _(J)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return te};e.getImageProperties=function(j){var A,q,J="";if(p(j)&&(j=m(j)),typeof j=="string"&&n(j)===t&&((J=R(j,!1))===""&&(J=e.loadFile(j)||""),j=J),q=n(j),!f(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(!O()||j instanceof Uint8Array||(j=T(j)),!(A=this["process"+q.toUpperCase()](j)))throw new Error("An unknown error occurred whilst processing the image");return A.fileType=q,A}})(pt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};pt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,p=0;p<u.length&&!f;p++)switch((n=u[p]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var m=0;m<u.length;m++){n=u[m];var h=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(x.objId),w=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(y(n.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+h(y(w))+") >>",x.content=s;var _=x.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(x.objId,"0 R",b.objId,"0 R");break;case"freetext":i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var E=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+h(v(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+h(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var D=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+D+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:u(n),w:l(r+i),h:u(n+s)},options:a,type:"link"})},e.textWithLink=function(r,n,i,s){var a,o,l=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var f=this.splitTextToSize(r,o).length;a=Math.ceil(u*f)}else o=l,a=u;return this.text(r,n,i,s),i+=.2*u,s.align==="center"&&(n-=l/2),s.align==="right"&&(n-=l),this.link(n,i-u,o,a,s),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(pt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(x){return t[x.charCodeAt(0)]!==void 0},a=e.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},o=e.__arabicParser__.isArabicEndLetter=function(x){return a(x)&&s(x)&&t[x.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(x){return a(x)&&i.indexOf(x.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return a(x)&&s(x)&&t[x.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(x){return a(x)&&s(x)&&t[x.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(x){return a(x)&&s(x)&&t[x.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(x){return a(x)&&s(x)&&t[x.charCodeAt(0)].length==4},p=e.__arabicParser__.resolveLigatures=function(x){var b=0,y=r,w="",_=0;for(b=0;b<x.length;b+=1)y[x.charCodeAt(b)]!==void 0?(_++,typeof(y=y[x.charCodeAt(b)])=="number"&&(w+=String.fromCharCode(y),y=r,_=0),b===x.length-1&&(y=r,w+=x.charAt(b-(_-1)),b-=_-1,_=0)):(y=r,w+=x.charAt(b-_),b-=_,_=0);return w};e.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(x,b,y){return a(x)?s(x)===!1?-1:!u(x)||!a(b)&&!a(y)||!a(y)&&o(b)||o(x)&&!a(b)||o(x)&&l(b)||o(x)&&o(b)?0:f(x)&&a(b)&&!o(b)&&a(y)&&u(y)?3:o(x)||!a(y)?1:2:-1},h=function(x){var b=0,y=0,w=0,_="",E="",O="",D=(x=x||"").split("\\s+"),T=[];for(b=0;b<D.length;b+=1){for(T.push(""),y=0;y<D[b].length;y+=1)_=D[b][y],E=D[b][y-1],O=D[b][y+1],a(_)?(w=m(_,E,O),T[b]+=w!==-1?String.fromCharCode(t[_.charCodeAt(0)][w]):_):T[b]+=_;T[b]=p(T[b])}return T.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var x,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(b)){var w=0;for(y=[],w=0;w<b.length;w+=1)Array.isArray(b[w])?y.push([h(b[w][0]),b[w][1],b[w][2]]):y.push([h(b[w])]);x=y}else x=h(b);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};e.events.push(["preProcessText",v])}(pt.API),pt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(pt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(x){l=x}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(x){f=x}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(x){p=x}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(x){v=x}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),p=u.font||this.getFont(),m=u.scaleFactor||this.internal.scaleFactor,h=0,v=0,x=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var y=u.maxWidth;y>0?typeof l=="string"?l=this.splitTextToSize(l,y):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(_,E){return _.concat(b.splitTextToSize(E,y))},[])):l=Array.isArray(l)?l:[l];for(var w=0;w<l.length;w++)h<(x=this.getStringUnitWidth(l[w],{font:p})*f)&&(h=x);return h!==0&&(v=l.length),{w:h/=m,h:Math.max((v*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=e.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,p=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===l.lineNumber?(l.x=(u.x||0)+(u.width||0),l.y=u.y||0):u.y+u.height+l.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=p.top,h&&m&&(this.printHeaderRow(l.lineNumber,!0),l.y+=m[0].height)):l.y=u.y+u.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-f,l.y+f,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+f,{align:"center",baseline:"top",maxWidth:l.width-f-f}):this.text(l.text,l.x+f,l.y+f,{align:"left",baseline:"top",maxWidth:l.width-f-f})),this.internal.__cell__.lastCell=l,this};e.table=function(l,u,f,p,m){if(n.call(this),!f)throw new Error("No data for PDF table.");var h,v,x,b,y=[],w=[],_=[],E={},O={},D=[],T=[],C=(m=m||{}).autoSize||!1,P=m.printHeaders!==!1,R=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,j=m.margins||Object.assign({width:this.getPageWidth()},t),A=typeof m.padding=="number"?m.padding:3,q=m.headerBackgroundColor||"#c8c8c8",J=m.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=j,this.internal.__cell__.table_font_size=R,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=q,this.internal.__cell__.headerTextColor=J,this.setFontSize(R),p==null)w=y=Object.keys(f[0]),_=y.map(function(){return"left"});else if(Array.isArray(p)&&tr(p[0])==="object")for(y=p.map(function(Z){return Z.name}),w=p.map(function(Z){return Z.prompt||Z.name||""}),_=p.map(function(Z){return Z.align||"left"}),h=0;h<p.length;h+=1)O[p[h].name]=p[h].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(w=y=p,_=y.map(function(){return"left"}));if(C||Array.isArray(p)&&typeof p[0]=="string")for(h=0;h<y.length;h+=1){for(E[b=y[h]]=f.map(function(Z){return Z[b]}),this.setFont(void 0,"bold"),D.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=E[b],this.setFont(void 0,"normal"),x=0;x<v.length;x+=1)D.push(this.getTextDimensions(v[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[b]=Math.max.apply(null,D)+A+A,D=[]}if(P){var te={};for(h=0;h<y.length;h+=1)te[y[h]]={},te[y[h]].text=w[h],te[y[h]].align=_[h];var z=o.call(this,te,O);T=y.map(function(Z){return new s(l,u,O[Z],z,te[Z].text,void 0,te[Z].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var B=p.reduce(function(Z,he){return Z[he.name]=he.align,Z},{});for(h=0;h<f.length;h+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:h,data:f[h]},this);var G=o.call(this,f[h],O);for(x=0;x<y.length;x+=1){var V=f[h][y[x]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:h,col:x,data:V},this),a.call(this,new s(l,u,O[y[x]],G,V,h+2,B[y[x]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=u,this};var o=function(l,u){var f=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(l).map(function(h){var v=l[h];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,u[h]-f-f)},this).map(function(h){return this.getLineHeightFactor()*h.length*p/m+f+f},this).reduce(function(h,v){return Math.max(h,v)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){f=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,m.push(f)),f.lineNumber=l;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,f),this.setTextColor(v)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}}(pt.API);var O_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},D_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],$g=F_(D_),I_=[100,200,300,400,500,600,700,800,900],WC=F_(I_);function qg(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return O_[s=s||"normal"]?s:"normal"}(e.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(s){return typeof $g[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function Xy(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var HC={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Jy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Qy(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function $C(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},HC,r.genericFontFamilies||{}),s=null,a=null,o=0;o<t.length;++o)if(i[(s=qg(t[o])).family]&&(s.family=i[s.family]),e.hasOwnProperty(s.family)){a=e[s.family];break}if(!(a=a||e[n]))throw new Error("Could not find a font-family for the rule '"+Qy(s)+"' and default family '"+n+"'.");if(a=function(l,u){if(u[l])return u[l];var f=$g[l],p=f<=$g.normal?-1:1,m=Xy(u,D_,f,p);if(!m)throw new Error("Could not find a matching font-stretch value for "+l);return m}(s.stretch,a),a=function(l,u){if(u[l])return u[l];for(var f=O_[l],p=0;p<f.length;++p)if(u[f[p]])return u[f[p]];throw new Error("Could not find a matching font-style for "+l)}(s.style,a),!(a=function(l,u){if(u[l])return u[l];if(l===400&&u[500])return u[500];if(l===500&&u[400])return u[400];var f=WC[l],p=Xy(u,I_,f,l<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+l);return p}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+Qy(s)+"'.");return a}function Zy(e){return e.trimLeft()}function qC(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function VC(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Hh,e5,t5,p1=["times"];(function(e){var t,r,n,i,s,a,o,l,u,f=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new l,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new a,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new a,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,u=new f}]);var p=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=k;Object.defineProperty(this,"pdf",{get:function(){return I}});var M=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return M},set:function(je){M=!!je}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(je){L=!!je}});var H=0;Object.defineProperty(this,"posX",{get:function(){return H},set:function(je){isNaN(je)||(H=je)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(je){isNaN(je)||(se=je)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(je){var ue;typeof je=="number"?ue=[je,je,je,je]:((ue=new Array(4))[0]=je[0],ue[1]=je.length>=2?je[1]:ue[0],ue[2]=je.length>=3?je[2]:ue[0],ue[3]=je.length>=4?je[3]:ue[1]),u.margin=ue}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(je){fe=je}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(je){de=je}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(je){ve=je}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(je){je instanceof f&&(u=je)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(je){u.path=je}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(je){Ee=je}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(je){var ue;ue=m(je),this.ctx.fillStyle=ue.style,this.ctx.isFillTransparent=ue.a===0,this.ctx.fillOpacity=ue.a,this.pdf.setFillColor(ue.r,ue.g,ue.b,{a:ue.a}),this.pdf.setTextColor(ue.r,ue.g,ue.b,{a:ue.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(je){var ue=m(je);this.ctx.strokeStyle=ue.style,this.ctx.isStrokeTransparent=ue.a===0,this.ctx.strokeOpacity=ue.a,ue.a===0?this.pdf.setDrawColor(255,255,255):(ue.a,this.pdf.setDrawColor(ue.r,ue.g,ue.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(je){["butt","round","square"].indexOf(je)!==-1&&(this.ctx.lineCap=je,this.pdf.setLineCap(je))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(je){isNaN(je)||(this.ctx.lineWidth=je,this.pdf.setLineWidth(je))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(je){["bevel","round","miter"].indexOf(je)!==-1&&(this.ctx.lineJoin=je,this.pdf.setLineJoin(je))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(je){isNaN(je)||(this.ctx.miterLimit=je,this.pdf.setMiterLimit(je))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(je){this.ctx.textBaseline=je}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(je){["right","end","center","left","start"].indexOf(je)!==-1&&(this.ctx.textAlign=je)}});var Oe=null;function qe(je,ue){if(Oe===null){var Me=function(at){var ze=[];return Object.keys(at).forEach(function(Ye){at[Ye].forEach(function(Ze){var tt=null;switch(Ze){case"bold":tt={family:Ye,weight:"bold"};break;case"italic":tt={family:Ye,style:"italic"};break;case"bolditalic":tt={family:Ye,weight:"bold",style:"italic"};break;case"":case"normal":tt={family:Ye}}tt!==null&&(tt.ref={name:Ye,style:Ze},ze.push(tt))})}),ze}(je.getFontList());Oe=function(at){for(var ze={},Ye=0;Ye<at.length;++Ye){var Ze=qg(at[Ye]),tt=Ze.family,ft=Ze.stretch,dt=Ze.style,bt=Ze.weight;ze[tt]=ze[tt]||{},ze[tt][ft]=ze[tt][ft]||{},ze[tt][ft][dt]=ze[tt][ft][dt]||{},ze[tt][ft][dt][bt]=Ze}return ze}(Me.concat(ue))}return Oe}var Qe=null;Object.defineProperty(this,"fontFaces",{get:function(){return Qe},set:function(je){Oe=null,Qe=je}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(je){var ue;if(this.ctx.font=je,(ue=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(je))!==null){var Me=ue[1],at=(ue[2],ue[3]),ze=ue[4],Ye=(ue[5],ue[6]),Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ze)[2];ze=Math.floor(Ze==="px"?parseFloat(ze)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(ze)*this.pdf.getFontSize():parseFloat(ze)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ze);var tt=function(xt){var Ct,nt,Zr=[],Rt=xt.trim();if(Rt==="")return p1;if(Rt in Jy)return[Jy[Rt]];for(;Rt!=="";){switch(nt=null,Ct=(Rt=Zy(Rt)).charAt(0)){case'"':case"'":nt=qC(Rt.substring(1),Ct);break;default:nt=VC(Rt)}if(nt===null||(Zr.push(nt[0]),(Rt=Zy(nt[1]))!==""&&Rt.charAt(0)!==","))return p1;Rt=Rt.replace(/^,/,"")}return Zr}(Ye);if(this.fontFaces){var ft=$C(qe(this.pdf,this.fontFaces),tt.map(function(xt){return{family:xt,stretch:"normal",weight:at,style:Me}}));this.pdf.setFont(ft.ref.name,ft.ref.style)}else{var dt="";(at==="bold"||parseInt(at,10)>=700||Me==="bold")&&(dt="bold"),Me==="italic"&&(dt+="italic"),dt.length===0&&(dt="normal");for(var bt="",At={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Lt=0;Lt<tt.length;Lt++){if(this.pdf.internal.getFont(tt[Lt],dt,{noFallback:!0,disableWarning:!0})!==void 0){bt=tt[Lt];break}if(dt==="bolditalic"&&this.pdf.internal.getFont(tt[Lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)bt=tt[Lt],dt="bold";else if(this.pdf.internal.getFont(tt[Lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){bt=tt[Lt],dt="normal";break}}if(bt===""){for(var Ot=0;Ot<tt.length;Ot++)if(At[tt[Ot]]){bt=At[tt[Ot]];break}}bt=bt===""?"Times":bt,this.pdf.setFont(bt,dt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(je){this.ctx.globalCompositeOperation=je}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(je){this.ctx.globalAlpha=je}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(je){this.ctx.lineDashOffset=je,he.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(je){this.ctx.lineDash=je,he.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(je){this.ctx.ignoreClearRect=!!je}})};p.prototype.setLineDash=function(k){this.lineDash=k},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){E.call(this,"fill",!1)},p.prototype.stroke=function(){E.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var M=this.ctx.transform.applyToPoint(new a(k,I));this.path.push({type:"mt",x:M.x,y:M.y}),this.ctx.lastPoint=new a(k,I)},p.prototype.closePath=function(){var k=new a(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&tr(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){k=new a(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(k.x,k.y)},p.prototype.lineTo=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var M=this.ctx.transform.applyToPoint(new a(k,I));this.path.push({type:"lt",x:M.x,y:M.y}),this.ctx.lastPoint=new a(M.x,M.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},p.prototype.quadraticCurveTo=function(k,I,M,L){if(isNaN(M)||isNaN(L)||isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var H=this.ctx.transform.applyToPoint(new a(M,L)),se=this.ctx.transform.applyToPoint(new a(k,I));this.path.push({type:"qct",x1:se.x,y1:se.y,x:H.x,y:H.y}),this.ctx.lastPoint=new a(H.x,H.y)},p.prototype.bezierCurveTo=function(k,I,M,L,H,se){if(isNaN(H)||isNaN(se)||isNaN(k)||isNaN(I)||isNaN(M)||isNaN(L))throw ur.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new a(H,se)),de=this.ctx.transform.applyToPoint(new a(k,I)),ve=this.ctx.transform.applyToPoint(new a(M,L));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:ve.x,y2:ve.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new a(fe.x,fe.y)},p.prototype.arc=function(k,I,M,L,H,se){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(L)||isNaN(H))throw ur.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new a(k,I));k=fe.x,I=fe.y;var de=this.ctx.transform.applyToPoint(new a(0,M)),ve=this.ctx.transform.applyToPoint(new a(0,0));M=Math.sqrt(Math.pow(de.x-ve.x,2)+Math.pow(de.y-ve.y,2))}Math.abs(H-L)>=2*Math.PI&&(L=0,H=2*Math.PI),this.path.push({type:"arc",x:k,y:I,radius:M,startAngle:L,endAngle:H,counterclockwise:se})},p.prototype.arcTo=function(k,I,M,L,H){throw new Error("arcTo not implemented.")},p.prototype.rect=function(k,I,M,L){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(L))throw ur.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,I),this.lineTo(k+M,I),this.lineTo(k+M,I+L),this.lineTo(k,I+L),this.lineTo(k,I),this.lineTo(k+M,I),this.lineTo(k,I)},p.prototype.fillRect=function(k,I,M,L){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(L))throw ur.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var H={};this.lineCap!=="butt"&&(H.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(H.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,I,M,L),this.fill(),H.hasOwnProperty("lineCap")&&(this.lineCap=H.lineCap),H.hasOwnProperty("lineJoin")&&(this.lineJoin=H.lineJoin)}},p.prototype.strokeRect=function(k,I,M,L){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(L))throw ur.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(k,I,M,L),this.stroke())},p.prototype.clearRect=function(k,I,M,L){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(L))throw ur.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,I,M,L))},p.prototype.save=function(k){k=typeof k!="boolean"||k;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},p.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("Q");this.pdf.setPage(I),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(k){var I,M,L,H;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))I=0,M=0,L=0,H=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(se!==null)I=parseInt(se[1]),M=parseInt(se[2]),L=parseInt(se[3]),H=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)I=parseInt(se[1]),M=parseInt(se[2]),L=parseInt(se[3]),H=parseFloat(se[4]);else{if(H=1,typeof k=="string"&&k.charAt(0)!=="#"){var fe=new A_(k);k=fe.ok?fe.toHex():"#000000"}k.length===4?(I=k.substring(1,2),I+=I,M=k.substring(2,3),M+=M,L=k.substring(3,4),L+=L):(I=k.substring(1,3),M=k.substring(3,5),L=k.substring(5,7)),I=parseInt(I,16),M=parseInt(M,16),L=parseInt(L,16)}}return{r:I,g:M,b:L,a:H,style:k}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(k,I,M,L){if(isNaN(I)||isNaN(M)||typeof k!="string")throw ur.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!h.call(this)){var H=G(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;A.call(this,{text:k,x:I,y:M,scale:se,angle:H,align:this.textAlign,maxWidth:L})}},p.prototype.strokeText=function(k,I,M,L){if(isNaN(I)||isNaN(M)||typeof k!="string")throw ur.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){L=isNaN(L)?void 0:L;var H=G(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;A.call(this,{text:k,x:I,y:M,scale:se,renderingMode:"stroke",angle:H,align:this.textAlign,maxWidth:L})}},p.prototype.measureText=function(k){if(typeof k!="string")throw ur.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,M=this.pdf.internal.scaleFactor,L=I.internal.getFontSize(),H=I.getStringUnitWidth(k)*L/I.internal.scaleFactor,se=function(fe){var de=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new se({width:H*=Math.round(96*M/72*1e4)/1e4})},p.prototype.scale=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var M=new l(k,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(M)},p.prototype.rotate=function(k){if(isNaN(k))throw ur.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new l(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},p.prototype.translate=function(k,I){if(isNaN(k)||isNaN(I))throw ur.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var M=new l(1,0,0,1,k,I);this.ctx.transform=this.ctx.transform.multiply(M)},p.prototype.transform=function(k,I,M,L,H,se){if(isNaN(k)||isNaN(I)||isNaN(M)||isNaN(L)||isNaN(H)||isNaN(se))throw ur.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new l(k,I,M,L,H,se);this.ctx.transform=this.ctx.transform.multiply(fe)},p.prototype.setTransform=function(k,I,M,L,H,se){k=isNaN(k)?1:k,I=isNaN(I)?0:I,M=isNaN(M)?0:M,L=isNaN(L)?1:L,H=isNaN(H)?0:H,se=isNaN(se)?0:se,this.ctx.transform=new l(k,I,M,L,H,se)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(k,I,M,L,H,se,fe,de,ve){var Ee=this.pdf.getImageProperties(k),Oe=1,qe=1,Qe=1,je=1;L!==void 0&&de!==void 0&&(Qe=de/L,je=ve/H,Oe=Ee.width/L*de/L,qe=Ee.height/H*ve/H),se===void 0&&(se=I,fe=M,I=0,M=0),L!==void 0&&de===void 0&&(de=L,ve=H),L===void 0&&de===void 0&&(de=Ee.width,ve=Ee.height);for(var ue,Me=this.ctx.transform.decompose(),at=G(Me.rotate.shx),ze=new l,Ye=(ze=(ze=(ze=ze.multiply(Me.translate)).multiply(Me.skew)).multiply(Me.scale)).applyToRectangle(new o(se-I*Qe,fe-M*je,L*Oe,H*qe)),Ze=b.call(this,Ye),tt=[],ft=0;ft<Ze.length;ft+=1)tt.indexOf(Ze[ft])===-1&&tt.push(Ze[ft]);if(_(tt),this.autoPaging)for(var dt=tt[0],bt=tt[tt.length-1],At=dt;At<bt+1;At++){this.pdf.setPage(At);var Lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=At===1?this.posY+this.margin[0]:this.margin[0],xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],nt=At===1?0:xt+(At-2)*Ct;if(this.ctx.clip_path.length!==0){var Zr=this.path;ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(ue,this.posX+this.margin[3],-nt+Ot+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=Zr}var Rt=JSON.parse(JSON.stringify(Ye));Rt=w([Rt],this.posX+this.margin[3],-nt+Ot+this.ctx.prevPageLastElemOffset)[0];var ti=(At>dt||At<bt)&&x.call(this);ti&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,Ct,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",Rt.x,Rt.y,Rt.w,Rt.h,null,null,at),ti&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",Ye.x,Ye.y,Ye.w,Ye.h,null,null,at)};var b=function(k,I,M){var L=[];I=I||this.pdf.internal.pageSize.width,M=M||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var H=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":L.push(Math.floor((k.y+H)/M)+1);break;case"arc":L.push(Math.floor((k.y+H-k.radius)/M)+1),L.push(Math.floor((k.y+H+k.radius)/M)+1);break;case"qct":var se=V(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);L.push(Math.floor((se.y+H)/M)+1),L.push(Math.floor((se.y+se.h+H)/M)+1);break;case"bct":var fe=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);L.push(Math.floor((fe.y+H)/M)+1),L.push(Math.floor((fe.y+fe.h+H)/M)+1);break;case"rect":L.push(Math.floor((k.y+H)/M)+1),L.push(Math.floor((k.y+k.h+H)/M)+1)}for(var de=0;de<L.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<L[de];)y.call(this);return L},y=function(){var k=this.fillStyle,I=this.strokeStyle,M=this.font,L=this.lineCap,H=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=I,this.font=M,this.lineCap=L,this.lineWidth=H,this.lineJoin=se},w=function(k,I,M){for(var L=0;L<k.length;L++)switch(k[L].type){case"bct":k[L].x2+=I,k[L].y2+=M;case"qct":k[L].x1+=I,k[L].y1+=M;case"mt":case"lt":case"arc":default:k[L].x+=I,k[L].y+=M}return k},_=function(k){return k.sort(function(I,M){return I-M})},E=function(k,I){for(var M,L,H=this.fillStyle,se=this.strokeStyle,fe=this.lineCap,de=this.lineWidth,ve=Math.abs(de*this.ctx.transform.scaleX),Ee=this.lineJoin,Oe=JSON.parse(JSON.stringify(this.path)),qe=JSON.parse(JSON.stringify(this.path)),Qe=[],je=0;je<qe.length;je++)if(qe[je].x!==void 0)for(var ue=b.call(this,qe[je]),Me=0;Me<ue.length;Me+=1)Qe.indexOf(ue[Me])===-1&&Qe.push(ue[Me]);for(var at=0;at<Qe.length;at++)for(;this.pdf.internal.getNumberOfPages()<Qe[at];)y.call(this);if(_(Qe),this.autoPaging)for(var ze=Qe[0],Ye=Qe[Qe.length-1],Ze=ze;Ze<Ye+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=H,this.strokeStyle=se,this.lineCap=fe,this.lineWidth=ve,this.lineJoin=Ee;var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=Ze===1?this.posY+this.margin[0]:this.margin[0],dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],At=Ze===1?0:dt+(Ze-2)*bt;if(this.ctx.clip_path.length!==0){var Lt=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(M,this.posX+this.margin[3],-At+ft+this.ctx.prevPageLastElemOffset),O.call(this,k,!0),this.path=Lt}if(L=JSON.parse(JSON.stringify(Oe)),this.path=w(L,this.posX+this.margin[3],-At+ft+this.ctx.prevPageLastElemOffset),I===!1||Ze===0){var Ot=(Ze>ze||Ze<Ye)&&x.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,bt,null).clip().discardPath()),O.call(this,k,I),Ot&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=ve,O.call(this,k,I),this.lineWidth=de;this.path=Oe},O=function(k,I){if((k!=="stroke"||I||!v.call(this))&&(k==="stroke"||I||!h.call(this))){for(var M,L,H=[],se=this.path,fe=0;fe<se.length;fe++){var de=se[fe];switch(de.type){case"begin":H.push({begin:!0});break;case"close":H.push({close:!0});break;case"mt":H.push({start:de,deltas:[],abs:[]});break;case"lt":var ve=H.length;if(se[fe-1]&&!isNaN(se[fe-1].x)&&(M=[de.x-se[fe-1].x,de.y-se[fe-1].y],ve>0)){for(;ve>=0;ve--)if(H[ve-1].close!==!0&&H[ve-1].begin!==!0){H[ve-1].deltas.push(M),H[ve-1].abs.push(de);break}}break;case"bct":M=[de.x1-se[fe-1].x,de.y1-se[fe-1].y,de.x2-se[fe-1].x,de.y2-se[fe-1].y,de.x-se[fe-1].x,de.y-se[fe-1].y],H[H.length-1].deltas.push(M);break;case"qct":var Ee=se[fe-1].x+2/3*(de.x1-se[fe-1].x),Oe=se[fe-1].y+2/3*(de.y1-se[fe-1].y),qe=de.x+2/3*(de.x1-de.x),Qe=de.y+2/3*(de.y1-de.y),je=de.x,ue=de.y;M=[Ee-se[fe-1].x,Oe-se[fe-1].y,qe-se[fe-1].x,Qe-se[fe-1].y,je-se[fe-1].x,ue-se[fe-1].y],H[H.length-1].deltas.push(M);break;case"arc":H.push({deltas:[],abs:[],arc:!0}),Array.isArray(H[H.length-1].abs)&&H[H.length-1].abs.push(de)}}L=I?null:k==="stroke"?"stroke":"fill";for(var Me=!1,at=0;at<H.length;at++)if(H[at].arc)for(var ze=H[at].abs,Ye=0;Ye<ze.length;Ye++){var Ze=ze[Ye];Ze.type==="arc"?C.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,I,!Me):q.call(this,Ze.x,Ze.y),Me=!0}else if(H[at].close===!0)this.pdf.internal.out("h"),Me=!1;else if(H[at].begin!==!0){var tt=H[at].start.x,ft=H[at].start.y;J.call(this,H[at].deltas,tt,ft),Me=!0}L&&P.call(this,L),I&&R.call(this)}},D=function(k){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,M=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-M;case"top":return k+I-M;case"hanging":return k+I-2*M;case"middle":return k+I/2-M;case"ideographic":return k;case"alphabetic":default:return k}},T=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(I,M){this.colorStops.push([I,M])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(k,I,M,L,H,se,fe,de,ve){for(var Ee=z.call(this,M,L,H,se),Oe=0;Oe<Ee.length;Oe++){var qe=Ee[Oe];Oe===0&&(ve?j.call(this,qe.x1+k,qe.y1+I):q.call(this,qe.x1+k,qe.y1+I)),te.call(this,k,I,qe.x2,qe.y2,qe.x3,qe.y3,qe.x4,qe.y4)}de?R.call(this):P.call(this,fe)},P=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},R=function(){this.pdf.clip(),this.pdf.discardPath()},j=function(k,I){this.pdf.internal.out(r(k)+" "+n(I)+" m")},A=function(k){var I;switch(k.align){case"right":case"end":I="right";break;case"center":I="center";break;case"left":case"start":default:I="left"}var M=this.pdf.getTextDimensions(k.text),L=D.call(this,k.y),H=T.call(this,L)-M.h,se=this.ctx.transform.applyToPoint(new a(k.x,L)),fe=this.ctx.transform.decompose(),de=new l;de=(de=(de=de.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var ve,Ee,Oe,qe=this.ctx.transform.applyToRectangle(new o(k.x,L,M.w,M.h)),Qe=de.applyToRectangle(new o(k.x,H,M.w,M.h)),je=b.call(this,Qe),ue=[],Me=0;Me<je.length;Me+=1)ue.indexOf(je[Me])===-1&&ue.push(je[Me]);if(_(ue),this.autoPaging)for(var at=ue[0],ze=ue[ue.length-1],Ye=at;Ye<ze+1;Ye++){this.pdf.setPage(Ye);var Ze=Ye===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[2],dt=ft-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],At=bt-this.margin[3],Lt=Ye===1?0:tt+(Ye-2)*dt;if(this.ctx.clip_path.length!==0){var Ot=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(ve,this.posX+this.margin[3],-1*Lt+Ze),O.call(this,"fill",!0),this.path=Ot}var xt=w([JSON.parse(JSON.stringify(Qe))],this.posX+this.margin[3],-Lt+Ze+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*k.scale),Oe=this.lineWidth,this.lineWidth=Oe*k.scale);var Ct=this.autoPaging!=="text";if(Ct||xt.y+xt.h<=ft){if(Ct||xt.y>=Ze&&xt.x<=bt){var nt=Ct?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||bt-xt.x)[0],Zr=w([JSON.parse(JSON.stringify(qe))],this.posX+this.margin[3],-Lt+Ze+this.ctx.prevPageLastElemOffset)[0],Rt=Ct&&(Ye>at||Ye<ze)&&x.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,dt,null).clip().discardPath()),this.pdf.text(nt,Zr.x,Zr.y,{angle:k.angle,align:I,renderingMode:k.renderingMode}),Rt&&this.pdf.restoreGraphicsState()}}else xt.y<ft&&(this.ctx.prevPageLastElemOffset+=ft-xt.y);k.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Oe)}else k.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*k.scale),Oe=this.lineWidth,this.lineWidth=Oe*k.scale),this.pdf.text(k.text,se.x+this.posX,se.y+this.posY,{angle:k.angle,align:I,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Oe)},q=function(k,I,M,L){M=M||0,L=L||0,this.pdf.internal.out(r(k+M)+" "+n(I+L)+" l")},J=function(k,I,M){return this.pdf.lines(k,I,M,null,null)},te=function(k,I,M,L,H,se,fe,de){this.pdf.internal.out([t(i(M+k)),t(s(L+I)),t(i(H+k)),t(s(se+I)),t(i(fe+k)),t(s(de+I)),"c"].join(" "))},z=function(k,I,M,L){for(var H=2*Math.PI,se=Math.PI/2;I>M;)I-=H;var fe=Math.abs(M-I);fe<H&&L&&(fe=H-fe);for(var de=[],ve=L?-1:1,Ee=I;fe>1e-5;){var Oe=Ee+ve*Math.min(fe,se);de.push(B.call(this,k,Ee,Oe)),fe-=Math.abs(Oe-Ee),Ee=Oe}return de},B=function(k,I,M){var L=(M-I)/2,H=k*Math.cos(L),se=k*Math.sin(L),fe=H,de=-se,ve=fe*fe+de*de,Ee=ve+fe*H+de*se,Oe=4/3*(Math.sqrt(2*ve*Ee)-Ee)/(fe*se-de*H),qe=fe-Oe*de,Qe=de+Oe*fe,je=qe,ue=-Qe,Me=L+I,at=Math.cos(Me),ze=Math.sin(Me);return{x1:k*Math.cos(I),y1:k*Math.sin(I),x2:qe*at-Qe*ze,y2:qe*ze+Qe*at,x3:je*at-ue*ze,y3:je*ze+ue*at,x4:k*Math.cos(M),y4:k*Math.sin(M)}},G=function(k){return 180*k/Math.PI},V=function(k,I,M,L,H,se){var fe=k+.5*(M-k),de=I+.5*(L-I),ve=H+.5*(M-H),Ee=se+.5*(L-se),Oe=Math.min(k,H,fe,ve),qe=Math.max(k,H,fe,ve),Qe=Math.min(I,se,de,Ee),je=Math.max(I,se,de,Ee);return new o(Oe,Qe,qe-Oe,je-Qe)},Z=function(k,I,M,L,H,se,fe,de){var ve,Ee,Oe,qe,Qe,je,ue,Me,at,ze,Ye,Ze,tt,ft,dt=M-k,bt=L-I,At=H-M,Lt=se-L,Ot=fe-H,xt=de-se;for(Ee=0;Ee<41;Ee++)at=(ue=(Oe=k+(ve=Ee/40)*dt)+ve*((Qe=M+ve*At)-Oe))+ve*(Qe+ve*(H+ve*Ot-Qe)-ue),ze=(Me=(qe=I+ve*bt)+ve*((je=L+ve*Lt)-qe))+ve*(je+ve*(se+ve*xt-je)-Me),Ee==0?(Ye=at,Ze=ze,tt=at,ft=ze):(Ye=Math.min(Ye,at),Ze=Math.min(Ze,ze),tt=Math.max(tt,at),ft=Math.max(ft,ze));return new o(Math.round(Ye),Math.round(Ze),Math.round(tt-Ye),Math.round(ft-Ze))},he=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,I,M=(k=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:I}));this.prevLineDash!==M&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=M)}}})(pt.API),function(e){var t=function(s){var a,o,l,u,f,p,m,h,v,x;for(o=[],l=0,u=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;u>l;l+=4)(f=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(p=(f=((f=((f=((f=(f-(x=f%85))/85)-(v=f%85))/85)-(h=f%85))/85)-(m=f%85))/85)%85,o.push(p+33,m+33,h+33,v+33,x+33)):o.push(122);return function(b,y){for(var w=y;w>0;w--)b.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},r=function(s){var a,o,l,u,f,p=String,m="length",h=255,v="charCodeAt",x="slice",b="replace";for(s[x](-2),s=s[x](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],u=0,f=(s+=a="uuuuu"[x](s[m]%5||5))[m];f>u;u+=5)o=52200625*(s[v](u)-33)+614125*(s[v](u+1)-33)+7225*(s[v](u+2)-33)+85*(s[v](u+3)-33)+(s[v](u+4)-33),l.push(h&o>>24,h&o>>16,h&o>>8,h&o);return function(y,w){for(var _=w;_>0;_--)y.pop()}(l,a[m]),p.fromCharCode.apply(p,l)},n=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",l=0;l<s.length;l+=2)o+=String.fromCharCode("0x"+(s[l]+s[l+1]));return o},i=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=Bg(a)).reduce(function(l,u){return l+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,a){var o=0,l=s||"",u=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=i(l),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:u.reverse().join(" ")}}}(pt.API),function(e){e.loadFile=function(t,r,n){return function(i,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(l,u,f){var p=new XMLHttpRequest,m=0,h=function(v){var x=v.length,b=[],y=String.fromCharCode;for(m=0;m<x;m+=1)b.push(y(255&v.charCodeAt(m)));return b.join("")};if(p.open("GET",l,!u),p.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(p.onload=function(){p.status===200?f(h(this.responseText)):f(void 0)}),p.send(null),u&&p.status===200)return h(p.responseText)}(i,s,a)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(pt.API),function(e){function t(){return(vt.html2canvas?Promise.resolve(vt.html2canvas):Aa(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function r(){return(vt.DOMPurify?Promise.resolve(vt.DOMPurify):Aa(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=tr(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(a,o){var l=document.createElement(a);for(var u in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[u]=o.style[u];return l},s=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),u=a.convert(Promise.resolve(),l);return u=(u=u.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(r).then(function(l){return this.set({src:i("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(u,f){for(var p=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),m=u.firstChild;m;m=m.nextSibling)f!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||p.appendChild(l(m,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(p.width=u.width,p.height=u.height,p.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(p.value=u.value),p.addEventListener("load",function(){p.scrollTop=u.scrollTop,p.scrollLeft=u.scrollLeft},!0)),p}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var l=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var h=u[m],v=h.src.find(function(x){return x.format==="truetype"});v&&l.addFont(v.url,h.ref.name,h.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,l.context2d.save(!0),o(this.prop.container,p)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(l){if(l in s.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(a,o){return this.then(function(){var l=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(l):l})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(l,u){return Math.floor(l*u/72*96)}return this.then(function(){(a=a||pt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,o,l,u){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,l,u){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,function(u,f){return l.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(p){return l.updateProgress(null,u),p}).then(u,f).then(function(p){return l.updateProgress(1),p})})},s.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),f=l.call(u,a,o);return s.convert(f,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach(function(l){o=o.thenCore(l)}),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,pt.getPageSize=function(a,o,l){if(tr(a)==="object"){var u=a;a=u.orientation,o=u.unit||o,l=u.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var f,p=(""+l).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+o}var h,v=0,x=0;if(m.hasOwnProperty(p))v=m[p][1]/f,x=m[p][0]/f;else try{v=l[1],x=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",x>v&&(h=x,x=v,v=h);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",v>x&&(h=x,x=v,v=h)}return{width:x,height:v,unit:o,k:f,orientation:a}},e.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(qg):null;var l=new s(o);return o.worker?l:l.from(a).doCallback()}}(pt.API),pt.API.addJS=function(e){return t5=e,this.internal.events.subscribe("postPutResources",function(){Hh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Hh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),e5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+t5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Hh!==void 0&&e5!==void 0&&this.internal.out("/Names <</JavaScript "+Hh+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var a=i[s],o=n.exec(a);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(a)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(s=0;s<u;s++){var p=r.internal.newObject();f.push(p);var m=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<f.length;s++)r.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var a={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(a),a},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var a=n.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=r.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(pt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,a,o){var l,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=a||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(p){for(var m,h=256*p.charCodeAt(4)+p.charCodeAt(5),v=p.length,x={width:0,height:0,numcomponents:1},b=4;b<v;b+=2){if(b+=h,t.indexOf(p.charCodeAt(b+1))!==-1){m=256*p.charCodeAt(b+5)+p.charCodeAt(b+6),x={width:256*p.charCodeAt(b+7)+p.charCodeAt(b+8),height:m,numcomponents:p.charCodeAt(b+9)};break}h=256*p.charCodeAt(b+2)+p.charCodeAt(b+3)}return x}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:i}}return f}}(pt.API);var pc,$h,r5,n5,i5,GC=function(){var e,t,r;function n(s){var a,o,l,u,f,p,m,h,v,x,b,y,w,_;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(a=this.readUInt32(),v=(function(){var E,O;for(O=[],E=0;E<4;++E)O.push(String.fromCharCode(this.data[this.pos++]));return O}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),u=this.readUInt16()||100,p.delay=1e3*f/u,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,a-=4),s=(p!=null?p.data:void 0)||this.imgData,y=0;0<=a?y<a:y>a;0<=a?++y:--y)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((x=l-this.transparency.indexed.length)>0)for(w=0;0<=x?w<x:w>x;0<=x?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":m=(b=this.read(a)).indexOf(0),h=String.fromCharCode.apply(String,b.slice(0,m)),this.text[h]=String.fromCharCode.apply(String,b.slice(m+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,u=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function f(p,m,h,v){var x,b,y,w,_,E,O,D,T,C,P,R,j,A,q,J,te,z,B,G,V,Z=Math.ceil((u.width-p)/h),he=Math.ceil((u.height-m)/v),k=u.width==Z&&u.height==he;for(A=a*Z,R=k?o:new Uint8Array(A*he),E=s.length,j=0,b=0;j<he&&l<E;){switch(s[l++]){case 0:for(w=te=0;te<A;w=te+=1)R[b++]=s[l++];break;case 1:for(w=z=0;z<A;w=z+=1)x=s[l++],_=w<a?0:R[b-a],R[b++]=(x+_)%256;break;case 2:for(w=B=0;B<A;w=B+=1)x=s[l++],y=(w-w%a)/a,q=j&&R[(j-1)*A+y*a+w%a],R[b++]=(q+x)%256;break;case 3:for(w=G=0;G<A;w=G+=1)x=s[l++],y=(w-w%a)/a,_=w<a?0:R[b-a],q=j&&R[(j-1)*A+y*a+w%a],R[b++]=(x+Math.floor((_+q)/2))%256;break;case 4:for(w=V=0;V<A;w=V+=1)x=s[l++],y=(w-w%a)/a,_=w<a?0:R[b-a],j===0?q=J=0:(q=R[(j-1)*A+y*a+w%a],J=y&&R[(j-1)*A+(y-1)*a+w%a]),O=_+q-J,D=Math.abs(O-_),C=Math.abs(O-q),P=Math.abs(O-J),T=D<=C&&D<=P?_:C<=P?q:J,R[b++]=(x+T)%256;break;default:throw new Error("Invalid filter algorithm: "+s[l-1])}if(!k){var I=((m+j*v)*u.width+p)*a,M=j*A;for(w=0;w<Z;w+=1){for(var L=0;L<a;L+=1)o[I++]=R[M++];I+=(h-1)*a}}j++}}return s=NC(s),u.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),o},n.prototype.decodePalette=function(){var s,a,o,l,u,f,p,m,h;for(o=this.palette,f=this.transparency.indexed||[],u=new Uint8Array((f.length||0)+o.length),l=0,s=0,a=p=0,m=o.length;p<m;a=p+=3)u[l++]=o[a],u[l++]=o[a+1],u[l++]=o[a+2],u[l++]=(h=f[s++])!=null?h:255;return u},n.prototype.copyToImageData=function(s,a){var o,l,u,f,p,m,h,v,x,b,y;if(l=this.colors,x=null,o=this.hasAlphaChannel,this.palette.length&&(x=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),l=4,o=!0),v=(u=s.data||s).length,p=x||a,f=m=0,l===1)for(;f<v;)h=x?4*a[f/4]:m,b=p[h++],u[f++]=b,u[f++]=b,u[f++]=b,u[f++]=o?p[h++]:255,m=h;else for(;f<v;)h=x?4*a[f/4]:m,u[f++]=p[h++],u[f++]=p[h++],u[f++]=p[h++],u[f++]=o?p[h++]:255,m=h},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(vt)==="[object Window]"){try{t=vt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(s){var a;if(i()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var a,o,l,u,f,p,m,h;if(this.animation){for(h=[],o=f=0,p=(m=this.animation.frames).length;f<p;o=++f)a=m[o],l=s.createImageData(a.width,a.height),u=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,u),a.imageData=l,h.push(a.image=e(l));return h}},n.prototype.renderFrame=function(s,a){var o,l,u;return o=(l=this.animation.frames)[a],u=l[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?s.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&s.putImageData(u.imageData,u.xOffset,u.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var a,o,l,u,f,p,m=this;return o=0,p=this.animation,u=p.numFrames,l=p.frames,f=p.numPlays,(a=function(){var h,v;if(h=o++%u,v=l[h],m.renderFrame(s,h),u>1&&o/u<f)return m.animation._timeout=setTimeout(a,v.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function YC(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,a=1<<(7&i)+1;e[t++],e[t++];var o=null,l=null;s&&(o=t,l=a,t+=3*a);var u=!0,f=[],p=0,m=null,h=0,v=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var x=e[t++];p=e[t++]|e[t++]<<8,m=e[t++],!(1&x)&&(m=null),h=x>>2&7,t++;break;case 254:for(;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var b=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,E=e[t++],O=E>>6&1,D=1<<(7&E)+1,T=o,C=l,P=!1;E>>7&&(P=!0,T=t,C=D,t+=3*D);var R=t;for(t++;;){var j;if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}f.push({x:b,y,width:w,height:_,has_local_palette:P,palette_offset:T,palette_size:C,data_offset:R,data_length:t-R,transparent_index:m,interlaced:!!O,delay:p,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return v},this.frameInfo=function(A){if(A<0||A>=f.length)throw new Error("Frame index out of range.");return f[A]},this.decodeAndBlitFrameBGRA=function(A,q){var J=this.frameInfo(A),te=J.width*J.height,z=new Uint8Array(te);s5(e,J.data_offset,z,te);var B=J.palette_offset,G=J.transparent_index;G===null&&(G=256);var V=J.width,Z=r-V,he=V,k=4*(J.y*r+J.x),I=4*((J.y+J.height)*r+J.x),M=k,L=4*Z;J.interlaced===!0&&(L+=4*r*7);for(var H=8,se=0,fe=z.length;se<fe;++se){var de=z[se];if(he===0&&(he=V,(M+=L)>=I&&(L=4*Z+4*r*(H-1),M=k+(V+Z)*(H<<1),H>>=1)),de===G)M+=4;else{var ve=e[B+3*de],Ee=e[B+3*de+1],Oe=e[B+3*de+2];q[M++]=Oe,q[M++]=Ee,q[M++]=ve,q[M++]=255}--he}},this.decodeAndBlitFrameRGBA=function(A,q){var J=this.frameInfo(A),te=J.width*J.height,z=new Uint8Array(te);s5(e,J.data_offset,z,te);var B=J.palette_offset,G=J.transparent_index;G===null&&(G=256);var V=J.width,Z=r-V,he=V,k=4*(J.y*r+J.x),I=4*((J.y+J.height)*r+J.x),M=k,L=4*Z;J.interlaced===!0&&(L+=4*r*7);for(var H=8,se=0,fe=z.length;se<fe;++se){var de=z[se];if(he===0&&(he=V,(M+=L)>=I&&(L=4*Z+4*r*(H-1),M=k+(V+Z)*(H<<1),H>>=1)),de===G)M+=4;else{var ve=e[B+3*de],Ee=e[B+3*de+1],Oe=e[B+3*de+2];q[M++]=ve,q[M++]=Ee,q[M++]=Oe,q[M++]=255}--he}}}function s5(e,t,r,n){for(var i=e[t++],s=1<<i,a=s+1,o=a+1,l=i+1,u=(1<<l)-1,f=0,p=0,m=0,h=e[t++],v=new Int32Array(4096),x=null;;){for(;f<16&&h!==0;)p|=e[t++]<<f,f+=8,h===1?h=e[t++]:--h;if(f<l)break;var b=p&u;if(p>>=l,f-=l,b!==s){if(b===a)break;for(var y=b<o?b:x,w=0,_=y;_>s;)_=v[_]>>8,++w;var E=_;if(m+w+(y!==b?1:0)>n)return void ur.log("Warning, gif stream longer than expected.");r[m++]=E;var O=m+=w;for(y!==b&&(r[m++]=E),_=y;w--;)_=v[_],r[--O]=255&_,_>>=8;x!==null&&o<4096&&(v[o++]=x<<8|E,o>=u+1&&l<12&&(++l,u=u<<1|1)),x=b}else o=a+1,u=(1<<(l=i+1))-1,x=null}return m!==n&&ur.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function m1(e){var t,r,n,i,s,a=Math.floor,o=new Array(64),l=new Array(64),u=new Array(64),f=new Array(64),p=new Array(65535),m=new Array(65535),h=new Array(64),v=new Array(64),x=[],b=0,y=7,w=new Array(64),_=new Array(64),E=new Array(64),O=new Array(256),D=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],j=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],te=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function z(k,I){for(var M=0,L=0,H=new Array,se=1;se<=16;se++){for(var fe=1;fe<=k[se];fe++)H[I[L]]=[],H[I[L]][0]=M,H[I[L]][1]=se,L++,M++;M*=2}return H}function B(k){for(var I=k[0],M=k[1]-1;M>=0;)I&1<<M&&(b|=1<<y),M--,--y<0&&(b==255?(G(255),G(0)):G(b),y=7,b=0)}function G(k){x.push(k)}function V(k){G(k>>8&255),G(255&k)}function Z(k,I,M,L,H){for(var se,fe=H[0],de=H[240],ve=function(ze,Ye){var Ze,tt,ft,dt,bt,At,Lt,Ot,xt,Ct,nt=0;for(xt=0;xt<8;++xt){Ze=ze[nt],tt=ze[nt+1],ft=ze[nt+2],dt=ze[nt+3],bt=ze[nt+4],At=ze[nt+5],Lt=ze[nt+6];var Zr=Ze+(Ot=ze[nt+7]),Rt=Ze-Ot,ti=tt+Lt,Gt=tt-Lt,fr=ft+At,Ui=ft-At,Bt=dt+bt,Fs=dt-bt,gr=Zr+Bt,yi=Zr-Bt,as=ti+fr,lr=ti-fr;ze[nt]=gr+as,ze[nt+4]=gr-as;var _t=.707106781*(lr+yi);ze[nt+2]=yi+_t,ze[nt+6]=yi-_t;var Ht=.382683433*((gr=Fs+Ui)-(lr=Gt+Rt)),ra=.5411961*gr+Ht,en=1.306562965*lr+Ht,zi=.707106781*(as=Ui+Gt),Wi=Rt+zi,mt=Rt-zi;ze[nt+5]=mt+ra,ze[nt+3]=mt-ra,ze[nt+1]=Wi+en,ze[nt+7]=Wi-en,nt+=8}for(nt=0,xt=0;xt<8;++xt){Ze=ze[nt],tt=ze[nt+8],ft=ze[nt+16],dt=ze[nt+24],bt=ze[nt+32],At=ze[nt+40],Lt=ze[nt+48];var wi=Ze+(Ot=ze[nt+56]),ri=Ze-Ot,Cn=tt+Lt,Or=tt-Lt,Ar=ft+At,K=ft-At,oe=dt+bt,re=dt-bt,ne=wi+oe,ae=wi-oe,le=Cn+Ar,Se=Cn-Ar;ze[nt]=ne+le,ze[nt+32]=ne-le;var Ce=.707106781*(Se+ae);ze[nt+16]=ae+Ce,ze[nt+48]=ae-Ce;var _e=.382683433*((ne=re+K)-(Se=Or+ri)),Ae=.5411961*ne+_e,Te=1.306562965*Se+_e,He=.707106781*(le=K+Or),Ke=ri+He,st=ri-He;ze[nt+40]=st+Ae,ze[nt+24]=st-Ae,ze[nt+8]=Ke+Te,ze[nt+56]=Ke-Te,nt++}for(xt=0;xt<64;++xt)Ct=ze[xt]*Ye[xt],h[xt]=Ct>0?Ct+.5|0:Ct-.5|0;return h}(k,I),Ee=0;Ee<64;++Ee)v[T[Ee]]=ve[Ee];var Oe=v[0]-M;M=v[0],Oe==0?B(L[0]):(B(L[m[se=32767+Oe]]),B(p[se]));for(var qe=63;qe>0&&v[qe]==0;)qe--;if(qe==0)return B(fe),M;for(var Qe,je=1;je<=qe;){for(var ue=je;v[je]==0&&je<=qe;)++je;var Me=je-ue;if(Me>=16){Qe=Me>>4;for(var at=1;at<=Qe;++at)B(de);Me&=15}se=32767+v[je],B(H[(Me<<4)+m[se]]),B(p[se]),je++}return qe!=63&&B(fe),M}function he(k){k=Math.min(Math.max(k,1),100),s!=k&&(function(I){for(var M=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var H=a((M[L]*I+50)/100);H=Math.min(Math.max(H,1),255),o[T[L]]=H}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var de=a((se[fe]*I+50)/100);de=Math.min(Math.max(de,1),255),l[T[fe]]=de}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,Oe=0;Oe<8;Oe++)for(var qe=0;qe<8;qe++)u[Ee]=1/(o[T[Ee]]*ve[Oe]*ve[qe]*8),f[Ee]=1/(l[T[Ee]]*ve[Oe]*ve[qe]*8),Ee++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),s=k)}this.encode=function(k,I){I&&he(I),x=new Array,b=0,y=7,V(65496),V(65504),V(16),G(74),G(70),G(73),G(70),G(0),G(1),G(1),G(0),V(1),V(1),G(0),G(0),function(){V(65499),V(132),G(0);for(var tt=0;tt<64;tt++)G(o[tt]);G(1);for(var ft=0;ft<64;ft++)G(l[ft])}(),function(tt,ft){V(65472),V(17),G(8),V(ft),V(tt),G(3),G(1),G(17),G(0),G(2),G(17),G(1),G(3),G(17),G(1)}(k.width,k.height),function(){V(65476),V(418),G(0);for(var tt=0;tt<16;tt++)G(C[tt+1]);for(var ft=0;ft<=11;ft++)G(P[ft]);G(16);for(var dt=0;dt<16;dt++)G(R[dt+1]);for(var bt=0;bt<=161;bt++)G(j[bt]);G(1);for(var At=0;At<16;At++)G(A[At+1]);for(var Lt=0;Lt<=11;Lt++)G(q[Lt]);G(17);for(var Ot=0;Ot<16;Ot++)G(J[Ot+1]);for(var xt=0;xt<=161;xt++)G(te[xt])}(),V(65498),V(12),G(3),G(1),G(0),G(2),G(17),G(3),G(17),G(0),G(63),G(0);var M=0,L=0,H=0;b=0,y=7,this.encode.displayName="_encode_";for(var se,fe,de,ve,Ee,Oe,qe,Qe,je,ue=k.data,Me=k.width,at=k.height,ze=4*Me,Ye=0;Ye<at;){for(se=0;se<ze;){for(Ee=ze*Ye+se,qe=-1,Qe=0,je=0;je<64;je++)Oe=Ee+(Qe=je>>3)*ze+(qe=4*(7&je)),Ye+Qe>=at&&(Oe-=ze*(Ye+1+Qe-at)),se+qe>=ze&&(Oe-=se+qe-ze+4),fe=ue[Oe++],de=ue[Oe++],ve=ue[Oe++],w[je]=(D[fe]+D[de+256>>0]+D[ve+512>>0]>>16)-128,_[je]=(D[fe+768>>0]+D[de+1024>>0]+D[ve+1280>>0]>>16)-128,E[je]=(D[fe+1280>>0]+D[de+1536>>0]+D[ve+1792>>0]>>16)-128;M=Z(w,u,M,t,n),L=Z(_,f,L,r,i),H=Z(E,f,H,r,i),se+=32}Ye+=8}if(y>=0){var Ze=[];Ze[1]=y+1,Ze[0]=(1<<y+1)-1,B(Ze)}return V(65497),new Uint8Array(x)},e=e||50,function(){for(var k=String.fromCharCode,I=0;I<256;I++)O[I]=k(I)}(),t=z(C,P),r=z(A,q),n=z(R,j),i=z(J,te),function(){for(var k=1,I=2,M=1;M<=15;M++){for(var L=k;L<I;L++)m[32767+L]=M,p[32767+L]=[],p[32767+L][1]=M,p[32767+L][0]=L;for(var H=-(I-1);H<=-k;H++)m[32767+H]=M,p[32767+H]=[],p[32767+H][1]=M,p[32767+H][0]=I-1+H;k<<=1,I<<=1}}(),function(){for(var k=0;k<256;k++)D[k]=19595*k,D[k+256>>0]=38470*k,D[k+512>>0]=7471*k+32768,D[k+768>>0]=-11059*k,D[k+1024>>0]=-21709*k,D[k+1280>>0]=32768*k+8421375,D[k+1536>>0]=-27439*k,D[k+1792>>0]=-5329*k}(),he(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function gs(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function a5(e){function t(C){if(!C)throw Error("assert :P")}function r(C,P,R){for(var j=0;4>j;j++)if(C[P+j]!=R.charCodeAt(j))return!0;return!1}function n(C,P,R,j,A){for(var q=0;q<A;q++)C[P+q]=R[j+q]}function i(C,P,R,j){for(var A=0;A<j;A++)C[P+A]=R}function s(C){return new Int32Array(C)}function a(C,P){for(var R=[],j=0;j<C;j++)R.push(new P);return R}function o(C,P){var R=[];return function j(A,q,J){for(var te=J[q],z=0;z<te&&(A.push(J.length>q+1?[]:new P),!(J.length<q+1));z++)j(A[z],q+1,J)}(R,0,C),R}var l=function(){var C=this;function P(d,g){for(var N=1<<g-1>>>0;d&N;)N>>>=1;return N?(d&N-1)+N:d}function R(d,g,N,F,U){t(!(F%N));do d[g+(F-=N)]=U;while(0<F)}function j(d,g,N,F,U){if(t(2328>=U),512>=U)var Y=s(512);else if((Y=s(U))==null)return 0;return function(X,Q,ee,ie,ge,Ne){var ke,we,Re=Q,Pe=1<<ee,xe=s(16),ye=s(16);for(t(ge!=0),t(ie!=null),t(X!=null),t(0<ee),we=0;we<ge;++we){if(15<ie[we])return 0;++xe[ie[we]]}if(xe[0]==ge)return 0;for(ye[1]=0,ke=1;15>ke;++ke){if(xe[ke]>1<<ke)return 0;ye[ke+1]=ye[ke]+xe[ke]}for(we=0;we<ge;++we)ke=ie[we],0<ie[we]&&(Ne[ye[ke]++]=we);if(ye[15]==1)return(ie=new A).g=0,ie.value=Ne[0],R(X,Re,1,Pe,ie),Pe;var De,Ue=-1,Ie=Pe-1,lt=0,et=1,gt=1,rt=1<<ee;for(we=0,ke=1,ge=2;ke<=ee;++ke,ge<<=1){if(et+=gt<<=1,0>(gt-=xe[ke]))return 0;for(;0<xe[ke];--xe[ke])(ie=new A).g=ke,ie.value=Ne[we++],R(X,Re+lt,ge,rt,ie),lt=P(lt,ke)}for(ke=ee+1,ge=2;15>=ke;++ke,ge<<=1){if(et+=gt<<=1,0>(gt-=xe[ke]))return 0;for(;0<xe[ke];--xe[ke]){if(ie=new A,(lt&Ie)!=Ue){for(Re+=rt,De=1<<(Ue=ke)-ee;15>Ue&&!(0>=(De-=xe[Ue]));)++Ue,De<<=1;Pe+=rt=1<<(De=Ue-ee),X[Q+(Ue=lt&Ie)].g=De+ee,X[Q+Ue].value=Re-Q-Ue}ie.g=ke-ee,ie.value=Ne[we++],R(X,Re+(lt>>ee),ge,rt,ie),lt=P(lt,ke)}}return et!=2*ye[15]-1?0:Pe}(d,g,N,F,U,Y)}function A(){this.value=this.g=0}function q(){this.value=this.g=0}function J(){this.G=a(5,A),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(vn,q)}function te(d,g,N,F){t(d!=null),t(g!=null),t(2147483648>F),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=g,d.pa=N,d.Jd=g,d.Yc=N+F,d.Zc=4<=F?N+F-4+1:N,se(d)}function z(d,g){for(var N=0;0<g--;)N|=de(d,128)<<g;return N}function B(d,g){var N=z(d,g);return fe(d)?-N:N}function G(d,g,N,F){var U,Y=0;for(t(d!=null),t(g!=null),t(4294967288>F),d.Sb=F,d.Ra=0,d.u=0,d.h=0,4<F&&(F=4),U=0;U<F;++U)Y+=g[N+U]<<8*U;d.Ra=Y,d.bb=F,d.oa=g,d.pa=N}function V(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<Jl-8>>>0,++d.bb,d.u-=8;M(d)&&(d.h=1,d.u=0)}function Z(d,g){if(t(0<=g),!d.h&&g<=Xl){var N=I(d)&Kl[g];return d.u+=g,V(d),N}return d.h=1,d.u=0}function he(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(d){return d.Ra>>>(d.u&Jl-1)>>>0}function M(d){return t(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>Jl}function L(d,g){d.u=g,d.h=M(d)}function H(d){d.u>=Du&&(t(d.u>=Du),V(d))}function se(d){t(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(t(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function fe(d){return z(d,1)}function de(d,g){var N=d.Ca;0>d.b&&se(d);var F=d.b,U=N*g>>>8,Y=(d.I>>>F>U)+0;for(Y?(N-=U,d.I-=U+1<<F>>>0):N=U+1,F=N,U=0;256<=F;)U+=8,F>>=8;return F=7^U+ii[F],d.b-=F,d.Ca=(N<<F)-1,Y}function ve(d,g,N){d[g+0]=N>>24&255,d[g+1]=N>>16&255,d[g+2]=N>>8&255,d[g+3]=N>>0&255}function Ee(d,g){return d[g+0]<<0|d[g+1]<<8}function Oe(d,g){return Ee(d,g)|d[g+2]<<16}function qe(d,g){return Ee(d,g)|Ee(d,g+2)<<16}function Qe(d,g){var N=1<<g;return t(d!=null),t(0<g),d.X=s(N),d.X==null?0:(d.Mb=32-g,d.Xa=g,1)}function je(d,g){t(d!=null),t(g!=null),t(d.Xa==g.Xa),n(g.X,0,d.X,0,1<<g.Xa)}function ue(){this.X=[],this.Xa=this.Mb=0}function Me(d,g,N,F){t(N!=null),t(F!=null);var U=N[0],Y=F[0];return U==0&&(U=(d*Y+g/2)/g),Y==0&&(Y=(g*U+d/2)/d),0>=U||0>=Y?0:(N[0]=U,F[0]=Y,1)}function at(d,g){return d+(1<<g)-1>>>g}function ze(d,g){return((4278255360&d)+(4278255360&g)>>>0&4278255360)+((16711935&d)+(16711935&g)>>>0&16711935)>>>0}function Ye(d,g){C[g]=function(N,F,U,Y,X,Q,ee){var ie;for(ie=0;ie<X;++ie){var ge=C[d](Q[ee+ie-1],U,Y+ie);Q[ee+ie]=ze(N[F+ie],ge)}}}function Ze(){this.ud=this.hd=this.jd=0}function tt(d,g){return((4278124286&(d^g))>>>1)+(d&g)>>>0}function ft(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function dt(d,g){return ft(d+(d-g+.5>>1))}function bt(d,g,N){return Math.abs(g-N)-Math.abs(d-N)}function At(d,g,N,F,U,Y,X){for(F=Y[X-1],N=0;N<U;++N)Y[X+N]=F=ze(d[g+N],F)}function Lt(d,g,N,F,U){var Y;for(Y=0;Y<N;++Y){var X=d[g+Y],Q=X>>8&255,ee=16711935&(ee=(ee=16711935&X)+((Q<<16)+Q));F[U+Y]=(4278255360&X)+ee>>>0}}function Ot(d,g){g.jd=d>>0&255,g.hd=d>>8&255,g.ud=d>>16&255}function xt(d,g,N,F,U,Y){var X;for(X=0;X<F;++X){var Q=g[N+X],ee=Q>>>8,ie=Q,ge=255&(ge=(ge=Q>>>16)+((d.jd<<24>>24)*(ee<<24>>24)>>>5));ie=255&(ie=(ie=ie+((d.hd<<24>>24)*(ee<<24>>24)>>>5))+((d.ud<<24>>24)*(ge<<24>>24)>>>5)),U[Y+X]=(4278255360&Q)+(ge<<16)+ie}}function Ct(d,g,N,F,U){C[g]=function(Y,X,Q,ee,ie,ge,Ne,ke,we){for(ee=Ne;ee<ke;++ee)for(Ne=0;Ne<we;++Ne)ie[ge++]=U(Q[F(Y[X++])])},C[d]=function(Y,X,Q,ee,ie,ge,Ne){var ke=8>>Y.b,we=Y.Ea,Re=Y.K[0],Pe=Y.w;if(8>ke)for(Y=(1<<Y.b)-1,Pe=(1<<ke)-1;X<Q;++X){var xe,ye=0;for(xe=0;xe<we;++xe)xe&Y||(ye=F(ee[ie++])),ge[Ne++]=U(Re[ye&Pe]),ye>>=ke}else C["VP8LMapColor"+N](ee,ie,Re,Pe,ge,Ne,X,Q,we)}}function nt(d,g,N,F,U){for(N=g+N;g<N;){var Y=d[g++];F[U++]=Y>>16&255,F[U++]=Y>>8&255,F[U++]=Y>>0&255}}function Zr(d,g,N,F,U){for(N=g+N;g<N;){var Y=d[g++];F[U++]=Y>>16&255,F[U++]=Y>>8&255,F[U++]=Y>>0&255,F[U++]=Y>>24&255}}function Rt(d,g,N,F,U){for(N=g+N;g<N;){var Y=(X=d[g++])>>16&240|X>>12&15,X=X>>0&240|X>>28&15;F[U++]=Y,F[U++]=X}}function ti(d,g,N,F,U){for(N=g+N;g<N;){var Y=(X=d[g++])>>16&248|X>>13&7,X=X>>5&224|X>>3&31;F[U++]=Y,F[U++]=X}}function Gt(d,g,N,F,U){for(N=g+N;g<N;){var Y=d[g++];F[U++]=Y>>0&255,F[U++]=Y>>8&255,F[U++]=Y>>16&255}}function fr(d,g,N,F,U,Y){if(Y==0)for(N=g+N;g<N;)ve(F,((Y=d[g++])[0]>>24|Y[1]>>8&65280|Y[2]<<8&16711680|Y[3]<<24)>>>0),U+=32;else n(F,U,d,g,N)}function Ui(d,g){C[g][0]=C[d+"0"],C[g][1]=C[d+"1"],C[g][2]=C[d+"2"],C[g][3]=C[d+"3"],C[g][4]=C[d+"4"],C[g][5]=C[d+"5"],C[g][6]=C[d+"6"],C[g][7]=C[d+"7"],C[g][8]=C[d+"8"],C[g][9]=C[d+"9"],C[g][10]=C[d+"10"],C[g][11]=C[d+"11"],C[g][12]=C[d+"12"],C[g][13]=C[d+"13"],C[g][14]=C[d+"0"],C[g][15]=C[d+"0"]}function Bt(d){return d==um||d==fm||d==sh||d==dm}function Fs(){this.eb=[],this.size=this.A=this.fb=0}function gr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function yi(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Fs,this.f.kb=new gr,this.sd=null}function as(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function lr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _t(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Ht(d,g){var N=d.T,F=g.ba.f.RGBA,U=F.eb,Y=F.fb+d.ka*F.A,X=Yi[g.ba.S],Q=d.y,ee=d.O,ie=d.f,ge=d.N,Ne=d.ea,ke=d.W,we=g.cc,Re=g.dc,Pe=g.Mc,xe=g.Nc,ye=d.ka,De=d.ka+d.T,Ue=d.U,Ie=Ue+1>>1;for(ye==0?X(Q,ee,null,null,ie,ge,Ne,ke,ie,ge,Ne,ke,U,Y,null,null,Ue):(X(g.ec,g.fc,Q,ee,we,Re,Pe,xe,ie,ge,Ne,ke,U,Y-F.A,U,Y,Ue),++N);ye+2<De;ye+=2)we=ie,Re=ge,Pe=Ne,xe=ke,ge+=d.Rc,ke+=d.Rc,Y+=2*F.A,X(Q,(ee+=2*d.fa)-d.fa,Q,ee,we,Re,Pe,xe,ie,ge,Ne,ke,U,Y-F.A,U,Y,Ue);return ee+=d.fa,d.j+De<d.o?(n(g.ec,g.fc,Q,ee,Ue),n(g.cc,g.dc,ie,ge,Ie),n(g.Mc,g.Nc,Ne,ke,Ie),N--):1&De||X(Q,ee,null,null,ie,ge,Ne,ke,ie,ge,Ne,ke,U,Y+F.A,null,null,Ue),N}function ra(d,g,N){var F=d.F,U=[d.J];if(F!=null){var Y=d.U,X=g.ba.S,Q=X==ih||X==sh;g=g.ba.f.RGBA;var ee=[0],ie=d.ka;ee[0]=d.T,d.Kb&&(ie==0?--ee[0]:(--ie,U[0]-=d.width),d.j+d.ka+d.T==d.o&&(ee[0]=d.o-d.j-ie));var ge=g.eb;ie=g.fb+ie*g.A,d=hr(F,U[0],d.width,Y,ee,ge,ie+(Q?0:3),g.A),t(N==ee),d&&Bt(X)&&Vi(ge,ie,Q,Y,ee,g.A)}return 0}function en(d){var g=d.ma,N=g.ba.S,F=11>N,U=N==rh||N==nh||N==ih||N==cm||N==12||Bt(N);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!Fu(g.Oa,d,U?11:12))return 0;if(U&&Bt(N)&&We(),d.da)alert("todo:use_scaling");else{if(F){if(g.Ib=_t,d.Kb){if(N=d.U+1>>1,g.memory=s(d.U+2*N),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+d.U,g.Mc=g.cc,g.Nc=g.dc+N,g.Ib=Ht,We()}}else alert("todo:EmitYUV");U&&(g.Jb=ra,F&&be())}if(F&&!Dx){for(d=0;256>d;++d)MS[d]=89858*(d-128)+oh>>ah,zS[d]=-22014*(d-128)+oh,US[d]=-45773*(d-128),BS[d]=113618*(d-128)+oh>>ah;for(d=Wu;d<mm;++d)g=76283*(d-16)+oh>>ah,WS[d-Wu]=_i(g,255),HS[d-Wu]=_i(g+8>>4,15);Dx=1}return 1}function zi(d){var g=d.ma,N=d.U,F=d.T;return t(!(1&d.ka)),0>=N||0>=F?0:(N=g.Ib(d,g),g.Jb!=null&&g.Jb(d,g,N),g.Dc+=N,1)}function Wi(d){d.ma.memory=null}function mt(d,g,N,F){return Z(d,8)!=47?0:(g[0]=Z(d,14)+1,N[0]=Z(d,14)+1,F[0]=Z(d,1),Z(d,3)!=0?0:!d.h)}function wi(d,g){if(4>d)return d+1;var N=d-2>>1;return(2+(1&d)<<N)+Z(g,N)+1}function ri(d,g){return 120<g?g-120:1<=(N=((N=NS[g-1])>>4)*d+(8-(15&N)))?N:1;var N}function Cn(d,g,N){var F=I(N),U=d[g+=255&F].g-8;return 0<U&&(L(N,N.u+8),F=I(N),g+=d[g].value,g+=F&(1<<U)-1),L(N,N.u+d[g].g),d[g].value}function Or(d,g,N){return N.g+=d.g,N.value+=d.value<<g>>>0,t(8>=N.g),d.g}function Ar(d,g,N){var F=d.xc;return t((g=F==0?0:d.vc[d.md*(N>>F)+(g>>F)])<d.Wb),d.Ya[g]}function K(d,g,N,F){var U=d.ab,Y=d.c*g,X=d.C;g=X+g;var Q=N,ee=F;for(F=d.Ta,N=d.Ua;0<U--;){var ie=d.gc[U],ge=X,Ne=g,ke=Q,we=ee,Re=(ee=F,Q=N,ie.Ea);switch(t(ge<Ne),t(Ne<=ie.nc),ie.hc){case 2:Kd(ke,we,(Ne-ge)*Re,ee,Q);break;case 0:var Pe=ge,xe=Ne,ye=ee,De=Q,Ue=(rt=ie).Ea;Pe==0&&(om(ke,we,null,null,1,ye,De),At(ke,we+1,0,0,Ue-1,ye,De+1),we+=Ue,De+=Ue,++Pe);for(var Ie=1<<rt.b,lt=Ie-1,et=at(Ue,rt.b),gt=rt.K,rt=rt.w+(Pe>>rt.b)*et;Pe<xe;){var qt=gt,Xt=rt,Ut=1;for(Iu(ke,we,ye,De-Ue,1,ye,De);Ut<Ue;){var Dt=(Ut&~lt)+Ie;Dt>Ue&&(Dt=Ue),(0,Da[qt[Xt++]>>8&15])(ke,we+ +Ut,ye,De+Ut-Ue,Dt-Ut,ye,De+Ut),Ut=Dt}we+=Ue,De+=Ue,++Pe&lt||(rt+=et)}Ne!=ie.nc&&n(ee,Q-Re,ee,Q+(Ne-ge-1)*Re,Re);break;case 1:for(Re=ke,xe=we,Ue=(ke=ie.Ea)-(De=ke&~(ye=(we=1<<ie.b)-1)),Pe=at(ke,ie.b),Ie=ie.K,ie=ie.w+(ge>>ie.b)*Pe;ge<Ne;){for(lt=Ie,et=ie,gt=new Ze,rt=xe+De,qt=xe+ke;xe<rt;)Ot(lt[et++],gt),qo(gt,Re,xe,we,ee,Q),xe+=we,Q+=we;xe<qt&&(Ot(lt[et++],gt),qo(gt,Re,xe,Ue,ee,Q),xe+=Ue,Q+=Ue),++ge&ye||(ie+=Pe)}break;case 3:if(ke==ee&&we==Q&&0<ie.b){for(xe=ee,ke=Re=Q+(Ne-ge)*Re-(De=(Ne-ge)*at(ie.Ea,ie.b)),we=ee,ye=Q,Pe=[],De=(Ue=De)-1;0<=De;--De)Pe[De]=we[ye+De];for(De=Ue-1;0<=De;--De)xe[ke+De]=Pe[De];Hi(ie,ge,Ne,ee,Re,ee,Q)}else Hi(ie,ge,Ne,ke,we,ee,Q)}Q=F,ee=N}ee!=N&&n(F,N,Q,ee,Y)}function oe(d,g){var N=d.V,F=d.Ba+d.c*d.C,U=g-d.C;if(t(g<=d.l.o),t(16>=U),0<U){var Y=d.l,X=d.Ta,Q=d.Ua,ee=Y.width;if(K(d,U,N,F),U=Q=[Q],t((N=d.C)<(F=g)),t(Y.v<Y.va),F>Y.o&&(F=Y.o),N<Y.j){var ie=Y.j-N;N=Y.j,U[0]+=ie*ee}if(N>=F?N=0:(U[0]+=4*Y.v,Y.ka=N-Y.j,Y.U=Y.va-Y.v,Y.T=F-N,N=1),N){if(Q=Q[0],11>(N=d.ca).S){var ge=N.f.RGBA,Ne=(F=N.S,U=Y.U,Y=Y.T,ie=ge.eb,ge.A),ke=Y;for(ge=ge.fb+d.Ma*ge.A;0<ke--;){var we=X,Re=Q,Pe=U,xe=ie,ye=ge;switch(F){case th:si(we,Re,Pe,xe,ye);break;case rh:$n(we,Re,Pe,xe,ye);break;case um:$n(we,Re,Pe,xe,ye),Vi(xe,ye,0,Pe,1,0);break;case Ex:oa(we,Re,Pe,xe,ye);break;case nh:fr(we,Re,Pe,xe,ye,1);break;case fm:fr(we,Re,Pe,xe,ye,1),Vi(xe,ye,0,Pe,1,0);break;case ih:fr(we,Re,Pe,xe,ye,0);break;case sh:fr(we,Re,Pe,xe,ye,0),Vi(xe,ye,1,Pe,1,0);break;case cm:Ia(we,Re,Pe,xe,ye);break;case dm:Ia(we,Re,Pe,xe,ye),dr(xe,ye,Pe,1,0);break;case Ax:aa(we,Re,Pe,xe,ye);break;default:t(0)}Q+=ee,ge+=Ne}d.Ma+=Y}else alert("todo:EmitRescaledRowsYUVA");t(d.Ma<=N.height)}}d.C=g,t(d.C<=d.i)}function re(d){var g;if(0<d.ua)return 0;for(g=0;g<d.Wb;++g){var N=d.Ya[g].G,F=d.Ya[g].H;if(0<N[1][F[1]+0].g||0<N[2][F[2]+0].g||0<N[3][F[3]+0].g)return 0}return 1}function ne(d,g,N,F,U,Y){if(d.Z!=0){var X=d.qd,Q=d.rd;for(t(Ua[d.Z]!=null);g<N;++g)Ua[d.Z](X,Q,F,U,F,U,Y),X=F,Q=U,U+=Y;d.qd=X,d.rd=Q}}function ae(d,g){var N=d.l.ma,F=N.Z==0||N.Z==1?d.l.j:d.C;if(F=d.C<F?F:d.C,t(g<=d.l.o),g>F){var U=d.l.width,Y=N.ca,X=N.tb+U*F,Q=d.V,ee=d.Ba+d.c*F,ie=d.gc;t(d.ab==1),t(ie[0].hc==3),Xd(ie[0],F,g,Q,ee,Y,X),ne(N,F,g,Y,X,U)}d.C=d.Ma=g}function le(d,g,N,F,U,Y,X){var Q=d.$/F,ee=d.$%F,ie=d.m,ge=d.s,Ne=N+d.$,ke=Ne;U=N+F*U;var we=N+F*Y,Re=280+ge.ua,Pe=d.Pb?Q:16777216,xe=0<ge.ua?ge.Wa:null,ye=ge.wc,De=Ne<we?Ar(ge,ee,Q):null;t(d.C<Y),t(we<=U);var Ue=!1;e:for(;;){for(;Ue||Ne<we;){var Ie=0;if(Q>=Pe){var lt=Ne-N;t((Pe=d).Pb),Pe.wd=Pe.m,Pe.xd=lt,0<Pe.s.ua&&je(Pe.s.Wa,Pe.s.vb),Pe=Q+ES}if(ee&ye||(De=Ar(ge,ee,Q)),t(De!=null),De.Qb&&(g[Ne]=De.qb,Ue=!0),!Ue)if(H(ie),De.jc){Ie=ie,lt=g;var et=Ne,gt=De.pd[I(Ie)&vn-1];t(De.jc),256>gt.g?(L(Ie,Ie.u+gt.g),lt[et]=gt.value,Ie=0):(L(Ie,Ie.u+gt.g-256),t(256<=gt.value),Ie=gt.value),Ie==0&&(Ue=!0)}else Ie=Cn(De.G[0],De.H[0],ie);if(ie.h)break;if(Ue||256>Ie){if(!Ue)if(De.nd)g[Ne]=(De.qb|Ie<<8)>>>0;else{if(H(ie),Ue=Cn(De.G[1],De.H[1],ie),H(ie),lt=Cn(De.G[2],De.H[2],ie),et=Cn(De.G[3],De.H[3],ie),ie.h)break;g[Ne]=(et<<24|Ue<<16|Ie<<8|lt)>>>0}if(Ue=!1,++Ne,++ee>=F&&(ee=0,++Q,X!=null&&Q<=Y&&!(Q%16)&&X(d,Q),xe!=null))for(;ke<Ne;)Ie=g[ke++],xe.X[(506832829*Ie&4294967295)>>>xe.Mb]=Ie}else if(280>Ie){if(Ie=wi(Ie-256,ie),lt=Cn(De.G[4],De.H[4],ie),H(ie),lt=ri(F,lt=wi(lt,ie)),ie.h)break;if(Ne-N<lt||U-Ne<Ie)break e;for(et=0;et<Ie;++et)g[Ne+et]=g[Ne+et-lt];for(Ne+=Ie,ee+=Ie;ee>=F;)ee-=F,++Q,X!=null&&Q<=Y&&!(Q%16)&&X(d,Q);if(t(Ne<=U),ee&ye&&(De=Ar(ge,ee,Q)),xe!=null)for(;ke<Ne;)Ie=g[ke++],xe.X[(506832829*Ie&4294967295)>>>xe.Mb]=Ie}else{if(!(Ie<Re))break e;for(Ue=Ie-280,t(xe!=null);ke<Ne;)Ie=g[ke++],xe.X[(506832829*Ie&4294967295)>>>xe.Mb]=Ie;Ie=Ne,t(!(Ue>>>(lt=xe).Xa)),g[Ie]=lt.X[Ue],Ue=!0}Ue||t(ie.h==M(ie))}if(d.Pb&&ie.h&&Ne<U)t(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&je(d.s.vb,d.s.Wa);else{if(ie.h)break e;X!=null&&X(d,Q>Y?Y:Q),d.a=0,d.$=Ne-N}return 1}return d.a=3,0}function Se(d){t(d!=null),d.vc=null,d.yc=null,d.Ya=null;var g=d.Wa;g!=null&&(g.X=null),d.vb=null,t(d!=null)}function Ce(){var d=new am;return d==null?null:(d.a=0,d.xb=Cx,Ui("Predictor","VP8LPredictors"),Ui("Predictor","VP8LPredictors_C"),Ui("PredictorAdd","VP8LPredictorsAdd"),Ui("PredictorAdd","VP8LPredictorsAdd_C"),Kd=Lt,qo=xt,si=nt,$n=Zr,Ia=Rt,aa=ti,oa=Gt,C.VP8LMapColor32b=Ql,C.VP8LMapColor8b=Jd,d)}function _e(d,g,N,F,U){var Y=1,X=[d],Q=[g],ee=F.m,ie=F.s,ge=null,Ne=0;e:for(;;){if(N)for(;Y&&Z(ee,1);){var ke=X,we=Q,Re=F,Pe=1,xe=Re.m,ye=Re.gc[Re.ab],De=Z(xe,2);if(Re.Oc&1<<De)Y=0;else{switch(Re.Oc|=1<<De,ye.hc=De,ye.Ea=ke[0],ye.nc=we[0],ye.K=[null],++Re.ab,t(4>=Re.ab),De){case 0:case 1:ye.b=Z(xe,3)+2,Pe=_e(at(ye.Ea,ye.b),at(ye.nc,ye.b),0,Re,ye.K),ye.K=ye.K[0];break;case 3:var Ue,Ie=Z(xe,8)+1,lt=16<Ie?0:4<Ie?1:2<Ie?2:3;if(ke[0]=at(ye.Ea,lt),ye.b=lt,Ue=Pe=_e(Ie,1,0,Re,ye.K)){var et,gt=Ie,rt=ye,qt=1<<(8>>rt.b),Xt=s(qt);if(Xt==null)Ue=0;else{var Ut=rt.K[0],Dt=rt.w;for(Xt[0]=rt.K[0][0],et=1;et<1*gt;++et)Xt[et]=ze(Ut[Dt+et],Xt[et-1]);for(;et<4*qt;++et)Xt[et]=0;rt.K[0]=null,rt.K[0]=Xt,Ue=1}}Pe=Ue;break;case 2:break;default:t(0)}Y=Pe}}if(X=X[0],Q=Q[0],Y&&Z(ee,1)&&!(Y=1<=(Ne=Z(ee,4))&&11>=Ne)){F.a=3;break e}var cr;if(cr=Y)t:{var ar,Tt,qr,ai=F,Vr=X,oi=Q,Jt=Ne,Ni=N,ki=ai.m,cn=ai.s,yn=[null],Vn=1,Ki=0,Bs=kS[Jt];r:for(;;){if(Ni&&Z(ki,1)){var un=Z(ki,3)+2,fa=at(Vr,un),Xo=at(oi,un),nc=fa*Xo;if(!_e(fa,Xo,0,ai,yn))break r;for(yn=yn[0],cn.xc=un,ar=0;ar<nc;++ar){var za=yn[ar]>>8&65535;yn[ar]=za,za>=Vn&&(Vn=za+1)}}if(ki.h)break r;for(Tt=0;5>Tt;++Tt){var jr=Tx[Tt];!Tt&&0<Jt&&(jr+=1<<Jt),Ki<jr&&(Ki=jr)}var gm=a(Vn*Bs,A),Mx=Vn,Bx=a(Mx,J);if(Bx==null)var ch=null;else t(65536>=Mx),ch=Bx;var Hu=s(Ki);if(ch==null||Hu==null||gm==null){ai.a=1;break r}var uh=gm;for(ar=qr=0;ar<Vn;++ar){var hs=ch[ar],ic=hs.G,sc=hs.H,Ux=0,fh=1,zx=0;for(Tt=0;5>Tt;++Tt){jr=Tx[Tt],ic[Tt]=uh,sc[Tt]=qr,!Tt&&0<Jt&&(jr+=1<<Jt);i:{var dh,xm=jr,hh=ai,$u=Hu,VS=uh,GS=qr,vm=0,Wa=hh.m,YS=Z(Wa,1);if(i($u,0,0,xm),YS){var KS=Z(Wa,1)+1,XS=Z(Wa,1),Wx=Z(Wa,XS==0?1:8);$u[Wx]=1,KS==2&&($u[Wx=Z(Wa,8)]=1);var ph=1}else{var Hx=s(19),$x=Z(Wa,4)+4;if(19<$x){hh.a=3;var mh=0;break i}for(dh=0;dh<$x;++dh)Hx[SS[dh]]=Z(Wa,3);var ym=void 0,qu=void 0,qx=hh,JS=Hx,gh=xm,Vx=$u,wm=0,Ha=qx.m,Gx=8,Yx=a(128,A);n:for(;j(Yx,0,7,JS,19);){if(Z(Ha,1)){var QS=2+2*Z(Ha,3);if((ym=2+Z(Ha,QS))>gh)break n}else ym=gh;for(qu=0;qu<gh&&ym--;){H(Ha);var Kx=Yx[0+(127&I(Ha))];L(Ha,Ha.u+Kx.g);var ac=Kx.value;if(16>ac)Vx[qu++]=ac,ac!=0&&(Gx=ac);else{var ZS=ac==16,Xx=ac-16,eN=bS[Xx],Jx=Z(Ha,wS[Xx])+eN;if(qu+Jx>gh)break n;for(var tN=ZS?Gx:0;0<Jx--;)Vx[qu++]=tN}}wm=1;break n}wm||(qx.a=3),ph=wm}(ph=ph&&!Wa.h)&&(vm=j(VS,GS,8,$u,xm)),ph&&vm!=0?mh=vm:(hh.a=3,mh=0)}if(mh==0)break r;if(fh&&_S[Tt]==1&&(fh=uh[qr].g==0),Ux+=uh[qr].g,qr+=mh,3>=Tt){var Vu,bm=Hu[0];for(Vu=1;Vu<jr;++Vu)Hu[Vu]>bm&&(bm=Hu[Vu]);zx+=bm}}if(hs.nd=fh,hs.Qb=0,fh&&(hs.qb=(ic[3][sc[3]+0].value<<24|ic[1][sc[1]+0].value<<16|ic[2][sc[2]+0].value)>>>0,Ux==0&&256>ic[0][sc[0]+0].value&&(hs.Qb=1,hs.qb+=ic[0][sc[0]+0].value<<8)),hs.jc=!hs.Qb&&6>zx,hs.jc){var xh,da=hs;for(xh=0;xh<vn;++xh){var $a=xh,qa=da.pd[$a],vh=da.G[0][da.H[0]+$a];256<=vh.value?(qa.g=vh.g+256,qa.value=vh.value):(qa.g=0,qa.value=0,$a>>=Or(vh,8,qa),$a>>=Or(da.G[1][da.H[1]+$a],16,qa),$a>>=Or(da.G[2][da.H[2]+$a],0,qa),Or(da.G[3][da.H[3]+$a],24,qa))}}}cn.vc=yn,cn.Wb=Vn,cn.Ya=ch,cn.yc=gm,cr=1;break t}cr=0}if(!(Y=cr)){F.a=3;break e}if(0<Ne){if(ie.ua=1<<Ne,!Qe(ie.Wa,Ne)){F.a=1,Y=0;break e}}else ie.ua=0;var _m=F,Qx=X,rN=Q,Sm=_m.s,Nm=Sm.xc;if(_m.c=Qx,_m.i=rN,Sm.md=at(Qx,Nm),Sm.wc=Nm==0?-1:(1<<Nm)-1,N){F.xb=FS;break e}if((ge=s(X*Q))==null){F.a=1,Y=0;break e}Y=(Y=le(F,ge,0,X,Q,Q,null))&&!ee.h;break e}return Y?(U!=null?U[0]=ge:(t(ge==null),t(N)),F.$=0,N||Se(ie)):Se(ie),Y}function Ae(d,g){var N=d.c*d.i,F=N+g+16*g;return t(d.c<=g),d.V=s(F),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+N+g,1)}function Te(d,g){var N=d.C,F=g-N,U=d.V,Y=d.Ba+d.c*N;for(t(g<=d.l.o);0<F;){var X=16<F?16:F,Q=d.l.ma,ee=d.l.width,ie=ee*X,ge=Q.ca,Ne=Q.tb+ee*N,ke=d.Ta,we=d.Ua;K(d,X,U,Y),Rr(ke,we,ge,Ne,ie),ne(Q,N,N+X,ge,Ne,ee),F-=X,U+=X*d.c,N+=X}t(N==g),d.C=d.Ma=g}function He(){this.ub=this.yd=this.td=this.Rb=0}function Ke(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function st(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ve(){this.Yb=function(){var d=[];return function g(N,F,U){for(var Y=U[F],X=0;X<Y&&(N.push(U.length>F+1?[]:0),!(U.length<F+1));X++)g(N[X],F+1,U)}(d,0,[3,11]),d}()}function it(){this.jb=s(3),this.Wc=o([4,8],Ve),this.Xc=o([4,17],Ve)}function wt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Yt(){this.ld=this.La=this.dd=this.tc=0}function sr(){this.Na=this.la=0}function Hr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function os(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function na(){this.uc=this.M=this.Nb=0,this.wa=Array(new Yt),this.Y=0,this.ya=Array(new os),this.aa=0,this.l=new Ds}function Os(){this.y=s(16),this.f=s(8),this.ea=s(8)}function ls(){this.cb=this.a=0,this.sc="",this.m=new he,this.Od=new He,this.Kc=new Ke,this.ed=new wt,this.Qa=new st,this.Ic=this.$c=this.Aa=0,this.D=new na,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,he),this.ia=0,this.pb=a(4,Hr),this.Pa=new it,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Os),this.Hd=0,this.rb=Array(new sr),this.sb=0,this.wa=Array(new Yt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new os),this.L=this.aa=0,this.gd=o([4,2],Yt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ds(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function bi(){var d=new ls;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,zu||(zu=Od)),d}function Dr(d,g,N){return d.a==0&&(d.a=g,d.sc=N,d.cb=0),0}function Ld(d,g,N){return 3<=N&&d[g+0]==157&&d[g+1]==1&&d[g+2]==42}function Fd(d,g){if(d==null)return 0;if(d.a=0,d.sc="OK",g==null)return Dr(d,2,"null VP8Io passed to VP8GetHeaders()");var N=g.data,F=g.w,U=g.ha;if(4>U)return Dr(d,7,"Truncated header.");var Y=N[F+0]|N[F+1]<<8|N[F+2]<<16,X=d.Od;if(X.Rb=!(1&Y),X.td=Y>>1&7,X.yd=Y>>4&1,X.ub=Y>>5,3<X.td)return Dr(d,3,"Incorrect keyframe parameters.");if(!X.yd)return Dr(d,4,"Frame not displayable.");F+=3,U-=3;var Q=d.Kc;if(X.Rb){if(7>U)return Dr(d,7,"cannot parse picture header");if(!Ld(N,F,U))return Dr(d,3,"Bad code word");Q.c=16383&(N[F+4]<<8|N[F+3]),Q.Td=N[F+4]>>6,Q.i=16383&(N[F+6]<<8|N[F+5]),Q.Ud=N[F+6]>>6,F+=7,U-=7,d.za=Q.c+15>>4,d.Ub=Q.i+15>>4,g.width=Q.c,g.height=Q.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,i((Y=d.Pa).jb,0,255,Y.jb.length),t((Y=d.Qa)!=null),Y.Cb=0,Y.Bb=0,Y.Fb=1,i(Y.Zb,0,0,Y.Zb.length),i(Y.Lb,0,0,Y.Lb)}if(X.ub>U)return Dr(d,7,"bad partition length");te(Y=d.m,N,F,X.ub),F+=X.ub,U-=X.ub,X.Rb&&(Q.Ld=fe(Y),Q.Kd=fe(Y)),Q=d.Qa;var ee,ie=d.Pa;if(t(Y!=null),t(Q!=null),Q.Cb=fe(Y),Q.Cb){if(Q.Bb=fe(Y),fe(Y)){for(Q.Fb=fe(Y),ee=0;4>ee;++ee)Q.Zb[ee]=fe(Y)?B(Y,7):0;for(ee=0;4>ee;++ee)Q.Lb[ee]=fe(Y)?B(Y,6):0}if(Q.Bb)for(ee=0;3>ee;++ee)ie.jb[ee]=fe(Y)?z(Y,8):255}else Q.Bb=0;if(Y.Ka)return Dr(d,3,"cannot parse segment header");if((Q=d.ed).zd=fe(Y),Q.Tb=z(Y,6),Q.wb=z(Y,3),Q.Pc=fe(Y),Q.Pc&&fe(Y)){for(ie=0;4>ie;++ie)fe(Y)&&(Q.vd[ie]=B(Y,6));for(ie=0;4>ie;++ie)fe(Y)&&(Q.od[ie]=B(Y,6))}if(d.L=Q.Tb==0?0:Q.zd?1:2,Y.Ka)return Dr(d,3,"cannot parse filter header");var ge=U;if(U=ee=F,F=ee+ge,Q=ge,d.Xb=(1<<z(d.m,2))-1,ge<3*(ie=d.Xb))N=7;else{for(ee+=3*ie,Q-=3*ie,ge=0;ge<ie;++ge){var Ne=N[U+0]|N[U+1]<<8|N[U+2]<<16;Ne>Q&&(Ne=Q),te(d.Jc[+ge],N,ee,Ne),ee+=Ne,Q-=Ne,U+=3}te(d.Jc[+ie],N,ee,Q),N=ee<F?0:5}if(N!=0)return Dr(d,N,"cannot parse partitions");for(N=z(ee=d.m,7),U=fe(ee)?B(ee,4):0,F=fe(ee)?B(ee,4):0,Q=fe(ee)?B(ee,4):0,ie=fe(ee)?B(ee,4):0,ee=fe(ee)?B(ee,4):0,ge=d.Qa,Ne=0;4>Ne;++Ne){if(ge.Cb){var ke=ge.Zb[Ne];ge.Fb||(ke+=N)}else{if(0<Ne){d.pb[Ne]=d.pb[0];continue}ke=N}var we=d.pb[Ne];we.Sc[0]=hm[_i(ke+U,127)],we.Sc[1]=pm[_i(ke+0,127)],we.Eb[0]=2*hm[_i(ke+F,127)],we.Eb[1]=101581*pm[_i(ke+Q,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=hm[_i(ke+ie,117)],we.Qc[1]=pm[_i(ke+ee,127)],we.lc=ke+ee}if(!X.Rb)return Dr(d,4,"Not a key frame.");for(fe(Y),X=d.Pa,N=0;4>N;++N){for(U=0;8>U;++U)for(F=0;3>F;++F)for(Q=0;11>Q;++Q)ie=de(Y,PS[N][U][F][Q])?z(Y,8):jS[N][U][F][Q],X.Wc[N][U].Yb[F][Q]=ie;for(U=0;17>U;++U)X.Xc[N][U]=X.Wc[N][LS[U]]}return d.kc=fe(Y),d.kc&&(d.Bd=z(Y,8)),d.cb=1}function Od(d,g,N,F,U,Y,X){var Q=g[U].Yb[N];for(N=0;16>U;++U){if(!de(d,Q[N+0]))return U;for(;!de(d,Q[N+1]);)if(Q=g[++U].Yb[0],N=0,U==16)return 16;var ee=g[U+1].Yb;if(de(d,Q[N+2])){var ie=d,ge=0;if(de(ie,(ke=Q)[(Ne=N)+3]))if(de(ie,ke[Ne+6])){for(Q=0,Ne=2*(ge=de(ie,ke[Ne+8]))+(ke=de(ie,ke[Ne+9+ge])),ge=0,ke=AS[Ne];ke[Q];++Q)ge+=ge+de(ie,ke[Q]);ge+=3+(8<<Ne)}else de(ie,ke[Ne+7])?(ge=7+2*de(ie,165),ge+=de(ie,145)):ge=5+de(ie,159);else ge=de(ie,ke[Ne+4])?3+de(ie,ke[Ne+5]):2;Q=ee[2]}else ge=1,Q=ee[1];ee=X+TS[U],0>(ie=d).b&&se(ie);var Ne,ke=ie.b,we=(Ne=ie.Ca>>1)-(ie.I>>ke)>>31;--ie.b,ie.Ca+=we,ie.Ca|=1,ie.I-=(Ne+1&we)<<ke,Y[ee]=((ge^we)-we)*F[(0<U)+0]}return 16}function vu(d){var g=d.rb[d.sb-1];g.la=0,g.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function Hp(d,g){if(d==null)return 0;if(g==null)return Dr(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!Fd(d,g))return 0;if(t(d.cb),g.ac==null||g.ac(g)){g.ob&&(d.L=0);var N=lh[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=g.v-N>>4,d.zb=g.j-N>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=g.o+15+N>>4,d.Hb=g.va+15+N>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var F=d.ed;for(N=0;4>N;++N){var U;if(d.Qa.Cb){var Y=d.Qa.Lb[N];d.Qa.Fb||(Y+=F.Tb)}else Y=F.Tb;for(U=0;1>=U;++U){var X=d.gd[N][U],Q=Y;if(F.Pc&&(Q+=F.vd[0],U&&(Q+=F.od[0])),0<(Q=0>Q?0:63<Q?63:Q)){var ee=Q;0<F.wb&&(ee=4<F.wb?ee>>2:ee>>1)>9-F.wb&&(ee=9-F.wb),1>ee&&(ee=1),X.dd=ee,X.tc=2*Q+ee,X.ld=40<=Q?2:15<=Q?1:0}else X.tc=0;X.La=U}}}N=0}else Dr(d,6,"Frame setup failed"),N=d.a;if(N=N==0){if(N){d.$c=0,0<d.Aa||(d.Ic=qS);e:{N=d.Ic,F=4*(ee=d.za);var ie=32*ee,ge=ee+1,Ne=0<d.L?ee*(0<d.Aa?2:1):0,ke=(d.Aa==2?2:1)*ee;if((X=F+832+(U=3*(16*N+lh[d.L])/2*ie)+(Y=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=X)N=0;else{if(X>d.Vb){if(d.Vb=0,d.Ec=s(X),d.Fc=0,d.Ec==null){N=Dr(d,1,"no memory during frame initialization.");break e}d.Vb=X}X=d.Ec,Q=d.Fc,d.Ac=X,d.Bc=Q,Q+=F,d.Gd=a(ie,Os),d.Hd=0,d.rb=a(ge+1,sr),d.sb=1,d.wa=Ne?a(Ne,Yt):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=ee),t(!0),d.oc=X,d.pc=Q,Q+=832,d.ya=a(ke,os),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=ee),d.R=16*ee,d.B=8*ee,ee=(ie=lh[d.L])*d.R,ie=ie/2*d.B,d.sa=X,d.ta=Q+ee,d.qa=d.sa,d.ra=d.ta+16*N*d.R+ie,d.Ha=d.qa,d.Ia=d.ra+8*N*d.B+ie,d.$c=0,Q+=U,d.mb=Y?X:null,d.nb=Y?Q:null,t(Q+Y<=d.Fc+d.Vb),vu(d),i(d.Ac,d.Bc,0,F),N=1}}if(N){if(g.ka=0,g.y=d.sa,g.O=d.ta,g.f=d.qa,g.N=d.ra,g.ea=d.Ha,g.Vd=d.Ia,g.fa=d.R,g.Rc=d.B,g.F=null,g.J=0,!Zd){for(N=-255;255>=N;++N)tn[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)ca[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)Uu[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)rc[255+N]=0>N?0:255<N?255:N;Zd=1}Zl=Vp,la=$p,Ru=Id,qn=qp,$i=Rd,Ir=Dd,ec=Nu,Qd=Ho,Mu=sm,Vo=ku,Go=im,Ra=$l,Yo=Eu,tc=Vd,Ko=qd,Ma=Rs,Bu=sa,qi=nm,ds[0]=Is,ds[1]=Gp,ds[2]=Jp,ds[3]=Qp,ds[4]=Ud,ds[5]=Wl,ds[6]=zd,ds[7]=bu,ds[8]=em,ds[9]=Zp,Ba[0]=Md,Ba[1]=Kp,Ba[2]=ia,Ba[3]=Ul,Ba[4]=Pn,Ba[5]=Xp,Ba[6]=Bd,ua[0]=La,ua[1]=Yp,ua[2]=tm,ua[3]=_u,ua[4]=Wo,ua[5]=rm,ua[6]=Su,N=1}else N=0}N&&(N=function(we,Re){for(we.M=0;we.M<we.Va;++we.M){var Pe,xe=we.Jc[we.M&we.Xb],ye=we.m,De=we;for(Pe=0;Pe<De.za;++Pe){var Ue=ye,Ie=De,lt=Ie.Ac,et=Ie.Bc+4*Pe,gt=Ie.zc,rt=Ie.ya[Ie.aa+Pe];if(Ie.Qa.Bb?rt.$b=de(Ue,Ie.Pa.jb[0])?2+de(Ue,Ie.Pa.jb[2]):de(Ue,Ie.Pa.jb[1]):rt.$b=0,Ie.kc&&(rt.Ad=de(Ue,Ie.Bd)),rt.Za=!de(Ue,145)+0,rt.Za){var qt=rt.Ob,Xt=0;for(Ie=0;4>Ie;++Ie){var Ut,Dt=gt[0+Ie];for(Ut=0;4>Ut;++Ut){Dt=CS[lt[et+Ut]][Dt];for(var cr=jx[de(Ue,Dt[0])];0<cr;)cr=jx[2*cr+de(Ue,Dt[cr])];Dt=-cr,lt[et+Ut]=Dt}n(qt,Xt,lt,et,4),Xt+=4,gt[0+Ie]=Dt}}else Dt=de(Ue,156)?de(Ue,128)?1:3:de(Ue,163)?2:0,rt.Ob[0]=Dt,i(lt,et,Dt,4),i(gt,0,Dt,4);rt.Dd=de(Ue,142)?de(Ue,114)?de(Ue,183)?1:3:2:0}if(De.m.Ka)return Dr(we,7,"Premature end-of-partition0 encountered.");for(;we.ja<we.za;++we.ja){if(De=xe,Ue=(ye=we).rb[ye.sb-1],lt=ye.rb[ye.sb+ye.ja],Pe=ye.ya[ye.aa+ye.ja],et=ye.kc?Pe.Ad:0)Ue.la=lt.la=0,Pe.Za||(Ue.Na=lt.Na=0),Pe.Hc=0,Pe.Gc=0,Pe.ia=0;else{var ar,Tt;if(Ue=lt,lt=De,et=ye.Pa.Xc,gt=ye.ya[ye.aa+ye.ja],rt=ye.pb[gt.$b],Ie=gt.ad,qt=0,Xt=ye.rb[ye.sb-1],Dt=Ut=0,i(Ie,qt,0,384),gt.Za)var qr=0,ai=et[3];else{cr=s(16);var Vr=Ue.Na+Xt.Na;if(Vr=zu(lt,et[1],Vr,rt.Eb,0,cr,0),Ue.Na=Xt.Na=(0<Vr)+0,1<Vr)Zl(cr,0,Ie,qt);else{var oi=cr[0]+3>>3;for(cr=0;256>cr;cr+=16)Ie[qt+cr]=oi}qr=1,ai=et[0]}var Jt=15&Ue.la,Ni=15&Xt.la;for(cr=0;4>cr;++cr){var ki=1&Ni;for(oi=Tt=0;4>oi;++oi)Jt=Jt>>1|(ki=(Vr=zu(lt,ai,Vr=ki+(1&Jt),rt.Sc,qr,Ie,qt))>qr)<<7,Tt=Tt<<2|(3<Vr?3:1<Vr?2:Ie[qt+0]!=0),qt+=16;Jt>>=4,Ni=Ni>>1|ki<<7,Ut=(Ut<<8|Tt)>>>0}for(ai=Jt,qr=Ni>>4,ar=0;4>ar;ar+=2){for(Tt=0,Jt=Ue.la>>4+ar,Ni=Xt.la>>4+ar,cr=0;2>cr;++cr){for(ki=1&Ni,oi=0;2>oi;++oi)Vr=ki+(1&Jt),Jt=Jt>>1|(ki=0<(Vr=zu(lt,et[2],Vr,rt.Qc,0,Ie,qt)))<<3,Tt=Tt<<2|(3<Vr?3:1<Vr?2:Ie[qt+0]!=0),qt+=16;Jt>>=2,Ni=Ni>>1|ki<<5}Dt|=Tt<<4*ar,ai|=Jt<<4<<ar,qr|=(240&Ni)<<ar}Ue.la=ai,Xt.la=qr,gt.Hc=Ut,gt.Gc=Dt,gt.ia=43690&Dt?0:rt.ia,et=!(Ut|Dt)}if(0<ye.L&&(ye.wa[ye.Y+ye.ja]=ye.gd[Pe.$b][Pe.Za],ye.wa[ye.Y+ye.ja].La|=!et),De.Ka)return Dr(we,7,"Premature end-of-file encountered.")}if(vu(we),ye=Re,De=1,Pe=(xe=we).D,Ue=0<xe.L&&xe.M>=xe.zb&&xe.M<=xe.Va,xe.Aa==0)e:{if(Pe.M=xe.M,Pe.uc=Ue,Lu(xe,Pe),De=1,Pe=(Tt=xe.D).Nb,Ue=(Dt=lh[xe.L])*xe.R,lt=Dt/2*xe.B,cr=16*Pe*xe.R,oi=8*Pe*xe.B,et=xe.sa,gt=xe.ta-Ue+cr,rt=xe.qa,Ie=xe.ra-lt+oi,qt=xe.Ha,Xt=xe.Ia-lt+oi,Ni=(Jt=Tt.M)==0,Ut=Jt>=xe.Va-1,xe.Aa==2&&Lu(xe,Tt),Tt.uc)for(ki=(Vr=xe).D.M,t(Vr.D.uc),Tt=Vr.yb;Tt<Vr.Hb;++Tt){qr=Tt,ai=ki;var cn=(yn=(jr=Vr).D).Nb;ar=jr.R;var yn=yn.wa[yn.Y+qr],Vn=jr.sa,Ki=jr.ta+16*cn*ar+16*qr,Bs=yn.dd,un=yn.tc;if(un!=0)if(t(3<=un),jr.L==1)0<qr&&Ma(Vn,Ki,ar,un+4),yn.La&&qi(Vn,Ki,ar,un),0<ai&&Ko(Vn,Ki,ar,un+4),yn.La&&Bu(Vn,Ki,ar,un);else{var fa=jr.B,Xo=jr.qa,nc=jr.ra+8*cn*fa+8*qr,za=jr.Ha,jr=jr.Ia+8*cn*fa+8*qr;cn=yn.ld,0<qr&&(Qd(Vn,Ki,ar,un+4,Bs,cn),Vo(Xo,nc,za,jr,fa,un+4,Bs,cn)),yn.La&&(Ra(Vn,Ki,ar,un,Bs,cn),tc(Xo,nc,za,jr,fa,un,Bs,cn)),0<ai&&(ec(Vn,Ki,ar,un+4,Bs,cn),Mu(Xo,nc,za,jr,fa,un+4,Bs,cn)),yn.La&&(Go(Vn,Ki,ar,un,Bs,cn),Yo(Xo,nc,za,jr,fa,un,Bs,cn))}}if(xe.ia&&alert("todo:DitherRow"),ye.put!=null){if(Tt=16*Jt,Jt=16*(Jt+1),Ni?(ye.y=xe.sa,ye.O=xe.ta+cr,ye.f=xe.qa,ye.N=xe.ra+oi,ye.ea=xe.Ha,ye.W=xe.Ia+oi):(Tt-=Dt,ye.y=et,ye.O=gt,ye.f=rt,ye.N=Ie,ye.ea=qt,ye.W=Xt),Ut||(Jt-=Dt),Jt>ye.o&&(Jt=ye.o),ye.F=null,ye.J=null,xe.Fa!=null&&0<xe.Fa.length&&Tt<Jt&&(ye.J=Cu(xe,ye,Tt,Jt-Tt),ye.F=xe.mb,ye.F==null&&ye.F.length==0)){De=Dr(xe,3,"Could not decode alpha data.");break e}Tt<ye.j&&(Dt=ye.j-Tt,Tt=ye.j,t(!(1&Dt)),ye.O+=xe.R*Dt,ye.N+=xe.B*(Dt>>1),ye.W+=xe.B*(Dt>>1),ye.F!=null&&(ye.J+=ye.width*Dt)),Tt<Jt&&(ye.O+=ye.v,ye.N+=ye.v>>1,ye.W+=ye.v>>1,ye.F!=null&&(ye.J+=ye.v),ye.ka=Tt-ye.j,ye.U=ye.va-ye.v,ye.T=Jt-Tt,De=ye.put(ye))}Pe+1!=xe.Ic||Ut||(n(xe.sa,xe.ta-Ue,et,gt+16*xe.R,Ue),n(xe.qa,xe.ra-lt,rt,Ie+8*xe.B,lt),n(xe.Ha,xe.Ia-lt,qt,Xt+8*xe.B,lt))}if(!De)return Dr(we,6,"Output aborted.")}return 1}(d,g)),g.bc!=null&&g.bc(g),N&=1}return N?(d.cb=0,N):0}function cs(d,g,N,F,U){U=d[g+N+32*F]+(U>>3),d[g+N+32*F]=-256&U?0>U?0:255:U}function Bl(d,g,N,F,U,Y){cs(d,g,0,N,F+U),cs(d,g,1,N,F+Y),cs(d,g,2,N,F-Y),cs(d,g,3,N,F-U)}function ni(d){return(20091*d>>16)+d}function yu(d,g,N,F){var U,Y=0,X=s(16);for(U=0;4>U;++U){var Q=d[g+0]+d[g+8],ee=d[g+0]-d[g+8],ie=(35468*d[g+4]>>16)-ni(d[g+12]),ge=ni(d[g+4])+(35468*d[g+12]>>16);X[Y+0]=Q+ge,X[Y+1]=ee+ie,X[Y+2]=ee-ie,X[Y+3]=Q-ge,Y+=4,g++}for(U=Y=0;4>U;++U)Q=(d=X[Y+0]+4)+X[Y+8],ee=d-X[Y+8],ie=(35468*X[Y+4]>>16)-ni(X[Y+12]),cs(N,F,0,0,Q+(ge=ni(X[Y+4])+(35468*X[Y+12]>>16))),cs(N,F,1,0,ee+ie),cs(N,F,2,0,ee-ie),cs(N,F,3,0,Q-ge),Y++,F+=32}function Dd(d,g,N,F){var U=d[g+0]+4,Y=35468*d[g+4]>>16,X=ni(d[g+4]),Q=35468*d[g+1]>>16;Bl(N,F,0,U+X,d=ni(d[g+1]),Q),Bl(N,F,1,U+Y,d,Q),Bl(N,F,2,U-Y,d,Q),Bl(N,F,3,U-X,d,Q)}function $p(d,g,N,F,U){yu(d,g,N,F),U&&yu(d,g+16,N,F+4)}function Id(d,g,N,F){la(d,g+0,N,F,1),la(d,g+32,N,F+128,1)}function qp(d,g,N,F){var U;for(d=d[g+0]+4,U=0;4>U;++U)for(g=0;4>g;++g)cs(N,F,g,U,d)}function Rd(d,g,N,F){d[g+0]&&qn(d,g+0,N,F),d[g+16]&&qn(d,g+16,N,F+4),d[g+32]&&qn(d,g+32,N,F+128),d[g+48]&&qn(d,g+48,N,F+128+4)}function Vp(d,g,N,F){var U,Y=s(16);for(U=0;4>U;++U){var X=d[g+0+U]+d[g+12+U],Q=d[g+4+U]+d[g+8+U],ee=d[g+4+U]-d[g+8+U],ie=d[g+0+U]-d[g+12+U];Y[0+U]=X+Q,Y[8+U]=X-Q,Y[4+U]=ie+ee,Y[12+U]=ie-ee}for(U=0;4>U;++U)X=(d=Y[0+4*U]+3)+Y[3+4*U],Q=Y[1+4*U]+Y[2+4*U],ee=Y[1+4*U]-Y[2+4*U],ie=d-Y[3+4*U],N[F+0]=X+Q>>3,N[F+16]=ie+ee>>3,N[F+32]=X-Q>>3,N[F+48]=ie-ee>>3,F+=64}function wu(d,g,N){var F,U=g-32,Y=Si,X=255-d[U-1];for(F=0;F<N;++F){var Q,ee=Y,ie=X+d[g-1];for(Q=0;Q<N;++Q)d[g+Q]=ee[ie+d[U+Q]];g+=32}}function Gp(d,g){wu(d,g,4)}function Yp(d,g){wu(d,g,8)}function Kp(d,g){wu(d,g,16)}function ia(d,g){var N;for(N=0;16>N;++N)n(d,g+32*N,d,g-32,16)}function Ul(d,g){var N;for(N=16;0<N;--N)i(d,g,d[g-1],16),g+=32}function zl(d,g,N){var F;for(F=0;16>F;++F)i(g,N+32*F,d,16)}function Md(d,g){var N,F=16;for(N=0;16>N;++N)F+=d[g-1+32*N]+d[g+N-32];zl(F>>5,d,g)}function Pn(d,g){var N,F=8;for(N=0;16>N;++N)F+=d[g-1+32*N];zl(F>>4,d,g)}function Xp(d,g){var N,F=8;for(N=0;16>N;++N)F+=d[g+N-32];zl(F>>4,d,g)}function Bd(d,g){zl(128,d,g)}function St(d,g,N){return d+2*g+N+2>>2}function Jp(d,g){var N,F=g-32;for(F=new Uint8Array([St(d[F-1],d[F+0],d[F+1]),St(d[F+0],d[F+1],d[F+2]),St(d[F+1],d[F+2],d[F+3]),St(d[F+2],d[F+3],d[F+4])]),N=0;4>N;++N)n(d,g+32*N,F,0,F.length)}function Qp(d,g){var N=d[g-1],F=d[g-1+32],U=d[g-1+64],Y=d[g-1+96];ve(d,g+0,16843009*St(d[g-1-32],N,F)),ve(d,g+32,16843009*St(N,F,U)),ve(d,g+64,16843009*St(F,U,Y)),ve(d,g+96,16843009*St(U,Y,Y))}function Is(d,g){var N,F=4;for(N=0;4>N;++N)F+=d[g+N-32]+d[g-1+32*N];for(F>>=3,N=0;4>N;++N)i(d,g+32*N,F,4)}function Ud(d,g){var N=d[g-1+0],F=d[g-1+32],U=d[g-1+64],Y=d[g-1-32],X=d[g+0-32],Q=d[g+1-32],ee=d[g+2-32],ie=d[g+3-32];d[g+0+96]=St(F,U,d[g-1+96]),d[g+1+96]=d[g+0+64]=St(N,F,U),d[g+2+96]=d[g+1+64]=d[g+0+32]=St(Y,N,F),d[g+3+96]=d[g+2+64]=d[g+1+32]=d[g+0+0]=St(X,Y,N),d[g+3+64]=d[g+2+32]=d[g+1+0]=St(Q,X,Y),d[g+3+32]=d[g+2+0]=St(ee,Q,X),d[g+3+0]=St(ie,ee,Q)}function zd(d,g){var N=d[g+1-32],F=d[g+2-32],U=d[g+3-32],Y=d[g+4-32],X=d[g+5-32],Q=d[g+6-32],ee=d[g+7-32];d[g+0+0]=St(d[g+0-32],N,F),d[g+1+0]=d[g+0+32]=St(N,F,U),d[g+2+0]=d[g+1+32]=d[g+0+64]=St(F,U,Y),d[g+3+0]=d[g+2+32]=d[g+1+64]=d[g+0+96]=St(U,Y,X),d[g+3+32]=d[g+2+64]=d[g+1+96]=St(Y,X,Q),d[g+3+64]=d[g+2+96]=St(X,Q,ee),d[g+3+96]=St(Q,ee,ee)}function Wl(d,g){var N=d[g-1+0],F=d[g-1+32],U=d[g-1+64],Y=d[g-1-32],X=d[g+0-32],Q=d[g+1-32],ee=d[g+2-32],ie=d[g+3-32];d[g+0+0]=d[g+1+64]=Y+X+1>>1,d[g+1+0]=d[g+2+64]=X+Q+1>>1,d[g+2+0]=d[g+3+64]=Q+ee+1>>1,d[g+3+0]=ee+ie+1>>1,d[g+0+96]=St(U,F,N),d[g+0+64]=St(F,N,Y),d[g+0+32]=d[g+1+96]=St(N,Y,X),d[g+1+32]=d[g+2+96]=St(Y,X,Q),d[g+2+32]=d[g+3+96]=St(X,Q,ee),d[g+3+32]=St(Q,ee,ie)}function bu(d,g){var N=d[g+0-32],F=d[g+1-32],U=d[g+2-32],Y=d[g+3-32],X=d[g+4-32],Q=d[g+5-32],ee=d[g+6-32],ie=d[g+7-32];d[g+0+0]=N+F+1>>1,d[g+1+0]=d[g+0+64]=F+U+1>>1,d[g+2+0]=d[g+1+64]=U+Y+1>>1,d[g+3+0]=d[g+2+64]=Y+X+1>>1,d[g+0+32]=St(N,F,U),d[g+1+32]=d[g+0+96]=St(F,U,Y),d[g+2+32]=d[g+1+96]=St(U,Y,X),d[g+3+32]=d[g+2+96]=St(Y,X,Q),d[g+3+64]=St(X,Q,ee),d[g+3+96]=St(Q,ee,ie)}function Zp(d,g){var N=d[g-1+0],F=d[g-1+32],U=d[g-1+64],Y=d[g-1+96];d[g+0+0]=N+F+1>>1,d[g+2+0]=d[g+0+32]=F+U+1>>1,d[g+2+32]=d[g+0+64]=U+Y+1>>1,d[g+1+0]=St(N,F,U),d[g+3+0]=d[g+1+32]=St(F,U,Y),d[g+3+32]=d[g+1+64]=St(U,Y,Y),d[g+3+64]=d[g+2+64]=d[g+0+96]=d[g+1+96]=d[g+2+96]=d[g+3+96]=Y}function em(d,g){var N=d[g-1+0],F=d[g-1+32],U=d[g-1+64],Y=d[g-1+96],X=d[g-1-32],Q=d[g+0-32],ee=d[g+1-32],ie=d[g+2-32];d[g+0+0]=d[g+2+32]=N+X+1>>1,d[g+0+32]=d[g+2+64]=F+N+1>>1,d[g+0+64]=d[g+2+96]=U+F+1>>1,d[g+0+96]=Y+U+1>>1,d[g+3+0]=St(Q,ee,ie),d[g+2+0]=St(X,Q,ee),d[g+1+0]=d[g+3+32]=St(N,X,Q),d[g+1+32]=d[g+3+64]=St(F,N,X),d[g+1+64]=d[g+3+96]=St(U,F,N),d[g+1+96]=St(Y,U,F)}function tm(d,g){var N;for(N=0;8>N;++N)n(d,g+32*N,d,g-32,8)}function _u(d,g){var N;for(N=0;8>N;++N)i(d,g,d[g-1],8),g+=32}function zo(d,g,N){var F;for(F=0;8>F;++F)i(g,N+32*F,d,8)}function La(d,g){var N,F=8;for(N=0;8>N;++N)F+=d[g+N-32]+d[g-1+32*N];zo(F>>4,d,g)}function rm(d,g){var N,F=4;for(N=0;8>N;++N)F+=d[g+N-32];zo(F>>3,d,g)}function Wo(d,g){var N,F=4;for(N=0;8>N;++N)F+=d[g-1+32*N];zo(F>>3,d,g)}function Su(d,g){zo(128,d,g)}function Hl(d,g,N){var F=d[g-N],U=d[g+0],Y=3*(U-F)+lm[1020+d[g-2*N]-d[g+N]],X=eh[112+(Y+4>>3)];d[g-N]=Si[255+F+eh[112+(Y+3>>3)]],d[g+0]=Si[255+U-X]}function Wd(d,g,N,F){var U=d[g+0],Y=d[g+N];return Gi[255+d[g-2*N]-d[g-N]]>F||Gi[255+Y-U]>F}function Hd(d,g,N,F){return 4*Gi[255+d[g-N]-d[g+0]]+Gi[255+d[g-2*N]-d[g+N]]<=F}function $d(d,g,N,F,U){var Y=d[g-3*N],X=d[g-2*N],Q=d[g-N],ee=d[g+0],ie=d[g+N],ge=d[g+2*N],Ne=d[g+3*N];return 4*Gi[255+Q-ee]+Gi[255+X-ie]>F?0:Gi[255+d[g-4*N]-Y]<=U&&Gi[255+Y-X]<=U&&Gi[255+X-Q]<=U&&Gi[255+Ne-ge]<=U&&Gi[255+ge-ie]<=U&&Gi[255+ie-ee]<=U}function qd(d,g,N,F){var U=2*F+1;for(F=0;16>F;++F)Hd(d,g+F,N,U)&&Hl(d,g+F,N)}function Rs(d,g,N,F){var U=2*F+1;for(F=0;16>F;++F)Hd(d,g+F*N,1,U)&&Hl(d,g+F*N,1)}function sa(d,g,N,F){var U;for(U=3;0<U;--U)qd(d,g+=4*N,N,F)}function nm(d,g,N,F){var U;for(U=3;0<U;--U)Rs(d,g+=4,N,F)}function Fa(d,g,N,F,U,Y,X,Q){for(Y=2*Y+1;0<U--;){if($d(d,g,N,Y,X))if(Wd(d,g,N,Q))Hl(d,g,N);else{var ee=d,ie=g,ge=N,Ne=ee[ie-2*ge],ke=ee[ie-ge],we=ee[ie+0],Re=ee[ie+ge],Pe=ee[ie+2*ge],xe=27*(De=lm[1020+3*(we-ke)+lm[1020+Ne-Re]])+63>>7,ye=18*De+63>>7,De=9*De+63>>7;ee[ie-3*ge]=Si[255+ee[ie-3*ge]+De],ee[ie-2*ge]=Si[255+Ne+ye],ee[ie-ge]=Si[255+ke+xe],ee[ie+0]=Si[255+we-xe],ee[ie+ge]=Si[255+Re-ye],ee[ie+2*ge]=Si[255+Pe-De]}g+=F}}function us(d,g,N,F,U,Y,X,Q){for(Y=2*Y+1;0<U--;){if($d(d,g,N,Y,X))if(Wd(d,g,N,Q))Hl(d,g,N);else{var ee=d,ie=g,ge=N,Ne=ee[ie-ge],ke=ee[ie+0],we=ee[ie+ge],Re=eh[112+((Pe=3*(ke-Ne))+4>>3)],Pe=eh[112+(Pe+3>>3)],xe=Re+1>>1;ee[ie-2*ge]=Si[255+ee[ie-2*ge]+xe],ee[ie-ge]=Si[255+Ne+Pe],ee[ie+0]=Si[255+ke-Re],ee[ie+ge]=Si[255+we-xe]}g+=F}}function Nu(d,g,N,F,U,Y){Fa(d,g,N,1,16,F,U,Y)}function Ho(d,g,N,F,U,Y){Fa(d,g,1,N,16,F,U,Y)}function im(d,g,N,F,U,Y){var X;for(X=3;0<X;--X)us(d,g+=4*N,N,1,16,F,U,Y)}function $l(d,g,N,F,U,Y){var X;for(X=3;0<X;--X)us(d,g+=4,1,N,16,F,U,Y)}function sm(d,g,N,F,U,Y,X,Q){Fa(d,g,U,1,8,Y,X,Q),Fa(N,F,U,1,8,Y,X,Q)}function ku(d,g,N,F,U,Y,X,Q){Fa(d,g,1,U,8,Y,X,Q),Fa(N,F,1,U,8,Y,X,Q)}function Eu(d,g,N,F,U,Y,X,Q){us(d,g+4*U,U,1,8,Y,X,Q),us(N,F+4*U,U,1,8,Y,X,Q)}function Vd(d,g,N,F,U,Y,X,Q){us(d,g+4,1,U,8,Y,X,Q),us(N,F+4,1,U,8,Y,X,Q)}function ql(){this.ba=new yi,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new lr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Au(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Tu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Gd(){this.ua=0,this.Wa=new ue,this.vb=new ue,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new J,this.yc=new A}function am(){this.xb=this.a=0,this.l=new Ds,this.ca=new yi,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Gd,this.ab=0,this.gc=a(4,Tu),this.Oc=0}function Vl(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ds,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function $o(d,g,N,F,U,Y,X){for(d=d==null?0:d[g+0],g=0;g<X;++g)U[Y+g]=d+N[F+g]&255,d=U[Y+g]}function ju(d,g,N,F,U,Y,X){var Q;if(d==null)$o(null,null,N,F,U,Y,X);else for(Q=0;Q<X;++Q)U[Y+Q]=d[g+Q]+N[F+Q]&255}function Oa(d,g,N,F,U,Y,X){if(d==null)$o(null,null,N,F,U,Y,X);else{var Q,ee=d[g+0],ie=ee,ge=ee;for(Q=0;Q<X;++Q)ie=ge+(ee=d[g+Q])-ie,ge=N[F+Q]+(-256&ie?0>ie?0:255:ie)&255,ie=ee,U[Y+Q]=ge}}function Cu(d,g,N,F){var U=g.width,Y=g.o;if(t(d!=null&&g!=null),0>N||0>=F||N+F>Y)return null;if(!d.Cc){if(d.ga==null){var X;if(d.ga=new Vl,(X=d.ga==null)||(X=g.width*g.o,t(d.Gb.length==0),d.Gb=s(X),d.Uc=0,d.Gb==null?X=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,X=1),X=!X),!X){X=d.ga;var Q=d.Fa,ee=d.P,ie=d.qc,ge=d.mb,Ne=d.nb,ke=ee+1,we=ie-1,Re=X.l;if(t(Q!=null&&ge!=null&&g!=null),Ua[0]=null,Ua[1]=$o,Ua[2]=ju,Ua[3]=Oa,X.ca=ge,X.tb=Ne,X.c=g.width,X.i=g.height,t(0<X.c&&0<X.i),1>=ie)g=0;else if(X.$a=Q[ee+0]>>0&3,X.Z=Q[ee+0]>>2&3,X.Lc=Q[ee+0]>>4&3,ee=Q[ee+0]>>6&3,0>X.$a||1<X.$a||4<=X.Z||1<X.Lc||ee)g=0;else if(Re.put=zi,Re.ac=en,Re.bc=Wi,Re.ma=X,Re.width=g.width,Re.height=g.height,Re.Da=g.Da,Re.v=g.v,Re.va=g.va,Re.j=g.j,Re.o=g.o,X.$a)e:{t(X.$a==1),g=Ce();t:for(;;){if(g==null){g=0;break e}if(t(X!=null),X.mc=g,g.c=X.c,g.i=X.i,g.l=X.l,g.l.ma=X,g.l.width=X.c,g.l.height=X.i,g.a=0,G(g.m,Q,ke,we),!_e(X.c,X.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&re(g.s)?(X.ic=1,Q=g.c*g.i,g.Ta=null,g.Ua=0,g.V=s(Q),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(X.ic=0,g=Ae(g,X.c)),!g))break t;g=1;break e}X.mc=null,g=0}else g=we>=X.c*X.i;X=!g}if(X)return null;d.ga.Lc!=1?d.Ga=0:F=Y-N}t(d.ga!=null),t(N+F<=Y);e:{if(g=(Q=d.ga).c,Y=Q.l.o,Q.$a==0){if(ke=d.rc,we=d.Vc,Re=d.Fa,ee=d.P+1+N*g,ie=d.mb,ge=d.nb+N*g,t(ee<=d.P+d.qc),Q.Z!=0)for(t(Ua[Q.Z]!=null),X=0;X<F;++X)Ua[Q.Z](ke,we,Re,ee,ie,ge,g),ke=ie,we=ge,ge+=g,ee+=g;else for(X=0;X<F;++X)n(ie,ge,Re,ee,g),ke=ie,we=ge,ge+=g,ee+=g;d.rc=ke,d.Vc=we}else{if(t(Q.mc!=null),g=N+F,t((X=Q.mc)!=null),t(g<=X.i),X.C>=g)g=1;else if(Q.ic||be(),Q.ic){Q=X.V,ke=X.Ba,we=X.c;var Pe=X.i,xe=(Re=1,ee=X.$/we,ie=X.$%we,ge=X.m,Ne=X.s,X.$),ye=we*Pe,De=we*g,Ue=Ne.wc,Ie=xe<De?Ar(Ne,ie,ee):null;t(xe<=ye),t(g<=Pe),t(re(Ne));t:for(;;){for(;!ge.h&&xe<De;){if(ie&Ue||(Ie=Ar(Ne,ie,ee)),t(Ie!=null),H(ge),256>(Pe=Cn(Ie.G[0],Ie.H[0],ge)))Q[ke+xe]=Pe,++xe,++ie>=we&&(ie=0,++ee<=g&&!(ee%16)&&ae(X,ee));else{if(!(280>Pe)){Re=0;break t}Pe=wi(Pe-256,ge);var lt,et=Cn(Ie.G[4],Ie.H[4],ge);if(H(ge),!(xe>=(et=ri(we,et=wi(et,ge)))&&ye-xe>=Pe)){Re=0;break t}for(lt=0;lt<Pe;++lt)Q[ke+xe+lt]=Q[ke+xe+lt-et];for(xe+=Pe,ie+=Pe;ie>=we;)ie-=we,++ee<=g&&!(ee%16)&&ae(X,ee);xe<De&&ie&Ue&&(Ie=Ar(Ne,ie,ee))}t(ge.h==M(ge))}ae(X,ee>g?g:ee);break t}!Re||ge.h&&xe<ye?(Re=0,X.a=ge.h?5:3):X.$=xe,g=Re}else g=le(X,X.V,X.Ba,X.c,X.i,g,Te);if(!g){F=0;break e}}N+F>=Y&&(d.Cc=1),F=1}if(!F)return null;if(d.Cc&&((F=d.ga)!=null&&(F.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+N*U}function S(d,g,N,F,U,Y){for(;0<U--;){var X,Q=d,ee=g+(N?1:0),ie=d,ge=g+(N?0:3);for(X=0;X<F;++X){var Ne=ie[ge+4*X];Ne!=255&&(Ne*=32897,Q[ee+4*X+0]=Q[ee+4*X+0]*Ne>>23,Q[ee+4*X+1]=Q[ee+4*X+1]*Ne>>23,Q[ee+4*X+2]=Q[ee+4*X+2]*Ne>>23)}g+=Y}}function W(d,g,N,F,U){for(;0<F--;){var Y;for(Y=0;Y<N;++Y){var X=d[g+2*Y+0],Q=15&(ie=d[g+2*Y+1]),ee=4369*Q,ie=(240&ie|ie>>4)*ee>>16;d[g+2*Y+0]=(240&X|X>>4)*ee>>16&240|(15&X|X<<4)*ee>>16>>4&15,d[g+2*Y+1]=240&ie|Q}g+=U}}function ce(d,g,N,F,U,Y,X,Q){var ee,ie,ge=255;for(ie=0;ie<U;++ie){for(ee=0;ee<F;++ee){var Ne=d[g+ee];Y[X+4*ee]=Ne,ge&=Ne}g+=N,X+=Q}return ge!=255}function me(d,g,N,F,U){var Y;for(Y=0;Y<U;++Y)N[F+Y]=d[g+Y]>>8}function be(){Vi=S,dr=W,hr=ce,Rr=me}function Le(d,g,N){C[d]=function(F,U,Y,X,Q,ee,ie,ge,Ne,ke,we,Re,Pe,xe,ye,De,Ue){var Ie,lt=Ue-1>>1,et=Q[ee+0]|ie[ge+0]<<16,gt=Ne[ke+0]|we[Re+0]<<16;t(F!=null);var rt=3*et+gt+131074>>2;for(g(F[U+0],255&rt,rt>>16,Pe,xe),Y!=null&&(rt=3*gt+et+131074>>2,g(Y[X+0],255&rt,rt>>16,ye,De)),Ie=1;Ie<=lt;++Ie){var qt=Q[ee+Ie]|ie[ge+Ie]<<16,Xt=Ne[ke+Ie]|we[Re+Ie]<<16,Ut=et+qt+gt+Xt+524296,Dt=Ut+2*(qt+gt)>>3;rt=Dt+et>>1,et=(Ut=Ut+2*(et+Xt)>>3)+qt>>1,g(F[U+2*Ie-1],255&rt,rt>>16,Pe,xe+(2*Ie-1)*N),g(F[U+2*Ie-0],255&et,et>>16,Pe,xe+(2*Ie-0)*N),Y!=null&&(rt=Ut+gt>>1,et=Dt+Xt>>1,g(Y[X+2*Ie-1],255&rt,rt>>16,ye,De+(2*Ie-1)*N),g(Y[X+2*Ie+0],255&et,et>>16,ye,De+(2*Ie+0)*N)),et=qt,gt=Xt}1&Ue||(rt=3*et+gt+131074>>2,g(F[U+Ue-1],255&rt,rt>>16,Pe,xe+(Ue-1)*N),Y!=null&&(rt=3*gt+et+131074>>2,g(Y[X+Ue-1],255&rt,rt>>16,ye,De+(Ue-1)*N)))}}function We(){Yi[th]=OS,Yi[rh]=Px,Yi[Ex]=DS,Yi[nh]=Lx,Yi[ih]=Fx,Yi[cm]=Ox,Yi[Ax]=IS,Yi[um]=Px,Yi[fm]=Lx,Yi[sh]=Fx,Yi[dm]=Ox}function ot(d){return d&-16384?0>d?0:255:d>>RS}function ht(d,g){return ot((19077*d>>8)+(26149*g>>8)-14234)}function Et(d,g,N){return ot((19077*d>>8)-(6419*g>>8)-(13320*N>>8)+8708)}function Nt(d,g){return ot((19077*d>>8)+(33050*g>>8)-17685)}function Mt(d,g,N,F,U){F[U+0]=ht(d,N),F[U+1]=Et(d,g,N),F[U+2]=Nt(d,g)}function _r(d,g,N,F,U){F[U+0]=Nt(d,g),F[U+1]=Et(d,g,N),F[U+2]=ht(d,N)}function Tr(d,g,N,F,U){var Y=Et(d,g,N);g=Y<<3&224|Nt(d,g)>>3,F[U+0]=248&ht(d,N)|Y>>5,F[U+1]=g}function $r(d,g,N,F,U){var Y=240&Nt(d,g)|15;F[U+0]=240&ht(d,N)|Et(d,g,N)>>4,F[U+1]=Y}function Ln(d,g,N,F,U){F[U+0]=255,Mt(d,g,N,F,U+1)}function ln(d,g,N,F,U){_r(d,g,N,F,U),F[U+3]=255}function fs(d,g,N,F,U){Mt(d,g,N,F,U),F[U+3]=255}function _i(d,g){return 0>d?0:d>g?g:d}function Ms(d,g,N){C[d]=function(F,U,Y,X,Q,ee,ie,ge,Ne){for(var ke=ge+(-2&Ne)*N;ge!=ke;)g(F[U+0],Y[X+0],Q[ee+0],ie,ge),g(F[U+1],Y[X+0],Q[ee+0],ie,ge+N),U+=2,++X,++ee,ge+=2*N;1&Ne&&g(F[U+0],Y[X+0],Q[ee+0],ie,ge)}}function Yd(d,g,N){return N==0?d==0?g==0?6:5:g==0?4:0:N}function Pu(d,g,N,F,U){switch(d>>>30){case 3:la(g,N,F,U,0);break;case 2:Ir(g,N,F,U);break;case 1:qn(g,N,F,U)}}function Lu(d,g){var N,F,U=g.M,Y=g.Nb,X=d.oc,Q=d.pc+40,ee=d.oc,ie=d.pc+584,ge=d.oc,Ne=d.pc+600;for(N=0;16>N;++N)X[Q+32*N-1]=129;for(N=0;8>N;++N)ee[ie+32*N-1]=129,ge[Ne+32*N-1]=129;for(0<U?X[Q-1-32]=ee[ie-1-32]=ge[Ne-1-32]=129:(i(X,Q-32-1,127,21),i(ee,ie-32-1,127,9),i(ge,Ne-32-1,127,9)),F=0;F<d.za;++F){var ke=g.ya[g.aa+F];if(0<F){for(N=-1;16>N;++N)n(X,Q+32*N-4,X,Q+32*N+12,4);for(N=-1;8>N;++N)n(ee,ie+32*N-4,ee,ie+32*N+4,4),n(ge,Ne+32*N-4,ge,Ne+32*N+4,4)}var we=d.Gd,Re=d.Hd+F,Pe=ke.ad,xe=ke.Hc;if(0<U&&(n(X,Q-32,we[Re].y,0,16),n(ee,ie-32,we[Re].f,0,8),n(ge,Ne-32,we[Re].ea,0,8)),ke.Za){var ye=X,De=Q-32+16;for(0<U&&(F>=d.za-1?i(ye,De,we[Re].y[15],4):n(ye,De,we[Re+1].y,0,4)),N=0;4>N;N++)ye[De+128+N]=ye[De+256+N]=ye[De+384+N]=ye[De+0+N];for(N=0;16>N;++N,xe<<=2)ye=X,De=Q+Ix[N],ds[ke.Ob[N]](ye,De),Pu(xe,Pe,16*+N,ye,De)}else if(ye=Yd(F,U,ke.Ob[0]),Ba[ye](X,Q),xe!=0)for(N=0;16>N;++N,xe<<=2)Pu(xe,Pe,16*+N,X,Q+Ix[N]);for(N=ke.Gc,ye=Yd(F,U,ke.Dd),ua[ye](ee,ie),ua[ye](ge,Ne),xe=Pe,ye=ee,De=ie,255&(ke=N>>0)&&(170&ke?Ru(xe,256,ye,De):$i(xe,256,ye,De)),ke=ge,xe=Ne,255&(N>>=8)&&(170&N?Ru(Pe,320,ke,xe):$i(Pe,320,ke,xe)),U<d.Ub-1&&(n(we[Re].y,0,X,Q+480,16),n(we[Re].f,0,ee,ie+224,8),n(we[Re].ea,0,ge,Ne+224,8)),N=8*Y*d.B,we=d.sa,Re=d.ta+16*F+16*Y*d.R,Pe=d.qa,ke=d.ra+8*F+N,xe=d.Ha,ye=d.Ia+8*F+N,N=0;16>N;++N)n(we,Re+N*d.R,X,Q+32*N,16);for(N=0;8>N;++N)n(Pe,ke+N*d.B,ee,ie+32*N,8),n(xe,ye+N*d.B,ge,Ne+32*N,8)}}function Gl(d,g,N,F,U,Y,X,Q,ee){var ie=[0],ge=[0],Ne=0,ke=ee!=null?ee.kd:0,we=ee??new Au;if(d==null||12>N)return 7;we.data=d,we.w=g,we.ha=N,g=[g],N=[N],we.gb=[we.gb];e:{var Re=g,Pe=N,xe=we.gb;if(t(d!=null),t(Pe!=null),t(xe!=null),xe[0]=0,12<=Pe[0]&&!r(d,Re[0],"RIFF")){if(r(d,Re[0]+8,"WEBP")){xe=3;break e}var ye=qe(d,Re[0]+4);if(12>ye||4294967286<ye){xe=3;break e}if(ke&&ye>Pe[0]-8){xe=7;break e}xe[0]=ye,Re[0]+=12,Pe[0]-=12}xe=0}if(xe!=0)return xe;for(ye=0<we.gb[0],N=N[0];;){e:{var De=d;Pe=g,xe=N;var Ue=ie,Ie=ge,lt=Re=[0];if((rt=Ne=[Ne])[0]=0,8>xe[0])xe=7;else{if(!r(De,Pe[0],"VP8X")){if(qe(De,Pe[0]+4)!=10){xe=3;break e}if(18>xe[0]){xe=7;break e}var et=qe(De,Pe[0]+8),gt=1+Oe(De,Pe[0]+12);if(2147483648<=gt*(De=1+Oe(De,Pe[0]+15))){xe=3;break e}lt!=null&&(lt[0]=et),Ue!=null&&(Ue[0]=gt),Ie!=null&&(Ie[0]=De),Pe[0]+=18,xe[0]-=18,rt[0]=1}xe=0}}if(Ne=Ne[0],Re=Re[0],xe!=0)return xe;if(Pe=!!(2&Re),!ye&&Ne)return 3;if(Y!=null&&(Y[0]=!!(16&Re)),X!=null&&(X[0]=Pe),Q!=null&&(Q[0]=0),X=ie[0],Re=ge[0],Ne&&Pe&&ee==null){xe=0;break}if(4>N){xe=7;break}if(ye&&Ne||!ye&&!Ne&&!r(d,g[0],"ALPH")){N=[N],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{et=d,xe=g,ye=N;var rt=we.gb;Ue=we.na,Ie=we.P,lt=we.Sa,gt=22,t(et!=null),t(ye!=null),De=xe[0];var qt=ye[0];for(t(Ue!=null),t(lt!=null),Ue[0]=null,Ie[0]=null,lt[0]=0;;){if(xe[0]=De,ye[0]=qt,8>qt){xe=7;break e}var Xt=qe(et,De+4);if(4294967286<Xt){xe=3;break e}var Ut=8+Xt+1&-2;if(gt+=Ut,0<rt&&gt>rt){xe=3;break e}if(!r(et,De,"VP8 ")||!r(et,De,"VP8L")){xe=0;break e}if(qt[0]<Ut){xe=7;break e}r(et,De,"ALPH")||(Ue[0]=et,Ie[0]=De+8,lt[0]=Xt),De+=Ut,qt-=Ut}}if(N=N[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],xe!=0)break}N=[N],we.Ja=[we.Ja],we.xa=[we.xa];e:if(rt=d,xe=g,ye=N,Ue=we.gb[0],Ie=we.Ja,lt=we.xa,et=xe[0],De=!r(rt,et,"VP8 "),gt=!r(rt,et,"VP8L"),t(rt!=null),t(ye!=null),t(Ie!=null),t(lt!=null),8>ye[0])xe=7;else{if(De||gt){if(rt=qe(rt,et+4),12<=Ue&&rt>Ue-12){xe=3;break e}if(ke&&rt>ye[0]-8){xe=7;break e}Ie[0]=rt,xe[0]+=8,ye[0]-=8,lt[0]=gt}else lt[0]=5<=ye[0]&&rt[et+0]==47&&!(rt[et+4]>>5),Ie[0]=ye[0];xe=0}if(N=N[0],we.Ja=we.Ja[0],we.xa=we.xa[0],g=g[0],xe!=0)break;if(4294967286<we.Ja)return 3;if(Q==null||Pe||(Q[0]=we.xa?2:1),X=[X],Re=[Re],we.xa){if(5>N){xe=7;break}Q=X,ke=Re,Pe=Y,d==null||5>N?d=0:5<=N&&d[g+0]==47&&!(d[g+4]>>5)?(ye=[0],rt=[0],Ue=[0],G(Ie=new k,d,g,N),mt(Ie,ye,rt,Ue)?(Q!=null&&(Q[0]=ye[0]),ke!=null&&(ke[0]=rt[0]),Pe!=null&&(Pe[0]=Ue[0]),d=1):d=0):d=0}else{if(10>N){xe=7;break}Q=Re,d==null||10>N||!Ld(d,g+3,N-3)?d=0:(ke=d[g+0]|d[g+1]<<8|d[g+2]<<16,Pe=16383&(d[g+7]<<8|d[g+6]),d=16383&(d[g+9]<<8|d[g+8]),1&ke||3<(ke>>1&7)||!(ke>>4&1)||ke>>5>=we.Ja||!Pe||!d?d=0:(X&&(X[0]=Pe),Q&&(Q[0]=d),d=1))}if(!d||(X=X[0],Re=Re[0],Ne&&(ie[0]!=X||ge[0]!=Re)))return 3;ee!=null&&(ee[0]=we,ee.offset=g-ee.w,t(4294967286>g-ee.w),t(ee.offset==ee.ha-N));break}return xe==0||xe==7&&Ne&&ee==null?(Y!=null&&(Y[0]|=we.na!=null&&0<we.na.length),F!=null&&(F[0]=X),U!=null&&(U[0]=Re),0):xe}function Fu(d,g,N){var F=g.width,U=g.height,Y=0,X=0,Q=F,ee=U;if(g.Da=d!=null&&0<d.Da,g.Da&&(Q=d.cd,ee=d.bd,Y=d.v,X=d.j,11>N||(Y&=-2,X&=-2),0>Y||0>X||0>=Q||0>=ee||Y+Q>F||X+ee>U))return 0;if(g.v=Y,g.j=X,g.va=Y+Q,g.o=X+ee,g.U=Q,g.T=ee,g.da=d!=null&&0<d.da,g.da){if(!Me(Q,ee,N=[d.ib],Y=[d.hb]))return 0;g.ib=N[0],g.hb=Y[0]}return g.ob=d!=null&&d.ob,g.Kb=d==null||!d.Sd,g.da&&(g.ob=g.ib<3*F/4&&g.hb<3*U/4,g.Kb=0),1}function Ou(d){if(d==null)return 2;if(11>d.S){var g=d.f.RGBA;g.fb+=(d.height-1)*g.A,g.A=-g.A}else g=d.f.kb,d=d.height,g.O+=(d-1)*g.fa,g.fa=-g.fa,g.N+=(d-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(d-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(d-1)*g.lb,g.lb=-g.lb);return 0}function Yl(d,g,N,F){if(F==null||0>=d||0>=g)return 2;if(N!=null){if(N.Da){var U=N.cd,Y=N.bd,X=-2&N.v,Q=-2&N.j;if(0>X||0>Q||0>=U||0>=Y||X+U>d||Q+Y>g)return 2;d=U,g=Y}if(N.da){if(!Me(d,g,U=[N.ib],Y=[N.hb]))return 2;d=U[0],g=Y[0]}}F.width=d,F.height=g;e:{var ee=F.width,ie=F.height;if(d=F.S,0>=ee||0>=ie||!(d>=th&&13>d))d=2;else{if(0>=F.Rd&&F.sd==null){X=Y=U=g=0;var ge=(Q=ee*Rx[d])*ie;if(11>d||(Y=(ie+1)/2*(g=(ee+1)/2),d==12&&(X=(U=ee)*ie)),(ie=s(ge+2*Y+X))==null){d=1;break e}F.sd=ie,11>d?((ee=F.f.RGBA).eb=ie,ee.fb=0,ee.A=Q,ee.size=ge):((ee=F.f.kb).y=ie,ee.O=0,ee.fa=Q,ee.Fd=ge,ee.f=ie,ee.N=0+ge,ee.Ab=g,ee.Cd=Y,ee.ea=ie,ee.W=0+ge+Y,ee.Db=g,ee.Ed=Y,d==12&&(ee.F=ie,ee.J=0+ge+2*Y),ee.Tc=X,ee.lb=U)}if(g=1,U=F.S,Y=F.width,X=F.height,U>=th&&13>U)if(11>U)d=F.f.RGBA,g&=(Q=Math.abs(d.A))*(X-1)+Y<=d.size,g&=Q>=Y*Rx[U],g&=d.eb!=null;else{d=F.f.kb,Q=(Y+1)/2,ge=(X+1)/2,ee=Math.abs(d.fa),ie=Math.abs(d.Ab);var Ne=Math.abs(d.Db),ke=Math.abs(d.lb),we=ke*(X-1)+Y;g&=ee*(X-1)+Y<=d.Fd,g&=ie*(ge-1)+Q<=d.Cd,g=(g&=Ne*(ge-1)+Q<=d.Ed)&ee>=Y&ie>=Q&Ne>=Q,g&=d.y!=null,g&=d.f!=null,g&=d.ea!=null,U==12&&(g&=ke>=Y,g&=we<=d.Tc,g&=d.F!=null)}else g=0;d=g?0:2}}return d!=0||N!=null&&N.fd&&(d=Ou(F)),d}var vn=64,Kl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Xl=24,Jl=32,Du=8,ii=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ye("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(d){return d},C.Predictor2=function(d,g,N){return g[N+0]},C.Predictor3=function(d,g,N){return g[N+1]},C.Predictor4=function(d,g,N){return g[N-1]},C.Predictor5=function(d,g,N){return tt(tt(d,g[N+1]),g[N+0])},C.Predictor6=function(d,g,N){return tt(d,g[N-1])},C.Predictor7=function(d,g,N){return tt(d,g[N+0])},C.Predictor8=function(d,g,N){return tt(g[N-1],g[N+0])},C.Predictor9=function(d,g,N){return tt(g[N+0],g[N+1])},C.Predictor10=function(d,g,N){return tt(tt(d,g[N-1]),tt(g[N+0],g[N+1]))},C.Predictor11=function(d,g,N){var F=g[N+0];return 0>=bt(F>>24&255,d>>24&255,(g=g[N-1])>>24&255)+bt(F>>16&255,d>>16&255,g>>16&255)+bt(F>>8&255,d>>8&255,g>>8&255)+bt(255&F,255&d,255&g)?F:d},C.Predictor12=function(d,g,N){var F=g[N+0];return(ft((d>>24&255)+(F>>24&255)-((g=g[N-1])>>24&255))<<24|ft((d>>16&255)+(F>>16&255)-(g>>16&255))<<16|ft((d>>8&255)+(F>>8&255)-(g>>8&255))<<8|ft((255&d)+(255&F)-(255&g)))>>>0},C.Predictor13=function(d,g,N){var F=g[N-1];return(dt((d=tt(d,g[N+0]))>>24&255,F>>24&255)<<24|dt(d>>16&255,F>>16&255)<<16|dt(d>>8&255,F>>8&255)<<8|dt(d>>0&255,F>>0&255))>>>0};var om=C.PredictorAdd0;C.PredictorAdd1=At,Ye("Predictor2","PredictorAdd2"),Ye("Predictor3","PredictorAdd3"),Ye("Predictor4","PredictorAdd4"),Ye("Predictor5","PredictorAdd5"),Ye("Predictor6","PredictorAdd6"),Ye("Predictor7","PredictorAdd7"),Ye("Predictor8","PredictorAdd8"),Ye("Predictor9","PredictorAdd9"),Ye("Predictor10","PredictorAdd10"),Ye("Predictor11","PredictorAdd11"),Ye("Predictor12","PredictorAdd12"),Ye("Predictor13","PredictorAdd13");var Iu=C.PredictorAdd2;Ct("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),Ct("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var Kd,Hi=C.ColorIndexInverseTransform,Ql=C.MapARGB,Xd=C.VP8LColorIndexInverseTransformAlpha,Jd=C.MapAlpha,Da=C.VP8LPredictorsAdd=[];Da.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var qo,si,$n,Ia,aa,oa,Zl,la,Ir,Ru,qn,$i,ec,Qd,Mu,Vo,Go,Ra,Yo,tc,Ko,Ma,Bu,qi,Vi,dr,hr,Rr,tn=s(511),ca=s(2041),Uu=s(225),rc=s(767),Zd=0,lm=ca,eh=Uu,Si=rc,Gi=tn,th=0,rh=1,Ex=2,nh=3,ih=4,cm=5,Ax=6,um=7,fm=8,sh=9,dm=10,wS=[2,3,7],bS=[3,3,11],Tx=[280,256,256,256,40],_S=[0,1,1,1,0],SS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],NS=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],kS=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ES=8,hm=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],pm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],zu=null,AS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],TS=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],jx=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],jS=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],CS=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],PS=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],LS=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ba=[],ds=[],ua=[],FS=1,Cx=2,Ua=[],Yi=[];Le("UpsampleRgbLinePair",Mt,3),Le("UpsampleBgrLinePair",_r,3),Le("UpsampleRgbaLinePair",fs,4),Le("UpsampleBgraLinePair",ln,4),Le("UpsampleArgbLinePair",Ln,4),Le("UpsampleRgba4444LinePair",$r,2),Le("UpsampleRgb565LinePair",Tr,2);var OS=C.UpsampleRgbLinePair,DS=C.UpsampleBgrLinePair,Px=C.UpsampleRgbaLinePair,Lx=C.UpsampleBgraLinePair,Fx=C.UpsampleArgbLinePair,Ox=C.UpsampleRgba4444LinePair,IS=C.UpsampleRgb565LinePair,ah=16,oh=1<<ah-1,Wu=-227,mm=482,RS=6,Dx=0,MS=s(256),BS=s(256),US=s(256),zS=s(256),WS=s(mm-Wu),HS=s(mm-Wu);Ms("YuvToRgbRow",Mt,3),Ms("YuvToBgrRow",_r,3),Ms("YuvToRgbaRow",fs,4),Ms("YuvToBgraRow",ln,4),Ms("YuvToArgbRow",Ln,4),Ms("YuvToRgba4444Row",$r,2),Ms("YuvToRgb565Row",Tr,2);var Ix=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],lh=[0,2,8],$S=[8,7,6,4,4,2,2,2,1,1,1,1],qS=1;this.WebPDecodeRGBA=function(d,g,N,F,U){var Y=rh,X=new ql,Q=new yi;X.ba=Q,Q.S=Y,Q.width=[Q.width],Q.height=[Q.height];var ee=Q.width,ie=Q.height,ge=new as;if(ge==null||d==null)var Ne=2;else t(ge!=null),Ne=Gl(d,g,N,ge.width,ge.height,ge.Pd,ge.Qd,ge.format,null);if(Ne!=0?ee=0:(ee!=null&&(ee[0]=ge.width[0]),ie!=null&&(ie[0]=ge.height[0]),ee=1),ee){Q.width=Q.width[0],Q.height=Q.height[0],F!=null&&(F[0]=Q.width),U!=null&&(U[0]=Q.height);e:{if(F=new Ds,(U=new Au).data=d,U.w=g,U.ha=N,U.kd=1,g=[0],t(U!=null),((d=Gl(U.data,U.w,U.ha,null,null,null,g,null,U))==0||d==7)&&g[0]&&(d=4),(g=d)==0){if(t(X!=null),F.data=U.data,F.w=U.w+U.offset,F.ha=U.ha-U.offset,F.put=zi,F.ac=en,F.bc=Wi,F.ma=X,U.xa){if((d=Ce())==null){X=1;break e}if(function(ke,we){var Re=[0],Pe=[0],xe=[0];t:for(;;){if(ke==null)return 0;if(we==null)return ke.a=2,0;if(ke.l=we,ke.a=0,G(ke.m,we.data,we.w,we.ha),!mt(ke.m,Re,Pe,xe)){ke.a=3;break t}if(ke.xb=Cx,we.width=Re[0],we.height=Pe[0],!_e(Re[0],Pe[0],1,ke,null))break t;return 1}return t(ke.a!=0),0}(d,F)){if(F=(g=Yl(F.width,F.height,X.Oa,X.ba))==0){t:{F=d;r:for(;;){if(F==null){F=0;break t}if(t(F.s.yc!=null),t(F.s.Ya!=null),t(0<F.s.Wb),t((N=F.l)!=null),t((U=N.ma)!=null),F.xb!=0){if(F.ca=U.ba,F.tb=U.tb,t(F.ca!=null),!Fu(U.Oa,N,nh)){F.a=2;break r}if(!Ae(F,N.width)||N.da)break r;if((N.da||Bt(F.ca.S))&&be(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&be()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!Qe(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!le(F,F.V,F.Ba,F.c,F.i,N.o,oe))break r;U.Dc=F.Ma,F=1;break t}t(F.a!=0),F=0}F=!F}F&&(g=d.a)}else g=d.a}else{if((d=new bi)==null){X=1;break e}if(d.Fa=U.na,d.P=U.P,d.qc=U.Sa,Fd(d,F)){if((g=Yl(F.width,F.height,X.Oa,X.ba))==0){if(d.Aa=0,N=X.Oa,t((U=d)!=null),N!=null){if(0<(ee=0>(ee=N.Md)?0:100<ee?255:255*ee/100)){for(ie=ge=0;4>ie;++ie)12>(Ne=U.pb[ie]).lc&&(Ne.ia=ee*$S[0>Ne.lc?0:Ne.lc]>>3),ge|=Ne.ia;ge&&(alert("todo:VP8InitRandom"),U.ia=1)}U.Ga=N.Id,100<U.Ga?U.Ga=100:0>U.Ga&&(U.Ga=0)}Hp(d,F)||(g=d.a)}}else g=d.a}g==0&&X.Oa!=null&&X.Oa.fd&&(g=Ou(X.ba))}X=g}Y=X!=0?null:11>Y?Q.f.RGBA.eb:Q.f.kb.y}else Y=null;return Y};var Rx=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,P){for(var R="",j=0;j<4;j++)R+=String.fromCharCode(C[P++]);return R}function f(C,P){return(C[P+0]<<0|C[P+1]<<8|C[P+2]<<16)>>>0}function p(C,P){return(C[P+0]<<0|C[P+1]<<8|C[P+2]<<16|C[P+3]<<24)>>>0}new l;var m=[0],h=[0],v=[],x=new l,b=e,y=function(C,P){var R={},j=0,A=!1,q=0,J=0;if(R.frames=[],!function(I,M,L,H){for(var se=0;se<H;se++)if(I[M+se]!=L.charCodeAt(se))return!0;return!1}(C,P,"RIFF",4)){var te,z;for(p(C,P+=4),P+=8;P<C.length;){var B=u(C,P),G=p(C,P+=4);P+=4;var V=G+(1&G);switch(B){case"VP8 ":case"VP8L":R.frames[j]===void 0&&(R.frames[j]={}),(k=R.frames[j]).src_off=A?J:P-8,k.src_size=q+G+8,j++,A&&(A=!1,q=0,J=0);break;case"VP8X":(k=R.header={}).feature_flags=C[P];var Z=P+4;k.canvas_width=1+f(C,Z),Z+=3,k.canvas_height=1+f(C,Z),Z+=3;break;case"ALPH":A=!0,q=V+8,J=P-8;break;case"ANIM":(k=R.header).bgcolor=p(C,P),Z=P+4,k.loop_count=(te=C)[(z=Z)+0]<<0|te[z+1]<<8,Z+=2;break;case"ANMF":var he,k;(k=R.frames[j]={}).offset_x=2*f(C,P),P+=3,k.offset_y=2*f(C,P),P+=3,k.width=1+f(C,P),P+=3,k.height=1+f(C,P),P+=3,k.duration=f(C,P),P+=3,he=C[P++],k.dispose=1&he,k.blend=he>>1&1}B!="ANMF"&&(P+=V)}return R}}(b,0);y.response=b,y.rgbaoutput=!0,y.dataurl=!1;var w=y.header?y.header:null,_=y.frames?y.frames:null;if(w){w.loop_counter=w.loop_count,m=[w.canvas_height],h=[w.canvas_width];for(var E=0;E<_.length&&_[E].blend!=0;E++);}var O=_[0],D=x.WebPDecodeRGBA(b,O.src_off,O.src_size,h,m);O.rgba=D,O.imgwidth=h[0],O.imgheight=m[0];for(var T=0;T<h[0]*m[0]*4;T++)v[T]=D[T];return this.width=h,this.height=m,this.data=v,this}(function(e){var t=function(){return typeof Bg=="function"},r=function(m,h,v,x){var b=4,y=a;switch(x){case e.image_compression.FAST:b=1,y=s;break;case e.image_compression.MEDIUM:b=6,y=o;break;case e.image_compression.SLOW:b=9,y=l}m=n(m,h,v,y);var w=Bg(m,{level:b});return e.__addimage__.arrayBufferToBinaryString(w)},n=function(m,h,v,x){for(var b,y,w,_=m.length/h,E=new Uint8Array(m.length+_),O=f(),D=0;D<_;D+=1){if(w=D*h,b=m.subarray(w,w+h),x)E.set(x(b,v,y),w+D);else{for(var T,C=O.length,P=[];T<C;T+=1)P[T]=O[T](b,v,y);var R=p(P.concat());E.set(P[R],w+D)}y=b}return E},i=function(m){var h=Array.apply([],m);return h.unshift(0),h},s=function(m,h){var v,x=[],b=m.length;x[0]=1;for(var y=0;y<b;y+=1)v=m[y-h]||0,x[y+1]=m[y]-v+256&255;return x},a=function(m,h,v){var x,b=[],y=m.length;b[0]=2;for(var w=0;w<y;w+=1)x=v&&v[w]||0,b[w+1]=m[w]-x+256&255;return b},o=function(m,h,v){var x,b,y=[],w=m.length;y[0]=3;for(var _=0;_<w;_+=1)x=m[_-h]||0,b=v&&v[_]||0,y[_+1]=m[_]+256-(x+b>>>1)&255;return y},l=function(m,h,v){var x,b,y,w,_=[],E=m.length;_[0]=4;for(var O=0;O<E;O+=1)x=m[O-h]||0,b=v&&v[O]||0,y=v&&v[O-h]||0,w=u(x,b,y),_[O+1]=m[O]-w+256&255;return _},u=function(m,h,v){if(m===h&&h===v)return m;var x=Math.abs(h-v),b=Math.abs(m-v),y=Math.abs(m+h-v-v);return x<=b&&x<=y?m:b<=y?h:v},f=function(){return[i,s,a,o,l]},p=function(m){var h=m.map(function(v){return v.reduce(function(x,b){return x+Math.abs(b)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(m,h,v,x){var b,y,w,_,E,O,D,T,C,P,R,j,A,q,J,te=this.decode.FLATE_DECODE,z="";if(this.__addimage__.isArrayBuffer(m)&&(m=new Uint8Array(m)),this.__addimage__.isArrayBufferView(m)){if(m=(w=new GC(m)).imgData,y=w.bits,b=w.colorSpace,E=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){C=(T=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,R=new Uint8Array(C*w.colors),P=new Uint8Array(C);var B,G=w.pixelBitlength-w.bits;for(q=0,J=0;q<C;q++){for(A=T[q],B=0;B<G;)R[J++]=A>>>B&255,B+=w.bits;P[q]=A>>>B&255}}if(w.bits===16){C=(T=new Uint32Array(w.decodePixels().buffer)).length,R=new Uint8Array(C*(32/w.pixelBitlength)*w.colors),P=new Uint8Array(C*(32/w.pixelBitlength)),j=w.colors>1,q=0,J=0;for(var V=0;q<C;)A=T[q++],R[J++]=A>>>0&255,j&&(R[J++]=A>>>16&255,A=T[q++],R[J++]=A>>>0&255),P[V++]=A>>>16&255;y=8}x!==e.image_compression.NONE&&t()?(m=r(R,w.width*w.colors,w.colors,x),D=r(P,w.width,1,x)):(m=R,D=P,te=void 0)}if(w.colorType===3&&(b=this.color_spaces.INDEXED,O=w.palette,w.transparency.indexed)){var Z=w.transparency.indexed,he=0;for(q=0,C=Z.length;q<C;++q)he+=Z[q];if((he/=255)===C-1&&Z.indexOf(0)!==-1)_=[Z.indexOf(0)];else if(he!==C){for(T=w.decodePixels(),P=new Uint8Array(T.length),q=0,C=T.length;q<C;q++)P[q]=Z[T[q]];D=r(P,w.width,1)}}var k=function(I){var M;switch(I){case e.image_compression.FAST:M=11;break;case e.image_compression.MEDIUM:M=13;break;case e.image_compression.SLOW:M=14;break;default:M=12}return M}(x);return te===this.decode.FLATE_DECODE&&(z="/Predictor "+k+" "),z+="/Colors "+E+" /BitsPerComponent "+y+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),(D&&this.__addimage__.isArrayBuffer(D)||this.__addimage__.isArrayBufferView(D))&&(D=this.__addimage__.arrayBufferToBinaryString(D)),{alias:v,data:m,index:h,filter:te,decodeParameters:z,transparency:_,palette:O,sMask:D,predictor:k,width:w.width,height:w.height,bitsPerComponent:y,colorSpace:b}}}})(pt.API),function(e){e.processGIF89A=function(t,r,n,i){var s=new YC(t),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:a,height:o},f=new m1(100).encode(u,100);return e.processJPEG.call(this,f,r,n,i)},e.processGIF87A=e.processGIF89A}(pt.API),gs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},gs.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){ur.log("bit decode error:"+r)}},gs.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}r!==0&&(this.pos+=4-r)}},gs.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*i*4,o=s>>4,l=15&s,u=this.palette[o];if(this.data[a]=u.blue,this.data[a+1]=u.green,this.data[a+2]=u.red,this.data[a+3]=255,2*i+1>=this.width)break;u=this.palette[l],this.data[a+4]=u.blue,this.data[a+4+1]=u.green,this.data[a+4+2]=u.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},gs.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},gs.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,u=s>>15?255:0,f=n*this.width*4+4*i;this.data[f]=l,this.data[f+1]=o,this.data[f+2]=a,this.data[f+3]=u}this.pos+=e}},gs.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,l=(a>>5&r)/r*255|0,u=(a>>11)/t*255|0,f=i*this.width*4+4*s;this.data[f]=u,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},gs.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*r;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},gs.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=a}},gs.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new gs(t,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},u=new m1(100).encode(l,100);return e.processJPEG.call(this,u,r,n,i)}}(pt.API),a5.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new a5(t),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},u=new m1(100).encode(l,100);return e.processJPEG.call(this,u,r,n,i)}}(pt.API),pt.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,l=0,u=0;u<i;u+=4){var f=n[u],p=n[u+1],m=n[u+2],h=n[u+3];s[o++]=f,s[o++]=p,s[o++]=m,a[l++]=h}var v=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},pt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},pc=pt.API,$h=pc.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,l=o.fof?o.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,p=t.doKerning!==!1,m=0,h=e.length,v=0,x=o[0]||l,b=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?b.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(m=p&&tr(u[n])==="object"&&!isNaN(parseInt(u[n][v],10))?u[n][v]/f:0,b.push((o[n]||x)/l+m)),v=n;return b},r5=pc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return pc.processArabic&&(e=pc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:$h.apply(this,arguments).reduce(function(s,a){return s+a},0)},n5=function(e,t,r,n){for(var i=[],s=0,a=e.length,o=0;s!==a&&o+t[s]<r;)o+=t[s],s++;i.push(e.slice(0,s));var l=s;for(o=0;s!==a;)o+t[s]>n&&(i.push(e.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&i.push(e.slice(l,s)),i},i5=function(e,t,r){r||(r={});var n,i,s,a,o,l,u,f=[],p=[f],m=r.textIndent||0,h=0,v=0,x=e.split(" "),b=$h.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?x[0].length+2:r.lineIndent||0){var y=Array(l).join(" "),w=[];x.map(function(E){(E=E.split(/\s*\n/)).length>1?w=w.concat(E.map(function(O,D){return(D&&O.length?`
`:"")+O})):w.push(E[0])}),x=w,l=r5.apply(this,[y,r])}for(s=0,a=x.length;s<a;s++){var _=0;if(n=x[s],l&&n[0]==`
`&&(n=n.substr(1),_=1),m+h+(v=(i=$h.apply(this,[n,r])).reduce(function(E,O){return E+O},0))>t||_){if(v>t){for(o=n5.apply(this,[n,i,t-(m+h),t]),f.push(o.shift()),f=[o.pop()];o.length;)p.push([o.shift()]);v=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(E,O){return E+O},0)}else f=[n];p.push(f),m=v+l,h=b}else f.push(n),m+=h+v,h=b}return u=l?function(E,O){return(O?y:"")+E.join(" ")}:function(E){return E.join(" ")},p.map(u)},pc.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var p=this.internal.getFont(f.fontName,f.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var o,l,u=[];for(o=0,l=n.length;o<l;o++)u=u.concat(i5.apply(this,[n[o],a,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},i=0;i<t.length;i++)r[t[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=t[i];var s=function(p){return"0x"+parseInt(p,10).toString(16)},a=e.__fontmetrics__.compress=function(p){var m,h,v,x,b=["{"];for(var y in p){if(m=p[y],isNaN(parseInt(y,10))?h="'"+y+"'":(y=parseInt(y,10),h=(h=s(y).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof m=="number")m<0?(v=s(m).slice(3),x="-"):(v=s(m).slice(2),x=""),v=x+v.slice(0,-1)+n[v.slice(-1)];else{if(tr(m)!=="object")throw new Error("Don't know what to do with value type "+tr(m)+".");v=a(m)}b.push(h+v)}return b.push("}"),b.join("")},o=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,h,v,x,b={},y=1,w=b,_=[],E="",O="",D=p.length-1,T=1;T<D;T+=1)(x=p[T])=="'"?m?(v=m.join(""),m=void 0):m=[]:m?m.push(x):x=="{"?(_.push([w,v]),w={},v=void 0):x=="}"?((h=_.pop())[0][h[1]]=w,v=void 0,w=h[0]):x=="-"?y=-1:v===void 0?r.hasOwnProperty(x)?(E+=r[x],v=parseInt(E,16)*y,y=1,E=""):E+=x:r.hasOwnProperty(x)?(O+=r[x],w[v]=parseInt(O,16)*y,y=1,v=void 0,O=""):O+=x;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},f={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var m=p.font,h=f.Unicode[m.postScriptName];h&&(m.metadata.Unicode={},m.metadata.Unicode.widths=h.widths,m.metadata.Unicode.kerning=h.kerning);var v=u.Unicode[m.postScriptName];v&&(m.metadata.Unicode.encoding=v,m.encoding=v.codePages[0])}])}(pt.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(jf(o)),a.metadata=e.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,n)}}])}(pt),function(e){function t(){return(vt.canvg?Promise.resolve(vt.canvg):Aa(()=>import("./index.es-D82Fu46g.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}pt.API.addSvgAsImage=function(r,n,i,s,a,o,l,u){if(isNaN(n)||isNaN(i))throw ur.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw ur.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=s,f.height=a;var p=f.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,f.width,f.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(v){return v.fromString(p,r,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(m)}).then(function(){h.addImage(f.toDataURL("image/jpeg",1),n,i,s,a,l,u)})}}(),pt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},pt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],u=0,f=0,p=0;function m(v,x){var b,y=!1;for(b=0;b<v.length;b+=1)v[b]===x&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(p=0;p<h;p+=1)r[o[p]].value=r[o[p]].defaultValue,r[o[p]].explicitSet=!1}if(tr(e)==="object"){for(i in e)if(s=e[i],m(o,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&m(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")l.push(String(s[u]-1));else if(s[u].length>1){for(f=0;f<s[u].length;f+=1)typeof s[u][f]!="number"&&(n=!1);n===!0&&l.push([s[u][0]-1,s[u][1]-1].join(" "))}r[i].value="["+l.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,x=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?x.push("/"+v+" /"+r[v].value):x.push("/"+v+" "+r[v].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+a.length+o.length+i.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(pt.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,a){for(var o,l=a.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],p=0,m=s.length;p<m;++p){if(o=a.metadata.characterToGlyph(s.charCodeAt(p)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(p),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(u[4-o.length],o)}return f.join("")},n=function(s){var a,o,l,u,f,p,m;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],p=0,m=(o=Object.keys(s).sort(function(h,v){return h-v})).length;p<m;p++)a=o[p],l.length>=100&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(u=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+u+">"));return l.length&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,u=a.newObject,f=a.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var p=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",v=0;v<m.length;v++)h+=String.fromCharCode(m[v]);var x=u();f({data:h,addLength1:!0,objectId:x}),l("endobj");var b=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var y=u();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+wc(o.fontName)),l("/FontFile2 "+x+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var w=u();l("<<"),l("/Type /Font"),l("/BaseFont /"+wc(o.fontName)),l("/FontDescriptor "+y+" 0 R"),l("/W "+e.API.PDFObject.convert(p)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=u(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+wc(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+w+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,u=a.newObject,f=a.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var p=o.metadata.rawData,m="",h=0;h<p.length;h++)m+=String.fromCharCode(p[h]);var v=u();f({data:m,addLength1:!0,objectId:v}),l("endobj");var x=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:x}),l("endobj");var b=u();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+v+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+wc(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=u();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+wc(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var a,o=s.text||"",l=s.x,u=s.y,f=s.options||{},p=s.mutex||{},m=p.pdfEscape,h=p.activeFontKey,v=p.fonts,x=h,b="",y=0,w="",_=v[x].encoding;if(v[x].encoding!=="Identity-H")return{text:o,x:l,y:u,options:f,mutex:p};for(w=o,x=h,Array.isArray(o)&&(w=o[0]),y=0;y<w.length;y+=1)v[x].metadata.hasOwnProperty("cmap")&&(a=v[x].metadata.cmap.unicode.codeMap[w[y].charCodeAt(0)]),a||w[y].charCodeAt(0)<256&&v[x].metadata.hasOwnProperty("Unicode")?b+=w[y]:b+="";var E="";return parseInt(x.slice(1))<14||_==="WinAnsiEncoding"?E=m(b,x).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(E=r(b,v[x])),p.isHex=!0,{text:E,x:l,y:u,options:f,mutex:p}};t.events.push(["postProcessText",function(s){var a=s.text||"",o=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var u=0;for(u=0;u<a.length;u+=1)Array.isArray(a[u])&&a[u].length===3?o.push([i(Object.assign({},l,{text:a[u][0]})).text,a[u][1],a[u][2]]):o.push(i(Object.assign({},l,{text:a[u]})).text);s.text=o}else s.text=i(Object.assign({},l,{text:a})).text}])}(pt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(pt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,a,o,l,u,f,p=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,_=0;this.__bidiEngine__={};var E=function(j){var A=j.charCodeAt(),q=A>>8,J=x[q];return J!==void 0?p[256*J+(255&A)]:q===252||q===253?"AL":y.test(q)?"L":q===8?"R":"N"},O=function(j){for(var A,q=0;q<j.length;q++){if((A=E(j.charAt(q)))==="L")return!1;if(A==="R")return!0}return!1},D=function(j,A,q,J){var te,z,B,G,V=A[J];switch(V){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(V="AN");break;case"AL":w=!0,V="R";break;case"WS":V="N";break;case"CS":J<1||J+1>=A.length||(te=q[J-1])!=="EN"&&te!=="AN"||(z=A[J+1])!=="EN"&&z!=="AN"?V="N":w&&(z="AN"),V=z===te?z:"N";break;case"ES":V=(te=J>0?q[J-1]:"B")==="EN"&&J+1<A.length&&A[J+1]==="EN"?"EN":"N";break;case"ET":if(J>0&&q[J-1]==="EN"){V="EN";break}if(w){V="N";break}for(B=J+1,G=A.length;B<G&&A[B]==="ET";)B++;V=B<G&&A[B]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(G=A.length,B=J+1;B<G&&A[B]==="NSM";)B++;if(B<G){var Z=j[J],he=Z>=1425&&Z<=2303||Z===64286;if(te=A[B],he&&(te==="R"||te==="AL")){V="R";break}}}V=J<1||(te=A[J-1])==="B"?"N":q[J-1];break;case"B":w=!1,i=!0,V=_;break;case"S":s=!0,V="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":V="N"}return V},T=function(j,A,q){var J=j.split("");return q&&C(J,q,{hiLevel:_}),J.reverse(),A&&A.reverse(),J.join("")},C=function(j,A,q){var J,te,z,B,G,V=-1,Z=j.length,he=0,k=[],I=_?h:m,M=[];for(w=!1,i=!1,s=!1,te=0;te<Z;te++)M[te]=E(j[te]);for(z=0;z<Z;z++){if(G=he,k[z]=D(j,M,k,z),J=240&(he=I[G][v[k[z]]]),he&=15,A[z]=B=I[he][5],J>0)if(J===16){for(te=V;te<z;te++)A[te]=1;V=-1}else V=-1;if(I[he][6])V===-1&&(V=z);else if(V>-1){for(te=V;te<z;te++)A[te]=B;V=-1}M[z]==="B"&&(A[z]=0),q.hiLevel|=B}s&&function(L,H,se){for(var fe=0;fe<se;fe++)if(L[fe]==="S"){H[fe]=_;for(var de=fe-1;de>=0&&L[de]==="WS";de--)H[de]=_}}(M,A,Z)},P=function(j,A,q,J,te){if(!(te.hiLevel<j)){if(j===1&&_===1&&!i)return A.reverse(),void(q&&q.reverse());for(var z,B,G,V,Z=A.length,he=0;he<Z;){if(J[he]>=j){for(G=he+1;G<Z&&J[G]>=j;)G++;for(V=he,B=G-1;V<B;V++,B--)z=A[V],A[V]=A[B],A[B]=z,q&&(z=q[V],q[V]=q[B],q[B]=z);he=G}he++}}},R=function(j,A,q){var J=j.split(""),te={hiLevel:_};return q||(q=[]),C(J,q,te),function(z,B,G){if(G.hiLevel!==0&&f)for(var V,Z=0;Z<z.length;Z++)B[Z]===1&&(V=b.indexOf(z[Z]))>=0&&(z[Z]=b[V+1])}(J,q,te),P(2,J,A,q,te),P(1,J,A,q,te),J.join("")};return this.__bidiEngine__.doBidiReorder=function(j,A,q){if(function(te,z){if(z)for(var B=0;B<te.length;B++)z[B]=B;o===void 0&&(o=O(te)),u===void 0&&(u=O(te))}(j,A),a||!l||u)if(a&&l&&o^u)_=o?1:0,j=T(j,A,q);else if(!a&&l&&u)_=o?1:0,j=R(j,A,q),j=T(j,A);else if(!a||o||l||u){if(a&&!l&&o^u)j=T(j,A),o?(_=0,j=R(j,A,q)):(_=1,j=R(j,A,q),j=T(j,A));else if(a&&o&&!l&&u)_=1,j=R(j,A,q),j=T(j,A);else if(!a&&!l&&o^u){var J=f;o?(_=1,j=R(j,A,q),_=0,f=!1,j=R(j,A,q),f=J):(_=0,j=R(j,A,q),j=T(j,A),_=1,f=!1,j=R(j,A,q),f=J,j=T(j,A))}}else _=0,j=R(j,A,q);else _=o?1:0,j=R(j,A,q);return j},this.__bidiEngine__.setOptions=function(j){j&&(a=j.isInputVisual,l=j.isOutputVisual,o=j.isInputRtl,u=j.isOutputRtl,f=j.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text,s=(n.x,n.y,n.options||{}),a=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(a=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?a.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):a.push([r.doBidiReorder(i[o])]);n.text=a}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(pt),pt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Co(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new c7(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new KC(this.contents),this.head=new JC(this),this.name=new r7(this),this.cmap=new R_(this),this.toUnicode={},this.hhea=new QC(this),this.maxp=new n7(this),this.hmtx=new i7(this),this.post=new e7(this),this.os2=new ZC(this),this.loca=new l7(this),this.glyf=new s7(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,u;for(u=[],a=0,o=(l=this.bbox).length;a<o;a++)t=l[a],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,a,o;for(a=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=t.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return a*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Ls,Co=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,a,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*a+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),KC=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,a,o,l,u,f,p,m,h,v,x;for(x in h=Object.keys(r).length,l=Math.log(2),p=16*Math.floor(Math.log(h)/l),a=Math.floor(p/l),f=16*h-p,(i=new Co).writeInt(this.scalarType),i.writeShort(h),i.writeShort(p),i.writeShort(a),i.writeShort(f),s=16*h,u=i.pos+s,o=null,v=[],r)for(m=r[x],i.writeString(x),i.writeInt(e(m)),i.writeInt(u),i.writeInt(m.length),v=v.concat(m),x==="head"&&(o=u),u+=m.length;u%4;)v.push(0),u++;return i.write(v),n=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,a;for(r=M_.call(r);r.length%4;)r.push(0);for(s=new Co(r),i=0,n=0,a=r.length;n<a;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),XC={}.hasOwnProperty,ta=function(e,t){for(var r in t)XC.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Ls=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var JC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new Co).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),o5=function(){function e(t,r){var n,i,s,a,o,l,u,f,p,m,h,v,x,b,y,w,_;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),p=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(h=t.readUInt16(),m=h/2,t.pos+=6,s=function(){var E,O;for(O=[],l=E=0;0<=m?E<m:E>m;l=0<=m?++E:--E)O.push(t.readUInt16());return O}(),t.pos+=2,x=function(){var E,O;for(O=[],l=E=0;0<=m?E<m:E>m;l=0<=m?++E:--E)O.push(t.readUInt16());return O}(),u=function(){var E,O;for(O=[],l=E=0;0<=m?E<m:E>m;l=0<=m?++E:--E)O.push(t.readUInt16());return O}(),f=function(){var E,O;for(O=[],l=E=0;0<=m?E<m:E>m;l=0<=m?++E:--E)O.push(t.readUInt16());return O}(),i=(this.length-t.pos+this.offset)/2,o=function(){var E,O;for(O=[],l=E=0;0<=i?E<i:E>i;l=0<=i?++E:--E)O.push(t.readUInt16());return O}(),l=y=0,_=s.length;y<_;l=++y)for(b=s[l],n=w=v=x[l];v<=b?w<=b:w>=b;n=v<=b?++w:--w)f[l]===0?a=n+u[l]:(a=o[f[l]/2+(n-v)-(m-l)]||0)!==0&&(a+=u[l]),this.codeMap[n]=65535&a}t.pos=p}return e.encode=function(t,r){var n,i,s,a,o,l,u,f,p,m,h,v,x,b,y,w,_,E,O,D,T,C,P,R,j,A,q,J,te,z,B,G,V,Z,he,k,I,M,L,H,se,fe,de,ve,Ee,Oe;switch(J=new Co,a=Object.keys(t).sort(function(qe,Qe){return qe-Qe}),r){case"macroman":for(x=0,b=function(){var qe=[];for(v=0;v<256;++v)qe.push(0);return qe}(),w={0:0},s={},te=0,V=a.length;te<V;te++)w[de=t[i=a[te]]]==null&&(w[de]=++x),s[i]={old:t[i],new:w[t[i]]},b[i]=w[t[i]];return J.writeUInt16(1),J.writeUInt16(0),J.writeUInt32(12),J.writeUInt16(0),J.writeUInt16(262),J.writeUInt16(0),J.write(b),{charMap:s,subtable:J.data,maxGlyphID:x+1};case"unicode":for(A=[],p=[],_=0,w={},n={},y=u=null,z=0,Z=a.length;z<Z;z++)w[O=t[i=a[z]]]==null&&(w[O]=++_),n[i]={old:O,new:w[O]},o=w[O]-i,y!=null&&o===u||(y&&p.push(y),A.push(i),u=o),y=i;for(y&&p.push(y),p.push(65535),A.push(65535),R=2*(P=A.length),C=2*Math.pow(Math.log(P)/Math.LN2,2),m=Math.log(C/2)/Math.LN2,T=2*P-C,l=[],D=[],h=[],v=B=0,he=A.length;B<he;v=++B){if(j=A[v],f=p[v],j===65535){l.push(0),D.push(0);break}if(j-(q=n[j].new)>=32768)for(l.push(0),D.push(2*(h.length+P-v)),i=G=j;j<=f?G<=f:G>=f;i=j<=f?++G:--G)h.push(n[i].new);else l.push(q-j),D.push(0)}for(J.writeUInt16(3),J.writeUInt16(1),J.writeUInt32(12),J.writeUInt16(4),J.writeUInt16(16+8*P+2*h.length),J.writeUInt16(0),J.writeUInt16(R),J.writeUInt16(C),J.writeUInt16(m),J.writeUInt16(T),se=0,k=p.length;se<k;se++)i=p[se],J.writeUInt16(i);for(J.writeUInt16(0),fe=0,I=A.length;fe<I;fe++)i=A[fe],J.writeUInt16(i);for(ve=0,M=l.length;ve<M;ve++)o=l[ve],J.writeUInt16(o);for(Ee=0,L=D.length;Ee<L;Ee++)E=D[Ee],J.writeUInt16(E);for(Oe=0,H=h.length;Oe<H;Oe++)x=h[Oe],J.writeUInt16(x);return{charMap:n,subtable:J.data,maxGlyphID:_+1}}},e}(),R_=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,i,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)n=new o5(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var i,s;return n==null&&(n="macroman"),i=o5.encode(r,n),(s=new Co).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},t}(),QC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),ZC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),e7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="post",t.prototype.parse=function(r){var n,i,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var a;for(i=r.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)n=r.readByte(),s.push(this.names.push(r.readString(n)));return s;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=(function(){var o,l,u;for(u=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)u.push(r.readUInt32());return u}).call(this)}},t}(),t7=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},r7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="name",t.prototype.parse=function(r){var n,i,s,a,o,l,u,f,p,m,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),i=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(u={},a=p=0,m=i.length;p<m;a=++p)s=i[a],r.pos=s.offset,f=r.readString(s.length),o=new t7(f,s),u[h=s.nameID]==null&&(u[h]=[]),u[s.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t}(),n7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),i7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,i,s,a,o,l,u;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,p;for(p=[],n=f=0;0<=s?f<s:f>s;n=0<=s?++f:--f)p.push(r.readInt16());return p}(),this.widths=(function(){var f,p,m,h;for(h=[],f=0,p=(m=this.metrics).length;f<p;f++)a=m[f],h.push(a.advance);return h}).call(this),i=this.widths[this.widths.length-1],u=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)u.push(this.widths.push(i));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),M_=[].slice,s7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,i,s,a,o,l,u,f,p,m;return r in this.cache?this.cache[r]:(a=this.file.loca,n=this.file.contents,i=a.indexOf(r),(s=a.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,o=(l=new Co(n.read(s))).readShort(),f=l.readShort(),m=l.readShort(),u=l.readShort(),p=l.readShort(),this.cache[r]=o===-1?new o7(l,f,m,u,p):new a7(l,o,f,m,u,p),this.cache[r]))},t.prototype.encode=function(r,n,i){var s,a,o,l,u;for(o=[],a=[],l=0,u=n.length;l<u;l++)s=r[n[l]],a.push(o.length),s&&(o=o.concat(s.encode(i)));return a.push(o.length),{table:o,offsets:a}},t}(),a7=function(){function e(t,r,n,i,s,a){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=a,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),o7=function(){function e(t,r,n,i,s){var a,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Co(M_.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),l7=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,Ls),t.prototype.tag="loca",t.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=2)a.push(2*r.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=4)a.push(r.readUInt32());return a}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<i.length;++o)if(i[o]=s,a<n.length&&n[a]==o){++a,i[o]=s;var l=this.offsets[o],u=this.offsets[o+1]-l;u>0&&(s+=u)}for(var f=new Array(4*i.length),p=0;p<i.length;++p)f[4*p+3]=255&i[p],f[4*p+2]=(65280&i[p])>>8,f[4*p+1]=(16711680&i[p])>>16,f[4*p]=(4278190080&i[p])>>24;return f},t}(),c7=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,a,o,l;for(i={},a=0,o=t.length;a<o;a++)i[s=t[a]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in l=this.glyphsFor(r))n=l[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,a,o,l,u,f,p,m,h,v,x,b,y;for(i in n=R_.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),h={0:0},y=n.charMap)h[(l=y[i]).old]=l.new;for(v in m=n.maxGlyphID,a)v in h||(h[v]=m++);return f=function(w){var _,E;for(_ in E={},w)E[w[_]]=_;return E}(h),p=Object.keys(f).sort(function(w,_){return w-_}),x=function(){var w,_,E;for(E=[],w=0,_=p.length;w<_;w++)o=p[w],E.push(f[o]);return E}(),s=this.font.glyf.encode(a,x,h),u=this.font.loca.encode(s.offsets,x),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},e}();pt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,a;if(Array.isArray(r))return"["+function(){var o,l,u;for(u=[],o=0,l=r.length;o<l;o++)n=r[o],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)a=r[i],s.push("/"+i+" "+t.convert(a));return s.push(">>"),s.join(`
`)}return""+r},t}();const u7=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:zC,AcroFormAppearance:ut,AcroFormButton:sn,AcroFormCheckBox:Lf,AcroFormChoiceField:ml,AcroFormComboBox:xl,AcroFormEditBox:Cf,AcroFormListBox:gl,AcroFormPasswordField:Ff,AcroFormPushButton:Pf,AcroFormRadioButton:vl,AcroFormTextField:So,GState:ld,ShadingPattern:so,TilingPattern:cl,default:pt,jsPDF:pt},Symbol.toStringTag,{value:"Module"}));var B_={exports:{}};const f7=ew(u7);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(n,i){e.exports=i(function(){try{return f7}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Xn<"u"?Xn:typeof window<"u"?window:typeof self<"u"?self:Xn,function(r){return function(){var n={172:function(o,l){var u=this&&this.__extends||function(){var m=function(h,v){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,b){x.__proto__=b}||function(x,b){for(var y in b)Object.prototype.hasOwnProperty.call(b,y)&&(x[y]=b[y])},m(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");m(h,v);function x(){this.constructor=h}h.prototype=v===null?Object.create(v):(x.prototype=v.prototype,new x)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.CellHookData=l.HookData=void 0;var f=function(){function m(h,v,x){this.table=v,this.pageNumber=v.pageNumber,this.pageCount=this.pageNumber,this.settings=v.settings,this.cursor=x,this.doc=h.getDocument()}return m}();l.HookData=f;var p=function(m){u(h,m);function h(v,x,b,y,w,_){var E=m.call(this,v,x,_)||this;return E.cell=b,E.row=y,E.column=w,E.section=y.section,E}return h}(f);l.CellHookData=p},340:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0});var f=u(4),p=u(136),m=u(744),h=u(776),v=u(664),x=u(972);function b(y){y.API.autoTable=function(){for(var w=[],_=0;_<arguments.length;_++)w[_]=arguments[_];var E;w.length===1?E=w[0]:(console.error("Use of deprecated autoTable initiation"),E=w[2]||{},E.columns=w[0],E.body=w[1]);var O=(0,h.parseInput)(this,E),D=(0,x.createTable)(this,O);return(0,v.drawTable)(this,D),this},y.API.lastAutoTable=!1,y.API.previousAutoTable=!1,y.API.autoTable.previous=!1,y.API.autoTableText=function(w,_,E,O){(0,p.default)(w,_,E,O,this)},y.API.autoTableSetDefaults=function(w){return m.DocHandler.setDefaults(w,this),this},y.autoTableSetDefaults=function(w,_){m.DocHandler.setDefaults(w,_)},y.API.autoTableHtmlToJson=function(w,_){var E;if(_===void 0&&(_=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var O=new m.DocHandler(this),D=(0,f.parseHtml)(O,w,window,_,!1),T=D.head,C=D.body,P=((E=T[0])===null||E===void 0?void 0:E.map(function(R){return R.content}))||[];return{columns:P,rows:C,data:C}},y.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var w=this.lastAutoTable;return w&&w.finalY?w.finalY:0},y.API.autoTableAddPageContent=function(w){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),y.API.autoTable.globalDefaults||(y.API.autoTable.globalDefaults={}),y.API.autoTable.globalDefaults.addPageContent=w,this},y.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}l.default=b},136:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function u(f,p,m,h,v){h=h||{};var x=1.15,b=v.internal.scaleFactor,y=v.internal.getFontSize()/b,w=v.getLineHeightFactor?v.getLineHeightFactor():x,_=y*w,E=/\r\n|\r|\n/g,O="",D=1;if((h.valign==="middle"||h.valign==="bottom"||h.halign==="center"||h.halign==="right")&&(O=typeof f=="string"?f.split(E):f,D=O.length||1),m+=y*(2-x),h.valign==="middle"?m-=D/2*_:h.valign==="bottom"&&(m-=D*_),h.halign==="center"||h.halign==="right"){var T=y;if(h.halign==="center"&&(T*=.5),O&&D>=1){for(var C=0;C<O.length;C++)v.text(O[C],p-v.getStringUnitWidth(O[C])*T,m),m+=_;return v}p-=v.getStringUnitWidth(f)*T}return h.halign==="justify"?v.text(f,p,m,{maxWidth:h.maxWidth||100,align:"justify"}):v.text(f,p,m),v}l.default=u},420:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.getPageAvailableWidth=l.parseSpacing=l.getFillStyle=l.addTableBorder=l.getStringWidth=void 0;function u(v,x,b){b.applyStyles(x,!0);var y=Array.isArray(v)?v:[v],w=y.map(function(_){return b.getTextWidth(_)}).reduce(function(_,E){return Math.max(_,E)},0);return w}l.getStringWidth=u;function f(v,x,b,y){var w=x.settings.tableLineWidth,_=x.settings.tableLineColor;v.applyStyles({lineWidth:w,lineColor:_});var E=p(w,!1);E&&v.rect(b.x,b.y,x.getWidth(v.pageSize().width),y.y-b.y,E)}l.addTableBorder=f;function p(v,x){var b=v>0,y=x||x===0;return b&&y?"DF":b?"S":y?"F":null}l.getFillStyle=p;function m(v,x){var b,y,w,_;if(v=v||x,Array.isArray(v)){if(v.length>=4)return{top:v[0],right:v[1],bottom:v[2],left:v[3]};if(v.length===3)return{top:v[0],right:v[1],bottom:v[2],left:v[1]};if(v.length===2)return{top:v[0],right:v[1],bottom:v[0],left:v[1]};v.length===1?v=v[0]:v=x}return typeof v=="object"?(typeof v.vertical=="number"&&(v.top=v.vertical,v.bottom=v.vertical),typeof v.horizontal=="number"&&(v.right=v.horizontal,v.left=v.horizontal),{left:(b=v.left)!==null&&b!==void 0?b:x,top:(y=v.top)!==null&&y!==void 0?y:x,right:(w=v.right)!==null&&w!==void 0?w:x,bottom:(_=v.bottom)!==null&&_!==void 0?_:x}):(typeof v!="number"&&(v=x),{top:v,right:v,bottom:v,left:v})}l.parseSpacing=m;function h(v,x){var b=m(x.settings.margin,0);return v.pageSize().width-(b.left+b.right)}l.getPageAvailableWidth=h},796:function(o,l){var u=this&&this.__extends||function(){var h=function(v,x){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,y){b.__proto__=y}||function(b,y){for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(b[w]=y[w])},h(v,x)};return function(v,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");h(v,x);function b(){this.constructor=v}v.prototype=x===null?Object.create(x):(b.prototype=x.prototype,new b)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.getTheme=l.defaultStyles=l.HtmlRowInput=void 0;var f=function(h){u(v,h);function v(x){var b=h.call(this)||this;return b._element=x,b}return v}(Array);l.HtmlRowInput=f;function p(h){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/h,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}l.defaultStyles=p;function m(h){var v={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return v[h]}l.getTheme=m},903:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseCss=void 0;var f=u(420);function p(b,y,w,_,E){var O={},D=1.3333333333333333,T=h(y,function(V){return E.getComputedStyle(V).backgroundColor});T!=null&&(O.fillColor=T);var C=h(y,function(V){return E.getComputedStyle(V).color});C!=null&&(O.textColor=C);var P=x(_,w);P&&(O.cellPadding=P);var R="borderTopColor",j=D*w,A=_.borderTopWidth;if(_.borderBottomWidth===A&&_.borderRightWidth===A&&_.borderLeftWidth===A){var q=(parseFloat(A)||0)/j;q&&(O.lineWidth=q)}else O.lineWidth={top:(parseFloat(_.borderTopWidth)||0)/j,right:(parseFloat(_.borderRightWidth)||0)/j,bottom:(parseFloat(_.borderBottomWidth)||0)/j,left:(parseFloat(_.borderLeftWidth)||0)/j},O.lineWidth.top||(O.lineWidth.right?R="borderRightColor":O.lineWidth.bottom?R="borderBottomColor":O.lineWidth.left&&(R="borderLeftColor"));var J=h(y,function(V){return E.getComputedStyle(V)[R]});J!=null&&(O.lineColor=J);var te=["left","right","center","justify"];te.indexOf(_.textAlign)!==-1&&(O.halign=_.textAlign),te=["middle","bottom","top"],te.indexOf(_.verticalAlign)!==-1&&(O.valign=_.verticalAlign);var z=parseInt(_.fontSize||"");isNaN(z)||(O.fontSize=z/D);var B=m(_);B&&(O.fontStyle=B);var G=(_.fontFamily||"").toLowerCase();return b.indexOf(G)!==-1&&(O.font=G),O}l.parseCss=p;function m(b){var y="";return(b.fontWeight==="bold"||b.fontWeight==="bolder"||parseInt(b.fontWeight)>=700)&&(y="bold"),(b.fontStyle==="italic"||b.fontStyle==="oblique")&&(y+="italic"),y}function h(b,y){var w=v(b,y);if(!w)return null;var _=w.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!_||!Array.isArray(_))return null;var E=[parseInt(_[1]),parseInt(_[2]),parseInt(_[3])],O=parseInt(_[4]);return O===0||isNaN(E[0])||isNaN(E[1])||isNaN(E[2])?null:E}function v(b,y){var w=y(b);return w==="rgba(0, 0, 0, 0)"||w==="transparent"||w==="initial"||w==="inherit"?b.parentElement==null?null:v(b.parentElement,y):w}function x(b,y){var w=[b.paddingTop,b.paddingRight,b.paddingBottom,b.paddingLeft],_=96/(72/y),E=(parseInt(b.lineHeight)-parseInt(b.fontSize))/y/2,O=w.map(function(T){return parseInt(T||"0")/_}),D=(0,f.parseSpacing)(O,0);return E>D.top&&(D.top=E),E>D.bottom&&(D.bottom=E),D}},744:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocHandler=void 0;var u={},f=function(){function p(m){this.jsPDFDocument=m,this.userStyles={textColor:m.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:m.internal.getFontSize(),fontStyle:m.internal.getFont().fontStyle,font:m.internal.getFont().fontName,lineWidth:m.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:m.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return p.setDefaults=function(m,h){h===void 0&&(h=null),h?h.__autoTableDocumentDefaults=m:u=m},p.unifyColor=function(m){return Array.isArray(m)?m:typeof m=="number"?[m,m,m]:typeof m=="string"?[m]:null},p.prototype.applyStyles=function(m,h){var v,x,b;h===void 0&&(h=!1),m.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(m.fontStyle);var y=this.jsPDFDocument.internal.getFont(),w=y.fontStyle,_=y.fontName;if(m.font&&(_=m.font),m.fontStyle){w=m.fontStyle;var E=this.getFontList()[_];E&&E.indexOf(w)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(E[0]),w=E[0])}if(this.jsPDFDocument.setFont(_,w),m.fontSize&&this.jsPDFDocument.setFontSize(m.fontSize),!h){var O=p.unifyColor(m.fillColor);O&&(v=this.jsPDFDocument).setFillColor.apply(v,O),O=p.unifyColor(m.textColor),O&&(x=this.jsPDFDocument).setTextColor.apply(x,O),O=p.unifyColor(m.lineColor),O&&(b=this.jsPDFDocument).setDrawColor.apply(b,O),typeof m.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(m.lineWidth)}},p.prototype.splitTextToSize=function(m,h,v){return this.jsPDFDocument.splitTextToSize(m,h,v)},p.prototype.rect=function(m,h,v,x,b){return this.jsPDFDocument.rect(m,h,v,x,b)},p.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},p.prototype.getTextWidth=function(m){return this.jsPDFDocument.getTextWidth(m)},p.prototype.getDocument=function(){return this.jsPDFDocument},p.prototype.setPage=function(m){this.jsPDFDocument.setPage(m)},p.prototype.addPage=function(){return this.jsPDFDocument.addPage()},p.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},p.prototype.getGlobalOptions=function(){return u||{}},p.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},p.prototype.pageSize=function(){var m=this.jsPDFDocument.internal.pageSize;return m.width==null&&(m={width:m.getWidth(),height:m.getHeight()}),m},p.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},p.prototype.getLineHeightFactor=function(){var m=this.jsPDFDocument;return m.getLineHeightFactor?m.getLineHeightFactor():1.15},p.prototype.getLineHeight=function(m){return m/this.scaleFactor()*this.getLineHeightFactor()},p.prototype.pageNumber=function(){var m=this.jsPDFDocument.internal.getCurrentPageInfo();return m?m.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},p}();l.DocHandler=f},4:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseHtml=void 0;var f=u(903),p=u(796);function m(x,b,y,w,_){var E,O;w===void 0&&(w=!1),_===void 0&&(_=!1);var D;typeof b=="string"?D=y.document.querySelector(b):D=b;var T=Object.keys(x.getFontList()),C=x.scaleFactor(),P=[],R=[],j=[];if(!D)return console.error("Html table could not be found with input: ",b),{head:P,body:R,foot:j};for(var A=0;A<D.rows.length;A++){var q=D.rows[A],J=(O=(E=q==null?void 0:q.parentElement)===null||E===void 0?void 0:E.tagName)===null||O===void 0?void 0:O.toLowerCase(),te=h(T,C,y,q,w,_);te&&(J==="thead"?P.push(te):J==="tfoot"?j.push(te):R.push(te))}return{head:P,body:R,foot:j}}l.parseHtml=m;function h(x,b,y,w,_,E){for(var O=new p.HtmlRowInput(w),D=0;D<w.cells.length;D++){var T=w.cells[D],C=y.getComputedStyle(T);if(_||C.display!=="none"){var P=void 0;E&&(P=(0,f.parseCss)(x,T,b,C,y)),O.push({rowSpan:T.rowSpan,colSpan:T.colSpan,styles:P,_element:T,content:v(T)})}}var R=y.getComputedStyle(w);if(O.length>0&&(_||R.display!=="none"))return O}function v(x){var b=x.cloneNode(!0);return b.innerHTML=b.innerHTML.replace(/\n/g,"").replace(/ +/g," "),b.innerHTML=b.innerHTML.split(/<br.*?>/).map(function(y){return y.trim()}).join(`
`),b.innerText||b.textContent||""}},776:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseInput=void 0;var f=u(4),p=u(356),m=u(420),h=u(744),v=u(792);function x(D,T){var C=new h.DocHandler(D),P=C.getDocumentOptions(),R=C.getGlobalOptions();(0,v.default)(C,R,P,T);var j=(0,p.assign)({},R,P,T),A;typeof window<"u"&&(A=window);var q=b(R,P,T),J=y(R,P,T),te=w(C,j),z=E(C,j,A);return{id:T.tableId,content:z,hooks:J,styles:q,settings:te}}l.parseInput=x;function b(D,T,C){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},R=function(J){if(J==="columnStyles"){var te=D[J],z=T[J],B=C[J];P.columnStyles=(0,p.assign)({},te,z,B)}else{var G=[D,T,C],V=G.map(function(Z){return Z[J]||{}});P[J]=(0,p.assign)({},V[0],V[1],V[2])}},j=0,A=Object.keys(P);j<A.length;j++){var q=A[j];R(q)}return P}function y(D,T,C){for(var P=[D,T,C],R={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},j=0,A=P;j<A.length;j++){var q=A[j];q.didParseCell&&R.didParseCell.push(q.didParseCell),q.willDrawCell&&R.willDrawCell.push(q.willDrawCell),q.didDrawCell&&R.didDrawCell.push(q.didDrawCell),q.willDrawPage&&R.willDrawPage.push(q.willDrawPage),q.didDrawPage&&R.didDrawPage.push(q.didDrawPage)}return R}function w(D,T){var C,P,R,j,A,q,J,te,z,B,G,V,Z=(0,m.parseSpacing)(T.margin,40/D.scaleFactor()),he=(C=_(D,T.startY))!==null&&C!==void 0?C:Z.top,k;T.showFoot===!0?k="everyPage":T.showFoot===!1?k="never":k=(P=T.showFoot)!==null&&P!==void 0?P:"everyPage";var I;T.showHead===!0?I="everyPage":T.showHead===!1?I="never":I=(R=T.showHead)!==null&&R!==void 0?R:"everyPage";var M=(j=T.useCss)!==null&&j!==void 0?j:!1,L=T.theme||(M?"plain":"striped"),H=!!T.horizontalPageBreak,se=(A=T.horizontalPageBreakRepeat)!==null&&A!==void 0?A:null;return{includeHiddenHtml:(q=T.includeHiddenHtml)!==null&&q!==void 0?q:!1,useCss:M,theme:L,startY:he,margin:Z,pageBreak:(J=T.pageBreak)!==null&&J!==void 0?J:"auto",rowPageBreak:(te=T.rowPageBreak)!==null&&te!==void 0?te:"auto",tableWidth:(z=T.tableWidth)!==null&&z!==void 0?z:"auto",showHead:I,showFoot:k,tableLineWidth:(B=T.tableLineWidth)!==null&&B!==void 0?B:0,tableLineColor:(G=T.tableLineColor)!==null&&G!==void 0?G:200,horizontalPageBreak:H,horizontalPageBreakRepeat:se,horizontalPageBreakBehaviour:(V=T.horizontalPageBreakBehaviour)!==null&&V!==void 0?V:"afterAllRows"}}function _(D,T){var C=D.getLastAutoTable(),P=D.scaleFactor(),R=D.pageNumber(),j=!1;if(C&&C.startPageNumber){var A=C.startPageNumber+C.pageNumber-1;j=A===R}return typeof T=="number"?T:(T==null||T===!1)&&j&&(C==null?void 0:C.finalY)!=null?C.finalY+20/P:null}function E(D,T,C){var P=T.head||[],R=T.body||[],j=T.foot||[];if(T.html){var A=T.includeHiddenHtml;if(C){var q=(0,f.parseHtml)(D,T.html,C,A,T.useCss)||{};P=q.head||P,R=q.body||P,j=q.foot||P}else console.error("Cannot parse html in non browser environment")}var J=T.columns||O(P,R,j);return{columns:J,head:P,body:R,foot:j}}function O(D,T,C){var P=D[0]||T[0]||C[0]||[],R=[];return Object.keys(P).filter(function(j){return j!=="_element"}).forEach(function(j){var A=1,q;Array.isArray(P)?q=P[parseInt(j)]:q=P[j],typeof q=="object"&&!Array.isArray(q)&&(A=(q==null?void 0:q.colSpan)||1);for(var J=0;J<A;J++){var te=void 0;Array.isArray(P)?te=R.length:te=j+(J>0?"_".concat(J):"");var z={dataKey:te};R.push(z)}}),R}},792:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function u(p,m,h,v){for(var x=function(_){_&&typeof _!="object"&&console.error("The options parameter should be of type object, is: "+typeof _),typeof _.extendWidth<"u"&&(_.tableWidth=_.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof _.margins<"u"&&(typeof _.margin>"u"&&(_.margin=_.margins),console.error("Use of deprecated option: margins, use margin instead.")),_.startY&&typeof _.startY!="number"&&(console.error("Invalid value for startY option",_.startY),delete _.startY),!_.didDrawPage&&(_.afterPageContent||_.beforePageContent||_.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),_.didDrawPage=function(j){p.applyStyles(p.userStyles),_.beforePageContent&&_.beforePageContent(j),p.applyStyles(p.userStyles),_.afterPageContent&&_.afterPageContent(j),p.applyStyles(p.userStyles),_.afterPageAdd&&j.pageNumber>1&&j.afterPageAdd(j),p.applyStyles(p.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(j){_[j]&&console.error('The "'.concat(j,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(j){var A=j[0],q=j[1];_[q]&&(console.error("Use of deprecated option ".concat(q,". Use ").concat(A," instead")),_[A]=_[q])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(j){var A=typeof j=="string"?j:j[0],q=typeof j=="string"?j:j[1];typeof _[A]<"u"&&(typeof _.styles[q]>"u"&&(_.styles[q]=_[A]),console.error("Use of deprecated option: "+A+", use the style "+q+" instead."))});for(var E=0,O=["styles","bodyStyles","headStyles","footStyles"];E<O.length;E++){var D=O[E];f(_[D]||{})}for(var T=_.columnStyles||{},C=0,P=Object.keys(T);C<P.length;C++){var R=P[C];f(T[R]||{})}},b=0,y=[m,h,v];b<y.length;b++){var w=y[b];x(w)}}l.default=u;function f(p){p.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),p.minCellHeight||(p.minCellHeight=p.rowHeight)):p.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),p.cellWidth||(p.cellWidth=p.columnWidth))}},260:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.Column=l.Cell=l.Row=l.Table=void 0;var f=u(796),p=u(172),m=u(420),h=function(){function y(w,_){this.pageNumber=1,this.pageCount=1,this.id=w.id,this.settings=w.settings,this.styles=w.styles,this.hooks=w.hooks,this.columns=_.columns,this.head=_.head,this.body=_.body,this.foot=_.foot}return y.prototype.getHeadHeight=function(w){return this.head.reduce(function(_,E){return _+E.getMaxCellHeight(w)},0)},y.prototype.getFootHeight=function(w){return this.foot.reduce(function(_,E){return _+E.getMaxCellHeight(w)},0)},y.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},y.prototype.callCellHooks=function(w,_,E,O,D,T){for(var C=0,P=_;C<P.length;C++){var R=P[C],j=new p.CellHookData(w,this,E,O,D,T),A=R(j)===!1;if(E.text=Array.isArray(E.text)?E.text:[E.text],A)return!1}return!0},y.prototype.callEndPageHooks=function(w,_){w.applyStyles(w.userStyles);for(var E=0,O=this.hooks.didDrawPage;E<O.length;E++){var D=O[E];D(new p.HookData(w,this,_))}},y.prototype.callWillDrawPageHooks=function(w,_){for(var E=0,O=this.hooks.willDrawPage;E<O.length;E++){var D=O[E];D(new p.HookData(w,this,_))}},y.prototype.getWidth=function(w){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var _=this.columns.reduce(function(O,D){return O+D.wrappedWidth},0);return _}else{var E=this.settings.margin;return w-E.left-E.right}},y}();l.Table=h;var v=function(){function y(w,_,E,O,D){D===void 0&&(D=!1),this.height=0,this.raw=w,w instanceof f.HtmlRowInput&&(this.raw=w._element,this.element=w._element),this.index=_,this.section=E,this.cells=O,this.spansMultiplePages=D}return y.prototype.getMaxCellHeight=function(w){var _=this;return w.reduce(function(E,O){var D;return Math.max(E,((D=_.cells[O.index])===null||D===void 0?void 0:D.height)||0)},0)},y.prototype.hasRowSpan=function(w){var _=this;return w.filter(function(E){var O=_.cells[E.index];return O?O.rowSpan>1:!1}).length>0},y.prototype.canEntireRowFit=function(w,_){return this.getMaxCellHeight(_)<=w},y.prototype.getMinimumRowHeight=function(w,_){var E=this;return w.reduce(function(O,D){var T=E.cells[D.index];if(!T)return 0;var C=_.getLineHeight(T.styles.fontSize),P=T.padding("vertical"),R=P+C;return R>O?R:O},0)},y}();l.Row=v;var x=function(){function y(w,_,E){var O,D;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=_,this.section=E,this.raw=w;var T=w;w!=null&&typeof w=="object"&&!Array.isArray(w)?(this.rowSpan=w.rowSpan||1,this.colSpan=w.colSpan||1,T=(D=(O=w.content)!==null&&O!==void 0?O:w.title)!==null&&D!==void 0?D:w,w._element&&(this.raw=w._element)):(this.rowSpan=1,this.colSpan=1);var C=T!=null?""+T:"",P=/\r\n|\r|\n/g;this.text=C.split(P)}return y.prototype.getTextPos=function(){var w;if(this.styles.valign==="top")w=this.y+this.padding("top");else if(this.styles.valign==="bottom")w=this.y+this.height-this.padding("bottom");else{var _=this.height-this.padding("vertical");w=this.y+_/2+this.padding("top")}var E;if(this.styles.halign==="right")E=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var O=this.width-this.padding("horizontal");E=this.x+O/2+this.padding("left")}else E=this.x+this.padding("left");return{x:E,y:w}},y.prototype.getContentHeight=function(w,_){_===void 0&&(_=1.15);var E=Array.isArray(this.text)?this.text.length:1,O=this.styles.fontSize/w*_,D=E*O+this.padding("vertical");return Math.max(D,this.styles.minCellHeight)},y.prototype.padding=function(w){var _=(0,m.parseSpacing)(this.styles.cellPadding,0);return w==="vertical"?_.top+_.bottom:w==="horizontal"?_.left+_.right:_[w]},y}();l.Cell=x;var b=function(){function y(w,_,E){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=w,this.raw=_,this.index=E}return y.prototype.getMaxCustomCellWidth=function(w){for(var _=0,E=0,O=w.allRows();E<O.length;E++){var D=O[E],T=D.cells[this.index];T&&typeof T.styles.cellWidth=="number"&&(_=Math.max(_,T.styles.cellWidth))}return _},y}();l.Column=b},356:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.assign=void 0;function u(f,p,m,h,v){if(f==null)throw new TypeError("Cannot convert undefined or null to object");for(var x=Object(f),b=1;b<arguments.length;b++){var y=arguments[b];if(y!=null)for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(x[w]=y[w])}return x}l.assign=u},972:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.createTable=void 0;var f=u(744),p=u(260),m=u(324),h=u(796),v=u(356);function x(D,T){var C=new f.DocHandler(D),P=b(T,C.scaleFactor()),R=new p.Table(T,P);return(0,m.calculateWidths)(C,R),C.applyStyles(C.userStyles),R}l.createTable=x;function b(D,T){var C=D.content,P=E(C.columns);if(C.head.length===0){var R=w(P,"head");R&&C.head.push(R)}if(C.foot.length===0){var R=w(P,"foot");R&&C.foot.push(R)}var j=D.settings.theme,A=D.styles;return{columns:P,head:y("head",C.head,P,A,j,T),body:y("body",C.body,P,A,j,T),foot:y("foot",C.foot,P,A,j,T)}}function y(D,T,C,P,R,j){var A={},q=T.map(function(J,te){for(var z=0,B={},G=0,V=0,Z=0,he=C;Z<he.length;Z++){var k=he[Z];if(A[k.index]==null||A[k.index].left===0)if(V===0){var I=void 0;Array.isArray(J)?I=J[k.index-G-z]:I=J[k.dataKey];var M={};typeof I=="object"&&!Array.isArray(I)&&(M=(I==null?void 0:I.styles)||{});var L=O(D,k,te,R,P,j,M),H=new p.Cell(I,L,D);B[k.dataKey]=H,B[k.index]=H,V=H.colSpan-1,A[k.index]={left:H.rowSpan-1,times:V}}else V--,G++;else A[k.index].left--,V=A[k.index].times,z++}return new p.Row(J,te,D,B)});return q}function w(D,T){var C={};return D.forEach(function(P){if(P.raw!=null){var R=_(T,P.raw);R!=null&&(C[P.dataKey]=R)}}),Object.keys(C).length>0?C:null}function _(D,T){if(D==="head"){if(typeof T=="object")return T.header||T.title||null;if(typeof T=="string"||typeof T=="number")return T}else if(D==="foot"&&typeof T=="object")return T.footer;return null}function E(D){return D.map(function(T,C){var P,R,j;return typeof T=="object"?j=(R=(P=T.dataKey)!==null&&P!==void 0?P:T.key)!==null&&R!==void 0?R:C:j=C,new p.Column(j,T,C)})}function O(D,T,C,P,R,j,A){var q=(0,h.getTheme)(P),J;D==="head"?J=R.headStyles:D==="body"?J=R.bodyStyles:D==="foot"&&(J=R.footStyles);var te=(0,v.assign)({},q.table,q[D],R.styles,J),z=R.columnStyles[T.dataKey]||R.columnStyles[T.index]||{},B=D==="body"?z:{},G=D==="body"&&C%2===0?(0,v.assign)({},q.alternateRow,R.alternateRowStyles):{},V=(0,h.defaultStyles)(j),Z=(0,v.assign)({},V,te,G,B);return(0,v.assign)(Z,A)}},664:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.addPage=l.drawTable=void 0;var f=u(420),p=u(260),m=u(744),h=u(356),v=u(136),x=u(224);function b(z,B){var G=B.settings,V=G.startY,Z=G.margin,he={x:Z.left,y:V},k=B.getHeadHeight(B.columns)+B.getFootHeight(B.columns),I=V+Z.bottom+k;if(G.pageBreak==="avoid"){var M=B.body,L=M.reduce(function(fe,de){return fe+de.height},0);I+=L}var H=new m.DocHandler(z);(G.pageBreak==="always"||G.startY!=null&&I>H.pageSize().height)&&(te(H),he.y=Z.top),B.callWillDrawPageHooks(H,he);var se=(0,h.assign)({},he);B.startPageNumber=H.pageNumber(),G.horizontalPageBreak?y(H,B,se,he):(H.applyStyles(H.userStyles),(G.showHead==="firstPage"||G.showHead==="everyPage")&&B.head.forEach(function(fe){return R(H,B,fe,he,B.columns)}),H.applyStyles(H.userStyles),B.body.forEach(function(fe,de){var ve=de===B.body.length-1;P(H,B,fe,ve,se,he,B.columns)}),H.applyStyles(H.userStyles),(G.showFoot==="lastPage"||G.showFoot==="everyPage")&&B.foot.forEach(function(fe){return R(H,B,fe,he,B.columns)})),(0,f.addTableBorder)(H,B,se,he),B.callEndPageHooks(H,he),B.finalY=he.y,z.lastAutoTable=B,z.previousAutoTable=B,z.autoTable&&(z.autoTable.previous=B),H.applyStyles(H.userStyles)}l.drawTable=b;function y(z,B,G,V){var Z=(0,x.calculateAllColumnsCanFitInPage)(z,B),he=B.settings;if(he.horizontalPageBreakBehaviour==="afterAllRows")Z.forEach(function(L,H){z.applyStyles(z.userStyles),H>0?J(z,B,G,V,L.columns,!0):w(z,B,V,L.columns),_(z,B,G,V,L.columns),O(z,B,V,L.columns)});else for(var k=-1,I=Z[0],M=function(){var L=k;if(I){z.applyStyles(z.userStyles);var H=I.columns;k>=0?J(z,B,G,V,H,!0):w(z,B,V,H),L=E(z,B,k+1,V,H),O(z,B,V,H)}var se=L-k;Z.slice(1).forEach(function(fe){z.applyStyles(z.userStyles),J(z,B,G,V,fe.columns,!0),E(z,B,k+1,V,fe.columns,se),O(z,B,V,fe.columns)}),k=L};k<B.body.length-1;)M()}function w(z,B,G,V){var Z=B.settings;z.applyStyles(z.userStyles),(Z.showHead==="firstPage"||Z.showHead==="everyPage")&&B.head.forEach(function(he){return R(z,B,he,G,V)})}function _(z,B,G,V,Z){z.applyStyles(z.userStyles),B.body.forEach(function(he,k){var I=k===B.body.length-1;P(z,B,he,I,G,V,Z)})}function E(z,B,G,V,Z,he){z.applyStyles(z.userStyles),he=he??B.body.length;var k=Math.min(G+he,B.body.length),I=-1;return B.body.slice(G,k).forEach(function(M,L){var H=G+L===B.body.length-1,se=q(z,B,H,V);M.canEntireRowFit(se,Z)&&(R(z,B,M,V,Z),I=G+L)}),I}function O(z,B,G,V){var Z=B.settings;z.applyStyles(z.userStyles),(Z.showFoot==="lastPage"||Z.showFoot==="everyPage")&&B.foot.forEach(function(he){return R(z,B,he,G,V)})}function D(z,B,G){var V=G.getLineHeight(z.styles.fontSize),Z=z.padding("vertical"),he=Math.floor((B-Z)/V);return Math.max(0,he)}function T(z,B,G,V){var Z={};z.spansMultiplePages=!0,z.height=0;for(var he=0,k=0,I=G.columns;k<I.length;k++){var M=I[k],L=z.cells[M.index];if(L){Array.isArray(L.text)||(L.text=[L.text]);var H=new p.Cell(L.raw,L.styles,L.section);H=(0,h.assign)(H,L),H.text=[];var se=D(L,B,V);L.text.length>se&&(H.text=L.text.splice(se,L.text.length));var fe=V.scaleFactor(),de=V.getLineHeightFactor();L.contentHeight=L.getContentHeight(fe,de),L.contentHeight>=B&&(L.contentHeight=B,H.styles.minCellHeight-=B),L.contentHeight>z.height&&(z.height=L.contentHeight),H.contentHeight=H.getContentHeight(fe,de),H.contentHeight>he&&(he=H.contentHeight),Z[M.index]=H}}var ve=new p.Row(z.raw,-1,z.section,Z,!0);ve.height=he;for(var Ee=0,Oe=G.columns;Ee<Oe.length;Ee++){var M=Oe[Ee],H=ve.cells[M.index];H&&(H.height=ve.height);var L=z.cells[M.index];L&&(L.height=z.height)}return ve}function C(z,B,G,V){var Z=z.pageSize().height,he=V.settings.margin,k=he.top+he.bottom,I=Z-k;B.section==="body"&&(I-=V.getHeadHeight(V.columns)+V.getFootHeight(V.columns));var M=B.getMinimumRowHeight(V.columns,z),L=M<G;if(M>I)return console.error("Will not be able to print row ".concat(B.index," correctly since it's minimum height is larger than page height")),!0;if(!L)return!1;var H=B.hasRowSpan(V.columns),se=B.getMaxCellHeight(V.columns)>I;return se?(H&&console.error("The content of row ".concat(B.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(H||V.settings.rowPageBreak==="avoid")}function P(z,B,G,V,Z,he,k){var I=q(z,B,V,he);if(G.canEntireRowFit(I,k))R(z,B,G,he,k);else if(C(z,G,I,B)){var M=T(G,I,B,z);R(z,B,G,he,k),J(z,B,Z,he,k),P(z,B,M,V,Z,he,k)}else J(z,B,Z,he,k),P(z,B,G,V,Z,he,k)}function R(z,B,G,V,Z){V.x=B.settings.margin.left;for(var he=0,k=Z;he<k.length;he++){var I=k[he],M=G.cells[I.index];if(!M){V.x+=I.width;continue}z.applyStyles(M.styles),M.x=V.x,M.y=V.y;var L=B.callCellHooks(z,B.hooks.willDrawCell,M,G,I,V);if(L===!1){V.x+=I.width;continue}j(z,M,V);var H=M.getTextPos();(0,v.default)(M.text,H.x,H.y,{halign:M.styles.halign,valign:M.styles.valign,maxWidth:Math.ceil(M.width-M.padding("left")-M.padding("right"))},z.getDocument()),B.callCellHooks(z,B.hooks.didDrawCell,M,G,I,V),V.x+=I.width}V.y+=G.height}function j(z,B,G){var V=B.styles;if(z.getDocument().setFillColor(z.getDocument().getFillColor()),typeof V.lineWidth=="number"){var Z=(0,f.getFillStyle)(V.lineWidth,V.fillColor);Z&&z.rect(B.x,G.y,B.width,B.height,Z)}else typeof V.lineWidth=="object"&&(V.fillColor&&z.rect(B.x,G.y,B.width,B.height,"F"),A(z,B,G,V.lineWidth))}function A(z,B,G,V){var Z,he,k,I;V.top&&(Z=G.x,he=G.y,k=G.x+B.width,I=G.y,V.right&&(k+=.5*V.right),V.left&&(Z-=.5*V.left),M(V.top,Z,he,k,I)),V.bottom&&(Z=G.x,he=G.y+B.height,k=G.x+B.width,I=G.y+B.height,V.right&&(k+=.5*V.right),V.left&&(Z-=.5*V.left),M(V.bottom,Z,he,k,I)),V.left&&(Z=G.x,he=G.y,k=G.x,I=G.y+B.height,V.top&&(he-=.5*V.top),V.bottom&&(I+=.5*V.bottom),M(V.left,Z,he,k,I)),V.right&&(Z=G.x+B.width,he=G.y,k=G.x+B.width,I=G.y+B.height,V.top&&(he-=.5*V.top),V.bottom&&(I+=.5*V.bottom),M(V.right,Z,he,k,I));function M(L,H,se,fe,de){z.getDocument().setLineWidth(L),z.getDocument().line(H,se,fe,de,"S")}}function q(z,B,G,V){var Z=B.settings.margin.bottom,he=B.settings.showFoot;return(he==="everyPage"||he==="lastPage"&&G)&&(Z+=B.getFootHeight(B.columns)),z.pageSize().height-V.y-Z}function J(z,B,G,V,Z,he){Z===void 0&&(Z=[]),he===void 0&&(he=!1),z.applyStyles(z.userStyles),B.settings.showFoot==="everyPage"&&!he&&B.foot.forEach(function(I){return R(z,B,I,V,Z)}),B.callEndPageHooks(z,V);var k=B.settings.margin;(0,f.addTableBorder)(z,B,G,V),te(z),B.pageNumber++,B.pageCount++,V.x=k.left,V.y=k.top,G.y=k.top,B.callWillDrawPageHooks(z,V),B.settings.showHead==="everyPage"&&(B.head.forEach(function(I){return R(z,B,I,V,Z)}),z.applyStyles(z.userStyles))}l.addPage=J;function te(z){var B=z.pageNumber();z.setPage(B+1);var G=z.pageNumber();return G===B?(z.addPage(),!0):!1}},224:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.calculateAllColumnsCanFitInPage=void 0;var f=u(420);function p(h,v,x){var b;x===void 0&&(x={});var y=(0,f.getPageAvailableWidth)(h,v),w=new Map,_=[],E=[],O=[];v.settings.horizontalPageBreakRepeat,Array.isArray(v.settings.horizontalPageBreakRepeat)?O=v.settings.horizontalPageBreakRepeat:(typeof v.settings.horizontalPageBreakRepeat=="string"||typeof v.settings.horizontalPageBreakRepeat=="number")&&(O=[v.settings.horizontalPageBreakRepeat]),O.forEach(function(P){var R=v.columns.find(function(j){return j.dataKey===P||j.index===P});R&&!w.has(R.index)&&(w.set(R.index,!0),_.push(R.index),E.push(v.columns[R.index]),y-=R.wrappedWidth)});for(var D=!0,T=(b=x==null?void 0:x.start)!==null&&b!==void 0?b:0;T<v.columns.length;){if(w.has(T)){T++;continue}var C=v.columns[T].wrappedWidth;if(D||y>=C)D=!1,_.push(T),E.push(v.columns[T]),y-=C;else break;T++}return{colIndexes:_,columns:E,lastIndex:T-1}}function m(h,v){for(var x=[],b=0;b<v.columns.length;b++){var y=p(h,v,{start:b});y.columns.length&&(x.push(y),b=y.lastIndex)}return x}l.calculateAllColumnsCanFitInPage=m},324:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.ellipsize=l.resizeColumns=l.calculateWidths=void 0;var f=u(420);function p(_,E){m(_,E);var O=[],D=0;E.columns.forEach(function(C){var P=C.getMaxCustomCellWidth(E);P?C.width=P:(C.width=C.wrappedWidth,O.push(C)),D+=C.width});var T=E.getWidth(_.pageSize().width)-D;T&&(T=h(O,T,function(C){return Math.max(C.minReadableWidth,C.minWidth)})),T&&(T=h(O,T,function(C){return C.minWidth})),T=Math.abs(T),!E.settings.horizontalPageBreak&&T>.1/_.scaleFactor()&&(T=T<1?T:Math.round(T),console.warn("Of the table content, ".concat(T," units width could not fit page"))),x(E),b(E,_),v(E)}l.calculateWidths=p;function m(_,E){var O=_.scaleFactor(),D=E.settings.horizontalPageBreak,T=(0,f.getPageAvailableWidth)(_,E);E.allRows().forEach(function(C){for(var P=0,R=E.columns;P<R.length;P++){var j=R[P],A=C.cells[j.index];if(A){var q=E.hooks.didParseCell;E.callCellHooks(_,q,A,C,j,null);var J=A.padding("horizontal");A.contentWidth=(0,f.getStringWidth)(A.text,A.styles,_)+J;var te=(0,f.getStringWidth)(A.text.join(" ").split(/[^\S\u00A0]+/),A.styles,_);if(A.minReadableWidth=te+A.padding("horizontal"),typeof A.styles.cellWidth=="number")A.minWidth=A.styles.cellWidth,A.wrappedWidth=A.styles.cellWidth;else if(A.styles.cellWidth==="wrap"||D===!0)A.contentWidth>T?(A.minWidth=T,A.wrappedWidth=T):(A.minWidth=A.contentWidth,A.wrappedWidth=A.contentWidth);else{var z=10/O;A.minWidth=A.styles.minCellWidth||z,A.wrappedWidth=A.contentWidth,A.minWidth>A.wrappedWidth&&(A.wrappedWidth=A.minWidth)}}}}),E.allRows().forEach(function(C){for(var P=0,R=E.columns;P<R.length;P++){var j=R[P],A=C.cells[j.index];if(A&&A.colSpan===1)j.wrappedWidth=Math.max(j.wrappedWidth,A.wrappedWidth),j.minWidth=Math.max(j.minWidth,A.minWidth),j.minReadableWidth=Math.max(j.minReadableWidth,A.minReadableWidth);else{var q=E.styles.columnStyles[j.dataKey]||E.styles.columnStyles[j.index]||{},J=q.cellWidth||q.minCellWidth;J&&typeof J=="number"&&(j.minWidth=J,j.wrappedWidth=J)}A&&(A.colSpan>1&&!j.minWidth&&(j.minWidth=A.minWidth),A.colSpan>1&&!j.wrappedWidth&&(j.wrappedWidth=A.minWidth))}})}function h(_,E,O){for(var D=E,T=_.reduce(function(z,B){return z+B.wrappedWidth},0),C=0;C<_.length;C++){var P=_[C],R=P.wrappedWidth/T,j=D*R,A=P.width+j,q=O(P),J=A<q?q:A;E-=J-P.width,P.width=J}if(E=Math.round(E*1e10)/1e10,E){var te=_.filter(function(z){return E<0?z.width>O(z):!0});te.length&&(E=h(te,E,O))}return E}l.resizeColumns=h;function v(_){for(var E={},O=1,D=_.allRows(),T=0;T<D.length;T++)for(var C=D[T],P=0,R=_.columns;P<R.length;P++){var j=R[P],A=E[j.index];if(O>1)O--,delete C.cells[j.index];else if(A)A.cell.height+=C.height,O=A.cell.colSpan,delete C.cells[j.index],A.left--,A.left<=1&&delete E[j.index];else{var q=C.cells[j.index];if(!q)continue;if(q.height=C.height,q.rowSpan>1){var J=D.length-T,te=q.rowSpan>J?J:q.rowSpan;E[j.index]={cell:q,left:te,row:C}}}}}function x(_){for(var E=_.allRows(),O=0;O<E.length;O++)for(var D=E[O],T=null,C=0,P=0,R=0;R<_.columns.length;R++){var j=_.columns[R];if(P-=1,P>1&&_.columns[R+1])C+=j.width,delete D.cells[j.index];else if(T){var A=T;delete D.cells[j.index],T=null,A.width=j.width+C}else{var A=D.cells[j.index];if(!A)continue;if(P=A.colSpan,C=0,A.colSpan>1){T=A,C+=j.width;continue}A.width=j.width+C}}}function b(_,E){for(var O={count:0,height:0},D=0,T=_.allRows();D<T.length;D++){for(var C=T[D],P=0,R=_.columns;P<R.length;P++){var j=R[P],A=C.cells[j.index];if(A){E.applyStyles(A.styles,!0);var q=A.width-A.padding("horizontal");if(A.styles.overflow==="linebreak")A.text=E.splitTextToSize(A.text,q+1/E.scaleFactor(),{fontSize:A.styles.fontSize});else if(A.styles.overflow==="ellipsize")A.text=y(A.text,q,A.styles,E,"...");else if(A.styles.overflow==="hidden")A.text=y(A.text,q,A.styles,E,"");else if(typeof A.styles.overflow=="function"){var J=A.styles.overflow(A.text,q);typeof J=="string"?A.text=[J]:A.text=J}A.contentHeight=A.getContentHeight(E.scaleFactor(),E.getLineHeightFactor());var te=A.contentHeight/A.rowSpan;A.rowSpan>1&&O.count*O.height<te*A.rowSpan?O={height:te,count:A.rowSpan}:O&&O.count>0&&O.height>te&&(te=O.height),te>C.height&&(C.height=te)}}O.count--}}function y(_,E,O,D,T){return _.map(function(C){return w(C,E,O,D,T)})}l.ellipsize=y;function w(_,E,O,D,T){var C=1e4*D.scaleFactor();if(E=Math.ceil(E*C)/C,E>=(0,f.getStringWidth)(_,O,D))return _;for(;E<(0,f.getStringWidth)(_+T,O,D)&&!(_.length<=1);)_=_.substring(0,_.length-1);return _.trim()+T}},964:function(o){if(typeof r>"u"){var l=new Error("Cannot find module 'undefined'");throw l.code="MODULE_NOT_FOUND",l}o.exports=r}},i={};function s(o){var l=i[o];if(l!==void 0)return l.exports;var u=i[o]={exports:{}};return n[o].call(u.exports,u,u.exports,s),u.exports}var a={};return function(){var o=a;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var l=s(340),u=s(776),f=s(664),p=s(972),m=s(260);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return m.Table}});var h=s(172);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return h.CellHookData}});var v=s(260);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return v.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return v.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return v.Row}});function x(E){(0,l.default)(E)}o.applyPlugin=x;function b(E,O){var D=(0,u.parseInput)(E,O),T=(0,p.createTable)(E,D);(0,f.drawTable)(E,T)}function y(E,O){var D=(0,u.parseInput)(E,O);return(0,p.createTable)(E,D)}o.__createTable=y;function w(E,O){(0,f.drawTable)(E,O)}o.__drawTable=w;try{var _=s(964);_.jsPDF&&(_=_.jsPDF),x(_)}catch{}o.default=b}(),a}()})})(B_);var d7=B_.exports;const mf=Xg(d7);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $0={};$0.version="0.18.5";var U_=1252,h7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],z_=function(e){h7.indexOf(e)!=-1&&(U_=e)};function p7(){z_(1252)}var cd=function(e){z_(e)};function m7(){cd(1200),p7()}var qh=function(t){return String.fromCharCode(t)},l5=function(t){return String.fromCharCode(t)},c5,uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ud(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),a=(r&3)<<4|n>>4,i=e.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=uo.charAt(s)+uo.charAt(a)+uo.charAt(o)+uo.charAt(l);return t}function Ta(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=uo.indexOf(e.charAt(u++)),a=uo.indexOf(e.charAt(u++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=uo.indexOf(e.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=uo.indexOf(e.charAt(u++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function El(e){return Vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function u5(e){return Vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ks=function(t){return Vt?Pa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Dp(e){if(typeof ArrayBuffer>"u")return ks(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ed(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function g7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Sn=Vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Pa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function x7(e){for(var t=[],r=0,n=e.length+250,i=El(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=El(65535),n=65530)}return t.push(i.slice(0,r)),Sn(t)}var Of=/\u0000/g,Vh=/[\u0001-\u0006]/g;function Hc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Es(e,t){var r=""+e;return r.length>=t?r:Lr("0",t-r.length)+r}function sx(e,t){var r=""+e;return r.length>=t?r:Lr(" ",t-r.length)+r}function q0(e,t){var r=""+e;return r.length>=t?r:r+Lr(" ",t-r.length)}function v7(e,t){var r=""+Math.round(e);return r.length>=t?r:Lr("0",t-r.length)+r}function y7(e,t){var r=""+e;return r.length>=t?r:Lr("0",t-r.length)+r}var f5=Math.pow(2,32);function mc(e,t){if(e>f5||e<-f5)return v7(e,t);var r=Math.round(e);return y7(r,t)}function V0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var d5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],g1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function w7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Fr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},h5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},b7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function G0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,u=0,f=0,p=Math.floor(i);u<t&&(p=Math.floor(i),o=p*a+s,f=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Gh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=T7(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var W_=new Date(1899,11,31,0,0,0),_7=W_.getTime(),S7=new Date(1900,2,1,0,0,0);function H_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=S7&&(r+=24*60*60*1e3),(r-(_7+(e.getTimezoneOffset()-W_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ax(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function N7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function k7(e){var t=e<0?12:11,r=ax(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function E7(e){var t=ax(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function A7(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=k7(e):t===10?r=e.toFixed(10).substr(0,12):r=E7(e),ax(N7(r.toUpperCase()))}function Vg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):A7(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Po(14,H_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function T7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function j7(e,t,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return g1[r.m-1][1];case 5:return g1[r.m-1][0];default:return g1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return d5[r.q][0];default:return d5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Es(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Es(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?Es(l,u):"";return f}function fo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var $_=/%/g;function C7(e,t,r){var n=t.replace($_,""),i=t.length-n.length;return wa(e,n,r*Math.pow(10,2*i))+Lr("%",i)}function P7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function q_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+q_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var V_=/# (\?+)( ?)\/( ?)(\d+)/;function L7(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Lr(" ",e[1].length+1+e[4].length):sx(a,e[1].length)+e[2]+"/"+e[3]+Es(o,e[4].length))}function F7(e,t,r){return r+(t===0?"":""+t)+Lr(" ",e[1].length+2+e[4].length)}var G_=/^#*0*\.([0#]+)/,Y_=/\).*[0#]/,K_=/\(###\) ###\\?-####/;function Yn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function p5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function m5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function O7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function D7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Xi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Y_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xi("n",n,r):"("+Xi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return P7(e,t,r);if(t.indexOf("%")!==-1)return C7(e,t,r);if(t.indexOf("E")!==-1)return q_(t,r);if(t.charCodeAt(0)===36)return"$"+Xi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+mc(l,t.length);if(t.match(/^[#?]+$/))return i=mc(r,0),i==="0"&&(i=""),i.length>t.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(V_))return L7(s,l,u);if(t.match(/^#+0+$/))return u+mc(l,t.length-t.indexOf("0"));if(s=t.match(G_))return i=p5(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Yn(s[1])).replace(/\.$/,"."+Yn(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Lr("0",Yn(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+p5(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+fo(mc(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xi(e,t,-r):fo(""+(Math.floor(r)+O7(r,s[1].length)))+"."+Es(m5(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Xi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Hc(Xi(e,t.replace(/[\\-]/g,""),r)),a=0,Hc(Hc(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(K_))return i=Xi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=G0(l,Math.pow(10,a)-1,!1),i=""+u,f=wa("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=q0(o[2],a),f.length<s[4].length&&(f=Yn(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=G0(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sx(o[1],a)+s[2]+"/"+s[3]+q0(o[2],a):Lr(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=mc(r,0),t.length<=i.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=t.indexOf(".")-a,m=t.length-i.length-p;return Yn(t.substr(0,p)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=m5(r,s[1].length),r<0?"-"+Xi(e,t,-r):fo(D7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Es(0,3-v.length):"")+v})+"."+Es(a,s[1].length);switch(t){case"###,##0.00":return Xi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=fo(mc(l,0));return h!=="0"?u+h:"";case"###,###.00":return Xi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Xi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function I7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function R7(e,t,r){var n=t.replace($_,""),i=t.length-n.length;return wa(e,n,r*Math.pow(10,2*i))+Lr("%",i)}function X_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+X_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Hs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Y_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hs("n",n,r):"("+Hs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return I7(e,t,r);if(t.indexOf("%")!==-1)return R7(e,t,r);if(t.indexOf("E")!==-1)return X_(t,r);if(t.charCodeAt(0)===36)return"$"+Hs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Es(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(V_))return F7(s,l,u);if(t.match(/^#+0+$/))return u+Es(l,t.length-t.indexOf("0"));if(s=t.match(G_))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Yn(s[1])).replace(/\.$/,"."+Yn(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Lr("0",Yn(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+fo(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hs(e,t,-r):fo(""+r)+"."+Lr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Hs(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Hc(Hs(e,t.replace(/[\\-]/g,""),r)),a=0,Hc(Hc(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(K_))return i=Hs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=G0(l,Math.pow(10,a)-1,!1),i=""+u,f=wa("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=q0(o[2],a),f.length<s[4].length&&(f=Yn(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=G0(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sx(o[1],a)+s[2]+"/"+s[3]+q0(o[2],a):Lr(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=t.indexOf(".")-a,m=t.length-i.length-p;return Yn(t.substr(0,p)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Hs(e,t,-r):fo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Es(0,3-v.length):"")+v})+"."+Es(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=fo(""+l);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Hs(e,t.slice(0,t.lastIndexOf(".")),r)+Yn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wa(e,t,r){return(r|0)===r?Hs(e,t,r):Xi(e,t,r)}function M7(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var J_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Q_(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":V0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(J_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function B7(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,p,m="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!V0(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var h=e.charAt(++a),v=h==="("||h===")"?h:"t";i[i.length]={t:v,v:h},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(u==null&&(u=Gh(t,r,e.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Gh(t,r),u==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Gh(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",m="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,m="h"):e.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,m="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(J_)){if(u==null&&(u=Gh(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Q_(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var b=0,y=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",b<1&&(b=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[a].v.match(/[Hh]/)&&(b=1),b<2&&i[a].v.match(/[Mm]/)&&(b=2),b<3&&i[a].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",E;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=j7(i[a].t.charCodeAt(0),i[a].v,u,y),i[a].t="t";break;case"n":case"?":for(E=a+1;i[E]!=null&&((o=i[E].t)==="?"||o==="D"||(o===" "||o==="t")&&i[E+1]!=null&&(i[E+1].t==="?"||i[E+1].t==="t"&&i[E+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[E].v==="/"||i[E].v===" "&&i[E+1]!=null&&i[E+1].t=="?"));)i[a].v+=i[E].v,i[E]={v:"",t:";"},++E;_+=i[a].v,a=E-1;break;case"G":i[a].t="t",i[a].v=Vg(t,r);break}var O="",D,T;if(_.length>0){_.charCodeAt(0)==40?(D=t<0&&_.charCodeAt(0)===45?-t:t,T=wa("n",_,D)):(D=t<0&&n>1?-t:t,T=wa("n",_,D),D<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),E=T.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var P=i.length;if(C===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(E>=i[a].v.length-1?(E-=i[a].v.length,i[a].v=T.substr(E+1,i[a].v.length)):E<0?i[a].v="":(i[a].v=T.substr(0,E+1),E=-1),i[a].t="t",P=a);E>=0&&P<i.length&&(i[P].v=T.substr(0,E+1)+i[P].v)}else if(C!==i.length&&T.indexOf("E")===-1){for(E=T.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,O=i[a].v.substr(f+1);f>=0;--f)E>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(O=T.charAt(E--)+O);i[a].v=O,i[a].t="t",P=a}for(E>=0&&P<i.length&&(i[P].v=T.substr(0,E+1)+i[P].v),E=T.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(f=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,O=i[a].v.substr(0,f);f<i[a].v.length;++f)E<T.length&&(O+=T.charAt(E++));i[a].v=O,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(D=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=wa(i[a].t,i[a].v,D),i[a].t="t");var R="";for(a=0;a!==i.length;++a)i[a]!=null&&(R+=i[a].v);return R}var g5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function x5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function U7(e,t){var r=M7(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(g5),o=r[1].match(g5);return x5(t,a)?[n,r[0]]:x5(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Po(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Fr)[e],n==null&&(n=r.table&&r.table[h5[e]]||Fr[h5[e]]),n==null&&(n=b7[e]||"General");break}if(V0(n,0))return Vg(t,r);t instanceof Date&&(t=H_(t,r.date1904));var i=U7(n,t);if(V0(i[1]))return Vg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return B7(i[1],t,r,i[0])}function Z_(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Fr[r]==null){t<0&&(t=r);continue}if(Fr[r]==e){t=r;break}}t<0&&(t=391)}return Fr[t]=e,t}function Ip(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Z_(e[t],t)}function Rp(){Fr=w7()}var e3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function z7(e){var t=typeof e=="number"?Fr[e]:e;return t=t.replace(e3,"(\\d+)"),new RegExp("^"+t+"$")}function W7(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(e3)||[]).forEach(function(p,m){var h=parseInt(r[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":a=h;break;case"s":l=h;break;case"m":a>=0?o=h:i=h;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var H7=function(){var e={};e.version="1.2.0";function t(){for(var T=0,C=new Array(256),P=0;P!=256;++P)T=P,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,C[P]=T;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(T){var C=0,P=0,R=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)j[R]=T[R];for(R=0;R!=256;++R)for(P=T[R],C=256+R;C<4096;C+=256)P=j[C]=P>>>8^T[P&255];var A=[];for(R=1;R!=16;++R)A[R-1]=typeof Int32Array<"u"?j.subarray(R*256,R*256+256):j.slice(R*256,R*256+256);return A}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],p=i[6],m=i[7],h=i[8],v=i[9],x=i[10],b=i[11],y=i[12],w=i[13],_=i[14];function E(T,C){for(var P=C^-1,R=0,j=T.length;R<j;)P=P>>>8^r[(P^T.charCodeAt(R++))&255];return~P}function O(T,C){for(var P=C^-1,R=T.length-15,j=0;j<R;)P=_[T[j++]^P&255]^w[T[j++]^P>>8&255]^y[T[j++]^P>>16&255]^b[T[j++]^P>>>24]^x[T[j++]]^v[T[j++]]^h[T[j++]]^m[T[j++]]^p[T[j++]]^f[T[j++]]^u[T[j++]]^l[T[j++]]^o[T[j++]]^a[T[j++]]^s[T[j++]]^r[T[j++]];for(R+=15;j<R;)P=P>>>8^r[(P^T[j++])&255];return~P}function D(T,C){for(var P=C^-1,R=0,j=T.length,A=0,q=0;R<j;)A=T.charCodeAt(R++),A<128?P=P>>>8^r[(P^A)&255]:A<2048?(P=P>>>8^r[(P^(192|A>>6&31))&255],P=P>>>8^r[(P^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,q=T.charCodeAt(R++)&1023,P=P>>>8^r[(P^(240|A>>8&7))&255],P=P>>>8^r[(P^(128|A>>2&63))&255],P=P>>>8^r[(P^(128|q>>6&15|(A&3)<<4))&255],P=P>>>8^r[(P^(128|q&63))&255]):(P=P>>>8^r[(P^(224|A>>12&15))&255],P=P>>>8^r[(P^(128|A>>6&63))&255],P=P>>>8^r[(P^(128|A&63))&255]);return~P}return e.table=r,e.bstr=E,e.buf=O,e.str=D,e}(),or=function(){var t={};t.version="1.2.1";function r(K,oe){for(var re=K.split("/"),ne=oe.split("/"),ae=0,le=0,Se=Math.min(re.length,ne.length);ae<Se;++ae){if(le=re[ae].length-ne[ae].length)return le;if(re[ae]!=ne[ae])return re[ae]<ne[ae]?-1:1}return re.length-ne.length}function n(K){if(K.charAt(K.length-1)=="/")return K.slice(0,-1).indexOf("/")===-1?K:n(K.slice(0,-1));var oe=K.lastIndexOf("/");return oe===-1?K:K.slice(0,oe+1)}function i(K){if(K.charAt(K.length-1)=="/")return i(K.slice(0,-1));var oe=K.lastIndexOf("/");return oe===-1?K:K.slice(oe+1)}function s(K,oe){typeof oe=="string"&&(oe=new Date(oe));var re=oe.getHours();re=re<<6|oe.getMinutes(),re=re<<5|oe.getSeconds()>>>1,K.write_shift(2,re);var ne=oe.getFullYear()-1980;ne=ne<<4|oe.getMonth()+1,ne=ne<<5|oe.getDate(),K.write_shift(2,ne)}function a(K){var oe=K.read_shift(2)&65535,re=K.read_shift(2)&65535,ne=new Date,ae=re&31;re>>>=5;var le=re&15;re>>>=4,ne.setMilliseconds(0),ne.setFullYear(re+1980),ne.setMonth(le-1),ne.setDate(ae);var Se=oe&31;oe>>>=5;var Ce=oe&63;return oe>>>=6,ne.setHours(oe),ne.setMinutes(Ce),ne.setSeconds(Se<<1),ne}function o(K){ji(K,0);for(var oe={},re=0;K.l<=K.length-4;){var ne=K.read_shift(2),ae=K.read_shift(2),le=K.l+ae,Se={};switch(ne){case 21589:re=K.read_shift(1),re&1&&(Se.mtime=K.read_shift(4)),ae>5&&(re&2&&(Se.atime=K.read_shift(4)),re&4&&(Se.ctime=K.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}K.l=le,oe[ne]=Se}return oe}var l;function u(){return l||(l={})}function f(K,oe){if(K[0]==80&&K[1]==75)return gr(K,oe);if((K[0]|32)==109&&(K[1]|32)==105)return Wi(K,oe);if(K.length<512)throw new Error("CFB file size "+K.length+" < 512");var re=3,ne=512,ae=0,le=0,Se=0,Ce=0,_e=0,Ae=[],Te=K.slice(0,512);ji(Te,0);var He=p(Te);switch(re=He[0],re){case 3:ne=512;break;case 4:ne=4096;break;case 0:if(He[1]==0)return gr(K,oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+re)}ne!==512&&(Te=K.slice(0,ne),ji(Te,28));var Ke=K.slice(0,ne);m(Te,re);var st=Te.read_shift(4,"i");if(re===3&&st!==0)throw new Error("# Directory Sectors: Expected 0 saw "+st);Te.l+=4,Se=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Ce=Te.read_shift(4,"i"),ae=Te.read_shift(4,"i"),_e=Te.read_shift(4,"i"),le=Te.read_shift(4,"i");for(var Ve=-1,it=0;it<109&&(Ve=Te.read_shift(4,"i"),!(Ve<0));++it)Ae[it]=Ve;var wt=h(K,ne);b(_e,le,wt,ne,Ae);var Yt=w(wt,Se,Ae,ne);Yt[Se].name="!Directory",ae>0&&Ce!==q&&(Yt[Ce].name="!MiniFAT"),Yt[Ae[0]].name="!FAT",Yt.fat_addrs=Ae,Yt.ssz=ne;var sr={},Hr=[],os=[],na=[];_(Se,Yt,wt,Hr,ae,sr,os,Ce),v(os,na,Hr),Hr.shift();var Os={FileIndex:os,FullPaths:na};return oe&&oe.raw&&(Os.raw={header:Ke,sectors:wt}),Os}function p(K){if(K[K.l]==80&&K[K.l+1]==75)return[0,0];K.chk(J,"Header Signature: "),K.l+=16;var oe=K.read_shift(2,"u");return[K.read_shift(2,"u"),oe]}function m(K,oe){var re=9;switch(K.l+=2,re=K.read_shift(2)){case 9:if(oe!=3)throw new Error("Sector Shift: Expected 9 saw "+re);break;case 12:if(oe!=4)throw new Error("Sector Shift: Expected 12 saw "+re);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+re)}K.chk("0600","Mini Sector Shift: "),K.chk("000000000000","Reserved: ")}function h(K,oe){for(var re=Math.ceil(K.length/oe)-1,ne=[],ae=1;ae<re;++ae)ne[ae-1]=K.slice(ae*oe,(ae+1)*oe);return ne[re-1]=K.slice(re*oe),ne}function v(K,oe,re){for(var ne=0,ae=0,le=0,Se=0,Ce=0,_e=re.length,Ae=[],Te=[];ne<_e;++ne)Ae[ne]=Te[ne]=ne,oe[ne]=re[ne];for(;Ce<Te.length;++Ce)ne=Te[Ce],ae=K[ne].L,le=K[ne].R,Se=K[ne].C,Ae[ne]===ne&&(ae!==-1&&Ae[ae]!==ae&&(Ae[ne]=Ae[ae]),le!==-1&&Ae[le]!==le&&(Ae[ne]=Ae[le])),Se!==-1&&(Ae[Se]=ne),ae!==-1&&ne!=Ae[ne]&&(Ae[ae]=Ae[ne],Te.lastIndexOf(ae)<Ce&&Te.push(ae)),le!==-1&&ne!=Ae[ne]&&(Ae[le]=Ae[ne],Te.lastIndexOf(le)<Ce&&Te.push(le));for(ne=1;ne<_e;++ne)Ae[ne]===ne&&(le!==-1&&Ae[le]!==le?Ae[ne]=Ae[le]:ae!==-1&&Ae[ae]!==ae&&(Ae[ne]=Ae[ae]));for(ne=1;ne<_e;++ne)if(K[ne].type!==0){if(Ce=ne,Ce!=Ae[Ce])do Ce=Ae[Ce],oe[ne]=oe[Ce]+"/"+oe[ne];while(Ce!==0&&Ae[Ce]!==-1&&Ce!=Ae[Ce]);Ae[ne]=-1}for(oe[0]+="/",ne=1;ne<_e;++ne)K[ne].type!==2&&(oe[ne]+="/")}function x(K,oe,re){for(var ne=K.start,ae=K.size,le=[],Se=ne;re&&ae>0&&Se>=0;)le.push(oe.slice(Se*A,Se*A+A)),ae-=A,Se=sl(re,Se*4);return le.length===0?Fe(0):Sn(le).slice(0,K.size)}function b(K,oe,re,ne,ae){var le=q;if(K===q){if(oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(K!==-1){var Se=re[K],Ce=(ne>>>2)-1;if(!Se)return;for(var _e=0;_e<Ce&&(le=sl(Se,_e*4))!==q;++_e)ae.push(le);b(sl(Se,ne-4),oe-1,re,ne,ae)}}function y(K,oe,re,ne,ae){var le=[],Se=[];ae||(ae=[]);var Ce=ne-1,_e=0,Ae=0;for(_e=oe;_e>=0;){ae[_e]=!0,le[le.length]=_e,Se.push(K[_e]);var Te=re[Math.floor(_e*4/ne)];if(Ae=_e*4&Ce,ne<4+Ae)throw new Error("FAT boundary crossed: "+_e+" 4 "+ne);if(!K[Te])break;_e=sl(K[Te],Ae)}return{nodes:le,data:k5([Se])}}function w(K,oe,re,ne){var ae=K.length,le=[],Se=[],Ce=[],_e=[],Ae=ne-1,Te=0,He=0,Ke=0,st=0;for(Te=0;Te<ae;++Te)if(Ce=[],Ke=Te+oe,Ke>=ae&&(Ke-=ae),!Se[Ke]){_e=[];var Ve=[];for(He=Ke;He>=0;){Ve[He]=!0,Se[He]=!0,Ce[Ce.length]=He,_e.push(K[He]);var it=re[Math.floor(He*4/ne)];if(st=He*4&Ae,ne<4+st)throw new Error("FAT boundary crossed: "+He+" 4 "+ne);if(!K[it]||(He=sl(K[it],st),Ve[He]))break}le[Ke]={nodes:Ce,data:k5([_e])}}return le}function _(K,oe,re,ne,ae,le,Se,Ce){for(var _e=0,Ae=ne.length?2:0,Te=oe[K].data,He=0,Ke=0,st;He<Te.length;He+=128){var Ve=Te.slice(He,He+128);ji(Ve,64),Ke=Ve.read_shift(2),st=fx(Ve,0,Ke-Ae),ne.push(st);var it={name:st,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},wt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);wt!==0&&(it.ct=E(Ve,Ve.l-8));var Yt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Yt!==0&&(it.mt=E(Ve,Ve.l-8)),it.start=Ve.read_shift(4,"i"),it.size=Ve.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=q,it.name=""),it.type===5?(_e=it.start,ae>0&&_e!==q&&(oe[_e].name="!StreamData")):it.size>=4096?(it.storage="fat",oe[it.start]===void 0&&(oe[it.start]=y(re,it.start,oe.fat_addrs,oe.ssz)),oe[it.start].name=it.name,it.content=oe[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:_e!==q&&it.start!==q&&oe[_e]&&(it.content=x(it,oe[_e].data,(oe[Ce]||{}).data))),it.content&&ji(it.content,0),le[st]=it,Se.push(it)}}function E(K,oe){return new Date((Pi(K,oe+4)/1e7*Math.pow(2,32)+Pi(K,oe)/1e7-11644473600)*1e3)}function O(K,oe){return u(),f(l.readFileSync(K),oe)}function D(K,oe){var re=oe&&oe.type;switch(re||Vt&&Buffer.isBuffer(K)&&(re="buffer"),re||"base64"){case"file":return O(K,oe);case"base64":return f(ks(Ta(K)),oe);case"binary":return f(ks(K),oe)}return f(K,oe)}function T(K,oe){var re=oe||{},ne=re.root||"Root Entry";if(K.FullPaths||(K.FullPaths=[]),K.FileIndex||(K.FileIndex=[]),K.FullPaths.length!==K.FileIndex.length)throw new Error("inconsistent CFB structure");K.FullPaths.length===0&&(K.FullPaths[0]=ne+"/",K.FileIndex[0]={name:ne,type:5}),re.CLSID&&(K.FileIndex[0].clsid=re.CLSID),C(K)}function C(K){var oe="Sh33tJ5";if(!or.find(K,"/"+oe)){var re=Fe(4);re[0]=55,re[1]=re[3]=50,re[2]=54,K.FileIndex.push({name:oe,type:2,content:re,size:4,L:69,R:69,C:69}),K.FullPaths.push(K.FullPaths[0]+oe),P(K)}}function P(K,oe){T(K);for(var re=!1,ne=!1,ae=K.FullPaths.length-1;ae>=0;--ae){var le=K.FileIndex[ae];switch(le.type){case 0:ne?re=!0:(K.FileIndex.pop(),K.FullPaths.pop());break;case 1:case 2:case 5:ne=!0,isNaN(le.R*le.L*le.C)&&(re=!0),le.R>-1&&le.L>-1&&le.R==le.L&&(re=!0);break;default:re=!0;break}}if(!(!re&&!oe)){var Se=new Date(1987,1,19),Ce=0,_e=Object.create?Object.create(null):{},Ae=[];for(ae=0;ae<K.FullPaths.length;++ae)_e[K.FullPaths[ae]]=!0,K.FileIndex[ae].type!==0&&Ae.push([K.FullPaths[ae],K.FileIndex[ae]]);for(ae=0;ae<Ae.length;++ae){var Te=n(Ae[ae][0]);ne=_e[Te],ne||(Ae.push([Te,{name:i(Te).replace("/",""),type:1,clsid:z,ct:Se,mt:Se,content:null}]),_e[Te]=!0)}for(Ae.sort(function(st,Ve){return r(st[0],Ve[0])}),K.FullPaths=[],K.FileIndex=[],ae=0;ae<Ae.length;++ae)K.FullPaths[ae]=Ae[ae][0],K.FileIndex[ae]=Ae[ae][1];for(ae=0;ae<Ae.length;++ae){var He=K.FileIndex[ae],Ke=K.FullPaths[ae];if(He.name=i(Ke).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||z,ae===0)He.C=Ae.length>1?1:-1,He.size=0,He.type=5;else if(Ke.slice(-1)=="/"){for(Ce=ae+1;Ce<Ae.length&&n(K.FullPaths[Ce])!=Ke;++Ce);for(He.C=Ce>=Ae.length?-1:Ce,Ce=ae+1;Ce<Ae.length&&n(K.FullPaths[Ce])!=n(Ke);++Ce);He.R=Ce>=Ae.length?-1:Ce,He.type=1}else n(K.FullPaths[ae+1]||"")==n(Ke)&&(He.R=ae+1),He.type=2}}}function R(K,oe){var re=oe||{};if(re.fileType=="mad")return mt(K,re);switch(P(K),re.fileType){case"zip":return as(K,re)}var ne=function(st){for(var Ve=0,it=0,wt=0;wt<st.FileIndex.length;++wt){var Yt=st.FileIndex[wt];if(Yt.content){var sr=Yt.content.length;sr>0&&(sr<4096?Ve+=sr+63>>6:it+=sr+511>>9)}}for(var Hr=st.FullPaths.length+3>>2,os=Ve+7>>3,na=Ve+127>>7,Os=os+it+Hr+na,ls=Os+127>>7,Ds=ls<=109?0:Math.ceil((ls-109)/127);Os+ls+Ds+127>>7>ls;)Ds=++ls<=109?0:Math.ceil((ls-109)/127);var bi=[1,Ds,ls,na,Hr,it,Ve,0];return st.FileIndex[0].size=Ve<<6,bi[7]=(st.FileIndex[0].start=bi[0]+bi[1]+bi[2]+bi[3]+bi[4]+bi[5])+(bi[6]+7>>3),bi}(K),ae=Fe(ne[7]<<9),le=0,Se=0;{for(le=0;le<8;++le)ae.write_shift(1,te[le]);for(le=0;le<8;++le)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),le=0;le<3;++le)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,ne[2]),ae.write_shift(4,ne[0]+ne[1]+ne[2]+ne[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,ne[3]?ne[0]+ne[1]+ne[2]-1:q),ae.write_shift(4,ne[3]),ae.write_shift(-4,ne[1]?ne[0]-1:q),ae.write_shift(4,ne[1]),le=0;le<109;++le)ae.write_shift(-4,le<ne[2]?ne[1]+le:-1)}if(ne[1])for(Se=0;Se<ne[1];++Se){for(;le<236+Se*127;++le)ae.write_shift(-4,le<ne[2]?ne[1]+le:-1);ae.write_shift(-4,Se===ne[1]-1?q:Se+1)}var Ce=function(st){for(Se+=st;le<Se-1;++le)ae.write_shift(-4,le+1);st&&(++le,ae.write_shift(-4,q))};for(Se=le=0,Se+=ne[1];le<Se;++le)ae.write_shift(-4,B.DIFSECT);for(Se+=ne[2];le<Se;++le)ae.write_shift(-4,B.FATSECT);Ce(ne[3]),Ce(ne[4]);for(var _e=0,Ae=0,Te=K.FileIndex[0];_e<K.FileIndex.length;++_e)Te=K.FileIndex[_e],Te.content&&(Ae=Te.content.length,!(Ae<4096)&&(Te.start=Se,Ce(Ae+511>>9)));for(Ce(ne[6]+7>>3);ae.l&511;)ae.write_shift(-4,B.ENDOFCHAIN);for(Se=le=0,_e=0;_e<K.FileIndex.length;++_e)Te=K.FileIndex[_e],Te.content&&(Ae=Te.content.length,!(!Ae||Ae>=4096)&&(Te.start=Se,Ce(Ae+63>>6)));for(;ae.l&511;)ae.write_shift(-4,B.ENDOFCHAIN);for(le=0;le<ne[4]<<2;++le){var He=K.FullPaths[le];if(!He||He.length===0){for(_e=0;_e<17;++_e)ae.write_shift(4,0);for(_e=0;_e<3;++_e)ae.write_shift(4,-1);for(_e=0;_e<12;++_e)ae.write_shift(4,0);continue}Te=K.FileIndex[le],le===0&&(Te.start=Te.size?Te.start-1:q);var Ke=le===0&&re.root||Te.name;if(Ae=2*(Ke.length+1),ae.write_shift(64,Ke,"utf16le"),ae.write_shift(2,Ae),ae.write_shift(1,Te.type),ae.write_shift(1,Te.color),ae.write_shift(-4,Te.L),ae.write_shift(-4,Te.R),ae.write_shift(-4,Te.C),Te.clsid)ae.write_shift(16,Te.clsid,"hex");else for(_e=0;_e<4;++_e)ae.write_shift(4,0);ae.write_shift(4,Te.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Te.start),ae.write_shift(4,Te.size),ae.write_shift(4,0)}for(le=1;le<K.FileIndex.length;++le)if(Te=K.FileIndex[le],Te.size>=4096)if(ae.l=Te.start+1<<9,Vt&&Buffer.isBuffer(Te.content))Te.content.copy(ae,ae.l,0,Te.size),ae.l+=Te.size+511&-512;else{for(_e=0;_e<Te.size;++_e)ae.write_shift(1,Te.content[_e]);for(;_e&511;++_e)ae.write_shift(1,0)}for(le=1;le<K.FileIndex.length;++le)if(Te=K.FileIndex[le],Te.size>0&&Te.size<4096)if(Vt&&Buffer.isBuffer(Te.content))Te.content.copy(ae,ae.l,0,Te.size),ae.l+=Te.size+63&-64;else{for(_e=0;_e<Te.size;++_e)ae.write_shift(1,Te.content[_e]);for(;_e&63;++_e)ae.write_shift(1,0)}if(Vt)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function j(K,oe){var re=K.FullPaths.map(function(_e){return _e.toUpperCase()}),ne=re.map(function(_e){var Ae=_e.split("/");return Ae[Ae.length-(_e.slice(-1)=="/"?2:1)]}),ae=!1;oe.charCodeAt(0)===47?(ae=!0,oe=re[0].slice(0,-1)+oe):ae=oe.indexOf("/")!==-1;var le=oe.toUpperCase(),Se=ae===!0?re.indexOf(le):ne.indexOf(le);if(Se!==-1)return K.FileIndex[Se];var Ce=!le.match(Vh);for(le=le.replace(Of,""),Ce&&(le=le.replace(Vh,"!")),Se=0;Se<re.length;++Se)if((Ce?re[Se].replace(Vh,"!"):re[Se]).replace(Of,"")==le||(Ce?ne[Se].replace(Vh,"!"):ne[Se]).replace(Of,"")==le)return K.FileIndex[Se];return null}var A=64,q=-2,J="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",B={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(K,oe,re){u();var ne=R(K,re);l.writeFileSync(oe,ne)}function V(K){for(var oe=new Array(K.length),re=0;re<K.length;++re)oe[re]=String.fromCharCode(K[re]);return oe.join("")}function Z(K,oe){var re=R(K,oe);switch(oe&&oe.type||"buffer"){case"file":return u(),l.writeFileSync(oe.filename,re),re;case"binary":return typeof re=="string"?re:V(re);case"base64":return ud(typeof re=="string"?re:V(re));case"buffer":if(Vt)return Buffer.isBuffer(re)?re:Pa(re);case"array":return typeof re=="string"?ks(re):re}return re}var he;function k(K){try{var oe=K.InflateRaw,re=new oe;if(re._processChunk(new Uint8Array([3,0]),re._finishFlushFlag),re.bytesRead)he=K;else throw new Error("zlib does not expose bytesRead")}catch(ne){console.error("cannot use native zlib: "+(ne.message||ne))}}function I(K,oe){if(!he)return Bt(K,oe);var re=he.InflateRaw,ne=new re,ae=ne._processChunk(K.slice(K.l),ne._finishFlushFlag);return K.l+=ne.bytesRead,ae}function M(K){return he?he.deflateRawSync(K):Ct(K)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(K){var oe=(K<<1|K<<11)&139536|(K<<5|K<<15)&558144;return(oe>>16|oe>>8|oe)&255}for(var de=typeof Uint8Array<"u",ve=de?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)ve[Ee]=fe(Ee);function Oe(K,oe){var re=ve[K&255];return oe<=8?re>>>8-oe:(re=re<<8|ve[K>>8&255],oe<=16?re>>>16-oe:(re=re<<8|ve[K>>16&255],re>>>24-oe))}function qe(K,oe){var re=oe&7,ne=oe>>>3;return(K[ne]|(re<=6?0:K[ne+1]<<8))>>>re&3}function Qe(K,oe){var re=oe&7,ne=oe>>>3;return(K[ne]|(re<=5?0:K[ne+1]<<8))>>>re&7}function je(K,oe){var re=oe&7,ne=oe>>>3;return(K[ne]|(re<=4?0:K[ne+1]<<8))>>>re&15}function ue(K,oe){var re=oe&7,ne=oe>>>3;return(K[ne]|(re<=3?0:K[ne+1]<<8))>>>re&31}function Me(K,oe){var re=oe&7,ne=oe>>>3;return(K[ne]|(re<=1?0:K[ne+1]<<8))>>>re&127}function at(K,oe,re){var ne=oe&7,ae=oe>>>3,le=(1<<re)-1,Se=K[ae]>>>ne;return re<8-ne||(Se|=K[ae+1]<<8-ne,re<16-ne)||(Se|=K[ae+2]<<16-ne,re<24-ne)||(Se|=K[ae+3]<<24-ne),Se&le}function ze(K,oe,re){var ne=oe&7,ae=oe>>>3;return ne<=5?K[ae]|=(re&7)<<ne:(K[ae]|=re<<ne&255,K[ae+1]=(re&7)>>8-ne),oe+3}function Ye(K,oe,re){var ne=oe&7,ae=oe>>>3;return re=(re&1)<<ne,K[ae]|=re,oe+1}function Ze(K,oe,re){var ne=oe&7,ae=oe>>>3;return re<<=ne,K[ae]|=re&255,re>>>=8,K[ae+1]=re,oe+8}function tt(K,oe,re){var ne=oe&7,ae=oe>>>3;return re<<=ne,K[ae]|=re&255,re>>>=8,K[ae+1]=re&255,K[ae+2]=re>>>8,oe+16}function ft(K,oe){var re=K.length,ne=2*re>oe?2*re:oe+5,ae=0;if(re>=oe)return K;if(Vt){var le=u5(ne);if(K.copy)K.copy(le);else for(;ae<K.length;++ae)le[ae]=K[ae];return le}else if(de){var Se=new Uint8Array(ne);if(Se.set)Se.set(K);else for(;ae<re;++ae)Se[ae]=K[ae];return Se}return K.length=ne,K}function dt(K){for(var oe=new Array(K),re=0;re<K;++re)oe[re]=0;return oe}function bt(K,oe,re){var ne=1,ae=0,le=0,Se=0,Ce=0,_e=K.length,Ae=de?new Uint16Array(32):dt(32);for(le=0;le<32;++le)Ae[le]=0;for(le=_e;le<re;++le)K[le]=0;_e=K.length;var Te=de?new Uint16Array(_e):dt(_e);for(le=0;le<_e;++le)Ae[ae=K[le]]++,ne<ae&&(ne=ae),Te[le]=0;for(Ae[0]=0,le=1;le<=ne;++le)Ae[le+16]=Ce=Ce+Ae[le-1]<<1;for(le=0;le<_e;++le)Ce=K[le],Ce!=0&&(Te[le]=Ae[Ce+16]++);var He=0;for(le=0;le<_e;++le)if(He=K[le],He!=0)for(Ce=Oe(Te[le],ne)>>ne-He,Se=(1<<ne+4-He)-1;Se>=0;--Se)oe[Ce|Se<<He]=He&15|le<<4;return ne}var At=de?new Uint16Array(512):dt(512),Lt=de?new Uint16Array(32):dt(32);if(!de){for(var Ot=0;Ot<512;++Ot)At[Ot]=0;for(Ot=0;Ot<32;++Ot)Lt[Ot]=0}(function(){for(var K=[],oe=0;oe<32;oe++)K.push(5);bt(K,Lt,32);var re=[];for(oe=0;oe<=143;oe++)re.push(8);for(;oe<=255;oe++)re.push(9);for(;oe<=279;oe++)re.push(7);for(;oe<=287;oe++)re.push(8);bt(re,At,288)})();var xt=function(){for(var oe=de?new Uint8Array(32768):[],re=0,ne=0;re<se.length-1;++re)for(;ne<se[re+1];++ne)oe[ne]=re;for(;ne<32768;++ne)oe[ne]=29;var ae=de?new Uint8Array(259):[];for(re=0,ne=0;re<H.length-1;++re)for(;ne<H[re+1];++ne)ae[ne]=re;function le(Ce,_e){for(var Ae=0;Ae<Ce.length;){var Te=Math.min(65535,Ce.length-Ae),He=Ae+Te==Ce.length;for(_e.write_shift(1,+He),_e.write_shift(2,Te),_e.write_shift(2,~Te&65535);Te-- >0;)_e[_e.l++]=Ce[Ae++]}return _e.l}function Se(Ce,_e){for(var Ae=0,Te=0,He=de?new Uint16Array(32768):[];Te<Ce.length;){var Ke=Math.min(65535,Ce.length-Te);if(Ke<10){for(Ae=ze(_e,Ae,+(Te+Ke==Ce.length)),Ae&7&&(Ae+=8-(Ae&7)),_e.l=Ae/8|0,_e.write_shift(2,Ke),_e.write_shift(2,~Ke&65535);Ke-- >0;)_e[_e.l++]=Ce[Te++];Ae=_e.l*8;continue}Ae=ze(_e,Ae,+(Te+Ke==Ce.length)+2);for(var st=0;Ke-- >0;){var Ve=Ce[Te];st=(st<<5^Ve)&32767;var it=-1,wt=0;if((it=He[st])&&(it|=Te&-32768,it>Te&&(it-=32768),it<Te))for(;Ce[it+wt]==Ce[Te+wt]&&wt<250;)++wt;if(wt>2){Ve=ae[wt],Ve<=22?Ae=Ze(_e,Ae,ve[Ve+1]>>1)-1:(Ze(_e,Ae,3),Ae+=5,Ze(_e,Ae,ve[Ve-23]>>5),Ae+=3);var Yt=Ve<8?0:Ve-4>>2;Yt>0&&(tt(_e,Ae,wt-H[Ve]),Ae+=Yt),Ve=oe[Te-it],Ae=Ze(_e,Ae,ve[Ve]>>3),Ae-=3;var sr=Ve<4?0:Ve-2>>1;sr>0&&(tt(_e,Ae,Te-it-se[Ve]),Ae+=sr);for(var Hr=0;Hr<wt;++Hr)He[st]=Te&32767,st=(st<<5^Ce[Te])&32767,++Te;Ke-=wt-1}else Ve<=143?Ve=Ve+48:Ae=Ye(_e,Ae,1),Ae=Ze(_e,Ae,ve[Ve]),He[st]=Te&32767,++Te}Ae=Ze(_e,Ae,0)-1}return _e.l=(Ae+7)/8|0,_e.l}return function(_e,Ae){return _e.length<8?le(_e,Ae):Se(_e,Ae)}}();function Ct(K){var oe=Fe(50+Math.floor(K.length*1.1)),re=xt(K,oe);return oe.slice(0,re)}var nt=de?new Uint16Array(32768):dt(32768),Zr=de?new Uint16Array(32768):dt(32768),Rt=de?new Uint16Array(128):dt(128),ti=1,Gt=1;function fr(K,oe){var re=ue(K,oe)+257;oe+=5;var ne=ue(K,oe)+1;oe+=5;var ae=je(K,oe)+4;oe+=4;for(var le=0,Se=de?new Uint8Array(19):dt(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Ae=de?new Uint8Array(8):dt(8),Te=de?new Uint8Array(8):dt(8),He=Se.length,Ke=0;Ke<ae;++Ke)Se[L[Ke]]=le=Qe(K,oe),_e<le&&(_e=le),Ae[le]++,oe+=3;var st=0;for(Ae[0]=0,Ke=1;Ke<=_e;++Ke)Te[Ke]=st=st+Ae[Ke-1]<<1;for(Ke=0;Ke<He;++Ke)(st=Se[Ke])!=0&&(Ce[Ke]=Te[st]++);var Ve=0;for(Ke=0;Ke<He;++Ke)if(Ve=Se[Ke],Ve!=0){st=ve[Ce[Ke]]>>8-Ve;for(var it=(1<<7-Ve)-1;it>=0;--it)Rt[st|it<<Ve]=Ve&7|Ke<<3}var wt=[];for(_e=1;wt.length<re+ne;)switch(st=Rt[Me(K,oe)],oe+=st&7,st>>>=3){case 16:for(le=3+qe(K,oe),oe+=2,st=wt[wt.length-1];le-- >0;)wt.push(st);break;case 17:for(le=3+Qe(K,oe),oe+=3;le-- >0;)wt.push(0);break;case 18:for(le=11+Me(K,oe),oe+=7;le-- >0;)wt.push(0);break;default:wt.push(st),_e<st&&(_e=st);break}var Yt=wt.slice(0,re),sr=wt.slice(re);for(Ke=re;Ke<286;++Ke)Yt[Ke]=0;for(Ke=ne;Ke<30;++Ke)sr[Ke]=0;return ti=bt(Yt,nt,286),Gt=bt(sr,Zr,30),oe}function Ui(K,oe){if(K[0]==3&&!(K[1]&3))return[El(oe),2];for(var re=0,ne=0,ae=u5(oe||1<<18),le=0,Se=ae.length>>>0,Ce=0,_e=0;!(ne&1);){if(ne=Qe(K,re),re+=3,ne>>>1)ne>>1==1?(Ce=9,_e=5):(re=fr(K,re),Ce=ti,_e=Gt);else{re&7&&(re+=8-(re&7));var Ae=K[re>>>3]|K[(re>>>3)+1]<<8;if(re+=32,Ae>0)for(!oe&&Se<le+Ae&&(ae=ft(ae,le+Ae),Se=ae.length);Ae-- >0;)ae[le++]=K[re>>>3],re+=8;continue}for(;;){!oe&&Se<le+32767&&(ae=ft(ae,le+32767),Se=ae.length);var Te=at(K,re,Ce),He=ne>>>1==1?At[Te]:nt[Te];if(re+=He&15,He>>>=4,!(He>>>8&255))ae[le++]=He;else{if(He==256)break;He-=257;var Ke=He<8?0:He-4>>2;Ke>5&&(Ke=0);var st=le+H[He];Ke>0&&(st+=at(K,re,Ke),re+=Ke),Te=at(K,re,_e),He=ne>>>1==1?Lt[Te]:Zr[Te],re+=He&15,He>>>=4;var Ve=He<4?0:He-2>>1,it=se[He];for(Ve>0&&(it+=at(K,re,Ve),re+=Ve),!oe&&Se<st&&(ae=ft(ae,st+100),Se=ae.length);le<st;)ae[le]=ae[le-it],++le}}}return oe?[ae,re+7>>>3]:[ae.slice(0,le),re+7>>>3]}function Bt(K,oe){var re=K.slice(K.l||0),ne=Ui(re,oe);return K.l+=ne[1],ne[0]}function Fs(K,oe){if(K)typeof console<"u"&&console.error(oe);else throw new Error(oe)}function gr(K,oe){var re=K;ji(re,0);var ne=[],ae=[],le={FileIndex:ne,FullPaths:ae};T(le,{root:oe.root});for(var Se=re.length-4;(re[Se]!=80||re[Se+1]!=75||re[Se+2]!=5||re[Se+3]!=6)&&Se>=0;)--Se;re.l=Se+4,re.l+=4;var Ce=re.read_shift(2);re.l+=6;var _e=re.read_shift(4);for(re.l=_e,Se=0;Se<Ce;++Se){re.l+=20;var Ae=re.read_shift(4),Te=re.read_shift(4),He=re.read_shift(2),Ke=re.read_shift(2),st=re.read_shift(2);re.l+=8;var Ve=re.read_shift(4),it=o(re.slice(re.l+He,re.l+He+Ke));re.l+=He+Ke+st;var wt=re.l;re.l=Ve+4,yi(re,Ae,Te,le,it),re.l=wt}return le}function yi(K,oe,re,ne,ae){K.l+=2;var le=K.read_shift(2),Se=K.read_shift(2),Ce=a(K);if(le&8257)throw new Error("Unsupported ZIP encryption");for(var _e=K.read_shift(4),Ae=K.read_shift(4),Te=K.read_shift(4),He=K.read_shift(2),Ke=K.read_shift(2),st="",Ve=0;Ve<He;++Ve)st+=String.fromCharCode(K[K.l++]);if(Ke){var it=o(K.slice(K.l,K.l+Ke));(it[21589]||{}).mt&&(Ce=it[21589].mt),((ae||{})[21589]||{}).mt&&(Ce=ae[21589].mt)}K.l+=Ke;var wt=K.slice(K.l,K.l+Ae);switch(Se){case 8:wt=I(K,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var Yt=!1;le&8&&(_e=K.read_shift(4),_e==134695760&&(_e=K.read_shift(4),Yt=!0),Ae=K.read_shift(4),Te=K.read_shift(4)),Ae!=oe&&Fs(Yt,"Bad compressed size: "+oe+" != "+Ae),Te!=re&&Fs(Yt,"Bad uncompressed size: "+re+" != "+Te),ri(ne,st,wt,{unsafe:!0,mt:Ce})}function as(K,oe){var re=oe||{},ne=[],ae=[],le=Fe(1),Se=re.compression?8:0,Ce=0,_e=0,Ae=0,Te=0,He=0,Ke=K.FullPaths[0],st=Ke,Ve=K.FileIndex[0],it=[],wt=0;for(_e=1;_e<K.FullPaths.length;++_e)if(st=K.FullPaths[_e].slice(Ke.length),Ve=K.FileIndex[_e],!(!Ve.size||!Ve.content||st=="Sh33tJ5")){var Yt=Te,sr=Fe(st.length);for(Ae=0;Ae<st.length;++Ae)sr.write_shift(1,st.charCodeAt(Ae)&127);sr=sr.slice(0,sr.l),it[He]=H7.buf(Ve.content,0);var Hr=Ve.content;Se==8&&(Hr=M(Hr)),le=Fe(30),le.write_shift(4,67324752),le.write_shift(2,20),le.write_shift(2,Ce),le.write_shift(2,Se),Ve.mt?s(le,Ve.mt):le.write_shift(4,0),le.write_shift(-4,it[He]),le.write_shift(4,Hr.length),le.write_shift(4,Ve.content.length),le.write_shift(2,sr.length),le.write_shift(2,0),Te+=le.length,ne.push(le),Te+=sr.length,ne.push(sr),Te+=Hr.length,ne.push(Hr),le=Fe(46),le.write_shift(4,33639248),le.write_shift(2,0),le.write_shift(2,20),le.write_shift(2,Ce),le.write_shift(2,Se),le.write_shift(4,0),le.write_shift(-4,it[He]),le.write_shift(4,Hr.length),le.write_shift(4,Ve.content.length),le.write_shift(2,sr.length),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(4,0),le.write_shift(4,Yt),wt+=le.l,ae.push(le),wt+=sr.length,ae.push(sr),++He}return le=Fe(22),le.write_shift(4,101010256),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,He),le.write_shift(2,He),le.write_shift(4,wt),le.write_shift(4,Te),le.write_shift(2,0),Sn([Sn(ne),Sn(ae),le])}var lr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _t(K,oe){if(K.ctype)return K.ctype;var re=K.name||"",ne=re.match(/\.([^\.]+)$/);return ne&&lr[ne[1]]||oe&&(ne=(re=oe).match(/[\.\\]([^\.\\])+$/),ne&&lr[ne[1]])?lr[ne[1]]:"application/octet-stream"}function Ht(K){for(var oe=ud(K),re=[],ne=0;ne<oe.length;ne+=76)re.push(oe.slice(ne,ne+76));return re.join(`\r
`)+`\r
`}function ra(K){var oe=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var Te=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});oe=oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),oe.charAt(0)==`
`&&(oe="=0D"+oe.slice(1)),oe=oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var re=[],ne=oe.split(`\r
`),ae=0;ae<ne.length;++ae){var le=ne[ae];if(le.length==0){re.push("");continue}for(var Se=0;Se<le.length;){var Ce=76,_e=le.slice(Se,Se+Ce);_e.charAt(Ce-1)=="="?Ce--:_e.charAt(Ce-2)=="="?Ce-=2:_e.charAt(Ce-3)=="="&&(Ce-=3),_e=le.slice(Se,Se+Ce),Se+=Ce,Se<le.length&&(_e+="="),re.push(_e)}}return re.join(`\r
`)}function en(K){for(var oe=[],re=0;re<K.length;++re){for(var ne=K[re];re<=K.length&&ne.charAt(ne.length-1)=="=";)ne=ne.slice(0,ne.length-1)+K[++re];oe.push(ne)}for(var ae=0;ae<oe.length;++ae)oe[ae]=oe[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(le){return String.fromCharCode(parseInt(le.slice(1),16))});return ks(oe.join(`\r
`))}function zi(K,oe,re){for(var ne="",ae="",le="",Se,Ce=0;Ce<10;++Ce){var _e=oe[Ce];if(!_e||_e.match(/^\s*$/))break;var Ae=_e.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":ne=Ae[2].trim();break;case"content-type":le=Ae[2].trim();break;case"content-transfer-encoding":ae=Ae[2].trim();break}}switch(++Ce,ae.toLowerCase()){case"base64":Se=ks(Ta(oe.slice(Ce).join("")));break;case"quoted-printable":Se=en(oe.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Te=ri(K,ne.slice(re.length),Se,{unsafe:!0});le&&(Te.ctype=le)}function Wi(K,oe){if(V(K.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var re=oe&&oe.root||"",ne=(Vt&&Buffer.isBuffer(K)?K.toString("binary"):V(K)).split(`\r
`),ae=0,le="";for(ae=0;ae<ne.length;++ae)if(le=ne[ae],!!/^Content-Location:/i.test(le)&&(le=le.slice(le.indexOf("file")),re||(re=le.slice(0,le.lastIndexOf("/")+1)),le.slice(0,re.length)!=re))for(;re.length>0&&(re=re.slice(0,re.length-1),re=re.slice(0,re.lastIndexOf("/")+1),le.slice(0,re.length)!=re););var Se=(ne[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Ce="--"+(Se[1]||""),_e=[],Ae=[],Te={FileIndex:_e,FullPaths:Ae};T(Te);var He,Ke=0;for(ae=0;ae<ne.length;++ae){var st=ne[ae];st!==Ce&&st!==Ce+"--"||(Ke++&&zi(Te,ne.slice(He,ae),re),He=ae)}return Te}function mt(K,oe){var re=oe||{},ne=re.boundary||"SheetJS";ne="------="+ne;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ne.slice(2)+'"',"","",""],le=K.FullPaths[0],Se=le,Ce=K.FileIndex[0],_e=1;_e<K.FullPaths.length;++_e)if(Se=K.FullPaths[_e].slice(le.length),Ce=K.FileIndex[_e],!(!Ce.size||!Ce.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wt){return"_x"+wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wt){return"_u"+wt.charCodeAt(0).toString(16)+"_"});for(var Ae=Ce.content,Te=Vt&&Buffer.isBuffer(Ae)?Ae.toString("binary"):V(Ae),He=0,Ke=Math.min(1024,Te.length),st=0,Ve=0;Ve<=Ke;++Ve)(st=Te.charCodeAt(Ve))>=32&&st<128&&++He;var it=He>=Ke*4/5;ae.push(ne),ae.push("Content-Location: "+(re.root||"file:///C:/SheetJS/")+Se),ae.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),ae.push("Content-Type: "+_t(Ce,Se)),ae.push(""),ae.push(it?ra(Te):Ht(Te))}return ae.push(ne+`--\r
`),ae.join(`\r
`)}function wi(K){var oe={};return T(oe,K),oe}function ri(K,oe,re,ne){var ae=ne&&ne.unsafe;ae||T(K);var le=!ae&&or.find(K,oe);if(!le){var Se=K.FullPaths[0];oe.slice(0,Se.length)==Se?Se=oe:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+oe).replace("//","/")),le={name:i(oe),type:2},K.FileIndex.push(le),K.FullPaths.push(Se),ae||or.utils.cfb_gc(K)}return le.content=re,le.size=re?re.length:0,ne&&(ne.CLSID&&(le.clsid=ne.CLSID),ne.mt&&(le.mt=ne.mt),ne.ct&&(le.ct=ne.ct)),le}function Cn(K,oe){T(K);var re=or.find(K,oe);if(re){for(var ne=0;ne<K.FileIndex.length;++ne)if(K.FileIndex[ne]==re)return K.FileIndex.splice(ne,1),K.FullPaths.splice(ne,1),!0}return!1}function Or(K,oe,re){T(K);var ne=or.find(K,oe);if(ne){for(var ae=0;ae<K.FileIndex.length;++ae)if(K.FileIndex[ae]==ne)return K.FileIndex[ae].name=i(re),K.FullPaths[ae]=re,!0}return!1}function Ar(K){P(K,!0)}return t.find=j,t.read=D,t.parse=f,t.write=Z,t.writeFile=G,t.utils={cfb_new:wi,cfb_add:ri,cfb_del:Cn,cfb_mov:Or,cfb_gc:Ar,ReadShift:If,CheckField:v3,prep_blob:ji,bconcat:Sn,use_zlib:k,_deflateRaw:Ct,_inflateRaw:Bt,consts:B},t}();function $7(e){return typeof e=="string"?Dp(e):Array.isArray(e)?g7(e):e}function Ad(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Dp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?dd(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([$7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ed(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Tn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function v5(e,t){for(var r=[],n=Tn(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function ox(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Mp(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function q7(e){for(var t=[],r=Tn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Y0=new Date(1899,11,30,0,0,0);function gi(e,t){var r=e.getTime(),n=Y0.getTime()+(e.getTimezoneOffset()-Y0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var t3=new Date,V7=Y0.getTime()+(t3.getTimezoneOffset()-Y0.getTimezoneOffset())*6e4,y5=t3.getTimezoneOffset();function r3(e){var t=new Date;return t.setTime(e*24*60*60*1e3+V7),t.getTimezoneOffset()!==y5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-y5)*6e4),t}var w5=new Date("2017-02-19T19:06:09.000Z"),n3=isNaN(w5.getFullYear())?new Date("2/19/17"):w5,G7=n3.getFullYear()==2017;function Qn(e,t){var r=new Date(e);if(G7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(n3.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Bp(e,t){if(Vt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function xi(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=xi(e[r]));return t}function Lr(e,t){for(var r="";r.length<t;)r+=e;return r}function ba(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Y7=["january","february","march","april","may","june","july","august","september","october","november","december"];function fd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Y7.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Pt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Vt?n=Pa(r):n=x7(r),or.utils.cfb_add(e,t,n)}or.utils.cfb_add(e,t,r)}else e.file(t,r)}function lx(){return or.utils.cfb_new()}var Qr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,K7={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cx=ox(K7),ux=/[&<>'"]/g,X7=/[\u0000-\u0008\u000b-\u001f]/g;function rr(e){var t=e+"";return t.replace(ux,function(r){return cx[r]}).replace(X7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function b5(e){return rr(e).replace(/ /g,"_x0020_")}var i3=/[\u0000-\u001f]/g;function J7(e){var t=e+"";return t.replace(ux,function(r){return cx[r]}).replace(/\n/g,"<br/>").replace(i3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Q7(e){var t=e+"";return t.replace(ux,function(r){return cx[r]}).replace(i3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Z7(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function eP(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function x1(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function _5(e){var t=El(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function S5(e){return Pa(e,"binary").toString("utf8")}var Yh="foo bar baz",Df=Vt&&(S5(Yh)==x1(Yh)&&S5||_5(Yh)==x1(Yh)&&_5)||x1,dd=Vt?function(e){return Pa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},tP=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),s3=/(^\s|\s$|\n)/;function Nn(e,t){return"<"+e+(t.match(s3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function hd(e){return Tn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Xe(e,t,r){return"<"+e+(r!=null?hd(r):"")+(t!=null?(t.match(s3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Gg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function rP(e,t){switch(typeof e){case"string":var r=Xe("vt:lpwstr",rr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Xe((e|0)==e?"vt:i4":"vt:r8",rr(String(e)));case"boolean":return Xe("vt:bool",e?"true":"false")}if(e instanceof Date)return Xe("vt:filetime",Gg(e));throw new Error("Unable to serialize "+e)}var hn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ci={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function nP(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function iP(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var N5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},k5=Vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Pa(t)})):N5(e)}:N5,E5=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(gf(e,i)));return n.join("").replace(Of,"")},fx=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Of,""):E5(e,t,r)}:E5,A5=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},a3=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):A5(e,t,r)}:A5,T5=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(bc(e,i)));return n.join("")},Td=Vt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):T5(t,r,n)}:T5,o3=function(e,t){var r=Pi(e,t);return r>0?Td(e,t+4,t+4+r-1):""},l3=o3,c3=function(e,t){var r=Pi(e,t);return r>0?Td(e,t+4,t+4+r-1):""},u3=c3,f3=function(e,t){var r=2*Pi(e,t);return r>0?Td(e,t+4,t+4+r-1):""},d3=f3,h3=function(t,r){var n=Pi(t,r);return n>0?fx(t,r+4,r+4+n):""},p3=h3,m3=function(e,t){var r=Pi(e,t);return r>0?Td(e,t+4,t+4+r):""},g3=m3,x3=function(e,t){return nP(e,t)},K0=x3,dx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Vt&&(l3=function(t,r){if(!Buffer.isBuffer(t))return o3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},u3=function(t,r){if(!Buffer.isBuffer(t))return c3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},d3=function(t,r){if(!Buffer.isBuffer(t))return f3(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},p3=function(t,r){if(!Buffer.isBuffer(t))return h3(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},g3=function(t,r){if(!Buffer.isBuffer(t))return m3(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},K0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):x3(t,r)},dx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var bc=function(e,t){return e[t]},gf=function(e,t){return e[t+1]*256+e[t]},sP=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Pi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},sl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},aP=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function If(e,t){var r="",n,i,s=[],a,o,l,u;switch(t){case"dbcs":if(u=this.l,Vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(gf(this,u)),u+=2;e*=2;break;case"utf8":r=Td(this,this.l,this.l+e);break;case"utf16le":e*=2,r=fx(this,this.l,this.l+e);break;case"wstr":return If.call(this,e,"dbcs");case"lpstr-ansi":r=l3(this,this.l),e=4+Pi(this,this.l);break;case"lpstr-cp":r=u3(this,this.l),e=4+Pi(this,this.l);break;case"lpwstr":r=d3(this,this.l),e=4+2*Pi(this,this.l);break;case"lpp4":e=4+Pi(this,this.l),r=p3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Pi(this,this.l),r=g3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=bc(this,this.l+e++))!==0;)s.push(qh(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=gf(this,this.l+e))!==0;)s.push(qh(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=bc(this,u),this.l=u+1,o=If.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(qh(gf(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=bc(this,u),this.l=u+1,o=If.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(qh(bc(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=bc(this,this.l),this.l++,n;case 2:return n=(t==="i"?sP:gf)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?sl:aP)(this,this.l),this.l+=4,n):(i=Pi(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=K0(this,this.l):i=K0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=a3(this,this.l,e);break}}return this.l+=e,r}var oP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},lP=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},cP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function uP(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)cP(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,oP(this,t,this.l);break;case 8:if(n=8,r==="f"){iP(this,t,this.l);break}case 16:break;case-4:n=4,lP(this,t,this.l);break}return this.l+=n,this}function v3(e,t){var r=a3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ji(e,t){e.l=t,e.read_shift=If,e.chk=v3,e.write_shift=uP}function Zs(e,t){e.l+=t}function Fe(e){var t=El(e);return ji(t,0),t}function mi(){var e=[],t=Vt?256:2048,r=function(u){var f=Fe(u);return ji(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},a=function(){return i(),Sn(e)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function Be(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=nI[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&dx(r)&&e.push(r)}}function Rf(e,t,r){var n=xi(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function j5(e,t,r){var n=xi(e);return n.s=Rf(n.s,t.s,r),n.e=Rf(n.e,t.s,r),n}function Mf(e,t){if(e.cRel&&e.c<0)for(e=xi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=xi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ir(e);return!e.cRel&&e.cRel!=null&&(r=hP(r)),!e.rRel&&e.rRel!=null&&(r=fP(r)),r}function v1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+zn(e.s.c)+":"+(e.e.cRel?"":"$")+zn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+En(e.s.r)+":"+(e.e.rRel?"":"$")+En(e.e.r):Mf(e.s,t.biff)+":"+Mf(e.e,t.biff)}function hx(e){return parseInt(dP(e),10)-1}function En(e){return""+(e+1)}function fP(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dP(e){return e.replace(/\$(\d+)$/,"$1")}function px(e){for(var t=pP(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function zn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function hP(e){return e.replace(/^([A-Z])/,"$$$1")}function pP(e){return e.replace(/^\$([A-Z])/,"$1")}function mP(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ir(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ri(e){var t=e.indexOf(":");return t==-1?{s:mn(e),e:mn(e)}:{s:mn(e.slice(0,t)),e:mn(e.slice(t+1))}}function Xr(e,t){return typeof t>"u"||typeof t=="number"?Xr(e.s,e.e):(typeof e!="string"&&(e=ir(e)),typeof t!="string"&&(t=ir(t)),e==t?e:e+":"+t)}function wr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function C5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Po(e.z,r?gi(t):t)}catch{}try{return e.w=Po((e.XF||{}).numFmtId||(r?14:0),r?gi(t):t)}catch{return""+t}}function ja(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?jd[e.v]||e.v:t==null?C5(e,e.v):C5(e,t))}function Ol(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function y3(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?mn(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=wr(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var h={v:t[p][m]},v=a+p,x=o+m;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))h=t[p][m];else if(Array.isArray(h.v)&&(h.f=t[p][m][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Fr[14],n.cellDates?(h.t="d",h.w=Po(h.z,gi(h.v))):(h.t="n",h.v=gi(h.v),h.w=Po(h.z,h.v))):h.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(h.z=s[v][x].z),s[v][x]=h;else{var b=ir({c:x,r:v});s[b]&&s[b].z&&(h.z=s[b].z),s[b]=h}}}return u.s.c<1e7&&(s["!ref"]=Xr(u)),s}function mu(e,t){return y3(null,e,t)}function gP(e){return e.read_shift(4,"i")}function js(e,t){return t||(t=Fe(4)),t.write_shift(4,e),t}function Wn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function gn(e,t){var r=!1;return t==null&&(r=!0,t=Fe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function xP(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vP(e,t){return t||(t=Fe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function mx(e,t){var r=e.l,n=e.read_shift(1),i=Wn(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(xP(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function yP(e,t){var r=!1;return t==null&&(r=!0,t=Fe(15+4*e.t.length)),t.write_shift(1,0),gn(e.t,t),r?t.slice(0,t.l):t}var wP=mx;function bP(e,t){var r=!1;return t==null&&(r=!0,t=Fe(23+4*e.t.length)),t.write_shift(1,1),gn(e.t,t),t.write_shift(4,1),vP({},t),r?t.slice(0,t.l):t}function ss(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Dl(e,t){return t==null&&(t=Fe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Il(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Rl(e,t){return t==null&&(t=Fe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var _P=Wn,w3=gn;function gx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function X0(e,t){var r=!1;return t==null&&(r=!0,t=Fe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var SP=Wn,Yg=gx,xx=X0;function b3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?K0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):sl(t,0)>>2;return r?i/100:i}function _3(e,t){t==null&&(t=Fe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function S3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function NP(e,t){return t||(t=Fe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ml=S3,gu=NP;function xu(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Al(e,t){return(t||Fe(8)).write_shift(8,e,"f")}function kP(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=OP[i];u&&(t.rgb=z5(u));break;case 2:t.rgb=z5([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function J0(e,t){if(t||(t=Fe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function EP(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function AP(e,t){t||(t=Fe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var N3=2,Ai=3,Kh=11,Q0=19,Xh=64,TP=65,jP=71,CP=4108,PP=4126,_n=80,P5={1:{n:"CodePage",t:N3},2:{n:"Category",t:_n},3:{n:"PresentationFormat",t:_n},4:{n:"ByteCount",t:Ai},5:{n:"LineCount",t:Ai},6:{n:"ParagraphCount",t:Ai},7:{n:"SlideCount",t:Ai},8:{n:"NoteCount",t:Ai},9:{n:"HiddenCount",t:Ai},10:{n:"MultimediaClipCount",t:Ai},11:{n:"ScaleCrop",t:Kh},12:{n:"HeadingPairs",t:CP},13:{n:"TitlesOfParts",t:PP},14:{n:"Manager",t:_n},15:{n:"Company",t:_n},16:{n:"LinksUpToDate",t:Kh},17:{n:"CharacterCount",t:Ai},19:{n:"SharedDoc",t:Kh},22:{n:"HyperlinksChanged",t:Kh},23:{n:"AppVersion",t:Ai,p:"version"},24:{n:"DigSig",t:TP},26:{n:"ContentType",t:_n},27:{n:"ContentStatus",t:_n},28:{n:"Language",t:_n},29:{n:"Version",t:_n},255:{},2147483648:{n:"Locale",t:Q0},2147483651:{n:"Behavior",t:Q0},1919054434:{}},L5={1:{n:"CodePage",t:N3},2:{n:"Title",t:_n},3:{n:"Subject",t:_n},4:{n:"Author",t:_n},5:{n:"Keywords",t:_n},6:{n:"Comments",t:_n},7:{n:"Template",t:_n},8:{n:"LastAuthor",t:_n},9:{n:"RevNumber",t:_n},10:{n:"EditTime",t:Xh},11:{n:"LastPrinted",t:Xh},12:{n:"CreatedDate",t:Xh},13:{n:"ModifiedDate",t:Xh},14:{n:"PageCount",t:Ai},15:{n:"WordCount",t:Ai},16:{n:"CharCount",t:Ai},17:{n:"Thumbnail",t:jP},18:{n:"Application",t:_n},19:{n:"DocSecurity",t:Ai},255:{},2147483648:{n:"Locale",t:Q0},2147483651:{n:"Behavior",t:Q0},1919054434:{}};function LP(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var FP=LP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),OP=xi(FP),jd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},DP={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Jh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function k3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function E3(e,t){var r=q7(DP),n=[],i;n[n.length]=Qr,n[n.length]=Xe("Types",null,{xmlns:hn.CT,"xmlns:xsd":hn.xsd,"xmlns:xsi":hn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Xe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=Xe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Jh[l][t.bookType]||Jh[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Jh[l][t.bookType]||Jh[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function A3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function $c(e){var t=[Qr,Xe("Relationships",null,{xmlns:hn.RELS})];return Tn(e["!id"]).forEach(function(r){t[t.length]=Xe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function er(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[$t.HLINK,$t.XPATH,$t.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function IP(e){var t=[Qr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function F5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function RP(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function MP(e){var t=[Qr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(F5(e[r][0],e[r][1])),t.push(RP("",e[r][0]));return t.push(F5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function T3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+$0.version+"</meta:generator></office:meta></office:document-meta>"}var yl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function y1(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=rr(t),n[n.length]=r?Xe(e,t,r):Nn(e,t))}function j3(e,t){var r=t||{},n=[Qr,Xe("cp:coreProperties",null,{"xmlns:cp":hn.CORE_PROPS,"xmlns:dc":hn.dc,"xmlns:dcterms":hn.dcterms,"xmlns:dcmitype":hn.dcmitype,"xmlns:xsi":hn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&y1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Gg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&y1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Gg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=yl.length;++s){var a=yl[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&y1(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var qc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],C3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function P3(e){var t=[],r=Xe;return e||(e={}),e.Application="SheetJS",t[t.length]=Qr,t[t.length]=Xe("Properties",null,{xmlns:hn.EXT_PROPS,"xmlns:vt":hn.vt}),qc.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=rr(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+rr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function L3(e){var t=[Qr,Xe("Properties",null,{xmlns:hn.CUST_PROPS,"xmlns:vt":hn.vt})];if(!e)return t.join("");var r=1;return Tn(e).forEach(function(i){++r,t[t.length]=Xe("property",rP(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rr(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var O5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function BP(e,t){var r=[];return Tn(O5).map(function(n){for(var i=0;i<yl.length;++i)if(yl[i][1]==n)return yl[i];for(i=0;i<qc.length;++i)if(qc[i][1]==n)return qc[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Nn(O5[n[1]]||n[1],i))}}),Xe("DocumentProperties",r.join(""),{xmlns:Ci.o})}function UP(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Tn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<yl.length;++a)if(s==yl[a][1])return;for(a=0;a<qc.length;++a)if(s==qc[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Xe(b5(s),o,{"dt:dt":l}))}}),t&&Tn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Xe(b5(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Ci.o+'">'+i.join("")+"</"+n+">"}function zP(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Fe(8);return a.write_shift(4,n),a.write_shift(4,i),a}function D5(e,t){var r=Fe(4),n=Fe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Fe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=zP(t);break;case 31:case 80:for(n=Fe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Sn([r,n])}var F3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function WP(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function I5(e,t,r){var n=Fe(8),i=[],s=[],a=8,o=0,l=Fe(8),u=Fe(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!t){u=Fe(8),u.write_shift(4,0),i.unshift(u);var f=[Fe(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var p=e[o][0];for(l=Fe(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Sn(f),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(F3.indexOf(e[o][0])>-1||C3.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],h=0;if(t){h=+t[e[o][0]];var v=r[h];if(v.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}l=D5(v.t,m)}else{var b=WP(m);b==-1&&(b=31,m=String(m)),l=D5(b,m)}s.push(l),u=Fe(8),u.write_shift(4,t?h:2+o),i.push(u),a+=8+l.length}var y=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,y),y+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Sn([n].concat(i).concat(s))}function R5(e,t,r,n,i,s){var a=Fe(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,or.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=I5(e,r,n);if(o.push(l),i){var u=I5(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Sn(o)}function HP(e,t){t||(t=Fe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function $P(e,t){return e.read_shift(t)===1}function Kn(e,t){return t||(t=Fe(2)),t.write_shift(2,+!!e),t}function O3(e){return e.read_shift(2,"u")}function Ji(e,t){return t||(t=Fe(2)),t.write_shift(2,e),t}function D3(e,t,r){return r||(r=Fe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function I3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function qP(e){var t=e.t||"",r=Fe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Fe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Sn(i)}function VP(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function GP(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):VP(e,n,r)}function YP(e,t,r){if(r.biff>5)return GP(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function R3(e,t,r){return r||(r=Fe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function M5(e,t){t||(t=Fe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function KP(e){var t=Fe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),M5(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&M5(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Tl(e,t,r,n){return n||(n=Fe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function XP(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function JP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function M3(e,t){return t||(t=Fe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function vx(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Fe(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function QP(e,t){var r=!t||t.biff==8,n=Fe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function ZP(e,t){var r=!t||t.biff>=8?2:1,n=Fe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function eL(e,t){var r=Fe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=qP(e[i]);var s=Sn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function tL(){var e=Fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function rL(e){var t=Fe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function nL(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=Fe(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function iL(e,t,r,n){var i=Fe(10);return Tl(e,t,n,i),i.write_shift(4,r),i}function sL(e,t,r,n,i){var s=!i||i.biff==8,a=Fe(8+ +s+(1+s)*r.length);return Tl(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function aL(e,t,r,n){var i=r&&r.biff==5;n||(n=Fe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function oL(e,t){var r=t.biff==8||!t.biff?4:2,n=Fe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function B5(e,t,r,n){var i=r&&r.biff==5;n||(n=Fe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function lL(e){var t=Fe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function cL(e,t,r,n,i,s){var a=Fe(8);return Tl(e,t,n,a),D3(r,s,a),a}function uL(e,t,r,n){var i=Fe(14);return Tl(e,t,n,i),Al(r,i),i}function fL(e,t,r){if(r.biff<8)return dL(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(XP(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function dL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=I3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function hL(e){var t=Fe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)M3(e[r],t);return t}function pL(e){var t=Fe(24),r=mn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Sn([t,KP(e[1])])}function mL(e){var t=e[1].Tooltip,r=Fe(10+2*(t.length+1));r.write_shift(2,2048);var n=mn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function gL(e){return e||(e=Fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function xL(e,t,r){if(!r.cellStyles)return Zs(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function vL(e,t){var r=Fe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function yL(e){for(var t=Fe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function wL(e,t,r){var n=Fe(15);return Pd(n,e,t),n.write_shift(8,r,"f"),n}function bL(e,t,r){var n=Fe(9);return Pd(n,e,t),n.write_shift(2,r),n}var _L=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ox({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=El(1);switch(l.type){case"base64":f=ks(Ta(o));break;case"binary":f=ks(o);break;case"buffer":case"array":f=o;break}ji(f,0);var p=f.read_shift(1),m=!!(p&136),h=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:h=!0,m=!0;break;case 49:h=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,b=521;p==2&&(x=f.read_shift(2)),f.l+=3,p!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(b=f.read_shift(2));var y=f.read_shift(2),w=l.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var _=[],E={},O=Math.min(f.length,p==2?521:b-10-(h?264:0)),D=v?32:11;f.l<O&&f[f.l]!=13;)switch(E={},E.name=c5.utils.decode(w,f.slice(f.l,f.l+D)).replace(/[\u0000\r\n].*$/g,""),f.l+=D,E.type=String.fromCharCode(f.read_shift(1)),p!=2&&!v&&(E.offset=f.read_shift(4)),E.len=f.read_shift(1),p==2&&(E.offset=f.read_shift(2)),E.dec=f.read_shift(1),E.name.length&&_.push(E),p!=2&&(f.l+=v?13:14),E.type){case"B":(!h||E.len!=8)&&l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(f[f.l]!==13&&(f.l=b-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=b;var T=0,C=0;for(u[0]=[],C=0;C!=_.length;++C)u[0][C]=_[C].name;for(;x-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++T]=[],C=0,C=0;C!=_.length;++C){var P=f.slice(f.l,f.l+_[C].len);f.l+=_[C].len,ji(P,0);var R=c5.utils.decode(w,P);switch(_[C].type){case"C":R.trim().length&&(u[T][C]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[T][C]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[T][C]=R;break;case"F":u[T][C]=parseFloat(R.trim());break;case"+":case"I":u[T][C]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[T][C]=!0;break;case"N":case"F":u[T][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[T][C]="##MEMO##"+(v?parseInt(R.trim(),10):P.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[T][C]=+R||0);break;case"@":u[T][C]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[T][C]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[T][C]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][C]=-P.read_shift(-8,"f");break;case"B":if(h&&_[C].len==8){u[T][C]=P.read_shift(8,"f");break}case"G":case"P":P.l+=_[C].len;break;case"0":if(_[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[C].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=mu(r(o,u),u);return f["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,f}function i(o,l){try{return Ol(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&cd(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=mi(),p=np(o,{header:1,raw:!0,cellDates:!0}),m=p[0],h=p.slice(1),v=o["!cols"]||[],x=0,b=0,y=0,w=1;for(x=0;x<m.length;++x){if(((v[x]||{}).DBF||{}).name){m[x]=v[x].DBF.name,++y;continue}if(m[x]!=null){if(++y,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(b=0;b<1024;++b)if(m.indexOf(m[x]+"_"+b)==-1){m[x]+="_"+b;break}}}}var _=wr(o["!ref"]),E=[],O=[],D=[];for(x=0;x<=_.e.c-_.s.c;++x){var T="",C="",P=0,R=[];for(b=0;b<h.length;++b)h[b][x]!=null&&R.push(h[b][x]);if(R.length==0||m[x]==null){E[x]="?";continue}for(b=0;b<R.length;++b){switch(typeof R[b]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=R[b]instanceof Date?"D":"C";break;default:C="C"}P=Math.max(P,String(R[b]).length),T=T&&T!=C?"C":C}P>250&&(P=250),C=((v[x]||{}).DBF||{}).type,C=="C"&&v[x].DBF.len>P&&(P=v[x].DBF.len),T=="B"&&C=="N"&&(T="N",D[x]=v[x].DBF.dec,P=v[x].DBF.len),O[x]=T=="C"||C=="N"?P:s[T]||0,w+=O[x],E[x]=T}var j=f.next(32);for(j.write_shift(4,318902576),j.write_shift(4,h.length),j.write_shift(2,296+32*y),j.write_shift(2,w),x=0;x<4;++x)j.write_shift(4,0);for(j.write_shift(4,0|(+t[U_]||3)<<8),x=0,b=0;x<m.length;++x)if(m[x]!=null){var A=f.next(32),q=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,q,"sbcs"),A.write_shift(1,E[x]=="?"?"C":E[x],"sbcs"),A.write_shift(4,b),A.write_shift(1,O[x]||s[E[x]]||0),A.write_shift(1,D[x]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),b+=O[x]||s[E[x]]||0}var J=f.next(264);for(J.write_shift(4,13),x=0;x<65;++x)J.write_shift(4,0);for(x=0;x<h.length;++x){var te=f.next(w);for(te.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(E[b]){case"L":te.write_shift(1,h[x][b]==null?63:h[x][b]?84:70);break;case"B":te.write_shift(8,h[x][b]||0,"f");break;case"N":var z="0";for(typeof h[x][b]=="number"&&(z=h[x][b].toFixed(D[b]||0)),y=0;y<O[b]-z.length;++y)te.write_shift(1,32);te.write_shift(1,z,"sbcs");break;case"D":h[x][b]?(te.write_shift(4,("0000"+h[x][b].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(h[x][b].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+h[x][b].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var B=String(h[x][b]!=null?h[x][b]:"").slice(0,O[b]);for(te.write_shift(1,B,"sbcs"),y=0;y<O[b]-B.length;++y)te.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),SL=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,h){var v=e[h];return typeof v=="number"?l5(v):v},n=function(m,h,v){var x=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?m:l5(x)};e["|"]=254;function i(m,h){switch(h.type){case"base64":return s(Ta(m),h);case"binary":return s(m,h);case"buffer":return s(Vt&&Buffer.isBuffer(m)?m.toString("binary"):Ed(m),h);case"array":return s(Bp(m),h)}throw new Error("Unrecognized type "+h.type)}function s(m,h){var v=m.split(/[\n\r]+/),x=-1,b=-1,y=0,w=0,_=[],E=[],O=null,D={},T=[],C=[],P=[],R=0,j;for(+h.codepage>=0&&cd(+h.codepage);y!==v.length;++y){R=0;var A=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=A.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),J=q[0],te;if(A.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&E.push(A.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,B=!1,G=!1,V=!1,Z=-1,he=-1;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"A":break;case"X":b=parseInt(q[w].slice(1))-1,B=!0;break;case"Y":for(x=parseInt(q[w].slice(1))-1,B||(b=0),j=_.length;j<=x;++j)_[j]=[];break;case"K":te=q[w].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(ba(te))?isNaN(fd(te).getDate())||(te=Qn(te)):(te=ba(te),O!==null&&Q_(O)&&(te=r3(te))),z=!0;break;case"E":V=!0;var k=bF(q[w].slice(1),{r:x,c:b});_[x][b]=[_[x][b],k];break;case"S":G=!0,_[x][b]=[_[x][b],"S5S"];break;case"G":break;case"R":Z=parseInt(q[w].slice(1))-1;break;case"C":he=parseInt(q[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}if(z&&(_[x][b]&&_[x][b].length==2?_[x][b][0]=te:_[x][b]=te,O=null),G){if(V)throw new Error("SYLK shared formula cannot have own formula");var I=Z>-1&&_[Z][he];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");_[x][b][1]=_F(I[1],{r:x-Z,c:b-he})}break;case"F":var M=0;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"X":b=parseInt(q[w].slice(1))-1,++M;break;case"Y":for(x=parseInt(q[w].slice(1))-1,j=_.length;j<=x;++j)_[j]=[];break;case"M":R=parseInt(q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":O=E[parseInt(q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=q[w].slice(1).split(" "),j=parseInt(P[0],10);j<=parseInt(P[1],10);++j)R=parseInt(P[2],10),C[j-1]=R===0?{hidden:!0}:{wch:R},yx(C[j-1]);break;case"C":b=parseInt(q[w].slice(1))-1,C[b]||(C[b]={});break;case"R":x=parseInt(q[w].slice(1))-1,T[x]||(T[x]={}),R>0?(T[x].hpt=R,T[x].hpx=H3(R)):R===0&&(T[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}M<1&&(O=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}}return T.length>0&&(D["!rows"]=T),C.length>0&&(D["!cols"]=C),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,D]}function a(m,h){var v=i(m,h),x=v[0],b=v[1],y=mu(x,h);return Tn(b).forEach(function(w){y[w]=b[w]}),y}function o(m,h){return Ol(a(m,h),h)}function l(m,h,v,x){var b="C;Y"+(v+1)+";X"+(x+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+bx(m.f,{r:v,c:x}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function u(m,h){h.forEach(function(v,x){var b="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?b+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Z0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ep(v.wpx)),typeof v.wch=="number"&&(b+=Math.round(v.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function f(m,h){h.forEach(function(v,x){var b="F;";v.hidden?b+="M0;":v.hpt?b+="M"+20*v.hpt+";":v.hpx&&(b+="M"+20*tp(v.hpx)+";"),b.length>2&&m.push(b+"R"+(x+1))})}function p(m,h){var v=["ID;PWXL;N;E"],x=[],b=wr(m["!ref"]),y,w=Array.isArray(m),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&u(v,m["!cols"]),m["!rows"]&&f(v,m["!rows"]),v.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var E=b.s.r;E<=b.e.r;++E)for(var O=b.s.c;O<=b.e.c;++O){var D=ir({r:E,c:O});y=w?(m[E]||[])[O]:m[D],!(!y||y.v==null&&(!y.f||y.F))&&x.push(l(y,m,E,O))}return v.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),NL=function(){function e(s,a){switch(a.type){case"base64":return t(Ta(s),a);case"binary":return t(s,a);case"buffer":return t(Vt&&Buffer.isBuffer(s)?s.toString("binary"):Ed(s),a);case"array":return t(Bp(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var m=o[f].trim().split(","),h=m[0],v=m[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+h){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(ba(v))?isNaN(fd(v).getDate())?p[l][u]=v:p[l][u]=Qn(v):p[l][u]=ba(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return mu(e(s,a),a)}function n(s,a){return Ol(r(s,a),a)}var i=function(){var s=function(l,u,f,p,m){l.push(u),l.push(f+","+p),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,u,f,p){l.push(u+","+f),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],f=wr(l["!ref"]),p,m=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){a(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var x=ir({r:h,c:v});if(p=m?(l[h]||[])[v]:l[x],!p){a(u,1,0,"");continue}switch(p.t){case"n":var b=p.w;!b&&p.v!=null&&(b=p.v),b==null?p.f&&!p.F?a(u,1,0,"="+p.f):a(u,1,0,""):a(u,0,b,"V");break;case"b":a(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Po(p.z||Fr[14],gi(Qn(p.v)))),a(u,0,p.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),B3=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,m){for(var h=p.split(`
`),v=-1,x=-1,b=0,y=[];b!==h.length;++b){var w=h[b].trim().split(":");if(w[0]==="cell"){var _=mn(w[1]);if(y.length<=_.r)for(v=y.length;v<=_.r;++v)y[v]||(y[v]=[]);switch(v=_.r,x=_.c,w[2]){case"t":y[v][x]=e(w[3]);break;case"v":y[v][x]=+w[3];break;case"vtf":var E=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[v][x]=!!+w[4];break;default:y[v][x]=+w[4];break}w[2]=="vtf"&&(y[v][x]=[y[v][x],E])}}}return m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}function n(p,m){return mu(r(p,m),m)}function i(p,m){return Ol(n(p,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var m=[],h=[],v,x="",b=Ri(p["!ref"]),y=Array.isArray(p),w=b.s.r;w<=b.e.r;++w)for(var _=b.s.c;_<=b.e.c;++_)if(x=ir({r:w,c:_}),v=y?(p[w]||[])[_]:p[x],!(!v||v.v==null||v.t==="z")){switch(h=["cell",x,"t"],v.t){case"s":case"str":h.push(t(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=t(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var E=gi(Qn(v.v));h[2]="vtc",h[3]="nd",h[4]=""+E,h[5]=v.w||Po(v.z||Fr[14],E);break;case"e":continue}m.push(h.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(p){return[s,a,o,a,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),kL=function(){function e(f,p,m,h,v){v.raw?p[m][h]=f:f===""||(f==="TRUE"?p[m][h]=!0:f==="FALSE"?p[m][h]=!1:isNaN(ba(f))?isNaN(fd(f).getDate())?p[m][h]=f:p[m][h]=Qn(f):p[m][h]=ba(f))}function t(f,p){var m=p||{},h=[];if(!f||f.length===0)return h;for(var v=f.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var b=10,y=0,w=0;w<=x;++w)y=v[w].indexOf(" "),y==-1?y=v[w].length:y++,b=Math.max(b,y);for(w=0;w<=x;++w){h[w]=[];var _=0;for(e(v[w].slice(0,b).trim(),h,w,_,m),_=1;_<=(v[w].length-b)/10+1;++_)e(v[w].slice(b+(_-1)*10,b+_*10).trim(),h,w,_,m)}return m.sheetRows&&(h=h.slice(0,m.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var p={},m=!1,h=0,v=0;h<f.length;++h)(v=f.charCodeAt(h))==34?m=!m:!m&&v in r&&(p[v]=(p[v]||0)+1);v=[];for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h]);if(!v.length){p=n;for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h])}return v.sort(function(x,b){return x[0]-b[0]||n[x[1]]-n[b[1]]}),r[v.pop()[1]]||44}function s(f,p){var m=p||{},h="",v=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=i(f.slice(0,1024)):m&&m.FS?h=m.FS:h=i(f.slice(0,1024));var b=0,y=0,w=0,_=0,E=0,O=h.charCodeAt(0),D=!1,T=0,C=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var P=m.dateNF!=null?z7(m.dateNF):null;function R(){var j=f.slice(_,E),A={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)A.t="z";else if(m.raw)A.t="s",A.v=j;else if(j.trim().length===0)A.t="s",A.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(A.t="s",A.v=j.slice(2,-1).replace(/""/g,'"')):SF(j)?(A.t="n",A.f=j.slice(1)):(A.t="s",A.v=j);else if(j=="TRUE")A.t="b",A.v=!0;else if(j=="FALSE")A.t="b",A.v=!1;else if(!isNaN(w=ba(j)))A.t="n",m.cellText!==!1&&(A.w=j),A.v=w;else if(!isNaN(fd(j).getDate())||P&&j.match(P)){A.z=m.dateNF||Fr[14];var q=0;P&&j.match(P)&&(j=W7(j,m.dateNF,j.match(P)||[]),q=1),m.cellDates?(A.t="d",A.v=Qn(j,q)):(A.t="n",A.v=gi(Qn(j,q))),m.cellText!==!1&&(A.w=Po(A.z,A.v instanceof Date?gi(A.v):A.v)),m.cellNF||delete A.z}else A.t="s",A.v=j;if(A.t=="z"||(m.dense?(v[b]||(v[b]=[]),v[b][y]=A):v[ir({c:y,r:b})]=A),_=E+1,C=f.charCodeAt(_),x.e.c<y&&(x.e.c=y),x.e.r<b&&(x.e.r=b),T==O)++y;else if(y=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;E<f.length;++E)switch(T=f.charCodeAt(E)){case 34:C===34&&(D=!D);break;case O:case 10:case 13:if(!D&&R())break e;break}return E-_>0&&R(),v["!ref"]=Xr(x),v}function a(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,p):mu(t(f,p),p)}function o(f,p){var m="",h=p.type=="string"?[0,0,0,0]:RI(f,p);switch(p.type){case"base64":m=Ta(f);break;case"binary":m=f;break;case"buffer":p.codepage==65001?m=f.toString("utf8"):(p.codepage,m=Vt&&Buffer.isBuffer(f)?f.toString("binary"):Ed(f));break;case"array":m=Bp(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+p.type)}return h[0]==239&&h[1]==187&&h[2]==191?m=Df(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=Df(m):p.type=="binary",m.slice(0,19)=="socialcalc:version:"?B3.to_sheet(p.type=="string"?m:Df(m),p):a(m,p)}function l(f,p){return Ol(o(f,p),p)}function u(f){for(var p=[],m=wr(f["!ref"]),h,v=Array.isArray(f),x=m.s.r;x<=m.e.r;++x){for(var b=[],y=m.s.c;y<=m.e.c;++y){var w=ir({r:x,c:y});if(h=v?(f[x]||[])[y]:f[w],!h||h.v==null){b.push("          ");continue}for(var _=(h.w||(ja(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";b.push(_+(y===0?" ":""))}p.push(b.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),U5=function(){function e(k,I,M){if(k){ji(k,k.l||0);for(var L=M.Enum||Z;k.l<k.length;){var H=k.read_shift(2),se=L[H]||L[65535],fe=k.read_shift(2),de=k.l+fe,ve=se.f&&se.f(k,fe,M);if(k.l=de,I(ve,se,H))return}}}function t(k,I){switch(I.type){case"base64":return r(ks(Ta(k)),I);case"binary":return r(ks(k),I);case"buffer":case"array":return r(k,I)}throw"Unsupported type "+I.type}function r(k,I){if(!k)return k;var M=I||{},L=M.dense?[]:{},H="Sheet1",se="",fe=0,de={},ve=[],Ee=[],Oe={s:{r:0,c:0},e:{r:0,c:0}},qe=M.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)M.Enum=Z,e(k,function(Me,at,ze){switch(ze){case 0:M.vers=Me,Me>=4096&&(M.qpro=!0);break;case 6:Oe=Me;break;case 204:Me&&(se=Me);break;case 222:se=Me;break;case 15:case 51:M.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:ze==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=M.dateNF||Fr[14],M.cellDates&&(Me[1].t="d",Me[1].v=r3(Me[1].v))),M.qpro&&Me[3]>fe&&(L["!ref"]=Xr(Oe),de[H]=L,ve.push(H),L=M.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],H=se||"Sheet"+(fe+1),se="");var Ye=M.dense?(L[Me[0].r]||[])[Me[0].c]:L[ir(Me[0])];if(Ye){Ye.t=Me[1].t,Ye.v=Me[1].v,Me[1].z!=null&&(Ye.z=Me[1].z),Me[1].f!=null&&(Ye.f=Me[1].f);break}M.dense?(L[Me[0].r]||(L[Me[0].r]=[]),L[Me[0].r][Me[0].c]=Me[1]):L[ir(Me[0])]=Me[1];break}},M);else if(k[2]==26||k[2]==14)M.Enum=he,k[2]==14&&(M.qpro=!0,k.l=0),e(k,function(Me,at,ze){switch(ze){case 204:H=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>fe&&(L["!ref"]=Xr(Oe),de[H]=L,ve.push(H),L=M.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],H="Sheet"+(fe+1)),qe>0&&Me[0].r>=qe)break;M.dense?(L[Me[0].r]||(L[Me[0].r]=[]),L[Me[0].r][Me[0].c]=Me[1]):L[ir(Me[0])]=Me[1],Oe.e.c<Me[0].c&&(Oe.e.c=Me[0].c),Oe.e.r<Me[0].r&&(Oe.e.r=Me[0].r);break;case 27:Me[14e3]&&(Ee[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Ee[Me[0]]=Me[1],Me[0]==fe&&(H=Me[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(L["!ref"]=Xr(Oe),de[se||H]=L,ve.push(se||H),!Ee.length)return{SheetNames:ve,Sheets:de};for(var Qe={},je=[],ue=0;ue<Ee.length;++ue)de[ve[ue]]?(je.push(Ee[ue]||ve[ue]),Qe[Ee[ue]]=de[Ee[ue]]||de[ve[ue]]):(je.push(Ee[ue]),Qe[Ee[ue]]={"!ref":"A1"});return{SheetNames:je,Sheets:Qe}}function n(k,I){var M=I||{};if(+M.codepage>=0&&cd(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var L=mi(),H=wr(k["!ref"]),se=Array.isArray(k),fe=[];Je(L,0,s(1030)),Je(L,6,l(H));for(var de=Math.min(H.e.r,8191),ve=H.s.r;ve<=de;++ve)for(var Ee=En(ve),Oe=H.s.c;Oe<=H.e.c;++Oe){ve===H.s.r&&(fe[Oe]=zn(Oe));var qe=fe[Oe]+Ee,Qe=se?(k[ve]||[])[Oe]:k[qe];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")(Qe.v|0)==Qe.v&&Qe.v>=-32768&&Qe.v<=32767?Je(L,13,h(ve,Oe,Qe.v)):Je(L,14,x(ve,Oe,Qe.v));else{var je=ja(Qe);Je(L,15,p(ve,Oe,je.slice(0,239)))}}return Je(L,1),L.end()}function i(k,I){var M=I||{};if(+M.codepage>=0&&cd(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var L=mi();Je(L,0,a(k));for(var H=0,se=0;H<k.SheetNames.length;++H)(k.Sheets[k.SheetNames[H]]||{})["!ref"]&&Je(L,27,V(k.SheetNames[H],se++));var fe=0;for(H=0;H<k.SheetNames.length;++H){var de=k.Sheets[k.SheetNames[H]];if(!(!de||!de["!ref"])){for(var ve=wr(de["!ref"]),Ee=Array.isArray(de),Oe=[],qe=Math.min(ve.e.r,8191),Qe=ve.s.r;Qe<=qe;++Qe)for(var je=En(Qe),ue=ve.s.c;ue<=ve.e.c;++ue){Qe===ve.s.r&&(Oe[ue]=zn(ue));var Me=Oe[ue]+je,at=Ee?(de[Qe]||[])[ue]:de[Me];if(!(!at||at.t=="z"))if(at.t=="n")Je(L,23,R(Qe,ue,fe,at.v));else{var ze=ja(at);Je(L,22,T(Qe,ue,fe,ze.slice(0,239)))}}++fe}}return Je(L,1),L.end()}function s(k){var I=Fe(2);return I.write_shift(2,k),I}function a(k){var I=Fe(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var M=0,L=0,H=0,se=0;se<k.SheetNames.length;++se){var fe=k.SheetNames[se],de=k.Sheets[fe];if(!(!de||!de["!ref"])){++H;var ve=Ri(de["!ref"]);M<ve.e.r&&(M=ve.e.r),L<ve.e.c&&(L=ve.e.c)}}return M>8191&&(M=8191),I.write_shift(2,M),I.write_shift(1,H),I.write_shift(1,L),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(k,I,M){var L={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&M.qpro?(L.s.c=k.read_shift(1),k.l++,L.s.r=k.read_shift(2),L.e.c=k.read_shift(1),k.l++,L.e.r=k.read_shift(2),L):(L.s.c=k.read_shift(2),L.s.r=k.read_shift(2),I==12&&M.qpro&&(k.l+=2),L.e.c=k.read_shift(2),L.e.r=k.read_shift(2),I==12&&M.qpro&&(k.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function l(k){var I=Fe(8);return I.write_shift(2,k.s.c),I.write_shift(2,k.s.r),I.write_shift(2,k.e.c),I.write_shift(2,k.e.r),I}function u(k,I,M){var L=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(L[0].c=k.read_shift(1),L[3]=k.read_shift(1),L[0].r=k.read_shift(2),k.l+=2):(L[2]=k.read_shift(1),L[0].c=k.read_shift(2),L[0].r=k.read_shift(2)),L}function f(k,I,M){var L=k.l+I,H=u(k,I,M);if(H[1].t="s",M.vers==20768){k.l++;var se=k.read_shift(1);return H[1].v=k.read_shift(se,"utf8"),H}return M.qpro&&k.l++,H[1].v=k.read_shift(L-k.l,"cstr"),H}function p(k,I,M){var L=Fe(7+M.length);L.write_shift(1,255),L.write_shift(2,I),L.write_shift(2,k),L.write_shift(1,39);for(var H=0;H<L.length;++H){var se=M.charCodeAt(H);L.write_shift(1,se>=128?95:se)}return L.write_shift(1,0),L}function m(k,I,M){var L=u(k,I,M);return L[1].v=k.read_shift(2,"i"),L}function h(k,I,M){var L=Fe(7);return L.write_shift(1,255),L.write_shift(2,I),L.write_shift(2,k),L.write_shift(2,M,"i"),L}function v(k,I,M){var L=u(k,I,M);return L[1].v=k.read_shift(8,"f"),L}function x(k,I,M){var L=Fe(13);return L.write_shift(1,255),L.write_shift(2,I),L.write_shift(2,k),L.write_shift(8,M,"f"),L}function b(k,I,M){var L=k.l+I,H=u(k,I,M);if(H[1].v=k.read_shift(8,"f"),M.qpro)k.l=L;else{var se=k.read_shift(2);E(k.slice(k.l,k.l+se),H),k.l+=se}return H}function y(k,I,M){var L=I&32768;return I&=-32769,I=(L?k:0)+(I>=8192?I-16384:I),(L?"":"$")+(M?zn(I):En(I))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(k,I){ji(k,0);for(var M=[],L=0,H="",se="",fe="",de="";k.l<k.length;){var ve=k[k.l++];switch(ve){case 0:M.push(k.read_shift(8,"f"));break;case 1:se=y(I[0].c,k.read_shift(2),!0),H=y(I[0].r,k.read_shift(2),!1),M.push(se+H);break;case 2:{var Ee=y(I[0].c,k.read_shift(2),!0),Oe=y(I[0].r,k.read_shift(2),!1);se=y(I[0].c,k.read_shift(2),!0),H=y(I[0].r,k.read_shift(2),!1),M.push(Ee+Oe+":"+se+H)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(k.read_shift(2));break;case 6:{for(var qe="";ve=k[k.l++];)qe+=String.fromCharCode(ve);M.push('"'+qe.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:de=M.pop(),fe=M.pop(),M.push(["AND","OR"][ve-20]+"("+fe+","+de+")");break;default:if(ve<32&&_[ve])de=M.pop(),fe=M.pop(),M.push(fe+_[ve]+de);else if(w[ve]){if(L=w[ve][1],L==69&&(L=k[k.l++]),L>M.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+M.join("|")+"|");return}var Qe=M.slice(-L);M.length-=L,M.push(w[ve][0]+"("+Qe.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}M.length==1?I[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function O(k){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=k.read_shift(2),I[3]=k[k.l++],I[0].c=k[k.l++],I}function D(k,I){var M=O(k);return M[1].t="s",M[1].v=k.read_shift(I-4,"cstr"),M}function T(k,I,M,L){var H=Fe(6+L.length);H.write_shift(2,k),H.write_shift(1,M),H.write_shift(1,I),H.write_shift(1,39);for(var se=0;se<L.length;++se){var fe=L.charCodeAt(se);H.write_shift(1,fe>=128?95:fe)}return H.write_shift(1,0),H}function C(k,I){var M=O(k);M[1].v=k.read_shift(2);var L=M[1].v>>1;if(M[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return M[1].v=L,M}function P(k,I){var M=O(k),L=k.read_shift(4),H=k.read_shift(4),se=k.read_shift(2);if(se==65535)return L===0&&H===3221225472?(M[1].t="e",M[1].v=15):L===0&&H===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var fe=se&32768;return se=(se&32767)-16446,M[1].v=(1-fe*2)*(H*Math.pow(2,se+32)+L*Math.pow(2,se)),M}function R(k,I,M,L){var H=Fe(14);if(H.write_shift(2,k),H.write_shift(1,M),H.write_shift(1,I),L==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var se=0,fe=0,de=0,ve=0;return L<0&&(se=1,L=-L),fe=Math.log2(L)|0,L/=Math.pow(2,fe-31),ve=L>>>0,ve&2147483648||(L/=2,++fe,ve=L>>>0),L-=ve,ve|=2147483648,ve>>>=0,L*=Math.pow(2,32),de=L>>>0,H.write_shift(4,de),H.write_shift(4,ve),fe+=16383+(se?32768:0),H.write_shift(2,fe),H}function j(k,I){var M=P(k);return k.l+=I-14,M}function A(k,I){var M=O(k),L=k.read_shift(4);return M[1].v=L>>6,M}function q(k,I){var M=O(k),L=k.read_shift(8,"f");return M[1].v=L,M}function J(k,I){var M=q(k);return k.l+=I-10,M}function te(k,I){return k[k.l+I-1]==0?k.read_shift(I,"cstr"):""}function z(k,I){var M=k[k.l++];M>I-1&&(M=I-1);for(var L="";L.length<M;)L+=String.fromCharCode(k[k.l++]);return L}function B(k,I,M){if(!(!M.qpro||I<21)){var L=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var H=k.read_shift(I-21,"cstr");return[L,H]}}function G(k,I){for(var M={},L=k.l+I;k.l<L;){var H=k.read_shift(2);if(H==14e3){for(M[H]=[0,""],M[H][0]=k.read_shift(2);k[k.l];)M[H][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return M}function V(k,I){var M=Fe(5+k.length);M.write_shift(2,14e3),M.write_shift(2,I);for(var L=0;L<k.length;++L){var H=k.charCodeAt(L);M[M.l++]=H>127?95:H}return M[M.l++]=0,M}var Z={0:{n:"BOF",f:O3},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:B},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),EL=/^\s|\s$|[\t\n\r]/;function U3(e,t){if(!t.bookSST)return"";var r=[Qr];r[r.length]=Xe("sst",null,{xmlns:pu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(EL)&&(s+=' xml:space="preserve"'),s+=">"+rr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function AL(e){return[e.read_shift(4),e.read_shift(4)]}function TL(e,t){return t||(t=Fe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var jL=yP;function CL(e){var t=mi();Be(t,159,TL(e));for(var r=0;r<e.length;++r)Be(t,19,jL(e[r]));return Be(t,160),t.end()}function PL(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function z3(e){var t=0,r,n=PL(e),i=n.length+1,s,a,o,l,u;for(r=El(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^a;return t^52811}var LL=function(){function e(i,s){switch(s.type){case"base64":return t(Ta(i),s);case"binary":return t(i,s);case"buffer":return t(Vt&&Buffer.isBuffer(i)?i.toString("binary"):Ed(i),s);case"array":return t(Bp(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var m=/\\\w+\b/g,h=0,v,x=-1;v=m.exec(f);){switch(v[0]){case"\\cell":var b=f.slice(h,m.lastIndex-v[0].length);if(b[0]==" "&&(b=b.slice(1)),++x,b.length){var y={v:b,t:"s"};Array.isArray(o)?o[p][x]=y:o[ir({r:p,c:x})]=y}break}h=m.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Xr(u),o}function r(i,s){return Ol(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=wr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var p=ir({r:u,c:f});o=l?(i[u]||[])[f]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ja(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function z5(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var FL=6,_a=FL;function Z0(e){return Math.floor((e+Math.round(128/_a)/256)*_a)}function ep(e){return Math.floor((e-5)/_a*100+.5)/100}function Kg(e){return Math.round((e*_a+5)/_a*256)/256}function yx(e){e.width?(e.wpx=Z0(e.width),e.wch=ep(e.wpx),e.MDW=_a):e.wpx?(e.wch=ep(e.wpx),e.width=Kg(e.wch),e.MDW=_a):typeof e.wch=="number"&&(e.width=Kg(e.wch),e.wpx=Z0(e.width),e.MDW=_a),e.customWidth&&delete e.customWidth}var OL=96,W3=OL;function tp(e){return e*96/W3}function H3(e){return e*W3/96}function DL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Xe("numFmt",null,{numFmtId:n,formatCode:rr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function IL(e){var t=[];return t[t.length]=Xe("cellXfs",null),e.forEach(function(r){t[t.length]=Xe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function $3(e,t){var r=[Qr,Xe("styleSheet",null,{xmlns:pu[0],"xmlns:vt":hn.vt})],n;return e.SSF&&(n=DL(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=IL(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function RL(e,t){var r=e.read_shift(2),n=Wn(e);return[r,n]}function ML(e,t,r){r||(r=Fe(6+4*t.length)),r.write_shift(2,e),gn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function BL(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=EP(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=kP(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wn(e),n}function UL(e,t){t||(t=Fe(25+4*32)),t.write_shift(2,e.sz*20),AP(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),J0(e.color,t);var n=0;return n=2,t.write_shift(1,n),gn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var zL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],w1,WL=Zs;function W5(e,t){t||(t=Fe(4*3+8*7+16*1)),w1||(w1=ox(zL));var r=w1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(J0({auto:1},t),J0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function HL(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function q3(e,t,r){r||(r=Fe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function of(e,t){return t||(t=Fe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var $L=Zs;function qL(e,t){return t||(t=Fe(51)),t.write_shift(1,0),of(null,t),of(null,t),of(null,t),of(null,t),of(null,t),t.length>t.l?t.slice(0,t.l):t}function VL(e,t){return t||(t=Fe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),X0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function GL(e,t,r){var n=Fe(2052);return n.write_shift(4,e),X0(t,n),X0(r,n),n.length>n.l?n.slice(0,n.l):n}function YL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Be(e,615,js(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Be(e,44,ML(i,t[i]))}),Be(e,616))}}function KL(e){var t=1;Be(e,611,js(t)),Be(e,43,UL({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(e,612)}function XL(e){var t=2;Be(e,603,js(t)),Be(e,45,W5({patternType:"none"})),Be(e,45,W5({patternType:"gray125"})),Be(e,604)}function JL(e){var t=1;Be(e,613,js(t)),Be(e,46,qL()),Be(e,614)}function QL(e){var t=1;Be(e,626,js(t)),Be(e,47,q3({numFmtId:0},65535)),Be(e,627)}function ZL(e,t){Be(e,617,js(t.length)),t.forEach(function(r){Be(e,47,q3(r,0))}),Be(e,618)}function eF(e){var t=1;Be(e,619,js(t)),Be(e,48,VL({xfId:0,name:"Normal"})),Be(e,620)}function tF(e){var t=0;Be(e,505,js(t)),Be(e,506)}function rF(e){var t=0;Be(e,508,GL(t,"TableStyleMedium9","PivotStyleMedium4")),Be(e,509)}function nF(e,t){var r=mi();return Be(r,278),YL(r,e.SSF),KL(r),XL(r),JL(r),QL(r),ZL(r,t.cellXfs),eF(r),tF(r),rF(r),Be(r,279),r.end()}function V3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function iF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wn(e)}}function sF(e){var t=Fe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),gn(e.name,t),t.slice(0,t.l)}function aF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function oF(e){var t=Fe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function lF(e,t){var r=Fe(8+2*t.length);return r.write_shift(4,e),gn(t,r),r.slice(0,r.l)}function cF(e){return e.l+=4,e.read_shift(4)!=0}function uF(e,t){var r=Fe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function fF(){var e=mi();return Be(e,332),Be(e,334,js(1)),Be(e,335,sF({name:"XLDAPR",version:12e4,flags:3496657072})),Be(e,336),Be(e,339,lF(1,"XLDAPR")),Be(e,52),Be(e,35,js(514)),Be(e,4096,js(0)),Be(e,4097,Ji(1)),Be(e,36),Be(e,53),Be(e,340),Be(e,337,uF(1)),Be(e,51,oF([[1,0]])),Be(e,338),Be(e,333),e.end()}function G3(){var e=[Qr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function dF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ir(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Dc=1024;function Y3(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Xe("xml",null,{"xmlns:v":Ci.v,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:mv":Ci.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Dc<e*1e3;)Dc+=1e3;return t.forEach(function(s){var a=mn(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Xe("v:fill",l,o),f={on:"t",obscured:"t"};++Dc,i=i.concat(["<v:shape"+hd({id:"_x0000_s"+Dc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Xe("v:shadow",null,f),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Nn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Nn("x:AutoFill","False"),Nn("x:Row",String(a.r)),Nn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function K3(e){var t=[Qr,Xe("comments",null,{xmlns:pu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=rr(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(rr(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Nn("t",rr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Nn("t",rr(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function hF(e,t,r){var n=[Qr,Xe("ThreadedComments",null,{xmlns:hn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(Xe("threadedComment",Nn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function pF(e){var t=[Qr,Xe("personList",null,{xmlns:hn.TCMNT,"xmlns:x":pu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function mF(e){var t={};t.iauthor=e.read_shift(4);var r=Ml(e);return t.rfx=r.s,t.ref=ir(r.s),e.l+=16,t}function gF(e,t){return t==null&&(t=Fe(36)),t.write_shift(4,e[1].iauthor),gu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var xF=Wn;function vF(e){return gn(e.slice(0,54))}function yF(e){var t=mi(),r=[];return Be(t,628),Be(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Be(t,632,vF(i.a)))})}),Be(t,631),Be(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:mn(n[0]),e:mn(n[0])};Be(t,635,gF([s,i])),i.t&&i.t.length>0&&Be(t,637,bP(i)),Be(t,636),delete i.iauthor})}),Be(t,634),Be(t,629),t.end()}function wF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&or.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var X3=["xlsb","xlsm","xlam","biff8","xla"],bF=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,i+(o?"":"$")+zn(f)+(l?"":"$")+En(u)}return function(i,s){return t=s,i.replace(e,r)}}(),wx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bx=function(){return function(t,r){return t.replace(wx,function(n,i,s,a,o,l){var u=px(a)-(s?0:r.c),f=hx(l)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",m=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+m})}}();function _F(e,t){return e.replace(wx,function(r,n,i,s,a,o){return n+(i=="$"?i+s:zn(px(s)+t.c))+(a=="$"?a+o:En(hx(o)+t.r))})}function SF(e){return e.length!=1}function Gr(e){e.l+=1}function Lo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function J3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Q3(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=Lo(e),o=Lo(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Q3(e){var t=Lo(e),r=Lo(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function NF(e,t,r){if(r.biff<8)return Q3(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Lo(e),a=Lo(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Z3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return kF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Lo(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function kF(e){var t=Lo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function EF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function AF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return TF(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function TF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function jF(e,t,r){var n=(e[e.l++]&96)>>5,i=J3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function CF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=J3(e,s,r);return[n,i,a]}function PF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function LF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function FF(e,t,r){var n=(e[e.l++]&96)>>5,i=NF(e,t-1,r);return[n,i]}function OF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function H5(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function DF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function IF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function RF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function MF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function BF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function eS(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function UF(e){return e.read_shift(2),eS(e)}function zF(e){return e.read_shift(2),eS(e)}function WF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Z3(e,0,r);return[n,i]}function HF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=AF(e,0,r);return[n,i]}function $F(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Z3(e,0,r);return[n,i,s]}function qF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[qO[i],nS[i],n]}function VF(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:GF(e);return[i,(s[0]===0?nS:$O)[s[1]]]}function GF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function YF(e,t,r){e.l+=r&&r.biff==2?3:4}function KF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function XF(e){return e.l++,jd[e.read_shift(1)]}function JF(e){return e.l++,e.read_shift(2)}function QF(e){return e.l++,e.read_shift(1)!==0}function ZF(e){return e.l++,xu(e)}function eO(e,t,r){return e.l++,I3(e,t-1,r)}function tO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=$P(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=jd[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=xu(e);break;case 2:r[1]=YP(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function rO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Ml:JP)(e));return i}function nO(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=tO(e,r.biff);return a}function iO(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function sO(e,t,r){if(r.biff==5)return aO(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function aO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function oO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function lO(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function cO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function uO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var fO=Zs,dO=Zs,hO=Zs;function Cd(e,t,r){return e.l+=2,[EF(e)]}function _x(e){return e.l+=6,[]}var pO=Cd,mO=_x,gO=_x,xO=Cd;function tS(e){return e.l+=2,[O3(e),e.read_shift(2)&1]}var vO=Cd,yO=tS,wO=_x,bO=Cd,_O=Cd,SO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=SO[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function kO(e){return e.l+=2,[e.read_shift(4)]}function EO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function AO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function TO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function CO(e){return e.l+=4,[0,0]}var $5={1:{n:"PtgExp",f:KF},2:{n:"PtgTbl",f:hO},3:{n:"PtgAdd",f:Gr},4:{n:"PtgSub",f:Gr},5:{n:"PtgMul",f:Gr},6:{n:"PtgDiv",f:Gr},7:{n:"PtgPower",f:Gr},8:{n:"PtgConcat",f:Gr},9:{n:"PtgLt",f:Gr},10:{n:"PtgLe",f:Gr},11:{n:"PtgEq",f:Gr},12:{n:"PtgGe",f:Gr},13:{n:"PtgGt",f:Gr},14:{n:"PtgNe",f:Gr},15:{n:"PtgIsect",f:Gr},16:{n:"PtgUnion",f:Gr},17:{n:"PtgRange",f:Gr},18:{n:"PtgUplus",f:Gr},19:{n:"PtgUminus",f:Gr},20:{n:"PtgPercent",f:Gr},21:{n:"PtgParen",f:Gr},22:{n:"PtgMissArg",f:Gr},23:{n:"PtgStr",f:eO},26:{n:"PtgSheet",f:EO},27:{n:"PtgEndSheet",f:AO},28:{n:"PtgErr",f:XF},29:{n:"PtgBool",f:QF},30:{n:"PtgInt",f:JF},31:{n:"PtgNum",f:ZF},32:{n:"PtgArray",f:OF},33:{n:"PtgFunc",f:qF},34:{n:"PtgFuncVar",f:VF},35:{n:"PtgName",f:iO},36:{n:"PtgRef",f:WF},37:{n:"PtgArea",f:jF},38:{n:"PtgMemArea",f:oO},39:{n:"PtgMemErr",f:fO},40:{n:"PtgMemNoMem",f:dO},41:{n:"PtgMemFunc",f:lO},42:{n:"PtgRefErr",f:cO},43:{n:"PtgAreaErr",f:PF},44:{n:"PtgRefN",f:HF},45:{n:"PtgAreaN",f:FF},46:{n:"PtgMemAreaN",f:TO},47:{n:"PtgMemNoMemN",f:jO},57:{n:"PtgNameX",f:sO},58:{n:"PtgRef3d",f:$F},59:{n:"PtgArea3d",f:CF},60:{n:"PtgRefErr3d",f:uO},61:{n:"PtgAreaErr3d",f:LF},255:{}},PO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},LO={1:{n:"PtgElfLel",f:tS},2:{n:"PtgElfRw",f:bO},3:{n:"PtgElfCol",f:pO},6:{n:"PtgElfRwV",f:_O},7:{n:"PtgElfColV",f:xO},10:{n:"PtgElfRadical",f:vO},11:{n:"PtgElfRadicalS",f:wO},13:{n:"PtgElfColS",f:mO},15:{n:"PtgElfColSV",f:gO},16:{n:"PtgElfRadicalLel",f:yO},25:{n:"PtgList",f:NO},29:{n:"PtgSxName",f:kO},255:{}},FO={0:{n:"PtgAttrNoop",f:CO},1:{n:"PtgAttrSemi",f:BF},2:{n:"PtgAttrIf",f:RF},4:{n:"PtgAttrChoose",f:DF},8:{n:"PtgAttrGoto",f:IF},16:{n:"PtgAttrSum",f:YF},32:{n:"PtgAttrBaxcel",f:H5},33:{n:"PtgAttrBaxcel",f:H5},64:{n:"PtgAttrSpace",f:UF},65:{n:"PtgAttrSpaceSemi",f:zF},128:{n:"PtgAttrIfError",f:MF},255:{}};function OO(e,t,r,n){if(n.biff<8)return Zs(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=nO(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=rO(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Zs(e,t)),s}function DO(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=$5[s]||$5[PO[s]],(s===24||s===25)&&(i=(s===24?LO:FO)[e[e.l+1]]),!i||!i.f?Zs(e,t):a.push([i.n,i.f(e,t,r)]);return a}function IO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var RO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function MO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function rS(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function q5(e,t,r){var n=rS(e,t,r);return n=="#REF"?n:MO(n,r)}function nu(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,p=0,m=0,h,v="";if(!e[0]||!e[0][0])return"";for(var x=-1,b="",y=0,w=e[0].length;y<w;++y){var _=e[0][y];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:b=Lr(" ",e[0][x][1][1]);break;case 1:b=Lr("\r",e[0][x][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+b,x=-1}o.push(u+RO[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Rf(_[1][1],a,i),o.push(Mf(f,s));break;case"PtgRefN":f=r?Rf(_[1][1],r,i):_[1][1],o.push(Mf(f,s));break;case"PtgRef3d":p=_[1][1],f=Rf(_[1][2],a,i),v=q5(n,p,i),o.push(v+"!"+Mf(f,s));break;case"PtgFunc":case"PtgFuncVar":var E=_[1][0],O=_[1][1];E||(E=0),E&=127;var D=E==0?[]:o.slice(-E);o.length-=E,O==="User"&&(O=D.shift()),o.push(O+"("+D.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":h=j5(_[1][1],r?{s:r}:a,i),o.push(v1(h,i));break;case"PtgArea":h=j5(_[1][1],a,i),o.push(v1(h,i));break;case"PtgArea3d":p=_[1][1],h=_[1][2],v=q5(n,p,i),o.push(v+"!"+v1(h,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=_[1][2];var T=(n.names||[])[m-1]||(n[0]||[])[m],C=T?T.Name:"SH33TJSNAME"+String(m);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var P=_[1][1];m=_[1][2];var R;if(i.biff<=5)P<0&&(P=-P),n[P]&&(R=n[P][m]);else{var j="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][m]&&n[P][m].itab>0&&(j=n.SheetNames[n[P][m].itab-1]+"!"):j=n.SheetNames[m-1]+"!"),n[P]&&n[P][m])j+=n[P][m].Name;else if(n[0]&&n[0][m])j+=n[0][m].Name;else{var A=(rS(n,P,i)||"").split(";;");A[m-1]?j=A[m-1]:j+="SH33TJSERRX"}o.push(j);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var q="(",J=")";if(x>=0){switch(b="",e[0][x][1][0]){case 2:q=Lr(" ",e[0][x][1][1])+q;break;case 3:q=Lr("\r",e[0][x][1][1])+q;break;case 4:J=Lr(" ",e[0][x][1][1])+J;break;case 5:J=Lr("\r",e[0][x][1][1])+J;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(q+o.pop()+J);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var te={c:r.c,r:r.r};if(n.sharedf[ir(f)]){var z=n.sharedf[ir(f)];o.push(nu(z,a,te,n,i))}else{var B=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(nu(u[1],a,te,n,i)),B=!0;break}B||o.push(_[1])}break;case"PtgArray":o.push("{"+IO(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&G.indexOf(e[0][y][0])==-1){_=e[0][x];var V=!0;switch(_[1][0]){case 4:V=!1;case 0:b=Lr(" ",_[1][1]);break;case 5:V=!1;case 1:b=Lr("\r",_[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((V?b:"")+o.pop()+(V?"":b)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function BO(e){if(e==null){var t=Fe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Al(e);return Al(0)}function UO(e,t,r,n,i){var s=Tl(t,r,i),a=BO(e.v),o=Fe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Fe(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var p=Sn([s,a,o,u]);return p}function Up(e,t,r){var n=e.read_shift(4),i=DO(e,n,r),s=e.read_shift(4),a=s>0?OO(e,s,i,r):null;return[i,a]}var zO=Up,zp=Up,WO=Up,HO=Up,$O={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},nS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function VO(e){var t="of:="+e.replace(wx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function GO(e){return e.replace(/\./,"!")}var Bf=typeof Map<"u";function Sx(e,t,r){var n=0,i=e.length;if(r){if(Bf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Bf?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Bf?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Wp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(_a=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ep(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Kg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function iS(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Uo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Z_(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function YO(e,t,r){if(e&&e["!ref"]){var n=wr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function KO(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Xr(e[r])+'"/>';return t+"</mergeCells>"}function XO(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=dd(rr(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Xe("outlinePr",null,u)}!s&&!o||(i[i.length]=Xe("sheetPr",o,a))}var JO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],QO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ZO(e){var t={sheet:1};return JO.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),QO.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=z3(e.password).toString(16).toUpperCase()),Xe("sheetProtection",null,t)}function eD(e){return iS(e),Xe("pageMargins",null,e)}function tD(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Xe("col",null,Wp(i,n)));return r[r.length]="</cols>",r.join("")}function rD(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Xr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ri(i);a.s.r==a.e.r&&(a.e.r=Ri(t["!ref"]).e.r,i=Xr(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Xe("autoFilter",null,{ref:i})}function nD(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,i),{})}function iD(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=jd[e.v];break;case"d":n&&n.cellDates?i=Qn(e.v,-1).toISOString():(e=xi(e),e.t="n",i=""+(e.v=gi(Qn(e.v)))),typeof e.z>"u"&&(e.z=Fr[14]);break;default:i=e.v;break}var o=Nn("v",rr(i)),l={r:t},u=Uo(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Nn("v",""+Sx(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Xe("f",rr(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Xe("c",o,l)}function sD(e,t,r,n){var i=[],s=[],a=wr(e["!ref"]),o="",l,u="",f=[],p=0,m=0,h=e["!rows"],v=Array.isArray(e),x={r:u},b,y=-1;for(m=a.s.c;m<=a.e.c;++m)f[m]=zn(m);for(p=a.s.r;p<=a.e.r;++p){for(s=[],u=En(p),m=a.s.c;m<=a.e.c;++m){l=f[m]+u;var w=v?(e[p]||[])[m]:e[l];w!==void 0&&(o=iD(w,l,e,t))!=null&&s.push(o)}(s.length>0||h&&h[p])&&(x={r:u},h&&h[p]&&(b=h[p],b.hidden&&(x.hidden=1),y=-1,b.hpx?y=tp(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(x.ht=y,x.customHeight=1),b.level&&(x.outlineLevel=b.level)),i[i.length]=Xe("row",s.join(""),x))}if(h)for(;p<h.length;++p)h&&h[p]&&(x={r:p+1},b=h[p],b.hidden&&(x.hidden=1),y=-1,b.hpx?y=tp(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(x.ht=y,x.customHeight=1),b.level&&(x.outlineLevel=b.level),i[i.length]=Xe("row","",x));return i.join("")}function sS(e,t,r,n){var i=[Qr,Xe("worksheet",null,{xmlns:pu[0],"xmlns:r":hn.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=wr(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Xr(f)}n||(n={}),l["!comments"]=[];var p=[];XO(l,r,e,t,i),i[i.length]=Xe("dimension",null,{ref:u}),i[i.length]=nD(l,t,e,r),t.sheetFormat&&(i[i.length]=Xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=tD(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=sD(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=ZO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=rD(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=KO(l["!merges"]));var m=-1,h,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(h={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=er(n,-1,rr(x[1].Target).replace(/#.*$/,""),$t.HLINK),h["r:id"]="rId"+v),(m=x[1].Target.indexOf("#"))>-1&&(h.location=rr(x[1].Target.slice(m+1))),x[1].Tooltip&&(h.tooltip=rr(x[1].Tooltip)),i[i.length]=Xe("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=eD(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Nn("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(v=er(n,-1,"../drawings/drawing"+(e+1)+".xml",$t.DRAW),i[i.length]=Xe("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=p),l["!comments"].length>0&&(v=er(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",$t.VML),i[i.length]=Xe("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function aD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function oD(e,t,r){var n=Fe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=tp(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var p=-1,m=-1,h=f<<10;h<f+1<<10;++h){u.c=h;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ir(u)];v&&(p<0&&(p=h),m=h)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,m))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function lD(e,t,r,n){var i=oD(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Be(e,0,i)}var cD=Ml,uD=gu;function fD(){}function dD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=_P(e),r}function hD(e,t,r){r==null&&(r=Fe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return J0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),w3(e,r),r.slice(0,r.l)}function pD(e){var t=ss(e);return[t]}function mD(e,t,r){return r==null&&(r=Fe(8)),Dl(t,r)}function gD(e){var t=Il(e);return[t]}function xD(e,t,r){return r==null&&(r=Fe(4)),Rl(t,r)}function vD(e){var t=ss(e),r=e.read_shift(1);return[t,r,"b"]}function yD(e,t,r){return r==null&&(r=Fe(9)),Dl(t,r),r.write_shift(1,e.v?1:0),r}function wD(e){var t=Il(e),r=e.read_shift(1);return[t,r,"b"]}function bD(e,t,r){return r==null&&(r=Fe(5)),Rl(t,r),r.write_shift(1,e.v?1:0),r}function _D(e){var t=ss(e),r=e.read_shift(1);return[t,r,"e"]}function SD(e,t,r){return r==null&&(r=Fe(9)),Dl(t,r),r.write_shift(1,e.v),r}function ND(e){var t=Il(e),r=e.read_shift(1);return[t,r,"e"]}function kD(e,t,r){return r==null&&(r=Fe(8)),Rl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function ED(e){var t=ss(e),r=e.read_shift(4);return[t,r,"s"]}function AD(e,t,r){return r==null&&(r=Fe(12)),Dl(t,r),r.write_shift(4,t.v),r}function TD(e){var t=Il(e),r=e.read_shift(4);return[t,r,"s"]}function jD(e,t,r){return r==null&&(r=Fe(8)),Rl(t,r),r.write_shift(4,t.v),r}function CD(e){var t=ss(e),r=xu(e);return[t,r,"n"]}function PD(e,t,r){return r==null&&(r=Fe(16)),Dl(t,r),Al(e.v,r),r}function LD(e){var t=Il(e),r=xu(e);return[t,r,"n"]}function FD(e,t,r){return r==null&&(r=Fe(12)),Rl(t,r),Al(e.v,r),r}function OD(e){var t=ss(e),r=b3(e);return[t,r,"n"]}function DD(e,t,r){return r==null&&(r=Fe(12)),Dl(t,r),_3(e.v,r),r}function ID(e){var t=Il(e),r=b3(e);return[t,r,"n"]}function RD(e,t,r){return r==null&&(r=Fe(8)),Rl(t,r),_3(e.v,r),r}function MD(e){var t=ss(e),r=mx(e);return[t,r,"is"]}function BD(e){var t=ss(e),r=Wn(e);return[t,r,"str"]}function UD(e,t,r){return r==null&&(r=Fe(12+4*e.v.length)),Dl(t,r),gn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zD(e){var t=Il(e),r=Wn(e);return[t,r,"str"]}function WD(e,t,r){return r==null&&(r=Fe(8+4*e.v.length)),Rl(t,r),gn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function HD(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=zp(e,n-e.l,r);a[3]=nu(o,null,i,r.supbooks,r)}else e.l=n;return a}function $D(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=zp(e,n-e.l,r);a[3]=nu(o,null,i,r.supbooks,r)}else e.l=n;return a}function qD(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=xu(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=zp(e,n-e.l,r);a[3]=nu(o,null,i,r.supbooks,r)}else e.l=n;return a}function VD(e,t,r){var n=e.l+t,i=ss(e);i.r=r["!row"];var s=Wn(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=zp(e,n-e.l,r);a[3]=nu(o,null,i,r.supbooks,r)}else e.l=n;return a}var GD=Ml,YD=gu;function KD(e,t){return t==null&&(t=Fe(4)),t.write_shift(4,e),t}function XD(e,t){var r=e.l+t,n=Ml(e),i=gx(e),s=Wn(e),a=Wn(e),o=Wn(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function JD(e,t){var r=Fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));gu({s:mn(e[0]),e:mn(e[0])},r),xx("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return gn(i||"",r),gn(e[1].Tooltip||"",r),gn("",r),r.slice(0,r.l)}function QD(){}function ZD(e,t,r){var n=e.l+t,i=S3(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=zO(e,n-e.l,r);a[1]=o}else e.l=n;return a}function e9(e,t,r){var n=e.l+t,i=Ml(e),s=[i];if(r.cellFormula){var a=HO(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function t9(e,t,r){r==null&&(r=Fe(18));var n=Wp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var aS=["left","right","top","bottom","header","footer"];function r9(e){var t={};return aS.forEach(function(r){t[r]=xu(e)}),t}function n9(e,t){return t==null&&(t=Fe(6*8)),iS(e),aS.forEach(function(r){Al(e[r],t)}),t}function i9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function s9(e,t,r){r==null&&(r=Fe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function a9(e){var t=Fe(24);return t.write_shift(4,4),t.write_shift(4,1),gu(e,t),t}function o9(e,t){return t==null&&(t=Fe(16*4+2)),t.write_shift(2,e.password?z3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function l9(){}function c9(){}function u9(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=xi(t),t.z=t.z||Fr[14],t.v=gi(Qn(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Uo(i.cellXfs,t,i),t.l&&s["!links"].push([ir(l),t.l]),t.c&&s["!comments"].push([ir(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Sx(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?Be(e,18,jD(t,l)):Be(e,7,AD(t,l))):(l.t="str",a?Be(e,17,WD(t,l)):Be(e,6,UD(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Be(e,13,RD(t,l)):Be(e,2,DD(t,l)):a?Be(e,16,FD(t,l)):Be(e,5,PD(t,l)),!0;case"b":return l.t="b",a?Be(e,15,bD(t,l)):Be(e,4,yD(t,l)),!0;case"e":return l.t="e",a?Be(e,14,kD(t,l)):Be(e,3,SD(t,l)),!0}return a?Be(e,12,xD(t,l)):Be(e,1,mD(t,l)),!0}function f9(e,t,r,n){var i=wr(t["!ref"]||"A1"),s,a="",o=[];Be(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=En(f),lD(e,t,i,f);var p=!1;if(f<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){f===i.s.r&&(o[m]=zn(m)),s=o[m]+a;var h=l?(t[f]||[])[m]:t[s];if(!h){p=!1;continue}p=u9(e,h,f,m,n,t,p)}}Be(e,146)}function d9(e,t){!t||!t["!merges"]||(Be(e,177,KD(t["!merges"].length)),t["!merges"].forEach(function(r){Be(e,176,YD(r))}),Be(e,178))}function h9(e,t){!t||!t["!cols"]||(Be(e,390),t["!cols"].forEach(function(r,n){r&&Be(e,60,t9(n,r))}),Be(e,391))}function p9(e,t){!t||!t["!ref"]||(Be(e,648),Be(e,649,a9(wr(t["!ref"]))),Be(e,650))}function m9(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=er(r,-1,n[1].Target.replace(/#.*$/,""),$t.HLINK);Be(e,494,JD(n,i))}}),delete t["!links"]}function g9(e,t,r,n){if(t["!comments"].length>0){var i=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$t.VML);Be(e,551,xx("rId"+i)),t["!legacy"]=i}}function x9(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:Xr(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ri(s);o.s.r==o.e.r&&(o.e.r=Ri(t["!ref"]).e.r,s=Xr(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Be(e,161,gu(wr(s))),Be(e,162)}}function v9(e,t,r){Be(e,133),Be(e,137,s9(t,r)),Be(e,138),Be(e,134)}function y9(e,t){t["!protect"]&&Be(e,535,o9(t["!protect"]))}function w9(e,t,r,n){var i=mi(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=wr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Be(i,129),(r.vbaraw||a["!outline"])&&Be(i,147,hD(o,a["!outline"])),Be(i,148,uD(l)),v9(i,a,r.Workbook),h9(i,a),f9(i,a,e,t),y9(i,a),x9(i,a,r,e),d9(i,a),m9(i,a,n),a["!margins"]&&Be(i,476,n9(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&p9(i,a),g9(i,a,e,n),Be(i,130),i.end()}function b9(e,t){e.l+=10;var r=Wn(e);return{name:r}}var _9=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function S9(e){return!e.Workbook||!e.Workbook.WBProps?"false":eP(e.Workbook.WBProps.date1904)?"true":"false"}var N9="][*?/\\".split("");function oS(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return N9.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function k9(e,t,r){e.forEach(function(n,i){oS(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function E9(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];k9(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)YO(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function lS(e){var t=[Qr];t[t.length]=Xe("workbook",null,{xmlns:pu[0],"xmlns:r":hn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(_9.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Xe("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:rr(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Xe("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Xe("definedName",rr(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function A9(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Yg(e),r.name=Wn(e),r}function T9(e,t){return t||(t=Fe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),xx(e.strRelID,t),gn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function j9(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Wn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function C9(e,t){t||(t=Fe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),w3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function P9(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=SP(e),a=WO(e,0,r),o=gx(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function L9(e,t){Be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Be(e,156,T9(i))}Be(e,144)}function F9(e,t){t||(t=Fe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return gn("SheetJS",t),gn($0.version,t),gn($0.version,t),gn("7262",t),t.length>t.l?t.slice(0,t.l):t}function O9(e,t){t||(t=Fe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function D9(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Be(e,135),Be(e,158,O9(i)),Be(e,136))}}function I9(e,t){var r=mi();return Be(r,131),Be(r,128,F9()),Be(r,153,C9(e.Workbook&&e.Workbook.WBProps||null)),D9(r,e),L9(r,e),Be(r,132),r.end()}function R9(e,t,r){return(t.slice(-4)===".bin"?I9:lS)(e)}function M9(e,t,r,n,i){return(t.slice(-4)===".bin"?w9:sS)(e,r,n,i)}function B9(e,t,r){return(t.slice(-4)===".bin"?nF:$3)(e,r)}function U9(e,t,r){return(t.slice(-4)===".bin"?CL:U3)(e,r)}function z9(e,t,r){return(t.slice(-4)===".bin"?yF:K3)(e)}function W9(e){return(e.slice(-4)===".bin"?fF:G3)()}function H9(e,t){var r=[];return e.Props&&r.push(BP(e.Props,t)),e.Custprops&&r.push(UP(e.Props,e.Custprops)),r.join("")}function $9(){return""}function q9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Xe("NumberFormat",null,{"ss:Format":rr(Fr[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Xe("Style",s.join(""),a))}),Xe("Styles",r.join(""))}function cS(e){return Xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+bx(e.Ref,{r:0,c:0})})}function V9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(cS(i)))}return Xe("Names",r.join(""))}function G9(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(cS(o)))}return s.join("")}function Y9(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Xe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Xe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Nn("ProtectContents","True")),e["!protect"].objects&&i.push(Nn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Nn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Nn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Nn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Xe("WorksheetOptions",i.join(""),{xmlns:Ci.x})}function K9(e){return e.map(function(t){var r=Z7(t.t||""),n=Xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Xe("Comment",n,{"ss:Author":t.a})}).join("")}function X9(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+rr(bx(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=mn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=rr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=rr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var p="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",m=String(e.v);break;case"b":p="Boolean",m=e.v?"1":"0";break;case"e":p="Error",m=jd[e.v];break;case"d":p="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Fr[14]);break;case"s":p="String",m=Q7(e.v||"");break}var h=Uo(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=a.c+1;var v=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+p+'">'+v+"</Data>";return(e.c||[]).length>0&&(x+=K9(e.c)),Xe("Cell",x,o)}function J9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=H3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Q9(e,t,r,n){if(!e["!ref"])return"";var i=wr(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(b,y){yx(b);var w=!!b.width,_=Wp(y,b),E={"ss:Index":y+1};w&&(E["ss:Width"]=Z0(_.width)),b.hidden&&(E["ss:Hidden"]="1"),o.push(Xe("Column",null,E))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var f=[J9(u,(e["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>u)&&!(s[a].e.c<p)&&!(s[a].e.r<u)){(s[a].s.c!=p||s[a].s.r!=u)&&(m=!0);break}if(!m){var h={r:u,c:p},v=ir(h),x=l?(e[u]||[])[p]:e[v];f.push(X9(x,v,e,t,r,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Z9(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?G9(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?Q9(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(Y9(s,t,e,r)),n.join("")}function eI(e,t){t||(t={}),e.SSF||(e.SSF=xi(Fr)),e.SSF&&(Rp(),Ip(e.SSF),t.revssf=Mp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(H9(e,t)),r.push($9()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Xe("Worksheet",Z9(n,t,e),{"ss:Name":rr(e.SheetNames[n])}));return r[2]=q9(e,t),r[3]=V9(e),Qr+Xe("Workbook",r.join(""),{xmlns:Ci.ss,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:ss":Ci.ss,"xmlns:dt":Ci.dt,"xmlns:html":Ci.html})}var b1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function tI(e,t){var r=[],n=[],i=[],s=0,a,o=v5(P5,"n"),l=v5(L5,"n");if(e.Props)for(a=Tn(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Tn(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)F3.indexOf(i[s][0])>-1||C3.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&or.utils.cfb_add(t,"/SummaryInformation",R5(n,b1.SI,l,L5)),(r.length||u.length)&&or.utils.cfb_add(t,"/DocumentSummaryInformation",R5(r,b1.DSI,o,P5,u.length?u:null,b1.UDI))}function rI(e,t){var r=t||{},n=or.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return or.utils.cfb_add(n,i,uS(e,r)),r.biff==8&&(e.Props||e.Custprops)&&tI(e,n),r.biff==8&&e.vbaraw&&wF(n,or.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var nI={0:{f:aD},1:{f:pD},2:{f:OD},3:{f:_D},4:{f:vD},5:{f:CD},6:{f:BD},7:{f:ED},8:{f:VD},9:{f:qD},10:{f:HD},11:{f:$D},12:{f:gD},13:{f:ID},14:{f:ND},15:{f:wD},16:{f:LD},17:{f:zD},18:{f:TD},19:{f:mx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:P9},40:{},42:{},43:{f:BL},44:{f:RL},45:{f:WL},46:{f:$L},47:{f:HL},48:{},49:{f:gP},50:{},51:{f:aF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xL},62:{f:MD},63:{f:dF},64:{f:l9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:i9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dD},148:{f:cD,p:16},151:{f:QD},152:{},153:{f:j9},154:{},155:{},156:{f:A9},157:{},158:{},159:{T:1,f:AL},160:{T:-1},161:{T:1,f:Ml},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:iF},336:{T:-1},337:{f:cF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fL},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZD},427:{f:e9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:r9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xF},633:{T:1},634:{T:-1},635:{T:1,f:mF},636:{T:-1},637:{f:wP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:b9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:c9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Je(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&dx(r)&&e.push(r)}}function iI(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Je(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<i;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Pd(e,t,r){return e||(e=Fe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function sI(e,t,r,n){var i=Fe(9);return Pd(i,e,t),D3(r,n||"b",i),i}function aI(e,t,r){var n=Fe(8+2*r.length);return Pd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function oI(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?gi(Qn(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Je(e,2,bL(r,n,i)):Je(e,3,wL(r,n,i));return;case"b":case"e":Je(e,5,sI(r,n,t.v,t.t));return;case"s":case"str":Je(e,4,aI(r,n,(t.v||"").slice(0,255)));return}Je(e,1,Pd(null,r,n))}function lI(e,t,r,n){var i=Array.isArray(t),s=wr(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Xr(s)}for(var u=s.s.r;u<=s.e.r;++u){o=En(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=zn(f)),a=l[f]+o;var p=i?(t[u]||[])[f]:t[a];p&&oI(e,p,u,f)}}}function cI(e,t){for(var r=t||{},n=mi(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Je(n,r.biff==4?1033:r.biff==3?521:9,vx(e,16,r)),lI(n,e.Sheets[e.SheetNames[i]],i,r),Je(n,10),n.end()}function uI(e,t,r){Je(e,49,nL({sz:12,name:"Arial"},r))}function fI(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Je(e,1054,aL(i,t[i],r))})}function dI(e,t){var r=Fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Je(e,2151,r),r=Fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),M3(wr(t["!ref"]||"A1"),r),r.write_shift(4,4),Je(e,2152,r)}function hI(e,t){for(var r=0;r<16;++r)Je(e,224,B5({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Je(e,224,B5(n,0,t))})}function pI(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Je(e,440,pL(n)),n[1].Tooltip&&Je(e,2048,mL(n))}delete t["!links"]}function mI(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Je(e,125,vL(Wp(i,n),i))})}}function gI(e,t,r,n,i){var s=16+Uo(i.cellXfs,t,i);if(t.v==null&&!t.bf){Je(e,513,Tl(r,n,s));return}if(t.bf)Je(e,6,UO(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?gi(Qn(t.v)):t.v;Je(e,515,uL(r,n,a,s));break;case"b":case"e":Je(e,517,cL(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Sx(i.Strings,t.v,i.revStrings);Je(e,253,iL(r,n,o,s))}else Je(e,516,sL(r,n,(t.v||"").slice(0,255),s,i));break;default:Je(e,513,Tl(r,n,s))}}function xI(e,t,r){var n=mi(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,f,p="",m=[],h=wr(s["!ref"]||"A1"),v=u?65536:16384;if(h.e.c>255||h.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,v-1)}Je(n,2057,vx(r,16,t)),Je(n,13,Ji(1)),Je(n,12,Ji(100)),Je(n,15,Kn(!0)),Je(n,17,Kn(!1)),Je(n,16,Al(.001)),Je(n,95,Kn(!0)),Je(n,42,Kn(!1)),Je(n,43,Kn(!1)),Je(n,130,Ji(1)),Je(n,128,lL()),Je(n,131,Kn(!1)),Je(n,132,Kn(!1)),u&&mI(n,s["!cols"]),Je(n,512,oL(h,t)),u&&(s["!links"]=[]);for(var x=h.s.r;x<=h.e.r;++x){p=En(x);for(var b=h.s.c;b<=h.e.c;++b){x===h.s.r&&(m[b]=zn(b)),f=m[b]+p;var y=l?(s[x]||[])[b]:s[f];y&&(gI(n,y,x,b,t),u&&y.l&&s["!links"].push([f,y.l]))}}var w=o.CodeName||o.name||i;return u&&Je(n,574,rL((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&Je(n,229,hL(s["!merges"])),u&&pI(n,s),Je(n,442,R3(w)),u&&dI(n,s),Je(n,10),n.end()}function vI(e,t,r){var n=mi(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Je(n,2057,vx(e,5,r)),r.bookType=="xla"&&Je(n,135),Je(n,225,o?Ji(1200):null),Je(n,193,HP(2)),l&&Je(n,191),l&&Je(n,192),Je(n,226),Je(n,92,QP("SheetJS",r)),Je(n,66,Ji(o?1200:1252)),o&&Je(n,353,Ji(0)),o&&Je(n,448),Je(n,317,yL(e.SheetNames.length)),o&&e.vbaraw&&Je(n,211),o&&e.vbaraw){var u=a.CodeName||"ThisWorkbook";Je(n,442,R3(u))}Je(n,156,Ji(17)),Je(n,25,Kn(!1)),Je(n,18,Kn(!1)),Je(n,19,Ji(0)),o&&Je(n,431,Kn(!1)),o&&Je(n,444,Ji(0)),Je(n,61,tL()),Je(n,64,Kn(!1)),Je(n,141,Ji(0)),Je(n,34,Kn(S9(e)=="true")),Je(n,14,Kn(!0)),o&&Je(n,439,Kn(!1)),Je(n,218,Ji(0)),uI(n,e,r),fI(n,e.SSF,r),hI(n,r),o&&Je(n,352,Kn(!1));var f=n.end(),p=mi();o&&Je(p,140,gL()),o&&r.Strings&&iI(p,252,eL(r.Strings)),Je(p,10);var m=p.end(),h=mi(),v=0,x=0;for(x=0;x<e.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var b=f.length+v+m.length;for(x=0;x<e.SheetNames.length;++x){var y=s[x]||{};Je(h,133,ZP({pos:b,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),b+=t[x].length}var w=h.end();if(v!=w.length)throw new Error("BS8 "+v+" != "+w.length);var _=[];return f.length&&_.push(f),w.length&&_.push(w),m.length&&_.push(m),Sn(_)}function yI(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=xi(Fr)),e&&e.SSF&&(Rp(),Ip(e.SSF),r.revssf=Mp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Nx(r),r.cellXfs=[],Uo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=xI(i,r,e);return n.unshift(vI(e,n,r)),Sn(n)}function uS(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ri(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return yI(e,t);case 4:case 3:case 2:return cI(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function wI(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=ir({r,c:a}),p=n.dense?(e[r]||[])[a]:e[f],m=p&&p.v!=null&&(p.h||J7(p.w||(ja(p),p.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(h["data-t"]=p&&p.t||"z",p.v!=null&&(h["data-v"]=p.v),p.z!=null&&(h["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),h.id=(n.id||"sjs")+"-"+f,s.push(Xe("td",m,h))}}var v="<tr>";return v+s.join("")+"</tr>"}var bI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_I="</body></html>";function SI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function fS(e,t){var r=t||{},n=r.header!=null?r.header:bI,i=r.footer!=null?r.footer:_I,s=[n],a=Ri(e["!ref"]);r.dense=Array.isArray(e),s.push(SI(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(wI(e,a,o,r));return s.push("</table>"+i),s.join("")}function dS(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?mn(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var f=Ri(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var p=[],m=0,h=e["!rows"]||(e["!rows"]=[]),v=0,x=0,b=0,y=0,w=0,_=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&x<l;++v){var E=o[v];if(V5(E)){if(n.display)continue;h[x]={hidden:!0}}var O=E.children;for(b=y=0;b<O.length;++b){var D=O[b];if(!(n.display&&V5(D))){var T=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):tP(D.innerHTML),C=D.getAttribute("data-z")||D.getAttribute("z");for(m=0;m<p.length;++m){var P=p[m];P.s.c==y+s&&P.s.r<x+i&&x+i<=P.e.r&&(y=P.e.c+1-s,m=-1)}_=+D.getAttribute("colspan")||1,((w=+D.getAttribute("rowspan")||1)>1||_>1)&&p.push({s:{r:x+i,c:y+s},e:{r:x+i+(w||1)-1,c:y+s+(_||1)-1}});var R={t:"s",v:T},j=D.getAttribute("data-t")||D.getAttribute("t")||"";T!=null&&(T.length==0?R.t=j||"z":n.raw||T.trim().length==0||j=="s"||(T==="TRUE"?R={t:"b",v:!0}:T==="FALSE"?R={t:"b",v:!1}:isNaN(ba(T))?isNaN(fd(T).getDate())||(R={t:"d",v:Qn(T)},n.cellDates||(R={t:"n",v:gi(R.v)}),R.z=n.dateNF||Fr[14]):R={t:"n",v:ba(T)})),R.z===void 0&&C!=null&&(R.z=C);var A="",q=D.getElementsByTagName("A");if(q&&q.length)for(var J=0;J<q.length&&!(q[J].hasAttribute("href")&&(A=q[J].getAttribute("href"),A.charAt(0)!="#"));++J);A&&A.charAt(0)!="#"&&(R.l={Target:A}),n.dense?(e[x+i]||(e[x+i]=[]),e[x+i][y+s]=R):e[ir({c:y+s,r:x+i})]=R,u.e.c<y+s&&(u.e.c=y+s),y+=_}}++x}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),e["!ref"]=Xr(u),x>=l&&(e["!fullref"]=Xr((u.e.r=o.length-v+x-1+i,u))),e}function hS(e,t){var r=t||{},n=r.dense?[]:{};return dS(n,e,t)}function NI(e,t){return Ol(hS(e,t),t)}function V5(e){var t="",r=kI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function kI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var EI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+hd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qr+t}}(),G5=function(){var e=function(s){return rr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+rr(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,p=Ri(s["!ref"]||"A1"),m=s["!merges"]||[],h=0,v=Array.isArray(s);if(s["!cols"])for(f=0;f<=p.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",b=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=b[u]?' table:style-name="ro'+b[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=b[u]?' table:style-name="ro'+b[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<p.s.c;++f)l.push(t);for(;f<=p.e.c;++f){var y=!1,w={},_="";for(h=0;h!=m.length;++h)if(!(m[h].s.c>f)&&!(m[h].s.r>u)&&!(m[h].e.c<f)&&!(m[h].e.r<u)){(m[h].s.c!=f||m[h].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=m[h].e.c-m[h].s.c+1,w["table:number-rows-spanned"]=m[h].e.r-m[h].s.r+1;break}if(y){l.push(r);continue}var E=ir({r:u,c:f}),O=v?(s[u]||[])[f]:s[E];if(O&&O.f&&(w["table:formula"]=rr(VO(O.f)),O.F&&O.F.slice(0,E.length)==E)){var D=Ri(O.F);w["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,w["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!O){l.push(t);continue}switch(O.t){case"b":_=O.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=O.v?"true":"false";break;case"n":_=O.w||String(O.v||0),w["office:value-type"]="float",w["office:value"]=O.v||0;break;case"s":case"str":_=O.v==null?"":O.v,w["office:value-type"]="string";break;case"d":_=O.w||Qn(O.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Qn(O.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var T=e(_);if(O.l&&O.l.Target){var C=O.l.Target;C=C.charAt(0)=="#"?"#"+GO(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),T=Xe("text:a",T,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+Xe("table:table-cell",Xe("text:p",T,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var p=u["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;yx(p),p.ods=o;var m=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var p=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Qr],u=hd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=hd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(T3().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function pS(e,t){if(t.bookType=="fods")return G5(e,t);var r=lx(),n="",i=[],s=[];return n="mimetype",Pt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Pt(r,n,G5(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Pt(r,n,EI(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Pt(r,n,Qr+T3()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Pt(r,n,MP(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Pt(r,n,IP(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function rp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function AI(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ks(dd(e))}function TI(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Fo(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function jI(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function pd(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Qt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Vc(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function rn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=pd(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=pd(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function wn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Qt(n*8+i.type)),i.type==2&&t.push(Qt(i.data.length)),t.push(i.data))})}),Fo(t)}function xs(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=pd(e,n),s=rn(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Vc(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=rn(o.data),u=Vc(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(a.merge=Vc(s[3][0].data)>>>0>0),r.push(a)}return r}function gc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Qt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Qt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Qt(a.data.length)}],n[2].push({data:wn(a.meta),type:2})});var s=wn(n);t.push(Qt(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),Fo(t)}function CI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=pd(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Fo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=Fo(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function vs(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(CI(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Fo(t)}function xc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Qt(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Fo(t)}function _1(e,t){var r=new Uint8Array(32),n=rp(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,jI(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function S1(e,t){var r=new Uint8Array(32),n=rp(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Xa(e){var t=rn(e);return pd(t[1][0].data)}function PI(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&Vc(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=rp(e[7][0].data),f=0,p=[],m=rp(e[4][0].data),h=0,v=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),m.setUint16(x*2,h,!0);var b,y;switch(typeof t[x]){case"string":b=_1({t:"s",v:t[x]},r),y=S1({t:"s",v:t[x]},r);break;case"number":b=_1({t:"n",v:t[x]},r),y=S1({t:"n",v:t[x]},r);break;case"boolean":b=_1({t:"b",v:t[x]},r),y=S1({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}p.push(b),f+=b.length,v.push(y),h+=y.length,++l}for(e[2][0].data=Qt(l);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=Fo(p),e[3][0].data=Fo(v),l}function LI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ri(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Xr(n)));var s=np(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(I){return I.forEach(function(M){typeof M=="string"&&a.push(M)})});var o={},l=[],u=or.read(t.numbers,{type:"base64"});u.FileIndex.map(function(I,M){return[I,u.FullPaths[M]]}).forEach(function(I){var M=I[0],L=I[1];if(M.type==2&&M.name.match(/\.iwa/)){var H=M.content,se=vs(H),fe=xs(se);fe.forEach(function(de){l.push(de.id),o[de.id]={deps:[],location:L,type:Vc(de.messages[0].meta[1][0].data)}})}}),l.sort(function(I,M){return I-M});var f=l.filter(function(I){return I>1}).map(function(I){return[I,Qt(I)]});u.FileIndex.map(function(I,M){return[I,u.FullPaths[M]]}).forEach(function(I){var M=I[0];if(I[1],!!M.name.match(/\.iwa/)){var L=xs(vs(M.content));L.forEach(function(H){H.messages.forEach(function(se){f.forEach(function(fe){H.messages.some(function(de){return Vc(de.meta[1][0].data)!=11006&&TI(de.data,fe[1])})&&o[fe[0]].deps.push(H.id)})})})}});for(var p=or.find(u,o[1].location),m=xs(vs(p.content)),h,v=0;v<m.length;++v){var x=m[v];x.id==1&&(h=x)}var b=Xa(rn(h.messages[0].data)[1][0].data);for(p=or.find(u,o[b].location),m=xs(vs(p.content)),v=0;v<m.length;++v)x=m[v],x.id==b&&(h=x);for(b=Xa(rn(h.messages[0].data)[2][0].data),p=or.find(u,o[b].location),m=xs(vs(p.content)),v=0;v<m.length;++v)x=m[v],x.id==b&&(h=x);for(b=Xa(rn(h.messages[0].data)[2][0].data),p=or.find(u,o[b].location),m=xs(vs(p.content)),v=0;v<m.length;++v)x=m[v],x.id==b&&(h=x);var y=rn(h.messages[0].data);{y[6][0].data=Qt(n.e.r+1),y[7][0].data=Qt(n.e.c+1);var w=Xa(y[46][0].data),_=or.find(u,o[w].location),E=xs(vs(_.content));{for(var O=0;O<E.length&&E[O].id!=w;++O);if(E[O].id!=w)throw"Bad ColumnRowUIDMapArchive";var D=rn(E[O].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var T=0;T<=n.e.c;++T){var C=[];C[1]=C[2]=[{type:0,data:Qt(T+420690)}],D[1].push({type:2,data:wn(C)}),D[2].push({type:0,data:Qt(T)}),D[3].push({type:0,data:Qt(T)})}D[4]=[],D[5]=[],D[6]=[];for(var P=0;P<=n.e.r;++P)C=[],C[1]=C[2]=[{type:0,data:Qt(P+726270)}],D[4].push({type:2,data:wn(C)}),D[5].push({type:0,data:Qt(P)}),D[6].push({type:0,data:Qt(P)});E[O].messages[0].data=wn(D)}_.content=xc(gc(E)),_.size=_.content.length,delete y[46];var R=rn(y[4][0].data);{R[7][0].data=Qt(n.e.r+1);var j=rn(R[1][0].data),A=Xa(j[2][0].data);_=or.find(u,o[A].location),E=xs(vs(_.content));{if(E[0].id!=A)throw"Bad HeaderStorageBucket";var q=rn(E[0].messages[0].data);for(P=0;P<s.length;++P){var J=rn(q[2][0].data);J[1][0].data=Qt(P),J[4][0].data=Qt(s[P].length),q[2][P]={type:q[2][0].type,data:wn(J)}}E[0].messages[0].data=wn(q)}_.content=xc(gc(E)),_.size=_.content.length;var te=Xa(R[2][0].data);_=or.find(u,o[te].location),E=xs(vs(_.content));{if(E[0].id!=te)throw"Bad HeaderStorageBucket";for(q=rn(E[0].messages[0].data),T=0;T<=n.e.c;++T)J=rn(q[2][0].data),J[1][0].data=Qt(T),J[4][0].data=Qt(n.e.r+1),q[2][T]={type:q[2][0].type,data:wn(J)};E[0].messages[0].data=wn(q)}_.content=xc(gc(E)),_.size=_.content.length;var z=Xa(R[4][0].data);(function(){for(var I=or.find(u,o[z].location),M=xs(vs(I.content)),L,H=0;H<M.length;++H){var se=M[H];se.id==z&&(L=se)}var fe=rn(L.messages[0].data);{fe[3]=[];var de=[];a.forEach(function(Oe,qe){de[1]=[{type:0,data:Qt(qe)}],de[2]=[{type:0,data:Qt(1)}],de[3]=[{type:2,data:AI(Oe)}],fe[3].push({type:2,data:wn(de)})})}L.messages[0].data=wn(fe);var ve=gc(M),Ee=xc(ve);I.content=Ee,I.size=I.content.length})();var B=rn(R[3][0].data);{var G=B[1][0];delete B[2];var V=rn(G.data);{var Z=Xa(V[2][0].data);(function(){for(var I=or.find(u,o[Z].location),M=xs(vs(I.content)),L,H=0;H<M.length;++H){var se=M[H];se.id==Z&&(L=se)}var fe=rn(L.messages[0].data);{delete fe[6],delete B[7];var de=new Uint8Array(fe[5][0].data);fe[5]=[];for(var ve=0,Ee=0;Ee<=n.e.r;++Ee){var Oe=rn(de);ve+=PI(Oe,s[Ee],a),Oe[1][0].data=Qt(Ee),fe[5].push({data:wn(Oe),type:2})}fe[1]=[{type:0,data:Qt(n.e.c+1)}],fe[2]=[{type:0,data:Qt(n.e.r+1)}],fe[3]=[{type:0,data:Qt(ve)}],fe[4]=[{type:0,data:Qt(n.e.r+1)}]}L.messages[0].data=wn(fe);var qe=gc(M),Qe=xc(qe);I.content=Qe,I.size=I.content.length})()}G.data=wn(V)}R[3][0].data=wn(B)}y[4][0].data=wn(R)}h.messages[0].data=wn(y);var he=gc(m),k=xc(he);return p.content=k,p.size=p.content.length,u}function FI(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Nx(e){FI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function OI(e,t){return t.bookType=="ods"?pS(e,t):t.bookType=="numbers"?LI(e,t):t.bookType=="xlsb"?DI(e,t):II(e,t)}function DI(e,t){Dc=1024,e&&!e.SSF&&(e.SSF=xi(Fr)),e&&e.SSF&&(Rp(),Ip(e.SSF),t.revssf=Mp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=X3.indexOf(t.bookType)>-1,i=k3();Nx(t=t||{});var s=lx(),a="",o=0;if(t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pt(s,a,j3(e.Props,t)),i.coreprops.push(a),er(t.rels,2,a,$t.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Pt(s,a,P3(e.Props)),i.extprops.push(a),er(t.rels,3,a,$t.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pt(s,a,L3(e.Custprops)),i.custprops.push(a),er(t.rels,4,a,$t.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Pt(s,a,M9(o-1,a,t,e,f)),i.sheets.push(a),er(t.wbrels,-1,"worksheets/sheet"+o+"."+r,$t.WS[0])}if(p){var h=p["!comments"],v=!1,x="";h&&h.length>0&&(x="xl/comments"+o+"."+r,Pt(s,x,z9(h,x)),i.comments.push(x),er(f,-1,"../comments"+o+"."+r,$t.CMNT),v=!0),p["!legacy"]&&v&&Pt(s,"xl/drawings/vmlDrawing"+o+".vml",Y3(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Pt(s,A3(a),$c(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pt(s,a,U9(t.Strings,a,t)),i.strs.push(a),er(t.wbrels,-1,"sharedStrings."+r,$t.SST)),a="xl/workbook."+r,Pt(s,a,R9(e,a)),i.workbooks.push(a),er(t.rels,1,a,$t.WB),a="xl/theme/theme1.xml",Pt(s,a,V3(e.Themes,t)),i.themes.push(a),er(t.wbrels,-1,"theme/theme1.xml",$t.THEME),a="xl/styles."+r,Pt(s,a,B9(e,a,t)),i.styles.push(a),er(t.wbrels,-1,"styles."+r,$t.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pt(s,a,e.vbaraw),i.vba.push(a),er(t.wbrels,-1,"vbaProject.bin",$t.VBA)),a="xl/metadata."+r,Pt(s,a,W9(a)),i.metadata.push(a),er(t.wbrels,-1,"metadata."+r,$t.XLMETA),Pt(s,"[Content_Types].xml",E3(i,t)),Pt(s,"_rels/.rels",$c(t.rels)),Pt(s,"xl/_rels/workbook."+r+".rels",$c(t.wbrels)),delete t.revssf,delete t.ssf,s}function II(e,t){Dc=1024,e&&!e.SSF&&(e.SSF=xi(Fr)),e&&e.SSF&&(Rp(),Ip(e.SSF),t.revssf=Mp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=X3.indexOf(t.bookType)>-1,i=k3();Nx(t=t||{});var s=lx(),a="",o=0;if(t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pt(s,a,j3(e.Props,t)),i.coreprops.push(a),er(t.rels,2,a,$t.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Pt(s,a,P3(e.Props)),i.extprops.push(a),er(t.rels,3,a,$t.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pt(s,a,L3(e.Custprops)),i.custprops.push(a),er(t.rels,4,a,$t.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var p={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Pt(s,a,sS(o-1,t,e,p)),i.sheets.push(a),er(t.wbrels,-1,"worksheets/sheet"+o+"."+r,$t.WS[0])}if(m){var v=m["!comments"],x=!1,b="";if(v&&v.length>0){var y=!1;v.forEach(function(w){w[1].forEach(function(_){_.T==!0&&(y=!0)})}),y&&(b="xl/threadedComments/threadedComment"+o+"."+r,Pt(s,b,hF(v,f,t)),i.threadedcomments.push(b),er(p,-1,"../threadedComments/threadedComment"+o+"."+r,$t.TCMNT)),b="xl/comments"+o+"."+r,Pt(s,b,K3(v)),i.comments.push(b),er(p,-1,"../comments"+o+"."+r,$t.CMNT),x=!0}m["!legacy"]&&x&&Pt(s,"xl/drawings/vmlDrawing"+o+".vml",Y3(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Pt(s,A3(a),$c(p))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pt(s,a,U3(t.Strings,t)),i.strs.push(a),er(t.wbrels,-1,"sharedStrings."+r,$t.SST)),a="xl/workbook."+r,Pt(s,a,lS(e)),i.workbooks.push(a),er(t.rels,1,a,$t.WB),a="xl/theme/theme1.xml",Pt(s,a,V3(e.Themes,t)),i.themes.push(a),er(t.wbrels,-1,"theme/theme1.xml",$t.THEME),a="xl/styles."+r,Pt(s,a,$3(e,t)),i.styles.push(a),er(t.wbrels,-1,"styles."+r,$t.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pt(s,a,e.vbaraw),i.vba.push(a),er(t.wbrels,-1,"vbaProject.bin",$t.VBA)),a="xl/metadata."+r,Pt(s,a,G3()),i.metadata.push(a),er(t.wbrels,-1,"metadata."+r,$t.XLMETA),f.length>1&&(a="xl/persons/person.xml",Pt(s,a,pF(f)),i.people.push(a),er(t.wbrels,-1,"persons/person.xml",$t.PEOPLE)),Pt(s,"[Content_Types].xml",E3(i,t)),Pt(s,"_rels/.rels",$c(t.rels)),Pt(s,"xl/_rels/workbook."+r+".rels",$c(t.wbrels)),delete t.revssf,delete t.ssf,s}function RI(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ta(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function mS(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ad(t.file,or.write(e,{type:Vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return or.write(e,t)}function MI(e,t){var r=xi(t||{}),n=OI(e,r);return BI(n,r)}function BI(e,t){var r={},n=Vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?or.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Dp(i))}return t.password&&typeof encrypt_agile<"u"?mS(encrypt_agile(i,t.password),t):t.type==="file"?Ad(t.file,i):t.type=="string"?Df(i):i}function UI(e,t){var r=t||{},n=rI(e,r);return mS(n,r)}function $s(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return ud(dd(n));case"binary":return dd(n);case"string":return e;case"file":return Ad(t.file,n,"utf8");case"buffer":return Vt?Pa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$s(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zI(e,t){switch(t.type){case"base64":return ud(e);case"binary":return e;case"string":return e;case"file":return Ad(t.file,e,"binary");case"buffer":return Vt?Pa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Qh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?ud(r):t.type=="string"?Df(r):r;case"file":return Ad(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function gS(e,t){m7(),E9(e);var r=xi(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=gS(e,r);return r.type="array",Dp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $s(eI(e,r),r);case"slk":case"sylk":return $s(SL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return $s(fS(e.Sheets[e.SheetNames[i]],r),r);case"txt":return zI(xS(e.Sheets[e.SheetNames[i]],r),r);case"csv":return $s(kx(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return $s(NL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Qh(_L.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return $s(kL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return $s(LL.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return $s(B3.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return $s(pS(e,r),r);case"wk1":return Qh(U5.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Qh(U5.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Qh(uS(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),UI(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MI(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function WI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function HI(e,t,r){var n={};return n.type="file",n.file=t,WI(n),gS(e,n)}function $I(e,t,r,n,i,s,a,o){var l=En(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||e[r])for(var h=t.s.c;h<=t.e.c;++h){var v=a?e[r][h]:e[n[h]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[h]!=null&&(m[s[h]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[h]!=null){if(x==null)if(v.t=="e"&&x===null)m[s[h]]=null;else if(u!==void 0)m[s[h]]=u;else if(f&&x===null)m[s[h]]=null;else continue;else m[s[h]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:ja(v,x,o);x!=null&&(p=!1)}}return{row:m,isempty:p}}function np(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=wr(f);break;case"number":l=wr(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var p=En(l.s.r),m=[],h=[],v=0,x=0,b=Array.isArray(e),y=l.s.r,w=0,_={};b&&!e[y]&&(e[y]=[]);var E=u.skipHidden&&e["!cols"]||[],O=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(E[w]||{}).hidden)switch(m[w]=zn(w),r=b?e[y][w]:e[m[w]+p],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=m[w];break;case 3:s[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ja(r,null,u),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[w]=o}for(y=l.s.r+i;y<=l.e.r;++y)if(!(O[y]||{}).hidden){var D=$I(e,l,y,m,n,s,b,u);(D.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[v++]=D.row)}return h.length=v,h}var Y5=/"/g;function qI(e,t,r,n,i,s,a,o){for(var l=!0,u=[],f="",p=En(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var h=o.dense?(e[r]||[])[m]:e[n[m]+p];if(h==null)f="";else if(h.v!=null){l=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:ja(h,null,o));for(var v=0,x=0;v!==f.length;++v)if((x=f.charCodeAt(v))===i||x===s||x===34||o.forceQuotes){f='"'+f.replace(Y5,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(l=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(Y5,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function kx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=wr(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",p=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(m[v]||{}).hidden||(p[v]=zn(v));for(var x=0,b=i.s.r;b<=i.e.r;++b)(h[b]||{}).hidden||(f=qI(e,i,b,p,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function xS(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=kx(e,t);return r}function VI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=wr(e["!ref"]),s="",a=[],o,l=[],u=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=zn(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=En(f),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function vS(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?mn(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var p=wr(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),a==-1&&(a=p.e.r+1,f.e.r=a+t.length-1+i)}else a==-1&&(a=0,f.e.r=t.length-1+i);var m=n.header||[],h=0;t.forEach(function(x,b){Tn(x).forEach(function(y){(h=m.indexOf(y))==-1&&(m[h=m.length]=y);var w=x[y],_="z",E="",O=ir({c:o+h,r:a+b+i});u=md(s,O),w&&typeof w=="object"&&!(w instanceof Date)?s[O]=w:(typeof w=="number"?_="n":typeof w=="boolean"?_="b":typeof w=="string"?_="s":w instanceof Date?(_="d",n.cellDates||(_="n",w=gi(w)),E=n.dateNF||Fr[14]):w===null&&n.nullError&&(_="e",w=0),u?(u.t=_,u.v=w,delete u.w,delete u.R,E&&(u.z=E)):s[O]=u={t:_,v:w},E&&(u.z=E))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var v=En(a);if(i)for(h=0;h<m.length;++h)s[zn(h+o)+v]={t:"s",v:m[h]};return s["!ref"]=Xr(f),s}function GI(e,t){return vS(null,e,t)}function md(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=mn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?md(e,ir(t)):md(e,ir({r:t,c:r||0}))}function YI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function KI(){return{SheetNames:[],Sheets:{}}}function XI(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(oS(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function JI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=YI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function QI(e,t){return e.z=t,e}function yS(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ZI(e,t,r){return yS(e,"#"+t,r)}function eR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function tR(e,t,r,n){for(var i=typeof t!="string"?t:wr(t),s=typeof t=="string"?t:Xr(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=md(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var N1={encode_col:zn,encode_row:En,encode_cell:ir,encode_range:Xr,decode_col:px,decode_row:hx,split_cell:mP,decode_cell:mn,decode_range:Ri,format_cell:ja,sheet_add_aoa:y3,sheet_add_json:vS,sheet_add_dom:dS,aoa_to_sheet:mu,json_to_sheet:GI,table_to_sheet:hS,table_to_book:NI,sheet_to_csv:kx,sheet_to_txt:xS,sheet_to_json:np,sheet_to_html:fS,sheet_to_formulae:VI,sheet_to_row_object_array:np,sheet_get_cell:md,book_new:KI,book_append_sheet:XI,book_set_sheet_visibility:JI,cell_set_number_format:QI,cell_set_hyperlink:yS,cell_set_internal_link:ZI,cell_add_comment:eR,sheet_set_array_formula:tR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const K5=(e,t,r,n,i,s="GHS")=>{var x;const a=new pt;a.setFont("helvetica","bold"),a.setFontSize(20),a.text(`Worker Report: ${e.name}`,14,20),a.setFont("helvetica","normal"),a.setFontSize(12),a.text(`Period: ${zt(n,"MMM dd, yyyy")} - ${zt(i,"MMM dd, yyyy")}`,14,30);const o=((x=Jr[s])==null?void 0:x.symbol)||s,l=t.filter(b=>b.status==="completed"),u=t.filter(b=>b.status==="pending");l.reduce((b,y)=>{var w;return b+(((w=y.deductions)==null?void 0:w.reduce((_,E)=>_+E.amount,0))||0)},0);const f=l.reduce((b,y)=>{var _;const w=((_=y.deductions)==null?void 0:_.reduce((E,O)=>E+O.amount,0))||0;return b+(y.amount-w)},0),p=t.reduce((b,y)=>b+y.amount,0);a.setFont("helvetica","bold"),a.text("Summary:",14,40);const m=48;a.setFont("helvetica","normal"),a.text(`Total Tasks: ${t.length}`,20,m),a.text(`Assigned Tasks: ${u.length}`,20,m+8),a.text(`Completed Tasks: ${l.length}`,20,m+16),a.text(`Weekly Project Total: ${o} ${p.toFixed(2)}`,20,m+24),a.text(`Completed Earnings: ${o} ${f.toFixed(2)}`,20,m+32),a.setFont("helvetica","bold"),a.text("Tasks Details:",14,m+56),a.setFont("helvetica","normal");let h=m+70;t.forEach((b,y)=>{var O,D,T;const w=(O=r.find(C=>C.project_id===b.project_id))==null?void 0:O.project,_=((D=b.deductions)==null?void 0:D.reduce((C,P)=>C+P.amount,0))||0,E=b.amount-_;if(h>250&&(a.addPage(),h=20),mf(a,{startY:h,head:[[{content:`Task ${y+1}`,styles:{halign:"left",fillColor:[37,99,235]}}]],theme:"plain",headStyles:{textColor:255,fontSize:12,fontStyle:"bold",cellPadding:8},margin:{left:20}}),mf(a,{startY:a.lastAutoTable.finalY,body:[["Date",zt(new Date(b.date),"MMM dd, yyyy")],["Project",(w==null?void 0:w.name)||"Unknown Project"],["Status",b.status.charAt(0).toUpperCase()+b.status.slice(1)],["Completed",b.completed_at?zt(new Date(b.completed_at),"MMM dd, yyyy HH:mm"):"-"],["Amount",`${o} ${b.amount.toFixed(2)}`],["Deductions",`${o} ${_.toFixed(2)}`],["Net Amount",`${o} ${E.toFixed(2)}`]],theme:"striped",styles:{fontSize:10,cellPadding:8,overflow:"linebreak",minCellWidth:80},columnStyles:{0:{fontStyle:"bold",fillColor:[243,244,246]}},margin:{left:20}}),b.description&&mf(a,{startY:a.lastAutoTable.finalY+2,head:[["Description"]],body:[[b.description]],theme:"plain",styles:{fontSize:10,cellPadding:8,overflow:"linebreak",cellWidth:"wrap"},headStyles:{fillColor:[253,224,71],textColor:[120,53,15],fontStyle:"bold"},margin:{left:20}}),(T=b.deductions)!=null&&T.length){const C=b.deductions.map(P=>[`GHS ${P.amount.toFixed(2)}`,P.reason]);mf(a,{startY:a.lastAutoTable.finalY+2,head:[["Deduction Amount","Deduction Reason"]],body:C,theme:"plain",styles:{fontSize:10,cellPadding:8,overflow:"linebreak"},headStyles:{fillColor:[252,165,165],textColor:[127,29,29],fontStyle:"bold"},margin:{left:20}})}h=a.lastAutoTable.finalY+15});const v=`
*Work Report for ${e.name}*
Period: ${zt(n,"MMM dd, yyyy")} - ${zt(i,"MMM dd, yyyy")}

*Summary*
Total Tasks: ${t.length} 
Assigned Tasks: ${u.length}
Tasks Completed: ${l.length}
Weekly Project Total: ${o} ${p.toFixed(2)}
Completed Earnings: ${o} ${f.toFixed(2)}

Your detailed report has been attached as a PDF.

Thank you for your service!
`;return{pdf:a.save(`${e.name}_report_${zt(n,"yyyy-MM-dd")}.pdf`),whatsappMessage:encodeURIComponent(v)}},rR=(e,t,r="GHS")=>{var f;const n=((f=Jr[r])==null?void 0:f.symbol)||r,i=N1.book_new(),s=e.map(p=>({Date:zt(new Date(p.date),"MMM dd, yyyy"),"Total Tasks":p.totalTasks,"Total Amount":`${n} ${p.totalAmount.toFixed(2)}`,"Total Deductions":`${n} ${p.totalDeductions.toFixed(2)}`,"Net Amount":`${n} ${p.netAmount.toFixed(2)}`})),a=N1.json_to_sheet(s);N1.book_append_sheet(i,a,"Financial Report");const o=new pt;o.setFontSize(20),o.text("Financial Report",14,20),o.setFontSize(12),o.text(`Period: ${zt(t.start,"MMM dd, yyyy")} - ${zt(t.end,"MMM dd, yyyy")}`,14,30);const l=e.reduce((p,m)=>({tasks:p.tasks+m.totalTasks,amount:p.amount+m.totalAmount,deductions:p.deductions+m.totalDeductions,net:p.net+m.netAmount}),{tasks:0,amount:0,deductions:0,net:0});o.text("Summary:",14,40),o.text(`Total Tasks: ${l.tasks}`,20,48),o.text(`Total Amount: ${n} ${l.amount.toFixed(2)}`,20,56),o.text(`Total Deductions: ${n} ${l.deductions.toFixed(2)}`,20,64),o.text(`Net Amount: ${n} ${l.net.toFixed(2)}`,20,72);const u=e.map(p=>[zt(new Date(p.date),"MMM dd, yyyy"),p.totalTasks.toString(),`${n} ${p.totalAmount.toFixed(2)}`,`${n} ${p.totalDeductions.toFixed(2)}`,`${n} ${p.netAmount.toFixed(2)}`]);return mf(o,{startY:80,head:[["Date","Tasks","Amount","Deductions","Net Amount"]],body:u,theme:"striped",styles:{fontSize:8},headStyles:{fillColor:[59,130,246]}}),{workbook:i,pdf:o}};function nR({worker:e,tasks:t,workerProjects:r,isEditing:n,setIsEditing:i,editedWorker:s,setEditedWorker:a,handleEditWorker:o,handleDeleteWorker:l}){var C;const[u,f]=pe.useState(!1),p=pe.useRef(null),{addToast:m}=jn(),{organization:h}=Kt(),v=new Date,x=Di(v,{weekStartsOn:1}),b=_o(v,{weekStartsOn:1}),y=t.filter(P=>P.status==="pending"),w=t.filter(P=>P.status==="completed"),_=async P=>{var j,A;const R=(j=P.target.files)==null?void 0:j[0];if(!(!R||!e))try{if(f(!0),!["image/jpeg","image/jpg","image/png"].includes(R.type))throw new Error("Please upload a JPG, JPEG, or PNG file");if(R.size>5*1024*1024)throw new Error("Image must be less than 5MB");const J=(A=R.name.split(".").pop())==null?void 0:A.toLowerCase();if(!J||!["jpg","jpeg","png"].includes(J))throw new Error("Invalid file extension");const te=`${Math.random().toString(36).substring(2)}.${J}`,z=`worker-${e.id}/${te}`,{error:B}=await Ge.storage.from("profiles").upload(z,R,{cacheControl:"3600",upsert:!0});if(B)throw B;const{data:{publicUrl:G}}=Ge.storage.from("profiles").getPublicUrl(z),{error:V}=await Ge.from("workers").update({image:G}).eq("id",e.id);if(V)throw V;a(Z=>Z?{...Z,image:G}:null),m({type:"success",title:"Image Uploaded",message:"Profile image has been updated successfully."})}catch(q){console.error("Error uploading image:",q),m({type:"error",title:"Upload Failed",message:q instanceof Error?q.message:"Failed to upload image"})}finally{f(!1),p.current&&(p.current.value="")}},E=()=>{e&&K5(e,t,r,x,b,h.currency)},O=()=>{if(!(e!=null&&e.whatsapp))return;const{whatsappMessage:P}=K5(e,t,r,x,b,h.currency);window.open(`https://wa.me/${e.whatsapp}?text=${P}`,"_blank")},D=w.reduce((P,R)=>{var A;const j=((A=R.deductions)==null?void 0:A.reduce((q,J)=>q+J.amount,0))||0;return P+(R.amount-j)},0),T=((C=Jr[h.currency])==null?void 0:C.symbol)||h.currency;return c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"flex items-start justify-between",children:c.jsxs("div",{className:"flex items-center space-x-5",children:[c.jsxs("div",{className:"relative h-20 w-20 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:[e.image?c.jsx("img",{src:e.image,alt:e.name,className:"h-full w-full object-cover",onError:P=>{console.error("Image failed to load:",e.image),P.currentTarget.src="",P.currentTarget.onerror=null}}):c.jsx("span",{className:"text-3xl font-medium text-gray-600",children:e.name[0].toUpperCase()}),n&&c.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:[c.jsx("input",{type:"file",ref:p,onChange:_,accept:"image/jpeg,image/jpg,image/png",className:"hidden"}),c.jsx("button",{onClick:()=>{var P;return(P=p.current)==null?void 0:P.click()},disabled:u,className:"p-2 bg-white rounded-full hover:bg-gray-100",children:u?c.jsx(Sd,{className:"h-5 w-5 text-gray-600 animate-spin"}):c.jsx(z0,{className:"h-5 w-5 text-gray-600"})})]})]}),c.jsx("div",{children:n?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),c.jsx("input",{type:"text",value:(s==null?void 0:s.name)||"",onChange:P=>a(R=>R?{...R,name:P.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp"}),c.jsx("input",{type:"text",value:(s==null?void 0:s.whatsapp)||"",onChange:P=>a(R=>R?{...R,whatsapp:P.target.value}:null),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter WhatsApp number"})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:o,disabled:u,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400",children:u?"Uploading...":"Save Changes"}),c.jsx("button",{onClick:()=>{i(!1),a(e)},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"})]})]}):c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e.name}),e.whatsapp&&c.jsxs("div",{className:"mt-2 flex items-center text-gray-500",children:[c.jsx(o_,{className:"h-4 w-4 mr-2"}),c.jsx("span",{children:e.whatsapp})]}),c.jsxs("div",{className:"mt-4 flex flex-wrap gap-3",children:[c.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(Ll,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),c.jsxs("button",{onClick:E,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(Fg,{className:"h-4 w-4 mr-2"}),"Download Report"]}),e.whatsapp&&c.jsxs("button",{onClick:O,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(s_,{className:"h-4 w-4 mr-2"}),"WhatsApp"]}),c.jsxs("button",{onClick:l,className:"inline-flex items-center px-3 py-1.5 border border-red-300 rounded-md text-sm font-medium text-red-700 bg-white hover:bg-red-50",children:[c.jsx(is,{className:"h-4 w-4 mr-2"}),"Delete Worker"]})]})]})})]})}),c.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-5 sm:grid-cols-3",children:[c.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(hu,{className:"h-6 w-6 text-yellow-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Assigned Tasks"}),c.jsx("p",{className:"mt-1 text-2xl font-semibold text-yellow-900",children:y.length})]})]})}),c.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Ns,{className:"h-6 w-6 text-green-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-sm font-medium text-green-900",children:"Completed Tasks"}),c.jsx("p",{className:"mt-1 text-2xl font-semibold text-green-900",children:w.length})]})]})}),c.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Ao,{className:"h-6 w-6 text-yellow-600"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Completed Earnings"}),c.jsxs("p",{className:"mt-1 text-2xl font-semibold text-yellow-900",children:[T," ",D.toFixed(2)]})]})]})})]})]})})}const Zh="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function iR({worker:e,workerProjects:t,setWorkerProjects:r,organization:n}){var E;const[i,s]=pe.useState(!1),[a,o]=pe.useState(null),[l,u]=pe.useState(0),[f,p]=pe.useState(""),[m,h]=pe.useState({name:"",rate:0}),{confirm:v}=c_(),{addToast:x}=u_(),b=((E=Jr[n.currency])==null?void 0:E.symbol)||n.currency,y=async()=>{if(!(!n||!e||!m.name.trim()||!m.rate))try{const{data:O,error:D}=await Ge.from("projects").insert([{organization_id:n.id,name:m.name.trim(),base_price:m.rate}]).select().single();if(D)throw D;const{data:T,error:C}=await Ge.from("worker_project_rates").insert([{worker_id:e.id,project_id:O.id,rate:m.rate}]).select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).single();if(C)throw C;r(P=>[...P,T]),h({name:"",rate:0}),s(!1),x({type:"success",title:"Project Added",message:"The project has been added successfully."})}catch(O){console.error("Error adding project:",O),x({type:"error",title:"Error",message:"Failed to add project. Please try again."})}},w=async O=>{var D;try{const{error:T}=await Ge.from("projects").update({name:f}).eq("id",(D=t.find(P=>P.id===O))==null?void 0:D.project_id);if(T)throw T;const{error:C}=await Ge.from("worker_project_rates").update({rate:l}).eq("id",O);if(C)throw C;r(P=>P.map(R=>R.id===O?{...R,rate:l,project:{...R.project,name:f}}:R)),o(null),p(""),u(0),x({type:"success",title:"Rate Updated",message:"The project has been updated successfully."})}catch(T){console.error("Error updating project rate:",T),x({type:"error",title:"Error",message:"Failed to update project rate. Please try again."})}},_=async O=>{if(await v({title:"Delete Project",message:"Are you sure you want to delete this project? This action cannot be undone.",type:"warning",confirmText:"Delete",cancelText:"Cancel"}))try{const T=t.find(P=>P.id===O);if(!T)throw new Error("Project not found");const{error:C}=await Ge.from("projects").delete().eq("id",T.project_id);if(C)throw C;r(P=>P.filter(R=>R.id!==O)),x({type:"success",title:"Project Deleted",message:"Project deleted successfully"})}catch(T){console.error("Error deleting project:",T),x({type:"error",title:"Error",message:T instanceof Error?T.message:"Failed to delete project"})}};return c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Projects and Rates"}),c.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Project"]})]}),i&&c.jsxs("div",{className:"mb-6 bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add New Project"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Project Name"}),c.jsx("input",{type:"text",value:m.name,onChange:O=>h(D=>({...D,name:O.target.value})),className:Zh,placeholder:"Enter project name"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Rate (",b,")"]}),c.jsx("input",{type:"number",value:m.rate||"",onChange:O=>h(D=>({...D,rate:parseFloat(O.target.value)||0})),className:Zh,min:"0",step:"0.01",placeholder:"Enter project rate"})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:y,disabled:!m.name.trim()||!m.rate,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Project"})]})]})]}),c.jsx("div",{className:"mt-4",children:t.length===0?c.jsx("p",{className:"text-center text-gray-500 py-4",children:"No projects assigned yet."}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(O=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===O.id?c.jsx("input",{type:"text",value:f,onChange:D=>p(D.target.value),className:`${Zh} w-full`,placeholder:"Enter project name"}):O.project.name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===O.id?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"number",value:l||"",onChange:D=>u(parseFloat(D.target.value)||0),className:`${Zh} w-24`,min:"0",step:"0.01"}),c.jsx("button",{onClick:()=>w(O.id),className:"text-green-600 hover:text-green-700",children:c.jsx(Ns,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>o(null),className:"text-red-600 hover:text-red-700",children:c.jsx(Bo,{className:"h-5 w-5"})})]}):c.jsxs("span",{children:[b," ",O.rate.toFixed(2)]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a!==O.id&&c.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[c.jsx("button",{onClick:()=>{o(O.id),u(O.rate),p(O.project.name)},className:"text-blue-600 hover:text-blue-700",children:c.jsx(Ll,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>_(O.id),className:"text-red-600 hover:text-red-700",title:"Delete project",children:c.jsx(is,{className:"h-5 w-5"})})]})})]},O.id))})]})})})]})})}const X5="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function sR({task:e,tasks:t,setTasks:r,organization:n}){var p;const[i,s]=pe.useState({amount:0,reason:""}),{confirm:a,addToast:o}=jn(),l=((p=Jr[n.currency])==null?void 0:p.symbol)||n.currency,u=async()=>{if(!(!e.id||!i.amount||!i.reason))try{const{data:m,error:h}=await Ge.from("deductions").insert([{task_id:e.id,amount:i.amount,reason:i.reason.trim()}]).select().single();if(h)throw h;r(v=>v.map(x=>x.id===e.id?{...x,deductions:[...x.deductions||[],m]}:x)),s({amount:0,reason:""}),o({type:"success",title:"Deduction Added",message:"The deduction has been added successfully."})}catch(m){console.error("Error adding deduction:",m),o({type:"error",title:"Error",message:"Failed to add deduction. Please try again."})}},f=async m=>{if(await a({title:"Remove Deduction",message:"Are you sure you want to remove this deduction? This action cannot be undone.",type:"danger",confirmText:"Remove",cancelText:"Cancel"}))try{const{error:v}=await Ge.from("deductions").delete().eq("id",m);if(v)throw v;r(x=>x.map(b=>{var y;return b.id===e.id?{...b,deductions:(y=b.deductions)==null?void 0:y.filter(w=>w.id!==m)}:b})),o({type:"success",title:"Deduction Removed",message:"The deduction has been removed successfully."})}catch(v){console.error("Error removing deduction:",v),o({type:"error",title:"Error",message:"Failed to remove deduction. Please try again."})}};return c.jsxs("div",{className:"mt-4 border-t pt-4",children:[c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Deduction"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm text-gray-700",children:["Amount (",l,")"]}),c.jsx("input",{type:"number",value:i.amount||"",onChange:m=>s(h=>({...h,amount:parseFloat(m.target.value)||0})),className:X5,min:"0",step:"0.01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-700",children:"Reason"}),c.jsx("input",{type:"text",value:i.reason,onChange:m=>s(h=>({...h,reason:m.target.value})),className:X5})]})]}),c.jsx("button",{onClick:u,disabled:!i.amount||!i.reason.trim(),className:"mt-4 w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Deduction"})]}),e.deductions&&e.deductions.length>0&&c.jsxs("div",{className:"mt-4 space-y-2",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Deductions"}),e.deductions.map(m=>c.jsxs("div",{className:"flex items-center justify-between bg-red-50 p-3 rounded",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-sm font-medium text-red-900",children:[l," ",m.amount.toFixed(2)]}),c.jsx("p",{className:"text-sm text-red-700",children:m.reason}),c.jsx("p",{className:"text-xs text-red-600",children:zt(new Date(m.created_at),"MMM d, yyyy HH:mm")})]}),c.jsx("button",{onClick:()=>f(m.id),className:"p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-100",children:c.jsx(Bo,{className:"h-5 w-5"})})]},m.id))]})]})}const k1={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},delayed:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"}},E1={pending:"Assigned",in_progress:"In Progress",delayed:"Delayed",completed:"Completed"},lf="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2";function aR({worker:e,tasks:t,setTasks:r,workerProjects:n,organization:i}){var O;const[s,a]=pe.useState(!1),[o,l]=pe.useState(null),[u,f]=pe.useState(null),[p,m]=pe.useState(""),[h,v]=pe.useState({project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),{confirm:x,addToast:b}=jn(),y=((O=Jr[i.currency])==null?void 0:O.symbol)||i.currency,w=async(D,T,C)=>{try{const P={status:T};T==="completed"?P.completed_at=new Date().toISOString():T==="delayed"&&(P.delay_reason=C),P.status_changed_at=new Date().toISOString();const{error:R}=await Ge.from("tasks").update(P).eq("id",D);if(R)throw R;r(j=>j.map(A=>A.id===D?{...A,...P}:A)),f(null),m(""),b({type:"success",title:"Status Updated",message:`Task marked as ${E1[T]}`})}catch(P){console.error("Error updating task status:",P),b({type:"error",title:"Error",message:"Failed to update task status"})}},_=async()=>{var R;if(!i||!e||!h.project_id)return;const D=((R=n.find(j=>j.project_id===h.project_id))==null?void 0:R.rate)||0,T=new Date(h.date),C=kl(new Date),P=pl(C,T);if(P&&!h.late_reason){b({type:"warning",title:"Late Entry",message:"Please provide a reason for adding a task for a past date."});return}try{const{data:j,error:A}=await Ge.from("tasks").insert([{organization_id:i.id,worker_id:e.id,project_id:h.project_id,description:h.description.trim()||null,date:h.date,amount:D,status:"pending",late_reason:P?h.late_reason:null}]).select(`
          *,
          deductions (*)
        `).single();if(A)throw A;r(q=>[j,...q]),v({project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),a(!1),b({type:"success",title:"Task Added",message:"The task has been added successfully."})}catch(j){console.error("Error adding task:",j),b({type:"error",title:"Error",message:"Failed to add task. Please try again."})}},E=async D=>{if(await x({title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:C}=await Ge.from("tasks").delete().eq("id",D);if(C)throw C;r(P=>P.filter(R=>R.id!==D)),b({type:"success",title:"Task Deleted",message:"The task has been deleted successfully."})}catch(C){console.error("Error deleting task:",C),b({type:"error",title:"Error",message:"Failed to delete task. Please try again."})}};return c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Tasks"}),c.jsxs("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Task"]})]}),s&&c.jsxs("div",{className:"mb-6 bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"New Task"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Project"}),c.jsxs("select",{value:h.project_id,onChange:D=>v(T=>({...T,project_id:D.target.value})),className:lf,children:[c.jsx("option",{value:"",children:"Select a project"}),n.map(D=>c.jsxs("option",{value:D.project_id,children:[D.project.name," - ",y," ",D.rate.toFixed(2)]},D.project_id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),c.jsx("input",{type:"text",value:h.description,onChange:D=>v(T=>({...T,description:D.target.value})),className:lf,placeholder:"Enter task description (optional)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),c.jsx("input",{type:"date",value:h.date,onChange:D=>v(T=>({...T,date:D.target.value})),className:lf,max:new Date().toISOString().split("T")[0]})]}),pl(kl(new Date),new Date(h.date))&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Late Entry"}),c.jsx("textarea",{value:h.late_reason,onChange:D=>v(T=>({...T,late_reason:D.target.value})),className:`${lf} h-20`,placeholder:"Please provide a reason for adding this task after the date",required:!0})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:_,disabled:!h.project_id,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Task"})]})]})]}),c.jsx("div",{className:"space-y-4",children:t.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No tasks found. Start by adding a new task."}):t.map(D=>{var R,j;const T=(R=n.find(A=>A.project_id===D.project_id))==null?void 0:R.project,C=((j=D.deductions)==null?void 0:j.reduce((A,q)=>A+q.amount,0))||0,P=D.amount-C;return c.jsx("div",{className:"bg-white border rounded-lg shadow-sm",children:c.jsxs("div",{className:"p-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("span",{className:`mt-1 ${D.status==="completed"?"text-green-500":"text-yellow-500"}`,children:D.status==="completed"?c.jsx(Ns,{className:"h-5 w-5"}):c.jsx(Bo,{className:"h-5 w-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:c.jsx("h4",{className:"text-lg font-medium text-gray-900",children:T==null?void 0:T.name})}),D.description&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:D.description}),D.late_reason&&c.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["Late entry: ",D.late_reason]}),D.status==="delayed"&&D.delay_reason&&c.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Delay reason: ",D.delay_reason]}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-gray-500",children:[c.jsxs("span",{children:["Created: ",zt(new Date(D.created_at),"MMM d, yyyy HH:mm")]}),D.completed_at&&c.jsxs("span",{children:["Completed: ",zt(new Date(D.completed_at),"MMM d, yyyy HH:mm")]})]})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-3",children:[c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Amount: ",y," ",D.amount.toFixed(2)]}),C>0&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-sm font-medium text-red-600",children:["-",y," ",C.toFixed(2)]}),c.jsxs("p",{className:"text-sm font-medium text-green-600",children:["Net: ",y," ",P.toFixed(2)]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>{f(u===D.id?null:D.id)},className:`px-3 py-1.5 text-xs font-medium rounded-full ${k1[D.status].bg} ${k1[D.status].text} ${k1[D.status].hover}`,children:E1[D.status]}),c.jsx("button",{onClick:()=>l(o===D.id?null:D.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:c.jsx(Og,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>E(D.id),className:"p-2 text-red-400 hover:text-red-600 rounded-full hover:bg-red-50",children:c.jsx(is,{className:"h-5 w-5"})})]})]})]}),u===D.id&&c.jsx("div",{className:"mt-4 border-t pt-4",children:c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Update Task Status"}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(E1).map(([A,q])=>A!==D.status&&(A!=="delayed"?c.jsx("button",{onClick:()=>w(D.id,A),className:"px-3 py-1.5 text-sm font-medium rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:q},A):null))}),D.status!=="delayed"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Delay Reason"}),c.jsx("textarea",{value:p,onChange:A=>m(A.target.value),className:`${lf} h-20`,placeholder:"Please provide a reason for the delay",required:!0}),c.jsx("button",{onClick:()=>w(D.id,"delayed",p),disabled:!p.trim(),className:"mt-4 w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Mark as Delayed"})]})]})]})}),o===D.id&&c.jsx(sR,{task:D,tasks:t,setTasks:r,organization:i})]})},D.id)})})]})})}function oR(){const[e,t]=pe.useState(null),[r,n]=pe.useState(!1),[i,s]=pe.useState(null),[a,o]=pe.useState([]),[l,u]=pe.useState([]),[f,p]=pe.useState(!0),[m,h]=pe.useState(new Date),v=Di(m,{weekStartsOn:1}),x=_o(m,{weekStartsOn:1}),b=new Date,y=Pp(m,{weekStartsOn:1}),w=tx(m),{id:_}=bb(),E=uu(),{organization:O}=Kt(),{confirm:D,addToast:T}=jn();pe.useEffect(()=>{!O||!_||C()},[_,O,m]);const C=async()=>{try{const{data:A,error:q}=await Ge.from("workers").select("*, organization:organizations(id)").eq("id",_).single();if(q)throw q;t({...A,organization_id:A.organization.id}),s({...A,organization_id:A.organization.id});const{data:J,error:te}=await Ge.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects(*)
        `).eq("worker_id",_);if(te)throw te;o(J||[]);const{data:z,error:B}=await Ge.from("tasks").select(`
          *,
          deductions (*)
        `).eq("worker_id",_).gte("date",v.toISOString()).lte("date",x.toISOString()).order("created_at",{ascending:!1});if(B)throw B;u(z||[])}catch(A){console.error("Error loading data:",A),T({type:"error",title:"Error",message:"Failed to load worker data. Please try again."})}finally{p(!1)}},P=async()=>{if(!(!e||!i||!O))try{const{error:A}=await Ge.from("workers").update({name:i.name,whatsapp:i.whatsapp,image:i.image}).eq("id",e.id).eq("organization_id",O.id);if(A)throw A;t(i),n(!1),T({type:"success",title:"Worker Updated",message:"Worker details have been updated successfully."})}catch(A){console.error("Error updating worker:",A),T({type:"error",title:"Error",message:"Failed to update worker. Please try again."})}},R=async()=>{if(!(!e||!await D({title:"Delete Worker",message:"Are you sure you want to delete this worker? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"})))try{if(e.image){const J=e.image.split("/").slice(-2).join("/");await Ge.storage.from("profiles").remove([J])}const{error:q}=await Ge.from("workers").delete().eq("id",e.id);if(q)throw q;T({type:"success",title:"Worker Deleted",message:"The worker has been deleted successfully."}),E("/dashboard/workers")}catch(q){console.error("Error deleting worker:",q),T({type:"error",title:"Error",message:"Failed to delete worker. Please try again."})}},j=A=>{h(q=>{const J=new Date(q);return A==="prev"?J.setDate(J.getDate()-7):J.setDate(J.getDate()+7),J})};return f?c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading worker details..."})]})}):e?c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>j("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:c.jsx(jp,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"text-sm",children:[c.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",y,", ",w]}),c.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[zt(v,"MMM d")," - ",zt(x,"MMM d")]})]}),c.jsx("button",{onClick:()=>j("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:pl(x,b),children:c.jsx(Cp,{className:"h-5 w-5 text-gray-600"})})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[l.length," tasks this week"]})]})}),c.jsx(nR,{worker:e,tasks:l,workerProjects:a,isEditing:r,setIsEditing:n,editedWorker:i,setEditedWorker:s,handleEditWorker:P,handleDeleteWorker:R}),c.jsx(iR,{worker:e,workerProjects:a,setWorkerProjects:o,organization:O}),c.jsx(aR,{worker:e,tasks:l,setTasks:u,workerProjects:a,organization:O})]}):c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600",children:"Worker not found."}),c.jsxs("button",{onClick:()=>E("/dashboard/workers"),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(Lg,{className:"h-4 w-4 mr-2"}),"Back to Workers"]})]})})}function lR(){var o;const{organization:e}=Kt(),[t,r]=pe.useState({totalWorkers:0,pendingTasks:0,inProgressTasks:0,delayedTasks:0,completedTasks:0,totalPayouts:0}),[n,i]=pe.useState(!0),s=((o=Jr[e.currency])==null?void 0:o.symbol)||e.currency;if(pe.useEffect(()=>{(async()=>{if(e)try{const{count:u}=await Ge.from("workers").select("*",{count:"exact",head:!0}).eq("organization_id",e.id),{data:f}=await Ge.from("tasks").select("status, amount, deductions(*)").eq("organization_id",e.id),p=(f==null?void 0:f.filter(b=>b.status==="pending").length)||0,m=(f==null?void 0:f.filter(b=>b.status==="in_progress").length)||0,h=(f==null?void 0:f.filter(b=>b.status==="delayed").length)||0,v=(f==null?void 0:f.filter(b=>b.status==="completed").length)||0,x=(f==null?void 0:f.reduce((b,y)=>{var _;const w=((_=y.deductions)==null?void 0:_.reduce((E,O)=>E+(O.amount||0),0))||0;return b+(y.amount-w)},0))||0;r({totalWorkers:u||0,pendingTasks:p,inProgressTasks:m,delayedTasks:h,completedTasks:v,totalPayouts:x})}catch(u){console.error("Error loading stats:",u)}finally{i(!1)}})()},[e]),n)return c.jsx("div",{className:"animate-pulse",children:c.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((l,u)=>c.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:c.jsxs("div",{className:"p-5",children:[c.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-4"}),c.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"})]})},u))})});const a=[{name:"Total Workers",value:t.totalWorkers,icon:ru,color:"text-blue-600",bg:"bg-blue-100",link:"/dashboard/workers"},{name:"Assigned Tasks",value:t.pendingTasks,icon:Oc,color:"text-yellow-600",bg:"bg-yellow-100",link:"/dashboard/tasks/pending"},{name:"In Progress",value:t.inProgressTasks,icon:Oc,color:"text-blue-600",bg:"bg-blue-100",link:"/dashboard/tasks/in_progress"},{name:"Delayed Tasks",value:t.delayedTasks,icon:Oc,color:"text-red-600",bg:"bg-red-100",link:"/dashboard/tasks/delayed"},{name:"Completed Tasks",value:t.completedTasks,icon:HT,color:"text-green-600",bg:"bg-green-100",link:"/dashboard/tasks/completed"},{name:"Total Payouts",value:`${s} ${t.totalPayouts.toFixed(2)}`,icon:Ao,color:"text-purple-600",bg:"bg-purple-100",link:"/dashboard/finances"}];return c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:a.map(l=>c.jsx(on,{to:l.link,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow",children:c.jsx("div",{className:"p-5",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:`flex-shrink-0 ${l.bg} rounded-md p-3`,children:c.jsx(l.icon,{className:`h-6 w-6 ${l.color}`,"aria-hidden":"true"})}),c.jsx("div",{className:"ml-5 w-0 flex-1",children:c.jsxs("dl",{children:[c.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:l.name}),c.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:l.value})]})})]})})},l.name))}),c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[c.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Quick Actions"}),c.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[c.jsxs(on,{to:"/dashboard/workers",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[c.jsx("div",{className:"flex-shrink-0 bg-blue-100 rounded-md p-3",children:c.jsx(ru,{className:"h-6 w-6 text-blue-600","aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Manage Workers"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Add or edit worker details"})]})]}),c.jsxs(on,{to:"/dashboard/tasks",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[c.jsx("div",{className:"flex-shrink-0 bg-yellow-100 rounded-md p-3",children:c.jsx(Oc,{className:"h-6 w-6 text-yellow-600","aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Manage Tasks"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Create and track tasks"})]})]}),c.jsxs(on,{to:"/dashboard/finances",className:"relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[c.jsx("div",{className:"flex-shrink-0 bg-purple-100 rounded-md p-3",children:c.jsx(Ao,{className:"h-6 w-6 text-purple-600","aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("span",{className:"absolute inset-0","aria-hidden":"true"}),c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Financial Reports"}),c.jsx("p",{className:"text-sm text-gray-500",children:"View and export financial data"})]})]})]})]})})]})}const e0={pending:"Pending",in_progress:"In Progress",completed:"Completed",delayed:"Delayed"},Qo={pending:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},completed:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},delayed:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"}};function cf({status:e}){var M;const{organization:t}=Kt(),[r,n]=pe.useState([]),[i,s]=pe.useState([]),[a,o]=pe.useState([]),[l,u]=pe.useState(!0),[f,p]=pe.useState(!1),[m,h]=pe.useState(null),[v,x]=pe.useState(null),[b,y]=pe.useState(new Date),w=Di(b,{weekStartsOn:1}),_=_o(b,{weekStartsOn:1}),E=new Date,O=Pp(b,{weekStartsOn:1}),D=tx(b),[T,C]=pe.useState(""),[P,R]=pe.useState({worker_id:"",project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),[j,A]=pe.useState({amount:0,reason:""}),{confirm:q,addToast:J}=jn(),te=t!=null&&t.currency?((M=Jr[t.currency])==null?void 0:M.symbol)||t.currency:"";pe.useEffect(()=>{t!=null&&t.id&&z()},[t,w,_,e]),pe.useEffect(()=>{!t||!P.worker_id||B(P.worker_id)},[t,P.worker_id]);const z=async()=>{if(!(t!=null&&t.id))return;const L=t.id;try{const{data:H,error:se}=await Ge.from("workers").select("id, name").eq("organization_id",L);if(se)throw se;s(H||[]);let fe=Ge.from("tasks").select(`
          *,
          deductions (*),
          project:projects(
            id,
            name
          ),
          worker:workers(
            id,
            name
          )
        `).eq("organization_id",L).gte("date",w.toISOString()).lte("date",_.toISOString()).order("created_at",{ascending:!1});e&&(fe=fe.eq("status",e));const{data:de,error:ve}=await fe;if(ve)throw ve;n(de||[])}catch(H){console.error("Error loading data:",H)}finally{u(!1)}},B=async L=>{if(t!=null&&t.id)try{const{data:se,error:fe}=await Ge.from("worker_project_rates").select(`
          id,
          worker_id,
          project_id,
          rate,
          project:projects!inner(
            id,
            name
          )
        `).eq("worker_id",L).returns();if(fe)throw fe;o(se||[])}catch(se){console.error("Error loading worker projects:",se)}},G=async()=>{var de;if(!t||!P.worker_id||!P.project_id)return;const L=((de=a.find(ve=>ve.project_id===P.project_id))==null?void 0:de.rate)||0,H=new Date(P.date),se=kl(new Date),fe=pl(se,H);if(fe&&!P.late_reason){alert("Please provide a reason for adding a task for a past date.");return}try{const{data:ve,error:Ee}=await Ge.from("tasks").insert([{organization_id:t.id,worker_id:P.worker_id,project_id:P.project_id,description:P.description.trim()||null,date:P.date,amount:L,status:"pending",late_reason:fe?P.late_reason:null}]).select(`
          *,
          deductions (*)
        `).single();if(Ee)throw Ee;n(Oe=>[ve,...Oe]),R({worker_id:"",project_id:"",description:"",date:new Date().toISOString().split("T")[0],late_reason:""}),p(!1)}catch(ve){console.error("Error adding task:",ve)}},V=async L=>{if(await q({title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:se}=await Ge.from("tasks").delete().eq("id",L);if(se)throw se;n(fe=>fe.filter(de=>de.id!==L)),J({type:"success",title:"Task Deleted",message:"The task has been deleted successfully."})}catch(se){console.error("Error deleting task:",se),J({type:"error",title:"Error",message:"Failed to delete task. Please try again."})}},Z=async(L,H,se)=>{try{const fe={status:H};H==="completed"?fe.completed_at=new Date().toISOString():H==="delayed"&&(fe.delay_reason=se),fe.status_changed_at=new Date().toISOString();const{error:de}=await Ge.from("tasks").update(fe).eq("id",L);if(de)throw de;n(ve=>ve.map(Ee=>Ee.id===L?{...Ee,...fe}:Ee)),x(null),C(""),J({type:"success",title:"Status Updated",message:`Task marked as ${e0[H]}`})}catch(fe){console.error("Error updating task status:",fe),J({type:"error",title:"Error",message:"Failed to update task status"})}},he=async L=>{if(!(!L||!j.amount||!j.reason))try{const{data:H,error:se}=await Ge.from("deductions").insert([{task_id:L,amount:j.amount,reason:j.reason.trim()}]).select().single();if(se)throw se;n(fe=>fe.map(de=>de.id===L?{...de,deductions:[...de.deductions||[],H]}:de)),A({amount:0,reason:""}),h(null)}catch(H){console.error("Error adding deduction:",H)}},k=async(L,H)=>{try{const{error:se}=await Ge.from("deductions").delete().eq("id",H);if(se)throw se;n(fe=>fe.map(de=>{var ve;return de.id===L?{...de,deductions:(ve=de.deductions)==null?void 0:ve.filter(Ee=>Ee.id!==H)}:de}))}catch(se){console.error("Error removing deduction:",se)}},I=L=>{y(H=>{const se=new Date(H);return L==="prev"?se.setDate(se.getDate()-7):se.setDate(se.getDate()+7),se})};return l?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex gap-2 bg-white rounded-lg p-1 shadow-sm",children:[c.jsx(on,{to:"/dashboard/tasks",className:`px-3 py-1.5 text-sm font-medium rounded-md ${e?"text-gray-500 hover:bg-gray-50":"bg-gray-100 text-gray-900"}`,children:"All Tasks"}),Object.entries(e0).map(([L,H])=>c.jsx(on,{to:`/dashboard/tasks/${L}`,className:`px-3 py-1.5 text-sm font-medium rounded-md ${e===L?`${Qo[L].bg} ${Qo[L].text}`:"text-gray-500 hover:bg-gray-100"}`,children:H},L))]}),c.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg",children:c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>I("prev"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:c.jsx(jp,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"text-sm",children:[c.jsxs("span",{className:"font-medium text-gray-900",children:["Week ",O,", ",D]}),c.jsxs("p",{className:"text-gray-500 text-xs mt-0.5",children:[zt(w,"MMM d")," - ",zt(_,"MMM d")]})]}),c.jsx("button",{onClick:()=>I("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",disabled:pl(_,E),children:c.jsx(Cp,{className:"h-5 w-5 text-gray-600"})})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," tasks this week"]})]})}),f&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border border-gray-100",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Task"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Worker *"}),c.jsxs("select",{value:P.worker_id,onChange:L=>R(H=>({...H,worker_id:L.target.value,project_id:""})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a worker"}),i.map(L=>c.jsx("option",{value:L.id,children:L.name},L.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project *"}),c.jsxs("select",{value:P.project_id,onChange:L=>R(H=>({...H,project_id:L.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500",disabled:!P.worker_id,children:[c.jsx("option",{value:"",children:"Select a project"}),a.map(L=>c.jsxs("option",{value:L.project_id,children:[L.project.name," - ",te," ",L.rate.toFixed(2)]},L.project_id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),c.jsx("input",{type:"text",value:P.description,onChange:L=>R(H=>({...H,description:L.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter task description (optional)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),c.jsx("input",{type:"date",value:P.date,onChange:L=>R(H=>({...H,date:L.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",max:new Date().toISOString().split("T")[0]})]}),pl(kl(new Date),new Date(P.date))&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Late Entry"}),c.jsx("textarea",{value:P.late_reason,onChange:L=>R(H=>({...H,late_reason:L.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm h-20",placeholder:"Please provide a reason for adding this task after the date",required:!0})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{onClick:()=>p(!1),className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:G,disabled:!P.worker_id||!P.project_id,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsx("div",{className:"p-4 space-y-4",children:r.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:e?"No tasks found matching this status.":"No tasks found for this week."}):r.map(L=>{var fe,de,ve;const H=((fe=L.deductions)==null?void 0:fe.reduce((Ee,Oe)=>Ee+Oe.amount,0))||0,se=L.amount-H;return c.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("span",{className:`mt-1 ${L.status==="completed"?"text-green-500":L.status==="delayed"?"text-red-500":"text-yellow-500"}`,children:L.status==="completed"?c.jsx(Ns,{className:"h-5 w-5"}):L.status==="delayed"?c.jsx(Bo,{className:"h-5 w-5"}):c.jsx(Og,{className:"h-5 w-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[c.jsx("h4",{className:"text-lg font-medium text-gray-900",children:((de=L.project)==null?void 0:de.name)||"Unknown Project"}),c.jsxs("span",{className:"text-sm text-gray-500",children:[" Assigned to ",((ve=L.worker)==null?void 0:ve.name)||"Unknown Worker"]})]}),L.description&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:L.description}),L.late_reason&&c.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["Late entry: ",L.late_reason]}),L.status==="delayed"&&L.delay_reason&&c.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Delay reason: ",L.delay_reason]}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-gray-500",children:[c.jsxs("span",{children:["Created: ",zt(new Date(L.created_at),"MMM d, yyyy HH:mm")]}),L.completed_at&&c.jsxs("span",{children:["Completed: ",zt(new Date(L.completed_at),"MMM d, yyyy HH:mm")]})]})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-3",children:[c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Amount: ",te," ",L.amount.toFixed(2)]}),H>0&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-sm font-medium text-red-600",children:["-",te," ",H.toFixed(2)]}),c.jsxs("p",{className:"text-sm font-medium text-green-600",children:["Net: ",te," ",se.toFixed(2)]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>x(v===L.id?null:L.id),className:`px-3 py-1.5 text-xs font-medium rounded-full ${Qo[L.status].bg} ${Qo[L.status].text} ${Qo[L.status].hover}`,children:e0[L.status]}),c.jsx("button",{onClick:()=>h(m===L.id?null:L.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:c.jsx(Og,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>V(L.id),className:"p-2 text-red-400 hover:text-red-600 rounded-full hover:bg-red-50",children:c.jsx(is,{className:"h-5 w-5"})})]})]})]})}),v===L.id&&c.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Update Status"}),c.jsxs("div",{className:"space-y-3",children:[Object.entries(e0).map(([Ee,Oe])=>c.jsx("button",{onClick:()=>{if(Ee==="delayed"&&!T){J({type:"error",title:"Error",message:"Please provide a reason for the delay"});return}Z(L.id,Ee,Ee==="delayed"?T:void 0)},className:`w-full px-3 py-2 text-sm font-medium rounded-md ${L.status===Ee?`${Qo[Ee].bg} ${Qo[Ee].text}`:"bg-white text-gray-700 hover:bg-gray-100"}`,children:Oe},Ee)),v===L.id&&c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Delay Reason"}),c.jsx("textarea",{value:T,onChange:Ee=>C(Ee.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm h-20",placeholder:"Required if marking as delayed"})]})]})]}),m===L.id&&c.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Deductions"}),L.deductions&&L.deductions.length>0&&c.jsx("div",{className:"mb-4 space-y-2",children:L.deductions.map(Ee=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{children:[c.jsxs("span",{className:"font-medium text-gray-900",children:[te," ",Ee.amount.toFixed(2)]}),c.jsxs("span",{className:"text-gray-500 ml-2",children:["- ",Ee.reason]})]}),c.jsx("button",{onClick:()=>k(L.id,Ee.id),className:"text-red-400 hover:text-red-600",children:c.jsx(is,{className:"h-4 w-4"})})]},Ee.id))}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),c.jsx("input",{type:"number",value:j.amount,onChange:Ee=>A(Oe=>({...Oe,amount:parseFloat(Ee.target.value)||0})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason"}),c.jsx("input",{type:"text",value:j.reason,onChange:Ee=>A(Oe=>({...Oe,reason:Ee.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsx("button",{onClick:()=>he(L.id),disabled:!j.amount||!j.reason.trim(),className:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Deduction"})]})]})]},L.id)})})})]})}const J5=[{value:15,label:"0-15 employees"},{value:30,label:"15-30 employees"},{value:50,label:"30-50 employees"},{value:100,label:"50-100 employees"},{value:200,label:"100-200 employees"},{value:201,label:"200+ employees"}],A1={GHS:{name:"Ghanaian Cedi",symbol:""},USD:{name:"US Dollar",symbol:"$"},EUR:{name:"Euro",symbol:""},GBP:{name:"British Pound",symbol:""},NGN:{name:"Nigerian Naira",symbol:""}};function cR(){var m,h,v;const{organization:e,signOut:t}=Kt();uu();const[r,n]=pe.useState(!1),[i,s]=pe.useState({name:e.name,country:e.country||"",city:e.city||"",address:e.address||"",employee_count:e.employee_count||15,currency:e.currency||"GHS"}),[a,o]=pe.useState(!1),{confirm:l,addToast:u}=jn(),f=async()=>{if(!i.name.trim()){n(!1);return}o(!0);try{const{error:x}=await Ge.from("organizations").update({name:i.name.trim(),country:i.country,city:i.city,address:i.address,employee_count:i.employee_count,currency:i.currency}).eq("id",e.id);if(x)throw x;Kt.setState({organization:{...e,...i}}),n(!1),u({type:"success",title:"Organization Updated",message:"Organization details have been updated successfully."})}catch(x){console.error("Error updating organization:",x),u({type:"error",title:"Error",message:"Failed to update organization name. Please try again."})}finally{o(!1)}},p=async()=>{if(await l({title:"Delete Organization",message:"Are you sure you want to delete your organization? This will permanently delete all workers, tasks, and associated data. This action cannot be undone.",type:"danger",confirmText:"Delete Organization",cancelText:"Cancel"}))try{const{error:b}=await Ge.from("organizations").delete().eq("id",e.id);if(b)throw b;await t(),window.location.href="/",u({type:"success",title:"Organization Deleted",message:"Your organization and all associated data have been permanently deleted."})}catch(b){console.error("Error deleting organization:",b),u({type:"error",title:"Error",message:"Failed to delete organization. Please try again."})}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white shadow rounded-lg divide-y",children:[c.jsxs("div",{className:"px-6 py-5",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Qs,{className:"h-6 w-6 text-gray-400"}),c.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Services"})]}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage the services your organization provides."})]}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"space-y-4",children:c.jsxs(on,{to:"/dashboard/settings/services",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Manage Services"]})})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg divide-y",children:[c.jsxs("div",{className:"px-6 py-5",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Eo,{className:"h-6 w-6 text-gray-400"}),c.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Organization Settings"})]}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your organization's basic information and settings."})]}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"space-y-6",children:c.jsx("div",{children:r?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organization Name"}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{type:"text",value:i.name,onChange:x=>s(b=>({...b,name:x.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter organization name"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{type:"text",value:i.country,onChange:x=>s(b=>({...b,country:x.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{type:"text",value:i.city,onChange:x=>s(b=>({...b,city:x.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),c.jsx("div",{className:"mt-1",children:c.jsx("textarea",{value:i.address,onChange:x=>s(b=>({...b,address:x.target.value})),rows:3,className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Employees"}),c.jsx("div",{className:"mt-1",children:c.jsx("select",{value:i.employee_count||"",onChange:x=>s(b=>({...b,employee_count:parseInt(x.target.value)})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:J5.map((x,b)=>c.jsx("option",{value:x.value,children:x.label},b))})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Currency"}),c.jsx("div",{className:"mt-1",children:c.jsx("select",{value:i.currency,onChange:x=>s(b=>({...b,currency:x.target.value})),className:"block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:Object.entries(A1).map(([x,{name:b,symbol:y}])=>c.jsxs("option",{value:x,children:[x," (",y,") - ",b]},x))})})]}),c.jsx("button",{onClick:f,disabled:a||!i.name.trim(),className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:a?"Saving...":"Save"}),c.jsx("button",{onClick:()=>{n(!1),s({name:e.name,country:e.country,city:e.city,address:e.address,employee_count:e.employee_count,currency:e.currency})},className:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Eo,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Organization Name"}),c.jsx("p",{className:"text-base text-gray-900",children:e.name})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(FT,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Country"}),c.jsx("p",{className:"text-base text-gray-900",children:e.country})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(TT,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"City"}),c.jsx("p",{className:"text-base text-gray-900",children:e.city})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(i_,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Address"}),c.jsx("p",{className:"text-base text-gray-900",children:e.address})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(ru,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Number of Employees"}),c.jsx("p",{className:"text-base text-gray-900",children:((m=J5.find(x=>x.value===e.employee_count))==null?void 0:m.label)||"Not set"})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(CT,{className:"h-5 w-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Currency"}),c.jsxs("p",{className:"text-base text-gray-900",children:[e.currency," (",(h=A1[e.currency])==null?void 0:h.symbol,") - ",(v=A1[e.currency])==null?void 0:v.name]})]})]})]}),c.jsx("button",{onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Edit Organization Details"})]})})})})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg divide-y space-y-4",children:[c.jsxs("div",{className:"px-6 py-5",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(ad,{className:"h-6 w-6 text-red-500"}),c.jsx("h3",{className:"ml-3 text-lg font-medium text-red-600",children:"Danger Zone"})]}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Irreversible and destructive actions"})]}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(ad,{className:"h-5 w-5 text-red-400"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Delete Organization"}),c.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[c.jsx("p",{children:"Once you delete your organization, there is no going back. Please be certain. This will delete:"}),c.jsxs("ul",{className:"list-disc list-inside mt-2",children:[c.jsx("li",{children:"All workers and their data"}),c.jsx("li",{children:"All tasks and financial records"}),c.jsx("li",{children:"All projects and rates"}),c.jsx("li",{children:"All uploaded files and images"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx("button",{type:"button",onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Organization"})})]})]})})}),c.jsx("div",{className:"px-6 py-5",children:c.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx($T,{className:"h-5 w-5 text-red-400"})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Delete Account"}),c.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[c.jsx("p",{children:"Permanently delete your account and all associated data. This action cannot be undone. This will:"}),c.jsxs("ul",{className:"list-disc list-inside mt-2",children:[c.jsx("li",{children:"Delete your user account"}),c.jsx("li",{children:"Delete your organization"}),c.jsx("li",{children:"Remove all workers and their data"}),c.jsx("li",{children:"Remove all tasks and financial records"}),c.jsx("li",{children:"Delete all uploaded files"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx("button",{type:"button",onClick:async()=>{if(await l({title:"Delete Account",message:"Are you absolutely sure you want to delete your account? This action cannot be undone.",type:"danger",confirmText:"Delete Account",cancelText:"Cancel"}))try{await Kt.getState().deleteAccount(),window.location.href="/"}catch(b){console.error("Error deleting account:",b)}},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Account Permanently"})})]})]})})})]})]})}function uR(){var J;const[e,t]=pe.useState([]),[r,n]=pe.useState(!0),[i,s]=pe.useState(""),[a,o]=pe.useState(null),[l,u]=pe.useState(!1),[f,p]=pe.useState({title:"",value:"",type:"text",file:null}),[m,h]=pe.useState({name:"",phone:"",address:"",date_of_birth:"",customFields:[{title:"",value:"",type:"text",file:null}]}),[v,x]=pe.useState(!1),{organization:b}=Kt(),{confirm:y,addToast:w}=jn(),_=b!=null&&b.currency?((J=Jr[b.currency])==null?void 0:J.symbol)||b.currency:"";pe.useEffect(()=>{b&&E()},[b]);const E=async()=>{if(b!=null&&b.id)try{const{data:te,error:z}=await Ge.from("clients").select(`
          *,
          custom_fields:client_custom_fields(*),
          orders:orders(outstanding_balance)
        `).eq("organization_id",b.id).order("name");if(z)throw z;const B=(te==null?void 0:te.map(G=>{var V;return{...G,total_balance:((V=G.orders)==null?void 0:V.reduce((Z,he)=>Z+(he.outstanding_balance||0),0))||0}}))||[];t(B)}catch(te){console.error("Error loading clients:",te),w({type:"error",title:"Error",message:"Failed to load clients"})}finally{n(!1)}},O=async()=>{var te;if(!(!b||!m.name.trim())){x(!0);try{const{data:z,error:B}=await Ge.from("clients").insert([{organization_id:b.id,name:m.name.trim(),phone:m.phone.trim(),address:m.address.trim(),date_of_birth:m.date_of_birth||null}]).select().single();if(B)throw B;const G=m.customFields.filter(V=>V.title.trim()&&(V.type==="text"?V.value.trim():V.file));if(G.length>0)for(const V of G){let Z=V.value;if(V.type==="file"&&V.file){const k=(te=V.file.name.split(".").pop())==null?void 0:te.toLowerCase(),I=`${Math.random().toString(36).substring(2)}.${k}`,M=`${b.id}/clients/${z.id}/${I}`,{error:L}=await Ge.storage.from("profiles").upload(M,V.file,{cacheControl:"3600",upsert:!1});if(L)throw L;const{data:{publicUrl:H}}=Ge.storage.from("profiles").getPublicUrl(M);Z=H}const{error:he}=await Ge.from("client_custom_fields").insert({client_id:z.id,title:V.title.trim(),value:Z,type:V.type});if(he)throw he}await E(),h({name:"",phone:"",address:"",date_of_birth:"",customFields:[{title:"",value:"",type:"text",file:null}]}),u(!1),w({type:"success",title:"Client Added",message:"New client has been added successfully."})}catch(z){console.error("Error adding client:",z),w({type:"error",title:"Error",message:"Failed to add client"})}finally{x(!1)}}},D=async te=>{if(await y({title:"Delete Client",message:"Are you sure you want to delete this client? This will also delete all their custom information.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:B}=await Ge.from("clients").delete().eq("id",te);if(B)throw B;t(G=>G.filter(V=>V.id!==te)),w({type:"success",title:"Client Deleted",message:"Client has been deleted successfully."})}catch(B){console.error("Error deleting client:",B),w({type:"error",title:"Error",message:"Failed to delete client"})}},T=async te=>{const z=e.find(B=>B.id===te);if(z)try{const{error:B}=await Ge.from("clients").update({name:z.name,phone:z.phone,address:z.address,date_of_birth:z.date_of_birth}).eq("id",te);if(B)throw B;o(null),w({type:"success",title:"Client Updated",message:"Client details have been updated successfully."})}catch(B){console.error("Error updating client:",B),w({type:"error",title:"Error",message:"Failed to update client"})}},C=async(te,z,B,G="text")=>{try{const{data:V,error:Z}=await Ge.from("client_custom_fields").insert([{client_id:te,title:z.trim(),value:B.trim(),type:G}]).select().single();if(Z)throw Z;t(he=>he.map(k=>k.id===te?{...k,custom_fields:[...k.custom_fields||[],V]}:k)),w({type:"success",title:"Field Added",message:"Custom field has been added successfully."})}catch(V){console.error("Error adding custom field:",V),w({type:"error",title:"Error",message:"Failed to add custom field"})}},P=async(te,z)=>{try{const{error:B}=await Ge.from("client_custom_fields").delete().eq("id",z);if(B)throw B;t(G=>G.map(V=>{var Z;return V.id===te?{...V,custom_fields:(Z=V.custom_fields)==null?void 0:Z.filter(he=>he.id!==z)}:V})),w({type:"success",title:"Field Deleted",message:"Custom field has been deleted successfully."})}catch(B){console.error("Error deleting custom field:",B),w({type:"error",title:"Error",message:"Failed to delete custom field"})}},R=()=>{h(te=>({...te,customFields:[...te.customFields,{title:"",value:"",type:"text",file:null}]}))},j=te=>{h(z=>({...z,customFields:z.customFields.filter((B,G)=>G!==te)}))},A=(te,z)=>{h(B=>({...B,customFields:B.customFields.map((G,V)=>V===te?{...G,...z}:G)}))};if(r)return c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const q=e.filter(te=>{var z,B;return te.name.toLowerCase().includes(i.toLowerCase())||((z=te.phone)==null?void 0:z.toLowerCase().includes(i.toLowerCase()))||((B=te.address)==null?void 0:B.toLowerCase().includes(i.toLowerCase()))});return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Clients"}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Client"]})]}),l&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Client"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),c.jsx("input",{type:"text",value:m.name,onChange:te=>h(z=>({...z,name:te.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter client name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),c.jsx("input",{type:"tel",value:m.phone,onChange:te=>h(z=>({...z,phone:te.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter phone number"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),c.jsx("textarea",{value:m.address,onChange:te=>h(z=>({...z,address:te.target.value})),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter address"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),c.jsx("input",{type:"date",value:m.date_of_birth,onChange:te=>h(z=>({...z,date_of_birth:te.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Custom Information"}),c.jsxs("button",{type:"button",onClick:R,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:[c.jsx(pn,{className:"h-4 w-4 mr-1"}),"Add Field"]})]}),m.customFields.map((te,z)=>c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex-1 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),c.jsx("input",{type:"text",value:te.title,onChange:B=>A(z,{title:B.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),c.jsxs("select",{value:te.type,onChange:B=>A(z,{type:B.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"text",children:"Text"}),c.jsx("option",{value:"file",children:"File"})]})]}),te.type==="text"?c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),c.jsx("input",{type:"text",value:te.value||"",onChange:B=>A(z,{value:B.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),c.jsxs("div",{className:"mt-1 flex items-center",children:[c.jsx("input",{type:"file",onChange:B=>{var V;const G=(V=B.target.files)==null?void 0:V[0];G&&A(z,{file:G})},className:"hidden",id:`file-${z}`}),c.jsxs("label",{htmlFor:`file-${z}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(z0,{className:"h-4 w-4 mr-2"}),"Choose File"]}),te.file&&c.jsx("span",{className:"ml-3 text-sm text-gray-500",children:te.file.name})]})]})]}),c.jsx("button",{type:"button",onClick:()=>j(z),className:"mt-8 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:c.jsx(is,{className:"h-5 w-5"})})]},z))]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{onClick:O,disabled:!m.name.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:v?c.jsxs(c.Fragment,{children:[c.jsx(Sd,{className:"animate-spin h-4 w-4 mr-2"}),"Adding..."]}):"Add Client"})]})]})]}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsx("div",{className:"p-4 border-b",children:c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Nd,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:te=>s(te.target.value),placeholder:"Search clients...",className:"ml-2 flex-1 outline-none bg-transparent"})]})}),c.jsx("div",{className:"overflow-x-auto",children:q.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:i?"No clients found matching your search.":"No clients added yet."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date of Birth"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Custom Information"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map(te=>{var z;return c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a===te.id?c.jsx("input",{type:"text",value:te.name,onChange:B=>t(G=>G.map(V=>V.id===te.id?{...V,name:B.target.value}:V)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):c.jsx("div",{className:"text-sm font-medium text-gray-900",children:te.name})}),c.jsx("td",{className:"px-6 py-4",children:a===te.id?c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"tel",value:te.phone||"",onChange:B=>t(G=>G.map(V=>V.id===te.id?{...V,phone:B.target.value}:V)),placeholder:"Phone",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),c.jsx("textarea",{value:te.address||"",onChange:B=>t(G=>G.map(V=>V.id===te.id?{...V,address:B.target.value}:V)),placeholder:"Address",rows:2,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}):c.jsxs("div",{className:"text-sm text-gray-500",children:[te.phone&&c.jsxs("div",{className:"flex items-center",children:[c.jsx(o_,{className:"h-4 w-4 mr-1"}),te.phone]}),te.address&&c.jsxs("div",{className:"flex items-center mt-1",children:[c.jsx(i_,{className:"h-4 w-4 mr-1"}),te.address]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a===te.id?c.jsx("input",{type:"date",value:te.date_of_birth||"",onChange:B=>t(G=>G.map(V=>V.id===te.id?{...V,date_of_birth:B.target.value}:V)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):te.date_of_birth?c.jsx("div",{className:"text-sm text-gray-500",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(hu,{className:"h-4 w-4 mr-1"}),zt(new Date(te.date_of_birth),"MMM d, yyyy")]})}):null}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"text-sm text-gray-900",children:[(z=te.custom_fields)==null?void 0:z.map((B,G)=>c.jsxs("div",{className:"flex items-center justify-between mb-2 bg-gray-50 p-2 rounded",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("span",{className:"font-medium",children:[B.title,": "]}),B.type==="file"?c.jsx("a",{href:B.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"View File"}):c.jsx("span",{children:B.value})]}),c.jsx("button",{onClick:()=>P(te.id,B.id),className:"ml-2 p-1 text-red-600 hover:text-red-800 rounded-full hover:bg-red-50",children:c.jsx(Gs,{className:"h-4 w-4"})})]},B.id)),a===te.id&&c.jsxs("div",{className:"mt-4 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Add Custom Information"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),c.jsxs("select",{value:f.type,onChange:B=>p(G=>({...G,type:B.target.value,value:"",file:null})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"text",children:"Text"}),c.jsx("option",{value:"file",children:"File"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),c.jsx("input",{type:"text",value:f.title,onChange:B=>p(G=>({...G,title:B.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter field title"})]}),f.type==="text"?c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Value"}),c.jsx("input",{type:"text",value:f.value||"",onChange:B=>p(G=>({...G,value:B.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter value"})]}):c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),c.jsxs("div",{className:"mt-1 flex items-center",children:[c.jsx("input",{type:"file",onChange:B=>{var V;const G=(V=B.target.files)==null?void 0:V[0];G&&p(Z=>({...Z,file:G}))},className:"hidden",id:`custom-file-${te.id}`}),c.jsxs("label",{htmlFor:`custom-file-${te.id}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(z0,{className:"h-4 w-4 mr-2"}),"Choose File"]}),f.file&&c.jsx("span",{className:"ml-3 text-sm text-gray-500",children:f.file.name})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>p({title:"",value:"",type:"text",file:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Clear"}),c.jsx("button",{onClick:()=>{f.title&&(f.value||f.file)&&(C(te.id,f.title,f.value||"",f.type),p({title:"",value:"",type:"text",file:null}))},disabled:!f.title||!f.value&&!f.file,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:"Add Field"})]})]})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("span",{className:`text-sm font-medium ${te.total_balance>0?"text-red-600":"text-green-600"}`,children:[_," ",te.total_balance.toFixed(2)]}),c.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:te.total_balance>0?"Outstanding":"Paid"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a===te.id?c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>T(te.id),className:"text-green-600 hover:text-green-900",children:"Save"}),c.jsx("button",{onClick:()=>{o(null),E()},className:"text-gray-600 hover:text-gray-900",children:"Cancel"})]}):c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>o(te.id),className:"text-blue-600 hover:text-blue-900",children:c.jsx(Ll,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>D(te.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},te.id)})})]})})]})]})}function fR(){var p;const{organization:e}=Kt(),[t,r]=pe.useState(new Date),[n,i]=pe.useState([]),[s,a]=pe.useState(!0),o=((p=Jr[e.currency])==null?void 0:p.symbol)||e.currency;pe.useEffect(()=>{if(!e)return;(async()=>{a(!0);try{const h=Di(t,{weekStartsOn:1}),v=_o(t,{weekStartsOn:1}),{data:x,error:b}=await Ge.from("tasks").select(`
            *,
            deductions (
              amount
            )
          `).eq("organization_id",e.id).gte("date",h.toISOString()).lte("date",v.toISOString());if(b)throw b;const y=(x||[]).reduce((_,E)=>{var T;const O=E.date;_[O]||(_[O]={date:O,totalTasks:0,totalAmount:0,totalDeductions:0,netAmount:0});const D=((T=E.deductions)==null?void 0:T.reduce((C,P)=>C+(P.amount||0),0))||0;return _[O].totalTasks+=1,_[O].totalAmount+=E.amount,_[O].totalDeductions+=D,_[O].netAmount+=E.amount-D,_},{}),w=Object.values(y).sort((_,E)=>new Date(_.date).getTime()-new Date(E.date).getTime());i(w)}catch(h){console.error("Error loading financial data:",h)}finally{a(!1)}})()},[e,t]);const l=m=>{r(h=>m==="prev"?sC(h):p_(h,1))},u=m=>{const h=Di(t,{weekStartsOn:1}),v=_o(t,{weekStartsOn:1}),{workbook:x,pdf:b}=rR(n,{start:h,end:v},e.currency),y=`financial_report_${zt(t,"yyyy-MM-dd")}`;m==="excel"?HI(x,`${y}.xlsx`):b.save(`${y}.pdf`)},f=n.reduce((m,h)=>({tasks:m.tasks+h.totalTasks,amount:m.amount+h.totalAmount,deductions:m.deductions+h.totalDeductions,net:m.net+h.netAmount}),{tasks:0,amount:0,deductions:0,net:0});return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Financial Dashboard"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{onClick:()=>u("excel"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(Fg,{className:"h-4 w-4 mr-2"}),"Export to Excel"]}),c.jsxs("button",{onClick:()=>u("pdf"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700",children:[c.jsx(Fg,{className:"h-4 w-4 mr-2"}),"Export to PDF"]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>l("prev"),className:"p-2 hover:bg-gray-100 rounded-full",children:c.jsx(jp,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(hu,{className:"h-5 w-5 text-gray-600"}),c.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[zt(Di(t,{weekStartsOn:1}),"MMM d, yyyy")," - "," ",zt(_o(t,{weekStartsOn:1}),"MMM d, yyyy")]})]}),c.jsx("button",{onClick:()=>l("next"),className:"p-2 hover:bg-gray-100 rounded-full",children:c.jsx(Cp,{className:"h-5 w-5 text-gray-600"})})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Tasks"}),c.jsx("p",{className:"mt-2 text-3xl font-bold text-blue-900",children:f.tasks})]}),c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Amount"}),c.jsxs("p",{className:"mt-2 text-3xl font-bold text-green-900",children:[o," ",f.amount.toFixed(2)]})]}),c.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-red-600",children:"Total Deductions"}),c.jsxs("p",{className:"mt-2 text-3xl font-bold text-red-900",children:[o," ",f.deductions.toFixed(2)]})]}),c.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Net Amount"}),c.jsxs("p",{className:"mt-2 text-3xl font-bold text-purple-900",children:[o," ",f.net.toFixed(2)]})]})]}),s?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.length===0?c.jsx("div",{className:"text-center py-12",children:c.jsx("p",{className:"text-gray-500",children:"No financial data available for this week."})}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tasks"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deductions"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Amount"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(m=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:zt(new Date(m.date),"MMM d, yyyy")}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.totalTasks}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[o," ",m.totalAmount.toFixed(2)]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:[o," ",m.totalDeductions.toFixed(2)]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:[o," ",m.netAmount.toFixed(2)]})]},m.date))})]})})]})})]})}function dR(){var w;const[e,t]=pe.useState([]),[r,n]=pe.useState(!0),[i,s]=pe.useState(!1),[a,o]=pe.useState(null),[l,u]=pe.useState({name:"",cost:0}),{organization:f}=Kt(),{confirm:p,addToast:m}=jn(),h=((w=Jr[f.currency])==null?void 0:w.symbol)||f.currency;pe.useEffect(()=>{f&&v()},[f]);const v=async()=>{try{const{data:_,error:E}=await Ge.from("services").select("*").eq("organization_id",f.id).order("name");if(E)throw E;t(_||[])}catch(_){console.error("Error loading services:",_),m({type:"error",title:"Error",message:"Failed to load services"})}finally{n(!1)}},x=async()=>{if(!(!f||!l.name.trim()||!l.cost))try{const{data:_,error:E}=await Ge.from("services").insert([{organization_id:f.id,name:l.name.trim(),cost:l.cost}]).select().single();if(E)throw E;t(O=>[...O,_]),u({name:"",cost:0}),s(!1),m({type:"success",title:"Service Added",message:"The service has been added successfully."})}catch(_){console.error("Error adding service:",_),m({type:"error",title:"Error",message:"Failed to add service. Please try again."})}},b=async _=>{const E=e.find(O=>O.id===_);if(E)try{const{error:O}=await Ge.from("services").update({name:E.name,cost:E.cost}).eq("id",_);if(O)throw O;o(null),m({type:"success",title:"Service Updated",message:"The service has been updated successfully."})}catch(O){console.error("Error updating service:",O),m({type:"error",title:"Error",message:"Failed to update service. Please try again."})}},y=async _=>{if(await p({title:"Delete Service",message:"Are you sure you want to delete this service? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:O}=await Ge.from("services").delete().eq("id",_);if(O)throw O;t(D=>D.filter(T=>T.id!==_)),m({type:"success",title:"Service Deleted",message:"The service has been deleted successfully."})}catch(O){console.error("Error deleting service:",O),m({type:"error",title:"Error",message:"Failed to delete service. Please try again."})}};return r?c.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Services"}),c.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Service"]})]}),i&&c.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Service"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Name *"}),c.jsx("input",{type:"text",value:l.name,onChange:_=>u(E=>({...E,name:_.target.value})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter service name"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Cost (",h,") *"]}),c.jsx("input",{type:"number",value:l.cost||"",onChange:_=>u(E=>({...E,cost:parseFloat(_.target.value)||0})),className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01",placeholder:"Enter service cost"})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{onClick:()=>s(!1),className:"px-6 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:x,disabled:!l.name.trim()||!l.cost,className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 flex items-center transition-colors duration-200 shadow-sm",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Service"]})]})]})]}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No services added yet. Start by adding a new service."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Service Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(_=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===_.id?c.jsx("input",{type:"text",value:_.name,onChange:E=>t(O=>O.map(D=>D.id===_.id?{...D,name:E.target.value}:D)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}):_.name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a===_.id?c.jsx("input",{type:"number",value:_.cost,onChange:E=>t(O=>O.map(D=>D.id===_.id?{...D,cost:parseFloat(E.target.value)||0}:D)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",min:"0",step:"0.01"}):`${h} ${_.cost.toFixed(2)}`}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a===_.id?c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>b(_.id),className:"text-green-600 hover:text-green-900",children:"Save"}),c.jsx("button",{onClick:()=>{o(null),v()},className:"text-gray-600 hover:text-gray-900",children:"Cancel"})]}):c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>o(_.id),className:"text-blue-600 hover:text-blue-900",children:c.jsx(Ll,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>y(_.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},_.id))})]})})]})}const Q5={raw_material:"Raw Material",finished_good:"Finished Good",packaging:"Packaging",other:"Other"},T1={unpaid:"Unpaid",partially_paid:"Partially Paid",paid:"Paid"},t0={unpaid:{bg:"bg-red-100",text:"text-red-800",hover:"hover:bg-red-200"},partially_paid:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},paid:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"}},Z5={raw_material:{bg:"bg-blue-100",text:"text-blue-800",hover:"hover:bg-blue-200"},finished_good:{bg:"bg-green-100",text:"text-green-800",hover:"hover:bg-green-200"},packaging:{bg:"bg-yellow-100",text:"text-yellow-800",hover:"hover:bg-yellow-200"},other:{bg:"bg-gray-100",text:"text-gray-800",hover:"hover:bg-gray-200"}};function hR({onClose:e,onSuccess:t}){const{organization:r}=Kt(),{addToast:n}=jn(),[i,s]=pe.useState(!1),[a,o]=pe.useState({name:"",sku:"",category:"finished_good",description:"",unit_price:"",stock_quantity:"",reorder_point:""}),l=async u=>{if(u.preventDefault(),!r)return;const f=parseFloat(a.unit_price),p=parseInt(a.stock_quantity),m=parseInt(a.reorder_point);if(isNaN(f)||f<0){n({type:"error",title:"Invalid Price",message:"Please enter a valid unit price"});return}if(isNaN(p)||p<0){n({type:"error",title:"Invalid Quantity",message:"Please enter a valid stock quantity"});return}if(isNaN(m)||m<0){n({type:"error",title:"Invalid Reorder Point",message:"Please enter a valid reorder point"});return}s(!0);try{const{error:h}=await Ge.from("products").insert([{organization_id:r.id,name:a.name.trim(),sku:a.sku.trim(),category:a.category,description:a.description.trim()||null,unit_price:f,stock_quantity:p,reorder_point:m}]);if(h)throw h;n({type:"success",title:"Product Created",message:"Product has been created successfully"}),t(),e()}catch(h){console.error("Error creating product:",h),n({type:"error",title:"Error",message:"Failed to create product"})}finally{s(!1)}};return c.jsxs("form",{onSubmit:l,className:"p-6 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Product"}),c.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-500",children:c.jsx(Gs,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),c.jsx("input",{type:"text",required:!0,value:a.name,onChange:u=>o(f=>({...f,name:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SKU *"}),c.jsx("input",{type:"text",required:!0,value:a.sku,onChange:u=>o(f=>({...f,sku:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category *"}),c.jsxs("select",{required:!0,value:a.category,onChange:u=>o(f=>({...f,category:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"raw_material",children:"Raw Material"}),c.jsx("option",{value:"finished_good",children:"Finished Good"}),c.jsx("option",{value:"packaging",children:"Packaging"}),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),c.jsx("textarea",{value:a.description,onChange:u=>o(f=>({...f,description:u.target.value})),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Price *"}),c.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:a.unit_price,onChange:u=>o(f=>({...f,unit_price:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity *"}),c.jsx("input",{type:"number",required:!0,min:"0",step:"1",value:a.stock_quantity,onChange:u=>o(f=>({...f,stock_quantity:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reorder Point *"}),c.jsx("input",{type:"number",required:!0,min:"0",step:"1",value:a.reorder_point,onChange:u=>o(f=>({...f,reorder_point:u.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:i?c.jsxs(c.Fragment,{children:[c.jsx(Sd,{className:"animate-spin h-4 w-4 mr-2"}),"Creating..."]}):"Create Product"})]})]})}function pR(){var y;const[e,t]=pe.useState([]),[r,n]=pe.useState(!0),[i,s]=pe.useState(""),[a,o]=pe.useState("all"),[l,u]=pe.useState(!1),{organization:f}=Kt(),{confirm:p,addToast:m}=jn(),h=f!=null&&f.currency?((y=Jr[f.currency])==null?void 0:y.symbol)||f.currency:"";pe.useEffect(()=>{f&&v()},[f]);const v=async()=>{if(f!=null&&f.id)try{const{data:w,error:_}=await Ge.from("products").select("*").eq("organization_id",f.id).order("name");if(_)throw _;t(w||[])}catch(w){console.error("Error loading products:",w),m({type:"error",title:"Error",message:"Failed to load products"})}finally{n(!1)}},x=async w=>{if(await p({title:"Delete Product",message:"Are you sure you want to delete this product? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:E}=await Ge.from("products").delete().eq("id",w);if(E)throw E;t(O=>O.filter(D=>D.id!==w)),m({type:"success",title:"Product Deleted",message:"Product has been deleted successfully."})}catch(E){console.error("Error deleting product:",E),m({type:"error",title:"Error",message:"Failed to delete product"})}},b=e.filter(w=>{var _;return(a==="all"||w.category===a)&&(w.name.toLowerCase().includes(i.toLowerCase())||((_=w.description)==null?void 0:_.toLowerCase().includes(i.toLowerCase())))});return r?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Products"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your inventory"})]}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Product"]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"Search products...",className:"block w-full rounded-lg border border-gray-300 py-2 pl-10 pr-3 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"}),c.jsx(Nd,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"})]}),c.jsxs("select",{value:a,onChange:w=>o(w.target.value),className:"block w-full sm:w-48 rounded-lg border border-gray-300 py-2 pl-3 pr-10 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[c.jsx("option",{value:"all",children:"All Categories"}),Object.entries(Q5).map(([w,_])=>c.jsx("option",{value:w,children:_},w))]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:b.length===0?c.jsx("div",{className:"p-6 text-center text-gray-500",children:"No products found."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),c.jsx("th",{scope:"col",className:"relative px-6 py-3",children:c.jsx("span",{className:"sr-only",children:"Actions"})})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(w=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center",children:c.jsx(Qs,{className:"h-6 w-6 text-gray-400"})}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name}),w.description&&c.jsx("div",{className:"text-sm text-gray-500",children:w.description})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Z5[w.category].bg} ${Z5[w.category].text}`,children:Q5[w.category]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w.sku}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h," ",w.unit_price.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:`text-sm font-medium ${w.stock_quantity<=w.reorder_point?"text-red-600":"text-gray-900"}`,children:w.stock_quantity}),w.stock_quantity<=w.reorder_point&&c.jsx("span",{className:"text-xs text-red-500 ml-2",children:"Low stock"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>{},className:"text-blue-600 hover:text-blue-900",children:c.jsx(Ll,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>x(w.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},w.id))})]})}),l&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:c.jsx(hR,{onClose:()=>u(!1),onSuccess:v})})]})})]})}function mR({onClose:e,onSuccess:t}){var te;const[r,n]=pe.useState(!1),[i,s]=pe.useState([]),[a,o]=pe.useState([]),[l,u]=pe.useState(""),[f,p]=pe.useState([]),[m,h]=pe.useState({name:"",quantity:1,unit_price:0}),[v,x]=pe.useState(""),{organization:b}=Kt(),{addToast:y}=jn(),w=b!=null&&b.currency?((te=Jr[b.currency])==null?void 0:te.symbol)||b.currency:"",[_,E]=pe.useState(!0),[O,D]=pe.useState(!0);pe.useEffect(()=>{b&&(T(),C())},[b]);const T=async()=>{if(b!=null&&b.id)try{const{data:z,error:B}=await Ge.from("clients").select("*").eq("organization_id",b.id).order("name");if(B)throw B;s(z||[])}catch(z){console.error("Error loading clients:",z),y({type:"error",title:"Error",message:"Failed to load clients"})}finally{E(!1)}},C=async()=>{if(b!=null&&b.id)try{const{data:z,error:B}=await Ge.from("products").select("*").eq("organization_id",b.id).order("name");if(B)throw B;o(z||[])}catch(z){console.error("Error loading products:",z),y({type:"error",title:"Error",message:"Failed to load products"})}finally{D(!1)}},P=z=>{const B=a.find(V=>V.id===z);if(!B)return;if(B.stock_quantity<=0){y({type:"error",title:"Error",message:"This product is out of stock"});return}const G=f.find(V=>V.product_id===z);if(G){if(G.quantity>=B.stock_quantity){y({type:"error",title:"Error",message:"Not enough stock available"});return}p(V=>V.map(Z=>Z.product_id===z?{...Z,quantity:Z.quantity+1,total_price:(Z.quantity+1)*Z.unit_price}:Z))}else p(V=>[...V,{product_id:B.id,name:B.name,quantity:1,unit_price:B.unit_price,total_price:B.unit_price,is_custom_item:!1,product:B}])},R=()=>{!m.name.trim()||m.quantity<=0||m.unit_price<=0||(p(z=>[...z,{product_id:null,name:m.name.trim(),quantity:m.quantity,unit_price:m.unit_price,total_price:m.quantity*m.unit_price,is_custom_item:!0}]),h({name:"",quantity:1,unit_price:0}))},j=z=>{p(B=>B.filter((G,V)=>V!==z))},A=(z,B)=>{const G=f[z];if(G){if(!G.is_custom_item&&G.product&&B>G.product.stock_quantity){y({type:"error",title:"Error",message:"Not enough stock available"});return}if(B<=0){j(z);return}p(V=>V.map((Z,he)=>he===z?{...Z,quantity:B,total_price:B*Z.unit_price}:Z))}},q=()=>f.reduce((z,B)=>z+B.total_price,0),J=async z=>{if(z.preventDefault(),!(!b||!l||f.length===0)){n(!0);try{const{data:B,error:G}=await Ge.from("sales_orders").insert([{organization_id:b.id,client_id:l,total_amount:q(),outstanding_balance:q(),notes:v.trim()||null}]).select().single();if(G)throw G;const{error:V}=await Ge.from("sales_order_items").insert(f.map(Z=>({sales_order_id:B.id,product_id:Z.product_id,name:Z.name,quantity:Z.quantity,unit_price:Z.unit_price,total_price:Z.total_price,is_custom_item:Z.is_custom_item})));if(V)throw V;y({type:"success",title:"Order Created",message:"Sales order has been created successfully."}),t(),e()}catch(B){console.error("Error creating order:",B),y({type:"error",title:"Error",message:"Failed to create order"})}finally{n(!1)}}};return _||O?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("form",{onSubmit:J,className:"p-6 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Sales Order"}),c.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-500",children:c.jsx(Gs,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client *"}),c.jsxs("select",{required:!0,value:l,onChange:z=>u(z.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a client"}),i.map(z=>c.jsx("option",{value:z.id,children:z.name},z.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Products"}),c.jsxs("select",{value:"",onChange:z=>P(z.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a product"}),a.map(z=>c.jsxs("option",{value:z.id,disabled:z.stock_quantity<=0,children:[z.name," - ",w,z.unit_price.toFixed(2)," (",z.stock_quantity," in stock)"]},z.id))]})]}),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Custom Item Name"}),c.jsx("input",{type:"text",value:m.name,onChange:z=>h(B=>({...B,name:z.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter item name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),c.jsx("input",{type:"number",min:"1",value:m.quantity,onChange:z=>h(B=>({...B,quantity:parseInt(z.target.value)||1})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Price"}),c.jsx("input",{type:"number",min:"0",step:"0.01",value:m.unit_price,onChange:z=>h(B=>({...B,unit_price:parseFloat(z.target.value)||0})),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"0.00"})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{type:"button",onClick:R,disabled:!m.name.trim()||m.quantity<=0||m.unit_price<=0,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Custom Item"]})})]}),c.jsx("div",{className:"border rounded-lg overflow-hidden",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[f.map((z,B)=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Qs,{className:"h-5 w-5 text-gray-400 mr-2"}),c.jsx("div",{className:"text-sm text-gray-900",children:z.name})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{type:"button",onClick:()=>A(B,z.quantity-1),className:"p-1 rounded-full hover:bg-gray-100",children:c.jsx(a_,{className:"h-4 w-4 text-gray-500"})}),c.jsx("span",{className:"text-sm text-gray-900",children:z.quantity}),c.jsx("button",{type:"button",onClick:()=>A(B,z.quantity+1),className:"p-1 rounded-full hover:bg-gray-100",disabled:!z.is_custom_item&&z.product&&z.quantity>=z.product.stock_quantity,children:c.jsx(pn,{className:"h-4 w-4 text-gray-500"})})]})}),c.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[w," ",z.unit_price.toFixed(2)]}),c.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[w," ",z.total_price.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsx("button",{type:"button",onClick:()=>j(B),className:"text-red-600 hover:text-red-900",children:c.jsx(Gs,{className:"h-4 w-4"})})})]},B)),f.length>0&&c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("td",{colSpan:3,className:"px-6 py-4 text-sm font-medium text-gray-900 text-right",children:"Total Amount:"}),c.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:[w," ",q().toFixed(2)]}),c.jsx("td",{})]})]})]})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),c.jsx("textarea",{value:v,onChange:z=>x(z.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Add any notes about this order"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:r||!l||f.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:r?c.jsxs(c.Fragment,{children:[c.jsx(Sd,{className:"animate-spin h-4 w-4 mr-2"}),"Creating..."]}):"Create Sale"})]})]})}function gR(){var O;const[e,t]=pe.useState([]),[r,n]=pe.useState(!0),[i,s]=pe.useState(""),[a,o]=pe.useState("all"),[l,u]=pe.useState(!1),[f,p]=pe.useState(null),[m,h]=pe.useState(!1),{organization:v}=Kt(),{confirm:x,addToast:b}=jn(),y=v!=null&&v.currency?((O=Jr[v.currency])==null?void 0:O.symbol)||v.currency:"";pe.useEffect(()=>{v&&w()},[v]);const w=async()=>{if(v!=null&&v.id)try{const{data:D,error:T}=await Ge.from("sales_orders").select(`
          *,
          client:clients(name),
          items:sales_order_items(
            id,
            product_id,
            name,
            quantity,
            unit_price,
            total_price,
            is_custom_item,
            product:products(*)
          ),
          payments:payments(
            id,
            amount,
            payment_method,
            transaction_reference,
            created_at,
            recorded_by
          )
        `).eq("organization_id",v.id).order("created_at",{ascending:!1});if(T)throw T;t(D||[])}catch(D){console.error("Error loading orders:",D),b({type:"error",title:"Error",message:"Failed to load orders"})}finally{n(!1)}},_=async D=>{if(await x({title:"Delete Order",message:"Are you sure you want to delete this order? This action cannot be undone.",type:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:C}=await Ge.from("sales_orders").delete().eq("id",D);if(C)throw C;t(P=>P.filter(R=>R.id!==D)),b({type:"success",title:"Order Deleted",message:"Order has been deleted successfully."})}catch(C){console.error("Error deleting order:",C),b({type:"error",title:"Error",message:"Failed to delete order"})}},E=e.filter(D=>{var T,C;return(a==="all"||D.payment_status===a)&&(((T=D.order_number)==null?void 0:T.toLowerCase().includes(i.toLowerCase()))||((C=D.client)==null?void 0:C.name.toLowerCase().includes(i.toLowerCase())))});return r?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Sales Orders"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your sales orders and payments"})]}),c.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:[c.jsx(pn,{className:"h-4 w-4 mr-2"}),"Create Sale"]})]}),l&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl",children:c.jsx(mR,{onClose:()=>u(!1),onSuccess:w})})]})}),m&&f&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>{h(!1),p(null)}}),c.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:c.jsx(x_,{orderId:f.id,outstandingBalance:f.outstanding_balance,onPaymentRecorded:()=>{h(!1),p(null),w()}})})]})}),c.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50"}`,children:"All Orders"}),Object.entries(T1).map(([D,T])=>c.jsx("button",{onClick:()=>o(D),className:`px-3 py-1.5 text-sm font-medium rounded-md ${a===D?`${t0[D].bg} ${t0[D].text}`:"text-gray-500 hover:bg-gray-50"}`,children:T},D))]}),c.jsxs("div",{className:"flex items-center px-3 py-2 border rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500",children:[c.jsx(Nd,{className:"h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",value:i,onChange:D=>s(D.target.value),placeholder:"Search orders...",className:"ml-2 flex-1 outline-none bg-transparent"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:E.length===0?c.jsx("div",{className:"text-center text-gray-500 py-8",children:i||a!=="all"?"No orders found matching your search.":"No orders created yet. Start by creating a new order."}):c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Number"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(D=>{var T,C;return c.jsxs("tr",{children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.order_number}),c.jsx("div",{className:"text-xs text-gray-500",children:zt(new Date(D.created_at),"MMM d, yyyy")})]}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(hl,{className:"h-5 w-5 text-gray-400 mr-2"}),c.jsx("div",{className:"text-sm font-medium text-gray-900",children:(T=D.client)==null?void 0:T.name})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"flex flex-col space-y-1",children:(C=D.items)==null?void 0:C.map(P=>c.jsxs("div",{className:"flex items-center text-sm",children:[c.jsx(Qs,{className:"h-4 w-4 text-gray-400 mr-2"}),c.jsx("span",{className:"text-gray-900",children:P.name}),c.jsxs("span",{className:"text-gray-500 ml-2",children:[" ",P.quantity]})]},P.id))})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[y," ",D.total_amount.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("span",{className:`text-sm font-medium ${D.payment_status==="paid"?"text-green-600":D.payment_status==="partially_paid"?"text-orange-600":"text-red-600"}`,children:[y," ",D.outstanding_balance.toFixed(2)]}),c.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:T1[D.payment_status]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t0[D.payment_status].bg} ${t0[D.payment_status].text}`,children:T1[D.payment_status]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[D.payment_status!=="paid"&&c.jsx("button",{onClick:()=>{p(D),h(!0)},className:"text-green-600 hover:text-green-900",children:c.jsx(n_,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>{},className:"text-blue-600 hover:text-blue-900",children:c.jsx(Ll,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>_(D.id),className:"text-red-600 hover:text-red-900",children:c.jsx(is,{className:"h-4 w-4"})})]})})]},D.id)})})]})})]})]})}function xR(){const{user:e,organization:t}=Kt(),r=uu(),n=cu();if(!(t&&t.country&&t.city&&t.address&&t.employee_count&&t.currency))return c.jsx(dl,{to:"/organization-setup"});if(!e||!t)return null;const s=async()=>{try{await Kt.getState().signOut(),r("/signin")}catch(o){console.error("Error signing out:",o)}},a=[{name:"Overview",path:"/dashboard",icon:Eo},{name:"Workers",path:"/dashboard/workers",icon:ru},{name:"Clients",path:"/dashboard/clients",icon:l_},{name:"Orders",path:"/dashboard/orders",icon:ex},{name:"Tasks",path:"/dashboard/tasks",icon:Oc},{name:"Inventory",path:"/dashboard/inventory",icon:Qs},{name:"Sales",path:"/dashboard/sales",icon:Ao},{name:"Settings",path:"/dashboard/settings",icon:zT}];return c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("header",{className:"bg-white shadow-sm",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Eo,{className:"h-8 w-8 text-blue-600"}),c.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:t.name})]}),c.jsxs("button",{onClick:s,className:"ml-4 inline-flex items-center px-3 py-1.5 text-sm text-gray-700 hover:text-gray-900",children:[c.jsx(MT,{className:"h-4 w-4 mr-1"}),"Sign out"]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:c.jsx("nav",{className:"flex items-center justify-center space-x-1 bg-white shadow-sm rounded-lg p-1",children:a.map(o=>{const l=n.pathname===o.path;return c.jsxs(on,{to:o.path,className:`px-4 py-2 text-sm font-medium rounded-md flex items-center ${l?"text-blue-700 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:[c.jsx(o.icon,{className:`h-5 w-5 mr-2 ${l?"text-blue-700":"text-gray-400"}`}),o.name]},o.name)})})}),c.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:c.jsxs(Eb,{children:[c.jsx(Sr,{index:!0,element:c.jsx(lR,{})}),c.jsx(Sr,{path:"workers",element:c.jsx(fC,{})}),c.jsx(Sr,{path:"workers/:id",element:c.jsx(oR,{})}),c.jsx(Sr,{path:"clients",element:c.jsx(uR,{})}),c.jsx(Sr,{path:"orders",element:c.jsx(uC,{})}),c.jsx(Sr,{path:"orders/:id",element:c.jsx(lC,{})}),c.jsx(Sr,{path:"tasks",element:c.jsx(cf,{status:void 0})}),c.jsx(Sr,{path:"tasks/pending",element:c.jsx(cf,{status:"pending"})}),c.jsx(Sr,{path:"tasks/in_progress",element:c.jsx(cf,{status:"in_progress"})}),c.jsx(Sr,{path:"tasks/delayed",element:c.jsx(cf,{status:"delayed"})}),c.jsx(Sr,{path:"tasks/completed",element:c.jsx(cf,{status:"completed"})}),c.jsx(Sr,{path:"inventory",element:c.jsx(pR,{})}),c.jsx(Sr,{path:"sales",element:c.jsx(gR,{})}),c.jsx(Sr,{path:"finances",element:c.jsx(fR,{})}),c.jsx(Sr,{path:"settings",element:c.jsx(cR,{})}),c.jsx(Sr,{path:"settings/services",element:c.jsx(dR,{})})]})})]})}const vR=[{label:"0-15 employees",value:15},{label:"15-30 employees",value:30},{label:"30-50 employees",value:50},{label:"50-100 employees",value:100},{label:"100-200 employees",value:200},{label:"200+ employees",value:201}],yR=[{code:"GHS",name:"Ghanaian Cedi"},{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"NGN",name:"Nigerian Naira"}],wR=["Ghana","Nigeria","Kenya","South Africa","United States","United Kingdom","Canada"].sort();function bR(){const e=uu(),{organization:t}=Kt(),[r,n]=pe.useState(!1),[i,s]=pe.useState({country:(t==null?void 0:t.country)||"",city:(t==null?void 0:t.city)||"",address:(t==null?void 0:t.address)||"",employee_count:(t==null?void 0:t.employee_count)||15,currency:(t==null?void 0:t.currency)||"GHS"}),a=async o=>{if(o.preventDefault(),!r){n(!0);try{const{error:l}=await Ge.from("organizations").update({country:i.country,city:i.city,address:i.address,employee_count:i.employee_count,currency:i.currency}).eq("id",t.id);if(l)throw l;Kt.setState({organization:{...t,...i}}),e("/dashboard")}catch(l){console.error("Error updating organization:",l),alert("Failed to update organization. Please try again.")}finally{n(!1)}}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex flex-col justify-center py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"max-w-2xl mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"mx-auto h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:c.jsx(Eo,{className:"h-8 w-8 text-blue-600"})}),c.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Complete Your Organization Setup"}),c.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Please provide additional information about your organization"})]}),c.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:c.jsxs("form",{onSubmit:a,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),c.jsxs("select",{id:"country",value:i.country,onChange:o=>s(l=>({...l,country:o.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[c.jsx("option",{value:"",children:"Select a country"}),wR.map(o=>c.jsx("option",{value:o,children:o},o))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),c.jsx("input",{type:"text",id:"city",value:i.city,onChange:o=>s(l=>({...l,city:o.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),c.jsx("textarea",{id:"address",value:i.address,onChange:o=>s(l=>({...l,address:o.target.value})),required:!0,rows:3,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"employee_count",className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Employees"}),c.jsx("select",{id:"employee_count",value:i.employee_count,onChange:o=>s(l=>({...l,employee_count:parseInt(o.target.value)})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:vR.map(o=>c.jsx("option",{value:o.value,children:o.label},o.value))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Currency"}),c.jsx("select",{id:"currency",value:i.currency,onChange:o=>s(l=>({...l,currency:o.target.value})),required:!0,className:"block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:yR.map(o=>c.jsxs("option",{value:o.code,children:[o.code," - ",o.name]},o.code))})]}),c.jsx("div",{children:c.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:r?"Saving...":"Save Organization Details"})})]})})]})})}const _R=[{icon:UT,name:"Fashion & Tailoring",description:"Perfect for fashion houses, tailoring shops, and clothing manufacturers."},{icon:Qs,name:"Service-Based Businesses",description:"Ideal for businesses offering services like cleaning, repairs, or installations."},{icon:ru,name:"Contractors & Freelancers",description:"Great for managing contract workers, freelancers, and project-based teams."},{icon:ex,name:"Retail & Custom Orders",description:"Suitable for retail businesses handling custom orders and made-to-order products."}],SR=[{icon:ru,title:"Workforce Management",description:"Track workers, assign tasks, and manage project rates with WhatsApp integration."},{icon:l_,title:"Client Management",description:"Maintain client profiles with custom fields and track client-specific information."},{icon:Qs,title:"Service Catalog",description:"Define and price your services, create service packages, and track service delivery."},{icon:ex,title:"Order Management",description:"Process client orders, assign workers, and track order fulfillment end-to-end."},{icon:Oc,title:"Task & Project Tracking",description:"Monitor tasks, track progress, and manage project timelines efficiently."},{icon:PT,title:"Detailed Reports",description:"Export financial reports, worker performance, and order analytics in Excel/PDF."},{icon:Ao,title:"Financial Controls",description:"Track earnings, manage deductions, and monitor financial performance."},{icon:s_,title:"Communication",description:"Integrated WhatsApp messaging for seamless communication."},{icon:AT,title:"Business Analytics",description:"Get insights into your business performance, worker productivity, and client trends."},{icon:WT,title:"Secure & Reliable",description:"Enterprise-grade security with role-based access control and data protection."}],NR=[{title:"Save Time",description:"Streamline operations and reduce administrative overhead with automated workflows."},{title:"Grow Revenue",description:"Manage more clients, track orders efficiently, and increase business throughput."},{title:"Better Insights",description:"Make data-driven decisions with comprehensive business analytics and reporting."},{title:"Improve Client Satisfaction",description:"Deliver better service with organized client management and order tracking."}];function kR(){return c.jsxs("div",{className:"bg-white",children:[c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-50 transform -skew-y-6 origin-top-left"}),c.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-24 sm:pb-32",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"flex justify-center mb-8",children:c.jsx("div",{className:"h-16 w-16 bg-blue-100 rounded-2xl flex items-center justify-center",children:c.jsx(Eo,{className:"h-10 w-10 text-blue-600"})})}),c.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-extrabold text-gray-900 tracking-tight leading-tight",children:["Sten360: ",c.jsx("span",{className:"text-blue-600",children:"Business Management"})," Platform"]}),c.jsx("p",{className:"mt-6 max-w-2xl mx-auto text-xl text-gray-500",children:"A Sten Business solution for managing your entire operation - from clients and orders to workers and finances - all in one integrated platform. Built for growing organizations that demand efficiency."}),c.jsxs("div",{className:"mt-10 flex justify-center gap-4",children:[c.jsxs(on,{to:"/signup",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200",children:["Get Started Free",c.jsx(s1,{className:"ml-2 h-5 w-5"})]}),c.jsx(on,{to:"/signin",className:"inline-flex items-center px-6 py-3 border border-gray-300 text-base font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200",children:"Sign In"})]})]})})]}),c.jsx("div",{className:"py-24 bg-gradient-to-br from-gray-50 to-blue-50",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Industries We Serve"}),c.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Our platform is tailored for businesses that rely on skilled workers and custom orders"})]}),c.jsx("div",{className:"mt-20 grid grid-cols-1 gap-8 sm:grid-cols-2",children:_R.map((e,t)=>c.jsx("div",{className:"relative bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"flex-shrink-0 rounded-lg inline-flex p-3 bg-blue-50 text-blue-600",children:c.jsx(e.icon,{className:"h-6 w-6","aria-hidden":"true"})}),c.jsxs("div",{className:"ml-4",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),c.jsx("p",{className:"mt-2 text-base text-gray-500",children:e.description})]})]})},t))})]})}),c.jsx("div",{className:"py-24 bg-white",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Your All-in-One Business Solution"}),c.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Powerful features designed to help you manage and grow your business efficiently"})]}),c.jsx("div",{className:"mt-20 grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3",children:SR.map((e,t)=>c.jsxs("div",{className:"relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-blue-500 rounded-lg hover:shadow-lg transition-shadow duration-200",children:[c.jsx("div",{children:c.jsx("span",{className:"rounded-lg inline-flex p-3 bg-blue-50 text-blue-600 ring-4 ring-white",children:c.jsx(e.icon,{className:"h-6 w-6","aria-hidden":"true"})})}),c.jsxs("div",{className:"mt-8",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.title}),c.jsx("p",{className:"mt-2 text-base text-gray-500",children:e.description})]})]},t))})]})}),c.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 py-24",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-2",children:"Transform Your Business Operations"}),c.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"Streamline operations, boost efficiency, and accelerate growth with our integrated platform"})]}),c.jsx("div",{className:"mt-20",children:c.jsx("dl",{className:"space-y-10 md:space-y-0 md:grid md:grid-cols-2 md:gap-x-8 md:gap-y-12",children:NR.map((e,t)=>c.jsxs("div",{className:"relative",children:[c.jsxs("dt",{children:[c.jsx("div",{className:"absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white",children:c.jsx(Ns,{className:"h-6 w-6","aria-hidden":"true"})}),c.jsx("p",{className:"ml-16 text-lg leading-6 font-medium text-gray-900",children:e.title})]}),c.jsx("dd",{className:"mt-2 ml-16 text-base text-gray-500",children:e.description})]},t))})})]})}),c.jsx("div",{className:"py-24 bg-white",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 sm:p-12",children:c.jsxs("div",{className:"max-w-3xl mx-auto",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl mb-8 text-center",children:"How Kofi Ghana Kloding Scaled with Sten360"}),c.jsx("p",{className:"text-gray-600 mb-8",children:"Before switching to Sten360, Kofi Ghana Kloding struggled with disorganized client records, delayed orders, and inefficient workforce management. Manual processes made it difficult to track tailor assignments, manage finances, and keep up with growing customer demand."}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-6",children:"With Sten360, Kofi Ghana Kloding transformed its operations:"}),c.jsxs("div",{className:"space-y-4 mb-8",children:[c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Seamless Order & Client Management"}),c.jsx("p",{className:"text-gray-600",children:"Orders are tracked end-to-end, ensuring every client gets timely service."})]})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Workforce Efficiency"}),c.jsx("p",{className:"text-gray-600",children:"Tailors receive assignments instantly, and their progress is monitored in real-time."})]})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Smarter Financial Controls"}),c.jsx("p",{className:"text-gray-600",children:"Earnings, expenses, and worker payments are automatically tracked, reducing financial errors."})]})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(Ns,{className:"h-6 w-6 text-green-500 mt-0.5 mr-3 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Stronger Customer Relationships"}),c.jsx("p",{className:"text-gray-600",children:"With detailed client profiles and history, Kofi delivers a more personalized experience."})]})]})]}),c.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Now, Kofi Ghana spends less time handling admin tasks and more time growing his brand."}),c.jsxs("div",{className:"text-center",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Ready to take your business to the next level?"}),c.jsxs(on,{to:"/signup",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700",children:["Get Started with Sten360 Today!",c.jsx(s1,{className:"ml-2 h-5 w-5"})]})]})]})})})}),c.jsx("div",{className:"bg-white",children:c.jsx("div",{className:"max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"bg-blue-600 rounded-lg shadow-xl overflow-hidden",children:c.jsx("div",{className:"pt-10 pb-12 px-6 sm:pt-16 sm:px-16 lg:py-16 lg:pr-0 xl:py-20 xl:px-20",children:c.jsxs("div",{className:"lg:self-center",children:[c.jsxs("h2",{className:"text-3xl font-extrabold text-white sm:text-4xl",children:[c.jsx("span",{className:"block",children:"Ready to get started?"}),c.jsx("span",{className:"block",children:"Transform your business today."})]}),c.jsx("p",{className:"mt-4 text-lg leading-6 text-blue-200",children:"Sign up for free and experience the difference. No credit card required."}),c.jsxs(on,{to:"/signup",className:"mt-8 inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-blue-600 bg-white hover:bg-blue-50 transition-colors duration-200",children:["Get Started Free",c.jsx(s1,{className:"ml-2 h-5 w-5"})]})]})})})})}),c.jsx("footer",{className:"bg-gray-50",children:c.jsx("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(Eo,{className:"h-6 w-6 text-gray-400"}),c.jsx("span",{className:"ml-2 text-gray-500",children:" 2024 Sten Media Network. All rights reserved."})]}),c.jsx("p",{className:"text-sm text-gray-400",children:"Sten360 is a product of Sten Business, a subsidiary of Sten Media Network"})]})})})]})}function ER(){const{user:e,error:t,initialized:r}=Kt();return r?t?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50",children:c.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[c.jsxs("div",{className:"text-red-600 mb-2",children:["Error: ",t]}),c.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})}):c.jsx(QT,{children:c.jsx(CE,{children:c.jsxs(Eb,{children:[c.jsx(Sr,{path:"/",element:e?c.jsx(dl,{to:"/dashboard",replace:!0}):c.jsx(kR,{})}),c.jsxs(Sr,{element:c.jsx(qT,{}),children:[c.jsx(Sr,{path:"/signin",element:c.jsx(GT,{})}),c.jsx(Sr,{path:"/signup",element:c.jsx(YT,{})})]}),c.jsx(Sr,{path:"/organization-setup",element:e?c.jsx(bR,{}):c.jsx(dl,{to:"/signin",replace:!0})}),c.jsx(Sr,{path:"/dashboard/*",element:e?c.jsx(xR,{}):c.jsx(dl,{to:"/signin",replace:!0})})]})})}):c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading application..."})]})})}pb(document.getElementById("root")).render(c.jsx(pe.StrictMode,{children:c.jsx(ER,{})}));export{tr as _,Xn as c,Xg as g};
